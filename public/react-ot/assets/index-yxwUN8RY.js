var tM=Object.defineProperty;var Kk=e=>{throw TypeError(e)};var rM=(e,t,r)=>t in e?tM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Fe=(e,t,r)=>rM(e,typeof t!="symbol"?t+"":t,r),Q1=(e,t,r)=>t.has(e)||Kk("Cannot "+r);var Y=(e,t,r)=>(Q1(e,t,"read from private field"),r?r.call(e):t.get(e)),Oe=(e,t,r)=>t.has(e)?Kk("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Te=(e,t,r,n)=>(Q1(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Ke=(e,t,r)=>(Q1(e,t,"access private method"),r);var xp=(e,t,r,n)=>({set _(s){Te(e,t,s,r)},get _(){return Y(e,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function nM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var TA={exports:{}},o1={},EA={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K0=Symbol.for("react.element"),sM=Symbol.for("react.portal"),aM=Symbol.for("react.fragment"),iM=Symbol.for("react.strict_mode"),oM=Symbol.for("react.profiler"),lM=Symbol.for("react.provider"),cM=Symbol.for("react.context"),dM=Symbol.for("react.forward_ref"),uM=Symbol.for("react.suspense"),hM=Symbol.for("react.memo"),fM=Symbol.for("react.lazy"),Xk=Symbol.iterator;function pM(e){return e===null||typeof e!="object"?null:(e=Xk&&e[Xk]||e["@@iterator"],typeof e=="function"?e:null)}var AA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},FA=Object.assign,PA={};function Iu(e,t,r){this.props=e,this.context=t,this.refs=PA,this.updater=r||AA}Iu.prototype.isReactComponent={};Iu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Iu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function DA(){}DA.prototype=Iu.prototype;function O2(e,t,r){this.props=e,this.context=t,this.refs=PA,this.updater=r||AA}var R2=O2.prototype=new DA;R2.constructor=O2;FA(R2,Iu.prototype);R2.isPureReactComponent=!0;var Yk=Array.isArray,MA=Object.prototype.hasOwnProperty,I2={current:null},OA={key:!0,ref:!0,__self:!0,__source:!0};function RA(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)MA.call(t,n)&&!OA.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:K0,type:e,key:i,ref:o,props:s,_owner:I2.current}}function mM(e,t){return{$$typeof:K0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function N2(e){return typeof e=="object"&&e!==null&&e.$$typeof===K0}function gM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Qk=/\/+/g;function J1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gM(""+e.key):t.toString(36)}function Mg(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case K0:case sM:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+J1(o,0):n,Yk(s)?(r="",e!=null&&(r=e.replace(Qk,"$&/")+"/"),Mg(s,t,r,"",function(u){return u})):s!=null&&(N2(s)&&(s=mM(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Qk,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Yk(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+J1(i,l);o+=Mg(i,t,r,c,s)}else if(c=pM(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+J1(i,l++),o+=Mg(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function vp(e,t,r){if(e==null)return e;var n=[],s=0;return Mg(e,n,"","",function(i){return t.call(r,i,s++)}),n}function xM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pn={current:null},Og={transition:null},vM={ReactCurrentDispatcher:Pn,ReactCurrentBatchConfig:Og,ReactCurrentOwner:I2};function IA(){throw Error("act(...) is not supported in production builds of React.")}Ze.Children={map:vp,forEach:function(e,t,r){vp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vp(e,function(){t++}),t},toArray:function(e){return vp(e,function(t){return t})||[]},only:function(e){if(!N2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ze.Component=Iu;Ze.Fragment=aM;Ze.Profiler=oM;Ze.PureComponent=O2;Ze.StrictMode=iM;Ze.Suspense=uM;Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vM;Ze.act=IA;Ze.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=FA({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=I2.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)MA.call(t,c)&&!OA.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:K0,type:e.type,key:s,ref:i,props:n,_owner:o}};Ze.createContext=function(e){return e={$$typeof:cM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lM,_context:e},e.Consumer=e};Ze.createElement=RA;Ze.createFactory=function(e){var t=RA.bind(null,e);return t.type=e,t};Ze.createRef=function(){return{current:null}};Ze.forwardRef=function(e){return{$$typeof:dM,render:e}};Ze.isValidElement=N2;Ze.lazy=function(e){return{$$typeof:fM,_payload:{_status:-1,_result:e},_init:xM}};Ze.memo=function(e,t){return{$$typeof:hM,type:e,compare:t===void 0?null:t}};Ze.startTransition=function(e){var t=Og.transition;Og.transition={};try{e()}finally{Og.transition=t}};Ze.unstable_act=IA;Ze.useCallback=function(e,t){return Pn.current.useCallback(e,t)};Ze.useContext=function(e){return Pn.current.useContext(e)};Ze.useDebugValue=function(){};Ze.useDeferredValue=function(e){return Pn.current.useDeferredValue(e)};Ze.useEffect=function(e,t){return Pn.current.useEffect(e,t)};Ze.useId=function(){return Pn.current.useId()};Ze.useImperativeHandle=function(e,t,r){return Pn.current.useImperativeHandle(e,t,r)};Ze.useInsertionEffect=function(e,t){return Pn.current.useInsertionEffect(e,t)};Ze.useLayoutEffect=function(e,t){return Pn.current.useLayoutEffect(e,t)};Ze.useMemo=function(e,t){return Pn.current.useMemo(e,t)};Ze.useReducer=function(e,t,r){return Pn.current.useReducer(e,t,r)};Ze.useRef=function(e){return Pn.current.useRef(e)};Ze.useState=function(e){return Pn.current.useState(e)};Ze.useSyncExternalStore=function(e,t,r){return Pn.current.useSyncExternalStore(e,t,r)};Ze.useTransition=function(){return Pn.current.useTransition()};Ze.version="18.3.1";EA.exports=Ze;var E=EA.exports;const li=nM(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yM=E,bM=Symbol.for("react.element"),_M=Symbol.for("react.fragment"),wM=Object.prototype.hasOwnProperty,jM=yM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kM={key:!0,ref:!0,__self:!0,__source:!0};function NA(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)wM.call(t,n)&&!kM.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:bM,type:e,key:i,ref:o,props:s,_owner:jM.current}}o1.Fragment=_M;o1.jsx=NA;o1.jsxs=NA;TA.exports=o1;var a=TA.exports,V_={},LA={exports:{}},_s={},zA={exports:{}},BA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,W){var ce=Z.length;Z.push(W);e:for(;0<ce;){var te=ce-1>>>1,D=Z[te];if(0<s(D,W))Z[te]=W,Z[ce]=D,ce=te;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var W=Z[0],ce=Z.pop();if(ce!==W){Z[0]=ce;e:for(var te=0,D=Z.length,R=D>>>1;te<R;){var N=2*(te+1)-1,H=Z[N],ee=N+1,J=Z[ee];if(0>s(H,ce))ee<D&&0>s(J,H)?(Z[te]=J,Z[ee]=ce,te=ee):(Z[te]=H,Z[N]=ce,te=N);else if(ee<D&&0>s(J,ce))Z[te]=J,Z[ee]=ce,te=ee;else break e}}return W}function s(Z,W){var ce=Z.sortIndex-W.sortIndex;return ce!==0?ce:Z.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,g=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Z){for(var W=r(u);W!==null;){if(W.callback===null)n(u);else if(W.startTime<=Z)n(u),W.sortIndex=W.expirationTime,t(c,W);else break;W=r(u)}}function C(Z){if(x=!1,w(Z),!v)if(r(c)!==null)v=!0,Q(j);else{var W=r(u);W!==null&&re(C,W.startTime-Z)}}function j(Z,W){v=!1,x&&(x=!1,_(M),M=-1),g=!0;var ce=m;try{for(w(W),f=r(c);f!==null&&(!(f.expirationTime>W)||Z&&!F());){var te=f.callback;if(typeof te=="function"){f.callback=null,m=f.priorityLevel;var D=te(f.expirationTime<=W);W=e.unstable_now(),typeof D=="function"?f.callback=D:f===r(c)&&n(c),w(W)}else n(c);f=r(c)}if(f!==null)var R=!0;else{var N=r(u);N!==null&&re(C,N.startTime-W),R=!1}return R}finally{f=null,m=ce,g=!1}}var T=!1,k=null,M=-1,A=5,O=-1;function F(){return!(e.unstable_now()-O<A)}function B(){if(k!==null){var Z=e.unstable_now();O=Z;var W=!0;try{W=k(!0,Z)}finally{W?L():(T=!1,k=null)}}else T=!1}var L;if(typeof b=="function")L=function(){b(B)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,P=U.port2;U.port1.onmessage=B,L=function(){P.postMessage(null)}}else L=function(){y(B,0)};function Q(Z){k=Z,T||(T=!0,L())}function re(Z,W){M=y(function(){Z(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){v||g||(v=!0,Q(j))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ce=m;m=W;try{return Z()}finally{m=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,W){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ce=m;m=Z;try{return W()}finally{m=ce}},e.unstable_scheduleCallback=function(Z,W,ce){var te=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?te+ce:te):ce=te,Z){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=ce+D,Z={id:h++,callback:W,priorityLevel:Z,startTime:ce,expirationTime:D,sortIndex:-1},ce>te?(Z.sortIndex=ce,t(u,Z),r(c)===null&&Z===r(u)&&(x?(_(M),M=-1):x=!0,re(C,ce-te))):(Z.sortIndex=D,t(c,Z),v||g||(v=!0,Q(j))),Z},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(Z){var W=m;return function(){var ce=m;m=W;try{return Z.apply(this,arguments)}finally{m=ce}}}})(BA);zA.exports=BA;var SM=zA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CM=E,ys=SM;function _e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var UA=new Set,t0={};function Jc(e,t){vu(e,t),vu(e+"Capture",t)}function vu(e,t){for(t0[e]=t,e=0;e<t.length;e++)UA.add(t[e])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),H_=Object.prototype.hasOwnProperty,$M=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jk={},Zk={};function TM(e){return H_.call(Zk,e)?!0:H_.call(Jk,e)?!1:$M.test(e)?Zk[e]=!0:(Jk[e]=!0,!1)}function EM(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function AM(e,t,r,n){if(t===null||typeof t>"u"||EM(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dn(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Gr[e]=new Dn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Gr[t]=new Dn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Gr[e]=new Dn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Gr[e]=new Dn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Gr[e]=new Dn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Gr[e]=new Dn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Gr[e]=new Dn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Gr[e]=new Dn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Gr[e]=new Dn(e,5,!1,e.toLowerCase(),null,!1,!1)});var L2=/[\-:]([a-z])/g;function z2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(L2,z2);Gr[t]=new Dn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(L2,z2);Gr[t]=new Dn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(L2,z2);Gr[t]=new Dn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Gr[e]=new Dn(e,1,!1,e.toLowerCase(),null,!1,!1)});Gr.xlinkHref=new Dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Gr[e]=new Dn(e,1,!1,e.toLowerCase(),null,!0,!0)});function B2(e,t,r,n){var s=Gr.hasOwnProperty(t)?Gr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(AM(t,r,s,n)&&(r=null),n||s===null?TM(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var so=CM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yp=Symbol.for("react.element"),Dd=Symbol.for("react.portal"),Md=Symbol.for("react.fragment"),U2=Symbol.for("react.strict_mode"),W_=Symbol.for("react.profiler"),VA=Symbol.for("react.provider"),HA=Symbol.for("react.context"),V2=Symbol.for("react.forward_ref"),G_=Symbol.for("react.suspense"),q_=Symbol.for("react.suspense_list"),H2=Symbol.for("react.memo"),Bo=Symbol.for("react.lazy"),WA=Symbol.for("react.offscreen"),eS=Symbol.iterator;function nh(e){return e===null||typeof e!="object"?null:(e=eS&&e[eS]||e["@@iterator"],typeof e=="function"?e:null)}var qt=Object.assign,Z1;function bf(e){if(Z1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Z1=t&&t[1]||""}return`
`+Z1+e}var ev=!1;function tv(e,t){if(!e||ev)return"";ev=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{ev=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bf(e):""}function FM(e){switch(e.tag){case 5:return bf(e.type);case 16:return bf("Lazy");case 13:return bf("Suspense");case 19:return bf("SuspenseList");case 0:case 2:case 15:return e=tv(e.type,!1),e;case 11:return e=tv(e.type.render,!1),e;case 1:return e=tv(e.type,!0),e;default:return""}}function K_(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Md:return"Fragment";case Dd:return"Portal";case W_:return"Profiler";case U2:return"StrictMode";case G_:return"Suspense";case q_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case HA:return(e.displayName||"Context")+".Consumer";case VA:return(e._context.displayName||"Context")+".Provider";case V2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H2:return t=e.displayName||null,t!==null?t:K_(e.type)||"Memo";case Bo:t=e._payload,e=e._init;try{return K_(e(t))}catch{}}return null}function PM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K_(t);case 8:return t===U2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function vl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function GA(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function DM(e){var t=GA(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bp(e){e._valueTracker||(e._valueTracker=DM(e))}function qA(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=GA(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function lx(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function X_(e,t){var r=t.checked;return qt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function tS(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=vl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function KA(e,t){t=t.checked,t!=null&&B2(e,"checked",t,!1)}function Y_(e,t){KA(e,t);var r=vl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Q_(e,t.type,r):t.hasOwnProperty("defaultValue")&&Q_(e,t.type,vl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rS(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Q_(e,t,r){(t!=="number"||lx(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var _f=Array.isArray;function Kd(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+vl(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function J_(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_e(91));return qt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nS(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_e(92));if(_f(r)){if(1<r.length)throw Error(_e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:vl(r)}}function XA(e,t){var r=vl(t.value),n=vl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function sS(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function YA(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Z_(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?YA(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _p,QA=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_p=_p||document.createElement("div"),_p.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_p.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function r0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Pf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MM=["Webkit","ms","Moz","O"];Object.keys(Pf).forEach(function(e){MM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Pf[t]=Pf[e]})});function JA(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Pf.hasOwnProperty(e)&&Pf[e]?(""+t).trim():t+"px"}function ZA(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=JA(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var OM=qt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ew(e,t){if(t){if(OM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_e(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_e(62))}}function tw(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rw=null;function W2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nw=null,Xd=null,Yd=null;function aS(e){if(e=Q0(e)){if(typeof nw!="function")throw Error(_e(280));var t=e.stateNode;t&&(t=h1(t),nw(e.stateNode,e.type,t))}}function eF(e){Xd?Yd?Yd.push(e):Yd=[e]:Xd=e}function tF(){if(Xd){var e=Xd,t=Yd;if(Yd=Xd=null,aS(e),t)for(e=0;e<t.length;e++)aS(t[e])}}function rF(e,t){return e(t)}function nF(){}var rv=!1;function sF(e,t,r){if(rv)return e(t,r);rv=!0;try{return rF(e,t,r)}finally{rv=!1,(Xd!==null||Yd!==null)&&(nF(),tF())}}function n0(e,t){var r=e.stateNode;if(r===null)return null;var n=h1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_e(231,t,typeof r));return r}var sw=!1;if(Zi)try{var sh={};Object.defineProperty(sh,"passive",{get:function(){sw=!0}}),window.addEventListener("test",sh,sh),window.removeEventListener("test",sh,sh)}catch{sw=!1}function RM(e,t,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(h){this.onError(h)}}var Df=!1,cx=null,dx=!1,aw=null,IM={onError:function(e){Df=!0,cx=e}};function NM(e,t,r,n,s,i,o,l,c){Df=!1,cx=null,RM.apply(IM,arguments)}function LM(e,t,r,n,s,i,o,l,c){if(NM.apply(this,arguments),Df){if(Df){var u=cx;Df=!1,cx=null}else throw Error(_e(198));dx||(dx=!0,aw=u)}}function Zc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function aF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function iS(e){if(Zc(e)!==e)throw Error(_e(188))}function zM(e){var t=e.alternate;if(!t){if(t=Zc(e),t===null)throw Error(_e(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return iS(s),e;if(i===n)return iS(s),t;i=i.sibling}throw Error(_e(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?e:t}function iF(e){return e=zM(e),e!==null?oF(e):null}function oF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=oF(e);if(t!==null)return t;e=e.sibling}return null}var lF=ys.unstable_scheduleCallback,oS=ys.unstable_cancelCallback,BM=ys.unstable_shouldYield,UM=ys.unstable_requestPaint,nr=ys.unstable_now,VM=ys.unstable_getCurrentPriorityLevel,G2=ys.unstable_ImmediatePriority,cF=ys.unstable_UserBlockingPriority,ux=ys.unstable_NormalPriority,HM=ys.unstable_LowPriority,dF=ys.unstable_IdlePriority,l1=null,di=null;function WM(e){if(di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(l1,e,void 0,(e.current.flags&128)===128)}catch{}}var $a=Math.clz32?Math.clz32:KM,GM=Math.log,qM=Math.LN2;function KM(e){return e>>>=0,e===0?32:31-(GM(e)/qM|0)|0}var wp=64,jp=4194304;function wf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function hx(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=wf(l):(i&=o,i!==0&&(n=wf(i)))}else o=r&~s,o!==0?n=wf(o):i!==0&&(n=wf(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-$a(t),s=1<<r,n|=e[r],t&=~s;return n}function XM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YM(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-$a(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=XM(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function iw(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function uF(){var e=wp;return wp<<=1,!(wp&4194240)&&(wp=64),e}function nv(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function X0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-$a(t),e[t]=r}function QM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-$a(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function q2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-$a(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var St=0;function hF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var fF,K2,pF,mF,gF,ow=!1,kp=[],ol=null,ll=null,cl=null,s0=new Map,a0=new Map,Vo=[],JM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lS(e,t){switch(e){case"focusin":case"focusout":ol=null;break;case"dragenter":case"dragleave":ll=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":s0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":a0.delete(t.pointerId)}}function ah(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Q0(t),t!==null&&K2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ZM(e,t,r,n,s){switch(t){case"focusin":return ol=ah(ol,e,t,r,n,s),!0;case"dragenter":return ll=ah(ll,e,t,r,n,s),!0;case"mouseover":return cl=ah(cl,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return s0.set(i,ah(s0.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,a0.set(i,ah(a0.get(i)||null,e,t,r,n,s)),!0}return!1}function xF(e){var t=lc(e.target);if(t!==null){var r=Zc(t);if(r!==null){if(t=r.tag,t===13){if(t=aF(r),t!==null){e.blockedOn=t,gF(e.priority,function(){pF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Rg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=lw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);rw=n,r.target.dispatchEvent(n),rw=null}else return t=Q0(r),t!==null&&K2(t),e.blockedOn=r,!1;t.shift()}return!0}function cS(e,t,r){Rg(e)&&r.delete(t)}function eO(){ow=!1,ol!==null&&Rg(ol)&&(ol=null),ll!==null&&Rg(ll)&&(ll=null),cl!==null&&Rg(cl)&&(cl=null),s0.forEach(cS),a0.forEach(cS)}function ih(e,t){e.blockedOn===t&&(e.blockedOn=null,ow||(ow=!0,ys.unstable_scheduleCallback(ys.unstable_NormalPriority,eO)))}function i0(e){function t(s){return ih(s,e)}if(0<kp.length){ih(kp[0],e);for(var r=1;r<kp.length;r++){var n=kp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ol!==null&&ih(ol,e),ll!==null&&ih(ll,e),cl!==null&&ih(cl,e),s0.forEach(t),a0.forEach(t),r=0;r<Vo.length;r++)n=Vo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vo.length&&(r=Vo[0],r.blockedOn===null);)xF(r),r.blockedOn===null&&Vo.shift()}var Qd=so.ReactCurrentBatchConfig,fx=!0;function tO(e,t,r,n){var s=St,i=Qd.transition;Qd.transition=null;try{St=1,X2(e,t,r,n)}finally{St=s,Qd.transition=i}}function rO(e,t,r,n){var s=St,i=Qd.transition;Qd.transition=null;try{St=4,X2(e,t,r,n)}finally{St=s,Qd.transition=i}}function X2(e,t,r,n){if(fx){var s=lw(e,t,r,n);if(s===null)fv(e,t,n,px,r),lS(e,n);else if(ZM(s,e,t,r,n))n.stopPropagation();else if(lS(e,n),t&4&&-1<JM.indexOf(e)){for(;s!==null;){var i=Q0(s);if(i!==null&&fF(i),i=lw(e,t,r,n),i===null&&fv(e,t,n,px,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else fv(e,t,n,null,r)}}var px=null;function lw(e,t,r,n){if(px=null,e=W2(n),e=lc(e),e!==null)if(t=Zc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=aF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return px=e,null}function vF(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VM()){case G2:return 1;case cF:return 4;case ux:case HM:return 16;case dF:return 536870912;default:return 16}default:return 16}}var el=null,Y2=null,Ig=null;function yF(){if(Ig)return Ig;var e,t=Y2,r=t.length,n,s="value"in el?el.value:el.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Ig=s.slice(e,1<n?1-n:void 0)}function Ng(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sp(){return!0}function dS(){return!1}function ws(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sp:dS,this.isPropagationStopped=dS,this}return qt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Sp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Sp)},persist:function(){},isPersistent:Sp}),t}var Nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Q2=ws(Nu),Y0=qt({},Nu,{view:0,detail:0}),nO=ws(Y0),sv,av,oh,c1=qt({},Y0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:J2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oh&&(oh&&e.type==="mousemove"?(sv=e.screenX-oh.screenX,av=e.screenY-oh.screenY):av=sv=0,oh=e),sv)},movementY:function(e){return"movementY"in e?e.movementY:av}}),uS=ws(c1),sO=qt({},c1,{dataTransfer:0}),aO=ws(sO),iO=qt({},Y0,{relatedTarget:0}),iv=ws(iO),oO=qt({},Nu,{animationName:0,elapsedTime:0,pseudoElement:0}),lO=ws(oO),cO=qt({},Nu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dO=ws(cO),uO=qt({},Nu,{data:0}),hS=ws(uO),hO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mO(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=pO[e])?!!t[e]:!1}function J2(){return mO}var gO=qt({},Y0,{key:function(e){if(e.key){var t=hO[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ng(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fO[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:J2,charCode:function(e){return e.type==="keypress"?Ng(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ng(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xO=ws(gO),vO=qt({},c1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fS=ws(vO),yO=qt({},Y0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:J2}),bO=ws(yO),_O=qt({},Nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),wO=ws(_O),jO=qt({},c1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kO=ws(jO),SO=[9,13,27,32],Z2=Zi&&"CompositionEvent"in window,Mf=null;Zi&&"documentMode"in document&&(Mf=document.documentMode);var CO=Zi&&"TextEvent"in window&&!Mf,bF=Zi&&(!Z2||Mf&&8<Mf&&11>=Mf),pS=" ",mS=!1;function _F(e,t){switch(e){case"keyup":return SO.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Od=!1;function $O(e,t){switch(e){case"compositionend":return wF(t);case"keypress":return t.which!==32?null:(mS=!0,pS);case"textInput":return e=t.data,e===pS&&mS?null:e;default:return null}}function TO(e,t){if(Od)return e==="compositionend"||!Z2&&_F(e,t)?(e=yF(),Ig=Y2=el=null,Od=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return bF&&t.locale!=="ko"?null:t.data;default:return null}}var EO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!EO[e.type]:t==="textarea"}function jF(e,t,r,n){eF(n),t=mx(t,"onChange"),0<t.length&&(r=new Q2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Of=null,o0=null;function AO(e){MF(e,0)}function d1(e){var t=Nd(e);if(qA(t))return e}function FO(e,t){if(e==="change")return t}var kF=!1;if(Zi){var ov;if(Zi){var lv="oninput"in document;if(!lv){var xS=document.createElement("div");xS.setAttribute("oninput","return;"),lv=typeof xS.oninput=="function"}ov=lv}else ov=!1;kF=ov&&(!document.documentMode||9<document.documentMode)}function vS(){Of&&(Of.detachEvent("onpropertychange",SF),o0=Of=null)}function SF(e){if(e.propertyName==="value"&&d1(o0)){var t=[];jF(t,o0,e,W2(e)),sF(AO,t)}}function PO(e,t,r){e==="focusin"?(vS(),Of=t,o0=r,Of.attachEvent("onpropertychange",SF)):e==="focusout"&&vS()}function DO(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return d1(o0)}function MO(e,t){if(e==="click")return d1(t)}function OO(e,t){if(e==="input"||e==="change")return d1(t)}function RO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pa=typeof Object.is=="function"?Object.is:RO;function l0(e,t){if(Pa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!H_.call(t,s)||!Pa(e[s],t[s]))return!1}return!0}function yS(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bS(e,t){var r=yS(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yS(r)}}function CF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CF(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $F(){for(var e=window,t=lx();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=lx(e.document)}return t}function ej(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function IO(e){var t=$F(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&CF(r.ownerDocument.documentElement,r)){if(n!==null&&ej(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=bS(r,i);var o=bS(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var NO=Zi&&"documentMode"in document&&11>=document.documentMode,Rd=null,cw=null,Rf=null,dw=!1;function _S(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dw||Rd==null||Rd!==lx(n)||(n=Rd,"selectionStart"in n&&ej(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Rf&&l0(Rf,n)||(Rf=n,n=mx(cw,"onSelect"),0<n.length&&(t=new Q2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Rd)))}function Cp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Id={animationend:Cp("Animation","AnimationEnd"),animationiteration:Cp("Animation","AnimationIteration"),animationstart:Cp("Animation","AnimationStart"),transitionend:Cp("Transition","TransitionEnd")},cv={},TF={};Zi&&(TF=document.createElement("div").style,"AnimationEvent"in window||(delete Id.animationend.animation,delete Id.animationiteration.animation,delete Id.animationstart.animation),"TransitionEvent"in window||delete Id.transitionend.transition);function u1(e){if(cv[e])return cv[e];if(!Id[e])return e;var t=Id[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in TF)return cv[e]=t[r];return e}var EF=u1("animationend"),AF=u1("animationiteration"),FF=u1("animationstart"),PF=u1("transitionend"),DF=new Map,wS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sl(e,t){DF.set(e,t),Jc(t,[e])}for(var dv=0;dv<wS.length;dv++){var uv=wS[dv],LO=uv.toLowerCase(),zO=uv[0].toUpperCase()+uv.slice(1);Sl(LO,"on"+zO)}Sl(EF,"onAnimationEnd");Sl(AF,"onAnimationIteration");Sl(FF,"onAnimationStart");Sl("dblclick","onDoubleClick");Sl("focusin","onFocus");Sl("focusout","onBlur");Sl(PF,"onTransitionEnd");vu("onMouseEnter",["mouseout","mouseover"]);vu("onMouseLeave",["mouseout","mouseover"]);vu("onPointerEnter",["pointerout","pointerover"]);vu("onPointerLeave",["pointerout","pointerover"]);Jc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BO=new Set("cancel close invalid load scroll toggle".split(" ").concat(jf));function jS(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LM(n,t,void 0,e),e.currentTarget=null}function MF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;jS(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;jS(s,l,u),i=c}}}if(dx)throw e=aw,dx=!1,aw=null,e}function Ft(e,t){var r=t[mw];r===void 0&&(r=t[mw]=new Set);var n=e+"__bubble";r.has(n)||(OF(t,e,2,!1),r.add(n))}function hv(e,t,r){var n=0;t&&(n|=4),OF(r,e,n,t)}var $p="_reactListening"+Math.random().toString(36).slice(2);function c0(e){if(!e[$p]){e[$p]=!0,UA.forEach(function(r){r!=="selectionchange"&&(BO.has(r)||hv(r,!1,e),hv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$p]||(t[$p]=!0,hv("selectionchange",!1,t))}}function OF(e,t,r,n){switch(vF(t)){case 1:var s=tO;break;case 4:s=rO;break;default:s=X2}r=s.bind(null,t,r,e),s=void 0,!sw||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function fv(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=lc(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}sF(function(){var u=i,h=W2(r),f=[];e:{var m=DF.get(e);if(m!==void 0){var g=Q2,v=e;switch(e){case"keypress":if(Ng(r)===0)break e;case"keydown":case"keyup":g=xO;break;case"focusin":v="focus",g=iv;break;case"focusout":v="blur",g=iv;break;case"beforeblur":case"afterblur":g=iv;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=uS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=aO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=bO;break;case EF:case AF:case FF:g=lO;break;case PF:g=wO;break;case"scroll":g=nO;break;case"wheel":g=kO;break;case"copy":case"cut":case"paste":g=dO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=fS}var x=(t&4)!==0,y=!x&&e==="scroll",_=x?m!==null?m+"Capture":null:m;x=[];for(var b=u,w;b!==null;){w=b;var C=w.stateNode;if(w.tag===5&&C!==null&&(w=C,_!==null&&(C=n0(b,_),C!=null&&x.push(d0(b,C,w)))),y)break;b=b.return}0<x.length&&(m=new g(m,v,null,r,h),f.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",m&&r!==rw&&(v=r.relatedTarget||r.fromElement)&&(lc(v)||v[eo]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(v=r.relatedTarget||r.toElement,g=u,v=v?lc(v):null,v!==null&&(y=Zc(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(x=uS,C="onMouseLeave",_="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(x=fS,C="onPointerLeave",_="onPointerEnter",b="pointer"),y=g==null?m:Nd(g),w=v==null?m:Nd(v),m=new x(C,b+"leave",g,r,h),m.target=y,m.relatedTarget=w,C=null,lc(h)===u&&(x=new x(_,b+"enter",v,r,h),x.target=w,x.relatedTarget=y,C=x),y=C,g&&v)t:{for(x=g,_=v,b=0,w=x;w;w=cd(w))b++;for(w=0,C=_;C;C=cd(C))w++;for(;0<b-w;)x=cd(x),b--;for(;0<w-b;)_=cd(_),w--;for(;b--;){if(x===_||_!==null&&x===_.alternate)break t;x=cd(x),_=cd(_)}x=null}else x=null;g!==null&&kS(f,m,g,x,!1),v!==null&&y!==null&&kS(f,y,v,x,!0)}}e:{if(m=u?Nd(u):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var j=FO;else if(gS(m))if(kF)j=OO;else{j=DO;var T=PO}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=MO);if(j&&(j=j(e,u))){jF(f,j,r,h);break e}T&&T(e,m,u),e==="focusout"&&(T=m._wrapperState)&&T.controlled&&m.type==="number"&&Q_(m,"number",m.value)}switch(T=u?Nd(u):window,e){case"focusin":(gS(T)||T.contentEditable==="true")&&(Rd=T,cw=u,Rf=null);break;case"focusout":Rf=cw=Rd=null;break;case"mousedown":dw=!0;break;case"contextmenu":case"mouseup":case"dragend":dw=!1,_S(f,r,h);break;case"selectionchange":if(NO)break;case"keydown":case"keyup":_S(f,r,h)}var k;if(Z2)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Od?_F(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(bF&&r.locale!=="ko"&&(Od||M!=="onCompositionStart"?M==="onCompositionEnd"&&Od&&(k=yF()):(el=h,Y2="value"in el?el.value:el.textContent,Od=!0)),T=mx(u,M),0<T.length&&(M=new hS(M,e,null,r,h),f.push({event:M,listeners:T}),k?M.data=k:(k=wF(r),k!==null&&(M.data=k)))),(k=CO?$O(e,r):TO(e,r))&&(u=mx(u,"onBeforeInput"),0<u.length&&(h=new hS("onBeforeInput","beforeinput",null,r,h),f.push({event:h,listeners:u}),h.data=k))}MF(f,t)})}function d0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function mx(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=n0(e,r),i!=null&&n.unshift(d0(e,i,s)),i=n0(e,t),i!=null&&n.push(d0(e,i,s))),e=e.return}return n}function cd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function kS(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=n0(r,i),c!=null&&o.unshift(d0(r,c,l))):s||(c=n0(r,i),c!=null&&o.push(d0(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var UO=/\r\n?/g,VO=/\u0000|\uFFFD/g;function SS(e){return(typeof e=="string"?e:""+e).replace(UO,`
`).replace(VO,"")}function Tp(e,t,r){if(t=SS(t),SS(e)!==t&&r)throw Error(_e(425))}function gx(){}var uw=null,hw=null;function fw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pw=typeof setTimeout=="function"?setTimeout:void 0,HO=typeof clearTimeout=="function"?clearTimeout:void 0,CS=typeof Promise=="function"?Promise:void 0,WO=typeof queueMicrotask=="function"?queueMicrotask:typeof CS<"u"?function(e){return CS.resolve(null).then(e).catch(GO)}:pw;function GO(e){setTimeout(function(){throw e})}function pv(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),i0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);i0(t)}function dl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $S(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Lu=Math.random().toString(36).slice(2),oi="__reactFiber$"+Lu,u0="__reactProps$"+Lu,eo="__reactContainer$"+Lu,mw="__reactEvents$"+Lu,qO="__reactListeners$"+Lu,KO="__reactHandles$"+Lu;function lc(e){var t=e[oi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[eo]||r[oi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$S(e);e!==null;){if(r=e[oi])return r;e=$S(e)}return t}e=r,r=e.parentNode}return null}function Q0(e){return e=e[oi]||e[eo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Nd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_e(33))}function h1(e){return e[u0]||null}var gw=[],Ld=-1;function Cl(e){return{current:e}}function Ot(e){0>Ld||(e.current=gw[Ld],gw[Ld]=null,Ld--)}function At(e,t){Ld++,gw[Ld]=e.current,e.current=t}var yl={},hn=Cl(yl),Yn=Cl(!1),Rc=yl;function yu(e,t){var r=e.type.contextTypes;if(!r)return yl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Qn(e){return e=e.childContextTypes,e!=null}function xx(){Ot(Yn),Ot(hn)}function TS(e,t,r){if(hn.current!==yl)throw Error(_e(168));At(hn,t),At(Yn,r)}function RF(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(_e(108,PM(e)||"Unknown",s));return qt({},r,n)}function vx(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||yl,Rc=hn.current,At(hn,e),At(Yn,Yn.current),!0}function ES(e,t,r){var n=e.stateNode;if(!n)throw Error(_e(169));r?(e=RF(e,t,Rc),n.__reactInternalMemoizedMergedChildContext=e,Ot(Yn),Ot(hn),At(hn,e)):Ot(Yn),At(Yn,r)}var Ii=null,f1=!1,mv=!1;function IF(e){Ii===null?Ii=[e]:Ii.push(e)}function XO(e){f1=!0,IF(e)}function $l(){if(!mv&&Ii!==null){mv=!0;var e=0,t=St;try{var r=Ii;for(St=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ii=null,f1=!1}catch(s){throw Ii!==null&&(Ii=Ii.slice(e+1)),lF(G2,$l),s}finally{St=t,mv=!1}}return null}var zd=[],Bd=0,yx=null,bx=0,qs=[],Ks=0,Ic=null,Vi=1,Hi="";function nc(e,t){zd[Bd++]=bx,zd[Bd++]=yx,yx=e,bx=t}function NF(e,t,r){qs[Ks++]=Vi,qs[Ks++]=Hi,qs[Ks++]=Ic,Ic=e;var n=Vi;e=Hi;var s=32-$a(n)-1;n&=~(1<<s),r+=1;var i=32-$a(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Vi=1<<32-$a(t)+s|r<<s|n,Hi=i+e}else Vi=1<<i|r<<s|n,Hi=e}function tj(e){e.return!==null&&(nc(e,1),NF(e,1,0))}function rj(e){for(;e===yx;)yx=zd[--Bd],zd[Bd]=null,bx=zd[--Bd],zd[Bd]=null;for(;e===Ic;)Ic=qs[--Ks],qs[Ks]=null,Hi=qs[--Ks],qs[Ks]=null,Vi=qs[--Ks],qs[Ks]=null}var vs=null,gs=null,zt=!1,ja=null;function LF(e,t){var r=Xs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function AS(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vs=e,gs=dl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vs=e,gs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ic!==null?{id:Vi,overflow:Hi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Xs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vs=e,gs=null,!0):!1;default:return!1}}function xw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vw(e){if(zt){var t=gs;if(t){var r=t;if(!AS(e,t)){if(xw(e))throw Error(_e(418));t=dl(r.nextSibling);var n=vs;t&&AS(e,t)?LF(n,r):(e.flags=e.flags&-4097|2,zt=!1,vs=e)}}else{if(xw(e))throw Error(_e(418));e.flags=e.flags&-4097|2,zt=!1,vs=e}}}function FS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vs=e}function Ep(e){if(e!==vs)return!1;if(!zt)return FS(e),zt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fw(e.type,e.memoizedProps)),t&&(t=gs)){if(xw(e))throw zF(),Error(_e(418));for(;t;)LF(e,t),t=dl(t.nextSibling)}if(FS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){gs=dl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}gs=null}}else gs=vs?dl(e.stateNode.nextSibling):null;return!0}function zF(){for(var e=gs;e;)e=dl(e.nextSibling)}function bu(){gs=vs=null,zt=!1}function nj(e){ja===null?ja=[e]:ja.push(e)}var YO=so.ReactCurrentBatchConfig;function lh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,e))}return e}function Ap(e,t){throw e=Object.prototype.toString.call(t),Error(_e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function PS(e){var t=e._init;return t(e._payload)}function BF(e){function t(_,b){if(e){var w=_.deletions;w===null?(_.deletions=[b],_.flags|=16):w.push(b)}}function r(_,b){if(!e)return null;for(;b!==null;)t(_,b),b=b.sibling;return null}function n(_,b){for(_=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function s(_,b){return _=pl(_,b),_.index=0,_.sibling=null,_}function i(_,b,w){return _.index=w,e?(w=_.alternate,w!==null?(w=w.index,w<b?(_.flags|=2,b):w):(_.flags|=2,b)):(_.flags|=1048576,b)}function o(_){return e&&_.alternate===null&&(_.flags|=2),_}function l(_,b,w,C){return b===null||b.tag!==6?(b=wv(w,_.mode,C),b.return=_,b):(b=s(b,w),b.return=_,b)}function c(_,b,w,C){var j=w.type;return j===Md?h(_,b,w.props.children,C,w.key):b!==null&&(b.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Bo&&PS(j)===b.type)?(C=s(b,w.props),C.ref=lh(_,b,w),C.return=_,C):(C=Wg(w.type,w.key,w.props,null,_.mode,C),C.ref=lh(_,b,w),C.return=_,C)}function u(_,b,w,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=jv(w,_.mode,C),b.return=_,b):(b=s(b,w.children||[]),b.return=_,b)}function h(_,b,w,C,j){return b===null||b.tag!==7?(b=Cc(w,_.mode,C,j),b.return=_,b):(b=s(b,w),b.return=_,b)}function f(_,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=wv(""+b,_.mode,w),b.return=_,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case yp:return w=Wg(b.type,b.key,b.props,null,_.mode,w),w.ref=lh(_,null,b),w.return=_,w;case Dd:return b=jv(b,_.mode,w),b.return=_,b;case Bo:var C=b._init;return f(_,C(b._payload),w)}if(_f(b)||nh(b))return b=Cc(b,_.mode,w,null),b.return=_,b;Ap(_,b)}return null}function m(_,b,w,C){var j=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:l(_,b,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case yp:return w.key===j?c(_,b,w,C):null;case Dd:return w.key===j?u(_,b,w,C):null;case Bo:return j=w._init,m(_,b,j(w._payload),C)}if(_f(w)||nh(w))return j!==null?null:h(_,b,w,C,null);Ap(_,w)}return null}function g(_,b,w,C,j){if(typeof C=="string"&&C!==""||typeof C=="number")return _=_.get(w)||null,l(b,_,""+C,j);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case yp:return _=_.get(C.key===null?w:C.key)||null,c(b,_,C,j);case Dd:return _=_.get(C.key===null?w:C.key)||null,u(b,_,C,j);case Bo:var T=C._init;return g(_,b,w,T(C._payload),j)}if(_f(C)||nh(C))return _=_.get(w)||null,h(b,_,C,j,null);Ap(b,C)}return null}function v(_,b,w,C){for(var j=null,T=null,k=b,M=b=0,A=null;k!==null&&M<w.length;M++){k.index>M?(A=k,k=null):A=k.sibling;var O=m(_,k,w[M],C);if(O===null){k===null&&(k=A);break}e&&k&&O.alternate===null&&t(_,k),b=i(O,b,M),T===null?j=O:T.sibling=O,T=O,k=A}if(M===w.length)return r(_,k),zt&&nc(_,M),j;if(k===null){for(;M<w.length;M++)k=f(_,w[M],C),k!==null&&(b=i(k,b,M),T===null?j=k:T.sibling=k,T=k);return zt&&nc(_,M),j}for(k=n(_,k);M<w.length;M++)A=g(k,_,M,w[M],C),A!==null&&(e&&A.alternate!==null&&k.delete(A.key===null?M:A.key),b=i(A,b,M),T===null?j=A:T.sibling=A,T=A);return e&&k.forEach(function(F){return t(_,F)}),zt&&nc(_,M),j}function x(_,b,w,C){var j=nh(w);if(typeof j!="function")throw Error(_e(150));if(w=j.call(w),w==null)throw Error(_e(151));for(var T=j=null,k=b,M=b=0,A=null,O=w.next();k!==null&&!O.done;M++,O=w.next()){k.index>M?(A=k,k=null):A=k.sibling;var F=m(_,k,O.value,C);if(F===null){k===null&&(k=A);break}e&&k&&F.alternate===null&&t(_,k),b=i(F,b,M),T===null?j=F:T.sibling=F,T=F,k=A}if(O.done)return r(_,k),zt&&nc(_,M),j;if(k===null){for(;!O.done;M++,O=w.next())O=f(_,O.value,C),O!==null&&(b=i(O,b,M),T===null?j=O:T.sibling=O,T=O);return zt&&nc(_,M),j}for(k=n(_,k);!O.done;M++,O=w.next())O=g(k,_,M,O.value,C),O!==null&&(e&&O.alternate!==null&&k.delete(O.key===null?M:O.key),b=i(O,b,M),T===null?j=O:T.sibling=O,T=O);return e&&k.forEach(function(B){return t(_,B)}),zt&&nc(_,M),j}function y(_,b,w,C){if(typeof w=="object"&&w!==null&&w.type===Md&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case yp:e:{for(var j=w.key,T=b;T!==null;){if(T.key===j){if(j=w.type,j===Md){if(T.tag===7){r(_,T.sibling),b=s(T,w.props.children),b.return=_,_=b;break e}}else if(T.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Bo&&PS(j)===T.type){r(_,T.sibling),b=s(T,w.props),b.ref=lh(_,T,w),b.return=_,_=b;break e}r(_,T);break}else t(_,T);T=T.sibling}w.type===Md?(b=Cc(w.props.children,_.mode,C,w.key),b.return=_,_=b):(C=Wg(w.type,w.key,w.props,null,_.mode,C),C.ref=lh(_,b,w),C.return=_,_=C)}return o(_);case Dd:e:{for(T=w.key;b!==null;){if(b.key===T)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(_,b.sibling),b=s(b,w.children||[]),b.return=_,_=b;break e}else{r(_,b);break}else t(_,b);b=b.sibling}b=jv(w,_.mode,C),b.return=_,_=b}return o(_);case Bo:return T=w._init,y(_,b,T(w._payload),C)}if(_f(w))return v(_,b,w,C);if(nh(w))return x(_,b,w,C);Ap(_,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(_,b.sibling),b=s(b,w),b.return=_,_=b):(r(_,b),b=wv(w,_.mode,C),b.return=_,_=b),o(_)):r(_,b)}return y}var _u=BF(!0),UF=BF(!1),_x=Cl(null),wx=null,Ud=null,sj=null;function aj(){sj=Ud=wx=null}function ij(e){var t=_x.current;Ot(_x),e._currentValue=t}function yw(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Jd(e,t){wx=e,sj=Ud=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kn=!0),e.firstContext=null)}function Zs(e){var t=e._currentValue;if(sj!==e)if(e={context:e,memoizedValue:t,next:null},Ud===null){if(wx===null)throw Error(_e(308));Ud=e,wx.dependencies={lanes:0,firstContext:e}}else Ud=Ud.next=e;return t}var cc=null;function oj(e){cc===null?cc=[e]:cc.push(e)}function VF(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,oj(t)):(r.next=s.next,s.next=r),t.interleaved=r,to(e,n)}function to(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Uo=!1;function lj(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HF(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ki(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ul(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,to(e,r)}return s=n.interleaved,s===null?(t.next=t,oj(n)):(t.next=s.next,s.next=t),n.interleaved=t,to(e,r)}function Lg(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q2(e,r)}}function DS(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function jx(e,t,r,n){var s=e.updateQueue;Uo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,h=u=c=null,l=i;do{var m=l.lane,g=l.eventTime;if((n&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,x=l;switch(m=t,g=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(g,f,m);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,m=typeof v=="function"?v.call(g,f,m):v,m==null)break e;f=qt({},f,m);break e;case 2:Uo=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else g={eventTime:g,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=g,c=f):h=h.next=g,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Lc|=o,e.lanes=o,e.memoizedState=f}}function MS(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(_e(191,s));s.call(n)}}}var J0={},ui=Cl(J0),h0=Cl(J0),f0=Cl(J0);function dc(e){if(e===J0)throw Error(_e(174));return e}function cj(e,t){switch(At(f0,t),At(h0,e),At(ui,J0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Z_(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Z_(t,e)}Ot(ui),At(ui,t)}function wu(){Ot(ui),Ot(h0),Ot(f0)}function WF(e){dc(f0.current);var t=dc(ui.current),r=Z_(t,e.type);t!==r&&(At(h0,e),At(ui,r))}function dj(e){h0.current===e&&(Ot(ui),Ot(h0))}var Ut=Cl(0);function kx(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gv=[];function uj(){for(var e=0;e<gv.length;e++)gv[e]._workInProgressVersionPrimary=null;gv.length=0}var zg=so.ReactCurrentDispatcher,xv=so.ReactCurrentBatchConfig,Nc=0,Gt=null,vr=null,Ar=null,Sx=!1,If=!1,p0=0,QO=0;function Yr(){throw Error(_e(321))}function hj(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Pa(e[r],t[r]))return!1;return!0}function fj(e,t,r,n,s,i){if(Nc=i,Gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zg.current=e===null||e.memoizedState===null?tR:rR,e=r(n,s),If){i=0;do{if(If=!1,p0=0,25<=i)throw Error(_e(301));i+=1,Ar=vr=null,t.updateQueue=null,zg.current=nR,e=r(n,s)}while(If)}if(zg.current=Cx,t=vr!==null&&vr.next!==null,Nc=0,Ar=vr=Gt=null,Sx=!1,t)throw Error(_e(300));return e}function pj(){var e=p0!==0;return p0=0,e}function ei(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Gt.memoizedState=Ar=e:Ar=Ar.next=e,Ar}function ea(){if(vr===null){var e=Gt.alternate;e=e!==null?e.memoizedState:null}else e=vr.next;var t=Ar===null?Gt.memoizedState:Ar.next;if(t!==null)Ar=t,vr=e;else{if(e===null)throw Error(_e(310));vr=e,e={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},Ar===null?Gt.memoizedState=Ar=e:Ar=Ar.next=e}return Ar}function m0(e,t){return typeof t=="function"?t(e):t}function vv(e){var t=ea(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=vr,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var h=u.lane;if((Nc&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Gt.lanes|=h,Lc|=h}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Pa(n,t.memoizedState)||(Kn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Gt.lanes|=i,Lc|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function yv(e){var t=ea(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Pa(i,t.memoizedState)||(Kn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function GF(){}function qF(e,t){var r=Gt,n=ea(),s=t(),i=!Pa(n.memoizedState,s);if(i&&(n.memoizedState=s,Kn=!0),n=n.queue,mj(YF.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Ar!==null&&Ar.memoizedState.tag&1){if(r.flags|=2048,g0(9,XF.bind(null,r,n,s,t),void 0,null),Mr===null)throw Error(_e(349));Nc&30||KF(r,t,s)}return s}function KF(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Gt.updateQueue,t===null?(t={lastEffect:null,stores:null},Gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function XF(e,t,r,n){t.value=r,t.getSnapshot=n,QF(t)&&JF(e)}function YF(e,t,r){return r(function(){QF(t)&&JF(e)})}function QF(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Pa(e,r)}catch{return!0}}function JF(e){var t=to(e,1);t!==null&&Ta(t,e,1,-1)}function OS(e){var t=ei();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m0,lastRenderedState:e},t.queue=e,e=e.dispatch=eR.bind(null,Gt,e),[t.memoizedState,e]}function g0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Gt.updateQueue,t===null?(t={lastEffect:null,stores:null},Gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ZF(){return ea().memoizedState}function Bg(e,t,r,n){var s=ei();Gt.flags|=e,s.memoizedState=g0(1|t,r,void 0,n===void 0?null:n)}function p1(e,t,r,n){var s=ea();n=n===void 0?null:n;var i=void 0;if(vr!==null){var o=vr.memoizedState;if(i=o.destroy,n!==null&&hj(n,o.deps)){s.memoizedState=g0(t,r,i,n);return}}Gt.flags|=e,s.memoizedState=g0(1|t,r,i,n)}function RS(e,t){return Bg(8390656,8,e,t)}function mj(e,t){return p1(2048,8,e,t)}function e3(e,t){return p1(4,2,e,t)}function t3(e,t){return p1(4,4,e,t)}function r3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function n3(e,t,r){return r=r!=null?r.concat([e]):null,p1(4,4,r3.bind(null,t,e),r)}function gj(){}function s3(e,t){var r=ea();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hj(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function a3(e,t){var r=ea();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hj(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function i3(e,t,r){return Nc&21?(Pa(r,t)||(r=uF(),Gt.lanes|=r,Lc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kn=!0),e.memoizedState=r)}function JO(e,t){var r=St;St=r!==0&&4>r?r:4,e(!0);var n=xv.transition;xv.transition={};try{e(!1),t()}finally{St=r,xv.transition=n}}function o3(){return ea().memoizedState}function ZO(e,t,r){var n=fl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},l3(e))c3(t,r);else if(r=VF(e,t,r,n),r!==null){var s=En();Ta(r,e,n,s),d3(r,t,n)}}function eR(e,t,r){var n=fl(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(l3(e))c3(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Pa(l,o)){var c=t.interleaved;c===null?(s.next=s,oj(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=VF(e,t,s,n),r!==null&&(s=En(),Ta(r,e,n,s),d3(r,t,n))}}function l3(e){var t=e.alternate;return e===Gt||t!==null&&t===Gt}function c3(e,t){If=Sx=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function d3(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q2(e,r)}}var Cx={readContext:Zs,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},tR={readContext:Zs,useCallback:function(e,t){return ei().memoizedState=[e,t===void 0?null:t],e},useContext:Zs,useEffect:RS,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Bg(4194308,4,r3.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bg(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bg(4,2,e,t)},useMemo:function(e,t){var r=ei();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ei();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ZO.bind(null,Gt,e),[n.memoizedState,e]},useRef:function(e){var t=ei();return e={current:e},t.memoizedState=e},useState:OS,useDebugValue:gj,useDeferredValue:function(e){return ei().memoizedState=e},useTransition:function(){var e=OS(!1),t=e[0];return e=JO.bind(null,e[1]),ei().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Gt,s=ei();if(zt){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=t(),Mr===null)throw Error(_e(349));Nc&30||KF(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,RS(YF.bind(null,n,i,e),[e]),n.flags|=2048,g0(9,XF.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=ei(),t=Mr.identifierPrefix;if(zt){var r=Hi,n=Vi;r=(n&~(1<<32-$a(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=p0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=QO++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},rR={readContext:Zs,useCallback:s3,useContext:Zs,useEffect:mj,useImperativeHandle:n3,useInsertionEffect:e3,useLayoutEffect:t3,useMemo:a3,useReducer:vv,useRef:ZF,useState:function(){return vv(m0)},useDebugValue:gj,useDeferredValue:function(e){var t=ea();return i3(t,vr.memoizedState,e)},useTransition:function(){var e=vv(m0)[0],t=ea().memoizedState;return[e,t]},useMutableSource:GF,useSyncExternalStore:qF,useId:o3,unstable_isNewReconciler:!1},nR={readContext:Zs,useCallback:s3,useContext:Zs,useEffect:mj,useImperativeHandle:n3,useInsertionEffect:e3,useLayoutEffect:t3,useMemo:a3,useReducer:yv,useRef:ZF,useState:function(){return yv(m0)},useDebugValue:gj,useDeferredValue:function(e){var t=ea();return vr===null?t.memoizedState=e:i3(t,vr.memoizedState,e)},useTransition:function(){var e=yv(m0)[0],t=ea().memoizedState;return[e,t]},useMutableSource:GF,useSyncExternalStore:qF,useId:o3,unstable_isNewReconciler:!1};function ya(e,t){if(e&&e.defaultProps){t=qt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function bw(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:qt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var m1={isMounted:function(e){return(e=e._reactInternals)?Zc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=En(),s=fl(e),i=Ki(n,s);i.payload=t,r!=null&&(i.callback=r),t=ul(e,i,s),t!==null&&(Ta(t,e,s,n),Lg(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=En(),s=fl(e),i=Ki(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ul(e,i,s),t!==null&&(Ta(t,e,s,n),Lg(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=En(),n=fl(e),s=Ki(r,n);s.tag=2,t!=null&&(s.callback=t),t=ul(e,s,n),t!==null&&(Ta(t,e,n,r),Lg(t,e,n))}};function IS(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!l0(r,n)||!l0(s,i):!0}function u3(e,t,r){var n=!1,s=yl,i=t.contextType;return typeof i=="object"&&i!==null?i=Zs(i):(s=Qn(t)?Rc:hn.current,n=t.contextTypes,i=(n=n!=null)?yu(e,s):yl),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=m1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function NS(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&m1.enqueueReplaceState(t,t.state,null)}function _w(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},lj(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Zs(i):(i=Qn(t)?Rc:hn.current,s.context=yu(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(bw(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&m1.enqueueReplaceState(s,s.state,null),jx(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ju(e,t){try{var r="",n=t;do r+=FM(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function bv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ww(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sR=typeof WeakMap=="function"?WeakMap:Map;function h3(e,t,r){r=Ki(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Tx||(Tx=!0,Pw=n),ww(e,t)},r}function f3(e,t,r){r=Ki(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ww(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ww(e,t),typeof n!="function"&&(hl===null?hl=new Set([this]):hl.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function LS(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sR;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=vR.bind(null,e,t,r),t.then(e,e))}function zS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function BS(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ki(-1,1),t.tag=2,ul(r,t,1))),r.lanes|=1),e)}var aR=so.ReactCurrentOwner,Kn=!1;function Sn(e,t,r,n){t.child=e===null?UF(t,null,r,n):_u(t,e.child,r,n)}function US(e,t,r,n,s){r=r.render;var i=t.ref;return Jd(t,s),n=fj(e,t,r,n,i,s),r=pj(),e!==null&&!Kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ro(e,t,s)):(zt&&r&&tj(t),t.flags|=1,Sn(e,t,n,s),t.child)}function VS(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!kj(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,p3(e,t,i,n,s)):(e=Wg(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:l0,r(o,n)&&e.ref===t.ref)return ro(e,t,s)}return t.flags|=1,e=pl(i,n),e.ref=t.ref,e.return=t,t.child=e}function p3(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(l0(i,n)&&e.ref===t.ref)if(Kn=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Kn=!0);else return t.lanes=e.lanes,ro(e,t,s)}return jw(e,t,r,n,s)}function m3(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Hd,ds),ds|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,At(Hd,ds),ds|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,At(Hd,ds),ds|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,At(Hd,ds),ds|=n;return Sn(e,t,s,r),t.child}function g3(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function jw(e,t,r,n,s){var i=Qn(r)?Rc:hn.current;return i=yu(t,i),Jd(t,s),r=fj(e,t,r,n,i,s),n=pj(),e!==null&&!Kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ro(e,t,s)):(zt&&n&&tj(t),t.flags|=1,Sn(e,t,r,s),t.child)}function HS(e,t,r,n,s){if(Qn(r)){var i=!0;vx(t)}else i=!1;if(Jd(t,s),t.stateNode===null)Ug(e,t),u3(t,r,n),_w(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zs(u):(u=Qn(r)?Rc:hn.current,u=yu(t,u));var h=r.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&NS(t,o,n,u),Uo=!1;var m=t.memoizedState;o.state=m,jx(t,n,o,s),c=t.memoizedState,l!==n||m!==c||Yn.current||Uo?(typeof h=="function"&&(bw(t,r,h,n),c=t.memoizedState),(l=Uo||IS(t,r,l,n,m,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,HF(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ya(t.type,l),o.props=u,f=t.pendingProps,m=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zs(c):(c=Qn(r)?Rc:hn.current,c=yu(t,c));var g=r.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&NS(t,o,n,c),Uo=!1,m=t.memoizedState,o.state=m,jx(t,n,o,s);var v=t.memoizedState;l!==f||m!==v||Yn.current||Uo?(typeof g=="function"&&(bw(t,r,g,n),v=t.memoizedState),(u=Uo||IS(t,r,u,n,m,v,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return kw(e,t,r,n,i,s)}function kw(e,t,r,n,s,i){g3(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&ES(t,r,!1),ro(e,t,i);n=t.stateNode,aR.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=_u(t,e.child,null,i),t.child=_u(t,null,l,i)):Sn(e,t,l,i),t.memoizedState=n.state,s&&ES(t,r,!0),t.child}function x3(e){var t=e.stateNode;t.pendingContext?TS(e,t.pendingContext,t.pendingContext!==t.context):t.context&&TS(e,t.context,!1),cj(e,t.containerInfo)}function WS(e,t,r,n,s){return bu(),nj(s),t.flags|=256,Sn(e,t,r,n),t.child}var Sw={dehydrated:null,treeContext:null,retryLane:0};function Cw(e){return{baseLanes:e,cachePool:null,transitions:null}}function v3(e,t,r){var n=t.pendingProps,s=Ut.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),At(Ut,s&1),e===null)return vw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=v1(o,n,0,null),e=Cc(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Cw(r),t.memoizedState=Sw,e):xj(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return iR(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=pl(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=pl(l,i):(i=Cc(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Cw(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Sw,n}return i=e.child,e=i.sibling,n=pl(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function xj(e,t){return t=v1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Fp(e,t,r,n){return n!==null&&nj(n),_u(t,e.child,null,r),e=xj(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function iR(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=bv(Error(_e(422))),Fp(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=v1({mode:"visible",children:n.children},s,0,null),i=Cc(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&_u(t,e.child,null,o),t.child.memoizedState=Cw(o),t.memoizedState=Sw,i);if(!(t.mode&1))return Fp(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(_e(419)),n=bv(i,n,void 0),Fp(e,t,o,n)}if(l=(o&e.childLanes)!==0,Kn||l){if(n=Mr,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,to(e,s),Ta(n,e,s,-1))}return jj(),n=bv(Error(_e(421))),Fp(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=yR.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,gs=dl(s.nextSibling),vs=t,zt=!0,ja=null,e!==null&&(qs[Ks++]=Vi,qs[Ks++]=Hi,qs[Ks++]=Ic,Vi=e.id,Hi=e.overflow,Ic=t),t=xj(t,n.children),t.flags|=4096,t)}function GS(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),yw(e.return,t,r)}function _v(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function y3(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Sn(e,t,n.children,r),n=Ut.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&GS(e,r,t);else if(e.tag===19)GS(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(At(Ut,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&kx(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),_v(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&kx(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}_v(t,!0,r,null,i);break;case"together":_v(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ug(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ro(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Lc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_e(153));if(t.child!==null){for(e=t.child,r=pl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=pl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function oR(e,t,r){switch(t.tag){case 3:x3(t),bu();break;case 5:WF(t);break;case 1:Qn(t.type)&&vx(t);break;case 4:cj(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;At(_x,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(At(Ut,Ut.current&1),t.flags|=128,null):r&t.child.childLanes?v3(e,t,r):(At(Ut,Ut.current&1),e=ro(e,t,r),e!==null?e.sibling:null);At(Ut,Ut.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return y3(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),At(Ut,Ut.current),n)break;return null;case 22:case 23:return t.lanes=0,m3(e,t,r)}return ro(e,t,r)}var b3,$w,_3,w3;b3=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$w=function(){};_3=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,dc(ui.current);var i=null;switch(r){case"input":s=X_(e,s),n=X_(e,n),i=[];break;case"select":s=qt({},s,{value:void 0}),n=qt({},n,{value:void 0}),i=[];break;case"textarea":s=J_(e,s),n=J_(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=gx)}ew(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(t0.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(t0.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ft("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};w3=function(e,t,r,n){r!==n&&(t.flags|=4)};function ch(e,t){if(!zt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function lR(e,t,r){var n=t.pendingProps;switch(rj(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(t),null;case 1:return Qn(t.type)&&xx(),Qr(t),null;case 3:return n=t.stateNode,wu(),Ot(Yn),Ot(hn),uj(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ep(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ja!==null&&(Ow(ja),ja=null))),$w(e,t),Qr(t),null;case 5:dj(t);var s=dc(f0.current);if(r=t.type,e!==null&&t.stateNode!=null)_3(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(_e(166));return Qr(t),null}if(e=dc(ui.current),Ep(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[oi]=t,n[u0]=i,e=(t.mode&1)!==0,r){case"dialog":Ft("cancel",n),Ft("close",n);break;case"iframe":case"object":case"embed":Ft("load",n);break;case"video":case"audio":for(s=0;s<jf.length;s++)Ft(jf[s],n);break;case"source":Ft("error",n);break;case"img":case"image":case"link":Ft("error",n),Ft("load",n);break;case"details":Ft("toggle",n);break;case"input":tS(n,i),Ft("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ft("invalid",n);break;case"textarea":nS(n,i),Ft("invalid",n)}ew(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Tp(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Tp(n.textContent,l,e),s=["children",""+l]):t0.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ft("scroll",n)}switch(r){case"input":bp(n),rS(n,i,!0);break;case"textarea":bp(n),sS(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=gx)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=YA(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[oi]=t,e[u0]=n,b3(e,t,!1,!1),t.stateNode=e;e:{switch(o=tw(r,n),r){case"dialog":Ft("cancel",e),Ft("close",e),s=n;break;case"iframe":case"object":case"embed":Ft("load",e),s=n;break;case"video":case"audio":for(s=0;s<jf.length;s++)Ft(jf[s],e);s=n;break;case"source":Ft("error",e),s=n;break;case"img":case"image":case"link":Ft("error",e),Ft("load",e),s=n;break;case"details":Ft("toggle",e),s=n;break;case"input":tS(e,n),s=X_(e,n),Ft("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=qt({},n,{value:void 0}),Ft("invalid",e);break;case"textarea":nS(e,n),s=J_(e,n),Ft("invalid",e);break;default:s=n}ew(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?ZA(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&QA(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&r0(e,c):typeof c=="number"&&r0(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(t0.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ft("scroll",e):c!=null&&B2(e,i,c,o))}switch(r){case"input":bp(e),rS(e,n,!1);break;case"textarea":bp(e),sS(e);break;case"option":n.value!=null&&e.setAttribute("value",""+vl(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Kd(e,!!n.multiple,i,!1):n.defaultValue!=null&&Kd(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=gx)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qr(t),null;case 6:if(e&&t.stateNode!=null)w3(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(_e(166));if(r=dc(f0.current),dc(ui.current),Ep(t)){if(n=t.stateNode,r=t.memoizedProps,n[oi]=t,(i=n.nodeValue!==r)&&(e=vs,e!==null))switch(e.tag){case 3:Tp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tp(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[oi]=t,t.stateNode=n}return Qr(t),null;case 13:if(Ot(Ut),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(zt&&gs!==null&&t.mode&1&&!(t.flags&128))zF(),bu(),t.flags|=98560,i=!1;else if(i=Ep(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(_e(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_e(317));i[oi]=t}else bu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qr(t),i=!1}else ja!==null&&(Ow(ja),ja=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ut.current&1?_r===0&&(_r=3):jj())),t.updateQueue!==null&&(t.flags|=4),Qr(t),null);case 4:return wu(),$w(e,t),e===null&&c0(t.stateNode.containerInfo),Qr(t),null;case 10:return ij(t.type._context),Qr(t),null;case 17:return Qn(t.type)&&xx(),Qr(t),null;case 19:if(Ot(Ut),i=t.memoizedState,i===null)return Qr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)ch(i,!1);else{if(_r!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=kx(e),o!==null){for(t.flags|=128,ch(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return At(Ut,Ut.current&1|2),t.child}e=e.sibling}i.tail!==null&&nr()>ku&&(t.flags|=128,n=!0,ch(i,!1),t.lanes=4194304)}else{if(!n)if(e=kx(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ch(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!zt)return Qr(t),null}else 2*nr()-i.renderingStartTime>ku&&r!==1073741824&&(t.flags|=128,n=!0,ch(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nr(),t.sibling=null,r=Ut.current,At(Ut,n?r&1|2:r&1),t):(Qr(t),null);case 22:case 23:return wj(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ds&1073741824&&(Qr(t),t.subtreeFlags&6&&(t.flags|=8192)):Qr(t),null;case 24:return null;case 25:return null}throw Error(_e(156,t.tag))}function cR(e,t){switch(rj(t),t.tag){case 1:return Qn(t.type)&&xx(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return wu(),Ot(Yn),Ot(hn),uj(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dj(t),null;case 13:if(Ot(Ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_e(340));bu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ot(Ut),null;case 4:return wu(),null;case 10:return ij(t.type._context),null;case 22:case 23:return wj(),null;case 24:return null;default:return null}}var Pp=!1,rn=!1,dR=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Vd(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Yt(e,t,n)}else r.current=null}function Tw(e,t,r){try{r()}catch(n){Yt(e,t,n)}}var qS=!1;function uR(e,t){if(uw=fx,e=$F(),ej(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,m=null;t:for(;;){for(var g;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==i||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)m=f,f=g;for(;;){if(f===e)break t;if(m===r&&++u===s&&(l=o),m===i&&++h===n&&(c=o),(g=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=g}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(hw={focusedElem:e,selectionRange:r},fx=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,_=t.stateNode,b=_.getSnapshotBeforeUpdate(t.elementType===t.type?x:ya(t.type,x),y);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(C){Yt(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return v=qS,qS=!1,v}function Nf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Tw(t,r,i)}s=s.next}while(s!==n)}}function g1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ew(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function j3(e){var t=e.alternate;t!==null&&(e.alternate=null,j3(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[oi],delete t[u0],delete t[mw],delete t[qO],delete t[KO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function k3(e){return e.tag===5||e.tag===3||e.tag===4}function KS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||k3(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Aw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=gx));else if(n!==4&&(e=e.child,e!==null))for(Aw(e,t,r),e=e.sibling;e!==null;)Aw(e,t,r),e=e.sibling}function Fw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Fw(e,t,r),e=e.sibling;e!==null;)Fw(e,t,r),e=e.sibling}var Ur=null,wa=!1;function ho(e,t,r){for(r=r.child;r!==null;)S3(e,t,r),r=r.sibling}function S3(e,t,r){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(l1,r)}catch{}switch(r.tag){case 5:rn||Vd(r,t);case 6:var n=Ur,s=wa;Ur=null,ho(e,t,r),Ur=n,wa=s,Ur!==null&&(wa?(e=Ur,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ur.removeChild(r.stateNode));break;case 18:Ur!==null&&(wa?(e=Ur,r=r.stateNode,e.nodeType===8?pv(e.parentNode,r):e.nodeType===1&&pv(e,r),i0(e)):pv(Ur,r.stateNode));break;case 4:n=Ur,s=wa,Ur=r.stateNode.containerInfo,wa=!0,ho(e,t,r),Ur=n,wa=s;break;case 0:case 11:case 14:case 15:if(!rn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Tw(r,t,o),s=s.next}while(s!==n)}ho(e,t,r);break;case 1:if(!rn&&(Vd(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Yt(r,t,l)}ho(e,t,r);break;case 21:ho(e,t,r);break;case 22:r.mode&1?(rn=(n=rn)||r.memoizedState!==null,ho(e,t,r),rn=n):ho(e,t,r);break;default:ho(e,t,r)}}function XS(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dR),t.forEach(function(n){var s=bR.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ca(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ur=l.stateNode,wa=!1;break e;case 3:Ur=l.stateNode.containerInfo,wa=!0;break e;case 4:Ur=l.stateNode.containerInfo,wa=!0;break e}l=l.return}if(Ur===null)throw Error(_e(160));S3(i,o,s),Ur=null,wa=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Yt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)C3(t,e),t=t.sibling}function C3(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ca(t,e),Na(e),n&4){try{Nf(3,e,e.return),g1(3,e)}catch(x){Yt(e,e.return,x)}try{Nf(5,e,e.return)}catch(x){Yt(e,e.return,x)}}break;case 1:ca(t,e),Na(e),n&512&&r!==null&&Vd(r,r.return);break;case 5:if(ca(t,e),Na(e),n&512&&r!==null&&Vd(r,r.return),e.flags&32){var s=e.stateNode;try{r0(s,"")}catch(x){Yt(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&KA(s,i),tw(l,o);var u=tw(l,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?ZA(s,f):h==="dangerouslySetInnerHTML"?QA(s,f):h==="children"?r0(s,f):B2(s,h,f,u)}switch(l){case"input":Y_(s,i);break;case"textarea":XA(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Kd(s,!!i.multiple,g,!1):m!==!!i.multiple&&(i.defaultValue!=null?Kd(s,!!i.multiple,i.defaultValue,!0):Kd(s,!!i.multiple,i.multiple?[]:"",!1))}s[u0]=i}catch(x){Yt(e,e.return,x)}}break;case 6:if(ca(t,e),Na(e),n&4){if(e.stateNode===null)throw Error(_e(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(x){Yt(e,e.return,x)}}break;case 3:if(ca(t,e),Na(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{i0(t.containerInfo)}catch(x){Yt(e,e.return,x)}break;case 4:ca(t,e),Na(e);break;case 13:ca(t,e),Na(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(bj=nr())),n&4&&XS(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(rn=(u=rn)||h,ca(t,e),rn=u):ca(t,e),Na(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(Ae=e,h=e.child;h!==null;){for(f=Ae=h;Ae!==null;){switch(m=Ae,g=m.child,m.tag){case 0:case 11:case 14:case 15:Nf(4,m,m.return);break;case 1:Vd(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){Yt(n,r,x)}}break;case 5:Vd(m,m.return);break;case 22:if(m.memoizedState!==null){QS(f);continue}}g!==null?(g.return=m,Ae=g):QS(f)}h=h.sibling}e:for(h=null,f=e;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=JA("display",o))}catch(x){Yt(e,e.return,x)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){Yt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ca(t,e),Na(e),n&4&&XS(e);break;case 21:break;default:ca(t,e),Na(e)}}function Na(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(k3(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(r0(s,""),n.flags&=-33);var i=KS(e);Fw(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=KS(e);Aw(e,l,o);break;default:throw Error(_e(161))}}catch(c){Yt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hR(e,t,r){Ae=e,$3(e)}function $3(e,t,r){for(var n=(e.mode&1)!==0;Ae!==null;){var s=Ae,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Pp;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||rn;l=Pp;var u=rn;if(Pp=o,(rn=c)&&!u)for(Ae=s;Ae!==null;)o=Ae,c=o.child,o.tag===22&&o.memoizedState!==null?JS(s):c!==null?(c.return=o,Ae=c):JS(s);for(;i!==null;)Ae=i,$3(i),i=i.sibling;Ae=s,Pp=l,rn=u}YS(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ae=i):YS(e)}}function YS(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rn||g1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!rn)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ya(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&MS(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}MS(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&i0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}rn||t.flags&512&&Ew(t)}catch(m){Yt(t,t.return,m)}}if(t===e){Ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function QS(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function JS(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{g1(4,t)}catch(c){Yt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Yt(t,s,c)}}var i=t.return;try{Ew(t)}catch(c){Yt(t,i,c)}break;case 5:var o=t.return;try{Ew(t)}catch(c){Yt(t,o,c)}}}catch(c){Yt(t,t.return,c)}if(t===e){Ae=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ae=l;break}Ae=t.return}}var fR=Math.ceil,$x=so.ReactCurrentDispatcher,vj=so.ReactCurrentOwner,Qs=so.ReactCurrentBatchConfig,ot=0,Mr=null,fr=null,Wr=0,ds=0,Hd=Cl(0),_r=0,x0=null,Lc=0,x1=0,yj=0,Lf=null,Gn=null,bj=0,ku=1/0,Mi=null,Tx=!1,Pw=null,hl=null,Dp=!1,tl=null,Ex=0,zf=0,Dw=null,Vg=-1,Hg=0;function En(){return ot&6?nr():Vg!==-1?Vg:Vg=nr()}function fl(e){return e.mode&1?ot&2&&Wr!==0?Wr&-Wr:YO.transition!==null?(Hg===0&&(Hg=uF()),Hg):(e=St,e!==0||(e=window.event,e=e===void 0?16:vF(e.type)),e):1}function Ta(e,t,r,n){if(50<zf)throw zf=0,Dw=null,Error(_e(185));X0(e,r,n),(!(ot&2)||e!==Mr)&&(e===Mr&&(!(ot&2)&&(x1|=r),_r===4&&Ho(e,Wr)),Jn(e,n),r===1&&ot===0&&!(t.mode&1)&&(ku=nr()+500,f1&&$l()))}function Jn(e,t){var r=e.callbackNode;YM(e,t);var n=hx(e,e===Mr?Wr:0);if(n===0)r!==null&&oS(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&oS(r),t===1)e.tag===0?XO(ZS.bind(null,e)):IF(ZS.bind(null,e)),WO(function(){!(ot&6)&&$l()}),r=null;else{switch(hF(n)){case 1:r=G2;break;case 4:r=cF;break;case 16:r=ux;break;case 536870912:r=dF;break;default:r=ux}r=O3(r,T3.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function T3(e,t){if(Vg=-1,Hg=0,ot&6)throw Error(_e(327));var r=e.callbackNode;if(Zd()&&e.callbackNode!==r)return null;var n=hx(e,e===Mr?Wr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ax(e,n);else{t=n;var s=ot;ot|=2;var i=A3();(Mr!==e||Wr!==t)&&(Mi=null,ku=nr()+500,Sc(e,t));do try{gR();break}catch(l){E3(e,l)}while(!0);aj(),$x.current=i,ot=s,fr!==null?t=0:(Mr=null,Wr=0,t=_r)}if(t!==0){if(t===2&&(s=iw(e),s!==0&&(n=s,t=Mw(e,s))),t===1)throw r=x0,Sc(e,0),Ho(e,n),Jn(e,nr()),r;if(t===6)Ho(e,n);else{if(s=e.current.alternate,!(n&30)&&!pR(s)&&(t=Ax(e,n),t===2&&(i=iw(e),i!==0&&(n=i,t=Mw(e,i))),t===1))throw r=x0,Sc(e,0),Ho(e,n),Jn(e,nr()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(_e(345));case 2:sc(e,Gn,Mi);break;case 3:if(Ho(e,n),(n&130023424)===n&&(t=bj+500-nr(),10<t)){if(hx(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){En(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=pw(sc.bind(null,e,Gn,Mi),t);break}sc(e,Gn,Mi);break;case 4:if(Ho(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-$a(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=nr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*fR(n/1960))-n,10<n){e.timeoutHandle=pw(sc.bind(null,e,Gn,Mi),n);break}sc(e,Gn,Mi);break;case 5:sc(e,Gn,Mi);break;default:throw Error(_e(329))}}}return Jn(e,nr()),e.callbackNode===r?T3.bind(null,e):null}function Mw(e,t){var r=Lf;return e.current.memoizedState.isDehydrated&&(Sc(e,t).flags|=256),e=Ax(e,t),e!==2&&(t=Gn,Gn=r,t!==null&&Ow(t)),e}function Ow(e){Gn===null?Gn=e:Gn.push.apply(Gn,e)}function pR(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Pa(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ho(e,t){for(t&=~yj,t&=~x1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-$a(t),n=1<<r;e[r]=-1,t&=~n}}function ZS(e){if(ot&6)throw Error(_e(327));Zd();var t=hx(e,0);if(!(t&1))return Jn(e,nr()),null;var r=Ax(e,t);if(e.tag!==0&&r===2){var n=iw(e);n!==0&&(t=n,r=Mw(e,n))}if(r===1)throw r=x0,Sc(e,0),Ho(e,t),Jn(e,nr()),r;if(r===6)throw Error(_e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sc(e,Gn,Mi),Jn(e,nr()),null}function _j(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(ku=nr()+500,f1&&$l())}}function zc(e){tl!==null&&tl.tag===0&&!(ot&6)&&Zd();var t=ot;ot|=1;var r=Qs.transition,n=St;try{if(Qs.transition=null,St=1,e)return e()}finally{St=n,Qs.transition=r,ot=t,!(ot&6)&&$l()}}function wj(){ds=Hd.current,Ot(Hd)}function Sc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,HO(r)),fr!==null)for(r=fr.return;r!==null;){var n=r;switch(rj(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&xx();break;case 3:wu(),Ot(Yn),Ot(hn),uj();break;case 5:dj(n);break;case 4:wu();break;case 13:Ot(Ut);break;case 19:Ot(Ut);break;case 10:ij(n.type._context);break;case 22:case 23:wj()}r=r.return}if(Mr=e,fr=e=pl(e.current,null),Wr=ds=t,_r=0,x0=null,yj=x1=Lc=0,Gn=Lf=null,cc!==null){for(t=0;t<cc.length;t++)if(r=cc[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}cc=null}return e}function E3(e,t){do{var r=fr;try{if(aj(),zg.current=Cx,Sx){for(var n=Gt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Sx=!1}if(Nc=0,Ar=vr=Gt=null,If=!1,p0=0,vj.current=null,r===null||r.return===null){_r=1,x0=t,fr=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Wr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=zS(o);if(g!==null){g.flags&=-257,BS(g,o,l,i,t),g.mode&1&&LS(i,u,t),t=g,c=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){LS(i,u,t),jj();break e}c=Error(_e(426))}}else if(zt&&l.mode&1){var y=zS(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),BS(y,o,l,i,t),nj(ju(c,l));break e}}i=c=ju(c,l),_r!==4&&(_r=2),Lf===null?Lf=[i]:Lf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var _=h3(i,c,t);DS(i,_);break e;case 1:l=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(hl===null||!hl.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var C=f3(i,l,t);DS(i,C);break e}}i=i.return}while(i!==null)}P3(r)}catch(j){t=j,fr===r&&r!==null&&(fr=r=r.return);continue}break}while(!0)}function A3(){var e=$x.current;return $x.current=Cx,e===null?Cx:e}function jj(){(_r===0||_r===3||_r===2)&&(_r=4),Mr===null||!(Lc&268435455)&&!(x1&268435455)||Ho(Mr,Wr)}function Ax(e,t){var r=ot;ot|=2;var n=A3();(Mr!==e||Wr!==t)&&(Mi=null,Sc(e,t));do try{mR();break}catch(s){E3(e,s)}while(!0);if(aj(),ot=r,$x.current=n,fr!==null)throw Error(_e(261));return Mr=null,Wr=0,_r}function mR(){for(;fr!==null;)F3(fr)}function gR(){for(;fr!==null&&!BM();)F3(fr)}function F3(e){var t=M3(e.alternate,e,ds);e.memoizedProps=e.pendingProps,t===null?P3(e):fr=t,vj.current=null}function P3(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=cR(r,t),r!==null){r.flags&=32767,fr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_r=6,fr=null;return}}else if(r=lR(r,t,ds),r!==null){fr=r;return}if(t=t.sibling,t!==null){fr=t;return}fr=t=e}while(t!==null);_r===0&&(_r=5)}function sc(e,t,r){var n=St,s=Qs.transition;try{Qs.transition=null,St=1,xR(e,t,r,n)}finally{Qs.transition=s,St=n}return null}function xR(e,t,r,n){do Zd();while(tl!==null);if(ot&6)throw Error(_e(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_e(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(QM(e,i),e===Mr&&(fr=Mr=null,Wr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Dp||(Dp=!0,O3(ux,function(){return Zd(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Qs.transition,Qs.transition=null;var o=St;St=1;var l=ot;ot|=4,vj.current=null,uR(e,r),C3(r,e),IO(hw),fx=!!uw,hw=uw=null,e.current=r,hR(r),UM(),ot=l,St=o,Qs.transition=i}else e.current=r;if(Dp&&(Dp=!1,tl=e,Ex=s),i=e.pendingLanes,i===0&&(hl=null),WM(r.stateNode),Jn(e,nr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Tx)throw Tx=!1,e=Pw,Pw=null,e;return Ex&1&&e.tag!==0&&Zd(),i=e.pendingLanes,i&1?e===Dw?zf++:(zf=0,Dw=e):zf=0,$l(),null}function Zd(){if(tl!==null){var e=hF(Ex),t=Qs.transition,r=St;try{if(Qs.transition=null,St=16>e?16:e,tl===null)var n=!1;else{if(e=tl,tl=null,Ex=0,ot&6)throw Error(_e(331));var s=ot;for(ot|=4,Ae=e.current;Ae!==null;){var i=Ae,o=i.child;if(Ae.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ae=u;Ae!==null;){var h=Ae;switch(h.tag){case 0:case 11:case 15:Nf(8,h,i)}var f=h.child;if(f!==null)f.return=h,Ae=f;else for(;Ae!==null;){h=Ae;var m=h.sibling,g=h.return;if(j3(h),h===u){Ae=null;break}if(m!==null){m.return=g,Ae=m;break}Ae=g}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}Ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ae=o;else e:for(;Ae!==null;){if(i=Ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Nf(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Ae=_;break e}Ae=i.return}}var b=e.current;for(Ae=b;Ae!==null;){o=Ae;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ae=w;else e:for(o=b;Ae!==null;){if(l=Ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:g1(9,l)}}catch(j){Yt(l,l.return,j)}if(l===o){Ae=null;break e}var C=l.sibling;if(C!==null){C.return=l.return,Ae=C;break e}Ae=l.return}}if(ot=s,$l(),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(l1,e)}catch{}n=!0}return n}finally{St=r,Qs.transition=t}}return!1}function eC(e,t,r){t=ju(r,t),t=h3(e,t,1),e=ul(e,t,1),t=En(),e!==null&&(X0(e,1,t),Jn(e,t))}function Yt(e,t,r){if(e.tag===3)eC(e,e,r);else for(;t!==null;){if(t.tag===3){eC(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hl===null||!hl.has(n))){e=ju(r,e),e=f3(t,e,1),t=ul(t,e,1),e=En(),t!==null&&(X0(t,1,e),Jn(t,e));break}}t=t.return}}function vR(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=En(),e.pingedLanes|=e.suspendedLanes&r,Mr===e&&(Wr&r)===r&&(_r===4||_r===3&&(Wr&130023424)===Wr&&500>nr()-bj?Sc(e,0):yj|=r),Jn(e,t)}function D3(e,t){t===0&&(e.mode&1?(t=jp,jp<<=1,!(jp&130023424)&&(jp=4194304)):t=1);var r=En();e=to(e,t),e!==null&&(X0(e,t,r),Jn(e,r))}function yR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),D3(e,r)}function bR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(t),D3(e,r)}var M3;M3=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yn.current)Kn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Kn=!1,oR(e,t,r);Kn=!!(e.flags&131072)}else Kn=!1,zt&&t.flags&1048576&&NF(t,bx,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ug(e,t),e=t.pendingProps;var s=yu(t,hn.current);Jd(t,r),s=fj(null,t,n,e,s,r);var i=pj();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qn(n)?(i=!0,vx(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,lj(t),s.updater=m1,t.stateNode=s,s._reactInternals=t,_w(t,n,e,r),t=kw(null,t,n,!0,i,r)):(t.tag=0,zt&&i&&tj(t),Sn(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ug(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=wR(n),e=ya(n,e),s){case 0:t=jw(null,t,n,e,r);break e;case 1:t=HS(null,t,n,e,r);break e;case 11:t=US(null,t,n,e,r);break e;case 14:t=VS(null,t,n,ya(n.type,e),r);break e}throw Error(_e(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ya(n,s),jw(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ya(n,s),HS(e,t,n,s,r);case 3:e:{if(x3(t),e===null)throw Error(_e(387));n=t.pendingProps,i=t.memoizedState,s=i.element,HF(e,t),jx(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ju(Error(_e(423)),t),t=WS(e,t,n,r,s);break e}else if(n!==s){s=ju(Error(_e(424)),t),t=WS(e,t,n,r,s);break e}else for(gs=dl(t.stateNode.containerInfo.firstChild),vs=t,zt=!0,ja=null,r=UF(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bu(),n===s){t=ro(e,t,r);break e}Sn(e,t,n,r)}t=t.child}return t;case 5:return WF(t),e===null&&vw(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,fw(n,s)?o=null:i!==null&&fw(n,i)&&(t.flags|=32),g3(e,t),Sn(e,t,o,r),t.child;case 6:return e===null&&vw(t),null;case 13:return v3(e,t,r);case 4:return cj(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=_u(t,null,n,r):Sn(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ya(n,s),US(e,t,n,s,r);case 7:return Sn(e,t,t.pendingProps,r),t.child;case 8:return Sn(e,t,t.pendingProps.children,r),t.child;case 12:return Sn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,At(_x,n._currentValue),n._currentValue=o,i!==null)if(Pa(i.value,o)){if(i.children===s.children&&!Yn.current){t=ro(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Ki(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),yw(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(_e(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),yw(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Sn(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Jd(t,r),s=Zs(s),n=n(s),t.flags|=1,Sn(e,t,n,r),t.child;case 14:return n=t.type,s=ya(n,t.pendingProps),s=ya(n.type,s),VS(e,t,n,s,r);case 15:return p3(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ya(n,s),Ug(e,t),t.tag=1,Qn(n)?(e=!0,vx(t)):e=!1,Jd(t,r),u3(t,n,s),_w(t,n,s,r),kw(null,t,n,!0,e,r);case 19:return y3(e,t,r);case 22:return m3(e,t,r)}throw Error(_e(156,t.tag))};function O3(e,t){return lF(e,t)}function _R(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xs(e,t,r,n){return new _R(e,t,r,n)}function kj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wR(e){if(typeof e=="function")return kj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===V2)return 11;if(e===H2)return 14}return 2}function pl(e,t){var r=e.alternate;return r===null?(r=Xs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Wg(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")kj(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Md:return Cc(r.children,s,i,t);case U2:o=8,s|=8;break;case W_:return e=Xs(12,r,t,s|2),e.elementType=W_,e.lanes=i,e;case G_:return e=Xs(13,r,t,s),e.elementType=G_,e.lanes=i,e;case q_:return e=Xs(19,r,t,s),e.elementType=q_,e.lanes=i,e;case WA:return v1(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case VA:o=10;break e;case HA:o=9;break e;case V2:o=11;break e;case H2:o=14;break e;case Bo:o=16,n=null;break e}throw Error(_e(130,e==null?e:typeof e,""))}return t=Xs(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Cc(e,t,r,n){return e=Xs(7,e,n,t),e.lanes=r,e}function v1(e,t,r,n){return e=Xs(22,e,n,t),e.elementType=WA,e.lanes=r,e.stateNode={isHidden:!1},e}function wv(e,t,r){return e=Xs(6,e,null,t),e.lanes=r,e}function jv(e,t,r){return t=Xs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jR(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nv(0),this.expirationTimes=nv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nv(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Sj(e,t,r,n,s,i,o,l,c){return e=new jR(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Xs(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},lj(i),e}function kR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function R3(e){if(!e)return yl;e=e._reactInternals;e:{if(Zc(e)!==e||e.tag!==1)throw Error(_e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_e(171))}if(e.tag===1){var r=e.type;if(Qn(r))return RF(e,r,t)}return t}function I3(e,t,r,n,s,i,o,l,c){return e=Sj(r,n,!0,e,s,i,o,l,c),e.context=R3(null),r=e.current,n=En(),s=fl(r),i=Ki(n,s),i.callback=t??null,ul(r,i,s),e.current.lanes=s,X0(e,s,n),Jn(e,n),e}function y1(e,t,r,n){var s=t.current,i=En(),o=fl(s);return r=R3(r),t.context===null?t.context=r:t.pendingContext=r,t=Ki(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ul(s,t,o),e!==null&&(Ta(e,s,o,i),Lg(e,s,o)),o}function Fx(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Cj(e,t){tC(e,t),(e=e.alternate)&&tC(e,t)}function SR(){return null}var N3=typeof reportError=="function"?reportError:function(e){console.error(e)};function $j(e){this._internalRoot=e}b1.prototype.render=$j.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_e(409));y1(e,t,null,null)};b1.prototype.unmount=$j.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zc(function(){y1(null,e,null,null)}),t[eo]=null}};function b1(e){this._internalRoot=e}b1.prototype.unstable_scheduleHydration=function(e){if(e){var t=mF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vo.length&&t!==0&&t<Vo[r].priority;r++);Vo.splice(r,0,e),r===0&&xF(e)}};function Tj(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rC(){}function CR(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Fx(o);i.call(u)}}var o=I3(t,n,e,0,null,!1,!1,"",rC);return e._reactRootContainer=o,e[eo]=o.current,c0(e.nodeType===8?e.parentNode:e),zc(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Fx(c);l.call(u)}}var c=Sj(e,0,!1,null,null,!1,!1,"",rC);return e._reactRootContainer=c,e[eo]=c.current,c0(e.nodeType===8?e.parentNode:e),zc(function(){y1(t,c,r,n)}),c}function w1(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Fx(o);l.call(c)}}y1(t,o,e,s)}else o=CR(r,t,e,s,n);return Fx(o)}fF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=wf(t.pendingLanes);r!==0&&(q2(t,r|1),Jn(t,nr()),!(ot&6)&&(ku=nr()+500,$l()))}break;case 13:zc(function(){var n=to(e,1);if(n!==null){var s=En();Ta(n,e,1,s)}}),Cj(e,1)}};K2=function(e){if(e.tag===13){var t=to(e,134217728);if(t!==null){var r=En();Ta(t,e,134217728,r)}Cj(e,134217728)}};pF=function(e){if(e.tag===13){var t=fl(e),r=to(e,t);if(r!==null){var n=En();Ta(r,e,t,n)}Cj(e,t)}};mF=function(){return St};gF=function(e,t){var r=St;try{return St=e,t()}finally{St=r}};nw=function(e,t,r){switch(t){case"input":if(Y_(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=h1(n);if(!s)throw Error(_e(90));qA(n),Y_(n,s)}}}break;case"textarea":XA(e,r);break;case"select":t=r.value,t!=null&&Kd(e,!!r.multiple,t,!1)}};rF=_j;nF=zc;var $R={usingClientEntryPoint:!1,Events:[Q0,Nd,h1,eF,tF,_j]},dh={findFiberByHostInstance:lc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TR={bundleType:dh.bundleType,version:dh.version,rendererPackageName:dh.rendererPackageName,rendererConfig:dh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:so.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=iF(e),e===null?null:e.stateNode},findFiberByHostInstance:dh.findFiberByHostInstance||SR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mp.isDisabled&&Mp.supportsFiber)try{l1=Mp.inject(TR),di=Mp}catch{}}_s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$R;_s.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tj(t))throw Error(_e(200));return kR(e,t,null,r)};_s.createRoot=function(e,t){if(!Tj(e))throw Error(_e(299));var r=!1,n="",s=N3;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Sj(e,1,!1,null,null,r,!1,n,s),e[eo]=t.current,c0(e.nodeType===8?e.parentNode:e),new $j(t)};_s.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_e(188)):(e=Object.keys(e).join(","),Error(_e(268,e)));return e=iF(t),e=e===null?null:e.stateNode,e};_s.flushSync=function(e){return zc(e)};_s.hydrate=function(e,t,r){if(!_1(t))throw Error(_e(200));return w1(null,e,t,!0,r)};_s.hydrateRoot=function(e,t,r){if(!Tj(e))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=N3;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=I3(t,null,e,1,r??null,s,!1,i,o),e[eo]=t.current,c0(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new b1(t)};_s.render=function(e,t,r){if(!_1(t))throw Error(_e(200));return w1(null,e,t,!1,r)};_s.unmountComponentAtNode=function(e){if(!_1(e))throw Error(_e(40));return e._reactRootContainer?(zc(function(){w1(null,null,e,!1,function(){e._reactRootContainer=null,e[eo]=null})}),!0):!1};_s.unstable_batchedUpdates=_j;_s.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!_1(r))throw Error(_e(200));if(e==null||e._reactInternals===void 0)throw Error(_e(38));return w1(e,t,r,!1,n)};_s.version="18.3.1-next-f1338f8080-20240426";function L3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L3)}catch(e){console.error(e)}}L3(),LA.exports=_s;var ER=LA.exports,nC=ER;V_.createRoot=nC.createRoot,V_.hydrateRoot=nC.hydrateRoot;var zu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},AR={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Wo,M2,xA,FR=(xA=class{constructor(){Oe(this,Wo,AR);Oe(this,M2,!1)}setTimeoutProvider(e){Te(this,Wo,e)}setTimeout(e,t){return Y(this,Wo).setTimeout(e,t)}clearTimeout(e){Y(this,Wo).clearTimeout(e)}setInterval(e,t){return Y(this,Wo).setInterval(e,t)}clearInterval(e){Y(this,Wo).clearInterval(e)}},Wo=new WeakMap,M2=new WeakMap,xA),uc=new FR;function PR(e){setTimeout(e,0)}var Bc=typeof window>"u"||"Deno"in globalThis;function Cn(){}function DR(e,t){return typeof e=="function"?e(t):e}function Rw(e){return typeof e=="number"&&e>=0&&e!==1/0}function z3(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ml(e,t){return typeof e=="function"?e(t):e}function Gs(e,t){return typeof e=="function"?e(t):e}function sC(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==Ej(o,t.options))return!1}else if(!v0(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function aC(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Uc(t.options.mutationKey)!==Uc(i))return!1}else if(!v0(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function Ej(e,t){return((t==null?void 0:t.queryKeyHashFn)||Uc)(e)}function Uc(e){return JSON.stringify(e,(t,r)=>Iw(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function v0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>v0(e[r],t[r])):!1}var MR=Object.prototype.hasOwnProperty;function B3(e,t){if(e===t)return e;const r=iC(e)&&iC(t);if(!r&&!(Iw(e)&&Iw(t)))return t;const s=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),o=i.length,l=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const h=r?u:i[u],f=e[h],m=t[h];if(f===m){l[h]=f,(r?u<s:MR.call(e,h))&&c++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){l[h]=m;continue}const g=B3(f,m);l[h]=g,g===f&&c++}return s===o&&c===s?e:l}function Px(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function iC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Iw(e){if(!oC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!oC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function oC(e){return Object.prototype.toString.call(e)==="[object Object]"}function OR(e){return new Promise(t=>{uc.setTimeout(t,e)})}function Nw(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?B3(e,t):t}function RR(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function IR(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Aj=Symbol();function U3(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Aj?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function V3(e,t){return typeof e=="function"?e(...t):!!e}var gc,Go,iu,vA,NR=(vA=class extends zu{constructor(){super();Oe(this,gc);Oe(this,Go);Oe(this,iu);Te(this,iu,t=>{if(!Bc&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Y(this,Go)||this.setEventListener(Y(this,iu))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,Go))==null||t.call(this),Te(this,Go,void 0))}setEventListener(t){var r;Te(this,iu,t),(r=Y(this,Go))==null||r.call(this),Te(this,Go,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Y(this,gc)!==t&&(Te(this,gc,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Y(this,gc)=="boolean"?Y(this,gc):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},gc=new WeakMap,Go=new WeakMap,iu=new WeakMap,vA),Fj=new NR;function Lw(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}var LR=PR;function zR(){let e=[],t=0,r=l=>{l()},n=l=>{l()},s=LR;const i=l=>{t?e.push(l):s(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var yr=zR(),ou,qo,lu,yA,BR=(yA=class extends zu{constructor(){super();Oe(this,ou,!0);Oe(this,qo);Oe(this,lu);Te(this,lu,t=>{if(!Bc&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Y(this,qo)||this.setEventListener(Y(this,lu))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,qo))==null||t.call(this),Te(this,qo,void 0))}setEventListener(t){var r;Te(this,lu,t),(r=Y(this,qo))==null||r.call(this),Te(this,qo,t(this.setOnline.bind(this)))}setOnline(t){Y(this,ou)!==t&&(Te(this,ou,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Y(this,ou)}},ou=new WeakMap,qo=new WeakMap,lu=new WeakMap,yA),Dx=new BR;function UR(e){return Math.min(1e3*2**e,3e4)}function H3(e){return(e??"online")==="online"?Dx.isOnline():!0}var zw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function W3(e){let t=!1,r=0,n;const s=Lw(),i=()=>s.status!=="pending",o=x=>{var y;if(!i()){const _=new zw(x);m(_),(y=e.onCancel)==null||y.call(e,_)}},l=()=>{t=!0},c=()=>{t=!1},u=()=>Fj.isFocused()&&(e.networkMode==="always"||Dx.isOnline())&&e.canRun(),h=()=>H3(e.networkMode)&&e.canRun(),f=x=>{i()||(n==null||n(),s.resolve(x))},m=x=>{i()||(n==null||n(),s.reject(x))},g=()=>new Promise(x=>{var y;n=_=>{(i()||u())&&x(_)},(y=e.onPause)==null||y.call(e)}).then(()=>{var x;n=void 0,i()||(x=e.onContinue)==null||x.call(e)}),v=()=>{if(i())return;let x;const y=r===0?e.initialPromise:void 0;try{x=y??e.fn()}catch(_){x=Promise.reject(_)}Promise.resolve(x).then(f).catch(_=>{var T;if(i())return;const b=e.retry??(Bc?0:3),w=e.retryDelay??UR,C=typeof w=="function"?w(r,_):w,j=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,_);if(t||!j){m(_);return}r++,(T=e.onFail)==null||T.call(e,r,_),OR(C).then(()=>u()?void 0:g()).then(()=>{t?m(_):v()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(n==null||n(),s),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?v():g().then(v),s)}}var xc,bA,G3=(bA=class{constructor(){Oe(this,xc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Rw(this.gcTime)&&Te(this,xc,uc.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Bc?1/0:5*60*1e3))}clearGcTimeout(){Y(this,xc)&&(uc.clearTimeout(Y(this,xc)),Te(this,xc,void 0))}},xc=new WeakMap,bA),vc,cu,Hs,yc,Tr,V0,bc,ba,Fi,_A,VR=(_A=class extends G3{constructor(t){super();Oe(this,ba);Oe(this,vc);Oe(this,cu);Oe(this,Hs);Oe(this,yc);Oe(this,Tr);Oe(this,V0);Oe(this,bc);Te(this,bc,!1),Te(this,V0,t.defaultOptions),this.setOptions(t.options),this.observers=[],Te(this,yc,t.client),Te(this,Hs,Y(this,yc).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Te(this,vc,cC(this.options)),this.state=t.state??Y(this,vc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Y(this,Tr))==null?void 0:t.promise}setOptions(t){if(this.options={...Y(this,V0),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=cC(this.options);r.data!==void 0&&(this.setState(lC(r.data,r.dataUpdatedAt)),Te(this,vc,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Y(this,Hs).remove(this)}setData(t,r){const n=Nw(this.state.data,t,this.options);return Ke(this,ba,Fi).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Ke(this,ba,Fi).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=Y(this,Tr))==null?void 0:n.promise;return(s=Y(this,Tr))==null||s.cancel(t),r?r.then(Cn).catch(Cn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Y(this,vc))}isActive(){return this.observers.some(t=>Gs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Aj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ml(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!z3(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Y(this,Tr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Y(this,Tr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Y(this,Hs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Y(this,Tr)&&(Y(this,bc)?Y(this,Tr).cancel({revert:!0}):Y(this,Tr).cancelRetry()),this.scheduleGc()),Y(this,Hs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ke(this,ba,Fi).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,h,f,m,g,v,x,y,_,b,w;if(this.state.fetchStatus!=="idle"&&((c=Y(this,Tr))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Y(this,Tr))return Y(this,Tr).continueRetry(),Y(this,Tr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const C=this.observers.find(j=>j.options.queryFn);C&&this.setOptions(C.options)}const n=new AbortController,s=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(Te(this,bc,!0),n.signal)})},i=()=>{const C=U3(this.options,r),T=(()=>{const k={client:Y(this,yc),queryKey:this.queryKey,meta:this.meta};return s(k),k})();return Te(this,bc,!1),this.options.persister?this.options.persister(C,T,this):C(T)},l=(()=>{const C={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Y(this,yc),state:this.state,fetchFn:i};return s(C),C})();(u=this.options.behavior)==null||u.onFetch(l,this),Te(this,cu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&Ke(this,ba,Fi).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta}),Te(this,Tr,W3({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:C=>{C instanceof zw&&C.revert&&this.setState({...Y(this,cu),fetchStatus:"idle"}),n.abort()},onFail:(C,j)=>{Ke(this,ba,Fi).call(this,{type:"failed",failureCount:C,error:j})},onPause:()=>{Ke(this,ba,Fi).call(this,{type:"pause"})},onContinue:()=>{Ke(this,ba,Fi).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const C=await Y(this,Tr).start();if(C===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(C),(g=(m=Y(this,Hs).config).onSuccess)==null||g.call(m,C,this),(x=(v=Y(this,Hs).config).onSettled)==null||x.call(v,C,this.state.error,this),C}catch(C){if(C instanceof zw){if(C.silent)return Y(this,Tr).promise;if(C.revert){if(this.state.data===void 0)throw C;return this.state.data}}throw Ke(this,ba,Fi).call(this,{type:"error",error:C}),(_=(y=Y(this,Hs).config).onError)==null||_.call(y,C,this),(w=(b=Y(this,Hs).config).onSettled)==null||w.call(b,this.state.data,C,this),C}finally{this.scheduleGc()}}},vc=new WeakMap,cu=new WeakMap,Hs=new WeakMap,yc=new WeakMap,Tr=new WeakMap,V0=new WeakMap,bc=new WeakMap,ba=new WeakSet,Fi=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...q3(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...lC(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Te(this,cu,t.manual?s:void 0),s;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),yr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Y(this,Hs).notify({query:this,type:"updated",action:t})})},_A);function q3(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:H3(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function lC(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function cC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Vn,tt,H0,jn,_c,du,Li,Ko,W0,uu,hu,wc,jc,Xo,fu,vt,kf,Bw,Uw,Vw,Hw,Ww,Gw,qw,K3,wA,HR=(wA=class extends zu{constructor(t,r){super();Oe(this,vt);Oe(this,Vn);Oe(this,tt);Oe(this,H0);Oe(this,jn);Oe(this,_c);Oe(this,du);Oe(this,Li);Oe(this,Ko);Oe(this,W0);Oe(this,uu);Oe(this,hu);Oe(this,wc);Oe(this,jc);Oe(this,Xo);Oe(this,fu,new Set);this.options=r,Te(this,Vn,t),Te(this,Ko,null),Te(this,Li,Lw()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Y(this,tt).addObserver(this),dC(Y(this,tt),this.options)?Ke(this,vt,kf).call(this):this.updateResult(),Ke(this,vt,Hw).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Kw(Y(this,tt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Kw(Y(this,tt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ke(this,vt,Ww).call(this),Ke(this,vt,Gw).call(this),Y(this,tt).removeObserver(this)}setOptions(t){const r=this.options,n=Y(this,tt);if(this.options=Y(this,Vn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Gs(this.options.enabled,Y(this,tt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ke(this,vt,qw).call(this),Y(this,tt).setOptions(this.options),r._defaulted&&!Px(this.options,r)&&Y(this,Vn).getQueryCache().notify({type:"observerOptionsUpdated",query:Y(this,tt),observer:this});const s=this.hasListeners();s&&uC(Y(this,tt),n,this.options,r)&&Ke(this,vt,kf).call(this),this.updateResult(),s&&(Y(this,tt)!==n||Gs(this.options.enabled,Y(this,tt))!==Gs(r.enabled,Y(this,tt))||ml(this.options.staleTime,Y(this,tt))!==ml(r.staleTime,Y(this,tt)))&&Ke(this,vt,Bw).call(this);const i=Ke(this,vt,Uw).call(this);s&&(Y(this,tt)!==n||Gs(this.options.enabled,Y(this,tt))!==Gs(r.enabled,Y(this,tt))||i!==Y(this,Xo))&&Ke(this,vt,Vw).call(this,i)}getOptimisticResult(t){const r=Y(this,Vn).getQueryCache().build(Y(this,Vn),t),n=this.createResult(r,t);return GR(this,n)&&(Te(this,jn,n),Te(this,du,this.options),Te(this,_c,Y(this,tt).state)),n}getCurrentResult(){return Y(this,jn)}trackResult(t,r){return new Proxy(t,{get:(n,s)=>(this.trackProp(s),r==null||r(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&Y(this,Li).status==="pending"&&Y(this,Li).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,s))})}trackProp(t){Y(this,fu).add(t)}getCurrentQuery(){return Y(this,tt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=Y(this,Vn).defaultQueryOptions(t),n=Y(this,Vn).getQueryCache().build(Y(this,Vn),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Ke(this,vt,kf).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),Y(this,jn)))}createResult(t,r){var A;const n=Y(this,tt),s=this.options,i=Y(this,jn),o=Y(this,_c),l=Y(this,du),u=t!==n?t.state:Y(this,H0),{state:h}=t;let f={...h},m=!1,g;if(r._optimisticResults){const O=this.hasListeners(),F=!O&&dC(t,r),B=O&&uC(t,n,r,s);(F||B)&&(f={...f,...q3(h.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:v,errorUpdatedAt:x,status:y}=f;g=f.data;let _=!1;if(r.placeholderData!==void 0&&g===void 0&&y==="pending"){let O;i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(O=i.data,_=!0):O=typeof r.placeholderData=="function"?r.placeholderData((A=Y(this,hu))==null?void 0:A.state.data,Y(this,hu)):r.placeholderData,O!==void 0&&(y="success",g=Nw(i==null?void 0:i.data,O,r),m=!0)}if(r.select&&g!==void 0&&!_)if(i&&g===(o==null?void 0:o.data)&&r.select===Y(this,W0))g=Y(this,uu);else try{Te(this,W0,r.select),g=r.select(g),g=Nw(i==null?void 0:i.data,g,r),Te(this,uu,g),Te(this,Ko,null)}catch(O){Te(this,Ko,O)}Y(this,Ko)&&(v=Y(this,Ko),g=Y(this,uu),x=Date.now(),y="error");const b=f.fetchStatus==="fetching",w=y==="pending",C=y==="error",j=w&&b,T=g!==void 0,M={status:y,fetchStatus:f.fetchStatus,isPending:w,isSuccess:y==="success",isError:C,isInitialLoading:j,isLoading:j,data:g,dataUpdatedAt:f.dataUpdatedAt,error:v,errorUpdatedAt:x,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!w,isLoadingError:C&&!T,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:C&&T,isStale:Pj(t,r),refetch:this.refetch,promise:Y(this,Li),isEnabled:Gs(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const O=L=>{M.status==="error"?L.reject(M.error):M.data!==void 0&&L.resolve(M.data)},F=()=>{const L=Te(this,Li,M.promise=Lw());O(L)},B=Y(this,Li);switch(B.status){case"pending":t.queryHash===n.queryHash&&O(B);break;case"fulfilled":(M.status==="error"||M.data!==B.value)&&F();break;case"rejected":(M.status!=="error"||M.error!==B.reason)&&F();break}}return M}updateResult(){const t=Y(this,jn),r=this.createResult(Y(this,tt),this.options);if(Te(this,_c,Y(this,tt).state),Te(this,du,this.options),Y(this,_c).data!==void 0&&Te(this,hu,Y(this,tt)),Px(r,t))return;Te(this,jn,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!Y(this,fu).size)return!0;const o=new Set(i??Y(this,fu));return this.options.throwOnError&&o.add("error"),Object.keys(Y(this,jn)).some(l=>{const c=l;return Y(this,jn)[c]!==t[c]&&o.has(c)})};Ke(this,vt,K3).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ke(this,vt,Hw).call(this)}},Vn=new WeakMap,tt=new WeakMap,H0=new WeakMap,jn=new WeakMap,_c=new WeakMap,du=new WeakMap,Li=new WeakMap,Ko=new WeakMap,W0=new WeakMap,uu=new WeakMap,hu=new WeakMap,wc=new WeakMap,jc=new WeakMap,Xo=new WeakMap,fu=new WeakMap,vt=new WeakSet,kf=function(t){Ke(this,vt,qw).call(this);let r=Y(this,tt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Cn)),r},Bw=function(){Ke(this,vt,Ww).call(this);const t=ml(this.options.staleTime,Y(this,tt));if(Bc||Y(this,jn).isStale||!Rw(t))return;const n=z3(Y(this,jn).dataUpdatedAt,t)+1;Te(this,wc,uc.setTimeout(()=>{Y(this,jn).isStale||this.updateResult()},n))},Uw=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Y(this,tt)):this.options.refetchInterval)??!1},Vw=function(t){Ke(this,vt,Gw).call(this),Te(this,Xo,t),!(Bc||Gs(this.options.enabled,Y(this,tt))===!1||!Rw(Y(this,Xo))||Y(this,Xo)===0)&&Te(this,jc,uc.setInterval(()=>{(this.options.refetchIntervalInBackground||Fj.isFocused())&&Ke(this,vt,kf).call(this)},Y(this,Xo)))},Hw=function(){Ke(this,vt,Bw).call(this),Ke(this,vt,Vw).call(this,Ke(this,vt,Uw).call(this))},Ww=function(){Y(this,wc)&&(uc.clearTimeout(Y(this,wc)),Te(this,wc,void 0))},Gw=function(){Y(this,jc)&&(uc.clearInterval(Y(this,jc)),Te(this,jc,void 0))},qw=function(){const t=Y(this,Vn).getQueryCache().build(Y(this,Vn),this.options);if(t===Y(this,tt))return;const r=Y(this,tt);Te(this,tt,t),Te(this,H0,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},K3=function(t){yr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(Y(this,jn))}),Y(this,Vn).getQueryCache().notify({query:Y(this,tt),type:"observerResultsUpdated"})})},wA);function WR(e,t){return Gs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function dC(e,t){return WR(e,t)||e.state.data!==void 0&&Kw(e,t,t.refetchOnMount)}function Kw(e,t,r){if(Gs(t.enabled,e)!==!1&&ml(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Pj(e,t)}return!1}function uC(e,t,r,n){return(e!==t||Gs(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Pj(e,r)}function Pj(e,t){return Gs(t.enabled,e)!==!1&&e.isStaleByTime(ml(t.staleTime,e))}function GR(e,t){return!Px(e.getCurrentResult(),t)}function hC(e){return{onFetch:(t,r)=>{var h,f,m,g,v;const n=t.options,s=(m=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:m.direction,i=((g=t.state.data)==null?void 0:g.pages)||[],o=((v=t.state.data)==null?void 0:v.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let x=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?x=!0:t.signal.addEventListener("abort",()=>{x=!0}),t.signal)})},_=U3(t.options,t.fetchOptions),b=async(w,C,j)=>{if(x)return Promise.reject();if(C==null&&w.pages.length)return Promise.resolve(w);const k=(()=>{const F={client:t.client,queryKey:t.queryKey,pageParam:C,direction:j?"backward":"forward",meta:t.options.meta};return y(F),F})(),M=await _(k),{maxPages:A}=t.options,O=j?IR:RR;return{pages:O(w.pages,M,A),pageParams:O(w.pageParams,C,A)}};if(s&&i.length){const w=s==="backward",C=w?qR:fC,j={pages:i,pageParams:o},T=C(n,j);l=await b(j,T,w)}else{const w=e??i.length;do{const C=c===0?o[0]??n.initialPageParam:fC(n,l);if(c>0&&C==null)break;l=await b(l,C),c++}while(c<w)}return l};t.options.persister?t.fetchFn=()=>{var x,y;return(y=(x=t.options).persister)==null?void 0:y.call(x,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function fC(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function qR(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var G0,ni,kn,kc,si,Io,jA,KR=(jA=class extends G3{constructor(t){super();Oe(this,si);Oe(this,G0);Oe(this,ni);Oe(this,kn);Oe(this,kc);Te(this,G0,t.client),this.mutationId=t.mutationId,Te(this,kn,t.mutationCache),Te(this,ni,[]),this.state=t.state||X3(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Y(this,ni).includes(t)||(Y(this,ni).push(t),this.clearGcTimeout(),Y(this,kn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Te(this,ni,Y(this,ni).filter(r=>r!==t)),this.scheduleGc(),Y(this,kn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Y(this,ni).length||(this.state.status==="pending"?this.scheduleGc():Y(this,kn).remove(this))}continue(){var t;return((t=Y(this,kc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,u,h,f,m,g,v,x,y,_,b,w,C,j,T,k,M,A;const r=()=>{Ke(this,si,Io).call(this,{type:"continue"})},n={client:Y(this,G0),meta:this.options.meta,mutationKey:this.options.mutationKey};Te(this,kc,W3({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(O,F)=>{Ke(this,si,Io).call(this,{type:"failed",failureCount:O,error:F})},onPause:()=>{Ke(this,si,Io).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Y(this,kn).canRun(this)}));const s=this.state.status==="pending",i=!Y(this,kc).canStart();try{if(s)r();else{Ke(this,si,Io).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=Y(this,kn).config).onMutate)==null?void 0:l.call(o,t,this,n));const F=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,n));F!==this.state.context&&Ke(this,si,Io).call(this,{type:"pending",context:F,variables:t,isPaused:i})}const O=await Y(this,kc).start();return await((f=(h=Y(this,kn).config).onSuccess)==null?void 0:f.call(h,O,t,this.state.context,this,n)),await((g=(m=this.options).onSuccess)==null?void 0:g.call(m,O,t,this.state.context,n)),await((x=(v=Y(this,kn).config).onSettled)==null?void 0:x.call(v,O,null,this.state.variables,this.state.context,this,n)),await((_=(y=this.options).onSettled)==null?void 0:_.call(y,O,null,t,this.state.context,n)),Ke(this,si,Io).call(this,{type:"success",data:O}),O}catch(O){try{throw await((w=(b=Y(this,kn).config).onError)==null?void 0:w.call(b,O,t,this.state.context,this,n)),await((j=(C=this.options).onError)==null?void 0:j.call(C,O,t,this.state.context,n)),await((k=(T=Y(this,kn).config).onSettled)==null?void 0:k.call(T,void 0,O,this.state.variables,this.state.context,this,n)),await((A=(M=this.options).onSettled)==null?void 0:A.call(M,void 0,O,t,this.state.context,n)),O}finally{Ke(this,si,Io).call(this,{type:"error",error:O})}}finally{Y(this,kn).runNext(this)}}},G0=new WeakMap,ni=new WeakMap,kn=new WeakMap,kc=new WeakMap,si=new WeakSet,Io=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),yr.batch(()=>{Y(this,ni).forEach(n=>{n.onMutationUpdate(t)}),Y(this,kn).notify({mutation:this,type:"updated",action:t})})},jA);function X3(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zi,_a,q0,kA,XR=(kA=class extends zu{constructor(t={}){super();Oe(this,zi);Oe(this,_a);Oe(this,q0);this.config=t,Te(this,zi,new Set),Te(this,_a,new Map),Te(this,q0,0)}build(t,r,n){const s=new KR({client:t,mutationCache:this,mutationId:++xp(this,q0)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){Y(this,zi).add(t);const r=Op(t);if(typeof r=="string"){const n=Y(this,_a).get(r);n?n.push(t):Y(this,_a).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Y(this,zi).delete(t)){const r=Op(t);if(typeof r=="string"){const n=Y(this,_a).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&Y(this,_a).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Op(t);if(typeof r=="string"){const n=Y(this,_a).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=Op(t);if(typeof r=="string"){const s=(n=Y(this,_a).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){yr.batch(()=>{Y(this,zi).forEach(t=>{this.notify({type:"removed",mutation:t})}),Y(this,zi).clear(),Y(this,_a).clear()})}getAll(){return Array.from(Y(this,zi))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>aC(r,n))}findAll(t={}){return this.getAll().filter(r=>aC(t,r))}notify(t){yr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return yr.batch(()=>Promise.all(t.map(r=>r.continue().catch(Cn))))}},zi=new WeakMap,_a=new WeakMap,q0=new WeakMap,kA);function Op(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Bi,Yo,Hn,Ui,Ji,Gg,Xw,SA,YR=(SA=class extends zu{constructor(r,n){super();Oe(this,Ji);Oe(this,Bi);Oe(this,Yo);Oe(this,Hn);Oe(this,Ui);Te(this,Bi,r),this.setOptions(n),this.bindMethods(),Ke(this,Ji,Gg).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=Y(this,Bi).defaultMutationOptions(r),Px(this.options,n)||Y(this,Bi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Y(this,Hn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Uc(n.mutationKey)!==Uc(this.options.mutationKey)?this.reset():((s=Y(this,Hn))==null?void 0:s.state.status)==="pending"&&Y(this,Hn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=Y(this,Hn))==null||r.removeObserver(this)}onMutationUpdate(r){Ke(this,Ji,Gg).call(this),Ke(this,Ji,Xw).call(this,r)}getCurrentResult(){return Y(this,Yo)}reset(){var r;(r=Y(this,Hn))==null||r.removeObserver(this),Te(this,Hn,void 0),Ke(this,Ji,Gg).call(this),Ke(this,Ji,Xw).call(this)}mutate(r,n){var s;return Te(this,Ui,n),(s=Y(this,Hn))==null||s.removeObserver(this),Te(this,Hn,Y(this,Bi).getMutationCache().build(Y(this,Bi),this.options)),Y(this,Hn).addObserver(this),Y(this,Hn).execute(r)}},Bi=new WeakMap,Yo=new WeakMap,Hn=new WeakMap,Ui=new WeakMap,Ji=new WeakSet,Gg=function(){var n;const r=((n=Y(this,Hn))==null?void 0:n.state)??X3();Te(this,Yo,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Xw=function(r){yr.batch(()=>{var n,s,i,o,l,c,u,h;if(Y(this,Ui)&&this.hasListeners()){const f=Y(this,Yo).variables,m=Y(this,Yo).context,g={client:Y(this,Bi),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((s=(n=Y(this,Ui)).onSuccess)==null||s.call(n,r.data,f,m,g),(o=(i=Y(this,Ui)).onSettled)==null||o.call(i,r.data,null,f,m,g)):(r==null?void 0:r.type)==="error"&&((c=(l=Y(this,Ui)).onError)==null||c.call(l,r.error,f,m,g),(h=(u=Y(this,Ui)).onSettled)==null||h.call(u,void 0,r.error,f,m,g))}this.listeners.forEach(f=>{f(Y(this,Yo))})})},SA),ai,CA,QR=(CA=class extends zu{constructor(t={}){super();Oe(this,ai);this.config=t,Te(this,ai,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??Ej(s,r);let o=this.get(i);return o||(o=new VR({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){Y(this,ai).has(t.queryHash)||(Y(this,ai).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Y(this,ai).get(t.queryHash);r&&(t.destroy(),r===t&&Y(this,ai).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){yr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Y(this,ai).get(t)}getAll(){return[...Y(this,ai).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>sC(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>sC(t,n)):r}notify(t){yr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){yr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){yr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ai=new WeakMap,CA),Xt,Qo,Jo,pu,mu,Zo,gu,xu,$A,JR=($A=class{constructor(e={}){Oe(this,Xt);Oe(this,Qo);Oe(this,Jo);Oe(this,pu);Oe(this,mu);Oe(this,Zo);Oe(this,gu);Oe(this,xu);Te(this,Xt,e.queryCache||new QR),Te(this,Qo,e.mutationCache||new XR),Te(this,Jo,e.defaultOptions||{}),Te(this,pu,new Map),Te(this,mu,new Map),Te(this,Zo,0)}mount(){xp(this,Zo)._++,Y(this,Zo)===1&&(Te(this,gu,Fj.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,Xt).onFocus())})),Te(this,xu,Dx.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,Xt).onOnline())})))}unmount(){var e,t;xp(this,Zo)._--,Y(this,Zo)===0&&((e=Y(this,gu))==null||e.call(this),Te(this,gu,void 0),(t=Y(this,xu))==null||t.call(this),Te(this,xu,void 0))}isFetching(e){return Y(this,Xt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Y(this,Qo).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Y(this,Xt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Y(this,Xt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ml(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return Y(this,Xt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=Y(this,Xt).get(n.queryHash),i=s==null?void 0:s.state.data,o=DR(t,i);if(o!==void 0)return Y(this,Xt).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return yr.batch(()=>Y(this,Xt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Y(this,Xt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Y(this,Xt);yr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Y(this,Xt);return yr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=yr.batch(()=>Y(this,Xt).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(Cn).catch(Cn)}invalidateQueries(e,t={}){return yr.batch(()=>(Y(this,Xt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=yr.batch(()=>Y(this,Xt).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(Cn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Cn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Y(this,Xt).build(this,t);return r.isStaleByTime(ml(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Cn).catch(Cn)}fetchInfiniteQuery(e){return e.behavior=hC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Cn).catch(Cn)}ensureInfiniteQueryData(e){return e.behavior=hC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Dx.isOnline()?Y(this,Qo).resumePausedMutations():Promise.resolve()}getQueryCache(){return Y(this,Xt)}getMutationCache(){return Y(this,Qo)}getDefaultOptions(){return Y(this,Jo)}setDefaultOptions(e){Te(this,Jo,e)}setQueryDefaults(e,t){Y(this,pu).set(Uc(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Y(this,pu).values()],r={};return t.forEach(n=>{v0(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){Y(this,mu).set(Uc(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Y(this,mu).values()],r={};return t.forEach(n=>{v0(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Y(this,Jo).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Ej(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Aj&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Y(this,Jo).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Y(this,Xt).clear(),Y(this,Qo).clear()}},Xt=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,pu=new WeakMap,mu=new WeakMap,Zo=new WeakMap,gu=new WeakMap,xu=new WeakMap,$A),Y3=E.createContext(void 0),Sr=e=>{const t=E.useContext(Y3);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},ZR=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(Y3.Provider,{value:e,children:t})),Q3=E.createContext(!1),eI=()=>E.useContext(Q3);Q3.Provider;function tI(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var rI=E.createContext(tI()),nI=()=>E.useContext(rI),sI=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},aI=e=>{E.useEffect(()=>{e.clearReset()},[e])},iI=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||V3(r,[e.error,n])),oI=e=>{if(e.suspense){const r=s=>s==="static"?s:Math.max(s??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...s)=>r(n(...s)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},lI=(e,t)=>e.isLoading&&e.isFetching&&!t,cI=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,pC=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function dI(e,t,r){var f,m,g,v,x;const n=eI(),s=nI(),i=Sr(),o=i.defaultQueryOptions(e);(m=(f=i.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||m.call(f,o),o._optimisticResults=n?"isRestoring":"optimistic",oI(o),sI(o,s),aI(s);const l=!i.getQueryCache().get(o.queryHash),[c]=E.useState(()=>new t(i,o)),u=c.getOptimisticResult(o),h=!n&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(y=>{const _=h?c.subscribe(yr.batchCalls(y)):Cn;return c.updateResult(),_},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),E.useEffect(()=>{c.setOptions(o)},[o,c]),cI(o,u))throw pC(o,c,s);if(iI({result:u,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((v=(g=i.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||v.call(g,o,u),o.experimental_prefetchInRender&&!Bc&&lI(u,n)){const y=l?pC(o,c,s):(x=i.getQueryCache().get(o.queryHash))==null?void 0:x.promise;y==null||y.catch(Cn).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function Bt(e,t){return dI(e,HR)}function Et(e,t){const r=Sr(),[n]=E.useState(()=>new YR(r,e));E.useEffect(()=>{n.setOptions(e)},[n,e]);const s=E.useSyncExternalStore(E.useCallback(o=>n.subscribe(yr.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=E.useCallback((o,l)=>{n.mutate(o,l).catch(Cn)},[n]);if(s.error&&V3(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}var on=function(){return on=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},on.apply(this,arguments)};function Su(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var Pt="-ms-",Bf="-moz-",gt="-webkit-",J3="comm",j1="rule",Dj="decl",uI="@import",Z3="@keyframes",hI="@layer",eP=Math.abs,Mj=String.fromCharCode,Yw=Object.assign;function fI(e,t){return Fr(e,0)^45?(((t<<2^Fr(e,0))<<2^Fr(e,1))<<2^Fr(e,2))<<2^Fr(e,3):0}function tP(e){return e.trim()}function Oi(e,t){return(e=t.exec(e))?e[0]:e}function Xe(e,t,r){return e.replace(t,r)}function qg(e,t,r){return e.indexOf(t,r)}function Fr(e,t){return e.charCodeAt(t)|0}function Cu(e,t,r){return e.slice(t,r)}function ii(e){return e.length}function rP(e){return e.length}function Sf(e,t){return t.push(e),e}function pI(e,t){return e.map(t).join("")}function mC(e,t){return e.filter(function(r){return!Oi(r,t)})}var k1=1,$u=1,nP=0,ta=0,hr=0,Bu="";function S1(e,t,r,n,s,i,o,l){return{value:e,root:t,parent:r,type:n,props:s,children:i,line:k1,column:$u,length:o,return:"",siblings:l}}function No(e,t){return Yw(S1("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function dd(e){for(;e.root;)e=No(e.root,{children:[e]});Sf(e,e.siblings)}function mI(){return hr}function gI(){return hr=ta>0?Fr(Bu,--ta):0,$u--,hr===10&&($u=1,k1--),hr}function Ea(){return hr=ta<nP?Fr(Bu,ta++):0,$u++,hr===10&&($u=1,k1++),hr}function $c(){return Fr(Bu,ta)}function Kg(){return ta}function C1(e,t){return Cu(Bu,e,t)}function Qw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function xI(e){return k1=$u=1,nP=ii(Bu=e),ta=0,[]}function vI(e){return Bu="",e}function kv(e){return tP(C1(ta-1,Jw(e===91?e+2:e===40?e+1:e)))}function yI(e){for(;(hr=$c())&&hr<33;)Ea();return Qw(e)>2||Qw(hr)>3?"":" "}function bI(e,t){for(;--t&&Ea()&&!(hr<48||hr>102||hr>57&&hr<65||hr>70&&hr<97););return C1(e,Kg()+(t<6&&$c()==32&&Ea()==32))}function Jw(e){for(;Ea();)switch(hr){case e:return ta;case 34:case 39:e!==34&&e!==39&&Jw(hr);break;case 40:e===41&&Jw(e);break;case 92:Ea();break}return ta}function _I(e,t){for(;Ea()&&e+hr!==57;)if(e+hr===84&&$c()===47)break;return"/*"+C1(t,ta-1)+"*"+Mj(e===47?e:Ea())}function wI(e){for(;!Qw($c());)Ea();return C1(e,ta)}function jI(e){return vI(Xg("",null,null,null,[""],e=xI(e),0,[0],e))}function Xg(e,t,r,n,s,i,o,l,c){for(var u=0,h=0,f=o,m=0,g=0,v=0,x=1,y=1,_=1,b=0,w="",C=s,j=i,T=n,k=w;y;)switch(v=b,b=Ea()){case 40:if(v!=108&&Fr(k,f-1)==58){qg(k+=Xe(kv(b),"&","&\f"),"&\f",eP(u?l[u-1]:0))!=-1&&(_=-1);break}case 34:case 39:case 91:k+=kv(b);break;case 9:case 10:case 13:case 32:k+=yI(v);break;case 92:k+=bI(Kg()-1,7);continue;case 47:switch($c()){case 42:case 47:Sf(kI(_I(Ea(),Kg()),t,r,c),c);break;default:k+="/"}break;case 123*x:l[u++]=ii(k)*_;case 125*x:case 59:case 0:switch(b){case 0:case 125:y=0;case 59+h:_==-1&&(k=Xe(k,/\f/g,"")),g>0&&ii(k)-f&&Sf(g>32?xC(k+";",n,r,f-1,c):xC(Xe(k," ","")+";",n,r,f-2,c),c);break;case 59:k+=";";default:if(Sf(T=gC(k,t,r,u,h,s,l,w,C=[],j=[],f,i),i),b===123)if(h===0)Xg(k,t,T,T,C,i,f,l,j);else switch(m===99&&Fr(k,3)===110?100:m){case 100:case 108:case 109:case 115:Xg(e,T,T,n&&Sf(gC(e,T,T,0,0,s,l,w,s,C=[],f,j),j),s,j,f,l,n?C:j);break;default:Xg(k,T,T,T,[""],j,0,l,j)}}u=h=g=0,x=_=1,w=k="",f=o;break;case 58:f=1+ii(k),g=v;default:if(x<1){if(b==123)--x;else if(b==125&&x++==0&&gI()==125)continue}switch(k+=Mj(b),b*x){case 38:_=h>0?1:(k+="\f",-1);break;case 44:l[u++]=(ii(k)-1)*_,_=1;break;case 64:$c()===45&&(k+=kv(Ea())),m=$c(),h=f=ii(w=k+=wI(Kg())),b++;break;case 45:v===45&&ii(k)==2&&(x=0)}}return i}function gC(e,t,r,n,s,i,o,l,c,u,h,f){for(var m=s-1,g=s===0?i:[""],v=rP(g),x=0,y=0,_=0;x<n;++x)for(var b=0,w=Cu(e,m+1,m=eP(y=o[x])),C=e;b<v;++b)(C=tP(y>0?g[b]+" "+w:Xe(w,/&\f/g,g[b])))&&(c[_++]=C);return S1(e,t,r,s===0?j1:l,c,u,h,f)}function kI(e,t,r,n){return S1(e,t,r,J3,Mj(mI()),Cu(e,2,-2),0,n)}function xC(e,t,r,n,s){return S1(e,t,r,Dj,Cu(e,0,n),Cu(e,n+1,-1),n,s)}function sP(e,t,r){switch(fI(e,t)){case 5103:return gt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return gt+e+e;case 4789:return Bf+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return gt+e+Bf+e+Pt+e+e;case 5936:switch(Fr(e,t+11)){case 114:return gt+e+Pt+Xe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return gt+e+Pt+Xe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return gt+e+Pt+Xe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return gt+e+Pt+e+e;case 6165:return gt+e+Pt+"flex-"+e+e;case 5187:return gt+e+Xe(e,/(\w+).+(:[^]+)/,gt+"box-$1$2"+Pt+"flex-$1$2")+e;case 5443:return gt+e+Pt+"flex-item-"+Xe(e,/flex-|-self/g,"")+(Oi(e,/flex-|baseline/)?"":Pt+"grid-row-"+Xe(e,/flex-|-self/g,""))+e;case 4675:return gt+e+Pt+"flex-line-pack"+Xe(e,/align-content|flex-|-self/g,"")+e;case 5548:return gt+e+Pt+Xe(e,"shrink","negative")+e;case 5292:return gt+e+Pt+Xe(e,"basis","preferred-size")+e;case 6060:return gt+"box-"+Xe(e,"-grow","")+gt+e+Pt+Xe(e,"grow","positive")+e;case 4554:return gt+Xe(e,/([^-])(transform)/g,"$1"+gt+"$2")+e;case 6187:return Xe(Xe(Xe(e,/(zoom-|grab)/,gt+"$1"),/(image-set)/,gt+"$1"),e,"")+e;case 5495:case 3959:return Xe(e,/(image-set\([^]*)/,gt+"$1$`$1");case 4968:return Xe(Xe(e,/(.+:)(flex-)?(.*)/,gt+"box-pack:$3"+Pt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+gt+e+e;case 4200:if(!Oi(e,/flex-|baseline/))return Pt+"grid-column-align"+Cu(e,t)+e;break;case 2592:case 3360:return Pt+Xe(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(n,s){return t=s,Oi(n.props,/grid-\w+-end/)})?~qg(e+(r=r[t].value),"span",0)?e:Pt+Xe(e,"-start","")+e+Pt+"grid-row-span:"+(~qg(r,"span",0)?Oi(r,/\d+/):+Oi(r,/\d+/)-+Oi(e,/\d+/))+";":Pt+Xe(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(n){return Oi(n.props,/grid-\w+-start/)})?e:Pt+Xe(Xe(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Xe(e,/(.+)-inline(.+)/,gt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ii(e)-1-t>6)switch(Fr(e,t+1)){case 109:if(Fr(e,t+4)!==45)break;case 102:return Xe(e,/(.+:)(.+)-([^]+)/,"$1"+gt+"$2-$3$1"+Bf+(Fr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~qg(e,"stretch",0)?sP(Xe(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return Xe(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,s,i,o,l,c,u){return Pt+s+":"+i+u+(o?Pt+s+"-span:"+(l?c:+c-+i)+u:"")+e});case 4949:if(Fr(e,t+6)===121)return Xe(e,":",":"+gt)+e;break;case 6444:switch(Fr(e,Fr(e,14)===45?18:11)){case 120:return Xe(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+gt+(Fr(e,14)===45?"inline-":"")+"box$3$1"+gt+"$2$3$1"+Pt+"$2box$3")+e;case 100:return Xe(e,":",":"+Pt)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Xe(e,"scroll-","scroll-snap-")+e}return e}function Mx(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function SI(e,t,r,n){switch(e.type){case hI:if(e.children.length)break;case uI:case Dj:return e.return=e.return||e.value;case J3:return"";case Z3:return e.return=e.value+"{"+Mx(e.children,n)+"}";case j1:if(!ii(e.value=e.props.join(",")))return""}return ii(r=Mx(e.children,n))?e.return=e.value+"{"+r+"}":""}function CI(e){var t=rP(e);return function(r,n,s,i){for(var o="",l=0;l<t;l++)o+=e[l](r,n,s,i)||"";return o}}function $I(e){return function(t){t.root||(t=t.return)&&e(t)}}function TI(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case Dj:e.return=sP(e.value,e.length,r);return;case Z3:return Mx([No(e,{value:Xe(e.value,"@","@"+gt)})],n);case j1:if(e.length)return pI(r=e.props,function(s){switch(Oi(s,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":dd(No(e,{props:[Xe(s,/:(read-\w+)/,":"+Bf+"$1")]})),dd(No(e,{props:[s]})),Yw(e,{props:mC(r,n)});break;case"::placeholder":dd(No(e,{props:[Xe(s,/:(plac\w+)/,":"+gt+"input-$1")]})),dd(No(e,{props:[Xe(s,/:(plac\w+)/,":"+Bf+"$1")]})),dd(No(e,{props:[Xe(s,/:(plac\w+)/,Pt+"input-$1")]})),dd(No(e,{props:[s]})),Yw(e,{props:mC(r,n)});break}return""})}}var EI={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},cs={},Tu=typeof process<"u"&&cs!==void 0&&(cs.REACT_APP_SC_ATTR||cs.SC_ATTR)||"data-styled",aP="active",iP="data-styled-version",$1="6.1.19",Oj=`/*!sc*/
`,Ox=typeof window<"u"&&typeof document<"u",AI=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&cs!==void 0&&cs.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&cs.REACT_APP_SC_DISABLE_SPEEDY!==""?cs.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&cs.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&cs!==void 0&&cs.SC_DISABLE_SPEEDY!==void 0&&cs.SC_DISABLE_SPEEDY!==""&&cs.SC_DISABLE_SPEEDY!=="false"&&cs.SC_DISABLE_SPEEDY),FI={},T1=Object.freeze([]),Eu=Object.freeze({});function oP(e,t,r){return r===void 0&&(r=Eu),e.theme!==r.theme&&e.theme||t||r.theme}var lP=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),PI=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,DI=/(^-|-$)/g;function vC(e){return e.replace(PI,"-").replace(DI,"")}var MI=/(a)(d)/gi,Rp=52,yC=function(e){return String.fromCharCode(e+(e>25?39:97))};function Zw(e){var t,r="";for(t=Math.abs(e);t>Rp;t=t/Rp|0)r=yC(t%Rp)+r;return(yC(t%Rp)+r).replace(MI,"$1-$2")}var Sv,cP=5381,Wd=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},dP=function(e){return Wd(cP,e)};function Rj(e){return Zw(dP(e)>>>0)}function OI(e){return e.displayName||e.name||"Component"}function Cv(e){return typeof e=="string"&&!0}var uP=typeof Symbol=="function"&&Symbol.for,hP=uP?Symbol.for("react.memo"):60115,RI=uP?Symbol.for("react.forward_ref"):60112,II={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},NI={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},fP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},LI=((Sv={})[RI]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Sv[hP]=fP,Sv);function bC(e){return("type"in(t=e)&&t.type.$$typeof)===hP?fP:"$$typeof"in e?LI[e.$$typeof]:II;var t}var zI=Object.defineProperty,BI=Object.getOwnPropertyNames,_C=Object.getOwnPropertySymbols,UI=Object.getOwnPropertyDescriptor,VI=Object.getPrototypeOf,wC=Object.prototype;function pP(e,t,r){if(typeof t!="string"){if(wC){var n=VI(t);n&&n!==wC&&pP(e,n,r)}var s=BI(t);_C&&(s=s.concat(_C(t)));for(var i=bC(e),o=bC(t),l=0;l<s.length;++l){var c=s[l];if(!(c in NI||r&&r[c]||o&&c in o||i&&c in i)){var u=UI(t,c);try{zI(e,c,u)}catch{}}}}return e}function Au(e){return typeof e=="function"}function Ij(e){return typeof e=="object"&&"styledComponentId"in e}function hc(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function Rx(e,t){if(e.length===0)return"";for(var r=e[0],n=1;n<e.length;n++)r+=e[n];return r}function y0(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function e2(e,t,r){if(r===void 0&&(r=!1),!r&&!y0(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)e[n]=e2(e[n],t[n]);else if(y0(t))for(var n in t)e[n]=e2(e[n],t[n]);return e}function Nj(e,t){Object.defineProperty(e,"toString",{value:t})}function Z0(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var HI=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,n=0;n<t;n++)r+=this.groupSizes[n];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var n=this.groupSizes,s=n.length,i=s;t>=i;)if((i<<=1)<0)throw Z0(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var o=s;o<i;o++)this.groupSizes[o]=0}for(var l=this.indexOfGroup(t+1),c=(o=0,r.length);o<c;o++)this.tag.insertRule(l,r[o])&&(this.groupSizes[t]++,l++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],n=this.indexOfGroup(t),s=n+r;this.groupSizes[t]=0;for(var i=n;i<s;i++)this.tag.deleteRule(n)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var n=this.groupSizes[t],s=this.indexOfGroup(t),i=s+n,o=s;o<i;o++)r+="".concat(this.tag.getRule(o)).concat(Oj);return r},e}(),Yg=new Map,Ix=new Map,Qg=1,Ip=function(e){if(Yg.has(e))return Yg.get(e);for(;Ix.has(Qg);)Qg++;var t=Qg++;return Yg.set(e,t),Ix.set(t,e),t},WI=function(e,t){Qg=t+1,Yg.set(e,t),Ix.set(t,e)},GI="style[".concat(Tu,"][").concat(iP,'="').concat($1,'"]'),qI=new RegExp("^".concat(Tu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),KI=function(e,t,r){for(var n,s=r.split(","),i=0,o=s.length;i<o;i++)(n=s[i])&&e.registerName(t,n)},XI=function(e,t){for(var r,n=((r=t.textContent)!==null&&r!==void 0?r:"").split(Oj),s=[],i=0,o=n.length;i<o;i++){var l=n[i].trim();if(l){var c=l.match(qI);if(c){var u=0|parseInt(c[1],10),h=c[2];u!==0&&(WI(h,u),KI(e,h,c[3]),e.getTag().insertRules(u,s)),s.length=0}else s.push(l)}}},jC=function(e){for(var t=document.querySelectorAll(GI),r=0,n=t.length;r<n;r++){var s=t[r];s&&s.getAttribute(Tu)!==aP&&(XI(e,s),s.parentNode&&s.parentNode.removeChild(s))}};function YI(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var mP=function(e){var t=document.head,r=e||t,n=document.createElement("style"),s=function(l){var c=Array.from(l.querySelectorAll("style[".concat(Tu,"]")));return c[c.length-1]}(r),i=s!==void 0?s.nextSibling:null;n.setAttribute(Tu,aP),n.setAttribute(iP,$1);var o=YI();return o&&n.setAttribute("nonce",o),r.insertBefore(n,i),n},QI=function(){function e(t){this.element=mP(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var n=document.styleSheets,s=0,i=n.length;s<i;s++){var o=n[s];if(o.ownerNode===r)return o}throw Z0(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),JI=function(){function e(t){this.element=mP(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var n=document.createTextNode(r);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),ZI=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),kC=Ox,eN={isServer:!Ox,useCSSOMInjection:!AI},Nx=function(){function e(t,r,n){t===void 0&&(t=Eu),r===void 0&&(r={});var s=this;this.options=on(on({},eN),t),this.gs=r,this.names=new Map(n),this.server=!!t.isServer,!this.server&&Ox&&kC&&(kC=!1,jC(this)),Nj(this,function(){return function(i){for(var o=i.getTag(),l=o.length,c="",u=function(f){var m=function(_){return Ix.get(_)}(f);if(m===void 0)return"continue";var g=i.names.get(m),v=o.getGroup(f);if(g===void 0||!g.size||v.length===0)return"continue";var x="".concat(Tu,".g").concat(f,'[id="').concat(m,'"]'),y="";g!==void 0&&g.forEach(function(_){_.length>0&&(y+="".concat(_,","))}),c+="".concat(v).concat(x,'{content:"').concat(y,'"}').concat(Oj)},h=0;h<l;h++)u(h);return c}(s)})}return e.registerId=function(t){return Ip(t)},e.prototype.rehydrate=function(){!this.server&&Ox&&jC(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(on(on({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var n=r.useCSSOMInjection,s=r.target;return r.isServer?new ZI(s):n?new QI(s):new JI(s)}(this.options),new HI(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(Ip(t),this.names.has(t))this.names.get(t).add(r);else{var n=new Set;n.add(r),this.names.set(t,n)}},e.prototype.insertRules=function(t,r,n){this.registerName(t,r),this.getTag().insertRules(Ip(t),n)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Ip(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),tN=/&/g,rN=/^\s*\/\/.*$/gm;function gP(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(n){return"".concat(t," ").concat(n)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=gP(r.children,t)),r})}function nN(e){var t,r,n,s=Eu,i=s.options,o=i===void 0?Eu:i,l=s.plugins,c=l===void 0?T1:l,u=function(m,g,v){return v.startsWith(r)&&v.endsWith(r)&&v.replaceAll(r,"").length>0?".".concat(t):m},h=c.slice();h.push(function(m){m.type===j1&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(tN,r).replace(n,u))}),o.prefix&&h.push(TI),h.push(SI);var f=function(m,g,v,x){g===void 0&&(g=""),v===void 0&&(v=""),x===void 0&&(x="&"),t=x,r=g,n=new RegExp("\\".concat(r,"\\b"),"g");var y=m.replace(rN,""),_=jI(v||g?"".concat(v," ").concat(g," { ").concat(y," }"):y);o.namespace&&(_=gP(_,o.namespace));var b=[];return Mx(_,CI(h.concat($I(function(w){return b.push(w)})))),b};return f.hash=c.length?c.reduce(function(m,g){return g.name||Z0(15),Wd(m,g.name)},cP).toString():"",f}var sN=new Nx,t2=nN(),xP=li.createContext({shouldForwardProp:void 0,styleSheet:sN,stylis:t2});xP.Consumer;li.createContext(void 0);function r2(){return E.useContext(xP)}var vP=function(){function e(t,r){var n=this;this.inject=function(s,i){i===void 0&&(i=t2);var o=n.name+i.hash;s.hasNameForId(n.id,o)||s.insertRules(n.id,o,i(n.rules,o,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,Nj(this,function(){throw Z0(12,String(n.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=t2),this.name+t.hash},e}(),aN=function(e){return e>="A"&&e<="Z"};function SC(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(r===1&&n==="-"&&e[0]==="-")return e;aN(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var yP=function(e){return e==null||e===!1||e===""},bP=function(e){var t,r,n=[];for(var s in e){var i=e[s];e.hasOwnProperty(s)&&!yP(i)&&(Array.isArray(i)&&i.isCss||Au(i)?n.push("".concat(SC(s),":"),i,";"):y0(i)?n.push.apply(n,Su(Su(["".concat(s," {")],bP(i),!1),["}"],!1)):n.push("".concat(SC(s),": ").concat((t=s,(r=i)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in EI||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return n};function gl(e,t,r,n){if(yP(e))return[];if(Ij(e))return[".".concat(e.styledComponentId)];if(Au(e)){if(!Au(i=e)||i.prototype&&i.prototype.isReactComponent||!t)return[e];var s=e(t);return gl(s,t,r,n)}var i;return e instanceof vP?r?(e.inject(r,n),[e.getName(n)]):[e]:y0(e)?bP(e):Array.isArray(e)?Array.prototype.concat.apply(T1,e.map(function(o){return gl(o,t,r,n)})):[e.toString()]}function _P(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(Au(r)&&!Ij(r))return!1}return!0}var iN=dP($1),oN=function(){function e(t,r,n){this.rules=t,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&_P(t),this.componentId=r,this.baseHash=Wd(iN,r),this.baseStyle=n,Nx.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,n){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))s=hc(s,this.staticRulesId);else{var i=Rx(gl(this.rules,t,r,n)),o=Zw(Wd(this.baseHash,i)>>>0);if(!r.hasNameForId(this.componentId,o)){var l=n(i,".".concat(o),void 0,this.componentId);r.insertRules(this.componentId,o,l)}s=hc(s,o),this.staticRulesId=o}else{for(var c=Wd(this.baseHash,n.hash),u="",h=0;h<this.rules.length;h++){var f=this.rules[h];if(typeof f=="string")u+=f;else if(f){var m=Rx(gl(f,t,r,n));c=Wd(c,m+h),u+=m}}if(u){var g=Zw(c>>>0);r.hasNameForId(this.componentId,g)||r.insertRules(this.componentId,g,n(u,".".concat(g),void 0,this.componentId)),s=hc(s,g)}}return s},e}(),Lj=li.createContext(void 0);Lj.Consumer;var $v={};function lN(e,t,r){var n=Ij(e),s=e,i=!Cv(e),o=t.attrs,l=o===void 0?T1:o,c=t.componentId,u=c===void 0?function(C,j){var T=typeof C!="string"?"sc":vC(C);$v[T]=($v[T]||0)+1;var k="".concat(T,"-").concat(Rj($1+T+$v[T]));return j?"".concat(j,"-").concat(k):k}(t.displayName,t.parentComponentId):c,h=t.displayName,f=h===void 0?function(C){return Cv(C)?"styled.".concat(C):"Styled(".concat(OI(C),")")}(e):h,m=t.displayName&&t.componentId?"".concat(vC(t.displayName),"-").concat(t.componentId):t.componentId||u,g=n&&s.attrs?s.attrs.concat(l).filter(Boolean):l,v=t.shouldForwardProp;if(n&&s.shouldForwardProp){var x=s.shouldForwardProp;if(t.shouldForwardProp){var y=t.shouldForwardProp;v=function(C,j){return x(C,j)&&y(C,j)}}else v=x}var _=new oN(r,m,n?s.componentStyle:void 0);function b(C,j){return function(T,k,M){var A=T.attrs,O=T.componentStyle,F=T.defaultProps,B=T.foldedComponentIds,L=T.styledComponentId,U=T.target,P=li.useContext(Lj),Q=r2(),re=T.shouldForwardProp||Q.shouldForwardProp,Z=oP(k,P,F)||Eu,W=function(H,ee,J){for(var he,ge=on(on({},ee),{className:void 0,theme:J}),xe=0;xe<H.length;xe+=1){var De=Au(he=H[xe])?he(ge):he;for(var X in De)ge[X]=X==="className"?hc(ge[X],De[X]):X==="style"?on(on({},ge[X]),De[X]):De[X]}return ee.className&&(ge.className=hc(ge.className,ee.className)),ge}(A,k,Z),ce=W.as||U,te={};for(var D in W)W[D]===void 0||D[0]==="$"||D==="as"||D==="theme"&&W.theme===Z||(D==="forwardedAs"?te.as=W.forwardedAs:re&&!re(D,ce)||(te[D]=W[D]));var R=function(H,ee){var J=r2(),he=H.generateAndInjectStyles(ee,J.styleSheet,J.stylis);return he}(O,W),N=hc(B,L);return R&&(N+=" "+R),W.className&&(N+=" "+W.className),te[Cv(ce)&&!lP.has(ce)?"class":"className"]=N,M&&(te.ref=M),E.createElement(ce,te)}(w,C,j)}b.displayName=f;var w=li.forwardRef(b);return w.attrs=g,w.componentStyle=_,w.displayName=f,w.shouldForwardProp=v,w.foldedComponentIds=n?hc(s.foldedComponentIds,s.styledComponentId):"",w.styledComponentId=m,w.target=n?s.target:e,Object.defineProperty(w,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=n?function(j){for(var T=[],k=1;k<arguments.length;k++)T[k-1]=arguments[k];for(var M=0,A=T;M<A.length;M++)e2(j,A[M],!0);return j}({},s.defaultProps,C):C}}),Nj(w,function(){return".".concat(w.styledComponentId)}),i&&pP(w,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),w}function CC(e,t){for(var r=[e[0]],n=0,s=t.length;n<s;n+=1)r.push(t[n],e[n+1]);return r}var $C=function(e){return Object.assign(e,{isCss:!0})};function xs(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Au(e)||y0(e))return $C(gl(CC(T1,Su([e],t,!0))));var n=e;return t.length===0&&n.length===1&&typeof n[0]=="string"?gl(n):$C(gl(CC(n,t)))}function n2(e,t,r){if(r===void 0&&(r=Eu),!t)throw Z0(1,t);var n=function(s){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return e(t,r,xs.apply(void 0,Su([s],i,!1)))};return n.attrs=function(s){return n2(e,t,on(on({},r),{attrs:Array.prototype.concat(r.attrs,s).filter(Boolean)}))},n.withConfig=function(s){return n2(e,t,on(on({},r),s))},n}var wP=function(e){return n2(lN,e)},p=wP;lP.forEach(function(e){p[e]=wP(e)});var cN=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=_P(t),Nx.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,n,s){var i=s(Rx(gl(this.rules,r,n,s)),""),o=this.componentId+t;n.insertRules(o,o,i)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,n,s){t>2&&Nx.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,r,n,s)},e}();function dN(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=xs.apply(void 0,Su([e],t,!1)),s="sc-global-".concat(Rj(JSON.stringify(n))),i=new cN(n,s),o=function(c){var u=r2(),h=li.useContext(Lj),f=li.useRef(u.styleSheet.allocateGSInstance(s)).current;return u.styleSheet.server&&l(f,c,u.styleSheet,h,u.stylis),li.useLayoutEffect(function(){if(!u.styleSheet.server)return l(f,c,u.styleSheet,h,u.stylis),function(){return i.removeStyles(f,u.styleSheet)}},[f,c,u.styleSheet,h,u.stylis]),null};function l(c,u,h,f,m){if(i.isStatic)i.renderStyles(c,FI,h,m);else{var g=on(on({},u),{theme:oP(u,f,o.defaultProps)});i.renderStyles(c,g,h,m)}}return li.memo(o)}function uN(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Rx(xs.apply(void 0,Su([e],t,!1))),s=Rj(n);return new vP(s,n)}const hN={primary:"#003A81",primaryDark:"#002654",secondary:"#EC7126",accent:"#05C1CA",cardHeader:"#01214d",bgWhite:"#FFFFFF",bgLight:"#F2F2F2",bgMedium:"#E9ECEF",bgBlueLight:"#D1E3F8",success:"#28A745",warning:"#FFC107",danger:"#DC3545",error:"#DC3545",info:"#17A2B8",disabled:"#9E9E9E",textPrimary:"#212529",textSecondary:"#6C757D",textMuted:"#9E9E9E",textWhite:"#FFFFFF",link:"#003A81",linkHover:"#002654",border:"#dee2e6"},fN={fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",weights:{regular:400,medium:500,semibold:600,bold:700},sizes:{h1:"2rem",h2:"1.5rem",h3:"1.25rem",h4:"1rem",body:"0.875rem",small:"0.75rem",tiny:"0.625rem"},lineHeights:{tight:1.2,normal:1.5}},pN={xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem",xxl:"3rem"},mN={sm:"4px",md:"8px",lg:"12px",full:"50%"},gN={sm:"0 1px 3px rgba(0, 0, 0, 0.08)",md:"0 2px 8px rgba(0, 0, 0, 0.1)",lg:"0 4px 16px rgba(0, 0, 0, 0.12)"},xN={fast:"0.15s ease",normal:"0.2s ease"},d={colors:hN,typography:fN,spacing:pN,radius:mN,shadows:gN,transitions:xN},vN=dN`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
  }

  body {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
    font-weight: ${d.typography.weights.regular};
    line-height: ${d.typography.lineHeights.normal};
    color: ${d.colors.textPrimary};
    background-color: ${d.colors.bgLight};
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1, h2, h3, h4, h5, h6 {
    font-weight: ${d.typography.weights.semibold};
    line-height: ${d.typography.lineHeights.tight};
    color: ${d.colors.textPrimary};
    margin-bottom: ${d.spacing.md};
  }

  h1 { font-size: ${d.typography.sizes.h1}; }
  h2 { font-size: ${d.typography.sizes.h2}; }
  h3 { font-size: ${d.typography.sizes.h3}; }
  h4 { font-size: ${d.typography.sizes.h4}; }

  a {
    color: ${d.colors.link};
    text-decoration: none;
    transition: color ${d.transitions.fast};

    &:hover {
      color: ${d.colors.linkHover};
    }
  }

  button {
    font-family: ${d.typography.fontFamily};
    cursor: pointer;
  }

  input, select, textarea {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
  }

  #root {
    min-height: 100vh;
  }
`,yN={primary:xs`
    background-color: ${d.colors.primary};
    border-color: ${d.colors.primary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: ${d.colors.linkHover};
      border-color: ${d.colors.linkHover};
    }
  `,secondary:xs`
    background-color: ${d.colors.secondary};
    border-color: ${d.colors.secondary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #d4631f;
      border-color: #d4631f;
    }
  `,outline:xs`
    background-color: transparent;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};

    &:hover:not(:disabled) {
      background-color: ${d.colors.primary};
      color: ${d.colors.textWhite};
    }
  `,danger:xs`
    background-color: ${d.colors.danger};
    border-color: ${d.colors.danger};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #c82333;
      border-color: #c82333;
    }
  `},bN={sm:xs`
    padding: 0.375rem 0.75rem;
    font-size: ${d.typography.sizes.small};
  `,md:xs`
    padding: 0.5rem 1.25rem;
    font-size: ${d.typography.sizes.body};
  `,lg:xs`
    padding: 0.75rem 1.5rem;
    font-size: ${d.typography.sizes.h4};
  `},_N=p.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: ${d.spacing.xs};
  font-family: ${d.typography.fontFamily};
  font-weight: ${d.typography.weights.medium};
  border: 2px solid;
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};

  ${({$variant:e="primary"})=>yN[e]}
  ${({$size:e="md"})=>bN[e]}
  ${({$fullWidth:e})=>e&&xs`width: 100%;`}

  &:disabled {
    background-color: ${d.colors.disabled};
    border-color: ${d.colors.disabled};
    color: ${d.colors.textWhite};
    cursor: not-allowed;
    opacity: 0.7;
  }

  &:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.25);
  }
`;p.div`
  background-color: ${d.colors.bgWhite};
  border-radius: ${d.radius.md};
  box-shadow: ${d.shadows.md};
  overflow: hidden;
`;p.div`
  background-color: ${d.colors.cardHeader};
  color: ${d.colors.textWhite};
  padding: ${d.spacing.md} ${d.spacing.lg};
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`;p.div`
  padding: ${d.spacing.lg};
`;p.div`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border-top: 1px solid ${d.colors.border};
  background-color: ${d.colors.bgLight};
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
`;const wN=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};

  ${({$disabled:e})=>e&&xs`
      opacity: 0.6;
      pointer-events: none;
    `}
`,jN=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,kN=p.select`
  width: 100%;
  padding: 0.75rem 1rem;
  font-family: ${d.typography.fontFamily};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: ${({$hasError:e})=>e?"#fff5f5":d.colors.bgWhite};
  border: 1px solid ${({$hasError:e})=>e?"#dc3545":d.colors.border};
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236C757D' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.25rem;
  padding-right: 2.5rem;

  ${({$hasValue:e,$hasError:t})=>e&&!t&&xs`
      border-color: ${d.colors.accent};
      background-color: ${d.colors.bgBlueLight}15;
    `}

  &:hover:not(:disabled) {
    border-color: ${d.colors.accent};
  }

  &:focus {
    outline: none;
    border-color: ${d.colors.accent};
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.15);
  }

  &:disabled {
    background-color: ${d.colors.bgLight};
    cursor: not-allowed;
    opacity: 0.7;
  }

  option {
    padding: 0.5rem;
  }
`,SN=p.span`
  font-size: ${d.typography.sizes.small};
  color: ${({$error:e})=>e?d.colors.danger:d.colors.textMuted};
`;function gi({label:e,value:t,options:r,onChange:n,disabled:s=!1,placeholder:i="Seleccione...",helperText:o,error:l,stepNumber:c}){return a.jsxs(wN,{$disabled:s,children:[a.jsxs(jN,{style:{color:l?"#dc3545":void 0},children:[c&&a.jsx(CN,{children:c}),e]}),a.jsxs(kN,{value:t??"",onChange:u=>n(u.target.value),disabled:s,$hasValue:t!==null&&t!=="",$hasError:l,children:[a.jsx("option",{value:"",children:i}),r.map(u=>a.jsx("option",{value:u.value,children:u.label},u.value))]}),o&&a.jsx(SN,{$error:l,children:o})]})}const CN=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: ${d.spacing.xs};
  background-color: ${d.colors.primary};
  color: ${d.colors.textWhite};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.semibold};
`,$N=uN`
  to {
    transform: rotate(360deg);
  }
`,TC={sm:"1rem",md:"1.5rem",lg:"2rem"},TN=p.div`
  width: ${({$size:e="md"})=>TC[e]};
  height: ${({$size:e="md"})=>TC[e]};
  border: 2px solid ${d.colors.bgLight};
  border-top-color: ${d.colors.accent};
  border-radius: ${d.radius.full};
  animation: ${$N} 0.8s linear infinite;
`,EN=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: ${d.spacing.xl};
`;function AN({size:e="md"}){return a.jsx(EN,{children:a.jsx(TN,{$size:e})})}const FN=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: ${e=>e.$isOpen?"flex":"none"};
  justify-content: center;
  align-items: flex-start;
  padding: 2rem;
  z-index: 1000;
  overflow-y: auto;
`,PN=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  width: 100%;
  max-width: ${e=>{switch(e.$size){case"sm":return"400px";case"md":return"600px";case"lg":return"800px";case"xl":return"1140px";default:return"600px"}}};
  max-height: calc(100vh - 4rem);
  overflow: hidden;
  display: flex;
  flex-direction: column;
`,DN=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 1rem 1.25rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,MN=p.h2`
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
`,ON=p.button`
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
  opacity: 0.8;
  transition: opacity 0.2s;

  &:hover {
    opacity: 1;
  }
`,RN=p.div`
  padding: 1.25rem;
  overflow-y: auto;
  flex: 1;
  background: #f2f4fd;
`;function IN({isOpen:e,onClose:t,title:r,children:n,size:s="lg",showCloseButton:i=!0}){const o=E.useCallback(c=>{c.key==="Escape"&&t()},[t]),l=E.useCallback(c=>{c.target===c.currentTarget&&t()},[t]);return E.useEffect(()=>(e&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}),[e,o]),e?a.jsx(FN,{$isOpen:e,onClick:l,children:a.jsxs(PN,{$size:s,children:[a.jsxs(DN,{children:[a.jsx(MN,{children:r}),i&&a.jsx(ON,{onClick:t,children:""})]}),a.jsx(RN,{children:n})]})}):null}function jP(e,t){return function(){return e.apply(t,arguments)}}const{toString:NN}=Object.prototype,{getPrototypeOf:zj}=Object,{iterator:E1,toStringTag:kP}=Symbol,A1=(e=>t=>{const r=NN.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ma=e=>(e=e.toLowerCase(),t=>A1(t)===e),F1=e=>t=>typeof t===e,{isArray:Uu}=Array,Fu=F1("undefined");function ep(e){return e!==null&&!Fu(e)&&e.constructor!==null&&!Fu(e.constructor)&&Zn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const SP=Ma("ArrayBuffer");function LN(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&SP(e.buffer),t}const zN=F1("string"),Zn=F1("function"),CP=F1("number"),tp=e=>e!==null&&typeof e=="object",BN=e=>e===!0||e===!1,Jg=e=>{if(A1(e)!=="object")return!1;const t=zj(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(kP in e)&&!(E1 in e)},UN=e=>{if(!tp(e)||ep(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},VN=Ma("Date"),HN=Ma("File"),WN=Ma("Blob"),GN=Ma("FileList"),qN=e=>tp(e)&&Zn(e.pipe),KN=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Zn(e.append)&&((t=A1(e))==="formdata"||t==="object"&&Zn(e.toString)&&e.toString()==="[object FormData]"))},XN=Ma("URLSearchParams"),[YN,QN,JN,ZN]=["ReadableStream","Request","Response","Headers"].map(Ma),eL=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function rp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Uu(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(ep(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(n=0;n<o;n++)l=i[n],t.call(null,e[l],l,e)}}function $P(e,t){if(ep(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const fc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,TP=e=>!Fu(e)&&e!==fc;function s2(){const{caseless:e,skipUndefined:t}=TP(this)&&this||{},r={},n=(s,i)=>{const o=e&&$P(r,i)||i;Jg(r[o])&&Jg(s)?r[o]=s2(r[o],s):Jg(s)?r[o]=s2({},s):Uu(s)?r[o]=s.slice():(!t||!Fu(s))&&(r[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&rp(arguments[s],n);return r}const tL=(e,t,r,{allOwnKeys:n}={})=>(rp(t,(s,i)=>{r&&Zn(s)?e[i]=jP(s,r):e[i]=s},{allOwnKeys:n}),e),rL=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),nL=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},sL=(e,t,r,n)=>{let s,i,o;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&zj(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},aL=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},iL=e=>{if(!e)return null;if(Uu(e))return e;let t=e.length;if(!CP(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},oL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&zj(Uint8Array)),lL=(e,t)=>{const n=(e&&e[E1]).call(e);let s;for(;(s=n.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},cL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},dL=Ma("HTMLFormElement"),uL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),EC=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),hL=Ma("RegExp"),EP=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};rp(r,(s,i)=>{let o;(o=t(s,i,e))!==!1&&(n[i]=o||s)}),Object.defineProperties(e,n)},fL=e=>{EP(e,(t,r)=>{if(Zn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Zn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},pL=(e,t)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return Uu(e)?n(e):n(String(e).split(t)),r},mL=()=>{},gL=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function xL(e){return!!(e&&Zn(e.append)&&e[kP]==="FormData"&&e[E1])}const vL=e=>{const t=new Array(10),r=(n,s)=>{if(tp(n)){if(t.indexOf(n)>=0)return;if(ep(n))return n;if(!("toJSON"in n)){t[s]=n;const i=Uu(n)?[]:{};return rp(n,(o,l)=>{const c=r(o,s+1);!Fu(c)&&(i[l]=c)}),t[s]=void 0,i}}return n};return r(e,0)},yL=Ma("AsyncFunction"),bL=e=>e&&(tp(e)||Zn(e))&&Zn(e.then)&&Zn(e.catch),AP=((e,t)=>e?setImmediate:t?((r,n)=>(fc.addEventListener("message",({source:s,data:i})=>{s===fc&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),fc.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Zn(fc.postMessage)),_L=typeof queueMicrotask<"u"?queueMicrotask.bind(fc):typeof process<"u"&&process.nextTick||AP,wL=e=>e!=null&&Zn(e[E1]),le={isArray:Uu,isArrayBuffer:SP,isBuffer:ep,isFormData:KN,isArrayBufferView:LN,isString:zN,isNumber:CP,isBoolean:BN,isObject:tp,isPlainObject:Jg,isEmptyObject:UN,isReadableStream:YN,isRequest:QN,isResponse:JN,isHeaders:ZN,isUndefined:Fu,isDate:VN,isFile:HN,isBlob:WN,isRegExp:hL,isFunction:Zn,isStream:qN,isURLSearchParams:XN,isTypedArray:oL,isFileList:GN,forEach:rp,merge:s2,extend:tL,trim:eL,stripBOM:rL,inherits:nL,toFlatObject:sL,kindOf:A1,kindOfTest:Ma,endsWith:aL,toArray:iL,forEachEntry:lL,matchAll:cL,isHTMLForm:dL,hasOwnProperty:EC,hasOwnProp:EC,reduceDescriptors:EP,freezeMethods:fL,toObjectSet:pL,toCamelCase:uL,noop:mL,toFiniteNumber:gL,findKey:$P,global:fc,isContextDefined:TP,isSpecCompliantForm:xL,toJSONObject:vL,isAsyncFn:yL,isThenable:bL,setImmediate:AP,asap:_L,isIterable:wL};function Ve(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}le.inherits(Ve,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:le.toJSONObject(this.config),code:this.code,status:this.status}}});const FP=Ve.prototype,PP={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{PP[e]={value:e}});Object.defineProperties(Ve,PP);Object.defineProperty(FP,"isAxiosError",{value:!0});Ve.from=(e,t,r,n,s,i)=>{const o=Object.create(FP);le.toFlatObject(e,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Ve.call(o,l,c,r,n,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const jL=null;function a2(e){return le.isPlainObject(e)||le.isArray(e)}function DP(e){return le.endsWith(e,"[]")?e.slice(0,-2):e}function AC(e,t,r){return e?e.concat(t).map(function(s,i){return s=DP(s),!r&&i?"["+s+"]":s}).join(r?".":""):t}function kL(e){return le.isArray(e)&&!e.some(a2)}const SL=le.toFlatObject(le,{},null,function(t){return/^is[A-Z]/.test(t)});function P1(e,t,r){if(!le.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=le.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,y){return!le.isUndefined(y[x])});const n=r.metaTokens,s=r.visitor||h,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&le.isSpecCompliantForm(t);if(!le.isFunction(s))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(le.isDate(v))return v.toISOString();if(le.isBoolean(v))return v.toString();if(!c&&le.isBlob(v))throw new Ve("Blob is not supported. Use a Buffer instead.");return le.isArrayBuffer(v)||le.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,x,y){let _=v;if(v&&!y&&typeof v=="object"){if(le.endsWith(x,"{}"))x=n?x:x.slice(0,-2),v=JSON.stringify(v);else if(le.isArray(v)&&kL(v)||(le.isFileList(v)||le.endsWith(x,"[]"))&&(_=le.toArray(v)))return x=DP(x),_.forEach(function(w,C){!(le.isUndefined(w)||w===null)&&t.append(o===!0?AC([x],C,i):o===null?x:x+"[]",u(w))}),!1}return a2(v)?!0:(t.append(AC(y,x,i),u(v)),!1)}const f=[],m=Object.assign(SL,{defaultVisitor:h,convertValue:u,isVisitable:a2});function g(v,x){if(!le.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(v),le.forEach(v,function(_,b){(!(le.isUndefined(_)||_===null)&&s.call(t,_,le.isString(b)?b.trim():b,x,m))===!0&&g(_,x?x.concat(b):[b])}),f.pop()}}if(!le.isObject(e))throw new TypeError("data must be an object");return g(e),t}function FC(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Bj(e,t){this._pairs=[],e&&P1(e,this,t)}const MP=Bj.prototype;MP.append=function(t,r){this._pairs.push([t,r])};MP.toString=function(t){const r=t?function(n){return t.call(this,n,FC)}:FC;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function CL(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function OP(e,t,r){if(!t)return e;const n=r&&r.encode||CL;le.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(t,r):i=le.isURLSearchParams(t)?t.toString():new Bj(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class PC{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){le.forEach(this.handlers,function(n){n!==null&&t(n)})}}const RP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$L=typeof URLSearchParams<"u"?URLSearchParams:Bj,TL=typeof FormData<"u"?FormData:null,EL=typeof Blob<"u"?Blob:null,AL={isBrowser:!0,classes:{URLSearchParams:$L,FormData:TL,Blob:EL},protocols:["http","https","file","blob","url","data"]},Uj=typeof window<"u"&&typeof document<"u",i2=typeof navigator=="object"&&navigator||void 0,FL=Uj&&(!i2||["ReactNative","NativeScript","NS"].indexOf(i2.product)<0),PL=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",DL=Uj&&window.location.href||"http://localhost",ML=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Uj,hasStandardBrowserEnv:FL,hasStandardBrowserWebWorkerEnv:PL,navigator:i2,origin:DL},Symbol.toStringTag,{value:"Module"})),sn={...ML,...AL};function OL(e,t){return P1(e,new sn.classes.URLSearchParams,{visitor:function(r,n,s,i){return sn.isNode&&le.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function RL(e){return le.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function IL(e){const t={},r=Object.keys(e);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],t[i]=e[i];return t}function IP(e){function t(r,n,s,i){let o=r[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=r.length;return o=!o&&le.isArray(s)?s.length:o,c?(le.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!l):((!s[o]||!le.isObject(s[o]))&&(s[o]=[]),t(r,n,s[o],i)&&le.isArray(s[o])&&(s[o]=IL(s[o])),!l)}if(le.isFormData(e)&&le.isFunction(e.entries)){const r={};return le.forEachEntry(e,(n,s)=>{t(RL(n),s,r,0)}),r}return null}function NL(e,t,r){if(le.isString(e))try{return(t||JSON.parse)(e),le.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const np={transitional:RP,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=le.isObject(t);if(i&&le.isHTMLForm(t)&&(t=new FormData(t)),le.isFormData(t))return s?JSON.stringify(IP(t)):t;if(le.isArrayBuffer(t)||le.isBuffer(t)||le.isStream(t)||le.isFile(t)||le.isBlob(t)||le.isReadableStream(t))return t;if(le.isArrayBufferView(t))return t.buffer;if(le.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return OL(t,this.formSerializer).toString();if((l=le.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return P1(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),NL(t)):t}],transformResponse:[function(t){const r=this.transitional||np.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(le.isResponse(t)||le.isReadableStream(t))return t;if(t&&le.isString(t)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Ve.from(l,Ve.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:sn.classes.FormData,Blob:sn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};le.forEach(["delete","get","head","post","put","patch"],e=>{np.headers[e]={}});const LL=le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),zL=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||t[r]&&LL[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},DC=Symbol("internals");function uh(e){return e&&String(e).trim().toLowerCase()}function Zg(e){return e===!1||e==null?e:le.isArray(e)?e.map(Zg):String(e)}function BL(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const UL=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Tv(e,t,r,n,s){if(le.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!le.isString(t)){if(le.isString(n))return t.indexOf(n)!==-1;if(le.isRegExp(n))return n.test(t)}}function VL(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function HL(e,t){const r=le.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,i,o){return this[n].call(this,t,s,i,o)},configurable:!0})})}let es=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function i(l,c,u){const h=uh(c);if(!h)throw new Error("header name must be a non-empty string");const f=le.findKey(s,h);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Zg(l))}const o=(l,c)=>le.forEach(l,(u,h)=>i(u,h,c));if(le.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(le.isString(t)&&(t=t.trim())&&!UL(t))o(zL(t),r);else if(le.isObject(t)&&le.isIterable(t)){let l={},c,u;for(const h of t){if(!le.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?le.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(l,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=uh(t),t){const n=le.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return BL(s);if(le.isFunction(r))return r.call(this,s,n);if(le.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=uh(t),t){const n=le.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Tv(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function i(o){if(o=uh(o),o){const l=le.findKey(n,o);l&&(!r||Tv(n,n[l],l,r))&&(delete n[l],s=!0)}}return le.isArray(t)?t.forEach(i):i(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!t||Tv(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const r=this,n={};return le.forEach(this,(s,i)=>{const o=le.findKey(n,i);if(o){r[o]=Zg(s),delete r[i];return}const l=t?VL(i):String(i).trim();l!==i&&delete r[i],r[l]=Zg(s),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return le.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&le.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[DC]=this[DC]={accessors:{}}).accessors,s=this.prototype;function i(o){const l=uh(o);n[l]||(HL(s,o),n[l]=!0)}return le.isArray(t)?t.forEach(i):i(t),this}};es.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);le.reduceDescriptors(es.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});le.freezeMethods(es);function Ev(e,t){const r=this||np,n=t||r,s=es.from(n.headers);let i=n.data;return le.forEach(e,function(l){i=l.call(r,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function NP(e){return!!(e&&e.__CANCEL__)}function Vu(e,t,r){Ve.call(this,e??"canceled",Ve.ERR_CANCELED,t,r),this.name="CanceledError"}le.inherits(Vu,Ve,{__CANCEL__:!0});function LP(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ve("Request failed with status code "+r.status,[Ve.ERR_BAD_REQUEST,Ve.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function WL(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function GL(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),h=n[i];o||(o=u),r[s]=c,n[s]=u;let f=i,m=0;for(;f!==s;)m+=r[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),u-o<t)return;const g=h&&u-h;return g?Math.round(m*1e3/g):void 0}}function qL(e,t){let r=0,n=1e3/t,s,i;const o=(u,h=Date.now())=>{r=h,s=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const h=Date.now(),f=h-r;f>=n?o(u,h):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},n-f)))},()=>s&&o(s)]}const Lx=(e,t,r=3)=>{let n=0;const s=GL(50,250);return qL(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-n,u=s(c),h=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-o)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},MC=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},OC=e=>(...t)=>le.asap(()=>e(...t)),KL=sn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,sn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(sn.origin),sn.navigator&&/(msie|trident)/i.test(sn.navigator.userAgent)):()=>!0,XL=sn.hasStandardBrowserEnv?{write(e,t,r,n,s,i,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];le.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),le.isString(n)&&l.push(`path=${n}`),le.isString(s)&&l.push(`domain=${s}`),i===!0&&l.push("secure"),le.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function YL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function QL(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function zP(e,t,r){let n=!YL(t);return e&&(n||r==!1)?QL(e,t):t}const RC=e=>e instanceof es?{...e}:e;function Vc(e,t){t=t||{};const r={};function n(u,h,f,m){return le.isPlainObject(u)&&le.isPlainObject(h)?le.merge.call({caseless:m},u,h):le.isPlainObject(h)?le.merge({},h):le.isArray(h)?h.slice():h}function s(u,h,f,m){if(le.isUndefined(h)){if(!le.isUndefined(u))return n(void 0,u,f,m)}else return n(u,h,f,m)}function i(u,h){if(!le.isUndefined(h))return n(void 0,h)}function o(u,h){if(le.isUndefined(h)){if(!le.isUndefined(u))return n(void 0,u)}else return n(void 0,h)}function l(u,h,f){if(f in t)return n(u,h);if(f in e)return n(void 0,u)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,h,f)=>s(RC(u),RC(h),f,!0)};return le.forEach(Object.keys({...e,...t}),function(h){const f=c[h]||s,m=f(e[h],t[h],h);le.isUndefined(m)&&f!==l||(r[h]=m)}),r}const BP=e=>{const t=Vc({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=es.from(o),t.url=OP(zP(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),le.isFormData(r)){if(sn.hasStandardBrowserEnv||sn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(le.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([h,f])=>{u.includes(h.toLowerCase())&&o.set(h,f)})}}if(sn.hasStandardBrowserEnv&&(n&&le.isFunction(n)&&(n=n(t)),n||n!==!1&&KL(t.url))){const c=s&&i&&XL.read(i);c&&o.set(s,c)}return t},JL=typeof XMLHttpRequest<"u",ZL=JL&&function(e){return new Promise(function(r,n){const s=BP(e);let i=s.data;const o=es.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,h,f,m,g,v;function x(){g&&g(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function _(){if(!y)return;const w=es.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};LP(function(k){r(k),x()},function(k){n(k),x()},j),y=null}"onloadend"in y?y.onloadend=_:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(_)},y.onabort=function(){y&&(n(new Ve("Request aborted",Ve.ECONNABORTED,e,y)),y=null)},y.onerror=function(C){const j=C&&C.message?C.message:"Network Error",T=new Ve(j,Ve.ERR_NETWORK,e,y);T.event=C||null,n(T),y=null},y.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const j=s.transitional||RP;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),n(new Ve(C,j.clarifyTimeoutError?Ve.ETIMEDOUT:Ve.ECONNABORTED,e,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&le.forEach(o.toJSON(),function(C,j){y.setRequestHeader(j,C)}),le.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),l&&l!=="json"&&(y.responseType=s.responseType),u&&([m,v]=Lx(u,!0),y.addEventListener("progress",m)),c&&y.upload&&([f,g]=Lx(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(h=w=>{y&&(n(!w||w.type?new Vu(null,e,y):w),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const b=WL(s.url);if(b&&sn.protocols.indexOf(b)===-1){n(new Ve("Unsupported protocol "+b+":",Ve.ERR_BAD_REQUEST,e));return}y.send(i||null)})},ez=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const i=function(u){if(!s){s=!0,l();const h=u instanceof Error?u:this.reason;n.abort(h instanceof Ve?h:new Vu(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,i(new Ve(`timeout ${t} of ms exceeded`,Ve.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>le.asap(l),c}},tz=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},rz=async function*(e,t){for await(const r of nz(e))yield*tz(r,t)},nz=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},IC=(e,t,r,n)=>{const s=rz(e,t);let i=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await s.next();if(u){l(),c.close();return}let f=h.byteLength;if(r){let m=i+=f;r(m)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},NC=64*1024,{isFunction:Np}=le,sz=(({Request:e,Response:t})=>({Request:e,Response:t}))(le.global),{ReadableStream:LC,TextEncoder:zC}=le.global,BC=(e,...t)=>{try{return!!e(...t)}catch{return!1}},az=e=>{e=le.merge.call({skipUndefined:!0},sz,e);const{fetch:t,Request:r,Response:n}=e,s=t?Np(t):typeof fetch=="function",i=Np(r),o=Np(n);if(!s)return!1;const l=s&&Np(LC),c=s&&(typeof zC=="function"?(v=>x=>v.encode(x))(new zC):async v=>new Uint8Array(await new r(v).arrayBuffer())),u=i&&l&&BC(()=>{let v=!1;const x=new r(sn.origin,{body:new LC,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!x}),h=o&&l&&BC(()=>le.isReadableStream(new n("").body)),f={stream:h&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!f[v]&&(f[v]=(x,y)=>{let _=x&&x[v];if(_)return _.call(x);throw new Ve(`Response type '${v}' is not supported`,Ve.ERR_NOT_SUPPORT,y)})});const m=async v=>{if(v==null)return 0;if(le.isBlob(v))return v.size;if(le.isSpecCompliantForm(v))return(await new r(sn.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(le.isArrayBufferView(v)||le.isArrayBuffer(v))return v.byteLength;if(le.isURLSearchParams(v)&&(v=v+""),le.isString(v))return(await c(v)).byteLength},g=async(v,x)=>{const y=le.toFiniteNumber(v.getContentLength());return y??m(x)};return async v=>{let{url:x,method:y,data:_,signal:b,cancelToken:w,timeout:C,onDownloadProgress:j,onUploadProgress:T,responseType:k,headers:M,withCredentials:A="same-origin",fetchOptions:O}=BP(v),F=t||fetch;k=k?(k+"").toLowerCase():"text";let B=ez([b,w&&w.toAbortSignal()],C),L=null;const U=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let P;try{if(T&&u&&y!=="get"&&y!=="head"&&(P=await g(M,_))!==0){let te=new r(x,{method:"POST",body:_,duplex:"half"}),D;if(le.isFormData(_)&&(D=te.headers.get("content-type"))&&M.setContentType(D),te.body){const[R,N]=MC(P,Lx(OC(T)));_=IC(te.body,NC,R,N)}}le.isString(A)||(A=A?"include":"omit");const Q=i&&"credentials"in r.prototype,re={...O,signal:B,method:y.toUpperCase(),headers:M.normalize().toJSON(),body:_,duplex:"half",credentials:Q?A:void 0};L=i&&new r(x,re);let Z=await(i?F(L,O):F(x,re));const W=h&&(k==="stream"||k==="response");if(h&&(j||W&&U)){const te={};["status","statusText","headers"].forEach(H=>{te[H]=Z[H]});const D=le.toFiniteNumber(Z.headers.get("content-length")),[R,N]=j&&MC(D,Lx(OC(j),!0))||[];Z=new n(IC(Z.body,NC,R,()=>{N&&N(),U&&U()}),te)}k=k||"text";let ce=await f[le.findKey(f,k)||"text"](Z,v);return!W&&U&&U(),await new Promise((te,D)=>{LP(te,D,{data:ce,headers:es.from(Z.headers),status:Z.status,statusText:Z.statusText,config:v,request:L})})}catch(Q){throw U&&U(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new Ve("Network Error",Ve.ERR_NETWORK,v,L),{cause:Q.cause||Q}):Ve.from(Q,Q&&Q.code,v,L)}}},iz=new Map,UP=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,i=[n,s,r];let o=i.length,l=o,c,u,h=iz;for(;l--;)c=i[l],u=h.get(c),u===void 0&&h.set(c,u=l?new Map:az(t)),h=u;return u};UP();const Vj={http:jL,xhr:ZL,fetch:{get:UP}};le.forEach(Vj,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const UC=e=>`- ${e}`,oz=e=>le.isFunction(e)||e===null||e===!1;function lz(e,t){e=le.isArray(e)?e:[e];const{length:r}=e;let n,s;const i={};for(let o=0;o<r;o++){n=e[o];let l;if(s=n,!oz(n)&&(s=Vj[(l=String(n)).toLowerCase()],s===void 0))throw new Ve(`Unknown adapter '${l}'`);if(s&&(le.isFunction(s)||(s=s.get(t))))break;i[l||"#"+o]=s}if(!s){const o=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(UC).join(`
`):" "+UC(o[0]):"as no adapter specified";throw new Ve("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s}const VP={getAdapter:lz,adapters:Vj};function Av(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Vu(null,e)}function VC(e){return Av(e),e.headers=es.from(e.headers),e.data=Ev.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),VP.getAdapter(e.adapter||np.adapter,e)(e).then(function(n){return Av(e),n.data=Ev.call(e,e.transformResponse,n),n.headers=es.from(n.headers),n},function(n){return NP(n)||(Av(e),n&&n.response&&(n.response.data=Ev.call(e,e.transformResponse,n.response),n.response.headers=es.from(n.response.headers))),Promise.reject(n)})}const HP="1.13.2",D1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{D1[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const HC={};D1.transitional=function(t,r,n){function s(i,o){return"[Axios v"+HP+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,l)=>{if(t===!1)throw new Ve(s(o," has been removed"+(r?" in "+r:"")),Ve.ERR_DEPRECATED);return r&&!HC[o]&&(HC[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,l):!0}};D1.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function cz(e,t,r){if(typeof e!="object")throw new Ve("options must be an object",Ve.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const i=n[s],o=t[i];if(o){const l=e[i],c=l===void 0||o(l,i,e);if(c!==!0)throw new Ve("option "+i+" must be "+c,Ve.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ve("Unknown option "+i,Ve.ERR_BAD_OPTION)}}const ex={assertOptions:cz,validators:D1},La=ex.validators;let Tc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new PC,response:new PC}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Vc(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&ex.assertOptions(n,{silentJSONParsing:La.transitional(La.boolean),forcedJSONParsing:La.transitional(La.boolean),clarifyTimeoutError:La.transitional(La.boolean)},!1),s!=null&&(le.isFunction(s)?r.paramsSerializer={serialize:s}:ex.assertOptions(s,{encode:La.function,serialize:La.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ex.assertOptions(r,{baseUrl:La.spelling("baseURL"),withXsrfToken:La.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&le.merge(i.common,i[r.method]);i&&le.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),r.headers=es.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const u=[];this.interceptors.response.forEach(function(x){u.push(x.fulfilled,x.rejected)});let h,f=0,m;if(!c){const v=[VC.bind(this),void 0];for(v.unshift(...l),v.push(...u),m=v.length,h=Promise.resolve(r);f<m;)h=h.then(v[f++],v[f++]);return h}m=l.length;let g=r;for(;f<m;){const v=l[f++],x=l[f++];try{g=v(g)}catch(y){x.call(this,y);break}}try{h=VC.call(this,g)}catch(v){return Promise.reject(v)}for(f=0,m=u.length;f<m;)h=h.then(u[f++],u[f++]);return h}getUri(t){t=Vc(this.defaults,t);const r=zP(t.baseURL,t.url,t.allowAbsoluteUrls);return OP(r,t.params,t.paramsSerializer)}};le.forEach(["delete","get","head","options"],function(t){Tc.prototype[t]=function(r,n){return this.request(Vc(n||{},{method:t,url:r,data:(n||{}).data}))}});le.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,l){return this.request(Vc(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Tc.prototype[t]=r(),Tc.prototype[t+"Form"]=r(!0)});let dz=class WP{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(l=>{n.subscribe(l),i=l}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,l){n.reason||(n.reason=new Vu(i,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new WP(function(s){t=s}),cancel:t}}};function uz(e){return function(r){return e.apply(null,r)}}function hz(e){return le.isObject(e)&&e.isAxiosError===!0}const o2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(o2).forEach(([e,t])=>{o2[t]=e});function GP(e){const t=new Tc(e),r=jP(Tc.prototype.request,t);return le.extend(r,Tc.prototype,t,{allOwnKeys:!0}),le.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return GP(Vc(e,s))},r}const Zt=GP(np);Zt.Axios=Tc;Zt.CanceledError=Vu;Zt.CancelToken=dz;Zt.isCancel=NP;Zt.VERSION=HP;Zt.toFormData=P1;Zt.AxiosError=Ve;Zt.Cancel=Zt.CanceledError;Zt.all=function(t){return Promise.all(t)};Zt.spread=uz;Zt.isAxiosError=hz;Zt.mergeConfig=Vc;Zt.AxiosHeaders=es;Zt.formToJSON=e=>IP(le.isHTMLForm(e)?new FormData(e):e);Zt.getAdapter=VP.getAdapter;Zt.HttpStatusCode=o2;Zt.default=Zt;const{Axios:qfe,AxiosError:Kfe,CanceledError:Xfe,isCancel:Yfe,CancelToken:Qfe,VERSION:Jfe,all:Zfe,Cancel:e0e,isAxiosError:t0e,spread:r0e,toFormData:n0e,AxiosHeaders:s0e,HttpStatusCode:a0e,formToJSON:i0e,getAdapter:o0e,mergeConfig:l0e}=Zt,fz="/api/v1",pz="http://localhost:8001",Uf="inveb_cascade_token",tx="inveb_cascade_user",ue=Zt.create({baseURL:fz,headers:{"Content-Type":"application/json"}});Zt.create({baseURL:pz,headers:{"Content-Type":"application/json"}});ue.interceptors.request.use(e=>{var r;const t=localStorage.getItem(Uf);return t&&(e.headers.Authorization=`Bearer ${t}`),console.log(`[API] ${(r=e.method)==null?void 0:r.toUpperCase()} ${e.url}`),e},e=>Promise.reject(e));ue.interceptors.response.use(e=>e,e=>{var t,r;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem(Uf),localStorage.removeItem(tx)),console.error("[API Error]",((r=e.response)==null?void 0:r.data)||e.message),Promise.reject(e)});const Ec={login:async e=>{const t=await ue.post("/auth/login",e);return localStorage.setItem(Uf,t.data.access_token),localStorage.setItem(tx,JSON.stringify(t.data.user)),t.data},logout:()=>{localStorage.removeItem(Uf),localStorage.removeItem(tx)},getCurrentUser:async()=>(await ue.get("/auth/me")).data,isAuthenticated:()=>!!localStorage.getItem(Uf),getStoredUser:()=>{const e=localStorage.getItem(tx);if(e)try{return JSON.parse(e)}catch{return null}return null},verifyToken:async()=>{try{return(await ue.post("/auth/verify")).data.valid}catch{return!1}},changePassword:async(e,t)=>(await ue.post("/auth/change-password",{current_password:e,new_password:t})).data,forgotPassword:async e=>(await ue.post("/auth/forgot-password",{email:e})).data,validateResetToken:async(e,t)=>(await ue.post("/auth/validate-reset-token",{token:e,email:t})).data,resetPassword:async(e,t,r)=>(await ue.post("/auth/reset-password",{token:e,email:t,new_password:r})).data},dn={list:async(e={})=>{var n,s,i,o,l,c,u;const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.id_ot&&t.append("id_ot",e.id_ot.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.carton&&t.append("carton",e.carton),e.material&&t.append("material",e.material),e.descripcion&&t.append("descripcion",e.descripcion),(n=e.client_id)==null||n.forEach(h=>t.append("client_id",h.toString())),(s=e.estado_id)==null||s.forEach(h=>t.append("estado_id",h.toString())),(i=e.area_id)==null||i.forEach(h=>t.append("area_id",h.toString())),(o=e.canal_id)==null||o.forEach(h=>t.append("canal_id",h.toString())),(l=e.vendedor_id)==null||l.forEach(h=>t.append("vendedor_id",h.toString())),(c=e.planta_id)==null||c.forEach(h=>t.append("planta_id",h.toString())),(u=e.tipo_solicitud)==null||u.forEach(h=>t.append("tipo_solicitud",h.toString())),(await ue.get(`/work-orders/?${t.toString()}`)).data},getFilterOptions:async()=>(await ue.get("/work-orders/filter-options")).data,get:async e=>(await ue.get(`/work-orders/${e}`)).data,create:async e=>(await ue.post("/work-orders/",e)).data,update:async(e,t)=>(await ue.put(`/work-orders/${e}`,t)).data,getManagementHistory:async e=>(await ue.get(`/work-orders/${e}/management`)).data,getWorkflowOptions:async e=>(await ue.get(`/work-orders/${e}/workflow-options`)).data,transition:async(e,t)=>(await ue.post(`/work-orders/${e}/transition`,t)).data,getPendingApproval:async(e=1,t=20)=>(await ue.get(`/work-orders/pending-approval?page=${e}&page_size=${t}`)).data,approve:async e=>(await ue.put(`/work-orders/${e}/approve`)).data,reject:async e=>(await ue.put(`/work-orders/${e}/reject`)).data},mz={downloadOTExcel:async e=>{const t=await ue.get(`/exports/ot/${e}/excel`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTSAP:async e=>{const t=await ue.get(`/exports/ot/${e}/sap`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`SAP_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTsListExcel:async(e={})=>{const t=new URLSearchParams;e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.area_id&&t.append("area_id",e.area_id.toString()),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.client_id&&t.append("client_id",e.client_id.toString()),e.fecha_desde&&t.append("fecha_desde",e.fecha_desde),e.fecha_hasta&&t.append("fecha_hasta",e.fecha_hasta);const r=await ue.get(`/exports/ots/excel?${t.toString()}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),s=document.createElement("a");s.href=n,s.setAttribute("download",`Lista_OTs_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(n)},getOTLog:async(e,t={})=>{const r=new URLSearchParams;return t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString()),t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),(await ue.get(`/exports/ot/${e}/log?${r.toString()}`)).data},downloadOTLogExcel:async(e,t={})=>{const r=new URLSearchParams;t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString());const n=await ue.get(`/exports/ot/${e}/log/excel?${r.toString()}`,{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([n.data])),i=document.createElement("a");i.href=s,i.setAttribute("download",`Log_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(s)}},b0={downloadEtiquetaMuestra:async(e,t="producto")=>{const r=await ue.get(`/pdfs/etiqueta-muestra/${e}?tipo=${t}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),s=document.createElement("a");s.href=n,s.setAttribute("download",`Etiqueta_${t==="producto"?"Producto":"Cliente"}_${e}.pdf`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(n)},downloadFichaDiseno:async e=>{const t=await ue.get(`/pdfs/ficha-diseno/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Ficha_Diseno_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadEstudioBench:async e=>{const t=await ue.get(`/pdfs/estudio-bench/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Estudio_Benchmarking_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadCotizacion:async e=>{const t=await ue.get(`/pdfs/cotizacion/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Cotizacion_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)}},WC={getInstalacionesCliente:async e=>(await ue.get(`/cascades/clientes/${e}/instalaciones`)).data,getInstalacionesClienteCotiza:async e=>(await ue.get(`/cascades/clientes/${e}/instalaciones-cotiza`)).data,getContactosCliente:async(e,t)=>{const r=t?`?instalacion_id=${t}`:"";return(await ue.get(`/cascades/clientes/${e}/contactos${r}`)).data},getInformacionInstalacion:async e=>(await ue.get(`/cascades/instalaciones/${e}`)).data,getDatosContacto:async e=>(await ue.get(`/cascades/contactos/${e}`)).data,getServiciosMaquila:async e=>(await ue.get(`/cascades/productos/${e}/servicios-maquila`)).data,getRubro:async e=>(await ue.get(`/cascades/jerarquias/${e}/rubro`)).data,getJerarquia2Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await ue.get(`/cascades/jerarquias/nivel2-rubro?hierarchy_id=${e}${r}`)).data},getJerarquia3Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await ue.get(`/cascades/jerarquias/nivel3-rubro?subhierarchy_id=${e}${r}`)).data}},gz={getFormOptions:async()=>(await ue.get("/form-options/")).data},qP={list:async(e=1,t=20)=>(await ue.get("/notifications/",{params:{page:e,page_size:t}})).data,markAsRead:async e=>(await ue.put(`/notifications/${e}/read`)).data,create:async e=>(await ue.post("/notifications/",e)).data,getCount:async()=>(await ue.get("/notifications/count")).data},Hu={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.clasificacion_id&&t.append("clasificacion_id",e.clasificacion_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await ue.get(`/mantenedores/clients/?${t.toString()}`)).data},get:async e=>(await ue.get(`/mantenedores/clients/${e}`)).data,create:async e=>(await ue.post("/mantenedores/clients/",e)).data,update:async(e,t)=>(await ue.put(`/mantenedores/clients/${e}`,t)).data,activate:async e=>(await ue.put(`/mantenedores/clients/${e}/activate`)).data,deactivate:async e=>(await ue.put(`/mantenedores/clients/${e}/deactivate`)).data,getClasificaciones:async()=>(await ue.get("/mantenedores/clients/clasificaciones")).data},ed={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.role_id&&t.append("role_id",e.role_id.toString()),e.work_space_id&&t.append("work_space_id",e.work_space_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await ue.get(`/mantenedores/users/?${t.toString()}`)).data},get:async e=>(await ue.get(`/mantenedores/users/${e}`)).data,create:async e=>(await ue.post("/mantenedores/users/",e)).data,update:async(e,t)=>(await ue.put(`/mantenedores/users/${e}`,t)).data,activate:async e=>(await ue.put(`/mantenedores/users/${e}/activate`)).data,deactivate:async e=>(await ue.put(`/mantenedores/users/${e}/deactivate`)).data,getRoles:async()=>(await ue.get("/mantenedores/users/roles")).data,getWorkSpaces:async()=>(await ue.get("/mantenedores/users/workspaces")).data},Ri={getTablas:async()=>(await ue.get("/mantenedores/generic/tablas")).data,list:async(e,t={})=>{const r=new URLSearchParams;return t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),t.search&&r.append("search",t.search),t.activo!==void 0&&r.append("activo",t.activo.toString()),(await ue.get(`/mantenedores/generic/${e}?${r.toString()}`)).data},get:async(e,t)=>(await ue.get(`/mantenedores/generic/${e}/${t}`)).data,create:async(e,t)=>(await ue.post(`/mantenedores/generic/${e}`,{data:t})).data,update:async(e,t,r)=>(await ue.put(`/mantenedores/generic/${e}/${t}`,{data:r})).data,activate:async(e,t)=>(await ue.put(`/mantenedores/generic/${e}/${t}/activate`)).data,deactivate:async(e,t)=>(await ue.put(`/mantenedores/generic/${e}/${t}/deactivate`)).data,bulkUpload:async(e,t)=>(await ue.post(`/mantenedores/generic/${e}/bulk`,{items:t})).data},lr={listNivel1:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await ue.get(`/mantenedores/jerarquias/nivel1?${t.toString()}`)).data},getNivel1:async e=>(await ue.get(`/mantenedores/jerarquias/nivel1/${e}`)).data,createNivel1:async e=>(await ue.post("/mantenedores/jerarquias/nivel1",e)).data,updateNivel1:async(e,t)=>(await ue.put(`/mantenedores/jerarquias/nivel1/${e}`,t)).data,activateNivel1:async e=>(await ue.put(`/mantenedores/jerarquias/nivel1/${e}/activate`)).data,deactivateNivel1:async e=>(await ue.put(`/mantenedores/jerarquias/nivel1/${e}/deactivate`)).data,getNivel2Parents:async()=>(await ue.get("/mantenedores/jerarquias/nivel2/parents")).data,listNivel2:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),(await ue.get(`/mantenedores/jerarquias/nivel2?${t.toString()}`)).data},getNivel2:async e=>(await ue.get(`/mantenedores/jerarquias/nivel2/${e}`)).data,createNivel2:async e=>(await ue.post("/mantenedores/jerarquias/nivel2",e)).data,updateNivel2:async(e,t)=>(await ue.put(`/mantenedores/jerarquias/nivel2/${e}`,t)).data,activateNivel2:async e=>(await ue.put(`/mantenedores/jerarquias/nivel2/${e}/activate`)).data,deactivateNivel2:async e=>(await ue.put(`/mantenedores/jerarquias/nivel2/${e}/deactivate`)).data,getNivel3Parents:async e=>{const t=new URLSearchParams;return e&&t.append("hierarchy_id",e.toString()),(await ue.get(`/mantenedores/jerarquias/nivel3/parents?${t.toString()}`)).data},listNivel3:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),e.subhierarchy_id&&t.append("subhierarchy_id",e.subhierarchy_id.toString()),(await ue.get(`/mantenedores/jerarquias/nivel3?${t.toString()}`)).data},getNivel3:async e=>(await ue.get(`/mantenedores/jerarquias/nivel3/${e}`)).data,createNivel3:async e=>(await ue.post("/mantenedores/jerarquias/nivel3",e)).data,updateNivel3:async(e,t)=>(await ue.put(`/mantenedores/jerarquias/nivel3/${e}`,t)).data,activateNivel3:async e=>(await ue.put(`/mantenedores/jerarquias/nivel3/${e}/activate`)).data,deactivateNivel3:async e=>(await ue.put(`/mantenedores/jerarquias/nivel3/${e}/deactivate`)).data},ka={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.user_id&&t.append("user_id",e.user_id.toString()),e.cotizacion_id&&t.append("cotizacion_id",e.cotizacion_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.estado_id&&e.estado_id.forEach(n=>t.append("estado_id",n.toString())),e.client_id&&e.client_id.forEach(n=>t.append("client_id",n.toString())),(await ue.get(`/cotizaciones/?${t.toString()}`)).data},get:async e=>(await ue.get(`/cotizaciones/${e}`)).data,create:async e=>(await ue.post("/cotizaciones/",e)).data,update:async(e,t)=>(await ue.put(`/cotizaciones/${e}`,t)).data,delete:async e=>(await ue.delete(`/cotizaciones/${e}`)).data,solicitarAprobacion:async e=>(await ue.post(`/cotizaciones/${e}/solicitar-aprobacion`)).data,gestionarAprobacion:async(e,t,r)=>(await ue.post(`/cotizaciones/${e}/gestionar-aprobacion`,{action:t,motivo:r})).data,getAprobaciones:async e=>(await ue.get(`/cotizaciones/${e}/aprobaciones`)).data,duplicar:async e=>(await ue.post(`/cotizaciones/${e}/duplicar`)).data,versionar:async e=>(await ue.post(`/cotizaciones/${e}/versionar`)).data,retomar:async e=>(await ue.post(`/cotizaciones/${e}/retomar`)).data,getEstados:async()=>(await ue.get("/cotizaciones/estados/")).data,getPendientesAprobacion:async e=>{const t=new URLSearchParams;return e&&t.append("role_id",e.toString()),(await ue.get(`/cotizaciones/pendientes-aprobacion/?${t.toString()}`)).data},exportPdf:async e=>{const t=await ue.get(`/cotizaciones/${e}/export-pdf`,{responseType:"blob"}),r=new Blob([t.data],{type:t.headers["content-type"]}),n=window.URL.createObjectURL(r),s=document.createElement("a");s.href=n;const i=t.headers["content-disposition"];let o=`cotizacion_${e}.pdf`;if(i){const l=i.match(/filename=(.+)/);l&&(o=l[1])}s.setAttribute("download",o),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n)},getPendientesAprobacionExterno:async(e={})=>{const t=new URLSearchParams;return Object.entries(e).forEach(([n,s])=>{s!=null&&s!==""&&t.append(n,s.toString())}),(await ue.get(`/cotizaciones/pendientes-aprobacion-externo/?${t.toString()}`)).data},solicitarAprobacionExterno:async(e,t)=>(await ue.post(`/cotizaciones/${e}/solicitar-aprobacion-externo?user_id=${t}`)).data,gestionarAprobacionExterno:async(e,t)=>(await ue.post(`/cotizaciones/${e}/gestionar-aprobacion-externo`,t)).data,getHistorialAprobaciones:async e=>(await ue.get(`/cotizaciones/${e}/historial-aprobaciones`)).data,getDetalleParaOT:async(e,t)=>(await ue.get(`/cotizaciones/detalle/${e}/para-ot`,{params:{tipo_solicitud:t}})).data,getDetallesParaOT:async(e,t=1,r=20)=>{const n=new URLSearchParams;return n.append("page",t.toString()),n.append("page_size",r.toString()),e&&n.append("cotizacion_id",e.toString()),(await ue.get(`/cotizaciones/detalles-para-ot/?${n.toString()}`)).data}},Fv={getPendingAssignment:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.asignado&&t.append("asignado",e.asignado),e.tipo_solicitud&&t.append("tipo_solicitud",e.tipo_solicitud),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.vendedor_id&&t.append("vendedor_id",e.vendedor_id.toString()),e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await ue.get(`/work-orders/pending-assignment?${t.toString()}`)).data},assign:async(e,t)=>(await ue.put(`/work-orders/${e}/assign`,{profesional_id:t})).data,assignWithMessage:async(e,t)=>(await ue.put(`/work-orders/${e}/assign`,t)).data,getProfessionals:async()=>(await ue.get("/work-orders/professionals")).data},sa={getOTsPorUsuario:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.area_id&&t.append("area_id",e.area_id.toString()),(await ue.get(`/reports/ots-por-usuario?${t.toString()}`)).data},getOTsCompletadas:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.client_id&&t.append("client_id",e.client_id.toString()),(await ue.get(`/reports/ots-completadas?${t.toString()}`)).data},getTiempoPorArea:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await ue.get(`/reports/tiempo-por-area?${t.toString()}`)).data},getCargaMensual:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await ue.get(`/reports/carga-mensual?${t.toString()}`)).data},getRechazosMes:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await ue.get(`/reports/rechazos-mes?${t.toString()}`)).data},getAnulaciones:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await ue.get(`/reports/anulaciones?${t.toString()}`)).data},getMotivosRechazo:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await ue.get(`/reports/motivos-rechazo?${t.toString()}`)).data},getTiempoPrimeraMuestra:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await ue.get(`/reports/tiempo-primera-muestra?${t.toString()}`)).data},getGestionOTsActivas:async e=>{const t=new URLSearchParams;return e&&t.append("area_id",e.toString()),(await ue.get(`/reports/gestion-ots-activas?${t.toString()}`)).data},getIndicadoresSalaMuestra:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await ue.get(`/reports/indicadores-sala-muestra?${t.toString()}`)).data},getDisenoEstructuralSala:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await ue.get(`/reports/diseno-estructural-sala?${t.toString()}`)).data},getTiempoDisenadorExterno:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await ue.get(`/reports/tiempo-disenador-externo?${t.toString()}`)).data},getMuestras:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.estado&&t.append("estado",e.estado),(await ue.get(`/reports/muestras?${t.toString()}`)).data}},xz={0:"Sin Asignar",1:"En Proceso",2:"Rechazada",3:"Terminada",4:"Anulada",5:"Devuelta",6:"Sala de Corte"},Us={listByOT:async e=>(await ue.get(`/muestras/ot/${e}`)).data,getOptions:async()=>(await ue.get("/muestras/options")).data,get:async e=>(await ue.get(`/muestras/${e}`)).data,create:async e=>(await ue.post("/muestras/",e)).data,terminar:async e=>(await ue.put(`/muestras/${e}/terminar`)).data,rechazar:async(e,t)=>(await ue.put(`/muestras/${e}/rechazar`,{observacion:t})).data,anular:async e=>(await ue.put(`/muestras/${e}/anular`)).data,devolver:async(e,t)=>(await ue.put(`/muestras/${e}/devolver`,{observacion:t})).data,togglePrioritaria:async e=>(await ue.put(`/muestras/${e}/prioritaria`)).data,delete:async e=>(await ue.delete(`/muestras/${e}`)).data,asignarSalaCorte:async(e,t)=>(await ue.put(`/muestras/${e}/sala-corte?sala_corte_id=${t}`)).data,iniciarProceso:async e=>(await ue.put(`/muestras/${e}/en-proceso`)).data},vz={...dn,getFormOptionsComplete:async()=>(await ue.get("/work-orders/form-options-complete")).data,duplicate:async e=>(await ue.post(`/work-orders/${e}/duplicate`)).data};function yz(){return Bt({queryKey:["form-options"],queryFn:gz.getFormOptions,staleTime:10*60*1e3})}p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`;p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: ${d.spacing.lg};
`;const bz=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: ${d.spacing.md};

  @media (max-width: 992px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 576px) {
    grid-template-columns: 1fr;
  }
`;p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`;p.h3`
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.primary};
  margin-bottom: ${d.spacing.sm};
  padding-bottom: ${d.spacing.xs};
  border-bottom: 2px solid ${d.colors.accent};
`;p.span`
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};

  ${({$status:e})=>{switch(e){case"valid":return`
          background-color: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"invalid":return`
          background-color: ${d.colors.danger}20;
          color: ${d.colors.danger};
        `;default:return`
          background-color: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `}}}
`;p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.md};
`;p.div`
  flex: 1;
  height: 4px;
  border-radius: 2px;
  transition: background-color ${d.transitions.normal};

  ${({$active:e,$completed:t})=>t?`background-color: ${d.colors.success};`:e?`background-color: ${d.colors.accent};`:`background-color: ${d.colors.border};`}
`;p.div`
  background-color: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`;p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};

  &:not(:last-child) {
    border-bottom: 1px dashed ${d.colors.border};
  }
`;p.code`
  background-color: ${d.colors.primary}15;
  color: ${d.colors.primary};
  padding: 2px 6px;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`;const xi=[];function KP({values:e,onChange:t,fieldErrors:r={}}){const{data:n,isLoading:s}=yz(),i=E.useMemo(()=>({productType:(n==null?void 0:n.product_types)||xi,impresion:(n==null?void 0:n.impresion_types)||xi,fsc:(n==null?void 0:n.fsc_options)||xi,cinta:(n==null?void 0:n.cinta_options)||xi,coverageInternal:(n==null?void 0:n.coverage_internal)||xi,coverageExternal:(n==null?void 0:n.coverage_external)||xi,planta:(n==null?void 0:n.plantas)||xi,cartonColor:(n==null?void 0:n.carton_colors)||xi,carton:(n==null?void 0:n.cartones)||xi}),[n]),o=E.useCallback((c,u)=>{const h={...u};return c<=2&&(h.impresion=null),c<=3&&(h.fsc=null),c<=4&&(h.cinta=null),c<=5&&(h.coverageInternalId=null),c<=6&&(h.coverageExternalId=null),c<=7&&(h.plantaId=null),c<=8&&(h.cartonColor=null),c<=9&&(h.cartonId=null),h},[]),l=E.useCallback((c,u)=>{const h={productTypeId:1,impresion:2,fsc:3,cinta:4,coverageInternalId:5,coverageExternalId:6,plantaId:7,cartonColor:8,cartonId:9};let f=u;u===""||u===null?f=null:["productTypeId","coverageInternalId","coverageExternalId","plantaId","cartonId"].includes(c)&&(f=parseInt(u,10));const m=h[c];let g={...e,[c]:f};g=o(m+1,g),t(g)},[e,t,o]);return s?a.jsx(AN,{}):a.jsxs(bz,{children:[a.jsx(gi,{label:"Tipo Item *",value:e.productTypeId,options:i.productType,onChange:c=>l("productTypeId",c),placeholder:"Seleccionar...",error:!!r.product_type_id,helperText:r.product_type_id}),a.jsx(gi,{label:"Cinta",value:e.cinta,options:i.cinta,onChange:c=>l("cinta",c),disabled:!e.fsc,placeholder:"Seleccionar...",error:!!r.cinta,helperText:r.cinta}),a.jsx(gi,{label:"Planta Objetivo",value:e.plantaId,options:i.planta,onChange:c=>l("plantaId",c),disabled:!e.coverageExternalId,placeholder:"Seleccionar...",error:!!r.planta_id,helperText:r.planta_id}),a.jsx(gi,{label:"Impresion *",value:e.impresion,options:i.impresion,onChange:c=>l("impresion",c),disabled:!e.productTypeId,placeholder:"Seleccionar...",error:!!r.impresion,helperText:r.impresion}),a.jsx(gi,{label:"Recubrimiento Interno",value:e.coverageInternalId,options:i.coverageInternal,onChange:c=>l("coverageInternalId",c),disabled:!e.cinta,placeholder:"Seleccionar...",error:!!r.coverage_internal_id,helperText:r.coverage_internal_id}),a.jsx(gi,{label:"Color Carton *",value:e.cartonColor,options:i.cartonColor,onChange:c=>l("cartonColor",c),disabled:!e.plantaId,placeholder:"Seleccionar...",error:!!r.carton_color,helperText:r.carton_color}),a.jsx(gi,{label:"FSC",value:e.fsc,options:i.fsc,onChange:c=>l("fsc",c),disabled:!e.impresion,placeholder:"Seleccionar...",error:!!r.fsc,helperText:r.fsc}),a.jsx(gi,{label:"Recubrimiento Externo",value:e.coverageExternalId,options:i.coverageExternal,onChange:c=>l("coverageExternalId",c),disabled:!e.coverageInternalId,placeholder:"Seleccionar...",error:!!r.coverage_external_id,helperText:r.coverage_external_id}),a.jsx(gi,{label:"Carton",value:e.cartonId,options:i.carton,onChange:c=>l("cartonId",c),disabled:!e.cartonColor,placeholder:"Seleccionar...",error:!!r.carton_id,helperText:r.carton_id})]})}const _z=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.primary} 0%, ${d.colors.primaryDark} 100%);
  padding: ${d.spacing.lg};
`,wz=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 400px;
`,jz=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,kz=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h1};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Sz=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0;
`,Cz=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`,GC=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,qC=p.label`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,KC=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s, box-shadow 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textSecondary};
  }
`,$z=p.div`
  background-color: ${d.colors.danger}15;
  color: ${d.colors.danger};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
`,Tz=p.div`
  margin-top: ${d.spacing.lg};
  text-align: center;
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Ez=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.sm};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`;function Az({onLogin:e,onNavigate:t}){const[r,n]=E.useState(""),[s,i]=E.useState(""),[o,l]=E.useState(null),[c,u]=E.useState(!1),h=E.useCallback(g=>{let v=g.replace(/[^0-9kK]/g,"");if(v.length>9&&(v=v.slice(0,9)),v.length>1){const x=v.slice(-1);return`${v.slice(0,-1)}-${x.toUpperCase()}`}return v},[]),f=E.useCallback(g=>{const v=h(g.target.value);n(v),l(null)},[h]),m=E.useCallback(async g=>{if(g.preventDefault(),l(null),!r||!s){l("Por favor complete todos los campos");return}u(!0);try{e?await e(r,s)||l("RUT o contrasea incorrectos"):(console.log("Login attempt:",{rut:r,password:s}),l("Modo demo - autenticacion no implementada"))}catch{l("Error de conexion. Intente nuevamente.")}finally{u(!1)}},[r,s,e]);return a.jsx(_z,{children:a.jsxs(wz,{children:[a.jsxs(jz,{children:[a.jsx(kz,{children:"INVEB"}),a.jsx(Sz,{children:"Sistema de Ordenes de Trabajo"})]}),a.jsxs(Cz,{onSubmit:m,children:[a.jsxs(GC,{children:[a.jsx(qC,{htmlFor:"rut",children:"RUT"}),a.jsx(KC,{id:"rut",type:"text",value:r,onChange:f,placeholder:"12345678-9",autoComplete:"username",disabled:c})]}),a.jsxs(GC,{children:[a.jsx(qC,{htmlFor:"password",children:"Contrasea"}),a.jsx(KC,{id:"password",type:"password",value:s,onChange:g=>{i(g.target.value),l(null)},placeholder:"",autoComplete:"current-password",disabled:c})]}),o&&a.jsx($z,{children:o}),a.jsx(_N,{type:"submit",$variant:"primary",disabled:c,style:{width:"100%",marginTop:d.spacing.sm},children:c?"Ingresando...":"Ingresar"}),t&&a.jsx(Ez,{type:"button",onClick:()=>t("forgot-password"),children:"Olvide mi contrasena"})]}),a.jsx(Tz,{children:"MS-004 CascadeService v1.0"})]})})}function XC({onNavigate:e}){const[t,r]=E.useState([]),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),[u,h]=E.useState(1),[f,m]=E.useState(1),[g,v]=E.useState(0),[x,y]=E.useState({page:1,page_size:20}),[_,b]=E.useState({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]});E.useEffect(()=>{(async()=>{try{const U=await dn.getFilterOptions();c(U)}catch(U){console.error("Error loading filter options:",U)}})()},[]);const w=E.useCallback(async()=>{s(!0),o(null);try{const L=await dn.list(x);r(L.items),v(L.total),m(L.total_pages),h(L.page)}catch(L){o("Error cargando ordenes de trabajo"),console.error(L)}finally{s(!1)}},[x]);E.useEffect(()=>{w()},[w]);const C=L=>{L.preventDefault();const U={page:1,page_size:20};_.id_ot&&(U.id_ot=parseInt(_.id_ot)),_.date_desde&&(U.date_desde=_.date_desde),_.date_hasta&&(U.date_hasta=_.date_hasta),_.cad&&(U.cad=_.cad),_.carton&&(U.carton=_.carton),_.material&&(U.material=_.material),_.descripcion&&(U.descripcion=_.descripcion),_.client_id.length&&(U.client_id=_.client_id),_.estado_id.length&&(U.estado_id=_.estado_id),_.area_id.length&&(U.area_id=_.area_id),_.canal_id.length&&(U.canal_id=_.canal_id),_.vendedor_id.length&&(U.vendedor_id=_.vendedor_id),_.planta_id.length&&(U.planta_id=_.planta_id),y(U)},j=L=>{y(U=>({...U,page:L}))},T=L=>{e&&e("gestionar-ot",L)},[k,M]=E.useState(!1),A=async()=>{M(!0);try{await mz.downloadOTsListExcel({estado_id:_.estado_id[0],area_id:_.area_id[0],canal_id:_.canal_id[0],client_id:_.client_id[0],fecha_desde:_.date_desde||void 0,fecha_hasta:_.date_hasta||void 0})}catch(L){console.error("Error exportando a Excel:",L),alert("Error al exportar a Excel")}finally{M(!1)}},O=(L,U)=>{switch(L){case 1:case 5:return U<=1?"badge-success":U<=2?"badge-warning":"badge-danger";case 2:return U<=1?"badge-success":U<=2?"badge-warning":"badge-danger";case 3:case 4:return U<=2?"badge-success":U<=3?"badge-warning":"badge-danger";case 6:return U<=3?"badge-success":U<=5?"badge-warning":"badge-danger";default:return U<=2?"badge-success":U<=5?"badge-warning":"badge-danger"}},F=(L,U,P=!1,Q=null,re=0)=>{if(L==null||L===0)return a.jsx("span",{className:"badge badge-secondary",children:"0"});const Z=O(re,L);return P&&Q?a.jsxs("span",{className:`badge ${Z}`,title:`${U}: ${L} dias (desde ${Q})`,children:[Q," ",a.jsx("strong",{children:L.toFixed(1)})]}):a.jsx("span",{className:`badge ${Z}`,title:`${U}: ${L} dias`,children:L.toFixed(1)})},B=L=>{switch(L){case 6:return a.jsx("span",{className:"ot-icon",title:"Licitacion",children:""});case 7:return a.jsx("span",{className:"ot-icon",title:"Proyecto Innovacion",children:""});default:return null}};return a.jsxs("div",{className:"work-orders-dashboard",children:[a.jsxs("div",{className:"dashboard-header",children:[a.jsx("h1",{children:"Ordenes de Trabajo"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("crear-ot"),children:"Crear OT"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("notificaciones"),children:"Notificaciones OT"}),a.jsx("button",{className:"btn btn-secondary",onClick:A,disabled:k,title:"Exportar lista de OTs a Excel",children:k?"Exportando...":"Exportar Excel"})]})]}),a.jsxs("form",{className:"filters-form",onSubmit:C,children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Desde"}),a.jsx("input",{type:"date",value:_.date_desde,onChange:L=>b(U=>({...U,date_desde:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Hasta"}),a.jsx("input",{type:"date",value:_.date_hasta,onChange:L=>b(U=>({...U,date_hasta:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"ID OT"}),a.jsx("input",{type:"text",value:_.id_ot,onChange:L=>b(U=>({...U,id_ot:L.target.value})),placeholder:"Ej: 26590"})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Material"}),a.jsx("input",{type:"text",value:_.material,onChange:L=>b(U=>({...U,material:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Creador"}),a.jsx("select",{multiple:!0,value:_.vendedor_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,vendedor_id:U}))},children:l==null?void 0:l.vendedores.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Canal"}),a.jsx("select",{multiple:!0,value:_.canal_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,canal_id:U}))},children:l==null?void 0:l.canales.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsx("select",{multiple:!0,value:_.estado_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,estado_id:U}))},children:l==null?void 0:l.estados.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Area"}),a.jsx("select",{multiple:!0,value:_.area_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,area_id:U}))},children:l==null?void 0:l.areas.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Cliente"}),a.jsx("select",{multiple:!0,value:_.client_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,client_id:U}))},children:l==null?void 0:l.clientes.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"CAD"}),a.jsx("input",{type:"text",value:_.cad,onChange:L=>b(U=>({...U,cad:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Carton"}),a.jsx("input",{type:"text",value:_.carton,onChange:L=>b(U=>({...U,carton:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Descripcion"}),a.jsx("input",{type:"text",value:_.descripcion,onChange:L=>b(U=>({...U,descripcion:L.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Planta"}),a.jsx("select",{multiple:!0,value:_.planta_id.map(String),onChange:L=>{const U=Array.from(L.target.selectedOptions,P=>parseInt(P.value));b(P=>({...P,planta_id:U}))},children:l==null?void 0:l.plantas.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))})]})]}),a.jsxs("div",{className:"filter-actions",children:[a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Filtrar"}),a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{b({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]}),y({page:1,page_size:20})},children:"Limpiar"})]})]}),a.jsx("div",{className:"results-info",children:a.jsxs("span",{children:["Mostrando ",t.length," de ",g," registros"]})}),i&&a.jsxs("div",{className:"alert alert-error",children:[i,a.jsx("button",{onClick:w,children:"Reintentar"})]}),n&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{children:"Cargando..."})]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"ot-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"OT"}),a.jsx("th",{children:"Creacion"}),a.jsx("th",{children:"Cliente"}),a.jsx("th",{children:"Descripcion"}),a.jsx("th",{children:"Canal"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{title:"Tiempo Total",children:"T"}),a.jsx("th",{children:"Ventas"}),a.jsx("th",{children:"Dis. Estructural"}),a.jsx("th",{children:"Muestra"}),a.jsx("th",{children:"Dis. Grafico"}),a.jsx("th",{children:"Dis. Externo"}),a.jsx("th",{children:"Calc. Paletizado"}),a.jsx("th",{children:"Catalogacion"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(L=>{var U;return a.jsxs("tr",{children:[a.jsxs("td",{children:[B(L.tipo_solicitud),a.jsx("span",{title:`Creador: ${L.creador_nombre}`,children:L.id})]}),a.jsx("td",{children:L.created_at}),a.jsx("td",{className:"truncate",title:L.client_name,children:L.client_name}),a.jsx("td",{className:"truncate",title:L.descripcion,children:L.descripcion}),a.jsx("td",{className:"center",children:(U=L.canal)==null?void 0:U.charAt(0)}),a.jsx("td",{children:L.item_tipo}),a.jsx("td",{title:L.estado,children:L.estado_abrev}),a.jsx("td",{className:"time-cell time-total",children:a.jsxs("span",{className:"badge badge-total",title:`Tiempo Total: ${L.tiempo_total} dias`,children:[" ",Math.round(L.tiempo_total||0)]})}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_venta,"Ventas",L.current_area_id===1,L.ultimo_cambio_area,1)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_desarrollo,"Desarrollo",L.current_area_id===2,L.ultimo_cambio_area,2)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_muestra,"Muestra",L.current_area_id===6,L.ultimo_cambio_area,6)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_diseno,"Diseno",L.current_area_id===3,L.ultimo_cambio_area,3)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_externo,"Externo",!1,null,0)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_precatalogacion,"Precatalogacion",L.current_area_id===5,L.ultimo_cambio_area,5)}),a.jsx("td",{className:"time-cell",children:F(L.tiempo_catalogacion,"Catalogacion",L.current_area_id===4,L.ultimo_cambio_area,4)}),a.jsx("td",{className:"actions",children:a.jsx("button",{className:"btn-icon",onClick:()=>T(L.id),title:"Ver OT",children:""})})]},L.id)})})]})}),f>1&&a.jsxs("div",{className:"pagination",children:[a.jsx("button",{disabled:u===1,onClick:()=>j(u-1),children:"Anterior"}),a.jsxs("span",{children:["Pagina ",u," de ",f]}),a.jsx("button",{disabled:u===f,onClick:()=>j(u+1),children:"Siguiente"})]})]})}const YC={cad_id:null,carton_id:null,pegado_id:null,tiempo_unitario:"",carton_muestra_id:null,destinatarios_id:[],cantidad_vendedor:null,comentario_vendedor:"Retira Vendedor",cantidad_disenador:null,comentario_disenador:"",cantidad_disenador_revision:null,comentario_disenador_revision:"",cantidad_laboratorio:null,comentario_laboratorio:"",destinatario_1:"",comuna_1:null,direccion_1:"",cantidad_1:null,comentario_1:"",destinatario_2:"",comuna_2:null,direccion_2:"",cantidad_2:null,comentario_2:"",destinatario_3:"",comuna_3:null,direccion_3:"",cantidad_3:null,comentario_3:"",destinatario_4:"",comuna_4:null,direccion_4:"",cantidad_4:null,comentario_4:""},Fz=[{id:"1",nombre:"Retira Ventas VB"},{id:"2",nombre:"Retira Diseador VB"},{id:"3",nombre:"Envo Laboratorio"},{id:"4",nombre:"Envo Cliente VB"},{id:"5",nombre:"Retira Diseador Revisin"}],Pz=[{id:1,nombre:"Sin Pegar"},{id:2,nombre:"Pegado Flexo Interior"},{id:3,nombre:"Pegado Flexo Exterior"},{id:4,nombre:"Pegado Diecutter"},{id:5,nombre:"Pegado Cajas Fruta"},{id:6,nombre:"Pegado con Cinta"},{id:7,nombre:"Sin Pegar con Cinta"}],Lp=[{id:"Chile Express",nombre:"Chile Express"},{id:"Auto Correo",nombre:"Auto Correo"},{id:"Camin",nombre:"Camin"}],QC=p.div`
  background: white;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
`,JC=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
`,ZC=p.h3`
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,e$=p.div`
  padding: 1rem;
`,za=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,nt=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,st=p.label`
  font-size: 0.8rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,tr=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Ts=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Dz=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,hh=p.div`
  display: ${e=>e.$visible?"block":"none"};
  margin-top: 1rem;
  padding: 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  background: #fafafa;
`,fh=p.h4`
  text-align: center;
  color: ${d.colors.primary};
  margin: 0 0 1rem 0;
  font-size: 0.95rem;
`,Mz=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,t$=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border: none;

    &:hover {
      background: ${d.colors.primaryDark};
    }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border: 1px solid ${d.colors.border};

    &:hover {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function Oz({isOpen:e,onClose:t,onSave:r,cadId:n,cartonId:s,tipoSolicitud:i,cads:o=[],cartones:l=[],cartonesMuestra:c=[],comunas:u=[]}){const[h,f]=E.useState({...YC,cad_id:n||null,carton_id:s||null}),m=E.useMemo(()=>i===1||i===4||i===7,[i]),g=E.useMemo(()=>({vendedor:h.destinatarios_id.includes("1"),disenador:h.destinatarios_id.includes("2"),laboratorio:h.destinatarios_id.includes("3"),clientes:h.destinatarios_id.includes("4"),disenadorRevision:h.destinatarios_id.includes("5")}),[h.destinatarios_id]),v=E.useCallback((b,w)=>{f(C=>({...C,[b]:w}))},[]),x=E.useCallback(b=>{const w=Array.from(b.target.selectedOptions).map(C=>C.value);f(C=>({...C,destinatarios_id:w}))},[]),y=E.useCallback(()=>{let b=0;g.vendedor&&h.cantidad_vendedor&&(b+=h.cantidad_vendedor),g.disenador&&h.cantidad_disenador&&(b+=h.cantidad_disenador),g.disenadorRevision&&h.cantidad_disenador_revision&&(b+=h.cantidad_disenador_revision),g.laboratorio&&h.cantidad_laboratorio&&(b+=h.cantidad_laboratorio),g.clientes&&(b+=(h.cantidad_1||0)+(h.cantidad_2||0)+(h.cantidad_3||0)+(h.cantidad_4||0)),r(h,b)},[h,g,r]),_=E.useCallback(()=>{f({...YC,cad_id:n||null,carton_id:s||null}),t()},[n,s,t]);return a.jsxs(IN,{isOpen:e,onClose:_,title:"Crear Muestra",size:"xl",children:[a.jsxs(QC,{children:[a.jsx(JC,{children:a.jsx(ZC,{children:"Caracteristicas de Muestra"})}),a.jsx(e$,{children:a.jsxs(za,{$columns:3,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"CAD"}),a.jsxs(Ts,{value:h.cad_id||"",onChange:b=>v("cad_id",b.target.value?Number(b.target.value):null),disabled:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),o.map(b=>a.jsx("option",{value:b.id,children:b.codigo||b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cartn"}),a.jsxs(Ts,{value:h.carton_id||"",onChange:b=>v("carton_id",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),l.map(b=>a.jsx("option",{value:b.id,children:b.codigo||b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Tipo de Pegado"}),a.jsxs(Ts,{value:h.pegado_id||"",onChange:b=>v("pegado_id",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Pz.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Tiempo Unitario"}),a.jsx(tr,{type:"time",value:h.tiempo_unitario,onChange:b=>v("tiempo_unitario",b.target.value),disabled:!0})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cartn Muestra"}),a.jsxs(Ts,{value:h.carton_muestra_id||"",onChange:b=>v("carton_muestra_id",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),c.map(b=>a.jsx("option",{value:b.id,children:b.codigo||b.nombre||b.id},String(b.id)))]})]})]})})]}),a.jsxs(QC,{children:[a.jsx(JC,{children:a.jsx(ZC,{children:"Destinos"})}),a.jsxs(e$,{children:[a.jsx(za,{$columns:1,children:a.jsxs(nt,{children:[a.jsx(st,{children:"Enviar Muestras a"}),a.jsx(Dz,{multiple:!0,value:h.destinatarios_id,onChange:x,children:Fz.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))})]})}),a.jsx("h4",{style:{textAlign:"center",color:"#7f7f7f",marginTop:"1.5rem"},children:"Datos de Muestra"}),a.jsxs(hh,{$visible:g.vendedor,children:[a.jsx(fh,{children:"Retira Ventas VB"}),a.jsxs(za,{$columns:3,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_vendedor||"",onChange:b=>v("cantidad_vendedor",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Entrega"}),a.jsx(tr,{type:"text",value:h.comentario_vendedor,onChange:b=>v("comentario_vendedor",b.target.value),disabled:!0,readOnly:!0})]})]})]}),a.jsxs(hh,{$visible:g.disenador,children:[a.jsx(fh,{children:"Retira Diseador VB"}),a.jsxs(za,{$columns:3,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_disenador||"",onChange:b=>v("cantidad_disenador",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Entrega"}),a.jsx(tr,{type:"text",value:h.comentario_disenador,onChange:b=>v("comentario_disenador",b.target.value)})]})]})]}),a.jsxs(hh,{$visible:g.disenadorRevision,children:[a.jsx(fh,{children:"Retira Diseador Revisin"}),a.jsxs(za,{$columns:3,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_disenador_revision||"",onChange:b=>v("cantidad_disenador_revision",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Entrega"}),a.jsx(tr,{type:"text",value:h.comentario_disenador_revision,onChange:b=>v("comentario_disenador_revision",b.target.value)})]})]})]}),a.jsxs(hh,{$visible:g.laboratorio,children:[a.jsx(fh,{children:"Envo Laboratorio"}),a.jsxs(za,{$columns:3,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_laboratorio||"",onChange:b=>v("cantidad_laboratorio",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Envo"}),a.jsx(tr,{type:"text",value:h.comentario_laboratorio,onChange:b=>v("comentario_laboratorio",b.target.value)})]})]})]}),a.jsxs(hh,{$visible:g.clientes,children:[a.jsx(fh,{children:"Envo Cliente VB"}),a.jsxs(za,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Destinatario 1"}),a.jsx(tr,{type:"text",value:h.destinatario_1,onChange:b=>v("destinatario_1",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Comuna"}),a.jsxs(Ts,{value:h.comuna_1||"",onChange:b=>v("comuna_1",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(b=>a.jsx("option",{value:b.id,children:b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Direccin"}),a.jsx(tr,{type:"text",value:h.direccion_1,onChange:b=>v("direccion_1",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_1||"",onChange:b=>v("cantidad_1",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Envo"}),a.jsxs(Ts,{value:h.comentario_1,onChange:b=>v("comentario_1",b.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Lp.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]}),a.jsxs(za,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Destinatario 2"}),a.jsx(tr,{type:"text",value:h.destinatario_2,onChange:b=>v("destinatario_2",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Comuna"}),a.jsxs(Ts,{value:h.comuna_2||"",onChange:b=>v("comuna_2",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(b=>a.jsx("option",{value:b.id,children:b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Direccin"}),a.jsx(tr,{type:"text",value:h.direccion_2,onChange:b=>v("direccion_2",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_2||"",onChange:b=>v("cantidad_2",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Envo"}),a.jsxs(Ts,{value:h.comentario_2,onChange:b=>v("comentario_2",b.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Lp.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]}),a.jsxs(za,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Destinatario 3"}),a.jsx(tr,{type:"text",value:h.destinatario_3,onChange:b=>v("destinatario_3",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Comuna"}),a.jsxs(Ts,{value:h.comuna_3||"",onChange:b=>v("comuna_3",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(b=>a.jsx("option",{value:b.id,children:b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Direccin"}),a.jsx(tr,{type:"text",value:h.direccion_3,onChange:b=>v("direccion_3",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_3||"",onChange:b=>v("cantidad_3",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Envo"}),a.jsxs(Ts,{value:h.comentario_3,onChange:b=>v("comentario_3",b.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Lp.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]}),a.jsxs(za,{$columns:5,children:[a.jsxs(nt,{children:[a.jsx(st,{children:"Destinatario 4"}),a.jsx(tr,{type:"text",value:h.destinatario_4,onChange:b=>v("destinatario_4",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Comuna"}),a.jsxs(Ts,{value:h.comuna_4||"",onChange:b=>v("comuna_4",b.target.value?Number(b.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(b=>a.jsx("option",{value:b.id,children:b.nombre||b.id},String(b.id)))]})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Direccin"}),a.jsx(tr,{type:"text",value:h.direccion_4,onChange:b=>v("direccion_4",b.target.value)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Cantidad"}),a.jsx(tr,{type:"number",min:"0",value:h.cantidad_4||"",onChange:b=>v("cantidad_4",b.target.value?Number(b.target.value):null)})]}),a.jsxs(nt,{children:[a.jsx(st,{children:"Forma de Envo"}),a.jsxs(Ts,{value:h.comentario_4,onChange:b=>v("comentario_4",b.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Lp.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]})]})]})]}),a.jsxs(Mz,{children:[a.jsx(t$,{type:"button",onClick:_,children:"Cancelar"}),a.jsx(t$,{type:"button",$variant:"primary",onClick:y,children:"Guardar Muestra"})]})]})}function XP(){return Bt({queryKey:["workOrderFilterOptions"],queryFn:()=>dn.getFilterOptions(),staleTime:1e3*60*10})}function YP(e){return Bt({queryKey:["workOrder",e],queryFn:()=>dn.get(e),enabled:!!e})}function Rz(e){return Bt({queryKey:["managementHistory",e],queryFn:()=>dn.getManagementHistory(e),enabled:!!e})}function Iz(e){return Bt({queryKey:["workflowOptions",e],queryFn:()=>dn.getWorkflowOptions(e),enabled:!!e})}function Nz(){const e=Sr();return Et({mutationFn:({id:t,data:r})=>dn.transition(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["managementHistory",r.id]}),e.invalidateQueries({queryKey:["workOrders"]}),e.invalidateQueries({queryKey:["workOrder",r.id]})}})}function Lz(e=1,t=20){return Bt({queryKey:["notifications",e,t],queryFn:()=>qP.list(e,t)})}function zz(){const e=Sr();return Et({mutationFn:t=>qP.markAsRead(t),onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]}),e.invalidateQueries({queryKey:["notificationsCount"]})}})}function QP(){return Bt({queryKey:["formOptionsComplete"],queryFn:()=>vz.getFormOptionsComplete(),staleTime:1e3*60*5})}const ri={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,API:17,SuperAdministrador:18,VendedorExterno:19},r$=()=>{try{const e=localStorage.getItem("inveb_ot_user");if(e)return JSON.parse(e).role_id||ri.Vendedor}catch{}return ri.Vendedor},Bz=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Uz=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Vz=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,n$=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Es=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,vn=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,yn=p.div`
  padding: 1rem;
`,da=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Hz=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.75rem;
  width: 100%;
  max-width: 100%;
  overflow: hidden;

  & > div {
    min-width: 0;
    overflow: hidden;
  }

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Wz=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: 1fr 1fr;
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Pv=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  overflow: hidden;
`,de=p.div`
  display: flex;
  flex-direction: column;
`,ie=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,je=p.input`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Me=p.select`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: ${e=>e.$hasError?"#fff5f5":"white"};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Gz=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }
`,pt=p.span`
  font-size: 0.7rem;
  color: #dc3545;
  margin-top: 0.25rem;
  display: block;
`,Dv=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,bn=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,qz=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Kz=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,s$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,a$={client_id:null,descripcion:"",tipo_solicitud:null,canal_id:null,org_venta_id:null,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",volumen_venta_anual:null,usd_monto:"",codigo_producto:"",orden_compra_id:null,hierarchy_id:null,subhierarchy_id:null,subsubhierarchy_id:null,ant_des_correo_cliente:!1,ant_des_plano_actual:!1,ant_des_boceto_actual:!1,ant_des_spec:!1,ant_des_otro:!1,ant_des_cj_referencia_de:!1,ant_des_cj_referencia_dg:!1,ant_des_envase_primario:!1,ant_des_conservar_muestra:null,armado_automatico:null,analisis:!1,prueba_industrial:!1,muestra:!1,numero_muestras:null,reference_type:null,reference_id:null,bloqueo_referencia:null,indicador_facturacion:null,ant_des_vb_muestra:!1,ant_des_vb_boceto:!1,cascadeData:{productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null},cad_id:null,cad_text:"",matriz_id:null,tipo_matriz_text:"",items_set:null,veces_item:null,style_id:null,caracteristicas_adicionales:"",largura_hm:null,anchura_hm:null,area_producto_m2:null,recorte_adicional_m2:null,longitud_pegado_mm:null,golpes_largo:null,golpes_ancho:null,separacion_golpes_largo:null,separacion_golpes_ancho:null,cuchillas_ml:null,rayado_c1_r1:null,rayado_r1_r2:null,rayado_r2_c2:null,pallet_qa_id:null,pais_id:null,restriccion_pallet:null,tamano_pallet_type_id:null,altura_pallet:null,permite_sobresalir_carga:null,bulto_zunchado_pallet:null,formato_etiqueta_pallet:null,etiquetas_por_pallet:null,termocontraible:null,bct_min_lb:null,bct_min_kg:null,bct_humedo_lb:null,ect_min_lb_pulg:null,gramaje_g_m2:null,mullen_lb_pulg2:null,fct_lb_pulg2:null,dst_bpi:null,espesor_placa_mm:null,espesor_caja_mm:null,cobb_interior_g_m2:null,cobb_exterior_g_m2:null,flexion_aleta_n:null,peso_cliente_g:null,incision_rayado_longitudinal:"",incision_rayado_transversal:"",porosidad:"",brillo:"",rigidez_4_ptos_long:"",rigidez_4_ptos_transv:"",angulo_deslizamiento_exterior:"",angulo_deslizamiento_interior:"",resistencia_frote:"",contenido_reciclado:"",interno_largo:null,interno_ancho:null,interno_alto:null,externo_largo:null,externo_ancho:null,externo_alto:null,process_id:null,armado_id:null,sentido_armado:null,numero_colores:null,color_1_id:null,color_2_id:null,color_3_id:null,color_4_id:null,color_5_id:null,color_6_id:null,trazabilidad:null,design_type_id:null,complejidad:"",percentage_coverage_internal:null,percentage_coverage_external:null,impresion_1:null,impresion_2:null,impresion_3:null,impresion_4:null,impresion_5:null,impresion_6:null,cm2_clisse_color_1:null,cm2_clisse_color_2:null,cm2_clisse_color_3:null,cm2_clisse_color_4:null,cm2_clisse_color_5:null,cm2_clisse_color_6:null,cm2_clisse_color_7:null,barniz_uv:null,porcentaje_barniz_uv:null,indicador_facturacion_diseno_grafico:"",prueba_color:null,impresion_borde:"",impresion_sobre_rayado:"",total_cm2_clisse:null,pegado_terminacion:null,maquila:null,maquila_servicio_id:null,material_asignado:"",descripcion_material:"",product_type_developing_id:null,food_type_id:null,expected_use_id:null,recycled_use_id:null,class_substance_packed_id:null,transportation_way_id:null,peso_contenido_caja:null,autosoportante:null,envase_id:null,cantidad_cajas_apiladas:null,pallet_sobre_pallet:null,cantidad:null,target_market_id:null,observacion:"",planta_id:null,so_planta_original:null,so_planta_original_select_values:"",so_planta_alt1:null,so_planta_alt1_select_values:"",so_planta_alt2:null,so_planta_alt2_select_values:"",secuencia_operacional_matrix:Array(6).fill(null).map(()=>Array(6).fill(null))},i$=[{id:1,nombre:"Desarrollo Completo"},{id:3,nombre:"Muestra con CAD"},{id:7,nombre:"OT Proyectos Innovacin"},{id:5,nombre:"Arte con Material"},{id:6,nombre:"Otras Solicitudes Desarrollo"}],Xz=(e,t)=>e===ri.VendedorExterno?i$.filter(r=>r.id===1||r.id===5):i$,Yz=p.button`
  padding: 0.5rem 1rem;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: background 0.2s;

  &:hover {
    background: #218838;
  }
`,Qz=p.div`
  display: flex;
  gap: 1rem;
  align-items: flex-end;
`;function o$({onNavigate:e,initialData:t}){var Z,W,ce,te,D,R,N,H,ee,J,he,ge,xe,De,X,rt,We,dt,pe,ve,Nt,gn,ns,js,lo,ia,Xr,ks,oa,co,Cr,ss,Ge,Lt,xn,Kt,Oa,Ju,fp,pp,Zu,eh;const[r,n]=E.useState(a$),[s,i]=E.useState(null),[o,l]=E.useState(null),[c,u]=E.useState({}),[h,f]=E.useState([]),[m,g]=E.useState([]),[v,x]=E.useState(!1),[y,_]=E.useState(!1),[b,w]=E.useState(!1),C=Sr(),{data:j,isLoading:T}=XP(),{data:k,isLoading:M}=QP(),A=E.useMemo(()=>!(k!=null&&k.subhierarchies)||!r.hierarchy_id?[]:k.subhierarchies.filter(S=>S.hierarchy_id===r.hierarchy_id),[k==null?void 0:k.subhierarchies,r.hierarchy_id]),O=E.useMemo(()=>!(k!=null&&k.subsubhierarchies)||!r.subhierarchy_id?[]:k.subsubhierarchies.filter(S=>S.subhierarchy_id===r.subhierarchy_id),[k==null?void 0:k.subsubhierarchies,r.subhierarchy_id]),F=E.useMemo(()=>{const S=r$();return Xz(S)},[]);E.useEffect(()=>{r.hierarchy_id&&n(S=>({...S,subhierarchy_id:null,subsubhierarchy_id:null}))},[r.hierarchy_id]),E.useEffect(()=>{r.tipo_solicitud===3&&(w(!0),n(S=>({...S,muestra:!0})))},[r.tipo_solicitud]),E.useEffect(()=>{r.subhierarchy_id&&n(S=>({...S,subsubhierarchy_id:null}))},[r.subhierarchy_id]),E.useEffect(()=>{if(r.canal_id&&(j!=null&&j.canales)&&(k!=null&&k.hierarchies)){const S=j.canales.find(at=>at.id===r.canal_id);if(S){const at=k.hierarchies.find(yt=>{var mr,or;return((mr=yt.nombre)==null?void 0:mr.toUpperCase())===((or=S.nombre)==null?void 0:or.toUpperCase())});at&&n(yt=>({...yt,hierarchy_id:Number(at.id),subhierarchy_id:null,subsubhierarchy_id:null}))}}},[r.canal_id,j==null?void 0:j.canales,k==null?void 0:k.hierarchies]),E.useEffect(()=>{console.log("[DEBUG] useEffect client_id ejecutado, client_id=",r.client_id),r.client_id?(x(!0),f([]),g([]),n(S=>({...S,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:""})),console.log("[DEBUG] Llamando cascadesApi.getInstalacionesCliente con client_id=",r.client_id),WC.getInstalacionesCliente(r.client_id).then(S=>{console.log("[DEBUG] Instalaciones recibidas:",S),f(S)}).catch(S=>console.error("[DEBUG] Error cargando instalaciones:",S)).finally(()=>x(!1))):(f([]),g([]))},[r.client_id]),E.useEffect(()=>{r.client_id&&(_(!0),g([]),WC.getContactosCliente(r.client_id,r.instalacion_cliente_id||void 0).then(S=>g(S)).catch(S=>console.error("Error cargando contactos:",S)).finally(()=>_(!1)))},[r.client_id,r.instalacion_cliente_id]),E.useEffect(()=>{if(r.contactos_cliente_id){const S=m.find(at=>at.id===r.contactos_cliente_id);S&&n(at=>({...at,nombre_contacto:S.nombre||"",email_contacto:S.email||"",telefono_contacto:S.telefono||""}))}},[r.contactos_cliente_id,m]),E.useEffect(()=>{t&&n(S=>({...S,client_id:t.client_id||null,descripcion:t.descripcion||"",tipo_solicitud:t.tipo_solicitud||null,nombre_contacto:t.nombre_contacto||"",email_contacto:t.email_contacto||"",telefono_contacto:t.telefono_contacto||"",codigo_producto:t.material_codigo||"",interno_largo:t.largo_interno||null,interno_ancho:t.ancho_interno||null,interno_alto:t.alto_interno||null,externo_largo:t.largo_externo||null,externo_ancho:t.ancho_externo||null,externo_alto:t.alto_externo||null,cantidad:t.cantidad||null}))},[t]);const B=Et({mutationFn:S=>dn.create(S),onSuccess:S=>{i(`Orden de trabajo #${S.id} creada exitosamente`),l(null),C.invalidateQueries({queryKey:["workOrders"]}),setTimeout(()=>{e("dashboard")},2e3)},onError:S=>{l(S.message||"Error al crear la orden de trabajo"),i(null)}}),L=E.useCallback(S=>{n(at=>({...at,cascadeData:S}))},[]),U=E.useCallback(()=>{var mp,gp,I,G,z,V,q,K,se,me,ne,ae,oe,be,Ce,Ee,we,$e,Ue,$t,Tt,gr;const S={},at=r$(),yt=r.tipo_solicitud,mr=yt===1||yt===4||yt===7,or=yt!==3,uo=yt===3,Ss=yt===5,$r=at===ri.Vendedor,Cs=at===ri.VendedorExterno,$s=at===ri.Ingeniero,Ra=at===ri.JefeDesarrollo,ld=at===ri.Diseador,la=at===ri.JefeVenta;if(r.client_id||(S.client_id="Campo obligatorio"),r.descripcion.trim()?r.descripcion.length>40&&(S.descripcion="Mximo 40 caracteres"):S.descripcion="Campo obligatorio",yt||(S.tipo_solicitud="Campo obligatorio"),r.canal_id||(S.canal_id="Campo obligatorio"),r.hierarchy_id&&!r.subhierarchy_id&&(S.subhierarchy_id="Campo obligatorio"),r.subhierarchy_id&&!r.subsubhierarchy_id&&(S.subsubhierarchy_id="Campo obligatorio"),(mp=r.nombre_contacto)!=null&&mp.trim()||(S.nombre_contacto="Campo obligatorio"),(gp=r.email_contacto)!=null&&gp.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email_contacto)||(S.email_contacto="Email invlido"):S.email_contacto="Campo obligatorio",(I=r.telefono_contacto)!=null&&I.trim()||(S.telefono_contacto="Campo obligatorio"),(G=r.observacion)!=null&&G.trim()?r.observacion.trim().length<10?S.observacion="Mnimo 10 caracteres":r.observacion.length>1e3&&(S.observacion="Mximo 1000 caracteres"):S.observacion="Campo obligatorio",(z=r.cascadeData)!=null&&z.impresion||(S.impresion="Campo obligatorio"),(V=r.cascadeData)!=null&&V.fsc||(S.fsc="Campo obligatorio"),r.sentido_armado||(S.sentido_armado="Campo obligatorio"),or&&yt&&(r.volumen_venta_anual||(S.volumen_venta_anual="Campo obligatorio"),(q=r.usd_monto)!=null&&q.trim()||(S.usd_monto="Campo obligatorio")),mr&&((K=r.cascadeData)!=null&&K.productTypeId||(S.product_type_id="Campo obligatorio"),r.peso_contenido_caja||(S.peso_contenido_caja="Campo obligatorio"),(r.autosoportante===null||r.autosoportante===void 0)&&(S.autosoportante="Campo obligatorio"),r.envase_id||(S.envase_id="Campo obligatorio"),r.cantidad_cajas_apiladas||(S.cantidad_cajas_apiladas="Campo obligatorio"),(r.pallet_sobre_pallet===null||r.pallet_sobre_pallet===void 0)&&(S.pallet_sobre_pallet="Campo obligatorio"),r.pallet_sobre_pallet===!0&&!r.cantidad&&(S.cantidad="Campo obligatorio")),(yt===1||yt===5||yt===7)&&((se=r.cascadeData)!=null&&se.cinta||(S.cinta="Campo obligatorio")),!((me=r.cascadeData)!=null&&me.cartonId)&&!((ne=r.cascadeData)!=null&&ne.cartonColor)&&mr&&(S.carton_color="Campo obligatorio"),Ss&&(r.reference_type||(S.reference_type="Campo obligatorio"),r.reference_type&&r.reference_type!==2&&(r.reference_id||(S.reference_id="Campo obligatorio"),r.bloqueo_referencia||(S.bloqueo_referencia="Campo obligatorio"))),($r||Cs||la)&&($r&&!r.org_venta_id&&(S.org_venta_id="Campo obligatorio"),($r||la||Cs||ld)&&(mr||Ss)&&(r.restriccion_pallet===null||r.restriccion_pallet===void 0)&&(S.restriccion_pallet="Campo obligatorio"),$r&&r.termocontraible===null&&(S.termocontraible="Campo obligatorio"),$r&&r.armado_automatico===null&&(S.armado_automatico="Campo obligatorio"),($r||Cs)&&or&&((ae=r.cascadeData)!=null&&ae.coverageInternalId||(S.coverage_internal_id="Campo obligatorio"),(oe=r.cascadeData)!=null&&oe.coverageExternalId||(S.coverage_external_id="Campo obligatorio"),(be=r.cascadeData)!=null&&be.coverageInternalId&&r.cascadeData.coverageInternalId!==1&&(r.percentage_coverage_internal||(S.percentage_coverage_internal="Campo obligatorio")),(Ce=r.cascadeData)!=null&&Ce.coverageExternalId&&r.cascadeData.coverageExternalId!==1&&(r.percentage_coverage_external||(S.percentage_coverage_external="Campo obligatorio"))),($r||Cs||$s)&&!((Ee=r.cascadeData)!=null&&Ee.plantaId)&&(S.planta_id="Campo obligatorio"),($r||la||Ra||$s)&&!r.impresion_borde&&(S.impresion_borde="Campo obligatorio"),($r||la||Ra||$s)&&!r.impresion_sobre_rayado&&(S.impresion_sobre_rayado="Campo obligatorio"),($r||Ra||$s||ld)&&!r.pegado_terminacion&&(S.pegado_terminacion="Campo obligatorio")),($s||Ra)&&((we=r.cascadeData)!=null&&we.plantaId||(S.planta_id="Campo obligatorio"),r.maquila||(S.maquila="Campo obligatorio"),r.impresion_borde||(S.impresion_borde="Campo obligatorio"),r.impresion_sobre_rayado||(S.impresion_sobre_rayado="Campo obligatorio"),($e=r.caracteristicas_adicionales)!=null&&$e.trim()||(S.caracteristicas_adicionales="Campo obligatorio")),Ra&&!r.armado_id&&(S.armado_id="Campo obligatorio"),(uo||Ss)&&($r||Cs)&&((Ue=r.cascadeData)!=null&&Ue.cartonId||(S.carton_id="Campo obligatorio")),String(($t=r.cascadeData)==null?void 0:$t.fsc)==="1"&&(r.pais_id||(S.pais_id="Campo obligatorio")),r.restriccion_pallet===1&&(r.tamano_pallet_type_id||(S.tamano_pallet_type_id="Campo obligatorio"),r.altura_pallet||(S.altura_pallet="Campo obligatorio"),r.permite_sobresalir_carga===null&&(S.permite_sobresalir_carga="Campo obligatorio"),r.pallet_qa_id||(S.pallet_qa_id="Campo obligatorio"),r.bulto_zunchado_pallet===null&&(S.bulto_zunchado_pallet="Campo obligatorio"),r.formato_etiqueta_pallet||(S.formato_etiqueta_pallet="Campo obligatorio"),r.etiquetas_por_pallet||(S.etiquetas_por_pallet="Campo obligatorio")),or&&yt){const Ia=Number((Tt=r.cascadeData)==null?void 0:Tt.impresion);Ia!==5&&Ia!==6&&Ia!==7&&!r.numero_colores&&r.numero_colores!==0&&(S.numero_colores="Campo obligatorio")}return(mr||Ss)&&Number((gr=r.cascadeData)==null?void 0:gr.impresion)===2&&!r.design_type_id&&(S.design_type_id="Campo obligatorio"),at===ri.SuperAdministrador||(r.product_type_developing_id||(S.product_type_developing_id="Campo obligatorio"),r.target_market_id||(S.target_market_id="Campo obligatorio")),S},[r]),P=E.useCallback((S,at)=>{n(yt=>({...yt,[S]:at})),u(yt=>{if(yt[S]){const{[S]:mr,...or}=yt;return or}return yt})},[]),Q=E.useCallback(S=>{var mr,or,uo,Ss,$r,Cs,$s,Ra;S.preventDefault();const at=U();if(u(at),Object.keys(at).length>0){const ld=Object.keys(at).length;l(`Por favor complete los ${ld} campo(s) obligatorio(s) marcados en rojo`);const la=document.querySelector('[data-has-error="true"]');la&&la.scrollIntoView({behavior:"smooth",block:"center"});return}l(null);const yt={client_id:r.client_id,descripcion:r.descripcion,tipo_solicitud:r.tipo_solicitud,canal_id:r.canal_id,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,subsubhierarchy_id:r.subsubhierarchy_id,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:((mr=r.cascadeData)==null?void 0:mr.productTypeId)||void 0,impresion:(or=r.cascadeData)!=null&&or.impresion?Number(r.cascadeData.impresion):void 0,fsc:((uo=r.cascadeData)==null?void 0:uo.fsc)||void 0,cinta:(Ss=r.cascadeData)!=null&&Ss.cinta?Number(r.cascadeData.cinta):void 0,coverage_internal_id:(($r=r.cascadeData)==null?void 0:$r.coverageInternalId)||void 0,coverage_external_id:((Cs=r.cascadeData)==null?void 0:Cs.coverageExternalId)||void 0,carton_color:($s=r.cascadeData)!=null&&$s.cartonColor?Number(r.cascadeData.cartonColor):void 0,carton_id:((Ra=r.cascadeData)==null?void 0:Ra.cartonId)||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.planta_id||void 0};B.mutate(yt)},[r,B]),re=E.useCallback(()=>{n(a$),u({}),i(null),l(null)},[]);return a.jsxs(Bz,{children:[a.jsxs(Uz,{children:[a.jsx(Vz,{children:"Crear Nueva Orden de Trabajo"}),a.jsx(n$,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]}),s&&a.jsx(s$,{$type:"success",children:s}),o&&a.jsx(s$,{$type:"error",children:o}),a.jsxs("form",{onSubmit:Q,children:[a.jsxs(Es,{children:[a.jsx(vn,{children:"1.- Seleccione el Tipo de Solicitud"}),a.jsx(yn,{children:a.jsxs(Qz,{children:[a.jsxs(de,{style:{minWidth:"300px"},children:[a.jsx(ie,{children:"Tipo de solicitud:"}),a.jsxs(Me,{id:"tipo_solicitud_select",value:r.tipo_solicitud||"",onChange:S=>P("tipo_solicitud",S.target.value?Number(S.target.value):null),disabled:!!r.tipo_solicitud,children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),F.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsx(Yz,{type:"button",onClick:re,children:"Reiniciar Solicitud"})]})})]}),r.tipo_solicitud&&a.jsxs(a.Fragment,{children:[a.jsxs(Es,{children:[a.jsx(vn,{children:"2.- Datos comerciales"}),a.jsxs(yn,{children:[a.jsxs(da,{$columns:3,children:[a.jsxs(de,{"data-has-error":!!c.client_id,children:[a.jsx(ie,{style:{color:c.client_id?"#dc3545":void 0},children:"Cliente *"}),a.jsxs(Me,{$hasError:!!c.client_id,value:r.client_id||"",onChange:S=>P("client_id",S.target.value?Number(S.target.value):null),disabled:T,children:[a.jsx("option",{value:"",children:"Seleccione cliente..."}),j==null?void 0:j.clientes.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.client_id&&a.jsx(pt,{children:c.client_id})]}),a.jsxs(de,{"data-has-error":!!c.descripcion,children:[a.jsx(ie,{style:{color:c.descripcion?"#dc3545":void 0},children:"Descripcion del Producto *"}),a.jsx(je,{$hasError:!!c.descripcion,type:"text",maxLength:40,value:r.descripcion,onChange:S=>P("descripcion",S.target.value),placeholder:"Max 40 caracteres"}),c.descripcion&&a.jsx(pt,{children:c.descripcion})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Codigo Producto"}),a.jsx(je,{type:"text",value:r.codigo_producto,onChange:S=>P("codigo_producto",S.target.value)})]})]}),a.jsxs(da,{$columns:4,style:{marginTop:"1rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Tipo Solicitud *"}),a.jsxs(Me,{value:r.tipo_solicitud||"",disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),F.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{"data-has-error":!!c.volumen_venta_anual,children:[a.jsxs(ie,{style:{color:c.volumen_venta_anual?"#dc3545":void 0},children:["Vol Vta Anual ",r.tipo_solicitud!==3?"*":""]}),a.jsx(je,{$hasError:!!c.volumen_venta_anual,type:"number",value:r.volumen_venta_anual||"",onChange:S=>P("volumen_venta_anual",S.target.value?Number(S.target.value):null)}),c.volumen_venta_anual&&a.jsx(pt,{children:c.volumen_venta_anual})]}),a.jsxs(de,{"data-has-error":!!c.usd_monto,children:[a.jsxs(ie,{style:{color:c.usd_monto?"#dc3545":void 0},children:["USD ",r.tipo_solicitud!==3?"*":""]}),a.jsx(je,{$hasError:!!c.usd_monto,type:"text",value:r.usd_monto,onChange:S=>P("usd_monto",S.target.value),placeholder:"Monto USD"})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Jerarquia 1"}),a.jsxs(Me,{value:r.hierarchy_id||"",onChange:S=>P("hierarchy_id",S.target.value?Number(S.target.value):null),disabled:M,children:[a.jsx("option",{value:"",children:"Seleccione..."}),k==null?void 0:k.hierarchies.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]})]}),a.jsxs(da,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Instalacion Cliente"}),a.jsxs(Me,{value:r.instalacion_cliente_id||"",onChange:S=>P("instalacion_cliente_id",S.target.value?Number(S.target.value):null),disabled:!r.client_id||v,children:[a.jsx("option",{value:"",children:v?"Cargando...":"Seleccione..."}),h.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{"data-has-error":!!c.org_venta_id,children:[a.jsx(ie,{style:{color:c.org_venta_id?"#dc3545":void 0},children:"Org Venta"}),a.jsxs(Me,{$hasError:!!c.org_venta_id,value:r.org_venta_id||"",onChange:S=>P("org_venta_id",S.target.value?Number(S.target.value):null),disabled:T,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Z=j==null?void 0:j.org_ventas)==null?void 0:Z.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.org_venta_id&&a.jsx(pt,{children:c.org_venta_id})]}),a.jsxs(de,{"data-has-error":!!c.subhierarchy_id,children:[a.jsx(ie,{style:{color:c.subhierarchy_id?"#dc3545":void 0},children:"Jerarquia 2 *"}),a.jsxs(Me,{$hasError:!!c.subhierarchy_id,value:r.subhierarchy_id||"",onChange:S=>P("subhierarchy_id",S.target.value?Number(S.target.value):null),disabled:!r.hierarchy_id||M,children:[a.jsx("option",{value:"",children:"Seleccione..."}),A.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.subhierarchy_id&&a.jsx(pt,{children:c.subhierarchy_id})]})]}),a.jsxs(da,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Contactos Cliente"}),a.jsxs(Me,{value:r.contactos_cliente_id||"",onChange:S=>P("contactos_cliente_id",S.target.value?Number(S.target.value):null),disabled:!r.client_id||y,children:[a.jsx("option",{value:"",children:y?"Cargando...":"Seleccionar Opcion"}),m.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{"data-has-error":!!c.canal_id,children:[a.jsx(ie,{style:{color:c.canal_id?"#dc3545":void 0},children:"Canal *"}),a.jsxs(Me,{$hasError:!!c.canal_id,value:r.canal_id||"",onChange:S=>P("canal_id",S.target.value?Number(S.target.value):null),disabled:T,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),j==null?void 0:j.canales.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.canal_id&&a.jsx(pt,{children:c.canal_id})]}),a.jsxs(de,{"data-has-error":!!c.subsubhierarchy_id,children:[a.jsx(ie,{style:{color:c.subsubhierarchy_id?"#dc3545":void 0},children:"Jerarquia 3 *"}),a.jsxs(Me,{$hasError:!!c.subsubhierarchy_id,value:r.subsubhierarchy_id||"",onChange:S=>P("subsubhierarchy_id",S.target.value?Number(S.target.value):null),disabled:!r.subhierarchy_id||M,children:[a.jsx("option",{value:"",children:"Seleccione..."}),O.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.subsubhierarchy_id&&a.jsx(pt,{children:c.subsubhierarchy_id})]})]}),a.jsxs(da,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(de,{"data-has-error":!!c.nombre_contacto,children:[a.jsx(ie,{style:{color:c.nombre_contacto?"#dc3545":void 0},children:"Nombre Contacto *"}),a.jsx(je,{$hasError:!!c.nombre_contacto,type:"text",value:r.nombre_contacto,onChange:S=>P("nombre_contacto",S.target.value)}),c.nombre_contacto&&a.jsx(pt,{children:c.nombre_contacto})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"OC"}),a.jsx(Me,{value:r.orden_compra_id||"",onChange:S=>P("orden_compra_id",S.target.value?Number(S.target.value):null),disabled:!r.client_id,children:a.jsx("option",{value:"",children:"Seleccionar..."})})]}),a.jsx(de,{})]}),a.jsxs(da,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(de,{"data-has-error":!!c.email_contacto,children:[a.jsx(ie,{style:{color:c.email_contacto?"#dc3545":void 0},children:"Email Contacto *"}),a.jsx(je,{$hasError:!!c.email_contacto,type:"email",value:r.email_contacto,onChange:S=>P("email_contacto",S.target.value)}),c.email_contacto&&a.jsx(pt,{children:c.email_contacto})]}),a.jsx(de,{}),a.jsx(de,{})]}),a.jsxs(da,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(de,{"data-has-error":!!c.telefono_contacto,children:[a.jsx(ie,{style:{color:c.telefono_contacto?"#dc3545":void 0},children:"Telefono Contacto *"}),a.jsx(je,{$hasError:!!c.telefono_contacto,type:"tel",value:r.telefono_contacto,onChange:S=>P("telefono_contacto",S.target.value)}),c.telefono_contacto&&a.jsx(pt,{children:c.telefono_contacto})]}),a.jsx(de,{}),a.jsx(de,{})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5fr 2fr 5fr",gap:"1rem",marginBottom:"1rem"},children:[a.jsxs(Es,{style:{marginBottom:0},children:[a.jsx(vn,{children:"3.- Antecedentes Desarrollo"}),a.jsxs(yn,{children:[a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(ie,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs(Dv,{children:[a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:S=>P("ant_des_correo_cliente",S.target.checked)}),"Correo Cliente"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:S=>P("ant_des_plano_actual",S.target.checked)}),"Plano Actual"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:S=>P("ant_des_boceto_actual",S.target.checked)}),"Boceto Actual"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:S=>P("ant_des_spec",S.target.checked)}),"Spec"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:S=>P("ant_des_otro",S.target.checked)}),"Otro"]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(ie,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(Dv,{children:[a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:S=>P("ant_des_cj_referencia_de",S.target.checked)}),"CJ Referencia DE"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:S=>P("ant_des_cj_referencia_dg",S.target.checked)}),"CJ Referencia DG"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:S=>P("ant_des_envase_primario",S.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[a.jsxs(de,{style:{flex:1},children:[a.jsx(ie,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(bn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>P("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>P("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(de,{style:{flex:1},"data-has-error":!!c.armado_automatico,children:[a.jsx(ie,{style:{color:c.armado_automatico?"#dc3545":void 0},children:"Armado Automatico"}),a.jsxs(Me,{$hasError:!!c.armado_automatico,value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:S=>P("armado_automatico",S.target.value===""?null:S.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.armado_automatico&&a.jsx(pt,{children:c.armado_automatico})]})]})]})]}),a.jsxs(Es,{style:{marginBottom:0},children:[a.jsx(vn,{children:"4.- Solicita"}),a.jsxs(yn,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:S=>P("analisis",S.target.checked)}),"Analisis"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:S=>P("prueba_industrial",S.target.checked)}),"Prueba Industrial"]}),a.jsxs(bn,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:S=>{S.target.checked?w(!0):(P("muestra",!1),P("numero_muestras",null))}}),"Muestra"]})]}),r.muestra&&a.jsxs(de,{style:{marginTop:"1rem"},children:[a.jsx(ie,{children:"N Muestras"}),a.jsx(je,{type:"number",min:"1",value:r.numero_muestras||"",onChange:S=>P("numero_muestras",S.target.value?Number(S.target.value):null),style:{width:"100px"},disabled:!0,readOnly:!0})]})]})]}),a.jsxs(Es,{style:{marginBottom:0},children:[a.jsx(vn,{children:"5.- Referencia Material"}),a.jsxs(yn,{children:[a.jsxs(da,{$columns:2,children:[a.jsxs(de,{"data-has-error":!!c.reference_type,children:[a.jsx(ie,{style:{color:c.reference_type?"#dc3545":void 0},children:"Tipo Referencia"}),a.jsxs(Me,{$hasError:!!c.reference_type,value:r.reference_type===null?"":r.reference_type,onChange:S=>P("reference_type",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(W=k==null?void 0:k.reference_types)==null?void 0:W.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]}),c.reference_type&&a.jsx(pt,{children:c.reference_type})]}),a.jsxs(de,{"data-has-error":!!c.reference_id,children:[a.jsx(ie,{style:{color:c.reference_id?"#dc3545":void 0},children:"Referencia"}),a.jsxs(Me,{$hasError:!!c.reference_id,value:r.reference_id||"",onChange:S=>P("reference_id",S.target.value?Number(S.target.value):null),disabled:!r.reference_type,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ce=k==null?void 0:k.materials)==null?void 0:ce.map(S=>a.jsxs("option",{value:S.id,children:[S.codigo||S.nombre,S.descripcion?` - ${S.descripcion}`:""]},String(S.id)))]}),c.reference_id&&a.jsx(pt,{children:c.reference_id})]}),a.jsxs(de,{"data-has-error":!!c.bloqueo_referencia,children:[a.jsx(ie,{style:{color:c.bloqueo_referencia?"#dc3545":void 0},children:"Bloqueo Referencia"}),a.jsxs(Me,{$hasError:!!c.bloqueo_referencia,value:r.bloqueo_referencia===null?"":r.bloqueo_referencia,onChange:S=>P("bloqueo_referencia",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(te=k==null?void 0:k.bloqueo_referencia)==null?void 0:te.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]}),c.bloqueo_referencia&&a.jsx(pt,{children:c.bloqueo_referencia})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Indicador Facturacion D.E."}),a.jsxs(Me,{value:r.indicador_facturacion||"",onChange:S=>P("indicador_facturacion",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(D=k==null?void 0:k.indicador_facturacion)==null?void 0:D.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]})]})]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f8f9fa",borderRadius:"4px"},children:[a.jsx(ie,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Archivo Visto Bueno"}),a.jsxs(Dv,{children:[a.jsxs(bn,{style:{color:"#28a745",fontWeight:"bold"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_muestra,onChange:S=>P("ant_des_vb_muestra",S.target.checked)}),"VB Muestra"]}),a.jsxs(bn,{style:{color:"#28a745",fontWeight:"bold"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_boceto,onChange:S=>P("ant_des_vb_boceto",S.target.checked)}),"VB Boceto"]})]})]})]})]})]}),a.jsxs(Es,{children:[a.jsx(vn,{children:"6.- Asistente Para: Ingresos Principales"}),a.jsx(yn,{children:a.jsx(KP,{values:r.cascadeData,onChange:L,fieldErrors:c})})]}),a.jsxs(Es,{children:[a.jsx(vn,{children:"7.- Caracteristicas"}),a.jsx(yn,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem"},children:[a.jsxs("div",{children:[a.jsxs(de,{children:[a.jsx(ie,{children:"CAD"}),a.jsxs(Me,{value:r.cad_id||"",onChange:S=>P("cad_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(R=k==null?void 0:k.cads)==null?void 0:R.map(S=>a.jsx("option",{value:S.id,children:S.codigo||S.nombre},String(S.id)))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Matriz"}),a.jsx(Me,{value:r.matriz_id||"",onChange:S=>P("matriz_id",S.target.value?Number(S.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Tipo Matriz"}),a.jsx(je,{type:"text",value:r.tipo_matriz_text,onChange:S=>P("tipo_matriz_text",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Tipo Item"}),a.jsx(je,{type:"text",value:r.cascadeData.productTypeId&&((H=(N=k==null?void 0:k.product_types)==null?void 0:N.find(S=>S.id===r.cascadeData.productTypeId))==null?void 0:H.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Items del Set"}),a.jsx(je,{type:"number",min:"0",value:r.items_set||"",onChange:S=>P("items_set",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Veces Item"}),a.jsx(je,{type:"number",min:"0",value:r.veces_item||"",onChange:S=>P("veces_item",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color Carton"}),a.jsx(je,{type:"text",value:r.cascadeData.cartonColor||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Carton"}),a.jsx(je,{type:"text",value:r.cascadeData.cartonId&&((J=(ee=k==null?void 0:k.cartons)==null?void 0:ee.find(S=>S.id===r.cascadeData.cartonId))==null?void 0:J.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Cinta"}),a.jsx(je,{type:"text",value:r.cascadeData.cinta?((ge=(he=k==null?void 0:k.tipo_cinta)==null?void 0:he.find(S=>S.id===Number(r.cascadeData.cinta)))==null?void 0:ge.nombre)||r.cascadeData.cinta:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"FSC"}),a.jsx(je,{type:"text",value:r.cascadeData.fsc?((De=(xe=k==null?void 0:k.fsc)==null?void 0:xe.find(S=>S.id===Number(r.cascadeData.fsc)))==null?void 0:De.nombre)||String(r.cascadeData.fsc):"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{"data-has-error":!!c.pallet_qa_id,children:[a.jsx(ie,{style:{color:c.pallet_qa_id?"#dc3545":void 0},children:"Certificado Calidad"}),a.jsx(Me,{$hasError:!!c.pallet_qa_id,value:r.pallet_qa_id||"",onChange:S=>P("pallet_qa_id",S.target.value?Number(S.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})}),c.pallet_qa_id&&a.jsx(pt,{children:c.pallet_qa_id})]}),a.jsxs(de,{"data-has-error":!!c.pais_id,children:[a.jsx(ie,{style:{color:c.pais_id?"#dc3545":void 0},children:"Pais/Mercado Destino"}),a.jsxs(Me,{$hasError:!!c.pais_id,value:r.pais_id||"",onChange:S=>P("pais_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(X=k==null?void 0:k.pais_referencia)==null?void 0:X.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]}),c.pais_id&&a.jsx(pt,{children:c.pais_id})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Planta Objetivo"}),a.jsx(je,{type:"text",value:r.cascadeData.plantaId&&((We=(rt=k==null?void 0:k.plantas)==null?void 0:rt.find(S=>S.id===r.cascadeData.plantaId))==null?void 0:We.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{"data-has-error":!!c.restriccion_pallet,children:[a.jsx(ie,{style:{color:c.restriccion_pallet?"#dc3545":void 0},children:"Restriccion Paletizado"}),a.jsxs(Me,{$hasError:!!c.restriccion_pallet,value:r.restriccion_pallet===null?"":r.restriccion_pallet,onChange:S=>P("restriccion_pallet",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.restriccion_pallet&&a.jsx(pt,{children:c.restriccion_pallet})]}),a.jsxs(de,{"data-has-error":!!c.tamano_pallet_type_id,children:[a.jsx(ie,{style:{color:c.tamano_pallet_type_id?"#dc3545":void 0},children:"Tamano Pallet"}),a.jsxs(Me,{$hasError:!!c.tamano_pallet_type_id,value:r.tamano_pallet_type_id||"",onChange:S=>P("tamano_pallet_type_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(dt=k==null?void 0:k.pallet_types)==null?void 0:dt.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]}),c.tamano_pallet_type_id&&a.jsx(pt,{children:c.tamano_pallet_type_id})]}),a.jsxs(de,{"data-has-error":!!c.altura_pallet,children:[a.jsx(ie,{style:{color:c.altura_pallet?"#dc3545":void 0},children:"Altura Pallet"}),a.jsx(je,{$hasError:!!c.altura_pallet,type:"number",min:"0",value:r.altura_pallet||"",onChange:S=>P("altura_pallet",S.target.value?Number(S.target.value):null)}),c.altura_pallet&&a.jsx(pt,{children:c.altura_pallet})]}),a.jsxs(de,{"data-has-error":!!c.permite_sobresalir_carga,children:[a.jsx(ie,{style:{color:c.permite_sobresalir_carga?"#dc3545":void 0},children:"Permite Sobresalir Carga"}),a.jsxs(Me,{$hasError:!!c.permite_sobresalir_carga,value:r.permite_sobresalir_carga===null?"":r.permite_sobresalir_carga,onChange:S=>P("permite_sobresalir_carga",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.permite_sobresalir_carga&&a.jsx(pt,{children:c.permite_sobresalir_carga})]})]}),a.jsxs("div",{children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Estilo"}),a.jsxs(Me,{value:r.style_id||"",onChange:S=>P("style_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(pe=k==null?void 0:k.styles)==null?void 0:pe.map(S=>a.jsx("option",{value:S.id,children:S.nombre},String(S.id)))]})]}),a.jsxs(de,{"data-has-error":!!c.caracteristicas_adicionales,children:[a.jsx(ie,{style:{color:c.caracteristicas_adicionales?"#dc3545":void 0},children:"Caracteristica Estilo"}),a.jsx(je,{$hasError:!!c.caracteristicas_adicionales,type:"text",value:r.caracteristicas_adicionales,onChange:S=>P("caracteristicas_adicionales",S.target.value)}),c.caracteristicas_adicionales&&a.jsx(pt,{children:c.caracteristicas_adicionales})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Largura HM"}),a.jsx(je,{type:"number",value:r.largura_hm||"",onChange:S=>P("largura_hm",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Anchura HM"}),a.jsx(je,{type:"number",value:r.anchura_hm||"",onChange:S=>P("anchura_hm",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Area Producto (M2)"}),a.jsx(je,{type:"number",value:r.area_producto_m2||"",onChange:S=>P("area_producto_m2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Recorte Adicional / Area Agujero (M2)"}),a.jsx(je,{type:"number",value:r.recorte_adicional_m2||"",onChange:S=>P("recorte_adicional_m2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Longitud Pegado (MM)"}),a.jsx(je,{type:"number",value:r.longitud_pegado_mm||"",onChange:S=>P("longitud_pegado_mm",S.target.value?Number(S.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Golpes al Largo"}),a.jsx(je,{type:"number",value:r.golpes_largo||"",onChange:S=>P("golpes_largo",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Golpes al Ancho"}),a.jsx(je,{type:"number",value:r.golpes_ancho||"",onChange:S=>P("golpes_ancho",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Separacion Golpes Largo (MM)"}),a.jsx(je,{type:"number",value:r.separacion_golpes_largo||"",onChange:S=>P("separacion_golpes_largo",S.target.value?Number(S.target.value):null),placeholder:"0"})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Separacion Golpes Ancho (MM)"}),a.jsx(je,{type:"number",value:r.separacion_golpes_ancho||"",onChange:S=>P("separacion_golpes_ancho",S.target.value?Number(S.target.value):null),placeholder:"0"})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Cuchillas (ML)"}),a.jsx(je,{type:"number",value:r.cuchillas_ml||"",onChange:S=>P("cuchillas_ml",S.target.value?Number(S.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Rayado C1/R1 (MM)"}),a.jsx(je,{type:"number",value:r.rayado_c1_r1||"",onChange:S=>P("rayado_c1_r1",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Rayado R1/R2 (MM)"}),a.jsx(je,{type:"number",value:r.rayado_r1_r2||"",onChange:S=>P("rayado_r1_r2",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Rayado R2/C2 (MM)"}),a.jsx(je,{type:"number",value:r.rayado_r2_c2||"",onChange:S=>P("rayado_r2_c2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{"data-has-error":!!c.bulto_zunchado_pallet,children:[a.jsx(ie,{style:{color:c.bulto_zunchado_pallet?"#dc3545":void 0},children:"Bulto Zunchado al Pallet"}),a.jsxs(Me,{$hasError:!!c.bulto_zunchado_pallet,value:r.bulto_zunchado_pallet===null?"":r.bulto_zunchado_pallet,onChange:S=>P("bulto_zunchado_pallet",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.bulto_zunchado_pallet&&a.jsx(pt,{children:c.bulto_zunchado_pallet})]}),a.jsxs(de,{"data-has-error":!!c.formato_etiqueta_pallet,children:[a.jsx(ie,{style:{color:c.formato_etiqueta_pallet?"#dc3545":void 0},children:"Formato Etiqueta Pallet"}),a.jsx(Me,{$hasError:!!c.formato_etiqueta_pallet,value:r.formato_etiqueta_pallet||"",onChange:S=>P("formato_etiqueta_pallet",S.target.value?Number(S.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})}),c.formato_etiqueta_pallet&&a.jsx(pt,{children:c.formato_etiqueta_pallet})]}),a.jsxs(de,{"data-has-error":!!c.etiquetas_por_pallet,children:[a.jsx(ie,{style:{color:c.etiquetas_por_pallet?"#dc3545":void 0},children:"N Etiquetas por Pallet"}),a.jsx(je,{$hasError:!!c.etiquetas_por_pallet,type:"number",value:r.etiquetas_por_pallet||"",onChange:S=>P("etiquetas_por_pallet",S.target.value?Number(S.target.value):null)}),c.etiquetas_por_pallet&&a.jsx(pt,{children:c.etiquetas_por_pallet})]}),a.jsxs(de,{"data-has-error":!!c.termocontraible,children:[a.jsx(ie,{style:{color:c.termocontraible?"#dc3545":void 0},children:"Termocontraible"}),a.jsxs(Me,{$hasError:!!c.termocontraible,value:r.termocontraible===null?"":r.termocontraible,onChange:S=>P("termocontraible",S.target.value===""?null:Number(S.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"BCT MIN (LB)"}),a.jsx(je,{type:"number",value:r.bct_min_lb||"",onChange:S=>P("bct_min_lb",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"BCT MIN (KG)"}),a.jsx(je,{type:"number",value:r.bct_min_kg||"",onChange:S=>P("bct_min_kg",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"BCT HUMEDO (LB)"}),a.jsx(je,{type:"number",value:r.bct_humedo_lb||"",onChange:S=>P("bct_humedo_lb",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"ECT MIN (LB/PULG)"}),a.jsx(je,{type:"number",value:r.ect_min_lb_pulg||"",onChange:S=>P("ect_min_lb_pulg",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"GRAMAJE (G/M2)"}),a.jsx(je,{type:"number",value:r.gramaje_g_m2||"",onChange:S=>P("gramaje_g_m2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"MULLEN (LB/PULG2)"}),a.jsx(je,{type:"number",value:r.mullen_lb_pulg2||"",onChange:S=>P("mullen_lb_pulg2",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"FCT (LB/PULG2)"}),a.jsx(je,{type:"number",value:r.fct_lb_pulg2||"",onChange:S=>P("fct_lb_pulg2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"DST (BPI)"}),a.jsx(je,{type:"number",value:r.dst_bpi||"",onChange:S=>P("dst_bpi",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"ESPESOR PLACA (MM)"}),a.jsx(je,{type:"number",value:r.espesor_placa_mm||"",onChange:S=>P("espesor_placa_mm",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"ESPESOR CAJA (MM)"}),a.jsx(je,{type:"number",value:r.espesor_caja_mm||"",onChange:S=>P("espesor_caja_mm",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"COBB INTERIOR (G/M2)"}),a.jsx(je,{type:"number",value:r.cobb_interior_g_m2||"",onChange:S=>P("cobb_interior_g_m2",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"COBB EXTERIOR (G/M2)"}),a.jsx(je,{type:"number",value:r.cobb_exterior_g_m2||"",onChange:S=>P("cobb_exterior_g_m2",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"FLEXION DE ALETA (N)"}),a.jsx(je,{type:"number",value:r.flexion_aleta_n||"",onChange:S=>P("flexion_aleta_n",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"PESO CLIENTE (G)"}),a.jsx(je,{type:"number",value:r.peso_cliente_g||"",onChange:S=>P("peso_cliente_g",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Incision Rayado Longitudinal (N)"}),a.jsx(je,{type:"text",value:r.incision_rayado_longitudinal,onChange:S=>P("incision_rayado_longitudinal",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Incision Rayado Transversal (N)"}),a.jsx(je,{type:"text",value:r.incision_rayado_transversal,onChange:S=>P("incision_rayado_transversal",S.target.value)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Porosidad (SEG)"}),a.jsx(je,{type:"text",value:r.porosidad,onChange:S=>P("porosidad",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Brillo (%)"}),a.jsx(je,{type:"text",value:r.brillo,onChange:S=>P("brillo",S.target.value)})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Rigidez 4 Puntos Longitudinal (N/mm)"}),a.jsx(je,{type:"text",value:r.rigidez_4_ptos_long,onChange:S=>P("rigidez_4_ptos_long",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Rigidez 4 Puntos Transversal (N/mm)"}),a.jsx(je,{type:"text",value:r.rigidez_4_ptos_transv,onChange:S=>P("rigidez_4_ptos_transv",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Angulo Deslizamiento-Tapa Exterior"}),a.jsx(je,{type:"text",value:r.angulo_deslizamiento_exterior,onChange:S=>P("angulo_deslizamiento_exterior",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Angulo Deslizamiento-Tapa Interior"}),a.jsx(je,{type:"text",value:r.angulo_deslizamiento_interior,onChange:S=>P("angulo_deslizamiento_interior",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Resistencia al Frote"}),a.jsx(je,{type:"text",value:r.resistencia_frote,onChange:S=>P("resistencia_frote",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Contenido Reciclado (%)"}),a.jsx(je,{type:"text",value:r.contenido_reciclado,onChange:S=>P("contenido_reciclado",S.target.value)})]})]})]})})]}),a.jsxs(Es,{children:[a.jsx(vn,{children:"8.- Color-Cera-Barniz"}),a.jsx(yn,{children:a.jsxs(Hz,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Impresin"}),a.jsx(je,{type:"text",value:r.cascadeData.impresion?((Nt=(ve=k==null?void 0:k.impresiones)==null?void 0:ve.find(S=>String(S.id)===String(r.cascadeData.impresion)))==null?void 0:Nt.nombre)||r.cascadeData.impresion:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Trazabilidad"}),a.jsxs(Me,{value:r.trazabilidad||"",onChange:S=>P("trazabilidad",S.target.value?Number(S.target.value):null),disabled:M,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(gn=k==null?void 0:k.trazabilidad)==null?void 0:gn.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{"data-has-error":!!c.design_type_id,children:[a.jsx(ie,{style:{color:c.design_type_id?"#dc3545":void 0},children:"Tipo Diseo"}),a.jsxs(Me,{$hasError:!!c.design_type_id,value:r.design_type_id||"",onChange:S=>P("design_type_id",S.target.value?Number(S.target.value):null),disabled:M,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ns=k==null?void 0:k.design_types)==null?void 0:ns.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),c.design_type_id&&a.jsx(pt,{children:c.design_type_id})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Complejidad"}),a.jsx(je,{type:"text",value:r.complejidad,onChange:S=>P("complejidad",S.target.value)})]}),a.jsxs(de,{"data-has-error":!!c.numero_colores,children:[a.jsx(ie,{style:{color:c.numero_colores?"#dc3545":void 0},children:"Nmero Colores"}),a.jsxs(Me,{$hasError:!!c.numero_colores,value:r.numero_colores!==null?r.numero_colores:"",onChange:S=>P("numero_colores",S.target.value!==""?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5,6,7].map(S=>a.jsx("option",{value:S,children:S},S))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Recubrimiento Interno"}),a.jsx(je,{type:"text",value:r.cascadeData.coverageInternalId&&((lo=(js=k==null?void 0:k.coverages_internal)==null?void 0:js.find(S=>S.id===r.cascadeData.coverageInternalId))==null?void 0:lo.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{"data-has-error":!!c.percentage_coverage_internal,children:[a.jsx(ie,{style:{color:c.percentage_coverage_internal?"#dc3545":void 0},children:"% Recubrimiento Interno"}),a.jsx(je,{$hasError:!!c.percentage_coverage_internal,type:"number",min:"0",value:r.percentage_coverage_internal||"",onChange:S=>P("percentage_coverage_internal",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Recubrimiento Externo"}),a.jsx(je,{type:"text",value:r.cascadeData.coverageExternalId&&((Xr=(ia=k==null?void 0:k.coverages_external)==null?void 0:ia.find(S=>S.id===r.cascadeData.coverageExternalId))==null?void 0:Xr.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(de,{"data-has-error":!!c.percentage_coverage_external,children:[a.jsx(ie,{style:{color:c.percentage_coverage_external?"#dc3545":void 0},children:"% Recubrimiento Externo"}),a.jsx(je,{$hasError:!!c.percentage_coverage_external,type:"number",min:"0",value:r.percentage_coverage_external||"",onChange:S=>P("percentage_coverage_external",S.target.value?Number(S.target.value):null)})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Color 1 (Interior TyR)"}),a.jsxs(Me,{value:r.color_1_id||"",onChange:S=>P("color_1_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ks=k==null?void 0:k.colors)==null?void 0:ks.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 1"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_1||"",onChange:S=>P("impresion_1",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 1"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_1||"",onChange:S=>P("cm2_clisse_color_1",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color 2"}),a.jsxs(Me,{value:r.color_2_id||"",onChange:S=>P("color_2_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(oa=k==null?void 0:k.colors)==null?void 0:oa.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 2"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_2||"",onChange:S=>P("impresion_2",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 2"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_2||"",onChange:S=>P("cm2_clisse_color_2",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color 3"}),a.jsxs(Me,{value:r.color_3_id||"",onChange:S=>P("color_3_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(co=k==null?void 0:k.colors)==null?void 0:co.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 3"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_3||"",onChange:S=>P("impresion_3",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 3"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_3||"",onChange:S=>P("cm2_clisse_color_3",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color 4"}),a.jsxs(Me,{value:r.color_4_id||"",onChange:S=>P("color_4_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Cr=k==null?void 0:k.colors)==null?void 0:Cr.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 4"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_4||"",onChange:S=>P("impresion_4",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 4"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_4||"",onChange:S=>P("cm2_clisse_color_4",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Color 5"}),a.jsxs(Me,{value:r.color_5_id||"",onChange:S=>P("color_5_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ss=k==null?void 0:k.colors)==null?void 0:ss.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 5"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_5||"",onChange:S=>P("impresion_5",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 5"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_5||"",onChange:S=>P("cm2_clisse_color_5",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color 6"}),a.jsxs(Me,{value:r.color_6_id||"",onChange:S=>P("color_6_id",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Ge=k==null?void 0:k.colors)==null?void 0:Ge.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 6"}),a.jsx(je,{type:"number",min:"0",value:r.impresion_6||"",onChange:S=>P("impresion_6",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 6"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_6||"",onChange:S=>P("cm2_clisse_color_6",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Color 7 (Barniz UV)"}),a.jsxs(Me,{value:r.barniz_uv||"",onChange:S=>P("barniz_uv",S.target.value?Number(S.target.value):null),disabled:M||r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Lt=k==null?void 0:k.colors)==null?void 0:Lt.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"% Impresin 7 UV"}),a.jsx(je,{type:"number",min:"0",value:r.porcentaje_barniz_uv||"",onChange:S=>P("porcentaje_barniz_uv",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Clisse cm2 7"}),a.jsx(je,{type:"number",min:"0",value:r.cm2_clisse_color_7||"",onChange:S=>P("cm2_clisse_color_7",S.target.value?Number(S.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Indicador Facturacin D.G."}),a.jsx(je,{type:"text",value:r.indicador_facturacion_diseno_grafico,onChange:S=>P("indicador_facturacion_diseno_grafico",S.target.value)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Prueba de Color"}),a.jsxs(Me,{value:r.prueba_color!==null?r.prueba_color:"",onChange:S=>P("prueba_color",S.target.value!==""?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]})]}),a.jsxs(de,{"data-has-error":!!c.impresion_borde,children:[a.jsx(ie,{style:{color:c.impresion_borde?"#dc3545":void 0},children:"Impresin de Borde"}),a.jsxs(Me,{$hasError:!!c.impresion_borde,value:r.impresion_borde,onChange:S=>P("impresion_borde",S.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(de,{"data-has-error":!!c.impresion_sobre_rayado,children:[a.jsx(ie,{style:{color:c.impresion_sobre_rayado?"#dc3545":void 0},children:"Impresin Sobre Rayado"}),a.jsxs(Me,{$hasError:!!c.impresion_sobre_rayado,value:r.impresion_sobre_rayado,onChange:S=>P("impresion_sobre_rayado",S.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Total Clisse cm2"}),a.jsx(je,{type:"number",min:"0",value:r.total_cm2_clisse||"",onChange:S=>P("total_cm2_clisse",S.target.value?Number(S.target.value):null)})]})]})]})})]}),a.jsxs(Wz,{children:[a.jsxs(Pv,{children:[a.jsx(vn,{children:"9.- Medidas Interiores"}),a.jsx(yn,{children:a.jsxs(da,{$columns:1,children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Largo (mm)"}),a.jsx(je,{type:"number",value:r.interno_largo||"",onChange:S=>P("interno_largo",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Ancho (mm)"}),a.jsx(je,{type:"number",value:r.interno_ancho||"",onChange:S=>P("interno_ancho",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Alto (mm)"}),a.jsx(je,{type:"number",value:r.interno_alto||"",onChange:S=>P("interno_alto",S.target.value?Number(S.target.value):null)})]})]})})]}),a.jsxs(Pv,{children:[a.jsx(vn,{children:"10.- Medidas Exteriores"}),a.jsx(yn,{children:a.jsxs(da,{$columns:1,children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Largo (mm)"}),a.jsx(je,{type:"number",value:r.externo_largo||"",onChange:S=>P("externo_largo",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Ancho (mm)"}),a.jsx(je,{type:"number",value:r.externo_ancho||"",onChange:S=>P("externo_ancho",S.target.value?Number(S.target.value):null)})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Alto (mm)"}),a.jsx(je,{type:"number",value:r.externo_alto||"",onChange:S=>P("externo_alto",S.target.value?Number(S.target.value):null)})]})]})})]}),a.jsxs(Pv,{children:[a.jsx(vn,{children:"11.- Terminaciones"}),a.jsx(yn,{children:a.jsxs(da,{$columns:1,children:[a.jsxs(de,{children:[a.jsx(ie,{children:"Proceso"}),a.jsxs(Me,{value:r.process_id||"",onChange:S=>P("process_id",S.target.value?Number(S.target.value):null),disabled:T,children:[a.jsx("option",{value:"",children:"Seleccione..."}),j==null?void 0:j.procesos.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs(de,{"data-has-error":!!c.pegado_terminacion,children:[a.jsx(ie,{style:{color:c.pegado_terminacion?"#dc3545":void 0},children:"Tipo Pegado"}),a.jsxs(Me,{$hasError:!!c.pegado_terminacion,value:r.pegado_terminacion||"",onChange:S=>P("pegado_terminacion",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"Pegado Simple"}),a.jsx("option",{value:2,children:"Pegado Doble"}),a.jsx("option",{value:3,children:"Sin Pegado"})]}),c.pegado_terminacion&&a.jsx(pt,{children:c.pegado_terminacion})]}),a.jsxs(de,{"data-has-error":!!c.armado_id,children:[a.jsx(ie,{style:{color:c.armado_id?"#dc3545":void 0},children:"Armado"}),a.jsxs(Me,{$hasError:!!c.armado_id,value:r.armado_id||"",onChange:S=>P("armado_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"Manual"}),a.jsx("option",{value:2,children:"Automtico"}),a.jsx("option",{value:3,children:"Semi-automtico"})]}),c.armado_id&&a.jsx(pt,{children:c.armado_id})]}),a.jsxs(de,{"data-has-error":!!c.sentido_armado,children:[a.jsx(ie,{style:{color:c.sentido_armado?"#dc3545":void 0},children:"Sentido de Armado *"}),a.jsxs(Me,{$hasError:!!c.sentido_armado,value:r.sentido_armado||"",onChange:S=>P("sentido_armado",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"Horizontal"}),a.jsx("option",{value:2,children:"Vertical"})]}),c.sentido_armado&&a.jsx(pt,{children:c.sentido_armado})]}),a.jsxs(de,{"data-has-error":!!c.maquila,children:[a.jsx(ie,{style:{color:c.maquila?"#dc3545":void 0},children:"Maquila"}),a.jsxs(Me,{$hasError:!!c.maquila,value:r.maquila||"",onChange:S=>P("maquila",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]}),c.maquila&&a.jsx(pt,{children:c.maquila})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"Servicios Maquila"}),a.jsxs(Me,{value:r.maquila_servicio_id||"",onChange:S=>P("maquila_servicio_id",S.target.value?Number(S.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"Servicio A"}),a.jsx("option",{value:2,children:"Servicio B"}),a.jsx("option",{value:3,children:"Servicio C"})]})]})]})})]})]}),a.jsxs(Es,{children:[a.jsx(vn,{children:"12.- Secuencia Operacional"}),a.jsxs(yn,{children:[a.jsxs("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[a.jsx(ie,{style:{fontWeight:"600",minWidth:"60px"},children:"PLANTA:"}),a.jsxs(Me,{value:r.so_planta_original||"",onChange:S=>P("so_planta_original",S.target.value?Number(S.target.value):null),style:{width:"200px"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),j==null?void 0:j.plantas.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ORIGINAL"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 1"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 2"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 3"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 4"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 5"})]})}),a.jsx("tbody",{children:[0,1,2,3,4,5].map(S=>a.jsx("tr",{children:[0,1,2,3,4,5].map(at=>{var yt,mr;return a.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #e5e7eb"},children:a.jsxs(Me,{value:((yt=r.secuencia_operacional_matrix[S])==null?void 0:yt[at])||"",onChange:or=>{const uo=r.secuencia_operacional_matrix.map((Ss,$r)=>$r===S?Ss.map((Cs,$s)=>$s===at?or.target.value||null:Cs):[...Ss]);P("secuencia_operacional_matrix",uo)},style:{width:"100%",fontSize:"0.8rem",padding:"0.25rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(mr=k==null?void 0:k.secuencia_operacional)==null?void 0:mr.map(or=>a.jsx("option",{value:or.id,children:or.descripcion||or.nombre},or.id))]})},at)})},S))})]})})]})]}),a.jsxs(Es,{children:[a.jsx(vn,{children:"13.- Material Asignado"}),a.jsx(yn,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",maxWidth:"100%"},children:[a.jsxs(de,{children:[a.jsx(ie,{children:"MATERIAL ASIGNADO"}),a.jsx(je,{type:"text",value:r.material_asignado,onChange:S=>P("material_asignado",S.target.value),placeholder:"Cdigo de material..."})]}),a.jsxs(de,{children:[a.jsx(ie,{children:"DESCRIPCIN"}),a.jsx(je,{type:"text",value:r.descripcion_material,onChange:S=>P("descripcion_material",S.target.value),placeholder:"Descripcin del material..."})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"65% 35%",gap:"0.5rem",maxWidth:"100%",overflow:"hidden"},children:[a.jsxs(Es,{style:{margin:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[a.jsx(vn,{children:"13.- Datos para desarrollo"}),a.jsx(yn,{style:{overflow:"hidden",padding:"0.5rem"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.7rem",maxWidth:"100%"},children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.product_type_developing_id?"#dc3545":void 0},children:"TIPO PRODUCTO:"}),a.jsxs(Me,{$hasError:!!c.product_type_developing_id,value:r.product_type_developing_id||"",onChange:S=>P("product_type_developing_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(xn=k==null?void 0:k.product_types)==null?void 0:xn.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.peso_contenido_caja?"#dc3545":void 0},children:"PESO CAJA (KG):"}),a.jsx(je,{$hasError:!!c.peso_contenido_caja,type:"number",value:r.peso_contenido_caja||"",onChange:S=>P("peso_contenido_caja",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.food_type_id?"#dc3545":void 0},children:"TIPO ALIMENTO:"}),a.jsxs(Me,{$hasError:!!c.food_type_id,value:r.food_type_id||"",onChange:S=>P("food_type_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Kt=k==null?void 0:k.food_types)==null?void 0:Kt.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.autosoportante?"#dc3545":void 0},children:"AUTOSOPORTANTE:"}),a.jsxs(Me,{$hasError:!!c.autosoportante,value:r.autosoportante===null?"":r.autosoportante?"1":"0",onChange:S=>P("autosoportante",S.target.value===""?null:S.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.expected_use_id?"#dc3545":void 0},children:"USO PREVISTO:"}),a.jsxs(Me,{$hasError:!!c.expected_use_id,value:r.expected_use_id||"",onChange:S=>P("expected_use_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Oa=k==null?void 0:k.expected_uses)==null?void 0:Oa.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.envase_id?"#dc3545":void 0},children:"ENVASE PRIMARIO:"}),a.jsxs(Me,{$hasError:!!c.envase_id,value:r.envase_id||"",onChange:S=>P("envase_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ju=k==null?void 0:k.envases)==null?void 0:Ju.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.recycled_use_id?"#dc3545":void 0},children:"USO RECICLADO:"}),a.jsxs(Me,{$hasError:!!c.recycled_use_id,value:r.recycled_use_id||"",onChange:S=>P("recycled_use_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(fp=k==null?void 0:k.recycled_uses)==null?void 0:fp.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad_cajas_apiladas?"#dc3545":void 0},children:"CAJAS APILADAS:"}),a.jsx(je,{$hasError:!!c.cantidad_cajas_apiladas,type:"number",value:r.cantidad_cajas_apiladas||"",onChange:S=>P("cantidad_cajas_apiladas",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.class_substance_packed_id?"#dc3545":void 0},children:"CLASE SUSTANCIA:"}),a.jsxs(Me,{$hasError:!!c.class_substance_packed_id,value:r.class_substance_packed_id||"",onChange:S=>P("class_substance_packed_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(pp=k==null?void 0:k.class_substance_packeds)==null?void 0:pp.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.pallet_sobre_pallet?"#dc3545":void 0},children:"PALLET S/ PALLET:"}),a.jsxs(Me,{$hasError:!!c.pallet_sobre_pallet,value:r.pallet_sobre_pallet===null?"":r.pallet_sobre_pallet?"1":"0",onChange:S=>P("pallet_sobre_pallet",S.target.value===""?null:S.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.transportation_way_id?"#dc3545":void 0},children:"MEDIO TRANSPORTE:"}),a.jsxs(Me,{$hasError:!!c.transportation_way_id,value:r.transportation_way_id||"",onChange:S=>P("transportation_way_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Zu=k==null?void 0:k.transportation_ways)==null?void 0:Zu.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad?"#dc3545":void 0},children:"CANTIDAD:"}),a.jsx(je,{$hasError:!!c.cantidad,type:"number",value:r.cantidad||"",onChange:S=>P("cantidad",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ie,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.target_market_id?"#dc3545":void 0},children:"MERCADO DESTINO:"}),a.jsxs(Me,{$hasError:!!c.target_market_id,value:r.target_market_id||"",onChange:S=>P("target_market_id",S.target.value?Number(S.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(eh=k==null?void 0:k.target_markets)==null?void 0:eh.map(S=>a.jsx("option",{value:S.id,children:S.nombre},S.id))]}),a.jsx("div",{}),a.jsx("div",{})]})]})})]}),a.jsxs(Es,{style:{margin:0,minWidth:0,overflow:"hidden"},"data-has-error":!!c.observacion,children:[a.jsx(vn,{style:{background:c.observacion?"linear-gradient(135deg, #dc3545 0%, #c82333 100%)":void 0},children:"14.- Observacin del trabajo a realizar *"}),a.jsxs(yn,{style:{padding:"0.5rem",overflow:"hidden"},children:[a.jsx(Gz,{$hasError:!!c.observacion,value:r.observacion,onChange:S=>P("observacion",S.target.value),placeholder:"Observaciones adicionales (mnimo 10 caracteres)...",style:{width:"100%",height:"200px",resize:"none",fontSize:"0.75rem",boxSizing:"border-box"}}),c.observacion&&a.jsx(pt,{children:c.observacion})]})]})]}),a.jsxs(Kz,{children:[a.jsx(n$,{type:"button",onClick:re,children:"Limpiar Formulario"}),a.jsx(qz,{type:"submit",disabled:B.isPending,children:B.isPending?"Creando...":"Crear Orden de Trabajo"})]})]})]}),a.jsx(Oz,{isOpen:b,onClose:()=>{w(!1),r.numero_muestras||P("muestra",!1)},onSave:(S,at)=>{P("muestra",!0),P("numero_muestras",at),w(!1)},cadId:r.cascadeData.cartonId,cartonId:r.cascadeData.cartonId,tipoSolicitud:r.tipo_solicitud,cads:(k==null?void 0:k.cads)||[],cartones:(k==null?void 0:k.cartons)||[],cartonesMuestra:(k==null?void 0:k.cartons)||[],comunas:(k==null?void 0:k.comunas)||[]})]})}const Mv=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,l$=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,c$=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Ov=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,ud=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,hd=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,fd=p.div`
  padding: 1rem;
`,Ba=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,ft=p.div`
  display: flex;
  flex-direction: column;
`,ut=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,_n=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,As=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Jz=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Rv=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,Nn=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,Zz=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,e7=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,Iv=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}

  ${e=>e.$type==="info"&&`
    background: #cce5ff;
    color: #004085;
    border: 1px solid #b8daff;
  `}
`,t7=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,r7=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,n7=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,s7=[{id:1,nombre:"Nuevo Desarrollo"},{id:2,nombre:"Rediseno"},{id:3,nombre:"Cambio de Diseno"},{id:4,nombre:"Cambio de Material"},{id:5,nombre:"Cotizacion"},{id:6,nombre:"Muestra"},{id:7,nombre:"Otro"}];function a7({otId:e,onNavigate:t}){const[r,n]=E.useState(null),[s,i]=E.useState(null),[o,l]=E.useState(null),c=Sr(),{data:u,isLoading:h,error:f}=YP(e),{data:m,isLoading:g}=XP(),{data:v,isLoading:x}=QP(),y=E.useMemo(()=>!(v!=null&&v.subhierarchies)||!(r!=null&&r.hierarchy_id)?[]:v.subhierarchies.filter(j=>j.hierarchy_id===r.hierarchy_id),[v==null?void 0:v.subhierarchies,r==null?void 0:r.hierarchy_id]),_=E.useMemo(()=>!(v!=null&&v.subsubhierarchies)||!(r!=null&&r.subhierarchy_id)?[]:v.subsubhierarchies.filter(j=>j.subhierarchy_id===r.subhierarchy_id),[v==null?void 0:v.subsubhierarchies,r==null?void 0:r.subhierarchy_id]);E.useEffect(()=>{if(u){const j=u;n({client_id:j.client_id,descripcion:j.descripcion||"",tipo_solicitud:j.tipo_solicitud,canal_id:j.canal_id,org_venta_id:j.org_venta_id,nombre_contacto:j.nombre_contacto||"",email_contacto:j.email_contacto||"",telefono_contacto:j.telefono_contacto||"",volumen_venta_anual:j.volumen_venta_anual,codigo_producto:j.codigo_producto||"",hierarchy_id:j.hierarchy_id,subhierarchy_id:j.subhierarchy_id,subsubhierarchy_id:j.subsubhierarchy_id,ant_des_correo_cliente:j.ant_des_correo_cliente===1,ant_des_plano_actual:j.ant_des_plano_actual===1,ant_des_boceto_actual:j.ant_des_boceto_actual===1,ant_des_spec:j.ant_des_spec===1,ant_des_otro:j.ant_des_otro===1,ant_des_cj_referencia_de:j.ant_des_cj_referencia_de===1,ant_des_cj_referencia_dg:j.ant_des_cj_referencia_dg===1,ant_des_envase_primario:j.ant_des_envase_primario===1,ant_des_conservar_muestra:j.ant_des_conservar_muestra===null?null:j.ant_des_conservar_muestra===1,armado_automatico:j.armado_automatico===null?null:j.armado_automatico===1,analisis:j.analisis===1,prueba_industrial:j.prueba_industrial===1,muestra:j.muestra===1,numero_muestras:j.numero_muestras,product_type_id:j.product_type_id,impresion:j.impresion,fsc:j.fsc,cinta:j.cinta,coverage_internal_id:j.coverage_internal_id,coverage_external_id:j.coverage_external_id,carton_color:j.carton_color,carton_id:j.carton_id,interno_largo:j.interno_largo,interno_ancho:j.interno_ancho,interno_alto:j.interno_alto,externo_largo:j.externo_largo,externo_ancho:j.externo_ancho,externo_alto:j.externo_alto,process_id:j.process_id,armado_id:j.armado_id,sentido_armado:j.sentido_armado,numero_colores:j.numero_colores,color_1_id:j.color_1_id,color_2_id:j.color_2_id,color_3_id:j.color_3_id,color_4_id:j.color_4_id,color_5_id:j.color_5_id,peso_contenido_caja:j.peso_contenido_caja,envase_id:j.envase_id,autosoportante:j.autosoportante===1,cantidad:j.cantidad,observacion:j.observacion||"",planta_id:j.planta_id})}},[u]);const b=Et({mutationFn:j=>dn.update(e,j),onSuccess:j=>{i(j.message),l(null),c.invalidateQueries({queryKey:["workOrders"]}),c.invalidateQueries({queryKey:["workOrder",e]})},onError:j=>{l(j.message||"Error al actualizar la orden de trabajo"),i(null)}}),w=E.useCallback((j,T)=>{n(k=>k?{...k,[j]:T}:null)},[]),C=E.useCallback(j=>{if(j.preventDefault(),!r)return;const T={client_id:r.client_id||void 0,descripcion:r.descripcion||void 0,tipo_solicitud:r.tipo_solicitud||void 0,canal_id:r.canal_id||void 0,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,subsubhierarchy_id:r.subsubhierarchy_id||void 0,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:r.product_type_id||void 0,impresion:r.impresion||void 0,fsc:r.fsc||void 0,cinta:r.cinta||void 0,coverage_internal_id:r.coverage_internal_id||void 0,coverage_external_id:r.coverage_external_id||void 0,carton_color:r.carton_color||void 0,carton_id:r.carton_id||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.planta_id||void 0};b.mutate(T)},[r,b]);return h?a.jsx(Mv,{children:a.jsxs(t7,{children:[a.jsx(r7,{}),a.jsxs("span",{children:["Cargando OT #",e,"..."]})]})}):f?a.jsxs(Mv,{children:[a.jsxs(l$,{children:[a.jsx(c$,{children:"Error"}),a.jsx(Ov,{onClick:()=>t("dashboard"),children:" Volver al Dashboard"})]}),a.jsxs(Iv,{$type:"error",children:["No se pudo cargar la OT #",e,". ",f.message]})]}):r?a.jsxs(Mv,{children:[a.jsxs(l$,{children:[a.jsxs(c$,{children:["Editar Orden de Trabajo",a.jsxs(n7,{children:["OT #",e]})]}),a.jsx(Ov,{onClick:()=>t("dashboard"),children:" Volver al Dashboard"})]}),s&&a.jsx(Iv,{$type:"success",children:s}),o&&a.jsx(Iv,{$type:"error",children:o}),a.jsxs("form",{onSubmit:C,children:[a.jsxs(ud,{children:[a.jsx(hd,{children:"1. Datos Comerciales"}),a.jsxs(fd,{children:[a.jsxs(Ba,{$columns:3,children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Cliente"}),a.jsxs(As,{value:r.client_id||"",onChange:j=>w("client_id",j.target.value?Number(j.target.value):null),disabled:g,children:[a.jsx("option",{value:"",children:"Seleccione cliente..."}),m==null?void 0:m.clientes.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Descripcion del Producto"}),a.jsx(_n,{type:"text",maxLength:40,value:r.descripcion,onChange:j=>w("descripcion",j.target.value)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Tipo de Solicitud"}),a.jsxs(As,{value:r.tipo_solicitud||"",onChange:j=>w("tipo_solicitud",j.target.value?Number(j.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),s7.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Canal"}),a.jsxs(As,{value:r.canal_id||"",onChange:j=>w("canal_id",j.target.value?Number(j.target.value):null),disabled:g,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),m==null?void 0:m.canales.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Codigo Producto"}),a.jsx(_n,{type:"text",value:r.codigo_producto,onChange:j=>w("codigo_producto",j.target.value)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Volumen Anual"}),a.jsx(_n,{type:"number",value:r.volumen_venta_anual||"",onChange:j=>w("volumen_venta_anual",j.target.value?Number(j.target.value):null)})]})]}),a.jsxs(Ba,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Nombre Contacto"}),a.jsx(_n,{type:"text",value:r.nombre_contacto,onChange:j=>w("nombre_contacto",j.target.value)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Email Contacto"}),a.jsx(_n,{type:"email",value:r.email_contacto,onChange:j=>w("email_contacto",j.target.value)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Telefono Contacto"}),a.jsx(_n,{type:"tel",value:r.telefono_contacto,onChange:j=>w("telefono_contacto",j.target.value)})]})]}),a.jsxs(Ba,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Jerarquia 1"}),a.jsxs(As,{value:r.hierarchy_id||"",onChange:j=>w("hierarchy_id",j.target.value?Number(j.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),v==null?void 0:v.hierarchies.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Jerarquia 2"}),a.jsxs(As,{value:r.subhierarchy_id||"",onChange:j=>w("subhierarchy_id",j.target.value?Number(j.target.value):null),disabled:!r.hierarchy_id||x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),y.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Jerarquia 3"}),a.jsxs(As,{value:r.subsubhierarchy_id||"",onChange:j=>w("subsubhierarchy_id",j.target.value?Number(j.target.value):null),disabled:!r.subhierarchy_id||x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),_.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]})]})]})]}),a.jsxs(ud,{children:[a.jsx(hd,{children:"2. Antecedentes Desarrollo"}),a.jsxs(fd,{children:[a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(ut,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs(Rv,{children:[a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:j=>w("ant_des_correo_cliente",j.target.checked)}),"Correo Cliente"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:j=>w("ant_des_plano_actual",j.target.checked)}),"Plano Actual"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:j=>w("ant_des_boceto_actual",j.target.checked)}),"Boceto Actual"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:j=>w("ant_des_spec",j.target.checked)}),"Spec"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:j=>w("ant_des_otro",j.target.checked)}),"Otro"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(ut,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(Rv,{children:[a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:j=>w("ant_des_cj_referencia_de",j.target.checked)}),"CJ Referencia DE"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:j=>w("ant_des_cj_referencia_dg",j.target.checked)}),"CJ Referencia DG"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:j=>w("ant_des_envase_primario",j.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs(Ba,{$columns:3,children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(Nn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>w("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>w("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Armado Automatico"}),a.jsxs(As,{value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:j=>w("armado_automatico",j.target.value===""?null:j.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),a.jsx(ft,{})]})]})]}),a.jsxs(ud,{children:[a.jsx(hd,{children:"Solicita"}),a.jsxs(fd,{children:[a.jsxs(Rv,{children:[a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:j=>w("analisis",j.target.checked)}),"Analisis"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:j=>w("prueba_industrial",j.target.checked)}),"Prueba Industrial"]}),a.jsxs(Nn,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:j=>w("muestra",j.target.checked)}),"Muestra"]})]}),r.muestra&&a.jsx(Ba,{$columns:4,style:{marginTop:"1rem"},children:a.jsxs(ft,{children:[a.jsx(ut,{children:"Numero de Muestras"}),a.jsx(_n,{type:"number",min:"1",value:r.numero_muestras||"",onChange:j=>w("numero_muestras",j.target.value?Number(j.target.value):null)})]})})]})]}),a.jsxs(ud,{children:[a.jsx(hd,{children:"3. Medidas"}),a.jsx(fd,{children:a.jsxs(Ba,{$columns:6,children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Largo Int. (mm)"}),a.jsx(_n,{type:"number",value:r.interno_largo||"",onChange:j=>w("interno_largo",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Ancho Int. (mm)"}),a.jsx(_n,{type:"number",value:r.interno_ancho||"",onChange:j=>w("interno_ancho",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Alto Int. (mm)"}),a.jsx(_n,{type:"number",value:r.interno_alto||"",onChange:j=>w("interno_alto",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Largo Ext. (mm)"}),a.jsx(_n,{type:"number",value:r.externo_largo||"",onChange:j=>w("externo_largo",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Ancho Ext. (mm)"}),a.jsx(_n,{type:"number",value:r.externo_ancho||"",onChange:j=>w("externo_ancho",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Alto Ext. (mm)"}),a.jsx(_n,{type:"number",value:r.externo_alto||"",onChange:j=>w("externo_alto",j.target.value?Number(j.target.value):null)})]})]})})]}),a.jsxs(ud,{children:[a.jsx(hd,{children:"4. Terminaciones"}),a.jsxs(fd,{children:[a.jsxs(Ba,{$columns:3,children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Proceso"}),a.jsxs(As,{value:r.process_id||"",onChange:j=>w("process_id",j.target.value?Number(j.target.value):null),disabled:g,children:[a.jsx("option",{value:"",children:"Seleccione proceso..."}),m==null?void 0:m.procesos.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Numero de Colores"}),a.jsxs(As,{value:r.numero_colores||"",onChange:j=>w("numero_colores",j.target.value?Number(j.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5].map(j=>a.jsx("option",{value:j,children:j},j))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Planta"}),a.jsxs(As,{value:r.planta_id||"",onChange:j=>w("planta_id",j.target.value?Number(j.target.value):null),disabled:g,children:[a.jsx("option",{value:"",children:"Seleccione planta..."}),m==null?void 0:m.plantas.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]})]}),r.numero_colores&&r.numero_colores>0&&a.jsx(Ba,{$columns:5,style:{marginTop:"1rem"},children:[1,2,3,4,5].slice(0,r.numero_colores).map(j=>a.jsxs(ft,{children:[a.jsxs(ut,{children:["Color ",j]}),a.jsxs(As,{value:r[`color_${j}_id`]||"",onChange:T=>w(`color_${j}_id`,T.target.value?Number(T.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),v==null?void 0:v.colors.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]},j))})]})]}),a.jsxs(ud,{children:[a.jsx(hd,{children:"5. Datos para Desarrollo"}),a.jsxs(fd,{children:[a.jsxs(Ba,{$columns:4,children:[a.jsxs(ft,{children:[a.jsx(ut,{children:"Peso Contenido Caja (kg)"}),a.jsx(_n,{type:"number",value:r.peso_contenido_caja||"",onChange:j=>w("peso_contenido_caja",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Cantidad"}),a.jsx(_n,{type:"number",value:r.cantidad||"",onChange:j=>w("cantidad",j.target.value?Number(j.target.value):null)})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Envase"}),a.jsxs(As,{value:r.envase_id||"",onChange:j=>w("envase_id",j.target.value?Number(j.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),v==null?void 0:v.envases.map(j=>a.jsx("option",{value:j.id,children:j.nombre},j.id))]})]}),a.jsxs(ft,{children:[a.jsx(ut,{children:"Autosoportante"}),a.jsxs(Nn,{style:{marginTop:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:r.autosoportante,onChange:j=>w("autosoportante",j.target.checked)}),"Si"]})]})]}),a.jsx(Ba,{$columns:1,style:{marginTop:"1rem"},children:a.jsxs(ft,{children:[a.jsx(ut,{children:"Observacion"}),a.jsx(Jz,{value:r.observacion,onChange:j=>w("observacion",j.target.value)})]})})]})]}),a.jsxs(e7,{children:[a.jsx(Ov,{type:"button",onClick:()=>t("dashboard"),children:"Cancelar"}),a.jsx(Zz,{type:"submit",disabled:b.isPending,children:b.isPending?"Guardando...":"Guardar Cambios"})]})]})]}):null}const d$=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,i7=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,o7=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,l7=p.div`
  display: flex;
  gap: 0.5rem;
  align-items: center;
`,c7=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,u$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.primary};
  border-radius: 50px;
  background: white;
  color: ${d.colors.primary};
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 0.35rem;

  &:hover {
    background: ${d.colors.primary};
    color: white;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,d7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,h$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,f$=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,p$=p.div`
  padding: 1rem;
`,zp=p.span`
  display: inline-block;
  padding: 0.35rem 0.75rem;
  border-radius: 50px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-right: 0.5rem;

  ${e=>e.$type==="area"&&`
    background: ${d.colors.primary}15;
    color: ${d.colors.primary};
  `}

  ${e=>e.$type==="state"&&`
    background: #6c757d15;
    color: #6c757d;
  `}
`,u7=p.div`
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`,m$=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Nv=p.div`
  margin-bottom: 1rem;
`,Lv=p.label`
  display: block;
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,g$=p.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,h7=p.textarea`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,f7=p.button`
  width: 100%;
  padding: 0.75rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,p7=p.div`
  max-height: 400px;
  overflow-y: auto;
`,m7=p.div`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background: ${d.colors.bgLight};
  }
`,g7=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.25rem;
`,x7=p.div`
  display: flex;
  gap: 0.5rem;
`,v7=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
`,y7=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
`,b7=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  margin-top: 0.5rem;
  padding: 0.5rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  font-style: italic;
`,x$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,_7=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,w7=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,j7=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,k7=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,zv=p.div`
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,Bv=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin-bottom: 0.25rem;
`,Uv=p.div`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  font-weight: 500;
`;function S7({otId:e,onNavigate:t}){const[r,n]=E.useState(null),[s,i]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(null),[h,f]=E.useState(null),{data:m,isLoading:g}=YP(e),{data:v,isLoading:x}=Rz(e),{data:y,isLoading:_}=Iz(e),b=Nz(),w=E.useCallback(()=>{if(!r||!s){f("Debe seleccionar area y estado");return}const T={work_space_id:r,state_id:s,observation:o||void 0};b.mutate({id:e,data:T},{onSuccess:k=>{u(k.message),f(null),n(null),i(null),l("")},onError:k=>{f(k.message||"Error al realizar la transicion"),u(null)}})},[e,r,s,o,b]),C=T=>T?new Date(T).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";if(x||_||g)return a.jsx(d$,{children:a.jsxs(_7,{children:[a.jsx(w7,{}),a.jsxs("span",{children:["Cargando informacion de OT #",e,"..."]})]})});const j=m;return a.jsxs(d$,{children:[a.jsxs(i7,{children:[a.jsxs(o7,{children:["Gestionar Orden de Trabajo",a.jsxs(j7,{children:["OT #",e]})]}),a.jsxs(l7,{children:[a.jsx(u$,{onClick:()=>b0.downloadFichaDiseno(e),title:"Descargar Ficha de Diseo",children:"Ficha Diseo"}),a.jsx(u$,{onClick:()=>b0.downloadEstudioBench(e),title:"Descargar Solicitud Benchmarking",children:"Est. Bench"}),a.jsx(c7,{onClick:()=>t("dashboard"),children:" Volver al Dashboard"})]})]}),c&&a.jsx(x$,{$type:"success",children:c}),h&&a.jsx(x$,{$type:"error",children:h}),j&&a.jsxs(k7,{children:[a.jsxs(zv,{children:[a.jsx(Bv,{children:"Cliente"}),a.jsx(Uv,{children:j.client_name||"N/A"})]}),a.jsxs(zv,{children:[a.jsx(Bv,{children:"Descripcion"}),a.jsx(Uv,{children:j.descripcion||"N/A"})]}),a.jsxs(zv,{children:[a.jsx(Bv,{children:"Creador"}),a.jsx(Uv,{children:j.creador_nombre||"N/A"})]})]}),a.jsxs(d7,{children:[a.jsxs(h$,{children:[a.jsx(f$,{children:"Transicion de Estado"}),a.jsxs(p$,{children:[a.jsxs(u7,{children:[a.jsxs("div",{children:[a.jsx(m$,{children:"Area Actual"}),a.jsx("div",{children:a.jsx(zp,{$type:"area",children:(v==null?void 0:v.current_area)||"Sin asignar"})})]}),a.jsxs("div",{children:[a.jsx(m$,{children:"Estado Actual"}),a.jsx("div",{children:a.jsx(zp,{$type:"state",children:(v==null?void 0:v.current_state)||"Sin estado"})})]})]}),a.jsxs(Nv,{children:[a.jsx(Lv,{children:"Nueva Area"}),a.jsxs(g$,{value:r||"",onChange:T=>n(T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione area..."}),y==null?void 0:y.areas.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Nv,{children:[a.jsx(Lv,{children:"Nuevo Estado"}),a.jsxs(g$,{value:s||"",onChange:T=>i(T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione estado..."}),y==null?void 0:y.states.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Nv,{children:[a.jsx(Lv,{children:"Observacion (opcional)"}),a.jsx(h7,{value:o,onChange:T=>l(T.target.value),placeholder:"Ingrese una observacion...",maxLength:500})]}),a.jsx(f7,{onClick:w,disabled:!r||!s||b.isPending,children:b.isPending?"Procesando...":"Realizar Transicion"})]})]}),a.jsxs(h$,{children:[a.jsx(f$,{children:"Historial de Gestion"}),a.jsx(p$,{children:a.jsxs(p7,{children:[(v==null?void 0:v.history.length)===0&&a.jsx("div",{style:{textAlign:"center",padding:"2rem",color:d.colors.textSecondary},children:"No hay registros de gestion"}),v==null?void 0:v.history.map(T=>a.jsxs(m7,{children:[a.jsxs(g7,{children:[a.jsxs(x7,{children:[a.jsx(zp,{$type:"area",children:T.work_space}),a.jsx(zp,{$type:"state",children:T.state})]}),a.jsx(v7,{children:C(T.created_at)})]}),a.jsxs(y7,{children:["Por: ",T.user_name]}),T.observation&&a.jsxs(b7,{children:['"',T.observation,'"']})]},T.id))]})})]})]})]})}const Vv=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Hv=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Wv=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Gv=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,C7=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,$7=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Fs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ps=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,T7=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,v$=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,E7=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  min-width: 40px;
  text-align: center;

  ${e=>e.$days>5?`
        background: ${d.colors.danger}15;
        color: ${d.colors.danger};
      `:e.$days>2?`
        background: #ffc10715;
        color: #d9a406;
      `:`
      background: ${d.colors.success}15;
      color: ${d.colors.success};
    `}
`,qv=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,y$=p.button`
  padding: 0.35rem 0.75rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.5rem;

  ${e=>e.$variant==="success"?`
    background: ${d.colors.success};
    color: white;

    &:hover {
      background: #218838;
    }
  `:`
    background: ${d.colors.primary};
    color: white;

    &:hover {
      background: #002d66;
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,A7=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,F7=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
`,P7=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,D7=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,M7=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,b$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,O7=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,R7=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Kv=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,I7=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  font-style: italic;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function N7({onNavigate:e}){const[t,r]=E.useState(1),[n,s]=E.useState(null),[i,o]=E.useState(null),{data:l,isLoading:c,error:u}=Lz(t,20),h=zz(),f=E.useCallback(y=>{h.mutate(y,{onSuccess:()=>{s("Notificacion marcada como leida"),o(null),setTimeout(()=>s(null),3e3)},onError:_=>{o(_.message||"Error al marcar notificacion"),s(null)}})},[h]),m=E.useCallback(y=>{e("gestionar-ot",y)},[e]);if(c)return a.jsxs(Vv,{children:[a.jsxs(Hv,{children:[a.jsx(Wv,{children:"Notificaciones"}),a.jsx(Gv,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsxs(P7,{children:[a.jsx(D7,{}),a.jsx("span",{children:"Cargando notificaciones..."})]})]});if(u)return a.jsxs(Vv,{children:[a.jsxs(Hv,{children:[a.jsx(Wv,{children:"Notificaciones"}),a.jsx(Gv,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsx(Kv,{$type:"error",children:"Error al cargar notificaciones. Intente nuevamente."})]});const g=(l==null?void 0:l.items)||[],v=(l==null?void 0:l.total_pages)||1,x=(l==null?void 0:l.total)||0;return a.jsxs(Vv,{children:[a.jsxs(Hv,{children:[a.jsx(Wv,{children:"Notificaciones"}),a.jsx(Gv,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),n&&a.jsx(Kv,{$type:"success",children:n}),i&&a.jsx(Kv,{$type:"error",children:i}),a.jsxs(R7,{children:["Mostrando ",g.length," de ",x," notificaciones"]}),a.jsx(C7,{children:g.length===0?a.jsxs(A7,{children:[a.jsx(F7,{children:""}),a.jsx("p",{children:"No tienes notificaciones pendientes"})]}):a.jsxs(a.Fragment,{children:[a.jsxs($7,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Fs,{children:"OT"}),a.jsx(Fs,{children:"Dias"}),a.jsx(Fs,{children:"Cliente"}),a.jsx(Fs,{children:"Descripcion"}),a.jsx(Fs,{children:"Item"}),a.jsx(Fs,{children:"Estado"}),a.jsx(Fs,{children:"Area"}),a.jsx(Fs,{children:"Generador"}),a.jsx(Fs,{children:"Motivo"}),a.jsx(Fs,{children:"Observacion"}),a.jsx(Fs,{children:"Fecha"}),a.jsx(Fs,{children:"Acciones"})]})}),a.jsx("tbody",{children:g.map(y=>a.jsxs(T7,{children:[a.jsx(Ps,{children:a.jsxs("strong",{children:["#",y.work_order_id]})}),a.jsx(Ps,{children:a.jsx(E7,{$days:y.dias_total||0,children:y.dias_total||0})}),a.jsx(Ps,{children:a.jsx(qv,{title:y.client_name,children:y.client_name})}),a.jsx(Ps,{children:a.jsx(qv,{title:y.ot_descripcion,children:y.ot_descripcion})}),a.jsx(Ps,{children:y.item_tipo||"-"}),a.jsx(Ps,{children:a.jsx(v$,{$type:"state",children:y.estado})}),a.jsx(Ps,{children:y.area&&a.jsx(v$,{$type:"area",children:y.area})}),a.jsx(Ps,{children:y.generador_nombre}),a.jsx(Ps,{children:a.jsx(qv,{title:y.motivo,children:y.motivo})}),a.jsx(Ps,{children:y.observacion&&a.jsx(I7,{title:y.observacion,children:y.observacion})}),a.jsx(Ps,{children:y.created_at}),a.jsxs(Ps,{children:[a.jsx(y$,{$variant:"primary",onClick:()=>m(y.work_order_id),title:"Gestionar OT",children:"Gestionar"}),a.jsx(y$,{$variant:"success",onClick:()=>f(y.id),disabled:h.isPending,title:"Marcar como leida",children:"Leido"})]})]},y.id))})]}),v>1&&a.jsxs(M7,{children:[a.jsx(b$,{disabled:t===1,onClick:()=>r(y=>y-1),children:"Anterior"}),a.jsxs(O7,{children:["Pagina ",t," de ",v]}),a.jsx(b$,{disabled:t===v,onClick:()=>r(y=>y+1),children:"Siguiente"})]})]})})]})}const Xv=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Yv=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Qv=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Jv=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,_$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,L7=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,vi=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,yi=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,w$=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,j$=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Zv=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"approve":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;case"reject":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover {
            background: ${d.colors.danger};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,k$=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,S$=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,C$=p.p`
  font-size: 1rem;
  margin: 0;
`,z7=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,B7=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,ey=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,ty=p.span`
  display: block;
  max-width: 200px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,U7=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`;function V7({onNavigate:e}){const[t,r]=E.useState(1),n=20,s=Sr(),{data:i,isLoading:o,error:l}=Bt({queryKey:["pendingApproval",t],queryFn:()=>dn.getPendingApproval(t,n)}),c=Et({mutationFn:_=>dn.approve(_),onSuccess:()=>{s.invalidateQueries({queryKey:["pendingApproval"]})}}),u=Et({mutationFn:_=>dn.reject(_),onSuccess:()=>{s.invalidateQueries({queryKey:["pendingApproval"]})}}),h=E.useCallback(_=>{window.confirm(`Aprobar OT ${_}?`)&&c.mutate(_)},[c]),f=E.useCallback(_=>{window.confirm(`Rechazar OT ${_}?`)&&u.mutate(_)},[u]),m=E.useCallback(_=>{e("gestionar-ot",_)},[e]),g=_=>_?new Date(_).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(o)return a.jsxs(Xv,{children:[a.jsxs(Yv,{children:[a.jsx(Qv,{children:"OTs por Aprobar"}),a.jsx(Jv,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx(z7,{children:"Cargando..."})]});if(l)return a.jsxs(Xv,{children:[a.jsxs(Yv,{children:[a.jsx(Qv,{children:"OTs por Aprobar"}),a.jsx(Jv,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(k$,{children:[a.jsx(S$,{children:"!"}),a.jsx(C$,{children:"Error al cargar las OTs pendientes"})]})]});const v=(i==null?void 0:i.items)||[],x=(i==null?void 0:i.total_pages)||1,y=(i==null?void 0:i.total)||0;return a.jsxs(Xv,{children:[a.jsxs(Yv,{children:[a.jsxs(Qv,{children:["OTs por Aprobar (",y,")"]}),a.jsx(Jv,{onClick:()=>e("dashboard"),children:"Volver"})]}),v.length===0?a.jsx(_$,{children:a.jsxs(k$,{children:[a.jsx(S$,{children:""}),a.jsx(C$,{children:"No hay OTs pendientes de aprobacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(_$,{children:a.jsxs(L7,{children:[a.jsx("thead",{children:a.jsxs(w$,{children:[a.jsx(vi,{style:{width:"60px"},children:"OT"}),a.jsx(vi,{style:{width:"80px"},children:"Creacion"}),a.jsx(vi,{children:"Creador"}),a.jsx(vi,{children:"Cliente"}),a.jsx(vi,{children:"Descripcion"}),a.jsx(vi,{style:{width:"80px"},children:"Canal"}),a.jsx(vi,{style:{width:"80px"},children:"Item"}),a.jsx(vi,{style:{width:"60px"},children:"Estado"}),a.jsx(vi,{style:{width:"120px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:v.map(_=>a.jsxs(w$,{children:[a.jsx(yi,{children:a.jsx(j$,{children:_.id})}),a.jsx(yi,{children:g(_.created_at)}),a.jsx(yi,{children:a.jsx(ty,{title:_.creador_nombre,children:_.creador_nombre})}),a.jsx(yi,{children:a.jsx(ty,{title:_.client_name,children:_.client_name})}),a.jsx(yi,{children:a.jsx(ty,{title:_.descripcion,children:_.descripcion})}),a.jsx(yi,{children:_.canal||"-"}),a.jsx(yi,{children:_.item_tipo||"-"}),a.jsx(yi,{children:a.jsx(j$,{$type:"state",title:_.estado,children:_.estado_abrev})}),a.jsx(yi,{children:a.jsxs(U7,{children:[a.jsx(Zv,{$variant:"view",onClick:()=>m(_.id),title:"Ver OT",children:"Ver"}),a.jsx(Zv,{$variant:"approve",onClick:()=>h(_.id),disabled:c.isPending,title:"Aprobar OT",children:""}),a.jsx(Zv,{$variant:"reject",onClick:()=>f(_.id),disabled:u.isPending,title:"Rechazar OT",children:""})]})})]},_.id))})]})}),x>1&&a.jsxs(B7,{children:[a.jsx(ey,{onClick:()=>r(_=>Math.max(1,_-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,x)},(_,b)=>{const w=Math.max(1,Math.min(t-2,x-4))+b;return w>x?null:a.jsx(ey,{$active:w===t,onClick:()=>r(w),children:w},w)}),a.jsx(ey,{onClick:()=>r(_=>Math.min(x,_+1)),disabled:t===x,children:"Siguiente"})]})]})]})}const ry=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ny=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,sy=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,ay=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,H7=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 1rem;
  padding: 1rem;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,Bp=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Up=p.label`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,$$=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,T$=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,W7=p.button`
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    opacity: 0.9;
  }
`,G7=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,E$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,q7=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,ua=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,ha=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,A$=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,Vp=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,F$=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"assign":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P$=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,D$=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,M$=p.p`
  font-size: 1rem;
  margin: 0;
`,K7=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,X7=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,iy=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Hp=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,Y7=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`,Q7=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,J7=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  min-width: 400px;
  max-width: 500px;
`,Z7=p.h3`
  margin: 0 0 1rem 0;
  font-size: 1.25rem;
  color: ${d.colors.textPrimary};
`,eB=p.p`
  margin: 0 0 1rem 0;
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`,tB=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,rB=p.div`
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
`,O$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function nB({onNavigate:e}){const[t,r]=E.useState(1),[n,s]=E.useState({page:1,page_size:20}),[i,o]=E.useState({}),[l,c]=E.useState(!1),[u,h]=E.useState(null),[f,m]=E.useState(""),g=Sr(),{data:v,isLoading:x,error:y}=Bt({queryKey:["pendingAssignment",n],queryFn:()=>Fv.getPendingAssignment(n)}),{data:_}=Bt({queryKey:["professionals"],queryFn:()=>Fv.getProfessionals(),enabled:l}),b=Et({mutationFn:({otId:U,profesionalId:P})=>Fv.assign(U,P),onSuccess:()=>{g.invalidateQueries({queryKey:["pendingAssignment"]}),c(!1),h(null),m("")}}),w=E.useCallback(()=>{s({...i,page:1,page_size:20}),r(1)},[i]),C=E.useCallback(()=>{o({}),s({page:1,page_size:20}),r(1)},[]),j=E.useCallback(U=>{r(U),s(P=>({...P,page:U}))},[]),T=E.useCallback(U=>{h(U),m(""),c(!0)},[]),k=E.useCallback(()=>{u&&f!==""&&b.mutate({otId:u.id,profesionalId:f})},[u,f,b]),M=E.useCallback(U=>{e("gestionar-ot",U)},[e]),A=U=>U?new Date(U).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",O=U=>U>=7?"danger":U>=3?"warning":"info";if(x)return a.jsxs(ry,{children:[a.jsxs(ny,{children:[a.jsx(sy,{children:"Asignacion de OTs"}),a.jsx(ay,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx(K7,{children:"Cargando..."})]});if(y)return a.jsxs(ry,{children:[a.jsxs(ny,{children:[a.jsx(sy,{children:"Asignacion de OTs"}),a.jsx(ay,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(P$,{children:[a.jsx(D$,{children:"!"}),a.jsx(M$,{children:"Error al cargar las OTs pendientes de asignacion"})]})]});const F=(v==null?void 0:v.items)||[],B=(v==null?void 0:v.total_pages)||1,L=(v==null?void 0:v.total)||0;return a.jsxs(ry,{children:[a.jsxs(ny,{children:[a.jsxs(sy,{children:["Asignacion de OTs (",L,")"]}),a.jsx(ay,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(H7,{children:[a.jsxs(Bp,{children:[a.jsx(Up,{children:"Estado Asignacion"}),a.jsxs($$,{value:i.asignado??"",onChange:U=>o(P=>({...P,asignado:U.target.value===""?void 0:U.target.value})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NO",children:"Sin Asignar"}),a.jsx("option",{value:"SI",children:"Asignados"})]})]}),a.jsxs(Bp,{children:[a.jsx(Up,{children:"Tipo Solicitud"}),a.jsxs($$,{value:i.tipo_solicitud??"",onChange:U=>o(P=>({...P,tipo_solicitud:U.target.value||void 0})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NUEVO",children:"Nuevo"}),a.jsx("option",{value:"REPETICION",children:"Repeticion"}),a.jsx("option",{value:"MODIFICACION",children:"Modificacion"})]})]}),a.jsxs(Bp,{children:[a.jsx(Up,{children:"Desde"}),a.jsx(T$,{type:"date",value:i.date_desde??"",onChange:U=>o(P=>({...P,date_desde:U.target.value||void 0}))})]}),a.jsxs(Bp,{children:[a.jsx(Up,{children:"Hasta"}),a.jsx(T$,{type:"date",value:i.date_hasta??"",onChange:U=>o(P=>({...P,date_hasta:U.target.value||void 0}))})]}),a.jsx(W7,{onClick:w,children:"Filtrar"}),a.jsx(G7,{onClick:C,children:"Limpiar"})]}),F.length===0?a.jsx(E$,{children:a.jsxs(P$,{children:[a.jsx(D$,{children:""}),a.jsx(M$,{children:"No hay OTs pendientes de asignacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(E$,{children:a.jsxs(q7,{children:[a.jsx("thead",{children:a.jsxs(A$,{children:[a.jsx(ua,{style:{width:"60px"},children:"OT"}),a.jsx(ua,{style:{width:"80px"},children:"Creacion"}),a.jsx(ua,{children:"Cliente"}),a.jsx(ua,{children:"Vendedor"}),a.jsx(ua,{style:{width:"90px"},children:"Tipo"}),a.jsx(ua,{style:{width:"80px"},children:"Canal"}),a.jsx(ua,{children:"Jerarquia"}),a.jsx(ua,{style:{width:"80px"},children:"CAD"}),a.jsx(ua,{children:"Profesional"}),a.jsx(ua,{style:{width:"60px"},children:"Dias"}),a.jsx(ua,{style:{width:"100px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:F.map(U=>a.jsxs(A$,{children:[a.jsx(ha,{children:a.jsx(Vp,{children:U.id})}),a.jsx(ha,{children:A(U.created_at)}),a.jsx(ha,{children:a.jsx(Hp,{title:U.client_name,children:U.client_name})}),a.jsx(ha,{children:a.jsx(Hp,{title:U.vendedor_nombre,children:U.vendedor_nombre})}),a.jsx(ha,{children:a.jsx(Vp,{$type:"info",children:U.tipo_solicitud})}),a.jsx(ha,{children:U.canal||"-"}),a.jsx(ha,{children:a.jsx(Hp,{title:`${U.jerarquia_1||""} > ${U.jerarquia_2||""} > ${U.jerarquia_3||""}`,children:U.jerarquia_1||"-"})}),a.jsx(ha,{children:U.cad||"-"}),a.jsx(ha,{children:a.jsx(Hp,{title:U.profesional_asignado||"Sin asignar",children:U.profesional_asignado||a.jsx(Vp,{$type:"warning",children:"Sin asignar"})})}),a.jsx(ha,{children:a.jsxs(Vp,{$type:O(U.dias_sin_asignar),children:[U.dias_sin_asignar,"d"]})}),a.jsx(ha,{children:a.jsxs(Y7,{children:[a.jsx(F$,{$variant:"view",onClick:()=>M(U.id),title:"Ver OT",children:"Ver"}),!U.profesional_asignado&&a.jsx(F$,{$variant:"assign",onClick:()=>T(U),title:"Asignar Profesional",children:"Asignar"})]})})]},U.id))})]})}),B>1&&a.jsxs(X7,{children:[a.jsx(iy,{onClick:()=>j(Math.max(1,t-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,B)},(U,P)=>{const Q=Math.max(1,Math.min(t-2,B-4))+P;return Q>B?null:a.jsx(iy,{$active:Q===t,onClick:()=>j(Q),children:Q},Q)}),a.jsx(iy,{onClick:()=>j(Math.min(B,t+1)),disabled:t===B,children:"Siguiente"})]})]}),l&&u&&a.jsx(Q7,{onClick:()=>c(!1),children:a.jsxs(J7,{onClick:U=>U.stopPropagation(),children:[a.jsx(Z7,{children:"Asignar Profesional"}),a.jsxs(eB,{children:["OT #",u.id," - ",u.client_name]}),a.jsxs(tB,{value:f,onChange:U=>m(U.target.value?Number(U.target.value):""),children:[a.jsx("option",{value:"",children:"Seleccione un profesional..."}),_==null?void 0:_.map(U=>a.jsxs("option",{value:U.id,children:[U.nombre," (",U.rol,")"]},U.id))]}),a.jsxs(rB,{children:[a.jsx(O$,{onClick:()=>c(!1),children:"Cancelar"}),a.jsx(O$,{$primary:!0,onClick:k,disabled:!f||b.isPending,children:b.isPending?"Asignando...":"Asignar"})]})]})})]})}const oy=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ly=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,cy=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,sB=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,aB=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,ph=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,mh=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,gh=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,iB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,Wp=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover:not(:disabled) { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover:not(:disabled) { background: #218838; }
        `;case"disabled":return`
          background: #ccc;
          color: #666;
          border-color: #ccc;
          cursor: not-allowed;
          opacity: 0.5;
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover:not(:disabled) {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,oB=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,lB=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,Lo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,R$=p(Lo)`
  text-align: center;
  width: 100px;
`,zo=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,I$=p(zo)`
  text-align: center;
`,cB=p.tr`
  ${e=>e.$highlighted&&`
    background-color: #d1f3d1;
  `}

  &:hover {
    background: ${e=>e.$highlighted?"#c1e3c1":d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,Gp=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,qp=p.input`
  width: 16px;
  height: 16px;
  cursor: pointer;
`,dB=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,uB=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,hB=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,fB=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,N$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,pB=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,mB=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,gB=p.span`
  color: ${d.colors.textPrimary};
  font-size: 0.875rem;
`,L$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`;function xB({onNavigate:e}){const[t,r]=E.useState({page:1,page_size:20}),[n,s]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(""),[u,h]=E.useState(""),[f,m]=E.useState(""),[g,v]=E.useState({}),[x,y]=E.useState(null),{data:_,isLoading:b,error:w}=Bt({queryKey:["ots-cotizables",t],queryFn:()=>dn.list(t)}),C=E.useMemo(()=>_!=null&&_.items?_.items:[],[_==null?void 0:_.items]),j=E.useCallback(Z=>{Z.preventDefault();const W={...t,page:1};n&&(W.date_desde=n),i&&(W.date_hasta=i),l&&(W.id_ot=parseInt(l,10)),u&&(W.cad=u),f&&(W.descripcion=f),r(W),v({})},[t,n,i,l,u,f]),T=E.useCallback(()=>{s(""),o(""),c(""),h(""),m(""),r({page:1,page_size:20}),v({})},[]),k=E.useCallback((Z,W)=>{v(ce=>{const te=ce[Z]||{corrugado:!1,esquinero:!1};return{...ce,[Z]:{...te,[W]:!te[W]}}})},[]),M=E.useCallback((Z,W)=>{v(ce=>{const te={...ce};return C.forEach(D=>{var R,N;te[D.id]={...te[D.id],corrugado:Z==="corrugado"?W:((R=te[D.id])==null?void 0:R.corrugado)||!1,esquinero:Z==="esquinero"?W:((N=te[D.id])==null?void 0:N.esquinero)||!1}}),te})},[C]),A=E.useCallback(()=>{const Z=Object.entries(g).filter(([W,ce])=>ce.corrugado||ce.esquinero).map(([W,ce])=>({ot_id:parseInt(W,10),tipo_corrugado:ce.corrugado,tipo_esquinero:ce.esquinero}));Z.length!==0&&(console.log("Cotizar OTs:",Z),y(`Se generar cotizacin para ${Z.length} OT(s)`),setTimeout(()=>y(null),3e3))},[g]),O=E.useCallback(Z=>{r(W=>({...W,page:Z}))},[]),F=E.useMemo(()=>{let Z=0,W=0;return Object.values(g).forEach(ce=>{ce.corrugado&&Z++,ce.esquinero&&W++}),{corrugadoCount:Z,esquineroCount:W,total:Z+W}},[g]),B=F.total>0,L=C.length>0&&C.every(Z=>{var W;return(W=g[Z.id])==null?void 0:W.corrugado}),U=C.length>0&&C.every(Z=>{var W;return(W=g[Z.id])==null?void 0:W.esquinero}),P=Z=>Z?new Date(Z).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(b)return a.jsxs(oy,{children:[a.jsx(ly,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(cy,{children:"Lista de OT para Cotizar"}),a.jsxs(uB,{children:[a.jsx(hB,{}),a.jsx("span",{children:"Cargando OTs..."})]})]});if(w)return a.jsxs(oy,{children:[a.jsx(ly,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(cy,{children:"Lista de OT para Cotizar"}),a.jsxs(L$,{$type:"error",children:["Error al cargar OTs: ",w.message]})]});const Q=(_==null?void 0:_.total_pages)||1,re=(_==null?void 0:_.page)||1;return a.jsxs(oy,{children:[a.jsx(ly,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(cy,{children:"Lista de OT para Cotizar"}),x&&a.jsx(L$,{$type:"success",children:x}),a.jsx(sB,{children:a.jsxs("form",{onSubmit:j,children:[a.jsxs(aB,{children:[a.jsxs(ph,{children:[a.jsx(mh,{children:"Desde"}),a.jsx(gh,{type:"date",value:n,onChange:Z=>s(Z.target.value)})]}),a.jsxs(ph,{children:[a.jsx(mh,{children:"Hasta"}),a.jsx(gh,{type:"date",value:i,onChange:Z=>o(Z.target.value)})]}),a.jsxs(ph,{children:[a.jsx(mh,{children:"OT"}),a.jsx(gh,{type:"number",placeholder:"ID...",value:l,onChange:Z=>c(Z.target.value)})]}),a.jsxs(ph,{children:[a.jsx(mh,{children:"CAD"}),a.jsx(gh,{type:"text",placeholder:"CAD...",value:u,onChange:Z=>h(Z.target.value)})]}),a.jsxs(ph,{children:[a.jsx(mh,{children:"Descripcin"}),a.jsx(gh,{type:"text",placeholder:"Descripcin...",value:f,onChange:Z=>m(Z.target.value)})]})]}),a.jsxs(iB,{children:[a.jsx(Wp,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(Wp,{type:"button",onClick:T,children:"Limpiar"}),a.jsx(Wp,{type:"button",$variant:B?"success":"disabled",disabled:!B,onClick:A,children:"Cotizar"})]})]})}),B&&a.jsxs(mB,{children:[a.jsxs(gB,{children:["Seleccionados: ",F.corrugadoCount," Corrugado, ",F.esquineroCount," Esquinero"]}),a.jsx(Wp,{onClick:()=>v({}),children:"Limpiar Seleccin"})]}),a.jsx(oB,{children:C.length===0?a.jsx(dB,{children:a.jsx("p",{children:"No hay OTs disponibles para cotizar"})}):a.jsxs(a.Fragment,{children:[a.jsxs(lB,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Lo,{children:"OT"}),a.jsx(Lo,{children:"Creacin"}),a.jsx(Lo,{children:"Creador"}),a.jsx(Lo,{children:"Cliente"}),a.jsx(Lo,{children:"Descripcin"}),a.jsx(Lo,{children:"CAD"}),a.jsx(Lo,{children:"Item"}),a.jsxs(R$,{children:["Tipo Corrugado",a.jsx("br",{}),a.jsx(qp,{type:"checkbox",checked:L,onChange:Z=>M("corrugado",Z.target.checked)})]}),a.jsxs(R$,{children:["Tipo Esquinero",a.jsx("br",{}),a.jsx(qp,{type:"checkbox",checked:U,onChange:Z=>M("esquinero",Z.target.checked)})]})]})}),a.jsx("tbody",{children:C.map(Z=>{var W,ce;return a.jsxs(cB,{children:[a.jsx(zo,{children:a.jsx("strong",{children:Z.id})}),a.jsx(zo,{children:P(Z.created_at)}),a.jsx(zo,{children:a.jsx(Gp,{title:Z.creador_nombre,children:Z.creador_nombre||"-"})}),a.jsx(zo,{children:a.jsx(Gp,{title:Z.client_name,children:Z.client_name||"-"})}),a.jsx(zo,{children:a.jsx(Gp,{title:Z.descripcion,children:Z.descripcion||"-"})}),a.jsx(zo,{children:a.jsx(Gp,{title:Z.cad||"-",children:Z.cad||"-"})}),a.jsx(zo,{children:Z.item_tipo||"-"}),a.jsx(I$,{children:a.jsx(qp,{type:"checkbox",checked:((W=g[Z.id])==null?void 0:W.corrugado)||!1,onChange:()=>k(Z.id,"corrugado")})}),a.jsx(I$,{children:a.jsx(qp,{type:"checkbox",checked:((ce=g[Z.id])==null?void 0:ce.esquinero)||!1,onChange:()=>k(Z.id,"esquinero")})})]},Z.id)})})]}),Q>1&&a.jsxs(fB,{children:[a.jsx(N$,{disabled:re===1,onClick:()=>O(re-1),children:"Anterior"}),a.jsxs(pB,{children:["Pgina ",re," de ",Q]}),a.jsx(N$,{disabled:re===Q,onClick:()=>O(re+1),children:"Siguiente"})]})]})})]})}const vB=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,yB=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,bB=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,_B=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 2rem;
`,dy=p.button`
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"white"};
  border: 2px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;

  &:hover {
    border-color: ${d.colors.primary};
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
`,uy=p.div`
  font-size: 2rem;
  margin-bottom: 0.5rem;
`,hy=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`,fy=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,py=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,my=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,gy=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,xy=p.div`
  padding: 1rem;
`,z$=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,fa=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ds=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Dl=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Kp=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,wB=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,jB=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,kB=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,SB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,B$=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,CB=p.div`
  background: ${d.colors.warning}10;
  border: 1px solid ${d.colors.warning}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,$B=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,TB=[{id:"bct",label:"BCT (lbf)"},{id:"ect",label:"ECT (lb/in)"},{id:"bct_humedo",label:"BCT en Humedo (lbf)"},{id:"flat",label:"Flat Crush (lb/in)"},{id:"humedad",label:"Humedad (%)"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley"},{id:"espesor",label:"Espesor (mm)"},{id:"cera",label:"Cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley"},{id:"flexion_fondo",label:"Flexion de Fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)"},{id:"composicion_papeles",label:"Composicion Papeles"},{id:"cobb_interno",label:"Cobb Interno"},{id:"cobb_externo",label:"Cobb Externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos"},{id:"medidas",label:"Medidas"},{id:"impresion",label:"Impresion"}];function EB({onNavigate:e}){const[t,r]=E.useState(null),[n,s]=E.useState({client_id:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]}),i=E.useCallback((u,h)=>{s(f=>({...f,[u]:h}))},[]),o=E.useCallback(u=>{s(h=>({...h,ensayos_selected:h.ensayos_selected.includes(u)?h.ensayos_selected.filter(f=>f!==u):[...h.ensayos_selected,u]}))},[]),l=E.useCallback(()=>{console.log("Submit special OT:",{type:t,data:n}),alert("Funcionalidad en desarrollo. Datos en consola.")},[t,n]),c=()=>{switch(t){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return a.jsxs(vB,{children:[a.jsx(yB,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(bB,{children:"Crear OT Especial"}),a.jsx(CB,{children:a.jsx($B,{children:"Seleccione el tipo de OT especial que desea crear. Estos tipos tienen campos especificos para el analisis de productos de la competencia (Estudio Benchmarking), especificaciones tecnicas detalladas (Ficha Tecnica) o procesos de licitacion."})}),a.jsxs(_B,{children:[a.jsxs(dy,{$active:t==="estudio-bench",onClick:()=>r("estudio-bench"),children:[a.jsx(uy,{children:""}),a.jsx(hy,{children:"Estudio Benchmarking"}),a.jsx(fy,{children:"Analisis de productos de la competencia con ensayos de laboratorio"})]}),a.jsxs(dy,{$active:t==="ficha-tecnica",onClick:()=>r("ficha-tecnica"),children:[a.jsx(uy,{children:""}),a.jsx(hy,{children:"Ficha Tecnica"}),a.jsx(fy,{children:"Especificaciones tecnicas detalladas del producto"})]}),a.jsxs(dy,{$active:t==="licitacion",onClick:()=>r("licitacion"),children:[a.jsx(uy,{children:""}),a.jsx(hy,{children:"Licitacion"}),a.jsx(fy,{children:"OTs para procesos de licitacion con requerimientos especiales"})]})]}),t&&a.jsxs(a.Fragment,{children:[a.jsxs(py,{children:[a.jsx(my,{children:a.jsxs(gy,{children:["Datos Comerciales - ",c()]})}),a.jsx(xy,{children:a.jsxs(z$,{children:[a.jsxs(fa,{children:[a.jsx(Ds,{children:"Cliente *"}),a.jsx(Kp,{value:n.client_id,onChange:u=>i("client_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Descripcion *"}),a.jsx(Dl,{type:"text",value:n.descripcion,onChange:u=>i("descripcion",u.target.value),maxLength:40})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Codigo Producto"}),a.jsx(Dl,{type:"text",value:n.codigo_producto,onChange:u=>i("codigo_producto",u.target.value)})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Tipo de Solicitud"}),a.jsxs(Kp,{value:n.tipo_solicitud,onChange:u=>i("tipo_solicitud",u.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"})]})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Canal"}),a.jsx(Kp,{value:n.canal_id,onChange:u=>i("canal_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Jerarquia 1"}),a.jsx(Kp,{value:n.hierarchy_id,onChange:u=>i("hierarchy_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Nombre Contacto"}),a.jsx(Dl,{type:"text",value:n.nombre_contacto,onChange:u=>i("nombre_contacto",u.target.value)})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Email Contacto"}),a.jsx(Dl,{type:"email",value:n.email_contacto,onChange:u=>i("email_contacto",u.target.value)})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Telefono Contacto"}),a.jsx(Dl,{type:"text",value:n.telefono_contacto,onChange:u=>i("telefono_contacto",u.target.value)})]})]})})]}),t==="estudio-bench"&&a.jsxs(py,{children:[a.jsx(my,{children:a.jsx(gy,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(xy,{children:[a.jsxs(z$,{children:[a.jsxs(fa,{children:[a.jsx(Ds,{children:"Cantidad de Items"}),a.jsx(Dl,{type:"number",min:"1",value:n.cantidad_estudio_bench,onChange:u=>i("cantidad_estudio_bench",u.target.value)})]}),a.jsxs(fa,{children:[a.jsx(Ds,{children:"Fecha Maxima Entrega"}),a.jsx(Dl,{type:"date",value:n.fecha_maxima_entrega_estudio,onChange:u=>i("fecha_maxima_entrega_estudio",u.target.value)})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(Ds,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(jB,{children:TB.map(u=>a.jsxs(kB,{children:[a.jsx("input",{type:"checkbox",checked:n.ensayos_selected.includes(u.id),onChange:()=>o(u.id)}),u.label]},u.id))})]})]})]}),a.jsxs(py,{children:[a.jsx(my,{children:a.jsx(gy,{children:"Observaciones"})}),a.jsx(xy,{children:a.jsx(wB,{value:n.observacion,onChange:u=>i("observacion",u.target.value),placeholder:"Ingrese observaciones adicionales..."})})]}),a.jsxs(SB,{children:[a.jsx(B$,{onClick:()=>e("dashboard"),children:"Cancelar"}),a.jsx(B$,{$variant:"success",onClick:l,children:"Guardar OT"})]})]})]})}const vy=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,U$=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,AB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`,FB=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,PB=p.span`
  background: ${d.colors.primary};
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.9rem;
  font-weight: 600;
`,DB=p.span`
  background: ${({$type:e})=>{switch(e){case"estudio-bench":return`${d.colors.info}20`;case"ficha-tecnica":return`${d.colors.success}20`;case"licitacion":return`${d.colors.warning}20`;default:return`${d.colors.textSecondary}20`}}};
  color: ${({$type:e})=>{switch(e){case"estudio-bench":return d.colors.info;case"ficha-tecnica":return d.colors.success;case"licitacion":return d.colors.warning;default:return d.colors.textSecondary}}};
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,xh=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,vh=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,yh=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,bh=p.div`
  padding: 1rem;
`,Xp=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,as=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ln=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Ms=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,MB=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,OB=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,RB=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,IB=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,NB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,yy=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,LB=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  color: ${d.colors.textSecondary};
  font-size: 1rem;
`,V$=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}30;
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;
  color: ${d.colors.danger};
`,zB=p.div`
  background: ${d.colors.success}15;
  border: 1px solid ${d.colors.success}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
  color: ${d.colors.success};
  text-align: center;
`,by=[{id:"bct",label:"BCT (lbf)",field:"ensayo_bct"},{id:"ect",label:"ECT (lb/in)",field:"ensayo_ect"},{id:"bct_humedo",label:"BCT en Humedo (lbf)",field:"ensayo_bct_humedo"},{id:"flat",label:"Flat Crush (lb/in)",field:"ensayo_flat"},{id:"humedad",label:"Humedad (%)",field:"ensayo_humedad"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley",field:"ensayo_porosidad_ext"},{id:"espesor",label:"Espesor (mm)",field:"ensayo_espesor"},{id:"cera",label:"Cera",field:"ensayo_cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley",field:"ensayo_porosidad_int"},{id:"flexion_fondo",label:"Flexion de Fondo",field:"ensayo_flexion_fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)",field:"ensayo_gramaje"},{id:"composicion_papeles",label:"Composicion Papeles",field:"ensayo_composicion_papeles"},{id:"cobb_interno",label:"Cobb Interno",field:"ensayo_cobb_interno"},{id:"cobb_externo",label:"Cobb Externo",field:"ensayo_cobb_externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos",field:"ensayo_flexion_4_puntos"},{id:"medidas",label:"Medidas",field:"ensayo_medidas"},{id:"impresion",label:"Impresion",field:"ensayo_impresion"}];function BB({otId:e,onNavigate:t}){const[r,n]=E.useState(!0),[s,i]=E.useState(!1),[o,l]=E.useState(null),[c,u]=E.useState(null),[h,f]=E.useState(null),[m,g]=E.useState({client_id:"",client_name:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]});E.useEffect(()=>{(async()=>{try{n(!0),l(null);const w=await dn.get(e),C=w.tipo_solicitud;let j=null;C===7||w.is_estudio_bench?j="estudio-bench":C===8||w.is_ficha_tecnica?j="ficha-tecnica":(C===9||w.is_licitacion)&&(j="licitacion"),f(j);const T=[];by.forEach(k=>{(w[k.field]===1||w[k.field]===!0)&&T.push(k.id)}),g({client_id:String(w.client_id||""),client_name:String(w.client_name||""),descripcion:String(w.descripcion||""),codigo_producto:String(w.codigo_producto||""),tipo_solicitud:String(w.tipo_solicitud||""),canal_id:String(w.canal_id||""),hierarchy_id:String(w.hierarchy_id||""),subhierarchy_id:String(w.subhierarchy_id||""),subsubhierarchy_id:String(w.subsubhierarchy_id||""),nombre_contacto:String(w.nombre_contacto||""),email_contacto:String(w.email_contacto||""),telefono_contacto:String(w.telefono_contacto||""),observacion:String(w.observacion||""),cantidad_estudio_bench:String(w.cantidad_estudio_bench||w.cantidad||""),fecha_maxima_entrega_estudio:String(w.fecha_maxima_entrega||""),ensayos_selected:T})}catch(w){console.error("Error loading OT:",w),l("Error al cargar los datos de la OT")}finally{n(!1)}})()},[e]);const v=E.useCallback((b,w)=>{g(C=>({...C,[b]:w})),u(null)},[]),x=E.useCallback(b=>{g(w=>({...w,ensayos_selected:w.ensayos_selected.includes(b)?w.ensayos_selected.filter(C=>C!==b):[...w.ensayos_selected,b]})),u(null)},[]),y=E.useCallback(async()=>{try{i(!0),l(null),u(null);const b={descripcion:m.descripcion,codigo_producto:m.codigo_producto||null,nombre_contacto:m.nombre_contacto||null,email_contacto:m.email_contacto||null,telefono_contacto:m.telefono_contacto||null,observacion:m.observacion||null};h==="estudio-bench"&&(b.cantidad=m.cantidad_estudio_bench?parseInt(m.cantidad_estudio_bench):null,b.fecha_maxima_entrega=m.fecha_maxima_entrega_estudio||null,by.forEach(w=>{b[w.field]=m.ensayos_selected.includes(w.id)?1:0})),await dn.update(e,b),u("OT actualizada correctamente"),window.scrollTo({top:0,behavior:"smooth"})}catch(b){console.error("Error updating OT:",b),l("Error al guardar los cambios")}finally{i(!1)}},[e,h,m]),_=()=>{switch(h){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return r?a.jsx(vy,{children:a.jsx(LB,{children:"Cargando datos de la OT..."})}):o&&!m.client_id?a.jsxs(vy,{children:[a.jsx(U$,{onClick:()=>t("dashboard"),children:" Volver"}),a.jsxs(V$,{children:[a.jsx("p",{children:o}),a.jsx(yy,{$variant:"primary",onClick:()=>t("dashboard"),style:{marginTop:"1rem"},children:"Volver al Dashboard"})]})]}):a.jsxs(vy,{children:[a.jsx(U$,{onClick:()=>t("work-order-detail",e),children:" Volver al Detalle"}),a.jsx(AB,{children:a.jsx("div",{children:a.jsxs(FB,{children:["Editar OT",a.jsxs(PB,{style:{marginLeft:"0.75rem"},children:["#",e]}),h&&a.jsx(DB,{$type:h,children:_()})]})})}),c&&a.jsx(zB,{children:c}),o&&a.jsx(V$,{style:{marginBottom:"1rem"},children:o}),a.jsxs(xh,{children:[a.jsx(vh,{children:a.jsx(yh,{children:"Datos Comerciales"})}),a.jsx(bh,{children:a.jsxs(Xp,{children:[a.jsxs(as,{children:[a.jsx(Ln,{children:"Cliente"}),a.jsx(Ms,{type:"text",value:m.client_name,disabled:!0,style:{background:d.colors.bgLight}})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Descripcion *"}),a.jsx(Ms,{type:"text",value:m.descripcion,onChange:b=>v("descripcion",b.target.value),maxLength:40,disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Codigo Producto"}),a.jsx(Ms,{type:"text",value:m.codigo_producto,onChange:b=>v("codigo_producto",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Tipo de Solicitud"}),a.jsxs(MB,{value:m.tipo_solicitud,disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"}),a.jsx("option",{value:"7",children:"Estudio Benchmarking"}),a.jsx("option",{value:"8",children:"Ficha Tecnica"}),a.jsx("option",{value:"9",children:"Licitacion"})]})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Nombre Contacto"}),a.jsx(Ms,{type:"text",value:m.nombre_contacto,onChange:b=>v("nombre_contacto",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Email Contacto"}),a.jsx(Ms,{type:"email",value:m.email_contacto,onChange:b=>v("email_contacto",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Telefono Contacto"}),a.jsx(Ms,{type:"text",value:m.telefono_contacto,onChange:b=>v("telefono_contacto",b.target.value),disabled:s})]})]})})]}),h==="estudio-bench"&&a.jsxs(xh,{children:[a.jsx(vh,{children:a.jsx(yh,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(bh,{children:[a.jsxs(Xp,{children:[a.jsxs(as,{children:[a.jsx(Ln,{children:"Cantidad de Items"}),a.jsx(Ms,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:b=>v("cantidad_estudio_bench",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Fecha Maxima Entrega"}),a.jsx(Ms,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:b=>v("fecha_maxima_entrega_estudio",b.target.value),disabled:s})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(Ln,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(RB,{children:by.map(b=>a.jsxs(IB,{children:[a.jsx("input",{type:"checkbox",checked:m.ensayos_selected.includes(b.id),onChange:()=>x(b.id),disabled:s}),b.label]},b.id))})]})]})]}),h==="ficha-tecnica"&&a.jsxs(xh,{children:[a.jsx(vh,{children:a.jsx(yh,{children:"Datos de Ficha Tecnica"})}),a.jsx(bh,{children:a.jsxs(Xp,{children:[a.jsxs(as,{children:[a.jsx(Ln,{children:"Cantidad"}),a.jsx(Ms,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:b=>v("cantidad_estudio_bench",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Fecha Maxima Entrega"}),a.jsx(Ms,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:b=>v("fecha_maxima_entrega_estudio",b.target.value),disabled:s})]})]})})]}),h==="licitacion"&&a.jsxs(xh,{children:[a.jsx(vh,{children:a.jsx(yh,{children:"Datos de Licitacion"})}),a.jsx(bh,{children:a.jsxs(Xp,{children:[a.jsxs(as,{children:[a.jsx(Ln,{children:"Cantidad"}),a.jsx(Ms,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:b=>v("cantidad_estudio_bench",b.target.value),disabled:s})]}),a.jsxs(as,{children:[a.jsx(Ln,{children:"Fecha Maxima Entrega"}),a.jsx(Ms,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:b=>v("fecha_maxima_entrega_estudio",b.target.value),disabled:s})]})]})})]}),a.jsxs(xh,{children:[a.jsx(vh,{children:a.jsx(yh,{children:"Observaciones"})}),a.jsx(bh,{children:a.jsx(OB,{value:m.observacion,onChange:b=>v("observacion",b.target.value),placeholder:"Ingrese observaciones adicionales...",disabled:s})})]}),a.jsxs(NB,{children:[a.jsx(yy,{onClick:()=>t("work-order-detail",e),disabled:s,children:"Cancelar"}),a.jsx(yy,{$variant:"success",onClick:y,disabled:s,children:s?"Guardando...":"Guardar Cambios"})]})]})}const UB=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,VB=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,HB=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,WB=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,GB=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,_h=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,wh=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,_y=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,H$=p.select`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,qB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,wy=p.button`
  padding: 0.4rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"outline":return`
          background: transparent;
          border: 1px solid ${d.colors.primary};
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}10; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,KB=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,XB=p.table`
  width: 100%;
  border-collapse: collapse;
`,fo=p.th`
  padding: 0.75rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`,po=p.td`
  padding: 0.75rem;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: top;
`,W$=p.span`
  display: inline-block;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$type:e})=>e==="old"?`${d.colors.danger}10`:`${d.colors.success}10`};
  color: ${({$type:e})=>e==="old"?d.colors.danger:d.colors.success};
`,jy=p.span`
  color: ${d.colors.textSecondary};
  font-style: italic;
  font-size: 0.75rem;
`,YB=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,QB=p.div`
  width: 24px;
  height: 24px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,JB=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,ZB=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,ky=p.button`
  padding: 0.4rem 0.75rem;
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.8rem;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,e9=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${({$type:e})=>{switch(e){case"Modificacin":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"Insercion":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"Eliminacion":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary};`}}}
`,t9=[{id:1,work_order_id:1234,created_at:"2025-12-20 10:30:00",observacion:"Actualizacion de datos comerciales",operacion:"Modificacin",user_data:{nombre:"Juan",apellido:"Perez"},datos_modificados:[{texto:"Cliente",antiguo_valor:{descripcion:"Cliente Antiguo"},nuevo_valor:{descripcion:"Cliente Nuevo"}},{texto:"Descripcion",antiguo_valor:{descripcion:"Desc 1"},nuevo_valor:{descripcion:"Desc Actualizada"}}]},{id:2,work_order_id:1234,created_at:"2025-12-19 15:45:00",observacion:"Cambio de estado",operacion:"Modificacin",user_data:{nombre:"Maria",apellido:"Garcia"},datos_modificados:[{texto:"Estado",antiguo_valor:{descripcion:"En Proceso"},nuevo_valor:{descripcion:"Completado"}}]},{id:3,work_order_id:1234,created_at:"2025-12-18 09:00:00",observacion:"Creacion de OT",operacion:"Insercion",user_data:{nombre:"Pedro",apellido:"Lopez"},datos_modificados:[{texto:"OT Creada",valor:{descripcion:"Nueva OT #1234"}}]}];function r9({otId:e,onNavigate:t}){const[r,n]=E.useState(""),[s,i]=E.useState(""),[o,l]=E.useState(""),[c,u]=E.useState(""),[h,f]=E.useState(""),[m,g]=E.useState(1),{data:v,isLoading:x}=Bt({queryKey:["ot-log",e,r,s,o,c,h,m],queryFn:async()=>(await new Promise(j=>setTimeout(j,500)),t9)}),y=E.useCallback(j=>{j.preventDefault(),g(1)},[]),_=E.useCallback(()=>{n(""),i(""),l(""),u(""),f(""),g(1)},[]),b=E.useCallback(()=>{console.log("Exporting log for OT:",e),alert("Exportacion en desarrollo")},[e]),w=E.useMemo(()=>v?v.flatMap(j=>j.datos_modificados.map((T,k)=>{var M,A,O;return{...j,modIndex:k,campo:T.texto,valorAntiguo:j.operacion==="Modificacin"?((M=T.antiguo_valor)==null?void 0:M.descripcion)||"":"N/A",valorNuevo:j.operacion==="Modificacin"?((A=T.nuevo_valor)==null?void 0:A.descripcion)||"":((O=T.valor)==null?void 0:O.descripcion)||""}})):[],[v]),C=j=>j?new Date(j).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return a.jsxs(UB,{children:[a.jsxs(VB,{onClick:()=>t("gestionar-ot",e),children:[" Volver a OT #",e]}),a.jsxs(HB,{children:["Historial de Cambios - OT #",e]}),a.jsx(WB,{children:a.jsxs("form",{onSubmit:y,children:[a.jsxs(GB,{children:[a.jsxs(_h,{children:[a.jsx(wh,{children:"Desde"}),a.jsx(_y,{type:"date",value:r,onChange:j=>n(j.target.value)})]}),a.jsxs(_h,{children:[a.jsx(wh,{children:"Hasta"}),a.jsx(_y,{type:"date",value:s,onChange:j=>i(j.target.value)})]}),a.jsxs(_h,{children:[a.jsx(wh,{children:"ID Cambio"}),a.jsx(_y,{type:"number",placeholder:"ID...",value:o,onChange:j=>l(j.target.value)})]}),a.jsxs(_h,{children:[a.jsx(wh,{children:"Campo Modificado"}),a.jsxs(H$,{value:c,onChange:j=>u(j.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"cliente",children:"Cliente"}),a.jsx("option",{value:"descripcion",children:"Descripcion"}),a.jsx("option",{value:"estado",children:"Estado"}),a.jsx("option",{value:"area",children:"Area"})]})]}),a.jsxs(_h,{children:[a.jsx(wh,{children:"Usuario"}),a.jsx(H$,{value:h,onChange:j=>f(j.target.value),children:a.jsx("option",{value:"",children:"Todos"})})]})]}),a.jsxs(qB,{children:[a.jsx(wy,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(wy,{type:"button",onClick:_,children:"Limpiar"}),a.jsx(wy,{type:"button",$variant:"outline",onClick:b,children:"Exportar"})]})]})}),a.jsx(KB,{children:x?a.jsxs(YB,{children:[a.jsx(QB,{}),a.jsx("span",{children:"Cargando historial..."})]}):w.length===0?a.jsx(JB,{children:a.jsx("p",{children:"No hay registros de cambios para esta OT"})}):a.jsxs(a.Fragment,{children:[a.jsxs(XB,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(fo,{style:{width:"8%"},children:"OT"}),a.jsx(fo,{style:{width:"8%"},children:"ID Cambio"}),a.jsx(fo,{style:{width:"12%"},children:"Fecha"}),a.jsx(fo,{style:{width:"15%"},children:"Descripcion"}),a.jsx(fo,{style:{width:"12%"},children:"Campo"}),a.jsx(fo,{style:{width:"15%"},children:"Valor Antiguo"}),a.jsx(fo,{style:{width:"15%"},children:"Valor Nuevo"}),a.jsx(fo,{style:{width:"15%"},children:"Usuario"})]})}),a.jsx("tbody",{children:w.map(j=>a.jsxs("tr",{children:[a.jsx(po,{children:j.work_order_id}),a.jsx(po,{children:j.id}),a.jsx(po,{children:C(j.created_at)}),a.jsxs(po,{children:[a.jsx(e9,{$type:j.operacion,children:j.operacion}),a.jsx("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem"},children:j.observacion})]}),a.jsx(po,{children:j.campo}),a.jsx(po,{children:j.valorAntiguo==="N/A"?a.jsx(jy,{children:"N/A"}):j.valorAntiguo?a.jsx(W$,{$type:"old",children:j.valorAntiguo}):a.jsx(jy,{children:"Campo Vacio"})}),a.jsx(po,{children:j.valorNuevo?a.jsx(W$,{$type:"new",children:j.valorNuevo}):a.jsx(jy,{children:"Campo Vacio"})}),a.jsxs(po,{children:[j.user_data.nombre," ",j.user_data.apellido]})]},`${j.id}-${j.modIndex}`))})]}),a.jsxs(ZB,{children:[a.jsx(ky,{disabled:m===1,onClick:()=>g(j=>j-1),children:"Anterior"}),a.jsx(ky,{$active:!0,children:m}),a.jsx(ky,{onClick:()=>g(j=>j+1),children:"Siguiente"})]})]})})]})}function n9(e={}){return Bt({queryKey:["clients",e],queryFn:()=>Hu.list(e)})}function s9(){return Bt({queryKey:["clasificaciones"],queryFn:()=>Hu.getClasificaciones(),staleTime:1e3*60*10})}function a9(){const e=Sr();return Et({mutationFn:t=>Hu.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]})}})}function i9(){const e=Sr();return Et({mutationFn:({id:t,data:r})=>Hu.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r.id]})}})}function o9(){const e=Sr();return Et({mutationFn:t=>Hu.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function l9(){const e=Sr();return Et({mutationFn:t=>Hu.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function c9(e={}){return Bt({queryKey:["users",e],queryFn:()=>ed.list(e)})}function d9(){return Bt({queryKey:["roles"],queryFn:()=>ed.getRoles(),staleTime:1e3*60*10})}function u9(){return Bt({queryKey:["workspaces"],queryFn:()=>ed.getWorkSpaces(),staleTime:1e3*60*10})}function h9(){const e=Sr();return Et({mutationFn:t=>ed.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}function f9(){const e=Sr();return Et({mutationFn:({id:t,data:r})=>ed.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r.id]})}})}function p9(){const e=Sr();return Et({mutationFn:t=>ed.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}function m9(){const e=Sr();return Et({mutationFn:t=>ed.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}const g9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,x9=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,v9=p.div`
  padding: 1.5rem;
`,y9=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,pa=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,ma=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,G$=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,Ua=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,b9=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,_9=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,q$=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Sy=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,w9=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`;function j9(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let s=0,i=2;for(let c=n.length-1;c>=0;c--)s+=parseInt(n[c])*i,i=i<7?i+1:2;const o=11-s%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function k9(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function S9({client:e,clasificaciones:t,onSubmit:r,onCancel:n,isLoading:s}){const i=!!e,[o,l]=E.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",razon_social:(e==null?void 0:e.razon_social)||"",giro:(e==null?void 0:e.giro)||"",direccion:(e==null?void 0:e.direccion)||"",comuna:(e==null?void 0:e.comuna)||"",ciudad:(e==null?void 0:e.ciudad)||"",telefono:(e==null?void 0:e.telefono)||"",email:(e==null?void 0:e.email)||"",contacto:(e==null?void 0:e.contacto)||"",clasificacion_id:(e==null?void 0:e.clasificacion_id)||null}),[c,u]=E.useState({}),[h,f]=E.useState({});E.useEffect(()=>{e&&l({rut:e.rut||"",nombre:e.nombre||"",razon_social:e.razon_social||"",giro:e.giro||"",direccion:e.direccion||"",comuna:e.comuna||"",ciudad:e.ciudad||"",telefono:e.telefono||"",email:e.email||"",contacto:e.contacto||"",clasificacion_id:e.clasificacion_id||null})},[e]);const m=E.useCallback((y,_)=>{switch(y){case"rut":return _?j9(_)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return _?_.length<3?"Nombre debe tener al menos 3 caracteres":void 0:"Nombre es requerido";case"email":return _&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_)?"Email invalido":void 0;default:return}},[]),g=E.useCallback(y=>{const{name:_,value:b}=y.target,w=_==="rut"?k9(b):b;if(l(C=>({...C,[_]:_==="clasificacion_id"?b?Number(b):null:w})),h[_]){const C=m(_,w);u(j=>({...j,[_]:C}))}},[h,m]),v=E.useCallback(y=>{const{name:_,value:b}=y.target;f(C=>({...C,[_]:!0}));const w=m(_,b);u(C=>({...C,[_]:w}))},[m]),x=E.useCallback(y=>{y.preventDefault();const _={};if(_.rut=m("rut",o.rut),_.nombre=m("nombre",o.nombre),_.email=m("email",o.email),u(_),f({rut:!0,nombre:!0,email:!0}),Object.values(_).some(w=>w))return;const b={nombre:o.nombre,razon_social:o.razon_social||void 0,giro:o.giro||void 0,direccion:o.direccion||void 0,comuna:o.comuna||void 0,ciudad:o.ciudad||void 0,telefono:o.telefono||void 0,email:o.email||void 0,contacto:o.contacto||void 0,clasificacion_id:o.clasificacion_id||void 0};i||(b.rut=o.rut),r(b)},[o,m,i,r]);return a.jsxs(g9,{children:[a.jsx(x9,{children:i?`Editando Cliente: ${e==null?void 0:e.nombre}`:"Nuevo Cliente"}),a.jsx(v9,{children:a.jsxs("form",{onSubmit:x,children:[a.jsxs(y9,{children:[a.jsxs(pa,{children:[a.jsxs(ma,{children:["RUT",a.jsx(G$,{children:"*"})]}),a.jsx(Ua,{type:"text",name:"rut",value:o.rut,onChange:g,onBlur:v,placeholder:"12.345.678-9",disabled:i,maxLength:12}),c.rut&&h.rut&&a.jsx(Sy,{children:c.rut}),a.jsx(w9,{children:"Formato: 12.345.678-9"})]}),a.jsxs(pa,{children:[a.jsxs(ma,{children:["Nombre",a.jsx(G$,{children:"*"})]}),a.jsx(Ua,{type:"text",name:"nombre",value:o.nombre,onChange:g,onBlur:v,placeholder:"Nombre del cliente",maxLength:255}),c.nombre&&h.nombre&&a.jsx(Sy,{children:c.nombre})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Razon Social"}),a.jsx(Ua,{type:"text",name:"razon_social",value:o.razon_social,onChange:g,placeholder:"Razon social",maxLength:255})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Giro"}),a.jsx(Ua,{type:"text",name:"giro",value:o.giro,onChange:g,placeholder:"Giro comercial",maxLength:255})]}),a.jsxs(pa,{$fullWidth:!0,children:[a.jsx(ma,{children:"Direccion"}),a.jsx(Ua,{type:"text",name:"direccion",value:o.direccion,onChange:g,placeholder:"Direccion",maxLength:255})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Comuna"}),a.jsx(Ua,{type:"text",name:"comuna",value:o.comuna,onChange:g,placeholder:"Comuna",maxLength:100})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Ciudad"}),a.jsx(Ua,{type:"text",name:"ciudad",value:o.ciudad,onChange:g,placeholder:"Ciudad",maxLength:100})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Telefono"}),a.jsx(Ua,{type:"text",name:"telefono",value:o.telefono,onChange:g,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Email"}),a.jsx(Ua,{type:"email",name:"email",value:o.email,onChange:g,onBlur:v,placeholder:"correo@ejemplo.com",maxLength:100}),c.email&&h.email&&a.jsx(Sy,{children:c.email})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Contacto"}),a.jsx(Ua,{type:"text",name:"contacto",value:o.contacto,onChange:g,placeholder:"Nombre del contacto",maxLength:255})]}),a.jsxs(pa,{children:[a.jsx(ma,{children:"Clasificacion"}),a.jsxs(b9,{name:"clasificacion_id",value:o.clasificacion_id||"",onChange:g,children:[a.jsx("option",{value:"",children:"Sin clasificacion"}),t.map(y=>a.jsx("option",{value:y.id,children:y.nombre},y.id))]})]})]}),a.jsxs(_9,{children:[a.jsx(q$,{type:"button",onClick:n,disabled:s,children:"Cancelar"}),a.jsx(q$,{type:"submit",$variant:"primary",disabled:s,children:s?"Guardando...":i?"Actualizar":"Crear"})]})]})})]})}const Yp=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Qp=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Jp=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Zp=p.div`
  display: flex;
  gap: 0.75rem;
`,Ml=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,C9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,$9=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  align-items: end;
`,em=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,tm=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,T9=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,K$=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,E9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,A9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,mo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,go=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,F9=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,X$=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Cy=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,D9=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,M9=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,O9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,Y$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,R9=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,I9=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,$y=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Q$=p.span`
  display: block;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function N9({onNavigate:e}){const[t,r]=E.useState(1),[n,s]=E.useState(""),[i,o]=E.useState(null),[l,c]=E.useState(void 0),[u,h]=E.useState(!1),[f,m]=E.useState(null),[g,v]=E.useState(null),[x,y]=E.useState(null),_={page:t,page_size:20,search:n||void 0,clasificacion_id:i||void 0,activo:l},{data:b,isLoading:w,error:C}=n9(_),{data:j}=s9(),T=a9(),k=i9(),M=o9(),A=l9(),O=E.useCallback(te=>{te.preventDefault(),r(1)},[]),F=E.useCallback(()=>{s(""),o(null),c(void 0),r(1)},[]),B=E.useCallback(()=>{m(null),h(!0)},[]),L=E.useCallback(te=>{m(te),h(!0)},[]),U=E.useCallback(()=>{h(!1),m(null)},[]),P=E.useCallback(async te=>{try{f?(await k.mutateAsync({id:f.id,data:te}),v("Cliente actualizado correctamente")):(await T.mutateAsync(te),v("Cliente creado correctamente")),h(!1),m(null),y(null),setTimeout(()=>v(null),3e3)}catch(D){y(D.message||"Error al guardar cliente"),v(null)}},[f,T,k]),Q=E.useCallback(async te=>{try{await M.mutateAsync(te),v("Cliente activado correctamente"),y(null),setTimeout(()=>v(null),3e3)}catch(D){y(D.message||"Error al activar cliente")}},[M]),re=E.useCallback(async te=>{if(window.confirm("Est seguro de desactivar este cliente?"))try{await A.mutateAsync(te),v("Cliente desactivado correctamente"),y(null),setTimeout(()=>v(null),3e3)}catch(D){y(D.message||"Error al desactivar cliente")}},[A]);if(w)return a.jsxs(Yp,{children:[a.jsxs(Qp,{children:[a.jsx(Jp,{children:"Mantenedor de Clientes"}),a.jsx(Zp,{children:a.jsx(Ml,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(D9,{children:[a.jsx(M9,{}),a.jsx("span",{children:"Cargando clientes..."})]})]});if(C)return a.jsxs(Yp,{children:[a.jsxs(Qp,{children:[a.jsx(Jp,{children:"Mantenedor de Clientes"}),a.jsx(Zp,{children:a.jsx(Ml,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx($y,{$type:"error",children:"Error al cargar clientes. Intente nuevamente."})]});const Z=(b==null?void 0:b.items)||[],W=(b==null?void 0:b.total_pages)||1,ce=(b==null?void 0:b.total)||0;return u?a.jsxs(Yp,{children:[a.jsxs(Qp,{children:[a.jsx(Jp,{children:f?"Editar Cliente":"Nuevo Cliente"}),a.jsx(Zp,{children:a.jsx(Ml,{onClick:U,children:" Cancelar"})})]}),a.jsx(S9,{client:f,clasificaciones:j||[],onSubmit:P,onCancel:U,isLoading:T.isPending||k.isPending})]}):a.jsxs(Yp,{children:[a.jsxs(Qp,{children:[a.jsx(Jp,{children:"Mantenedor de Clientes"}),a.jsxs(Zp,{children:[a.jsx(Ml,{$variant:"primary",onClick:B,children:"+ Nuevo Cliente"}),a.jsx(Ml,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),g&&a.jsx($y,{$type:"success",children:g}),x&&a.jsx($y,{$type:"error",children:x}),a.jsx(C9,{children:a.jsx("form",{onSubmit:O,children:a.jsxs($9,{children:[a.jsxs(em,{children:[a.jsx(tm,{children:"Buscar"}),a.jsx(T9,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:te=>s(te.target.value)})]}),a.jsxs(em,{children:[a.jsx(tm,{children:"Clasificacion"}),a.jsxs(K$,{value:i||"",onChange:te=>o(te.target.value?Number(te.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),j==null?void 0:j.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]}),a.jsxs(em,{children:[a.jsx(tm,{children:"Estado"}),a.jsxs(K$,{value:l===void 0?"":l?"true":"false",onChange:te=>c(te.target.value===""?void 0:te.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(em,{children:[a.jsx(tm,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Ml,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(Ml,{type:"button",onClick:F,children:"Limpiar"})]})]})]})})}),a.jsxs(I9,{children:["Mostrando ",Z.length," de ",ce," clientes"]}),a.jsx(E9,{children:Z.length===0?a.jsx(P9,{children:a.jsx("p",{children:"No se encontraron clientes"})}):a.jsxs(a.Fragment,{children:[a.jsxs(A9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(mo,{children:"ID"}),a.jsx(mo,{children:"RUT"}),a.jsx(mo,{children:"Nombre"}),a.jsx(mo,{children:"Clasificacion"}),a.jsx(mo,{children:"Email"}),a.jsx(mo,{children:"Telefono"}),a.jsx(mo,{children:"Estado"}),a.jsx(mo,{children:"Acciones"})]})}),a.jsx("tbody",{children:Z.map(te=>a.jsxs(F9,{children:[a.jsx(go,{children:te.id}),a.jsx(go,{children:te.rut}),a.jsx(go,{children:a.jsx(Q$,{title:te.nombre,children:te.nombre})}),a.jsx(go,{children:te.clasificacion&&a.jsx(X$,{$type:"info",children:te.clasificacion})}),a.jsx(go,{children:a.jsx(Q$,{title:te.email||"",children:te.email||"-"})}),a.jsx(go,{children:te.telefono||"-"}),a.jsx(go,{children:a.jsx(X$,{$type:te.activo?"active":"inactive",children:te.activo?"Activo":"Inactivo"})}),a.jsxs(go,{children:[a.jsx(Cy,{$variant:"edit",onClick:()=>L(te),title:"Editar",children:"Editar"}),te.activo?a.jsx(Cy,{$variant:"deactivate",onClick:()=>re(te.id),disabled:A.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(Cy,{$variant:"activate",onClick:()=>Q(te.id),disabled:M.isPending,title:"Activar",children:"Activar"})]})]},te.id))})]}),W>1&&a.jsxs(O9,{children:[a.jsx(Y$,{disabled:t===1,onClick:()=>r(te=>te-1),children:"Anterior"}),a.jsxs(R9,{children:["Pagina ",t," de ",W]}),a.jsx(Y$,{disabled:t===W,onClick:()=>r(te=>te+1),children:"Siguiente"})]})]})})]})}const L9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,z9=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,B9=p.div`
  padding: 1.5rem;
`,U9=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,xo=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,vo=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,rm=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,pd=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,J$=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,V9=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,Z$=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,jh=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,eT=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`;function H9(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let s=0,i=2;for(let c=n.length-1;c>=0;c--)s+=parseInt(n[c])*i,i=i<7?i+1:2;const o=11-s%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function W9(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function G9({user:e,roles:t,workSpaces:r,onSubmit:n,onCancel:s,isLoading:i}){const o=!!e,[l,c]=E.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",apellido:(e==null?void 0:e.apellido)||"",email:(e==null?void 0:e.email)||"",telefono:(e==null?void 0:e.telefono)||"",password:"",role_id:(e==null?void 0:e.role_id)||null,work_space_id:(e==null?void 0:e.work_space_id)||null}),[u,h]=E.useState({}),[f,m]=E.useState({});E.useEffect(()=>{e&&c({rut:e.rut||"",nombre:e.nombre||"",apellido:e.apellido||"",email:e.email||"",telefono:e.telefono||"",password:"",role_id:e.role_id||null,work_space_id:e.work_space_id||null})},[e]);const g=E.useCallback((_,b)=>{switch(_){case"rut":return b?H9(b)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return b?b.length<2?"Nombre debe tener al menos 2 caracteres":void 0:"Nombre es requerido";case"apellido":return b?b.length<2?"Apellido debe tener al menos 2 caracteres":void 0:"Apellido es requerido";case"email":return b&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b)?"Email invalido":void 0;case"password":return!o&&!b?"Contrasea es requerida":b&&b.length<6?"Contrasea debe tener al menos 6 caracteres":void 0;default:return}},[o]),v=E.useCallback(_=>{const{name:b,value:w}=_.target,C=b==="rut"?W9(w):w;if(c(j=>({...j,[b]:["role_id","work_space_id"].includes(b)?w?Number(w):null:C})),f[b]){const j=g(b,C);h(T=>({...T,[b]:j}))}},[f,g]),x=E.useCallback(_=>{const{name:b,value:w}=_.target;m(j=>({...j,[b]:!0}));const C=g(b,w);h(j=>({...j,[b]:C}))},[g]),y=E.useCallback(_=>{_.preventDefault();const b={};if(b.rut=g("rut",l.rut),b.nombre=g("nombre",l.nombre),b.apellido=g("apellido",l.apellido),b.email=g("email",l.email),b.password=g("password",l.password),h(b),m({rut:!0,nombre:!0,apellido:!0,email:!0,password:!0}),!Object.values(b).some(w=>w))if(o){const w={nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password||void 0,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(w)}else{const w={rut:l.rut,nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(w)}},[l,g,o,n]);return a.jsxs(L9,{children:[a.jsx(z9,{children:o?`Editando Usuario: ${e==null?void 0:e.nombre} ${e==null?void 0:e.apellido}`:"Nuevo Usuario"}),a.jsx(B9,{children:a.jsxs("form",{onSubmit:y,children:[a.jsxs(U9,{children:[a.jsxs(xo,{children:[a.jsxs(vo,{children:["RUT",a.jsx(rm,{children:"*"})]}),a.jsx(pd,{type:"text",name:"rut",value:l.rut,onChange:v,onBlur:x,placeholder:"12.345.678-9",disabled:o,maxLength:12}),u.rut&&f.rut&&a.jsx(jh,{children:u.rut}),a.jsx(eT,{children:"Formato: 12.345.678-9"})]}),a.jsxs(xo,{children:[a.jsxs(vo,{children:["Nombre",a.jsx(rm,{children:"*"})]}),a.jsx(pd,{type:"text",name:"nombre",value:l.nombre,onChange:v,onBlur:x,placeholder:"Nombre",maxLength:100}),u.nombre&&f.nombre&&a.jsx(jh,{children:u.nombre})]}),a.jsxs(xo,{children:[a.jsxs(vo,{children:["Apellido",a.jsx(rm,{children:"*"})]}),a.jsx(pd,{type:"text",name:"apellido",value:l.apellido,onChange:v,onBlur:x,placeholder:"Apellido",maxLength:100}),u.apellido&&f.apellido&&a.jsx(jh,{children:u.apellido})]}),a.jsxs(xo,{children:[a.jsx(vo,{children:"Email"}),a.jsx(pd,{type:"email",name:"email",value:l.email,onChange:v,onBlur:x,placeholder:"correo@ejemplo.com",maxLength:100}),u.email&&f.email&&a.jsx(jh,{children:u.email})]}),a.jsxs(xo,{children:[a.jsx(vo,{children:"Telefono"}),a.jsx(pd,{type:"text",name:"telefono",value:l.telefono,onChange:v,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(xo,{children:[a.jsxs(vo,{children:["Contrasea",!o&&a.jsx(rm,{children:"*"})]}),a.jsx(pd,{type:"password",name:"password",value:l.password,onChange:v,onBlur:x,placeholder:o?"Dejar vacio para no cambiar":"Minimo 6 caracteres",maxLength:100}),u.password&&f.password&&a.jsx(jh,{children:u.password}),o&&a.jsx(eT,{children:"Dejar vacio para mantener contrasea actual"})]}),a.jsxs(xo,{children:[a.jsx(vo,{children:"Rol"}),a.jsxs(J$,{name:"role_id",value:l.role_id||"",onChange:v,children:[a.jsx("option",{value:"",children:"Sin rol asignado"}),t.map(_=>a.jsx("option",{value:_.id,children:_.nombre},_.id))]})]}),a.jsxs(xo,{children:[a.jsx(vo,{children:"Area de Trabajo"}),a.jsxs(J$,{name:"work_space_id",value:l.work_space_id||"",onChange:v,children:[a.jsx("option",{value:"",children:"Sin area asignada"}),r.map(_=>a.jsx("option",{value:_.id,children:_.nombre},_.id))]})]})]}),a.jsxs(V9,{children:[a.jsx(Z$,{type:"button",onClick:s,disabled:i,children:"Cancelar"}),a.jsx(Z$,{type:"submit",$variant:"primary",disabled:i,children:i?"Guardando...":o?"Actualizar":"Crear"})]})]})})]})}const nm=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,sm=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,am=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,im=p.div`
  display: flex;
  gap: 0.75rem;
`,Ol=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,q9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,K9=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,kh=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Sh=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,X9=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Ty=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Y9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Q9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,yo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,bo=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,J9=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,Ey=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"role":return`
          background: #6c757d15;
          color: #6c757d;
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Ay=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Z9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,eU=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,tU=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,rU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,tT=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,nU=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,sU=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Fy=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,rT=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function aU({onNavigate:e}){const[t,r]=E.useState(1),[n,s]=E.useState(""),[i,o]=E.useState(null),[l,c]=E.useState(null),[u,h]=E.useState(void 0),[f,m]=E.useState(!1),[g,v]=E.useState(null),[x,y]=E.useState(null),[_,b]=E.useState(null),w={page:t,page_size:20,search:n||void 0,role_id:i||void 0,work_space_id:l||void 0,activo:u},{data:C,isLoading:j,error:T}=c9(w),{data:k}=d9(),{data:M}=u9(),A=h9(),O=f9(),F=p9(),B=m9(),L=E.useCallback(N=>{N.preventDefault(),r(1)},[]),U=E.useCallback(()=>{s(""),o(null),c(null),h(void 0),r(1)},[]),P=E.useCallback(()=>{v(null),m(!0)},[]),Q=E.useCallback(N=>{v(N),m(!0)},[]),re=E.useCallback(()=>{m(!1),v(null)},[]),Z=E.useCallback(async N=>{try{g?(await O.mutateAsync({id:g.id,data:N}),y("Usuario actualizado correctamente")):(await A.mutateAsync(N),y("Usuario creado correctamente")),m(!1),v(null),b(null),setTimeout(()=>y(null),3e3)}catch(H){b(H.message||"Error al guardar usuario"),y(null)}},[g,A,O]),W=E.useCallback(async N=>{try{await F.mutateAsync(N),y("Usuario activado correctamente"),b(null),setTimeout(()=>y(null),3e3)}catch(H){b(H.message||"Error al activar usuario")}},[F]),ce=E.useCallback(async N=>{if(window.confirm("Est seguro de desactivar este usuario?"))try{await B.mutateAsync(N),y("Usuario desactivado correctamente"),b(null),setTimeout(()=>y(null),3e3)}catch(H){b(H.message||"Error al desactivar usuario")}},[B]);if(j)return a.jsxs(nm,{children:[a.jsxs(sm,{children:[a.jsx(am,{children:"Mantenedor de Usuarios"}),a.jsx(im,{children:a.jsx(Ol,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(eU,{children:[a.jsx(tU,{}),a.jsx("span",{children:"Cargando usuarios..."})]})]});if(T)return a.jsxs(nm,{children:[a.jsxs(sm,{children:[a.jsx(am,{children:"Mantenedor de Usuarios"}),a.jsx(im,{children:a.jsx(Ol,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx(Fy,{$type:"error",children:"Error al cargar usuarios. Intente nuevamente."})]});const te=(C==null?void 0:C.items)||[],D=(C==null?void 0:C.total_pages)||1,R=(C==null?void 0:C.total)||0;return f?a.jsxs(nm,{children:[a.jsxs(sm,{children:[a.jsx(am,{children:g?"Editar Usuario":"Nuevo Usuario"}),a.jsx(im,{children:a.jsx(Ol,{onClick:re,children:" Cancelar"})})]}),a.jsx(G9,{user:g,roles:k||[],workSpaces:M||[],onSubmit:Z,onCancel:re,isLoading:A.isPending||O.isPending})]}):a.jsxs(nm,{children:[a.jsxs(sm,{children:[a.jsx(am,{children:"Mantenedor de Usuarios"}),a.jsxs(im,{children:[a.jsx(Ol,{$variant:"primary",onClick:P,children:"+ Nuevo Usuario"}),a.jsx(Ol,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),x&&a.jsx(Fy,{$type:"success",children:x}),_&&a.jsx(Fy,{$type:"error",children:_}),a.jsx(q9,{children:a.jsx("form",{onSubmit:L,children:a.jsxs(K9,{children:[a.jsxs(kh,{children:[a.jsx(Sh,{children:"Buscar"}),a.jsx(X9,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:N=>s(N.target.value)})]}),a.jsxs(kh,{children:[a.jsx(Sh,{children:"Rol"}),a.jsxs(Ty,{value:i||"",onChange:N=>o(N.target.value?Number(N.target.value):null),children:[a.jsx("option",{value:"",children:"Todos"}),k==null?void 0:k.map(N=>a.jsx("option",{value:N.id,children:N.nombre},N.id))]})]}),a.jsxs(kh,{children:[a.jsx(Sh,{children:"Area"}),a.jsxs(Ty,{value:l||"",onChange:N=>c(N.target.value?Number(N.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),M==null?void 0:M.map(N=>a.jsx("option",{value:N.id,children:N.nombre},N.id))]})]}),a.jsxs(kh,{children:[a.jsx(Sh,{children:"Estado"}),a.jsxs(Ty,{value:u===void 0?"":u?"true":"false",onChange:N=>h(N.target.value===""?void 0:N.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(kh,{children:[a.jsx(Sh,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Ol,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(Ol,{type:"button",onClick:U,children:"Limpiar"})]})]})]})})}),a.jsxs(sU,{children:["Mostrando ",te.length," de ",R," usuarios"]}),a.jsx(Y9,{children:te.length===0?a.jsx(Z9,{children:a.jsx("p",{children:"No se encontraron usuarios"})}):a.jsxs(a.Fragment,{children:[a.jsxs(Q9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(yo,{children:"ID"}),a.jsx(yo,{children:"RUT"}),a.jsx(yo,{children:"Nombre"}),a.jsx(yo,{children:"Email"}),a.jsx(yo,{children:"Rol"}),a.jsx(yo,{children:"Area"}),a.jsx(yo,{children:"Estado"}),a.jsx(yo,{children:"Acciones"})]})}),a.jsx("tbody",{children:te.map(N=>a.jsxs(J9,{children:[a.jsx(bo,{children:N.id}),a.jsx(bo,{children:N.rut}),a.jsx(bo,{children:a.jsxs(rT,{title:`${N.nombre} ${N.apellido}`,children:[N.nombre," ",N.apellido]})}),a.jsx(bo,{children:a.jsx(rT,{title:N.email||"",children:N.email||"-"})}),a.jsx(bo,{children:N.role_nombre&&a.jsx(Ey,{$type:"role",children:N.role_nombre})}),a.jsx(bo,{children:N.work_space_nombre&&a.jsx(Ey,{$type:"area",children:N.work_space_nombre})}),a.jsx(bo,{children:a.jsx(Ey,{$type:N.activo?"active":"inactive",children:N.activo?"Activo":"Inactivo"})}),a.jsxs(bo,{children:[a.jsx(Ay,{$variant:"edit",onClick:()=>Q(N),title:"Editar",children:"Editar"}),N.activo?a.jsx(Ay,{$variant:"deactivate",onClick:()=>ce(N.id),disabled:B.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(Ay,{$variant:"activate",onClick:()=>W(N.id),disabled:F.isPending,title:"Activar",children:"Activar"})]})]},N.id))})]}),D>1&&a.jsxs(rU,{children:[a.jsx(tT,{disabled:t===1,onClick:()=>r(N=>N-1),children:"Anterior"}),a.jsxs(nU,{children:["Pagina ",t," de ",D]}),a.jsx(tT,{disabled:t===D,onClick:()=>r(N=>N+1),children:"Siguiente"})]})]})})]})}const iU=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,oU=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,lU=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,md=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,cU=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,dU=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,uU=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,hU=p.table`
  width: 100%;
  border-collapse: collapse;
`,Ch=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,$h=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,fU=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,pU=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,mU=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,Py=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,gU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,nT=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,sT=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,xU=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,vU=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,yU=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,bU=p.div`
  margin-bottom: ${d.spacing.md};
`,_U=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,wU=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,jU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,kU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,SU=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function Re({tablaKey:e}){const[t,r]=E.useState([]),[n,s]=E.useState(null),[i,o]=E.useState(!0),[l,c]=E.useState(1),[u,h]=E.useState(1),[f,m]=E.useState(0),[g,v]=E.useState(""),[x,y]=E.useState(""),[_,b]=E.useState(!1),[w,C]=E.useState(null),[j,T]=E.useState({}),[k,M]=E.useState(null),[A,O]=E.useState(null),[F,B]=E.useState(!1);E.useEffect(()=>{(async()=>{try{const N=(await Ri.getTablas()).find(H=>H.key===e);N&&s(N)}catch(R){console.error("Error loading tabla info:",R)}})()},[e]);const L=E.useCallback(async()=>{o(!0);try{const D=await Ri.list(e,{page:l,page_size:20,search:g||void 0,activo:x?parseInt(x):void 0});r(D.items),h(D.total_pages),m(D.total)}catch(D){console.error("Error loading data:",D),O("Error al cargar los datos")}finally{o(!1)}},[e,l,g,x]);E.useEffect(()=>{L()},[L]);const U=()=>{c(1),L()},P=()=>{C(null),T({}),b(!0)},Q=async D=>{try{const R=await Ri.get(e,D.id);C(D);const N={};Object.entries(R.data).forEach(([H,ee])=>{H!=="id"&&H!=="created_at"&&H!=="updated_at"&&(N[H]=(ee==null?void 0:ee.toString())||"")}),T(N),b(!0)}catch(R){console.error("Error loading item:",R),O("Error al cargar el item")}},re=()=>{b(!1),C(null),T({})},Z=async()=>{B(!0),O(null);try{const D={};Object.entries(j).forEach(([R,N])=>{N!==""&&(D[R]=N)}),w?(await Ri.update(e,w.id,D),M("Item actualizado exitosamente")):(await Ri.create(e,D),M("Item creado exitosamente")),re(),L()}catch(D){console.error("Error saving:",D),O("Error al guardar")}finally{B(!1)}},W=async D=>{try{await Ri.activate(e,D),M("Item activado"),L()}catch(R){console.error("Error activating:",R),O("Error al activar")}},ce=async D=>{try{await Ri.deactivate(e,D),M("Item desactivado"),L()}catch(R){console.error("Error deactivating:",R),O("Error al desactivar")}};E.useEffect(()=>{if(k||A){const D=setTimeout(()=>{M(null),O(null)},3e3);return()=>clearTimeout(D)}},[k,A]);const te=()=>n?n.columns.filter(D=>D!=="id"&&D!=="active"&&D!=="created_at"&&D!=="updated_at"):[];return a.jsxs(iU,{children:[a.jsxs(oU,{children:[a.jsx(lU,{children:(n==null?void 0:n.display_name)||e}),a.jsx(md,{onClick:P,children:"+ Nuevo"})]}),k&&a.jsx(sT,{$type:"success",children:k}),A&&a.jsx(sT,{$type:"error",children:A}),a.jsxs(cU,{children:[a.jsx(dU,{type:"text",placeholder:"Buscar...",value:g,onChange:D=>v(D.target.value),onKeyDown:D=>D.key==="Enter"&&U()}),(n==null?void 0:n.has_active)&&a.jsxs(uU,{value:x,onChange:D=>{y(D.target.value),c(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(md,{onClick:U,children:"Filtrar"})]}),a.jsxs(nT,{children:["Mostrando ",t.length," de ",f," registros"]}),i?a.jsx(kU,{children:"Cargando..."}):t.length===0?a.jsx(SU,{children:"No hay registros"}):a.jsxs(hU,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ch,{children:"ID"}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx(Ch,{children:"Cdigo"}),a.jsx(Ch,{children:"Nombre"}),(n==null?void 0:n.has_active)&&a.jsx(Ch,{children:"Estado"}),a.jsx(Ch,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(D=>a.jsxs(fU,{children:[a.jsx($h,{children:D.id}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx($h,{children:D.codigo||"-"}),a.jsx($h,{children:D.nombre}),(n==null?void 0:n.has_active)&&a.jsx($h,{children:a.jsx(pU,{$active:D.active===1,children:D.active===1?"Activo":"Inactivo"})}),a.jsx($h,{children:a.jsxs(mU,{children:[a.jsx(Py,{onClick:()=>Q(D),title:"Editar",children:""}),(n==null?void 0:n.has_active)&&(D.active===1?a.jsx(Py,{$color:d.colors.danger,onClick:()=>ce(D.id),title:"Desactivar",children:""}):a.jsx(Py,{$color:d.colors.success,onClick:()=>W(D.id),title:"Activar",children:""}))]})})]},D.id))})]}),u>1&&a.jsxs(gU,{children:[a.jsx(md,{$variant:"secondary",onClick:()=>c(D=>Math.max(1,D-1)),disabled:l===1,children:"Anterior"}),a.jsxs(nT,{children:["Pgina ",l," de ",u]}),a.jsx(md,{$variant:"secondary",onClick:()=>c(D=>Math.min(u,D+1)),disabled:l===u,children:"Siguiente"})]}),_&&a.jsx(xU,{onClick:re,children:a.jsxs(vU,{onClick:D=>D.stopPropagation(),children:[a.jsxs(yU,{children:[w?"Editar":"Crear"," ",n==null?void 0:n.display_name]}),te().map(D=>a.jsxs(bU,{children:[a.jsx(_U,{children:D.charAt(0).toUpperCase()+D.slice(1).replace(/_/g," ")}),a.jsx(wU,{type:"text",value:j[D]||"",onChange:R=>T(N=>({...N,[D]:R.target.value}))})]},D)),a.jsxs(jU,{children:[a.jsx(md,{$variant:"secondary",onClick:re,children:"Cancelar"}),a.jsx(md,{onClick:Z,disabled:F,children:F?"Guardando...":"Guardar"})]})]})})]})}const CU=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,$U=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,TU=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,EU=p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.lg};
  border-bottom: 2px solid ${d.colors.border};
`,Dy=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  border-radius: ${d.radius.md} ${d.radius.md} 0 0;
  transition: all 0.2s;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
  }
`,gd=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,AU=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,FU=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,aT=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,PU=p.table`
  width: 100%;
  border-collapse: collapse;
`,Rl=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Ir=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,My=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,Oy=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,iT=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${d.colors.primary}20;
  color: ${d.colors.primary};
`,Ry=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,bi=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,DU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,oT=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,lT=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,MU=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,OU=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,RU=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,Iy=p.div`
  margin-bottom: ${d.spacing.md};
`,Ny=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,cT=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,IU=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,NU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,LU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,zU=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function Ly({nivel:e}){const[t,r]=E.useState(e),[n,s]=E.useState(!0),[i,o]=E.useState(1),[l,c]=E.useState(1),[u,h]=E.useState(0),[f,m]=E.useState(""),[g,v]=E.useState(""),[x,y]=E.useState(""),[_,b]=E.useState(!1),[w,C]=E.useState(null),[j,T]=E.useState(null),[k,M]=E.useState(null),[A,O]=E.useState(!1),[F,B]=E.useState([]),[L,U]=E.useState([]),[P,Q]=E.useState([]),[re,Z]=E.useState([]),[W,ce]=E.useState([]),[te,D]=E.useState(""),[R,N]=E.useState(""),[H,ee]=E.useState("");E.useEffect(()=>{(async()=>{try{if(t>=2){const ve=await lr.getNivel2Parents();Z(ve)}if(t===3){const ve=await lr.getNivel3Parents();ce(ve)}}catch(ve){console.error("Error loading parents:",ve)}})()},[t]);const J=E.useCallback(async()=>{s(!0);try{const pe={page:i,page_size:20,search:f||void 0,activo:g?parseInt(g):void 0,hierarchy_id:x&&t>=2?parseInt(x):void 0,subhierarchy_id:x&&t===3?parseInt(x):void 0};if(t===1){const ve=await lr.listNivel1(pe);B(ve.items),c(ve.total_pages),h(ve.total)}else if(t===2){const ve=await lr.listNivel2(pe);U(ve.items),c(ve.total_pages),h(ve.total)}else{const ve=await lr.listNivel3(pe);Q(ve.items),c(ve.total_pages),h(ve.total)}}catch(pe){console.error("Error loading data:",pe),M("Error al cargar los datos")}finally{s(!1)}},[t,i,f,g,x]);E.useEffect(()=>{J()},[J]),E.useEffect(()=>{o(1),m(""),v(""),y("")},[t]);const he=()=>{o(1),J()},ge=()=>{C(null),D(""),N(""),ee(""),b(!0)},xe=async pe=>{try{if(t===1){const ve=await lr.getNivel1(pe);D(ve.descripcion)}else if(t===2){const ve=await lr.getNivel2(pe);D(ve.descripcion),ee(ve.hierarchy_id.toString())}else{const ve=await lr.getNivel3(pe);D(ve.descripcion),N(ve.jerarquia_sap||""),ee(ve.subhierarchy_id.toString())}C(pe),b(!0)}catch(ve){console.error("Error loading item:",ve),M("Error al cargar el item")}},De=()=>{b(!1),C(null)},X=async()=>{if(!te.trim()){M("La descripcin es requerida");return}O(!0),M(null);try{if(t===1)w?await lr.updateNivel1(w,{descripcion:te}):await lr.createNivel1({descripcion:te});else if(t===2){if(!H){M("Debe seleccionar una Jerarqua 1"),O(!1);return}w?await lr.updateNivel2(w,{descripcion:te,hierarchy_id:parseInt(H)}):await lr.createNivel2({descripcion:te,hierarchy_id:parseInt(H)})}else{if(!H){M("Debe seleccionar una Jerarqua 2"),O(!1);return}w?await lr.updateNivel3(w,{descripcion:te,jerarquia_sap:R||void 0,subhierarchy_id:parseInt(H)}):await lr.createNivel3({descripcion:te,jerarquia_sap:R||void 0,subhierarchy_id:parseInt(H)})}T(w?"Actualizado exitosamente":"Creado exitosamente"),De(),J()}catch(pe){console.error("Error saving:",pe),M("Error al guardar")}finally{O(!1)}},rt=async pe=>{try{t===1?await lr.activateNivel1(pe):t===2?await lr.activateNivel2(pe):await lr.activateNivel3(pe),T("Activado"),J()}catch(ve){console.error("Error activating:",ve),M("Error al activar")}},We=async pe=>{try{t===1?await lr.deactivateNivel1(pe):t===2?await lr.deactivateNivel2(pe):await lr.deactivateNivel3(pe),T("Desactivado"),J()}catch(ve){console.error("Error deactivating:",ve),M("Error al desactivar")}};E.useEffect(()=>{if(j||k){const pe=setTimeout(()=>{T(null),M(null)},3e3);return()=>clearTimeout(pe)}},[j,k]);const dt=()=>{switch(t){case 1:return"Jerarquas Nivel 1";case 2:return"Jerarquas Nivel 2";case 3:return"Jerarquas Nivel 3"}};return a.jsxs(CU,{children:[a.jsxs($U,{children:[a.jsx(TU,{children:dt()}),a.jsx(gd,{onClick:ge,children:"+ Nueva Jerarqua"})]}),a.jsxs(EU,{children:[a.jsx(Dy,{$active:t===1,onClick:()=>r(1),children:"Nivel 1"}),a.jsx(Dy,{$active:t===2,onClick:()=>r(2),children:"Nivel 2"}),a.jsx(Dy,{$active:t===3,onClick:()=>r(3),children:"Nivel 3"})]}),j&&a.jsx(lT,{$type:"success",children:j}),k&&a.jsx(lT,{$type:"error",children:k}),a.jsxs(AU,{children:[a.jsx(FU,{type:"text",placeholder:"Buscar...",value:f,onChange:pe=>m(pe.target.value),onKeyDown:pe=>pe.key==="Enter"&&he()}),t>=2&&a.jsxs(aT,{value:x,onChange:pe=>{y(pe.target.value),o(1)},children:[a.jsxs("option",{value:"",children:["Todas las Jerarquas ",t===2?"1":"2"]}),(t===2?re:W).map(pe=>a.jsx("option",{value:pe.id,children:pe.nombre},pe.id))]}),a.jsxs(aT,{value:g,onChange:pe=>{v(pe.target.value),o(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(gd,{onClick:he,children:"Filtrar"})]}),a.jsxs(oT,{children:["Mostrando ",t===1?F.length:t===2?L.length:P.length," de ",u," registros"]}),n?a.jsx(LU,{children:"Cargando..."}):(t===1?F.length:t===2?L.length:P.length)===0?a.jsx(zU,{children:"No hay registros"}):a.jsxs(PU,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Rl,{children:"ID"}),a.jsx(Rl,{children:"Descripcin"}),t===3&&a.jsx(Rl,{children:"SAP"}),t>=2&&a.jsx(Rl,{children:"Padre"}),t<3&&a.jsx(Rl,{children:"Hijos"}),a.jsx(Rl,{children:"Estado"}),a.jsx(Rl,{children:"Acciones"})]})}),a.jsxs("tbody",{children:[t===1&&F.map(pe=>a.jsxs(My,{children:[a.jsx(Ir,{children:pe.id}),a.jsx(Ir,{children:pe.descripcion}),a.jsx(Ir,{children:a.jsx(iT,{children:pe.count_children})}),a.jsx(Ir,{children:a.jsx(Oy,{$active:pe.active===1,children:pe.active===1?"Activo":"Inactivo"})}),a.jsx(Ir,{children:a.jsxs(Ry,{children:[a.jsx(bi,{onClick:()=>xe(pe.id),title:"Editar",children:""}),pe.active===1?a.jsx(bi,{$color:d.colors.danger,onClick:()=>We(pe.id),title:"Desactivar",children:""}):a.jsx(bi,{$color:d.colors.success,onClick:()=>rt(pe.id),title:"Activar",children:""})]})})]},pe.id)),t===2&&L.map(pe=>a.jsxs(My,{children:[a.jsx(Ir,{children:pe.id}),a.jsx(Ir,{children:pe.descripcion}),a.jsx(Ir,{children:pe.hierarchy_nombre}),a.jsx(Ir,{children:a.jsx(iT,{children:pe.count_children})}),a.jsx(Ir,{children:a.jsx(Oy,{$active:pe.active===1,children:pe.active===1?"Activo":"Inactivo"})}),a.jsx(Ir,{children:a.jsxs(Ry,{children:[a.jsx(bi,{onClick:()=>xe(pe.id),title:"Editar",children:""}),pe.active===1?a.jsx(bi,{$color:d.colors.danger,onClick:()=>We(pe.id),title:"Desactivar",children:""}):a.jsx(bi,{$color:d.colors.success,onClick:()=>rt(pe.id),title:"Activar",children:""})]})})]},pe.id)),t===3&&P.map(pe=>a.jsxs(My,{children:[a.jsx(Ir,{children:pe.id}),a.jsx(Ir,{children:pe.descripcion}),a.jsx(Ir,{children:pe.jerarquia_sap||"-"}),a.jsx(Ir,{children:pe.subhierarchy_nombre}),a.jsx(Ir,{children:a.jsx(Oy,{$active:pe.active===1,children:pe.active===1?"Activo":"Inactivo"})}),a.jsx(Ir,{children:a.jsxs(Ry,{children:[a.jsx(bi,{onClick:()=>xe(pe.id),title:"Editar",children:""}),pe.active===1?a.jsx(bi,{$color:d.colors.danger,onClick:()=>We(pe.id),title:"Desactivar",children:""}):a.jsx(bi,{$color:d.colors.success,onClick:()=>rt(pe.id),title:"Activar",children:""})]})})]},pe.id))]})]}),l>1&&a.jsxs(DU,{children:[a.jsx(gd,{$variant:"secondary",onClick:()=>o(pe=>Math.max(1,pe-1)),disabled:i===1,children:"Anterior"}),a.jsxs(oT,{children:["Pgina ",i," de ",l]}),a.jsx(gd,{$variant:"secondary",onClick:()=>o(pe=>Math.min(l,pe+1)),disabled:i===l,children:"Siguiente"})]}),_&&a.jsx(MU,{onClick:De,children:a.jsxs(OU,{onClick:pe=>pe.stopPropagation(),children:[a.jsxs(RU,{children:[w?"Editar":"Crear"," Jerarqua Nivel ",t]}),a.jsxs(Iy,{children:[a.jsx(Ny,{children:"Descripcin *"}),a.jsx(cT,{type:"text",value:te,onChange:pe=>D(pe.target.value),placeholder:"Ingrese descripcin"})]}),t>=2&&a.jsxs(Iy,{children:[a.jsxs(Ny,{children:["Jerarqua ",t===2?"1":"2"," (Padre) *"]}),a.jsxs(IU,{value:H,onChange:pe=>ee(pe.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(t===2?re:W).map(pe=>a.jsx("option",{value:pe.id,children:pe.nombre},pe.id))]})]}),t===3&&a.jsxs(Iy,{children:[a.jsx(Ny,{children:"Cdigo SAP"}),a.jsx(cT,{type:"text",value:R,onChange:pe=>N(pe.target.value),placeholder:"Cdigo SAP (opcional)"})]}),a.jsxs(NU,{children:[a.jsx(gd,{$variant:"secondary",onClick:De,children:"Cancelar"}),a.jsx(gd,{onClick:X,disabled:A,children:A?"Guardando...":"Guardar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zx={};zx.version="0.18.5";var JP=1252,BU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Hj={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Wj=function(e){BU.indexOf(e)!=-1&&(JP=Hj[0]=e)};function UU(){Wj(1252)}var Sa=function(e){Wj(e)};function Gj(){Sa(1200),UU()}function dT(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function VU(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ZP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Cf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?VU(e.slice(2)):t==254&&r==255?ZP(e.slice(2)):t==65279?e.slice(1):e},om=function(t){return String.fromCharCode(t)},uT=function(t){return String.fromCharCode(t)},_0,rl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function w0(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=rl.charAt(i)+rl.charAt(o)+rl.charAt(l)+rl.charAt(c);return t}function bs(e){var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=rl.indexOf(e.charAt(u++)),o=rl.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=rl.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=rl.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ao=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function bl(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function hT(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ps=function(t){return Qe?ao(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function M1(e){if(typeof ArrayBuffer>"u")return ps(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Tl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function HU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function qj(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qj(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Pr=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ao(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function WU(e){for(var t=[],r=0,n=e.length+250,s=bl(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=bl(65535),n=65530)}return t.push(s.slice(0,r)),Pr(t)}var An=/\u0000/g,$f=/[\u0001-\u0006]/g;function eu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ca(e,t){var r=""+e;return r.length>=t?r:Qt("0",t-r.length)+r}function Kj(e,t){var r=""+e;return r.length>=t?r:Qt(" ",t-r.length)+r}function Bx(e,t){var r=""+e;return r.length>=t?r:r+Qt(" ",t-r.length)}function GU(e,t){var r=""+Math.round(e);return r.length>=t?r:Qt("0",t-r.length)+r}function qU(e,t){var r=""+e;return r.length>=t?r:Qt("0",t-r.length)+r}var fT=Math.pow(2,32);function xd(e,t){if(e>fT||e<-fT)return GU(e,t);var r=Math.round(e);return qU(r,t)}function Ux(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var pT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zy=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function KU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Le={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},mT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},XU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vx(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,o=1,l=0,c=1,u=0,h=0,f=Math.floor(s);u<t&&(f=Math.floor(s),l=f*o+i,h=f*u+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=u,u=h;if(h>t&&(u>t?(h=c,l=i):(h=u,l=o)),!r)return[0,n*l,h];var m=Math.floor(n*l/h);return[m,n*l-m*h,h]}function pc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=tV(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var eD=new Date(1899,11,31,0,0,0),YU=eD.getTime(),QU=new Date(1900,2,1,0,0,0);function tD(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=QU&&(r+=24*60*60*1e3),(r-(YU+(e.getTimezoneOffset()-eD.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xj(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZU(e){var t=e<0?12:11,r=Xj(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function eV(e){var t=Xj(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function j0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ZU(e):t===10?r=e.toFixed(10).substr(0,12):r=eV(e),Xj(JU(r.toUpperCase()))}function Hc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):j0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ra(14,tD(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function tV(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function rV(e,t,r,n){var s="",i=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return zy[r.m-1][1];case 5:return zy[r.m-1][0];default:return zy[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return pT[r.q][0];default:return pT[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ca(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=Ca(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var h=u>0?Ca(c,u):"";return h}function nl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var rD=/%/g;function nV(e,t,r){var n=t.replace(rD,""),s=t.length-n.length;return Xi(e,n,r*Math.pow(10,2*s))+Qt("%",s)}function sV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function nD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+nD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sD=/# (\?+)( ?)\/( ?)(\d+)/;function aV(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),o=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Qt(" ",e[1].length+1+e[4].length):Kj(o,e[1].length)+e[2]+"/"+e[3]+Ca(l,e[4].length))}function iV(e,t,r){return r+(t===0?"":""+t)+Qt(" ",e[1].length+2+e[4].length)}var aD=/^#*0*\.([0#]+)/,iD=/\).*[0#]/,oD=/\(###\) ###\\?-####/;function $n(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function gT(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function xT(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function oV(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function lV(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ls(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ls("n",n,r):"("+Ls("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sV(e,t,r);if(t.indexOf("%")!==-1)return nV(e,t,r);if(t.indexOf("E")!==-1)return nD(t,r);if(t.charCodeAt(0)===36)return"$"+Ls(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+xd(c,t.length);if(t.match(/^[#?]+$/))return s=xd(r,0),s==="0"&&(s=""),s.length>t.length?s:$n(t.substr(0,t.length-s.length))+s;if(i=t.match(sD))return aV(i,c,u);if(t.match(/^#+0+$/))return u+xd(c,t.length-t.indexOf("0"));if(i=t.match(aD))return s=gT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Qt("0",$n(i[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+gT(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+nl(xd(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ls(e,t,-r):nl(""+(Math.floor(r)+oV(r,i[1].length)))+"."+Ca(xT(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ls(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=eu(Ls(e,t.replace(/[\\-]/g,""),r)),o=0,eu(eu(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<s.length?s.charAt(o++):v==="0"?"0":""}));if(t.match(oD))return s=Ls(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Vx(c,Math.pow(10,o)-1,!1),s=""+u,h=Xi("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Bx(l[2],o),h.length<i[4].length&&(h=$n(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Vx(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kj(l[1],o)+i[2]+"/"+i[3]+Bx(l[2],o):Qt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=xd(r,0),t.length<=s.length?s:$n(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,m=t.length-s.length-f;return $n(t.substr(0,f)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=xT(r,i[1].length),r<0?"-"+Ls(e,t,-r):nl(lV(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ca(0,3-v.length):"")+v})+"."+Ca(o,i[1].length);switch(t){case"###,##0.00":return Ls(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=nl(xd(c,0));return g!=="0"?u+g:"";case"###,###.00":return Ls(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ls(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function cV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Xi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function dV(e,t,r){var n=t.replace(rD,""),s=t.length-n.length;return Xi(e,n,r*Math.pow(10,2*s))+Qt("%",s)}function lD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+lD(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Qa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qa("n",n,r):"("+Qa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return cV(e,t,r);if(t.indexOf("%")!==-1)return dV(e,t,r);if(t.indexOf("E")!==-1)return lD(t,r);if(t.charCodeAt(0)===36)return"$"+Qa(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ca(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:$n(t.substr(0,t.length-s.length))+s;if(i=t.match(sD))return iV(i,c,u);if(t.match(/^#+0+$/))return u+Ca(c,t.length-t.indexOf("0"));if(i=t.match(aD))return s=(""+r).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])),s=s.replace(/\.(\d*)$/,function(v,x){return"."+x+Qt("0",$n(i[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+nl(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qa(e,t,-r):nl(""+r)+"."+Qt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Qa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=eu(Qa(e,t.replace(/[\\-]/g,""),r)),o=0,eu(eu(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<s.length?s.charAt(o++):v==="0"?"0":""}));if(t.match(oD))return s=Qa(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Vx(c,Math.pow(10,o)-1,!1),s=""+u,h=Xi("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Bx(l[2],o),h.length<i[4].length&&(h=$n(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Vx(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kj(l[1],o)+i[2]+"/"+i[3]+Bx(l[2],o):Qt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:$n(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,m=t.length-s.length-f;return $n(t.substr(0,f)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Qa(e,t,-r):nl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ca(0,3-v.length):"")+v})+"."+Ca(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=nl(""+c);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return Qa(e,t.slice(0,t.lastIndexOf(".")),r)+$n(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Xi(e,t,r){return(r|0)===r?Qa(e,t,r):Ls(e,t,r)}function uV(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var cD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ux(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(cD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hV(e,t,r,n){for(var s=[],i="",o=0,l="",c="t",u,h,f,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Ux(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var g=e.charAt(++o),v=g==="("||g===")"?g:"t";s[s.length]={t:v,v:g},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=pc(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=pc(t,r),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(u==null&&(u=pc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,m="h"):(x.t="t",++o),u==null&&x.t==="T")return"";s[s.length]=x,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(cD)){if(u==null&&(u=pc(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wu(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var y=0,_=0,b;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=m,c="h",y<1&&(y=1);break;case"s":(b=s[o].v.match(/\.0+$/))&&(_=Math.max(_,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[o].v.match(/[Hh]/)&&(y=1),y<2&&s[o].v.match(/[Mm]/)&&(y=2),y<3&&s[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",C;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=rV(s[o].t.charCodeAt(0),s[o].v,u,_),s[o].t="t";break;case"n":case"?":for(C=o+1;s[C]!=null&&((l=s[C].t)==="?"||l==="D"||(l===" "||l==="t")&&s[C+1]!=null&&(s[C+1].t==="?"||s[C+1].t==="t"&&s[C+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[C].v==="/"||s[C].v===" "&&s[C+1]!=null&&s[C+1].t=="?"));)s[o].v+=s[C].v,s[C]={v:"",t:";"},++C;w+=s[o].v,o=C-1;break;case"G":s[o].t="t",s[o].v=Hc(t,r);break}var j="",T,k;if(w.length>0){w.charCodeAt(0)==40?(T=t<0&&w.charCodeAt(0)===45?-t:t,k=Xi("n",w,T)):(T=t<0&&n>1?-t:t,k=Xi("n",w,T),T<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),C=k.length-1;var M=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){M=o;break}var A=s.length;if(M===s.length&&k.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(C>=s[o].v.length-1?(C-=s[o].v.length,s[o].v=k.substr(C+1,s[o].v.length)):C<0?s[o].v="":(s[o].v=k.substr(0,C+1),C=-1),s[o].t="t",A=o);C>=0&&A<s.length&&(s[A].v=k.substr(0,C+1)+s[A].v)}else if(M!==s.length&&k.indexOf("E")===-1){for(C=k.indexOf(".")-1,o=M;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(h=s[o].v.indexOf(".")>-1&&o===M?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(h+1);h>=0;--h)C>=0&&(s[o].v.charAt(h)==="0"||s[o].v.charAt(h)==="#")&&(j=k.charAt(C--)+j);s[o].v=j,s[o].t="t",A=o}for(C>=0&&A<s.length&&(s[A].v=k.substr(0,C+1)+s[A].v),C=k.indexOf(".")+1,o=M;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==M)){for(h=s[o].v.indexOf(".")>-1&&o===M?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,h);h<s[o].v.length;++h)C<k.length&&(j+=k.charAt(C++));s[o].v=j,s[o].t="t",A=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(T=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Xi(s[o].t,s[o].v,T),s[o].t="t");var O="";for(o=0;o!==s.length;++o)s[o]!=null&&(O+=s[o].v);return O}var vT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yT(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function fV(e,t){var r=uV(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(vT),l=r[1].match(vT);return yT(t,o)?[n,r[0]]:yT(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function ra(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Le)[e],n==null&&(n=r.table&&r.table[mT[e]]||Le[mT[e]]),n==null&&(n=XU[e]||"General");break}if(Ux(n,0))return Hc(t,r);t instanceof Date&&(t=tD(t,r.date1904));var s=fV(n,t);if(Ux(s[1]))return Hc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hV(s[1],t,r,s[0])}function Yi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Le[r]==null){t<0&&(t=r);continue}if(Le[r]==e){t=r;break}}t<0&&(t=391)}return Le[t]=e,t}function O1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Yi(e[t],t)}function Gu(){Le=KU()}var pV={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function mV(e){var t=typeof e=="number"?Le[e]:e;return t=t.replace(dD,"(\\d+)"),new RegExp("^"+t+"$")}function gV(e,t,r){var n=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(dD)||[]).forEach(function(f,m){var g=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":o=g;break;case"s":c=g;break;case"m":o>=0?l=g:s=g;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&i==-1?h:u+"T"+h}var xV=function(){var e={};e.version="1.2.0";function t(){for(var k=0,M=new Array(256),A=0;A!=256;++A)k=A,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,M[A]=k;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(k){var M=0,A=0,O=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)F[O]=k[O];for(O=0;O!=256;++O)for(A=k[O],M=256+O;M<4096;M+=256)A=F[M]=A>>>8^k[A&255];var B=[];for(O=1;O!=16;++O)B[O-1]=typeof Int32Array<"u"?F.subarray(O*256,O*256+256):F.slice(O*256,O*256+256);return B}var s=n(r),i=s[0],o=s[1],l=s[2],c=s[3],u=s[4],h=s[5],f=s[6],m=s[7],g=s[8],v=s[9],x=s[10],y=s[11],_=s[12],b=s[13],w=s[14];function C(k,M){for(var A=M^-1,O=0,F=k.length;O<F;)A=A>>>8^r[(A^k.charCodeAt(O++))&255];return~A}function j(k,M){for(var A=M^-1,O=k.length-15,F=0;F<O;)A=w[k[F++]^A&255]^b[k[F++]^A>>8&255]^_[k[F++]^A>>16&255]^y[k[F++]^A>>>24]^x[k[F++]]^v[k[F++]]^g[k[F++]]^m[k[F++]]^f[k[F++]]^h[k[F++]]^u[k[F++]]^c[k[F++]]^l[k[F++]]^o[k[F++]]^i[k[F++]]^r[k[F++]];for(O+=15;F<O;)A=A>>>8^r[(A^k[F++])&255];return~A}function T(k,M){for(var A=M^-1,O=0,F=k.length,B=0,L=0;O<F;)B=k.charCodeAt(O++),B<128?A=A>>>8^r[(A^B)&255]:B<2048?(A=A>>>8^r[(A^(192|B>>6&31))&255],A=A>>>8^r[(A^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,L=k.charCodeAt(O++)&1023,A=A>>>8^r[(A^(240|B>>8&7))&255],A=A>>>8^r[(A^(128|B>>2&63))&255],A=A>>>8^r[(A^(128|L>>6&15|(B&3)<<4))&255],A=A>>>8^r[(A^(128|L&63))&255]):(A=A>>>8^r[(A^(224|B>>12&15))&255],A=A>>>8^r[(A^(128|B>>6&63))&255],A=A>>>8^r[(A^(128|B&63))&255]);return~A}return e.table=r,e.bstr=C,e.buf=j,e.str=T,e}(),Ie=function(){var t={};t.version="1.2.1";function r(I,G){for(var z=I.split("/"),V=G.split("/"),q=0,K=0,se=Math.min(z.length,V.length);q<se;++q){if(K=z[q].length-V[q].length)return K;if(z[q]!=V[q])return z[q]<V[q]?-1:1}return z.length-V.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(0,G+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(G+1)}function i(I,G){typeof G=="string"&&(G=new Date(G));var z=G.getHours();z=z<<6|G.getMinutes(),z=z<<5|G.getSeconds()>>>1,I.write_shift(2,z);var V=G.getFullYear()-1980;V=V<<4|G.getMonth()+1,V=V<<5|G.getDate(),I.write_shift(2,V)}function o(I){var G=I.read_shift(2)&65535,z=I.read_shift(2)&65535,V=new Date,q=z&31;z>>>=5;var K=z&15;z>>>=4,V.setMilliseconds(0),V.setFullYear(z+1980),V.setMonth(K-1),V.setDate(q);var se=G&31;G>>>=5;var me=G&63;return G>>>=6,V.setHours(G),V.setMinutes(me),V.setSeconds(se<<1),V}function l(I){Vr(I,0);for(var G={},z=0;I.l<=I.length-4;){var V=I.read_shift(2),q=I.read_shift(2),K=I.l+q,se={};switch(V){case 21589:z=I.read_shift(1),z&1&&(se.mtime=I.read_shift(4)),q>5&&(z&2&&(se.atime=I.read_shift(4)),z&4&&(se.ctime=I.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}I.l=K,G[V]=se}return G}var c;function u(){return c||(c={})}function h(I,G){if(I[0]==80&&I[1]==75)return S(I,G);if((I[0]|32)==109&&(I[1]|32)==105)return $s(I,G);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var z=3,V=512,q=0,K=0,se=0,me=0,ne=0,ae=[],oe=I.slice(0,512);Vr(oe,0);var be=f(oe);switch(z=be[0],z){case 3:V=512;break;case 4:V=4096;break;case 0:if(be[1]==0)return S(I,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}V!==512&&(oe=I.slice(0,V),Vr(oe,28));var Ce=I.slice(0,V);m(oe,z);var Ee=oe.read_shift(4,"i");if(z===3&&Ee!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ee);oe.l+=4,se=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),me=oe.read_shift(4,"i"),q=oe.read_shift(4,"i"),ne=oe.read_shift(4,"i"),K=oe.read_shift(4,"i");for(var we=-1,$e=0;$e<109&&(we=oe.read_shift(4,"i"),!(we<0));++$e)ae[$e]=we;var Ue=g(I,V);y(ne,K,Ue,V,ae);var $t=b(Ue,se,ae,V);$t[se].name="!Directory",q>0&&me!==L&&($t[me].name="!MiniFAT"),$t[ae[0]].name="!FAT",$t.fat_addrs=ae,$t.ssz=V;var Tt={},gr=[],Ia=[],th=[];w(se,$t,Ue,gr,q,Tt,Ia,me),v(Ia,th,gr),gr.shift();var rh={FileIndex:Ia,FullPaths:th};return G&&G.raw&&(rh.raw={header:Ce,sectors:Ue}),rh}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(U,"Header Signature: "),I.l+=16;var G=I.read_shift(2,"u");return[I.read_shift(2,"u"),G]}function m(I,G){var z=9;switch(I.l+=2,z=I.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function g(I,G){for(var z=Math.ceil(I.length/G)-1,V=[],q=1;q<z;++q)V[q-1]=I.slice(q*G,(q+1)*G);return V[z-1]=I.slice(z*G),V}function v(I,G,z){for(var V=0,q=0,K=0,se=0,me=0,ne=z.length,ae=[],oe=[];V<ne;++V)ae[V]=oe[V]=V,G[V]=z[V];for(;me<oe.length;++me)V=oe[me],q=I[V].L,K=I[V].R,se=I[V].C,ae[V]===V&&(q!==-1&&ae[q]!==q&&(ae[V]=ae[q]),K!==-1&&ae[K]!==K&&(ae[V]=ae[K])),se!==-1&&(ae[se]=V),q!==-1&&V!=ae[V]&&(ae[q]=ae[V],oe.lastIndexOf(q)<me&&oe.push(q)),K!==-1&&V!=ae[V]&&(ae[K]=ae[V],oe.lastIndexOf(K)<me&&oe.push(K));for(V=1;V<ne;++V)ae[V]===V&&(K!==-1&&ae[K]!==K?ae[V]=ae[K]:q!==-1&&ae[q]!==q&&(ae[V]=ae[q]));for(V=1;V<ne;++V)if(I[V].type!==0){if(me=V,me!=ae[me])do me=ae[me],G[V]=G[me]+"/"+G[V];while(me!==0&&ae[me]!==-1&&me!=ae[me]);ae[V]=-1}for(G[0]+="/",V=1;V<ne;++V)I[V].type!==2&&(G[V]+="/")}function x(I,G,z){for(var V=I.start,q=I.size,K=[],se=V;z&&q>0&&se>=0;)K.push(G.slice(se*B,se*B+B)),q-=B,se=oc(z,se*4);return K.length===0?fe(0):Pr(K).slice(0,I.size)}function y(I,G,z,V,q){var K=L;if(I===L){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var se=z[I],me=(V>>>2)-1;if(!se)return;for(var ne=0;ne<me&&(K=oc(se,ne*4))!==L;++ne)q.push(K);y(oc(se,V-4),G-1,z,V,q)}}function _(I,G,z,V,q){var K=[],se=[];q||(q=[]);var me=V-1,ne=0,ae=0;for(ne=G;ne>=0;){q[ne]=!0,K[K.length]=ne,se.push(I[ne]);var oe=z[Math.floor(ne*4/V)];if(ae=ne*4&me,V<4+ae)throw new Error("FAT boundary crossed: "+ne+" 4 "+V);if(!I[oe])break;ne=oc(I[oe],ae)}return{nodes:K,data:FT([se])}}function b(I,G,z,V){var q=I.length,K=[],se=[],me=[],ne=[],ae=V-1,oe=0,be=0,Ce=0,Ee=0;for(oe=0;oe<q;++oe)if(me=[],Ce=oe+G,Ce>=q&&(Ce-=q),!se[Ce]){ne=[];var we=[];for(be=Ce;be>=0;){we[be]=!0,se[be]=!0,me[me.length]=be,ne.push(I[be]);var $e=z[Math.floor(be*4/V)];if(Ee=be*4&ae,V<4+Ee)throw new Error("FAT boundary crossed: "+be+" 4 "+V);if(!I[$e]||(be=oc(I[$e],Ee),we[be]))break}K[Ce]={nodes:me,data:FT([ne])}}return K}function w(I,G,z,V,q,K,se,me){for(var ne=0,ae=V.length?2:0,oe=G[I].data,be=0,Ce=0,Ee;be<oe.length;be+=128){var we=oe.slice(be,be+128);Vr(we,64),Ce=we.read_shift(2),Ee=rk(we,0,Ce-ae),V.push(Ee);var $e={name:Ee,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},Ue=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Ue!==0&&($e.ct=C(we,we.l-8));var $t=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);$t!==0&&($e.mt=C(we,we.l-8)),$e.start=we.read_shift(4,"i"),$e.size=we.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=L,$e.name=""),$e.type===5?(ne=$e.start,q>0&&ne!==L&&(G[ne].name="!StreamData")):$e.size>=4096?($e.storage="fat",G[$e.start]===void 0&&(G[$e.start]=_(z,$e.start,G.fat_addrs,G.ssz)),G[$e.start].name=$e.name,$e.content=G[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:ne!==L&&$e.start!==L&&G[ne]&&($e.content=x($e,G[ne].data,(G[me]||{}).data))),$e.content&&Vr($e.content,0),K[Ee]=$e,se.push($e)}}function C(I,G){return new Date((fs(I,G+4)/1e7*Math.pow(2,32)+fs(I,G)/1e7-11644473600)*1e3)}function j(I,G){return u(),h(c.readFileSync(I),G)}function T(I,G){var z=G&&G.type;switch(z||Qe&&Buffer.isBuffer(I)&&(z="buffer"),z||"base64"){case"file":return j(I,G);case"base64":return h(ps(bs(I)),G);case"binary":return h(ps(I),G)}return h(I,G)}function k(I,G){var z=G||{},V=z.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=V+"/",I.FileIndex[0]={name:V,type:5}),z.CLSID&&(I.FileIndex[0].clsid=z.CLSID),M(I)}function M(I){var G="Sh33tJ5";if(!Ie.find(I,"/"+G)){var z=fe(4);z[0]=55,z[1]=z[3]=50,z[2]=54,I.FileIndex.push({name:G,type:2,content:z,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+G),A(I)}}function A(I,G){k(I);for(var z=!1,V=!1,q=I.FullPaths.length-1;q>=0;--q){var K=I.FileIndex[q];switch(K.type){case 0:V?z=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(K.R*K.L*K.C)&&(z=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!G)){var se=new Date(1987,1,19),me=0,ne=Object.create?Object.create(null):{},ae=[];for(q=0;q<I.FullPaths.length;++q)ne[I.FullPaths[q]]=!0,I.FileIndex[q].type!==0&&ae.push([I.FullPaths[q],I.FileIndex[q]]);for(q=0;q<ae.length;++q){var oe=n(ae[q][0]);V=ne[oe],V||(ae.push([oe,{name:s(oe).replace("/",""),type:1,clsid:Q,ct:se,mt:se,content:null}]),ne[oe]=!0)}for(ae.sort(function(Ee,we){return r(Ee[0],we[0])}),I.FullPaths=[],I.FileIndex=[],q=0;q<ae.length;++q)I.FullPaths[q]=ae[q][0],I.FileIndex[q]=ae[q][1];for(q=0;q<ae.length;++q){var be=I.FileIndex[q],Ce=I.FullPaths[q];if(be.name=s(Ce).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||Q,q===0)be.C=ae.length>1?1:-1,be.size=0,be.type=5;else if(Ce.slice(-1)=="/"){for(me=q+1;me<ae.length&&n(I.FullPaths[me])!=Ce;++me);for(be.C=me>=ae.length?-1:me,me=q+1;me<ae.length&&n(I.FullPaths[me])!=n(Ce);++me);be.R=me>=ae.length?-1:me,be.type=1}else n(I.FullPaths[q+1]||"")==n(Ce)&&(be.R=q+1),be.type=2}}}function O(I,G){var z=G||{};if(z.fileType=="mad")return Ra(I,z);switch(A(I),z.fileType){case"zip":return yt(I,z)}var V=function(Ee){for(var we=0,$e=0,Ue=0;Ue<Ee.FileIndex.length;++Ue){var $t=Ee.FileIndex[Ue];if($t.content){var Tt=$t.content.length;Tt>0&&(Tt<4096?we+=Tt+63>>6:$e+=Tt+511>>9)}}for(var gr=Ee.FullPaths.length+3>>2,Ia=we+7>>3,th=we+127>>7,rh=Ia+$e+gr+th,Pl=rh+127>>7,Y1=Pl<=109?0:Math.ceil((Pl-109)/127);rh+Pl+Y1+127>>7>Pl;)Y1=++Pl<=109?0:Math.ceil((Pl-109)/127);var mi=[1,Y1,Pl,th,gr,$e,we,0];return Ee.FileIndex[0].size=we<<6,mi[7]=(Ee.FileIndex[0].start=mi[0]+mi[1]+mi[2]+mi[3]+mi[4]+mi[5])+(mi[6]+7>>3),mi}(I),q=fe(V[7]<<9),K=0,se=0;{for(K=0;K<8;++K)q.write_shift(1,P[K]);for(K=0;K<8;++K)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),K=0;K<3;++K)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,V[2]),q.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:L),q.write_shift(4,V[3]),q.write_shift(-4,V[1]?V[0]-1:L),q.write_shift(4,V[1]),K=0;K<109;++K)q.write_shift(-4,K<V[2]?V[1]+K:-1)}if(V[1])for(se=0;se<V[1];++se){for(;K<236+se*127;++K)q.write_shift(-4,K<V[2]?V[1]+K:-1);q.write_shift(-4,se===V[1]-1?L:se+1)}var me=function(Ee){for(se+=Ee;K<se-1;++K)q.write_shift(-4,K+1);Ee&&(++K,q.write_shift(-4,L))};for(se=K=0,se+=V[1];K<se;++K)q.write_shift(-4,re.DIFSECT);for(se+=V[2];K<se;++K)q.write_shift(-4,re.FATSECT);me(V[3]),me(V[4]);for(var ne=0,ae=0,oe=I.FileIndex[0];ne<I.FileIndex.length;++ne)oe=I.FileIndex[ne],oe.content&&(ae=oe.content.length,!(ae<4096)&&(oe.start=se,me(ae+511>>9)));for(me(V[6]+7>>3);q.l&511;)q.write_shift(-4,re.ENDOFCHAIN);for(se=K=0,ne=0;ne<I.FileIndex.length;++ne)oe=I.FileIndex[ne],oe.content&&(ae=oe.content.length,!(!ae||ae>=4096)&&(oe.start=se,me(ae+63>>6)));for(;q.l&511;)q.write_shift(-4,re.ENDOFCHAIN);for(K=0;K<V[4]<<2;++K){var be=I.FullPaths[K];if(!be||be.length===0){for(ne=0;ne<17;++ne)q.write_shift(4,0);for(ne=0;ne<3;++ne)q.write_shift(4,-1);for(ne=0;ne<12;++ne)q.write_shift(4,0);continue}oe=I.FileIndex[K],K===0&&(oe.start=oe.size?oe.start-1:L);var Ce=K===0&&z.root||oe.name;if(ae=2*(Ce.length+1),q.write_shift(64,Ce,"utf16le"),q.write_shift(2,ae),q.write_shift(1,oe.type),q.write_shift(1,oe.color),q.write_shift(-4,oe.L),q.write_shift(-4,oe.R),q.write_shift(-4,oe.C),oe.clsid)q.write_shift(16,oe.clsid,"hex");else for(ne=0;ne<4;++ne)q.write_shift(4,0);q.write_shift(4,oe.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,oe.start),q.write_shift(4,oe.size),q.write_shift(4,0)}for(K=1;K<I.FileIndex.length;++K)if(oe=I.FileIndex[K],oe.size>=4096)if(q.l=oe.start+1<<9,Qe&&Buffer.isBuffer(oe.content))oe.content.copy(q,q.l,0,oe.size),q.l+=oe.size+511&-512;else{for(ne=0;ne<oe.size;++ne)q.write_shift(1,oe.content[ne]);for(;ne&511;++ne)q.write_shift(1,0)}for(K=1;K<I.FileIndex.length;++K)if(oe=I.FileIndex[K],oe.size>0&&oe.size<4096)if(Qe&&Buffer.isBuffer(oe.content))oe.content.copy(q,q.l,0,oe.size),q.l+=oe.size+63&-64;else{for(ne=0;ne<oe.size;++ne)q.write_shift(1,oe.content[ne]);for(;ne&63;++ne)q.write_shift(1,0)}if(Qe)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function F(I,G){var z=I.FullPaths.map(function(ne){return ne.toUpperCase()}),V=z.map(function(ne){var ae=ne.split("/");return ae[ae.length-(ne.slice(-1)=="/"?2:1)]}),q=!1;G.charCodeAt(0)===47?(q=!0,G=z[0].slice(0,-1)+G):q=G.indexOf("/")!==-1;var K=G.toUpperCase(),se=q===!0?z.indexOf(K):V.indexOf(K);if(se!==-1)return I.FileIndex[se];var me=!K.match($f);for(K=K.replace(An,""),me&&(K=K.replace($f,"!")),se=0;se<z.length;++se)if((me?z[se].replace($f,"!"):z[se]).replace(An,"")==K||(me?V[se].replace($f,"!"):V[se]).replace(An,"")==K)return I.FileIndex[se];return null}var B=64,L=-2,U="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(I,G,z){u();var V=O(I,z);c.writeFileSync(G,V)}function W(I){for(var G=new Array(I.length),z=0;z<I.length;++z)G[z]=String.fromCharCode(I[z]);return G.join("")}function ce(I,G){var z=O(I,G);switch(G&&G.type||"buffer"){case"file":return u(),c.writeFileSync(G.filename,z),z;case"binary":return typeof z=="string"?z:W(z);case"base64":return w0(typeof z=="string"?z:W(z));case"buffer":if(Qe)return Buffer.isBuffer(z)?z:ao(z);case"array":return typeof z=="string"?ps(z):z}return z}var te;function D(I){try{var G=I.InflateRaw,z=new G;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)te=I;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function R(I,G){if(!te)return Zu(I,G);var z=te.InflateRaw,V=new z,q=V._processChunk(I.slice(I.l),V._finishFlushFlag);return I.l+=V.bytesRead,q}function N(I){return te?te.deflateRawSync(I):Ge(I)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(I){var G=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(G>>16|G>>8|G)&255}for(var ge=typeof Uint8Array<"u",xe=ge?new Uint8Array(256):[],De=0;De<256;++De)xe[De]=he(De);function X(I,G){var z=xe[I&255];return G<=8?z>>>8-G:(z=z<<8|xe[I>>8&255],G<=16?z>>>16-G:(z=z<<8|xe[I>>16&255],z>>>24-G))}function rt(I,G){var z=G&7,V=G>>>3;return(I[V]|(z<=6?0:I[V+1]<<8))>>>z&3}function We(I,G){var z=G&7,V=G>>>3;return(I[V]|(z<=5?0:I[V+1]<<8))>>>z&7}function dt(I,G){var z=G&7,V=G>>>3;return(I[V]|(z<=4?0:I[V+1]<<8))>>>z&15}function pe(I,G){var z=G&7,V=G>>>3;return(I[V]|(z<=3?0:I[V+1]<<8))>>>z&31}function ve(I,G){var z=G&7,V=G>>>3;return(I[V]|(z<=1?0:I[V+1]<<8))>>>z&127}function Nt(I,G,z){var V=G&7,q=G>>>3,K=(1<<z)-1,se=I[q]>>>V;return z<8-V||(se|=I[q+1]<<8-V,z<16-V)||(se|=I[q+2]<<16-V,z<24-V)||(se|=I[q+3]<<24-V),se&K}function gn(I,G,z){var V=G&7,q=G>>>3;return V<=5?I[q]|=(z&7)<<V:(I[q]|=z<<V&255,I[q+1]=(z&7)>>8-V),G+3}function ns(I,G,z){var V=G&7,q=G>>>3;return z=(z&1)<<V,I[q]|=z,G+1}function js(I,G,z){var V=G&7,q=G>>>3;return z<<=V,I[q]|=z&255,z>>>=8,I[q+1]=z,G+8}function lo(I,G,z){var V=G&7,q=G>>>3;return z<<=V,I[q]|=z&255,z>>>=8,I[q+1]=z&255,I[q+2]=z>>>8,G+16}function ia(I,G){var z=I.length,V=2*z>G?2*z:G+5,q=0;if(z>=G)return I;if(Qe){var K=hT(V);if(I.copy)I.copy(K);else for(;q<I.length;++q)K[q]=I[q];return K}else if(ge){var se=new Uint8Array(V);if(se.set)se.set(I);else for(;q<z;++q)se[q]=I[q];return se}return I.length=V,I}function Xr(I){for(var G=new Array(I),z=0;z<I;++z)G[z]=0;return G}function ks(I,G,z){var V=1,q=0,K=0,se=0,me=0,ne=I.length,ae=ge?new Uint16Array(32):Xr(32);for(K=0;K<32;++K)ae[K]=0;for(K=ne;K<z;++K)I[K]=0;ne=I.length;var oe=ge?new Uint16Array(ne):Xr(ne);for(K=0;K<ne;++K)ae[q=I[K]]++,V<q&&(V=q),oe[K]=0;for(ae[0]=0,K=1;K<=V;++K)ae[K+16]=me=me+ae[K-1]<<1;for(K=0;K<ne;++K)me=I[K],me!=0&&(oe[K]=ae[me+16]++);var be=0;for(K=0;K<ne;++K)if(be=I[K],be!=0)for(me=X(oe[K],V)>>V-be,se=(1<<V+4-be)-1;se>=0;--se)G[me|se<<be]=be&15|K<<4;return V}var oa=ge?new Uint16Array(512):Xr(512),co=ge?new Uint16Array(32):Xr(32);if(!ge){for(var Cr=0;Cr<512;++Cr)oa[Cr]=0;for(Cr=0;Cr<32;++Cr)co[Cr]=0}(function(){for(var I=[],G=0;G<32;G++)I.push(5);ks(I,co,32);var z=[];for(G=0;G<=143;G++)z.push(8);for(;G<=255;G++)z.push(9);for(;G<=279;G++)z.push(7);for(;G<=287;G++)z.push(8);ks(z,oa,288)})();var ss=function(){for(var G=ge?new Uint8Array(32768):[],z=0,V=0;z<J.length-1;++z)for(;V<J[z+1];++V)G[V]=z;for(;V<32768;++V)G[V]=29;var q=ge?new Uint8Array(259):[];for(z=0,V=0;z<ee.length-1;++z)for(;V<ee[z+1];++V)q[V]=z;function K(me,ne){for(var ae=0;ae<me.length;){var oe=Math.min(65535,me.length-ae),be=ae+oe==me.length;for(ne.write_shift(1,+be),ne.write_shift(2,oe),ne.write_shift(2,~oe&65535);oe-- >0;)ne[ne.l++]=me[ae++]}return ne.l}function se(me,ne){for(var ae=0,oe=0,be=ge?new Uint16Array(32768):[];oe<me.length;){var Ce=Math.min(65535,me.length-oe);if(Ce<10){for(ae=gn(ne,ae,+(oe+Ce==me.length)),ae&7&&(ae+=8-(ae&7)),ne.l=ae/8|0,ne.write_shift(2,Ce),ne.write_shift(2,~Ce&65535);Ce-- >0;)ne[ne.l++]=me[oe++];ae=ne.l*8;continue}ae=gn(ne,ae,+(oe+Ce==me.length)+2);for(var Ee=0;Ce-- >0;){var we=me[oe];Ee=(Ee<<5^we)&32767;var $e=-1,Ue=0;if(($e=be[Ee])&&($e|=oe&-32768,$e>oe&&($e-=32768),$e<oe))for(;me[$e+Ue]==me[oe+Ue]&&Ue<250;)++Ue;if(Ue>2){we=q[Ue],we<=22?ae=js(ne,ae,xe[we+1]>>1)-1:(js(ne,ae,3),ae+=5,js(ne,ae,xe[we-23]>>5),ae+=3);var $t=we<8?0:we-4>>2;$t>0&&(lo(ne,ae,Ue-ee[we]),ae+=$t),we=G[oe-$e],ae=js(ne,ae,xe[we]>>3),ae-=3;var Tt=we<4?0:we-2>>1;Tt>0&&(lo(ne,ae,oe-$e-J[we]),ae+=Tt);for(var gr=0;gr<Ue;++gr)be[Ee]=oe&32767,Ee=(Ee<<5^me[oe])&32767,++oe;Ce-=Ue-1}else we<=143?we=we+48:ae=ns(ne,ae,1),ae=js(ne,ae,xe[we]),be[Ee]=oe&32767,++oe}ae=js(ne,ae,0)-1}return ne.l=(ae+7)/8|0,ne.l}return function(ne,ae){return ne.length<8?K(ne,ae):se(ne,ae)}}();function Ge(I){var G=fe(50+Math.floor(I.length*1.1)),z=ss(I,G);return G.slice(0,z)}var Lt=ge?new Uint16Array(32768):Xr(32768),xn=ge?new Uint16Array(32768):Xr(32768),Kt=ge?new Uint16Array(128):Xr(128),Oa=1,Ju=1;function fp(I,G){var z=pe(I,G)+257;G+=5;var V=pe(I,G)+1;G+=5;var q=dt(I,G)+4;G+=4;for(var K=0,se=ge?new Uint8Array(19):Xr(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,ae=ge?new Uint8Array(8):Xr(8),oe=ge?new Uint8Array(8):Xr(8),be=se.length,Ce=0;Ce<q;++Ce)se[H[Ce]]=K=We(I,G),ne<K&&(ne=K),ae[K]++,G+=3;var Ee=0;for(ae[0]=0,Ce=1;Ce<=ne;++Ce)oe[Ce]=Ee=Ee+ae[Ce-1]<<1;for(Ce=0;Ce<be;++Ce)(Ee=se[Ce])!=0&&(me[Ce]=oe[Ee]++);var we=0;for(Ce=0;Ce<be;++Ce)if(we=se[Ce],we!=0){Ee=xe[me[Ce]]>>8-we;for(var $e=(1<<7-we)-1;$e>=0;--$e)Kt[Ee|$e<<we]=we&7|Ce<<3}var Ue=[];for(ne=1;Ue.length<z+V;)switch(Ee=Kt[ve(I,G)],G+=Ee&7,Ee>>>=3){case 16:for(K=3+rt(I,G),G+=2,Ee=Ue[Ue.length-1];K-- >0;)Ue.push(Ee);break;case 17:for(K=3+We(I,G),G+=3;K-- >0;)Ue.push(0);break;case 18:for(K=11+ve(I,G),G+=7;K-- >0;)Ue.push(0);break;default:Ue.push(Ee),ne<Ee&&(ne=Ee);break}var $t=Ue.slice(0,z),Tt=Ue.slice(z);for(Ce=z;Ce<286;++Ce)$t[Ce]=0;for(Ce=V;Ce<30;++Ce)Tt[Ce]=0;return Oa=ks($t,Lt,286),Ju=ks(Tt,xn,30),G}function pp(I,G){if(I[0]==3&&!(I[1]&3))return[bl(G),2];for(var z=0,V=0,q=hT(G||1<<18),K=0,se=q.length>>>0,me=0,ne=0;!(V&1);){if(V=We(I,z),z+=3,V>>>1)V>>1==1?(me=9,ne=5):(z=fp(I,z),me=Oa,ne=Ju);else{z&7&&(z+=8-(z&7));var ae=I[z>>>3]|I[(z>>>3)+1]<<8;if(z+=32,ae>0)for(!G&&se<K+ae&&(q=ia(q,K+ae),se=q.length);ae-- >0;)q[K++]=I[z>>>3],z+=8;continue}for(;;){!G&&se<K+32767&&(q=ia(q,K+32767),se=q.length);var oe=Nt(I,z,me),be=V>>>1==1?oa[oe]:Lt[oe];if(z+=be&15,be>>>=4,!(be>>>8&255))q[K++]=be;else{if(be==256)break;be-=257;var Ce=be<8?0:be-4>>2;Ce>5&&(Ce=0);var Ee=K+ee[be];Ce>0&&(Ee+=Nt(I,z,Ce),z+=Ce),oe=Nt(I,z,ne),be=V>>>1==1?co[oe]:xn[oe],z+=be&15,be>>>=4;var we=be<4?0:be-2>>1,$e=J[be];for(we>0&&($e+=Nt(I,z,we),z+=we),!G&&se<Ee&&(q=ia(q,Ee+100),se=q.length);K<Ee;)q[K]=q[K-$e],++K}}}return G?[q,z+7>>>3]:[q.slice(0,K),z+7>>>3]}function Zu(I,G){var z=I.slice(I.l||0),V=pp(z,G);return I.l+=V[1],V[0]}function eh(I,G){if(I)typeof console<"u"&&console.error(G);else throw new Error(G)}function S(I,G){var z=I;Vr(z,0);var V=[],q=[],K={FileIndex:V,FullPaths:q};k(K,{root:G.root});for(var se=z.length-4;(z[se]!=80||z[se+1]!=75||z[se+2]!=5||z[se+3]!=6)&&se>=0;)--se;z.l=se+4,z.l+=4;var me=z.read_shift(2);z.l+=6;var ne=z.read_shift(4);for(z.l=ne,se=0;se<me;++se){z.l+=20;var ae=z.read_shift(4),oe=z.read_shift(4),be=z.read_shift(2),Ce=z.read_shift(2),Ee=z.read_shift(2);z.l+=8;var we=z.read_shift(4),$e=l(z.slice(z.l+be,z.l+be+Ce));z.l+=be+Ce+Ee;var Ue=z.l;z.l=we+4,at(z,ae,oe,K,$e),z.l=Ue}return K}function at(I,G,z,V,q){I.l+=2;var K=I.read_shift(2),se=I.read_shift(2),me=o(I);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var ne=I.read_shift(4),ae=I.read_shift(4),oe=I.read_shift(4),be=I.read_shift(2),Ce=I.read_shift(2),Ee="",we=0;we<be;++we)Ee+=String.fromCharCode(I[I.l++]);if(Ce){var $e=l(I.slice(I.l,I.l+Ce));($e[21589]||{}).mt&&(me=$e[21589].mt),((q||{})[21589]||{}).mt&&(me=q[21589].mt)}I.l+=Ce;var Ue=I.slice(I.l,I.l+ae);switch(se){case 8:Ue=R(I,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var $t=!1;K&8&&(ne=I.read_shift(4),ne==134695760&&(ne=I.read_shift(4),$t=!0),ae=I.read_shift(4),oe=I.read_shift(4)),ae!=G&&eh($t,"Bad compressed size: "+G+" != "+ae),oe!=z&&eh($t,"Bad uncompressed size: "+z+" != "+oe),la(V,Ee,Ue,{unsafe:!0,mt:me})}function yt(I,G){var z=G||{},V=[],q=[],K=fe(1),se=z.compression?8:0,me=0,ne=0,ae=0,oe=0,be=0,Ce=I.FullPaths[0],Ee=Ce,we=I.FileIndex[0],$e=[],Ue=0;for(ne=1;ne<I.FullPaths.length;++ne)if(Ee=I.FullPaths[ne].slice(Ce.length),we=I.FileIndex[ne],!(!we.size||!we.content||Ee=="Sh33tJ5")){var $t=oe,Tt=fe(Ee.length);for(ae=0;ae<Ee.length;++ae)Tt.write_shift(1,Ee.charCodeAt(ae)&127);Tt=Tt.slice(0,Tt.l),$e[be]=xV.buf(we.content,0);var gr=we.content;se==8&&(gr=N(gr)),K=fe(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,me),K.write_shift(2,se),we.mt?i(K,we.mt):K.write_shift(4,0),K.write_shift(-4,$e[be]),K.write_shift(4,gr.length),K.write_shift(4,we.content.length),K.write_shift(2,Tt.length),K.write_shift(2,0),oe+=K.length,V.push(K),oe+=Tt.length,V.push(Tt),oe+=gr.length,V.push(gr),K=fe(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,me),K.write_shift(2,se),K.write_shift(4,0),K.write_shift(-4,$e[be]),K.write_shift(4,gr.length),K.write_shift(4,we.content.length),K.write_shift(2,Tt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,$t),Ue+=K.l,q.push(K),Ue+=Tt.length,q.push(Tt),++be}return K=fe(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,be),K.write_shift(2,be),K.write_shift(4,Ue),K.write_shift(4,oe),K.write_shift(2,0),Pr([Pr(V),Pr(q),K])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function or(I,G){if(I.ctype)return I.ctype;var z=I.name||"",V=z.match(/\.([^\.]+)$/);return V&&mr[V[1]]||G&&(V=(z=G).match(/[\.\\]([^\.\\])+$/),V&&mr[V[1]])?mr[V[1]]:"application/octet-stream"}function uo(I){for(var G=w0(I),z=[],V=0;V<G.length;V+=76)z.push(G.slice(V,V+76));return z.join(`\r
`)+`\r
`}function Ss(I){var G=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var oe=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],V=G.split(`\r
`),q=0;q<V.length;++q){var K=V[q];if(K.length==0){z.push("");continue}for(var se=0;se<K.length;){var me=76,ne=K.slice(se,se+me);ne.charAt(me-1)=="="?me--:ne.charAt(me-2)=="="?me-=2:ne.charAt(me-3)=="="&&(me-=3),ne=K.slice(se,se+me),se+=me,se<K.length&&(ne+="="),z.push(ne)}}return z.join(`\r
`)}function $r(I){for(var G=[],z=0;z<I.length;++z){for(var V=I[z];z<=I.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+I[++z];G.push(V)}for(var q=0;q<G.length;++q)G[q]=G[q].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return ps(G.join(`\r
`))}function Cs(I,G,z){for(var V="",q="",K="",se,me=0;me<10;++me){var ne=G[me];if(!ne||ne.match(/^\s*$/))break;var ae=ne.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":V=ae[2].trim();break;case"content-type":K=ae[2].trim();break;case"content-transfer-encoding":q=ae[2].trim();break}}switch(++me,q.toLowerCase()){case"base64":se=ps(bs(G.slice(me).join("")));break;case"quoted-printable":se=$r(G.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var oe=la(I,V.slice(z.length),se,{unsafe:!0});K&&(oe.ctype=K)}function $s(I,G){if(W(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=G&&G.root||"",V=(Qe&&Buffer.isBuffer(I)?I.toString("binary"):W(I)).split(`\r
`),q=0,K="";for(q=0;q<V.length;++q)if(K=V[q],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),z||(z=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),K.slice(0,z.length)!=z););var se=(V[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var me="--"+(se[1]||""),ne=[],ae=[],oe={FileIndex:ne,FullPaths:ae};k(oe);var be,Ce=0;for(q=0;q<V.length;++q){var Ee=V[q];Ee!==me&&Ee!==me+"--"||(Ce++&&Cs(oe,V.slice(be,q),z),be=q)}return oe}function Ra(I,G){var z=G||{},V=z.boundary||"SheetJS";V="------="+V;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],K=I.FullPaths[0],se=K,me=I.FileIndex[0],ne=1;ne<I.FullPaths.length;++ne)if(se=I.FullPaths[ne].slice(K.length),me=I.FileIndex[ne],!(!me.size||!me.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var ae=me.content,oe=Qe&&Buffer.isBuffer(ae)?ae.toString("binary"):W(ae),be=0,Ce=Math.min(1024,oe.length),Ee=0,we=0;we<=Ce;++we)(Ee=oe.charCodeAt(we))>=32&&Ee<128&&++be;var $e=be>=Ce*4/5;q.push(V),q.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+se),q.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),q.push("Content-Type: "+or(me,se)),q.push(""),q.push($e?Ss(oe):uo(oe))}return q.push(V+`--\r
`),q.join(`\r
`)}function ld(I){var G={};return k(G,I),G}function la(I,G,z,V){var q=V&&V.unsafe;q||k(I);var K=!q&&Ie.find(I,G);if(!K){var se=I.FullPaths[0];G.slice(0,se.length)==se?se=G:(se.slice(-1)!="/"&&(se+="/"),se=(se+G).replace("//","/")),K={name:s(G),type:2},I.FileIndex.push(K),I.FullPaths.push(se),q||Ie.utils.cfb_gc(I)}return K.content=z,K.size=z?z.length:0,V&&(V.CLSID&&(K.clsid=V.CLSID),V.mt&&(K.mt=V.mt),V.ct&&(K.ct=V.ct)),K}function qk(I,G){k(I);var z=Ie.find(I,G);if(z){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==z)return I.FileIndex.splice(V,1),I.FullPaths.splice(V,1),!0}return!1}function mp(I,G,z){k(I);var V=Ie.find(I,G);if(V){for(var q=0;q<I.FileIndex.length;++q)if(I.FileIndex[q]==V)return I.FileIndex[q].name=s(z),I.FullPaths[q]=z,!0}return!1}function gp(I){A(I,!0)}return t.find=F,t.read=T,t.parse=h,t.write=ce,t.writeFile=Z,t.utils={cfb_new:ld,cfb_add:la,cfb_del:qk,cfb_mov:mp,cfb_gc:gp,ReadShift:Vf,CheckField:PD,prep_blob:Vr,bconcat:Pr,use_zlib:D,_deflateRaw:Ge,_inflateRaw:Zu,consts:re},t}();function vV(e){return typeof e=="string"?M1(e):Array.isArray(e)?HU(e):e}function sp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=M1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ci(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([vV(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Tl(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function yV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function er(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function bT(e,t){for(var r=[],n=er(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function R1(e){for(var t=[],r=er(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function I1(e){for(var t=[],r=er(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function bV(e){for(var t=[],r=er(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Hx=new Date(1899,11,30,0,0,0);function kr(e,t){var r=e.getTime(),n=Hx.getTime()+(e.getTimezoneOffset()-Hx.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uD=new Date,_V=Hx.getTime()+(uD.getTimezoneOffset()-Hx.getTimezoneOffset())*6e4,_T=uD.getTimezoneOffset();function N1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+_V),t.getTimezoneOffset()!==_T&&t.setTime(t.getTime()+(t.getTimezoneOffset()-_T)*6e4),t}function wV(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var wT=new Date("2017-02-19T19:06:09.000Z"),hD=isNaN(wT.getFullYear())?new Date("2/19/17"):wT,jV=hD.getFullYear()==2017;function Rt(e,t){var r=new Date(e);if(jV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(hD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Wc(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ci(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ci(ZP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ci(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ci(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function It(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=It(e[r]));return t}function Qt(e,t){for(var r="";r.length<t;)r+=e;return r}function Aa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var kV=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&kV.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var SV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function fD(e){return e?e.content&&e.type?Wc(e.content,!0):e.data?Cf(e.data):e.asNodeBuffer&&Qe?Cf(e.asNodeBuffer().toString("binary")):e.asBinary?Cf(e.asBinary()):e._data&&e._data.getContent?Cf(Wc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function pD(e){if(!e)return null;if(e.data)return dT(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?dT(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function CV(e){return e&&e.name.slice(-4)===".bin"?pD(e):fD(e)}function Vs(e,t){for(var r=e.FullPaths||er(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Yj(e,t){var r=Vs(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function dr(e,t,r){if(!r)return CV(Yj(e,t));if(!t)return null;try{return dr(e,t)}catch{return null}}function ms(e,t,r){if(!r)return fD(Yj(e,t));if(!t)return null;try{return ms(e,t)}catch{return null}}function $V(e,t,r){return pD(Yj(e,t))}function jT(e){for(var t=e.FullPaths||er(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=ao(r):n=WU(r),Ie.utils.cfb_add(e,t,n)}Ie.utils.cfb_add(e,t,r)}else e.file(t,r)}function Qj(){return Ie.utils.cfb_new()}function mD(e,t){switch(t.type){case"base64":return Ie.read(e,{type:"base64"});case"binary":return Ie.read(e,{type:"binary"});case"buffer":case"array":return Ie.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Tf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ir=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,EV=/<[^>]*>/g,mn=ir.match(kT)?kT:EV,AV=/<\w*:/,FV=/<(\/?)\w+:/;function Be(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(TV),l=0,c="",u=0,h="",f="",m=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(h=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(m=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+m,f.length-m),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[g]&&h.slice(l-3,l)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function fi(e){return e.replace(FV,"<$1")}var gD={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Jj=R1(gD),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return gD[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),Zj=/[&<>'"]/g,PV=/[\u0000-\u0008\u000b-\u001f]/g;function kt(e){var t=e+"";return t.replace(Zj,function(r){return Jj[r]}).replace(PV,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ST(e){return kt(e).replace(/ /g,"_x0020_")}var xD=/[\u0000-\u001f]/g;function ek(e){var t=e+"";return t.replace(Zj,function(r){return Jj[r]}).replace(/\n/g,"<br/>").replace(xD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function DV(e){var t=e+"";return t.replace(Zj,function(r){return Jj[r]}).replace(xD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var CT=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function MV(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function By(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function $T(e){var t=bl(2*e.length),r,n,s=1,i=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function TT(e){return ao(e,"binary").toString("utf8")}var lm="foo bar baz",Ct=Qe&&(TT(lm)==By(lm)&&TT||$T(lm)==By(lm)&&$T)||By,ci=Qe?function(e){return ao(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},k0=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),vD=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),OV=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),RV=/<\/?(?:vt:)?variant>/g,IV=/<(?:vt:)([^>]*)>([\s\S]*)</;function ET(e,t){var r=Be(e),n=e.match(OV(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(RV,"").match(IV);o&&s.push({v:Ct(o[2]),t:o[1]})}),s}var yD=/(^\s|\s$|\n)/;function Hr(e,t){return"<"+e+(t.match(yD)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function S0(e){return er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ke(e,t,r){return"<"+e+(r!=null?S0(r):"")+(t!=null?(t.match(yD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function l2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function NV(e,t){switch(typeof e){case"string":var r=ke("vt:lpwstr",kt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ke((e|0)==e?"vt:i4":"vt:r8",kt(String(e)));case"boolean":return ke("vt:bool",e?"true":"false")}if(e instanceof Date)return ke("vt:filetime",l2(e));throw new Error("Unable to serialize "+e)}function tk(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ct(Tl(qj(e)));throw new Error("Bad input format: expected Buffer or string")}var C0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,br={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},td=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function LV(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function zV(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=n?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var AT=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},FT=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ao(t)})):AT(e)}:AT,PT=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Wi(e,s)));return n.join("").replace(An,"")},rk=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(An,""):PT(e,t,r)}:PT,DT=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},bD=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):DT(e,t,r)}:DT,MT=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Pd(e,s)));return n.join("")},ap=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):MT(t,r,n)}:MT,_D=function(e,t){var r=fs(e,t);return r>0?ap(e,t+4,t+4+r-1):""},wD=_D,jD=function(e,t){var r=fs(e,t);return r>0?ap(e,t+4,t+4+r-1):""},kD=jD,SD=function(e,t){var r=2*fs(e,t);return r>0?ap(e,t+4,t+4+r-1):""},CD=SD,$D=function(t,r){var n=fs(t,r);return n>0?rk(t,r+4,r+4+n):""},TD=$D,ED=function(e,t){var r=fs(e,t);return r>0?ap(e,t+4,t+4+r):""},AD=ED,FD=function(e,t){return LV(e,t)},Wx=FD,nk=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(wD=function(t,r){if(!Buffer.isBuffer(t))return _D(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},kD=function(t,r){if(!Buffer.isBuffer(t))return jD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},CD=function(t,r){if(!Buffer.isBuffer(t))return SD(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},TD=function(t,r){if(!Buffer.isBuffer(t))return $D(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},AD=function(t,r){if(!Buffer.isBuffer(t))return ED(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Wx=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FD(t,r)},nk=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Pd=function(e,t){return e[t]},Wi=function(e,t){return e[t+1]*256+e[t]},BV=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fs=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},oc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},UV=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Vf(e,t){var r="",n,s,i=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Wi(this,u)),u+=2;e*=2;break;case"utf8":r=ap(this,this.l,this.l+e);break;case"utf16le":e*=2,r=rk(this,this.l,this.l+e);break;case"wstr":return Vf.call(this,e,"dbcs");case"lpstr-ansi":r=wD(this,this.l),e=4+fs(this,this.l);break;case"lpstr-cp":r=kD(this,this.l),e=4+fs(this,this.l);break;case"lpwstr":r=CD(this,this.l),e=4+2*fs(this,this.l);break;case"lpp4":e=4+fs(this,this.l),r=TD(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fs(this,this.l),r=AD(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Pd(this,this.l+e++))!==0;)i.push(om(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Wi(this,this.l+e))!==0;)i.push(om(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Pd(this,u),this.l=u+1,l=Vf.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(om(Wi(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Pd(this,u),this.l=u+1,l=Vf.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(om(Pd(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Pd(this,this.l),this.l++,n;case 2:return n=(t==="i"?BV:Wi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?oc:UV)(this,this.l),this.l+=4,n):(s=fs(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Wx(this,this.l):s=Wx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=bD(this,this.l,e);break}}return this.l+=e,r}var VV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},HV=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},WV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function GV(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)WV(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,VV(this,t,this.l);break;case 8:if(n=8,r==="f"){zV(this,t,this.l);break}case 16:break;case-4:n=4,HV(this,t,this.l);break}return this.l+=n,this}function PD(e,t){var r=bD(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Vr(e,t){e.l=t,e.read_shift=Vf,e.chk=PD,e.write_shift=GV}function fn(e,t){e.l+=t}function fe(e){var t=bl(e);return Vr(t,0),t}function io(e,t,r){if(e){var n,s,i;Vr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=P0[l]||P0[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;c=e.l+i;var h=u.f&&u.f(e,i,r);if(e.l=c,t(h,u,l))return}}}function ts(){var e=[],t=Qe?256:2048,r=function(u){var h=fe(u);return Vr(h,0),h},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),Pr(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ye(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=P0[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&nk(r)&&e.push(r)}}function Hf(e,t,r){var n=It(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function OT(e,t,r){var n=It(e);return n.s=Hf(n.s,t.s,r),n.e=Hf(n.e,t.s,r),n}function Wf(e,t){if(e.cRel&&e.c<0)for(e=It(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=It(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ze(e);return!e.cRel&&e.cRel!=null&&(r=XV(r)),!e.rRel&&e.rRel!=null&&(r=qV(r)),r}function Uy(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Vt(e.s.c)+":"+(e.e.cRel?"":"$")+Vt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ar(e.s.r)+":"+(e.e.rRel?"":"$")+ar(e.e.r):Wf(e.s,t.biff)+":"+Wf(e.e,t.biff)}function sk(e){return parseInt(KV(e),10)-1}function ar(e){return""+(e+1)}function qV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function KV(e){return e.replace(/\$(\d+)$/,"$1")}function ak(e){for(var t=YV(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Vt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function XV(e){return e.replace(/^([A-Z])/,"$$$1")}function YV(e){return e.replace(/^\$([A-Z])/,"$1")}function QV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ze(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function rs(e){var t=e.indexOf(":");return t==-1?{s:Ht(e),e:Ht(e)}:{s:Ht(e.slice(0,t)),e:Ht(e.slice(t+1))}}function He(e,t){return typeof t>"u"||typeof t=="number"?He(e.s,e.e):(typeof e!="string"&&(e=ze(e)),typeof t!="string"&&(t=ze(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function RT(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ra(e.z,r?kr(t):t)}catch{}try{return e.w=ra((e.XF||{}).numFmtId||(r?14:0),r?kr(t):t)}catch{return""+t}}function no(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?oo[e.v]||e.v:t==null?RT(e,e.v):RT(e,t))}function El(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function DD(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ht(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=ct(i["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(u.e.r=o=h.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var g={v:t[f][m]},v=o+f,x=l+m;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))g=t[f][m];else if(Array.isArray(g.v)&&(g.f=t[f][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||Le[14],n.cellDates?(g.t="d",g.w=ra(g.z,kr(g.v))):(g.t="n",g.v=kr(g.v),g.w=ra(g.z,g.v))):g.t="s";if(s)i[v]||(i[v]=[]),i[v][x]&&i[v][x].z&&(g.z=i[v][x].z),i[v][x]=g;else{var y=ze({c:x,r:v});i[y]&&i[y].z&&(g.z=i[y].z),i[y]=g}}}return u.s.c<1e7&&(i["!ref"]=He(u)),i}function qu(e,t){return DD(null,e,t)}function JV(e){return e.read_shift(4,"i")}function Fa(e,t){return t||(t=fe(4)),t.write_shift(4,e),t}function un(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Dr(e,t){var r=!1;return t==null&&(r=!0,t=fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ZV(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function eH(e,t){return t||(t=fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ik(e,t){var r=e.l,n=e.read_shift(1),s=un(e),i=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(ZV(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function tH(e,t){var r=!1;return t==null&&(r=!0,t=fe(15+4*e.t.length)),t.write_shift(1,0),Dr(e.t,t),r?t.slice(0,t.l):t}var rH=ik;function nH(e,t){var r=!1;return t==null&&(r=!0,t=fe(23+4*e.t.length)),t.write_shift(1,1),Dr(e.t,t),t.write_shift(4,1),eH({},t),r?t.slice(0,t.l):t}function aa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function rd(e,t){return t==null&&(t=fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function nd(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function sd(e,t){return t==null&&(t=fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var sH=un,MD=Dr;function ok(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Gx(e,t){var r=!1;return t==null&&(r=!0,t=fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var aH=un,c2=ok,lk=Gx;function ck(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Wx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):oc(t,0)>>2;return r?s/100:s}function OD(e,t){t==null&&(t=fe(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function RD(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function iH(e,t){return t||(t=fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ad=RD,Ku=iH;function an(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Gc(e,t){return(t||fe(8)).write_shift(8,e,"f")}function oH(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Ac[s];u&&(t.rgb=T0(u));break;case 2:t.rgb=T0([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function qx(e,t){if(t||(t=fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function lH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function cH(e,t){t||(t=fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ID(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function dH(e){return ID(e,1)}function uH(e){return ID(e,2)}var dk=2,Wn=3,cm=11,IT=12,Kx=19,dm=64,hH=65,fH=71,pH=4108,mH=4126,Er=80,ND=81,gH=[Er,ND],d2={1:{n:"CodePage",t:dk},2:{n:"Category",t:Er},3:{n:"PresentationFormat",t:Er},4:{n:"ByteCount",t:Wn},5:{n:"LineCount",t:Wn},6:{n:"ParagraphCount",t:Wn},7:{n:"SlideCount",t:Wn},8:{n:"NoteCount",t:Wn},9:{n:"HiddenCount",t:Wn},10:{n:"MultimediaClipCount",t:Wn},11:{n:"ScaleCrop",t:cm},12:{n:"HeadingPairs",t:pH},13:{n:"TitlesOfParts",t:mH},14:{n:"Manager",t:Er},15:{n:"Company",t:Er},16:{n:"LinksUpToDate",t:cm},17:{n:"CharacterCount",t:Wn},19:{n:"SharedDoc",t:cm},22:{n:"HyperlinksChanged",t:cm},23:{n:"AppVersion",t:Wn,p:"version"},24:{n:"DigSig",t:hH},26:{n:"ContentType",t:Er},27:{n:"ContentStatus",t:Er},28:{n:"Language",t:Er},29:{n:"Version",t:Er},255:{},2147483648:{n:"Locale",t:Kx},2147483651:{n:"Behavior",t:Kx},1919054434:{}},u2={1:{n:"CodePage",t:dk},2:{n:"Title",t:Er},3:{n:"Subject",t:Er},4:{n:"Author",t:Er},5:{n:"Keywords",t:Er},6:{n:"Comments",t:Er},7:{n:"Template",t:Er},8:{n:"LastAuthor",t:Er},9:{n:"RevNumber",t:Er},10:{n:"EditTime",t:dm},11:{n:"LastPrinted",t:dm},12:{n:"CreatedDate",t:dm},13:{n:"ModifiedDate",t:dm},14:{n:"PageCount",t:Wn},15:{n:"WordCount",t:Wn},16:{n:"CharCount",t:Wn},17:{n:"Thumbnail",t:fH},18:{n:"Application",t:Er},19:{n:"DocSecurity",t:Wn},255:{},2147483648:{n:"Locale",t:Kx},2147483651:{n:"Behavior",t:Kx},1919054434:{}},NT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var yH=vH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ac=It(yH),oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},LD={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},h2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},um={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function uk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bH(e){var t=uk();if(!e||!e.match)return t;var r={};if((e.match(mn)||[]).forEach(function(n){var s=Be(n);switch(s[0].replace(AV,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[h2[s.ContentType]]!==void 0&&t[h2[s.ContentType]].push(s.PartName);break}}),t.xmlns!==br.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function zD(e,t){var r=bV(h2),n=[],s;n[n.length]=ir,n[n.length]=ke("Types",null,{xmlns:br.CT,"xmlns:xsd":br.xsd,"xmlns:xsi":br.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ke("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=ke("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:um[c][t.bookType]||um[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:um[c][t.bookType]||um[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Je={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(mn)||[]).forEach(function(s){var i=Be(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Tf(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}function tu(e){var t=[ir,ke("Relationships",null,{xmlns:br.RELS})];return er(e["!id"]).forEach(function(r){t[t.length]=ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function _t(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Je.HLINK,Je.XPATH,Je.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var _H="application/vnd.oasis.opendocument.spreadsheet";function wH(e,t){for(var r=tk(e),n,s;n=C0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Be(n[0],!1),s.path=="/"&&s.type!==_H)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function jH(e){var t=[ir];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function LT(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function kH(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function SH(e){var t=[ir];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(LT(e[r][0],e[r][1])),t.push(kH("",e[r][0]));return t.push(LT("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function BD(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zx.version+"</meta:generator></office:meta></office:document-meta>"}var Js=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CH=function(){for(var e=new Array(Js.length),t=0;t<Js.length;++t){var r=Js[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function UD(e){var t={};e=Ct(e);for(var r=0;r<Js.length;++r){var n=Js[r],s=e.match(CH[r]);s!=null&&s.length>0&&(t[n[1]]=lt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Rt(t[n[1]]))}return t}function Vy(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=kt(t),n[n.length]=r?ke(e,t,r):Hr(e,t))}function VD(e,t){var r=t||{},n=[ir,ke("cp:coreProperties",null,{"xmlns:cp":br.CORE_PROPS,"xmlns:dc":br.dc,"xmlns:dcterms":br.dcterms,"xmlns:dcmitype":br.dcmitype,"xmlns:xsi":br.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Vy("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:l2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Vy("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:l2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Js.length;++i){var o=Js[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Vy(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Fc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],HD=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function WD(e,t,r,n){var s=[];if(typeof e=="string")s=ET(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?ET(t,n).map(function(h){return h.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function $H(e,t,r){var n={};return t||(t={}),e=Ct(e),Fc.forEach(function(s){var i=(e.match(k0(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=lt(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&WD(n.HeadingPairs,n.TitlesOfParts,t,r),t}function GD(e){var t=[],r=ke;return e||(e={}),e.Application="SheetJS",t[t.length]=ir,t[t.length]=ke("Properties",null,{xmlns:br.EXT_PROPS,"xmlns:vt":br.vt}),Fc.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=kt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+kt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var TH=/<[^>]+>[^<]*/g;function EH(e,t){var r={},n="",s=e.match(TH);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Be(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),h=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(h);break;case"bool":r[n]=Mt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Rt(h);break;case"cy":case"error":r[n]=lt(h);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function qD(e){var t=[ir,ke("Properties",null,{xmlns:br.CUST_PROPS,"xmlns:vt":br.vt})];if(!e)return t.join("");var r=1;return er(e).forEach(function(s){++r,t[t.length]=ke("property",NV(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:kt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var f2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hy;function AH(e,t,r){Hy||(Hy=R1(f2)),t=Hy[t]||t,e[t]=r}function FH(e,t){var r=[];return er(f2).map(function(n){for(var s=0;s<Js.length;++s)if(Js[s][1]==n)return Js[s];for(s=0;s<Fc.length;++s)if(Fc[s][1]==n)return Fc[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Hr(f2[n[1]]||n[1],s))}}),ke("DocumentProperties",r.join(""),{xmlns:hs.o})}function PH(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&er(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Js.length;++o)if(i==Js[o][1])return;for(o=0;o<Fc.length;++o)if(i==Fc[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(ke(ST(i),l,{"dt:dt":c}))}}),t&&er(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(ke(ST(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+hs.o+'">'+s.join("")+"</"+n+">"}function hk(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function DH(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=fe(8);return o.write_shift(4,n),o.write_shift(4,s),o}function KD(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function XD(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function YD(e,t,r){return t===31?XD(e):KD(e,t,r)}function p2(e,t,r){return YD(e,t,r===!1?0:4)}function MH(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return YD(e,t,0)}function OH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(An,""),e.l-s&2&&(e.l+=2)}return r}function RH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(An,"");return r}function IH(e){var t=e.l,r=Xx(e,ND);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Xx(e,Wn);return[r,n]}function NH(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(IH(e));return r}function zT(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(An,"").replace($f,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function QD(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function LH(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Xx(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==IT&&n!==t&&gH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===IT?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return KD(e,n,4).replace(An,"");case 31:return XD(e);case 64:return hk(e);case 65:return QD(e);case 71:return LH(e);case 80:return p2(e,n,!i.raw).replace(An,"");case 81:return MH(e,n).replace(An,"");case 4108:return NH(e);case 4126:case 4127:return n==4127?OH(e):RH(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function BT(e,t){var r=fe(4),n=fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=fe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=DH(t);break;case 31:case 80:for(n=fe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Pr([r,n])}function UT(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,u={};for(o=0;o!=s;++o){var h=e.read_shift(4),f=e.read_shift(4);i[o]=[h,f+r]}i.sort(function(b,w){return b[1]-w[1]});var m={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var g=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],g=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],g=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(g=!1,e.l=i[o][1]),g)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[i[o][0]];if(m[v.n]=Xx(e,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sa(l=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(i[o][0]===1){if(l=m.CodePage=Xx(e,dk),Sa(l),c!==-1){var x=e.l;e.l=i[c][1],u=zT(e,l),e.l=x}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}u=zT(e,l)}else{var y=u[i[o][0]],_;switch(e[e.l]){case 65:e.l+=4,_=QD(e);break;case 30:e.l+=4,_=p2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=p2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=rr(e,4);break;case 64:e.l+=4,_=Rt(hk(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[y]=_}}return e.l=r+n,m}var JD=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zH(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function VT(e,t,r){var n=fe(8),s=[],i=[],o=8,l=0,c=fe(8),u=fe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),o+=8+c.length,!t){u=fe(8),u.write_shift(4,0),s.unshift(u);var h=[fe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=fe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Pr(h),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(JD.indexOf(e[l][0])>-1||HD.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],g=0;if(t){g=+t[e[l][0]];var v=r[g];if(v.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}c=BT(v.t,m)}else{var y=zH(m);y==-1&&(y=31,m=String(m)),c=BT(y,m)}i.push(c),u=fe(8),u.write_shift(4,t?g:2+l),s.push(u),o+=8+c.length}var _=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,_),_+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),Pr([n].concat(s).concat(i))}function HT(e,t,r){var n=e.content;if(!n)return{};Vr(n,0);var s,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==Ie.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=UT(n,t),m={SystemIdentifier:u};for(var g in f)m[g]=f[g];if(m.FMTID=i,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=UT(n,null)}catch{}for(g in v)m[g]=v[g];return m.FMTID=[i,o],m}function WT(e,t,r,n,s,i){var o=fe(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ie.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=VT(e,r,n);if(l.push(c),s){var u=VT(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Pr(l)}function _o(e,t){return e.read_shift(t),null}function BH(e,t){t||(t=fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function UH(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function rr(e,t){return e.read_shift(t)===1}function Tn(e,t){return t||(t=fe(2)),t.write_shift(2,+!!e),t}function ur(e){return e.read_shift(2,"u")}function Ws(e,t){return t||(t=fe(2)),t.write_shift(2,e),t}function ZD(e,t){return UH(e,t,ur)}function VH(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function e8(e,t,r){return r||(r=fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ip(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function HH(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function WH(e){var t=e.t||"",r=fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=fe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Pr(s)}function qc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function op(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):qc(e,n,r)}function id(e,t,r){if(r.biff>5)return op(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function t8(e,t,r){return r||(r=fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function GH(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function qH(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(An,"");return n&&(e.l+=24),s}function KH(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(An,"");return r+o}function XH(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return qH(e);case"0303000000000000c000000000000046":return KH(e);default:throw new Error("Unsupported Moniker "+r)}}function hm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(An,""):"";return r}function GT(e,t){t||(t=fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function YH(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,o,l,c,u="",h,f;s&16&&(i=hm(e,r-e.l)),s&128&&(o=hm(e,r-e.l)),(s&257)===257&&(l=hm(e,r-e.l)),(s&257)===1&&(c=XH(e,r-e.l)),s&8&&(u=hm(e,r-e.l)),s&32&&(h=e.read_shift(16)),s&64&&(f=hk(e)),e.l=r;var m=o||l||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return h&&(g.guid=h),f&&(g.time=f),i&&(g.Tooltip=i),g}function QH(e){var t=fe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),GT(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&GT(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function r8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function n8(e,t){var r=r8(e);return r[3]=0,r}function pi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Kc(e,t,r,n){return n||(n=fe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function JH(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ZH(e,t,r){return t===0?"":id(e,t,r)}function eW(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,i,o]}function s8(e){var t=e.read_shift(2),r=ck(e);return[t,r]}function tW(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=ip(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function L1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function a8(e,t){return t||(t=fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function i8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var rW=i8;function o8(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function nW(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sW(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Jr(e){e.l+=2,e.l+=e.read_shift(2)}var aW={0:Jr,4:Jr,5:Jr,6:Jr,7:sW,8:Jr,9:Jr,10:Jr,11:Jr,12:Jr,13:nW,14:Jr,15:Jr,16:Jr,17:Jr,18:Jr,19:Jr,20:Jr,21:o8};function iW(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(aW[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function fm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function fk(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=fe(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function oW(e,t){return t===0||e.read_shift(2),1200}function lW(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=id(e,0,r);return e.read_shift(t+n-e.l),s}function cW(e,t){var r=!t||t.biff==8,n=fe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function dW(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function uW(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=ip(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function hW(e,t){var r=!t||t.biff>=8?2:1,n=fe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function fW(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(HH(e));return i.Count=n,i.Unique=s,i}function pW(e,t){var r=fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=WH(e[s]);var i=Pr([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function mW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function gW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function xW(e){var t=JH(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vW(e){return e.read_shift(2),e.read_shift(4)}function qT(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function yW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function bW(){var e=fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function _W(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function wW(e){var t=fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jW(){}function kW(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ip(e,0,r),n}function SW(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=fe(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function CW(e){var t=pi(e);return t.isst=e.read_shift(4),t}function $W(e,t,r,n){var s=fe(10);return Kc(e,t,n,s),s.write_shift(4,r),s}function TW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=pi(e);r.biff==2&&e.l++;var i=op(e,n-e.l,r);return s.val=i,s}function EW(e,t,r,n,s){var i=!s||s.biff==8,o=fe(8+ +i+(1+i)*r.length);return Kc(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function AW(e,t,r){var n=e.read_shift(2),s=id(e,0,r);return[n,s]}function FW(e,t,r,n){var s=r&&r.biff==5;n||(n=fe(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var PW=id;function KT(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c}}}function DW(e,t){var r=t.biff==8||!t.biff?4:2,n=fe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function MW(e){var t=e.read_shift(2),r=e.read_shift(2),n=s8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function OW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(s8(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function RW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function IW(e,t,r,n){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=xH[l>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function NW(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=IW(e,t,n.fStyle,r),n}function XT(e,t,r,n){var s=r&&r.biff==5;n||(n=fe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function LW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function zW(e){var t=fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function YT(e,t,r){var n=pi(e);(r.biff==2||t==9)&&++e.l;var s=VH(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function BW(e,t,r,n,s,i){var o=fe(8);return Kc(e,t,n,o),e8(r,i,o),o}function UW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=pi(e),s=an(e);return n.val=s,n}function VW(e,t,r,n){var s=fe(14);return Kc(e,t,n,s),Gc(r,s),s}var QT=ZH;function HW(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=qc(e,i),l=[];n>e.l;)l.push(op(e));return[i,s,o,l]}function JT(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=tW(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var WW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ZT(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=qc(e,o,r);s&32&&(u=WW[u.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var f=n==e.l||l===0||!(h>0)?[]:iY(e,h,r,l);return{chKey:i,Name:u,itab:c,rgce:f}}function l8(e,t,r){if(r.biff<8)return GW(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(eW(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function GW(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ip(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function qW(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=qc(e,n,r),o=qc(e,s,r);return[i,o]}function KW(e,t,r){var n=i8(e);e.l++;var s=e.read_shift(1);return t-=8,[oY(e,t,r),s,n]}function eE(e,t,r){var n=rW(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,sY(e,t,r)]}function XW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function YW(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=id(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,i]}}function QW(e,t,r){return YW(e,t,r)}function JW(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(L1(e));return r}function ZW(e){var t=fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)a8(e[r],t);return t}function eG(e,t,r){if(r&&r.biff<8)return rG(e,t,r);var n=o8(e),s=iW(e,t-22,n[1]);return{cmo:n,ft:s}}var tG={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function rG(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((tG[n]||fn)(e,t,r)),{cmo:[s,n,i],ft:o}}function nG(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=GH(e,6,r);var l=e.read_shift(2);e.read_shift(2),ur(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var h=e[e.l],f=qc(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(h?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function sG(e,t){var r=L1(e);e.l+=16;var n=YH(e,t-24);return[r,n]}function aG(e){var t=fe(24),r=Ht(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Pr([t,QH(e[1])])}function iG(e,t){e.read_shift(2);var r=L1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(An,""),[r,n]}function oG(e){var t=e[1].Tooltip,r=fe(10+2*(t.length+1));r.write_shift(2,2048);var n=Ht(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function lG(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=NT[r]||r,r=e.read_shift(2),t[1]=NT[r]||r,t}function cG(e){return e||(e=fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function dG(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n8(e));return r}function uG(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n8(e));return r}function hG(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function c8(e,t,r){if(!r.cellStyles)return fn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function fG(e,t){var r=fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function pG(e,t){var r={};return t<32||(e.l+=16,r.header=an(e),r.footer=an(e),e.l+=2),r}function mG(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function gG(e){for(var t=fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var xG=pi,vG=ZD,yG=op;function bG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function _G(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=pi(e);++e.l;var s=id(e,t-7,r);return n.t="str",n.val=s,n}function wG(e){var t=pi(e);++e.l;var r=an(e);return t.t="n",t.val=r,t}function jG(e,t,r){var n=fe(15);return up(n,e,t),n.write_shift(8,r,"f"),n}function kG(e){var t=pi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function SG(e,t,r){var n=fe(9);return up(n,e,t),n.write_shift(2,r),n}function CG(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function $G(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function TG(e,t,r){var n=e.l+t,s=pi(e),i=e.read_shift(2),o=qc(e,i,r);return e.l=n,s.t="str",s.val=o,s}var EG=[2,3,48,49,131,139,140,245],m2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=R1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],h=bl(1);switch(c.type){case"base64":h=ps(bs(l));break;case"binary":h=ps(l);break;case"buffer":case"array":h=l;break}Vr(h,0);var f=h.read_shift(1),m=!!(f&136),g=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,y=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(y=h.read_shift(2));var _=h.read_shift(2),b=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=e[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var w=[],C={},j=Math.min(h.length,f==2?521:y-10-(g?264:0)),T=v?32:11;h.l<j&&h[h.l]!=13;)switch(C={},C.name=_0.utils.decode(b,h.slice(h.l,h.l+T)).replace(/[\u0000\r\n].*$/g,""),h.l+=T,C.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(C.offset=h.read_shift(4)),C.len=h.read_shift(1),f==2&&(C.offset=h.read_shift(2)),C.dec=h.read_shift(1),C.name.length&&w.push(C),f!=2&&(h.l+=v?13:14),C.type){case"B":(!g||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var k=0,M=0;for(u[0]=[],M=0;M!=w.length;++M)u[0][M]=w[M].name;for(;x-- >0;){if(h[h.l]===42){h.l+=_;continue}for(++h.l,u[++k]=[],M=0,M=0;M!=w.length;++M){var A=h.slice(h.l,h.l+w[M].len);h.l+=w[M].len,Vr(A,0);var O=_0.utils.decode(b,A);switch(w[M].type){case"C":O.trim().length&&(u[k][M]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[k][M]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[k][M]=O;break;case"F":u[k][M]=parseFloat(O.trim());break;case"+":case"I":u[k][M]=v?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[k][M]=!0;break;case"N":case"F":u[k][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][M]="##MEMO##"+(v?parseInt(O.trim(),10):A.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[k][M]=+O||0);break;case"@":u[k][M]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[k][M]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[k][M]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][M]=-A.read_shift(-8,"f");break;case"B":if(g&&w[M].len==8){u[k][M]=A.read_shift(8,"f");break}case"G":case"P":A.l+=w[M].len;break;case"0":if(w[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[M].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var h=qu(r(l,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function s(l,c){try{return El(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Sa(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=ts(),f=Jx(l,{header:1,raw:!0,cellDates:!0}),m=f[0],g=f.slice(1),v=l["!cols"]||[],x=0,y=0,_=0,b=1;for(x=0;x<m.length;++x){if(((v[x]||{}).DBF||{}).name){m[x]=v[x].DBF.name,++_;continue}if(m[x]!=null){if(++_,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(y=0;y<1024;++y)if(m.indexOf(m[x]+"_"+y)==-1){m[x]+="_"+y;break}}}}var w=ct(l["!ref"]),C=[],j=[],T=[];for(x=0;x<=w.e.c-w.s.c;++x){var k="",M="",A=0,O=[];for(y=0;y<g.length;++y)g[y][x]!=null&&O.push(g[y][x]);if(O.length==0||m[x]==null){C[x]="?";continue}for(y=0;y<O.length;++y){switch(typeof O[y]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=O[y]instanceof Date?"D":"C";break;default:M="C"}A=Math.max(A,String(O[y]).length),k=k&&k!=M?"C":M}A>250&&(A=250),M=((v[x]||{}).DBF||{}).type,M=="C"&&v[x].DBF.len>A&&(A=v[x].DBF.len),k=="B"&&M=="N"&&(k="N",T[x]=v[x].DBF.dec,A=v[x].DBF.len),j[x]=k=="C"||M=="N"?A:i[k]||0,b+=j[x],C[x]=k}var F=h.next(32);for(F.write_shift(4,318902576),F.write_shift(4,g.length),F.write_shift(2,296+32*_),F.write_shift(2,b),x=0;x<4;++x)F.write_shift(4,0);for(F.write_shift(4,0|(+t[JP]||3)<<8),x=0,y=0;x<m.length;++x)if(m[x]!=null){var B=h.next(32),L=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,L,"sbcs"),B.write_shift(1,C[x]=="?"?"C":C[x],"sbcs"),B.write_shift(4,y),B.write_shift(1,j[x]||i[C[x]]||0),B.write_shift(1,T[x]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),y+=j[x]||i[C[x]]||0}var U=h.next(264);for(U.write_shift(4,13),x=0;x<65;++x)U.write_shift(4,0);for(x=0;x<g.length;++x){var P=h.next(b);for(P.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(C[y]){case"L":P.write_shift(1,g[x][y]==null?63:g[x][y]?84:70);break;case"B":P.write_shift(8,g[x][y]||0,"f");break;case"N":var Q="0";for(typeof g[x][y]=="number"&&(Q=g[x][y].toFixed(T[y]||0)),_=0;_<j[y]-Q.length;++_)P.write_shift(1,32);P.write_shift(1,Q,"sbcs");break;case"D":g[x][y]?(P.write_shift(4,("0000"+g[x][y].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(g[x][y].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+g[x][y].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var re=String(g[x][y]!=null?g[x][y]:"").slice(0,j[y]);for(P.write_shift(1,re,"sbcs"),_=0;_<j[y]-re.length;++_)P.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),d8=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,g){var v=e[g];return typeof v=="number"?uT(v):v},n=function(m,g,v){var x=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?m:uT(x)};e["|"]=254;function s(m,g){switch(g.type){case"base64":return i(bs(m),g);case"binary":return i(m,g);case"buffer":return i(Qe&&Buffer.isBuffer(m)?m.toString("binary"):Tl(m),g);case"array":return i(Wc(m),g)}throw new Error("Unrecognized type "+g.type)}function i(m,g){var v=m.split(/[\n\r]+/),x=-1,y=-1,_=0,b=0,w=[],C=[],j=null,T={},k=[],M=[],A=[],O=0,F;for(+g.codepage>=0&&Sa(+g.codepage);_!==v.length;++_){O=0;var B=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=B.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),U=L[0],P;if(B.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&C.push(B.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,re=!1,Z=!1,W=!1,ce=-1,te=-1;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"A":break;case"X":y=parseInt(L[b].slice(1))-1,re=!0;break;case"Y":for(x=parseInt(L[b].slice(1))-1,re||(y=0),F=w.length;F<=x;++F)w[F]=[];break;case"K":P=L[b].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(Aa(P))?isNaN(Pu(P).getDate())||(P=Rt(P)):(P=Aa(P),j!==null&&Wu(j)&&(P=N1(P))),Q=!0;break;case"E":W=!0;var D=ru(L[b].slice(1),{r:x,c:y});w[x][y]=[w[x][y],D];break;case"S":Z=!0,w[x][y]=[w[x][y],"S5S"];break;case"G":break;case"R":ce=parseInt(L[b].slice(1))-1;break;case"C":te=parseInt(L[b].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}if(Q&&(w[x][y]&&w[x][y].length==2?w[x][y][0]=P:w[x][y]=P,j=null),Z){if(W)throw new Error("SYLK shared formula cannot have own formula");var R=ce>-1&&w[ce][te];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");w[x][y][1]=T8(R[1],{r:x-ce,c:y-te})}break;case"F":var N=0;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"X":y=parseInt(L[b].slice(1))-1,++N;break;case"Y":for(x=parseInt(L[b].slice(1))-1,F=w.length;F<=x;++F)w[F]=[];break;case"M":O=parseInt(L[b].slice(1))/20;break;case"F":break;case"G":break;case"P":j=C[parseInt(L[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=L[b].slice(1).split(" "),F=parseInt(A[0],10);F<=parseInt(A[1],10);++F)O=parseInt(A[2],10),M[F-1]=O===0?{hidden:!0}:{wch:O},_l(M[F-1]);break;case"C":y=parseInt(L[b].slice(1))-1,M[y]||(M[y]={});break;case"R":x=parseInt(L[b].slice(1))-1,k[x]||(k[x]={}),O>0?(k[x].hpt=O,k[x].hpx=Mu(O)):O===0&&(k[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}N<1&&(j=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}}return k.length>0&&(T["!rows"]=k),M.length>0&&(T["!cols"]=M),g&&g.sheetRows&&(w=w.slice(0,g.sheetRows)),[w,T]}function o(m,g){var v=s(m,g),x=v[0],y=v[1],_=qu(x,g);return er(y).forEach(function(b){_[b]=y[b]}),_}function l(m,g){return El(o(m,g),g)}function c(m,g,v,x){var y="C;Y"+(v+1)+";X"+(x+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+yk(m.f,{r:v,c:x}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(m,g){g.forEach(function(v,x){var y="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=E0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=A0(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function h(m,g){g.forEach(function(v,x){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*F0(v.hpx)+";"),y.length>2&&m.push(y+"R"+(x+1))})}function f(m,g){var v=["ID;PWXL;N;E"],x=[],y=ct(m["!ref"]),_,b=Array.isArray(m),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&h(v,m["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var C=y.s.r;C<=y.e.r;++C)for(var j=y.s.c;j<=y.e.c;++j){var T=ze({r:C,c:j});_=b?(m[C]||[])[j]:m[T],!(!_||_.v==null&&(!_.f||_.F))&&x.push(c(_,m,C,j))}return v.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),u8=function(){function e(i,o){switch(o.type){case"base64":return t(bs(i),o);case"binary":return t(i,o);case"buffer":return t(Qe&&Buffer.isBuffer(i)?i.toString("binary"):Tl(i),o);case"array":return t(Wc(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,u=-1,h=0,f=[];h!==l.length;++h){if(l[h].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=l[h].trim().split(","),g=m[0],v=m[1];++h;for(var x=l[h]||"";(x.match(/["]/g)||[]).length&1&&h<l.length-1;)x+=`
`+l[++h];switch(x=x.trim(),+g){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(Aa(v))?isNaN(Pu(v).getDate())?f[c][u]=v:f[c][u]=Rt(v):f[c][u]=Aa(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return qu(e(i,o),o)}function n(i,o){return El(r(i,o),o)}var s=function(){var i=function(c,u,h,f,m){c.push(u),c.push(h+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,u,h,f){c.push(u+","+h),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],h=ct(c["!ref"]),f,m=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,h.e.r-h.s.r+1,""),i(u,"TUPLES",0,h.e.c-h.s.c+1,""),i(u,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){o(u,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var x=ze({r:g,c:v});if(f=m?(c[g]||[])[v]:c[x],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ra(f.z||Le[14],kr(Rt(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var _=`\r
`,b=u.join(_);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),h8=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var g=f.split(`
`),v=-1,x=-1,y=0,_=[];y!==g.length;++y){var b=g[y].trim().split(":");if(b[0]==="cell"){var w=Ht(b[1]);if(_.length<=w.r)for(v=_.length;v<=w.r;++v)_[v]||(_[v]=[]);switch(v=w.r,x=w.c,b[2]){case"t":_[v][x]=e(b[3]);break;case"v":_[v][x]=+b[3];break;case"vtf":var C=b[b.length-1];case"vtc":switch(b[3]){case"nl":_[v][x]=!!+b[4];break;default:_[v][x]=+b[4];break}b[2]=="vtf"&&(_[v][x]=[_[v][x],C])}}}return m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),_}function n(f,m){return qu(r(f,m),m)}function s(f,m){return El(n(f,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],g=[],v,x="",y=rs(f["!ref"]),_=Array.isArray(f),b=y.s.r;b<=y.e.r;++b)for(var w=y.s.c;w<=y.e.c;++w)if(x=ze({r:b,c:w}),v=_?(f[b]||[])[w]:f[x],!(!v||v.v==null||v.t==="z")){switch(g=["cell",x,"t"],v.t){case"s":case"str":g.push(t(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=t(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var C=kr(Rt(v.v));g[2]="vtc",g[3]="nd",g[4]=""+C,g[5]=v.w||ra(v.z||Le[14],C);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[i,o,l,o,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}}(),Du=function(){function e(h,f,m,g,v){v.raw?f[m][g]=h:h===""||(h==="TRUE"?f[m][g]=!0:h==="FALSE"?f[m][g]=!1:isNaN(Aa(h))?isNaN(Pu(h).getDate())?f[m][g]=h:f[m][g]=Rt(h):f[m][g]=Aa(h))}function t(h,f){var m=f||{},g=[];if(!h||h.length===0)return g;for(var v=h.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var y=10,_=0,b=0;b<=x;++b)_=v[b].indexOf(" "),_==-1?_=v[b].length:_++,y=Math.max(y,_);for(b=0;b<=x;++b){g[b]=[];var w=0;for(e(v[b].slice(0,y).trim(),g,b,w,m),w=1;w<=(v[b].length-y)/10+1;++w)e(v[b].slice(y+(w-1)*10,y+w*10).trim(),g,b,w,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var f={},m=!1,g=0,v=0;g<h.length;++g)(v=h.charCodeAt(g))==34?m=!m:!m&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&v.push([f[g],g]);if(!v.length){f=n;for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&v.push([f[g],g])}return v.sort(function(x,y){return x[0]-y[0]||n[x[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(h,f){var m=f||{},g="",v=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=s(h.slice(0,1024)):m&&m.FS?g=m.FS:g=s(h.slice(0,1024));var y=0,_=0,b=0,w=0,C=0,j=g.charCodeAt(0),T=!1,k=0,M=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var A=m.dateNF!=null?mV(m.dateNF):null;function O(){var F=h.slice(w,C),B={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)B.t="z";else if(m.raw)B.t="s",B.v=F;else if(F.trim().length===0)B.t="s",B.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(B.t="s",B.v=F.slice(2,-1).replace(/""/g,'"')):HK(F)?(B.t="n",B.f=F.slice(1)):(B.t="s",B.v=F);else if(F=="TRUE")B.t="b",B.v=!0;else if(F=="FALSE")B.t="b",B.v=!1;else if(!isNaN(b=Aa(F)))B.t="n",m.cellText!==!1&&(B.w=F),B.v=b;else if(!isNaN(Pu(F).getDate())||A&&F.match(A)){B.z=m.dateNF||Le[14];var L=0;A&&F.match(A)&&(F=gV(F,m.dateNF,F.match(A)||[]),L=1),m.cellDates?(B.t="d",B.v=Rt(F,L)):(B.t="n",B.v=kr(Rt(F,L))),m.cellText!==!1&&(B.w=ra(B.z,B.v instanceof Date?kr(B.v):B.v)),m.cellNF||delete B.z}else B.t="s",B.v=F;if(B.t=="z"||(m.dense?(v[y]||(v[y]=[]),v[y][_]=B):v[ze({c:_,r:y})]=B),w=C+1,M=h.charCodeAt(w),x.e.c<_&&(x.e.c=_),x.e.r<y&&(x.e.r=y),k==j)++_;else if(_=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;C<h.length;++C)switch(k=h.charCodeAt(C)){case 34:M===34&&(T=!T);break;case j:case 10:case 13:if(!T&&O())break e;break}return C-w>0&&O(),v["!ref"]=He(x),v}function o(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,f):qu(t(h,f),f)}function l(h,f){var m="",g=f.type=="string"?[0,0,0,0]:$k(h,f);switch(f.type){case"base64":m=bs(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):f.codepage&&typeof _0<"u"||(m=Qe&&Buffer.isBuffer(h)?h.toString("binary"):Tl(h));break;case"array":m=Wc(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=Ct(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=Ct(m):f.type=="binary"&&typeof _0<"u",m.slice(0,19)=="socialcalc:version:"?h8.to_sheet(f.type=="string"?m:Ct(m),f):o(m,f)}function c(h,f){return El(l(h,f),f)}function u(h){for(var f=[],m=ct(h["!ref"]),g,v=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var y=[],_=m.s.c;_<=m.e.c;++_){var b=ze({r:x,c:_});if(g=v?(h[x]||[])[_]:h[b],!g||g.v==null){y.push("          ");continue}for(var w=(g.w||(no(g),g.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(_===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function AG(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=d8.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Du.to_workbook(e,t)}}var Pc=function(){function e(D,R,N){if(D){Vr(D,D.l||0);for(var H=N.Enum||ce;D.l<D.length;){var ee=D.read_shift(2),J=H[ee]||H[65535],he=D.read_shift(2),ge=D.l+he,xe=J.f&&J.f(D,he,N);if(D.l=ge,R(xe,J,ee))return}}}function t(D,R){switch(R.type){case"base64":return r(ps(bs(D)),R);case"binary":return r(ps(D),R);case"buffer":case"array":return r(D,R)}throw"Unsupported type "+R.type}function r(D,R){if(!D)return D;var N=R||{},H=N.dense?[]:{},ee="Sheet1",J="",he=0,ge={},xe=[],De=[],X={s:{r:0,c:0},e:{r:0,c:0}},rt=N.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)N.Enum=ce,e(D,function(ve,Nt,gn){switch(gn){case 0:N.vers=ve,ve>=4096&&(N.qpro=!0);break;case 6:X=ve;break;case 204:ve&&(J=ve);break;case 222:J=ve;break;case 15:case 51:N.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:gn==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=N.dateNF||Le[14],N.cellDates&&(ve[1].t="d",ve[1].v=N1(ve[1].v))),N.qpro&&ve[3]>he&&(H["!ref"]=He(X),ge[ee]=H,xe.push(ee),H=N.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},he=ve[3],ee=J||"Sheet"+(he+1),J="");var ns=N.dense?(H[ve[0].r]||[])[ve[0].c]:H[ze(ve[0])];if(ns){ns.t=ve[1].t,ns.v=ve[1].v,ve[1].z!=null&&(ns.z=ve[1].z),ve[1].f!=null&&(ns.f=ve[1].f);break}N.dense?(H[ve[0].r]||(H[ve[0].r]=[]),H[ve[0].r][ve[0].c]=ve[1]):H[ze(ve[0])]=ve[1];break}},N);else if(D[2]==26||D[2]==14)N.Enum=te,D[2]==14&&(N.qpro=!0,D.l=0),e(D,function(ve,Nt,gn){switch(gn){case 204:ee=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>he&&(H["!ref"]=He(X),ge[ee]=H,xe.push(ee),H=N.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},he=ve[3],ee="Sheet"+(he+1)),rt>0&&ve[0].r>=rt)break;N.dense?(H[ve[0].r]||(H[ve[0].r]=[]),H[ve[0].r][ve[0].c]=ve[1]):H[ze(ve[0])]=ve[1],X.e.c<ve[0].c&&(X.e.c=ve[0].c),X.e.r<ve[0].r&&(X.e.r=ve[0].r);break;case 27:ve[14e3]&&(De[ve[14e3][0]]=ve[14e3][1]);break;case 1537:De[ve[0]]=ve[1],ve[0]==he&&(ee=ve[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(H["!ref"]=He(X),ge[J||ee]=H,xe.push(J||ee),!De.length)return{SheetNames:xe,Sheets:ge};for(var We={},dt=[],pe=0;pe<De.length;++pe)ge[xe[pe]]?(dt.push(De[pe]||xe[pe]),We[De[pe]]=ge[De[pe]]||ge[xe[pe]]):(dt.push(De[pe]),We[De[pe]]={"!ref":"A1"});return{SheetNames:dt,Sheets:We}}function n(D,R){var N=R||{};if(+N.codepage>=0&&Sa(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var H=ts(),ee=ct(D["!ref"]),J=Array.isArray(D),he=[];Se(H,0,i(1030)),Se(H,6,c(ee));for(var ge=Math.min(ee.e.r,8191),xe=ee.s.r;xe<=ge;++xe)for(var De=ar(xe),X=ee.s.c;X<=ee.e.c;++X){xe===ee.s.r&&(he[X]=Vt(X));var rt=he[X]+De,We=J?(D[xe]||[])[X]:D[rt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Se(H,13,g(xe,X,We.v)):Se(H,14,x(xe,X,We.v));else{var dt=no(We);Se(H,15,f(xe,X,dt.slice(0,239)))}}return Se(H,1),H.end()}function s(D,R){var N=R||{};if(+N.codepage>=0&&Sa(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var H=ts();Se(H,0,o(D));for(var ee=0,J=0;ee<D.SheetNames.length;++ee)(D.Sheets[D.SheetNames[ee]]||{})["!ref"]&&Se(H,27,W(D.SheetNames[ee],J++));var he=0;for(ee=0;ee<D.SheetNames.length;++ee){var ge=D.Sheets[D.SheetNames[ee]];if(!(!ge||!ge["!ref"])){for(var xe=ct(ge["!ref"]),De=Array.isArray(ge),X=[],rt=Math.min(xe.e.r,8191),We=xe.s.r;We<=rt;++We)for(var dt=ar(We),pe=xe.s.c;pe<=xe.e.c;++pe){We===xe.s.r&&(X[pe]=Vt(pe));var ve=X[pe]+dt,Nt=De?(ge[We]||[])[pe]:ge[ve];if(!(!Nt||Nt.t=="z"))if(Nt.t=="n")Se(H,23,O(We,pe,he,Nt.v));else{var gn=no(Nt);Se(H,22,k(We,pe,he,gn.slice(0,239)))}}++he}}return Se(H,1),H.end()}function i(D){var R=fe(2);return R.write_shift(2,D),R}function o(D){var R=fe(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var N=0,H=0,ee=0,J=0;J<D.SheetNames.length;++J){var he=D.SheetNames[J],ge=D.Sheets[he];if(!(!ge||!ge["!ref"])){++ee;var xe=rs(ge["!ref"]);N<xe.e.r&&(N=xe.e.r),H<xe.e.c&&(H=xe.e.c)}}return N>8191&&(N=8191),R.write_shift(2,N),R.write_shift(1,ee),R.write_shift(1,H),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function l(D,R,N){var H={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&N.qpro?(H.s.c=D.read_shift(1),D.l++,H.s.r=D.read_shift(2),H.e.c=D.read_shift(1),D.l++,H.e.r=D.read_shift(2),H):(H.s.c=D.read_shift(2),H.s.r=D.read_shift(2),R==12&&N.qpro&&(D.l+=2),H.e.c=D.read_shift(2),H.e.r=D.read_shift(2),R==12&&N.qpro&&(D.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(D){var R=fe(8);return R.write_shift(2,D.s.c),R.write_shift(2,D.s.r),R.write_shift(2,D.e.c),R.write_shift(2,D.e.r),R}function u(D,R,N){var H=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(H[0].c=D.read_shift(1),H[3]=D.read_shift(1),H[0].r=D.read_shift(2),D.l+=2):(H[2]=D.read_shift(1),H[0].c=D.read_shift(2),H[0].r=D.read_shift(2)),H}function h(D,R,N){var H=D.l+R,ee=u(D,R,N);if(ee[1].t="s",N.vers==20768){D.l++;var J=D.read_shift(1);return ee[1].v=D.read_shift(J,"utf8"),ee}return N.qpro&&D.l++,ee[1].v=D.read_shift(H-D.l,"cstr"),ee}function f(D,R,N){var H=fe(7+N.length);H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,D),H.write_shift(1,39);for(var ee=0;ee<H.length;++ee){var J=N.charCodeAt(ee);H.write_shift(1,J>=128?95:J)}return H.write_shift(1,0),H}function m(D,R,N){var H=u(D,R,N);return H[1].v=D.read_shift(2,"i"),H}function g(D,R,N){var H=fe(7);return H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,D),H.write_shift(2,N,"i"),H}function v(D,R,N){var H=u(D,R,N);return H[1].v=D.read_shift(8,"f"),H}function x(D,R,N){var H=fe(13);return H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,D),H.write_shift(8,N,"f"),H}function y(D,R,N){var H=D.l+R,ee=u(D,R,N);if(ee[1].v=D.read_shift(8,"f"),N.qpro)D.l=H;else{var J=D.read_shift(2);C(D.slice(D.l,D.l+J),ee),D.l+=J}return ee}function _(D,R,N){var H=R&32768;return R&=-32769,R=(H?D:0)+(R>=8192?R-16384:R),(H?"":"$")+(N?Vt(R):ar(R))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(D,R){Vr(D,0);for(var N=[],H=0,ee="",J="",he="",ge="";D.l<D.length;){var xe=D[D.l++];switch(xe){case 0:N.push(D.read_shift(8,"f"));break;case 1:J=_(R[0].c,D.read_shift(2),!0),ee=_(R[0].r,D.read_shift(2),!1),N.push(J+ee);break;case 2:{var De=_(R[0].c,D.read_shift(2),!0),X=_(R[0].r,D.read_shift(2),!1);J=_(R[0].c,D.read_shift(2),!0),ee=_(R[0].r,D.read_shift(2),!1),N.push(De+X+":"+J+ee)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(D.read_shift(2));break;case 6:{for(var rt="";xe=D[D.l++];)rt+=String.fromCharCode(xe);N.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:ge=N.pop(),he=N.pop(),N.push(["AND","OR"][xe-20]+"("+he+","+ge+")");break;default:if(xe<32&&w[xe])ge=N.pop(),he=N.pop(),N.push(he+w[xe]+ge);else if(b[xe]){if(H=b[xe][1],H==69&&(H=D[D.l++]),H>N.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+N.join("|")+"|");return}var We=N.slice(-H);N.length-=H,N.push(b[xe][0]+"("+We.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}N.length==1?R[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function j(D){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=D.read_shift(2),R[3]=D[D.l++],R[0].c=D[D.l++],R}function T(D,R){var N=j(D);return N[1].t="s",N[1].v=D.read_shift(R-4,"cstr"),N}function k(D,R,N,H){var ee=fe(6+H.length);ee.write_shift(2,D),ee.write_shift(1,N),ee.write_shift(1,R),ee.write_shift(1,39);for(var J=0;J<H.length;++J){var he=H.charCodeAt(J);ee.write_shift(1,he>=128?95:he)}return ee.write_shift(1,0),ee}function M(D,R){var N=j(D);N[1].v=D.read_shift(2);var H=N[1].v>>1;if(N[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return N[1].v=H,N}function A(D,R){var N=j(D),H=D.read_shift(4),ee=D.read_shift(4),J=D.read_shift(2);if(J==65535)return H===0&&ee===3221225472?(N[1].t="e",N[1].v=15):H===0&&ee===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var he=J&32768;return J=(J&32767)-16446,N[1].v=(1-he*2)*(ee*Math.pow(2,J+32)+H*Math.pow(2,J)),N}function O(D,R,N,H){var ee=fe(14);if(ee.write_shift(2,D),ee.write_shift(1,N),ee.write_shift(1,R),H==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var J=0,he=0,ge=0,xe=0;return H<0&&(J=1,H=-H),he=Math.log2(H)|0,H/=Math.pow(2,he-31),xe=H>>>0,xe&2147483648||(H/=2,++he,xe=H>>>0),H-=xe,xe|=2147483648,xe>>>=0,H*=Math.pow(2,32),ge=H>>>0,ee.write_shift(4,ge),ee.write_shift(4,xe),he+=16383+(J?32768:0),ee.write_shift(2,he),ee}function F(D,R){var N=A(D);return D.l+=R-14,N}function B(D,R){var N=j(D),H=D.read_shift(4);return N[1].v=H>>6,N}function L(D,R){var N=j(D),H=D.read_shift(8,"f");return N[1].v=H,N}function U(D,R){var N=L(D);return D.l+=R-10,N}function P(D,R){return D[D.l+R-1]==0?D.read_shift(R,"cstr"):""}function Q(D,R){var N=D[D.l++];N>R-1&&(N=R-1);for(var H="";H.length<N;)H+=String.fromCharCode(D[D.l++]);return H}function re(D,R,N){if(!(!N.qpro||R<21)){var H=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ee=D.read_shift(R-21,"cstr");return[H,ee]}}function Z(D,R){for(var N={},H=D.l+R;D.l<H;){var ee=D.read_shift(2);if(ee==14e3){for(N[ee]=[0,""],N[ee][0]=D.read_shift(2);D[D.l];)N[ee][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return N}function W(D,R){var N=fe(5+D.length);N.write_shift(2,14e3),N.write_shift(2,R);for(var H=0;H<D.length;++H){var ee=D.charCodeAt(H);N[N.l++]=ee>127?95:ee}return N[N.l++]=0,N}var ce={0:{n:"BOF",f:ur},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function FG(e){var t={},r=e.match(mn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Be(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Hj[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var PG=function(){var e=k0("t"),t=k0("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:lt(o[1])},c=i.match(t);return c&&(l.s=FG(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),DG=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),MG=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,OG=/<(?:\w+:)?r>/,RG=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function pk(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(Ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ct(e),r&&(n.h=ek(n.t))):e.match(OG)&&(n.r=Ct(e),n.t=lt(Ct((e.replace(RG,"").match(MG)||[]).join("").replace(mn,""))),r&&(n.h=DG(PG(n.r)))),n):{t:""}}var IG=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,NG=/<(?:\w+:)?(?:si|sstItem)>/g,LG=/<\/(?:\w+:)?(?:si|sstItem)>/;function zG(e,t){var r=[],n="";if(!e)return r;var s=e.match(IG);if(s){n=s[2].replace(NG,"").split(LG);for(var i=0;i!=n.length;++i){var o=pk(n[i].trim(),t);o!=null&&(r[r.length]=o)}s=Be(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var BG=/^\s|\s$|[\t\n\r]/;function f8(e,t){if(!t.bookSST)return"";var r=[ir];r[r.length]=ke("sst",null,{xmlns:td[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(BG)&&(i+=' xml:space="preserve"'),i+=">"+kt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function UG(e){return[e.read_shift(4),e.read_shift(4)]}function VG(e,t){var r=[],n=!1;return io(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function HG(e,t){return t||(t=fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var WG=tH;function GG(e){var t=ts();ye(t,159,HG(e));for(var r=0;r<e.length;++r)ye(t,19,WG(e[r]));return ye(t,160),t.end()}function p8(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Qi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function qG(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Qi(e,4),t.U=Qi(e,4),t.W=Qi(e,4),t}function KG(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function XG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(KG(e));return t}function YG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function QG(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Qi(e,4),t.U=Qi(e,4),t.W=Qi(e,4),t}function JG(e){var t=QG(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function m8(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function g8(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function ZG(e){var t=Qi(e);switch(t.Minor){case 2:return[t.Minor,eq(e)];case 3:return[t.Minor,tq()];case 4:return[t.Minor,rq(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function eq(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=m8(e,r),s=g8(e,e.length-e.l);return{t:"Std",h:n,v:s}}function tq(){throw new Error("File is password-protected: ECMA-376 Extensible")}function rq(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(mn,function(i){var o=Be(i);switch(fi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function nq(e,t){var r={},n=r.EncryptionVersionInfo=Qi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=m8(e,s),t-=s,r.EncryptionVerifier=g8(e,t),r}function sq(e){var t={},r=t.EncryptionVersionInfo=Qi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function mk(e){var t=0,r,n=p8(e),s=n.length+1,i,o,l,c,u;for(r=bl(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var x8=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var h=o[u],f=0;f!=7;++f)h&64&&(l^=r[c]),h*=2,--c;return l};return function(o){for(var l=p8(o),c=i(l),u=l.length,h=bl(16),f=0;f!=16;++f)h[f]=0;var m,g,v;for((u&1)===1&&(m=c>>8,h[u]=s(e[0],m),--u,m=c&255,g=l[l.length-1],h[u]=s(g,m));u>0;)--u,m=c>>8,h[u]=s(l[u],m),--u,m=c&255,h[u]=s(l[u],m);for(u=15,v=15-l.length;v>0;)m=c>>8,h[u]=s(e[v],m),--u,--v,m=c&255,h[u]=s(l[u],m),--u,--v;return h}}(),aq=function(e,t,r,n,s){s||(s=t),n||(n=x8(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},iq=function(e){var t=0,r=x8(e);return function(n){var s=aq("",n,t,r);return t=s[1],s[0]}};function oq(e,t,r,n){var s={key:ur(e),verificationBytes:ur(e)};return r.password&&(s.verifier=mk(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=iq(r.password)),s}function lq(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=sq(e):n.Data=nq(e,t),n}function cq(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?lq(e,t-2,n):oq(e,r.biff>=8?t:t-2,r,n),n}var v8=function(){function e(s,i){switch(i.type){case"base64":return t(bs(s),i);case"binary":return t(s,i);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Tl(s),i);case"array":return t(Wc(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,g=0,v,x=-1;v=m.exec(h);){switch(v[0]){case"\\cell":var y=h.slice(g,m.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var _={v:y,t:"s"};Array.isArray(l)?l[f][x]=_:l[ze({r:f,c:x})]=_}break}g=m.lastIndex}x>u.e.c&&(u.e.c=x)}),l["!ref"]=He(u),l}function r(s,i){return El(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=ct(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var f=ze({r:u,c:h});l=c?(s[u]||[])[h]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(no(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function dq(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function T0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function uq(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,u=s+i;switch(c=o/(u>1?2-u:u),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function hq(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function Yx(e,t){if(t===0)return e;var r=uq(dq(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),T0(hq(r))}var y8=6,fq=15,pq=1,nn=y8;function E0(e){return Math.floor((e+Math.round(128/nn)/256)*nn)}function A0(e){return Math.floor((e-5)/nn*100+.5)/100}function Qx(e){return Math.round((e*nn+5)/nn*256)/256}function Wy(e){return Qx(A0(E0(e)))}function gk(e){var t=Math.abs(e-Wy(e)),r=nn;if(t>.005)for(nn=pq;nn<fq;++nn)Math.abs(e-Wy(e))<=t&&(t=Math.abs(e-Wy(e)),r=nn);nn=r}function _l(e){e.width?(e.wpx=E0(e.width),e.wch=A0(e.wpx),e.MDW=nn):e.wpx?(e.wch=A0(e.wpx),e.width=Qx(e.wch),e.MDW=nn):typeof e.wch=="number"&&(e.width=Qx(e.wch),e.wpx=E0(e.width),e.MDW=nn),e.customWidth&&delete e.customWidth}var mq=96,b8=mq;function F0(e){return e*96/b8}function Mu(e){return e*b8/96}var gq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xq(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(mn)||[]).forEach(function(o){var l=Be(o);switch(fi(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Mt(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Mt(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function vq(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(mn)||[]).forEach(function(o){var l=Be(o);switch(fi(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function yq(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(mn)||[]).forEach(function(o){var l=Be(o);switch(fi(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Ct(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Mt(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Mt(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Mt(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Mt(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Mt(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Mt(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Mt(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Hj[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Mt(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Ac[s.color.index];s.color.index==81&&(c=Ac[1]),c||(c=Ac[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Yx(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function bq(e,t,r){t.NumberFmt=[];for(var n=er(Le),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Le[n[s]];var i=e[0].match(mn);if(i)for(s=0;s<i.length;++s){var o=Be(i[s]);switch(fi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=lt(Ct(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Yi(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function _q(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ke("numFmt",null,{numFmtId:n,formatCode:kt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var pm=["numFmtId","fillId","fontId","borderId","xfId"],mm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function wq(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(mn)||[]).forEach(function(i){var o=Be(i),l=0;switch(fi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<pm.length;++l)n[pm[l]]&&(n[pm[l]]=parseInt(n[pm[l]],10));for(l=0;l<mm.length;++l)n[mm[l]]&&(n[mm[l]]=Mt(n[mm[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Mt(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function jq(e){var t=[];return t[t.length]=ke("cellXfs",null),e.forEach(function(r){t[t.length]=ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var kq=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&bq(f,h,u),(f=l.match(s))&&yq(f,h,c,u),(f=l.match(n))&&vq(f,h,c,u),(f=l.match(i))&&xq(f,h,c,u),(f=l.match(r))&&wq(f,h,u),h}}();function _8(e,t){var r=[ir,ke("styleSheet",null,{xmlns:td[0],"xmlns:vt":br.vt})],n;return e.SSF&&(n=_q(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Sq(e,t){var r=e.read_shift(2),n=un(e);return[r,n]}function Cq(e,t,r){r||(r=fe(6+4*t.length)),r.write_shift(2,e),Dr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function $q(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=lH(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=oH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=un(e),n}function Tq(e,t){t||(t=fe(25+4*32)),t.write_shift(2,e.sz*20),cH(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),qx(e.color,t);var n=0;return n=2,t.write_shift(1,n),Dr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Eq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gy,Aq=fn;function tE(e,t){t||(t=fe(4*3+8*7+16*1)),Gy||(Gy=R1(Eq));var r=Gy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(qx({auto:1},t),qx({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Fq(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function w8(e,t,r){r||(r=fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Th(e,t){return t||(t=fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Pq=fn;function Dq(e,t){return t||(t=fe(51)),t.write_shift(1,0),Th(null,t),Th(null,t),Th(null,t),Th(null,t),Th(null,t),t.length>t.l?t.slice(0,t.l):t}function Mq(e,t){return t||(t=fe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Gx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Oq(e,t,r){var n=fe(2052);return n.write_shift(4,e),Gx(t,n),Gx(r,n),n.length>n.l?n.slice(0,n.l):n}function Rq(e,t,r){var n={};n.NumberFmt=[];for(var s in Le)n.NumberFmt[s]=Le[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return io(e,function(c,u,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],Yi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Yx(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(h);else if(u.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function Iq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ye(e,615,Fa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ye(e,44,Cq(s,t[s]))}),ye(e,616))}}function Nq(e){var t=1;ye(e,611,Fa(t)),ye(e,43,Tq({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(e,612)}function Lq(e){var t=2;ye(e,603,Fa(t)),ye(e,45,tE({patternType:"none"})),ye(e,45,tE({patternType:"gray125"})),ye(e,604)}function zq(e){var t=1;ye(e,613,Fa(t)),ye(e,46,Dq()),ye(e,614)}function Bq(e){var t=1;ye(e,626,Fa(t)),ye(e,47,w8({numFmtId:0},65535)),ye(e,627)}function Uq(e,t){ye(e,617,Fa(t.length)),t.forEach(function(r){ye(e,47,w8(r,0))}),ye(e,618)}function Vq(e){var t=1;ye(e,619,Fa(t)),ye(e,48,Mq({xfId:0,name:"Normal"})),ye(e,620)}function Hq(e){var t=0;ye(e,505,Fa(t)),ye(e,506)}function Wq(e){var t=0;ye(e,508,Oq(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function Gq(e,t){var r=ts();return ye(r,278),Iq(r,e.SSF),Nq(r),Lq(r),zq(r),Bq(r),Uq(r,t.cellXfs),Vq(r),Hq(r),Wq(r),ye(r,279),r.end()}var qq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Kq(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(mn)||[]).forEach(function(s){var i=Be(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[qq.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Xq(){}function Yq(){}var Qq=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jq=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Zq=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eK(e,t,r){t.themeElements={};var n;[["clrScheme",Qq,Kq],["fontScheme",Jq,Xq],["fmtScheme",Zq,Yq]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var tK=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function j8(e,t){(!e||e.length===0)&&(e=xk());var r,n={};if(!(r=e.match(tK)))throw new Error("themeElements not found in theme");return eK(r[0],n,t),n.raw=e,n}function xk(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ir];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rK(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=mD(i,{type:"array"})}catch{return}var l=ms(o,"theme/theme/theme1.xml",!0);if(l)return j8(l,r)}}function nK(e){return e.read_shift(4)}function sK(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=aK(e,4);break;case 2:t.xclrValue=r8(e);break;case 3:t.xclrValue=nK(e);break;case 4:e.l+=4;break}return e.l+=8,t}function aK(e,t){return fn(e,t)}function iK(e,t){return fn(e,t)}function oK(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sK(e);break;case 6:n[1]=iK(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function lK(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(oK(e,r-e.l));return{ixfe:n,ext:i}}function cK(e,t){t.forEach(function(r){switch(r[0]){}})}function dK(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:un(e)}}function uK(e){var t=fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Dr(e.name,t),t.slice(0,t.l)}function hK(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fK(e){var t=fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function pK(e,t){var r=fe(8+2*t.length);return r.write_shift(4,e),Dr(t,r),r.slice(0,r.l)}function mK(e){return e.l+=4,e.read_shift(4)!=0}function gK(e,t){var r=fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function xK(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return io(e,function(c,u,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function vK(){var e=ts();return ye(e,332),ye(e,334,Fa(1)),ye(e,335,uK({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,pK(1,"XLDAPR")),ye(e,52),ye(e,35,Fa(514)),ye(e,4096,Fa(0)),ye(e,4097,Ws(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,gK(1)),ye(e,51,fK([[1,0]])),ye(e,338),ye(e,333),e.end()}function yK(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,o;return e.replace(mn,function(l){var c=Be(l);switch(fi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function k8(){var e=[ir];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function bK(e){var t=[];if(!e)return t;var r=1;return(e.match(mn)||[]).forEach(function(n){var s=Be(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function _K(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ze(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function wK(e,t,r){var n=[];return io(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function jK(e,t,r,n){if(!e)return e;var s=n||{},i=!1;io(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function kK(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gd=1024;function S8(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ke("xml",null,{"xmlns:v":hs.v,"xmlns:o":hs.o,"xmlns:x":hs.x,"xmlns:mv":hs.mv}).replace(/\/>/,">"),ke("o:shapelayout",ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ke("v:shapetype",[ke("v:stroke",null,{joinstyle:"miter"}),ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gd<e*1e3;)Gd+=1e3;return t.forEach(function(i){var o=Ht(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ke("v:fill",c,l),h={on:"t",obscured:"t"};++Gd,s=s.concat(["<v:shape"+S0({id:"_x0000_s"+Gd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ke("v:shadow",null,h),ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Hr("x:AutoFill","False"),Hr("x:Row",String(o.r)),Hr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function rE(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(o){var l=Ht(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=ct(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=He(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}i.c.push(h)})}function SK(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Be(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ht(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&pk(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function C8(e){var t=[ir,ke("comments",null,{xmlns:td[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=kt(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(kt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Hr("t",kt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Hr("t",kt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function CK(e,t){var r=[],n=!1,s={},i=0;return e.replace(mn,function(l,c){var u=Be(l);switch(fi(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function $K(e,t,r){var n=[ir,ke("ThreadedComments",null,{xmlns:br.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ke("threadedComment",Hr("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function TK(e,t){var r=[],n=!1;return e.replace(mn,function(i){var o=Be(i);switch(fi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function EK(e){var t=[ir,ke("personList",null,{xmlns:br.TCMNT,"xmlns:x":td[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function AK(e){var t={};t.iauthor=e.read_shift(4);var r=ad(e);return t.rfx=r.s,t.ref=ze(r.s),e.l+=16,t}function FK(e,t){return t==null&&(t=fe(36)),t.write_shift(4,e[1].iauthor),Ku(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var PK=un;function DK(e){return Dr(e.slice(0,54))}function MK(e,t){var r=[],n=[],s={},i=!1;return io(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function OK(e){var t=ts(),r=[];return ye(t,628),ye(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ye(t,632,DK(s.a)))})}),ye(t,631),ye(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Ht(n[0]),e:Ht(n[0])};ye(t,635,FK([i,s])),s.t&&s.t.length>0&&ye(t,637,nH(s)),ye(t,636),delete s.iauthor})}),ye(t,634),ye(t,629),t.end()}var RK="application/vnd.ms-office.vbaProject";function IK(e){var t=Ie.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ie.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Ie.write(t)}function NK(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ie.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var $8=["xlsb","xlsm","xlam","biff8","xla"];function LK(){return{"!type":"dialog"}}function zK(){return{"!type":"dialog"}}function BK(){return{"!type":"macro"}}function UK(){return{"!type":"macro"}}var ru=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,c?u+=t.r:--u,s+(l?"":"$")+Vt(h)+(c?"":"$")+ar(u)}return function(s,i){return t=i,s.replace(e,r)}}(),vk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yk=function(){return function(t,r){return t.replace(vk,function(n,s,i,o,l,c){var u=ak(o)-(i?0:r.c),h=sk(c)-(l?0:r.r),f=h==0?"":l?h+1:"["+h+"]",m=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+m})}}();function T8(e,t){return e.replace(vk,function(r,n,s,i,o,l){return n+(s=="$"?s+i:Vt(ak(i)+t.c))+(o=="$"?o+l:ar(sk(l)+t.r))})}function VK(e,t,r){var n=rs(t),s=n.s,i=Ht(r),o={r:i.r-s.r,c:i.c-s.c};return T8(e,o)}function HK(e){return e.length!=1}function nE(e){return e.replace(/_xlfn\./g,"")}function cr(e){e.l+=1}function wl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function E8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return A8(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),o=wl(e),l=wl(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function A8(e){var t=wl(e),r=wl(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function WK(e,t,r){if(r.biff<8)return A8(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=wl(e),o=wl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function F8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return GK(e);var n=e.read_shift(r&&r.biff==12?4:2),s=wl(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function GK(e){var t=wl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function qK(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function KK(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return XK(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function XK(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function YK(e,t,r){var n=(e[e.l++]&96)>>5,s=E8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function QK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=E8(e,i,r);return[n,s,o]}function JK(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ZK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function eX(e,t,r){var n=(e[e.l++]&96)>>5,s=WK(e,t-1,r);return[n,s]}function tX(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function sE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function rX(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function nX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function sX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function aX(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iX(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function P8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function oX(e){return e.read_shift(2),P8(e)}function lX(e){return e.read_shift(2),P8(e)}function cX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=F8(e,0,r);return[n,s]}function dX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=KK(e,0,r);return[n,s]}function uX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=F8(e,0,r);return[n,s,i]}function hX(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[mY[s],O8[s],n]}function fX(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:pX(e);return[s,(i[0]===0?O8:pY)[i[1]]]}function pX(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function mX(e,t,r){e.l+=r&&r.biff==2?3:4}function gX(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function xX(e){return e.l++,oo[e.read_shift(1)]}function vX(e){return e.l++,e.read_shift(2)}function yX(e){return e.l++,e.read_shift(1)!==0}function bX(e){return e.l++,an(e)}function _X(e,t,r){return e.l++,ip(e,t-1,r)}function wX(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=rr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=oo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=an(e);break;case 2:r[1]=id(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jX(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?ad:L1)(e));return s}function kX(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=wX(e,r.biff);return o}function SX(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function CX(e,t,r){if(r.biff==5)return $X(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function $X(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function TX(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function EX(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function AX(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function FX(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var PX=fn,DX=fn,MX=fn;function lp(e,t,r){return e.l+=2,[qK(e)]}function bk(e){return e.l+=6,[]}var OX=lp,RX=bk,IX=bk,NX=lp;function D8(e){return e.l+=2,[ur(e),e.read_shift(2)&1]}var LX=lp,zX=D8,BX=bk,UX=lp,VX=lp,HX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=HX[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:i}}function GX(e){return e.l+=2,[e.read_shift(4)]}function qX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function KX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function XX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function QX(e){return e.l+=4,[0,0]}var aE={1:{n:"PtgExp",f:gX},2:{n:"PtgTbl",f:MX},3:{n:"PtgAdd",f:cr},4:{n:"PtgSub",f:cr},5:{n:"PtgMul",f:cr},6:{n:"PtgDiv",f:cr},7:{n:"PtgPower",f:cr},8:{n:"PtgConcat",f:cr},9:{n:"PtgLt",f:cr},10:{n:"PtgLe",f:cr},11:{n:"PtgEq",f:cr},12:{n:"PtgGe",f:cr},13:{n:"PtgGt",f:cr},14:{n:"PtgNe",f:cr},15:{n:"PtgIsect",f:cr},16:{n:"PtgUnion",f:cr},17:{n:"PtgRange",f:cr},18:{n:"PtgUplus",f:cr},19:{n:"PtgUminus",f:cr},20:{n:"PtgPercent",f:cr},21:{n:"PtgParen",f:cr},22:{n:"PtgMissArg",f:cr},23:{n:"PtgStr",f:_X},26:{n:"PtgSheet",f:qX},27:{n:"PtgEndSheet",f:KX},28:{n:"PtgErr",f:xX},29:{n:"PtgBool",f:yX},30:{n:"PtgInt",f:vX},31:{n:"PtgNum",f:bX},32:{n:"PtgArray",f:tX},33:{n:"PtgFunc",f:hX},34:{n:"PtgFuncVar",f:fX},35:{n:"PtgName",f:SX},36:{n:"PtgRef",f:cX},37:{n:"PtgArea",f:YK},38:{n:"PtgMemArea",f:TX},39:{n:"PtgMemErr",f:PX},40:{n:"PtgMemNoMem",f:DX},41:{n:"PtgMemFunc",f:EX},42:{n:"PtgRefErr",f:AX},43:{n:"PtgAreaErr",f:JK},44:{n:"PtgRefN",f:dX},45:{n:"PtgAreaN",f:eX},46:{n:"PtgMemAreaN",f:XX},47:{n:"PtgMemNoMemN",f:YX},57:{n:"PtgNameX",f:CX},58:{n:"PtgRef3d",f:uX},59:{n:"PtgArea3d",f:QK},60:{n:"PtgRefErr3d",f:FX},61:{n:"PtgAreaErr3d",f:ZK},255:{}},JX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZX={1:{n:"PtgElfLel",f:D8},2:{n:"PtgElfRw",f:UX},3:{n:"PtgElfCol",f:OX},6:{n:"PtgElfRwV",f:VX},7:{n:"PtgElfColV",f:NX},10:{n:"PtgElfRadical",f:LX},11:{n:"PtgElfRadicalS",f:BX},13:{n:"PtgElfColS",f:RX},15:{n:"PtgElfColSV",f:IX},16:{n:"PtgElfRadicalLel",f:zX},25:{n:"PtgList",f:WX},29:{n:"PtgSxName",f:GX},255:{}},eY={0:{n:"PtgAttrNoop",f:QX},1:{n:"PtgAttrSemi",f:iX},2:{n:"PtgAttrIf",f:sX},4:{n:"PtgAttrChoose",f:rX},8:{n:"PtgAttrGoto",f:nX},16:{n:"PtgAttrSum",f:mX},32:{n:"PtgAttrBaxcel",f:sE},33:{n:"PtgAttrBaxcel",f:sE},64:{n:"PtgAttrSpace",f:oX},65:{n:"PtgAttrSpaceSemi",f:lX},128:{n:"PtgAttrIfError",f:aX},255:{}};function cp(e,t,r,n){if(n.biff<8)return fn(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=kX(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=jX(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(fn(e,t)),i}function dp(e,t,r){for(var n=e.l+t,s,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],s=aE[i]||aE[JX[i]],(i===24||i===25)&&(s=(i===24?ZX:eY)[e[e.l+1]]),!s||!s.f?fn(e,t):o.push([s.n,s.f(e,t,r)]);return o}function tY(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var rY={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nY(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function M8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function iE(e,t,r){var n=M8(e,t,r);return n=="#REF"?n:nY(n,r)}function tn(e,t,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,u,h,f=0,m=0,g,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,y="",_=0,b=e[0].length;_<b;++_){var w=e[0][_];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:y=Qt(" ",e[0][x][1][1]);break;case 1:y=Qt("\r",e[0][x][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+y,x=-1}l.push(u+rY[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Hf(w[1][1],o,s),l.push(Wf(h,i));break;case"PtgRefN":h=r?Hf(w[1][1],r,s):w[1][1],l.push(Wf(h,i));break;case"PtgRef3d":f=w[1][1],h=Hf(w[1][2],o,s),v=iE(n,f,s),l.push(v+"!"+Wf(h,i));break;case"PtgFunc":case"PtgFuncVar":var C=w[1][0],j=w[1][1];C||(C=0),C&=127;var T=C==0?[]:l.slice(-C);l.length-=C,j==="User"&&(j=T.shift()),l.push(j+"("+T.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":g=OT(w[1][1],r?{s:r}:o,s),l.push(Uy(g,s));break;case"PtgArea":g=OT(w[1][1],o,s),l.push(Uy(g,s));break;case"PtgArea3d":f=w[1][1],g=w[1][2],v=iE(n,f,s),l.push(v+"!"+Uy(g,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=w[1][2];var k=(n.names||[])[m-1]||(n[0]||[])[m],M=k?k.Name:"SH33TJSNAME"+String(m);M&&M.slice(0,6)=="_xlfn."&&!s.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var A=w[1][1];m=w[1][2];var O;if(s.biff<=5)A<0&&(A=-A),n[A]&&(O=n[A][m]);else{var F="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][m]&&n[A][m].itab>0&&(F=n.SheetNames[n[A][m].itab-1]+"!"):F=n.SheetNames[m-1]+"!"),n[A]&&n[A][m])F+=n[A][m].Name;else if(n[0]&&n[0][m])F+=n[0][m].Name;else{var B=(M8(n,A,s)||"").split(";;");B[m-1]?F=B[m-1]:F+="SH33TJSERRX"}l.push(F);break}O||(O={Name:"SH33TJSERRY"}),l.push(O.Name);break;case"PtgParen":var L="(",U=")";if(x>=0){switch(y="",e[0][x][1][0]){case 2:L=Qt(" ",e[0][x][1][1])+L;break;case 3:L=Qt("\r",e[0][x][1][1])+L;break;case 4:U=Qt(" ",e[0][x][1][1])+U;break;case 5:U=Qt("\r",e[0][x][1][1])+U;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(L+l.pop()+U);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:w[1][1],r:w[1][0]};var P={c:r.c,r:r.r};if(n.sharedf[ze(h)]){var Q=n.sharedf[ze(h)];l.push(tn(Q,o,P,n,s))}else{var re=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){l.push(tn(u[1],o,P,n,s)),re=!0;break}re||l.push(w[1])}break;case"PtgArray":l.push("{"+tY(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&Z.indexOf(e[0][_][0])==-1){w=e[0][x];var W=!0;switch(w[1][0]){case 4:W=!1;case 0:y=Qt(" ",w[1][1]);break;case 5:W=!1;case 1:y=Qt("\r",w[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((W?y:"")+l.pop()+(W?"":y)),x=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function sY(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],fn(e,t-2)];var l=dp(e,o,r);return t!==o+s&&(i=cp(e,t-o-s,l,r)),e.l=n,[l,i]}function aY(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],fn(e,t-2)];var l=dp(e,o,r);return t!==o+s&&(i=cp(e,t-o-s,l,r)),e.l=n,[l,i]}function iY(e,t,r,n){var s=e.l+t,i=dp(e,n,r),o;return s!==e.l&&(o=cp(e,s-e.l,i,r)),[i,o]}function oY(e,t,r){var n=e.l+t,s,i=e.read_shift(2),o=dp(e,i,r);return i==65535?[[],fn(e,t-2)]:(t!==i+2&&(s=cp(e,n-i-2,o,r)),[o,s])}function lY(e){var t;if(Wi(e,e.l+6)!==65535)return[an(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function cY(e){if(e==null){var t=fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Gc(e);return Gc(0)}function qy(e,t,r){var n=e.l+t,s=pi(e);r.biff==2&&++e.l;var i=lY(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=aY(e,n-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function dY(e,t,r,n,s){var i=Kc(t,r,s),o=cY(e.v),l=fe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=fe(e.bf.length),h=0;h<e.bf.length;++h)u[h]=e.bf[h];var f=Pr([i,o,l,u]);return f}function z1(e,t,r){var n=e.read_shift(4),s=dp(e,n,r),i=e.read_shift(4),o=i>0?cp(e,i,s,r):null;return[s,o]}var uY=z1,B1=z1,hY=z1,fY=z1,pY={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},O8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mY={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gY(e){var t="of:="+e.replace(vk,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ky(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function xY(e){return e.replace(/\./,"!")}var qf={},nu={},Kf=typeof Map<"u";function _k(e,t,r){var n=0,s=e.length;if(r){if(Kf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Kf?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Kf?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function U1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(nn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=A0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Qx(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Dc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Al(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Yi(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function R8(e,t,r,n,s,i){try{n.cellNF&&(e.z=Le[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Rt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Le[t]==null&&Yi(pV[t]||"General",t),e.t==="e")e.w=e.w||oo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=j0(e.v);else if(e.t==="d"){var o=kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=j0(o)}else{if(e.v===void 0)return"";e.w=Hc(e.v,nu)}else e.t==="d"?e.w=ra(t,kr(e.v),nu):e.w=ra(t,e.v,nu)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Yx(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Yx(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function vY(e,t,r){if(e&&e["!ref"]){var n=ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function yY(e,t){var r=ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=He(r))}var bY=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_Y=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,wY=/<(?:\w:)?hyperlink [^>]*>/mg,jY=/"(\w*:\w*)"/,kY=/<(?:\w:)?col\b[^>]*[\/]?>/g,SY=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,CY=/<(?:\w:)?pageMargins[^>]*\/>/g,I8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$Y=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,TY=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function EY(e,t,r,n,s,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",f=e.match(_Y);f?(u=e.slice(0,f.index),h=e.slice(f.index+f[0].length)):u=h=e;var m=u.match(I8);m?wk(m[0],l,s,r):(m=u.match($Y))&&FY(m[0],m[1]||"",l,s,r);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var v=u.slice(g,g+50).match(jY);v&&yY(l,v[1])}var x=u.match(TY);x&&x[1]&&HY(x[1],s);var y=[];if(t.cellStyles){var _=u.match(kY);_&&LY(y,_)}f&&qY(f[1],l,t,c,i,o);var b=h.match(SY);b&&(l["!autofilter"]=BY(b[0]));var w=[],C=h.match(bY);if(C)for(g=0;g!=C.length;++g)w[g]=ct(C[g].slice(C[g].indexOf('"')+1));var j=h.match(wY);j&&RY(l,j,n);var T=h.match(CY);if(T&&(l["!margins"]=IY(Be(T[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=He(c)),t.sheetRows>0&&l["!ref"]){var k=ct(l["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),l["!fullref"]=l["!ref"],l["!ref"]=He(k))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function AY(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+He(e[r])+'"/>';return t+"</mergeCells>"}function wk(e,t,r,n){var s=Be(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=lt(Ct(s.codeName)))}function FY(e,t,r,n,s){wk(e.slice(0,e.indexOf(">")),r,n,s)}function PY(e,t,r,n,s){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=ci(kt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ke("outlinePr",null,u)}!i&&!l||(s[s.length]=ke("sheetPr",l,o))}var DY=["objects","scenarios","selectLockedCells","selectUnlockedCells"],MY=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function OY(e){var t={sheet:1};return DY.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),MY.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=mk(e.password).toString(16).toUpperCase()),ke("sheetProtection",null,t)}function RY(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=Be(Ct(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+lt(i.location))):(i.Target="#"+lt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=ct(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var h=ze({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function IY(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function NY(e){return Dc(e),ke("pageMargins",null,e)}function LY(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Be(t[n],!0);s.hidden&&(s.hidden=Mt(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,gk(s.width)),_l(s);i<=o;)e[i++]=It(s)}}function zY(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=ke("col",null,U1(s,n)));return r[r.length]="</cols>",r.join("")}function BY(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function UY(e,t,r,n){var s=typeof e.ref=="string"?e.ref:He(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=rs(s);o.s.r==o.e.r&&(o.e.r=rs(t["!ref"]).e.r,s=He(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ke("autoFilter",null,{ref:s})}var VY=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function HY(e,t){t.Views||(t.Views=[{}]),(e.match(VY)||[]).forEach(function(r,n){var s=Be(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Mt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function WY(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ke("sheetViews",ke("sheetView",null,s),{})}function GY(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=oo[e.v];break;case"d":n&&n.cellDates?s=Rt(e.v,-1).toISOString():(e=It(e),e.t="n",s=""+(e.v=kr(Rt(e.v)))),typeof e.z>"u"&&(e.z=Le[14]);break;default:s=e.v;break}var l=Hr("v",kt(s)),c={r:t},u=Al(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Hr("v",""+_k(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ke("f",kt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ke("c",l,c)}var qY=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=k0("v"),o=k0("f");return function(c,u,h,f,m,g){for(var v=0,x="",y=[],_=[],b=0,w=0,C=0,j="",T,k,M=0,A=0,O,F,B=0,L=0,U=Array.isArray(g.CellXf),P,Q=[],re=[],Z=Array.isArray(u),W=[],ce={},te=!1,D=!!h.sheetStubs,R=c.split(t),N=0,H=R.length;N!=H;++N){x=R[N].trim();var ee=x.length;if(ee!==0){var J=0;e:for(v=0;v<ee;++v)switch(x[v]){case">":if(x[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(k=Be(x.slice(J,v),!0),M=k.r!=null?parseInt(k.r,10):M+1,A=-1,h.sheetRows&&h.sheetRows<M)continue;ce={},te=!1,k.ht&&(te=!0,ce.hpt=parseFloat(k.ht),ce.hpx=Mu(ce.hpt)),k.hidden=="1"&&(te=!0,ce.hidden=!0),k.outlineLevel!=null&&(te=!0,ce.level=+k.outlineLevel),te&&(W[M-1]=ce)}break;case"<":J=v;break}if(J>=v)break;if(k=Be(x.slice(J,v),!0),M=k.r!=null?parseInt(k.r,10):M+1,A=-1,!(h.sheetRows&&h.sheetRows<M)){f.s.r>M-1&&(f.s.r=M-1),f.e.r<M-1&&(f.e.r=M-1),h&&h.cellStyles&&(ce={},te=!1,k.ht&&(te=!0,ce.hpt=parseFloat(k.ht),ce.hpx=Mu(ce.hpt)),k.hidden=="1"&&(te=!0,ce.hidden=!0),k.outlineLevel!=null&&(te=!0,ce.level=+k.outlineLevel),te&&(W[M-1]=ce)),y=x.slice(v).split(e);for(var he=0;he!=y.length&&y[he].trim().charAt(0)=="<";++he);for(y=y.slice(he),v=0;v!=y.length;++v)if(x=y[v].trim(),x.length!==0){if(_=x.match(r),b=v,w=0,C=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,_!=null&&_.length===2){for(b=0,j=_[1],w=0;w!=j.length&&!((C=j.charCodeAt(w)-64)<1||C>26);++w)b=26*b+C;--b,A=b}else++A;for(w=0;w!=x.length&&x.charCodeAt(w)!==62;++w);if(++w,k=Be(x.slice(0,w),!0),k.r||(k.r=ze({r:M-1,c:A})),j=x.slice(w),T={t:""},(_=j.match(i))!=null&&_[1]!==""&&(T.v=lt(_[1])),h.cellFormula){if((_=j.match(o))!=null&&_[1]!==""){if(T.f=lt(Ct(_[1])).replace(/\r\n/g,`
`),h.xlfn||(T.f=nE(T.f)),_[0].indexOf('t="array"')>-1)T.F=(j.match(s)||[])[1],T.F.indexOf(":")>-1&&Q.push([ct(T.F),T.F]);else if(_[0].indexOf('t="shared"')>-1){F=Be(_[0]);var ge=lt(Ct(_[1]));h.xlfn||(ge=nE(ge)),re[parseInt(F.si,10)]=[F,ge,k.r]}}else(_=j.match(/<f[^>]*\/>/))&&(F=Be(_[0]),re[F.si]&&(T.f=VK(re[F.si][1],re[F.si][2],k.r)));var xe=Ht(k.r);for(w=0;w<Q.length;++w)xe.r>=Q[w][0].s.r&&xe.r<=Q[w][0].e.r&&xe.c>=Q[w][0].s.c&&xe.c<=Q[w][0].e.c&&(T.F=Q[w][1])}if(k.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(D)T.t="z";else continue;else T.t=k.t||"n";switch(f.s.c>A&&(f.s.c=A),f.e.c<A&&(f.e.c=A),T.t){case"n":if(T.v==""||T.v==null){if(!D)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!D)continue;T.t="z"}else O=qf[parseInt(T.v,10)],T.v=O.t,T.r=O.r,h.cellHTML&&(T.h=O.h);break;case"str":T.t="s",T.v=T.v!=null?Ct(T.v):"",h.cellHTML&&(T.h=ek(T.v));break;case"inlineStr":_=j.match(n),T.t="s",_!=null&&(O=pk(_[1]))?(T.v=O.t,h.cellHTML&&(T.h=O.h)):T.v="";break;case"b":T.v=Mt(T.v);break;case"d":h.cellDates?T.v=Rt(T.v,1):(T.v=kr(Rt(T.v,1)),T.t="n");break;case"e":(!h||h.cellText!==!1)&&(T.w=T.v),T.v=LD[T.v];break}if(B=L=0,P=null,U&&k.s!==void 0&&(P=g.CellXf[k.s],P!=null&&(P.numFmtId!=null&&(B=P.numFmtId),h.cellStyles&&P.fillId!=null&&(L=P.fillId))),R8(T,B,L,h,m,g),h.cellDates&&U&&T.t=="n"&&Wu(Le[B])&&(T.t="d",T.v=N1(T.v)),k.cm&&h.xlmeta){var De=(h.xlmeta.Cell||[])[+k.cm-1];De&&De.type=="XLDAPR"&&(T.D=!0)}if(Z){var X=Ht(k.r);u[X.r]||(u[X.r]=[]),u[X.r][X.c]=T}else u[k.r]=T}}}}W.length>0&&(u["!rows"]=W)}}();function KY(e,t,r,n){var s=[],i=[],o=ct(e["!ref"]),l="",c,u="",h=[],f=0,m=0,g=e["!rows"],v=Array.isArray(e),x={r:u},y,_=-1;for(m=o.s.c;m<=o.e.c;++m)h[m]=Vt(m);for(f=o.s.r;f<=o.e.r;++f){for(i=[],u=ar(f),m=o.s.c;m<=o.e.c;++m){c=h[m]+u;var b=v?(e[f]||[])[m]:e[c];b!==void 0&&(l=GY(b,c,e,t))!=null&&i.push(l)}(i.length>0||g&&g[f])&&(x={r:u},g&&g[f]&&(y=g[f],y.hidden&&(x.hidden=1),_=-1,y.hpx?_=F0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(x.ht=_,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),s[s.length]=ke("row",i.join(""),x))}if(g)for(;f<g.length;++f)g&&g[f]&&(x={r:f+1},y=g[f],y.hidden&&(x.hidden=1),_=-1,y.hpx?_=F0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(x.ht=_,x.customHeight=1),y.level&&(x.outlineLevel=y.level),s[s.length]=ke("row","",x));return s.join("")}function N8(e,t,r,n){var s=[ir,ke("worksheet",null,{xmlns:td[0],"xmlns:r":br.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",h=ct(u);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=He(h)}n||(n={}),c["!comments"]=[];var f=[];PY(c,r,e,t,s),s[s.length]=ke("dimension",null,{ref:u}),s[s.length]=WY(c,t,e,r),t.sheetFormat&&(s[s.length]=ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=zY(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=KY(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=OY(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=UY(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=AY(c["!merges"]));var m=-1,g,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=_t(n,-1,kt(x[1].Target).replace(/#.*$/,""),Je.HLINK),g["r:id"]="rId"+v),(m=x[1].Target.indexOf("#"))>-1&&(g.location=kt(x[1].Target.slice(m+1))),x[1].Tooltip&&(g.tooltip=kt(x[1].Tooltip)),s[s.length]=ke("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=NY(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Hr("ignoredErrors",ke("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=_t(n,-1,"../drawings/drawing"+(e+1)+".xml",Je.DRAW),s[s.length]=ke("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=_t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Je.VML),s[s.length]=ke("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function XY(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function YY(e,t,r){var n=fe(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=F0(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,m=-1,g=h<<10;g<h+1<<10;++g){u.c=g;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ze(u)];v&&(f<0&&(f=g),m=g)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var x=n.l;return n.l=c,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function QY(e,t,r,n){var s=YY(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ye(e,0,s)}var JY=ad,ZY=Ku;function eQ(){}function tQ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=sH(e),r}function rQ(e,t,r){r==null&&(r=fe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return qx({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),MD(e,r),r.slice(0,r.l)}function nQ(e){var t=aa(e);return[t]}function sQ(e,t,r){return r==null&&(r=fe(8)),rd(t,r)}function aQ(e){var t=nd(e);return[t]}function iQ(e,t,r){return r==null&&(r=fe(4)),sd(t,r)}function oQ(e){var t=aa(e),r=e.read_shift(1);return[t,r,"b"]}function lQ(e,t,r){return r==null&&(r=fe(9)),rd(t,r),r.write_shift(1,e.v?1:0),r}function cQ(e){var t=nd(e),r=e.read_shift(1);return[t,r,"b"]}function dQ(e,t,r){return r==null&&(r=fe(5)),sd(t,r),r.write_shift(1,e.v?1:0),r}function uQ(e){var t=aa(e),r=e.read_shift(1);return[t,r,"e"]}function hQ(e,t,r){return r==null&&(r=fe(9)),rd(t,r),r.write_shift(1,e.v),r}function fQ(e){var t=nd(e),r=e.read_shift(1);return[t,r,"e"]}function pQ(e,t,r){return r==null&&(r=fe(8)),sd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function mQ(e){var t=aa(e),r=e.read_shift(4);return[t,r,"s"]}function gQ(e,t,r){return r==null&&(r=fe(12)),rd(t,r),r.write_shift(4,t.v),r}function xQ(e){var t=nd(e),r=e.read_shift(4);return[t,r,"s"]}function vQ(e,t,r){return r==null&&(r=fe(8)),sd(t,r),r.write_shift(4,t.v),r}function yQ(e){var t=aa(e),r=an(e);return[t,r,"n"]}function bQ(e,t,r){return r==null&&(r=fe(16)),rd(t,r),Gc(e.v,r),r}function L8(e){var t=nd(e),r=an(e);return[t,r,"n"]}function _Q(e,t,r){return r==null&&(r=fe(12)),sd(t,r),Gc(e.v,r),r}function wQ(e){var t=aa(e),r=ck(e);return[t,r,"n"]}function jQ(e,t,r){return r==null&&(r=fe(12)),rd(t,r),OD(e.v,r),r}function kQ(e){var t=nd(e),r=ck(e);return[t,r,"n"]}function SQ(e,t,r){return r==null&&(r=fe(8)),sd(t,r),OD(e.v,r),r}function CQ(e){var t=aa(e),r=ik(e);return[t,r,"is"]}function $Q(e){var t=aa(e),r=un(e);return[t,r,"str"]}function TQ(e,t,r){return r==null&&(r=fe(12+4*e.v.length)),rd(t,r),Dr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function EQ(e){var t=nd(e),r=un(e);return[t,r,"str"]}function AQ(e,t,r){return r==null&&(r=fe(8+4*e.v.length)),sd(t,r),Dr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function FQ(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=B1(e,n-e.l,r);o[3]=tn(l,null,s,r.supbooks,r)}else e.l=n;return o}function PQ(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=B1(e,n-e.l,r);o[3]=tn(l,null,s,r.supbooks,r)}else e.l=n;return o}function DQ(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var i=an(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=B1(e,n-e.l,r);o[3]=tn(l,null,s,r.supbooks,r)}else e.l=n;return o}function MQ(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var i=un(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=B1(e,n-e.l,r);o[3]=tn(l,null,s,r.supbooks,r)}else e.l=n;return o}var OQ=ad,RQ=Ku;function IQ(e,t){return t==null&&(t=fe(4)),t.write_shift(4,e),t}function NQ(e,t){var r=e.l+t,n=ad(e),s=ok(e),i=un(e),o=un(e),l=un(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function LQ(e,t){var r=fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ku({s:Ht(e[0]),e:Ht(e[0])},r),lk("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Dr(s||"",r),Dr(e[1].Tooltip||"",r),Dr("",r),r.slice(0,r.l)}function zQ(){}function BQ(e,t,r){var n=e.l+t,s=RD(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=uY(e,n-e.l,r);o[1]=l}else e.l=n;return o}function UQ(e,t,r){var n=e.l+t,s=ad(e),i=[s];if(r.cellFormula){var o=fY(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function VQ(e,t,r){r==null&&(r=fe(18));var n=U1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var z8=["left","right","top","bottom","header","footer"];function HQ(e){var t={};return z8.forEach(function(r){t[r]=an(e)}),t}function WQ(e,t){return t==null&&(t=fe(6*8)),Dc(e),z8.forEach(function(r){Gc(e[r],t)}),t}function GQ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function qQ(e,t,r){r==null&&(r=fe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function KQ(e){var t=fe(24);return t.write_shift(4,4),t.write_shift(4,1),Ku(e,t),t}function XQ(e,t){return t==null&&(t=fe(16*4+2)),t.write_shift(2,e.password?mk(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function YQ(){}function QQ(){}function JQ(e,t,r,n,s,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,g,v,x,y,_,b,w,C,j,T=[];l.biff=12,l["!row"]=0;var k=0,M=!1,A=[],O={},F=l.supbooks||s.supbooks||[[]];if(F.sharedf=O,F.arrayf=A,F.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!l.supbooks&&(l.supbooks=F,s.Names))for(var B=0;B<s.Names.length;++B)F[0][B+1]=s.Names[B];var L=[],U=[],P=!1;P0[16]={n:"BrtShortReal",f:L8};var Q;if(io(e,function(W,ce,te){if(!m)switch(te){case 148:u=W;break;case 0:g=W,l.sheetRows&&l.sheetRows<=g.r&&(m=!0),C=ar(y=g.r),l["!row"]=g.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Mu(W.hpt)),U[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:W[2]},W[2]){case"n":v.v=W[1];break;case"s":w=qf[W[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!W[1];break;case"e":v.v=W[1],l.cellText!==!1&&(v.w=oo[v.v]);break;case"str":v.t="s",v.v=W[1];break;case"is":v.t="s",v.v=W[1].t;break}if((x=o.CellXf[W[0].iStyleRef])&&R8(v,x.numFmtId,null,l,i,o),_=W[0].c==-1?_+1:W[0].c,l.dense?(c[y]||(c[y]=[]),c[y][_]=v):c[Vt(_)+C]=v,l.cellFormula){for(M=!1,k=0;k<A.length;++k){var D=A[k];g.r>=D[0].s.r&&g.r<=D[0].e.r&&_>=D[0].s.c&&_<=D[0].e.c&&(v.F=He(D[0]),M=!0)}!M&&W.length>3&&(v.f=W[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),l.cellDates&&x&&v.t=="n"&&Wu(Le[x.numFmtId])){var R=pc(v.v);R&&(v.t="d",v.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}Q&&(Q.type=="XLDAPR"&&(v.D=!0),Q=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;v={t:"z",v:void 0},_=W[0].c==-1?_+1:W[0].c,l.dense?(c[y]||(c[y]=[]),c[y][_]=v):c[Vt(_)+C]=v,h.s.r>g.r&&(h.s.r=g.r),h.s.c>_&&(h.s.c=_),h.e.r<g.r&&(h.e.r=g.r),h.e.c<_&&(h.e.c=_),Q&&(Q.type=="XLDAPR"&&(v.D=!0),Q=void 0);break;case 176:T.push(W);break;case 49:Q=((l.xlmeta||{}).Cell||[])[W-1];break;case 494:var N=n["!id"][W.relId];for(N?(W.Target=N.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=N):W.relId==""&&(W.Target="#"+W.loc),y=W.rfx.s.r;y<=W.rfx.e.r;++y)for(_=W.rfx.s.c;_<=W.rfx.e.c;++_)l.dense?(c[y]||(c[y]=[]),c[y][_]||(c[y][_]={t:"z",v:void 0}),c[y][_].l=W):(b=ze({c:_,r:y}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=W);break;case 426:if(!l.cellFormula)break;A.push(W),j=l.dense?c[y][_]:c[Vt(_)+C],j.f=tn(W[1],h,{r:g.r,c:_},F,l),j.F=He(W[0]);break;case 427:if(!l.cellFormula)break;O[ze(W[0].s)]=W[1],j=l.dense?c[y][_]:c[Vt(_)+C],j.f=tn(W[1],h,{r:g.r,c:_},F,l);break;case 60:if(!l.cellStyles)break;for(;W.e>=W.s;)L[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},P||(P=!0,gk(W.w/256)),_l(L[W.e+1]);break;case 161:c["!autofilter"]={ref:He(W)};break;case 476:c["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ce.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=He(u||h)),l.sheetRows&&c["!ref"]){var re=ct(c["!ref"]);l.sheetRows<=+re.e.r&&(re.e.r=l.sheetRows-1,re.e.r>h.e.r&&(re.e.r=h.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>h.e.c&&(re.e.c=h.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),c["!fullref"]=c["!ref"],c["!ref"]=He(re))}return T.length>0&&(c["!merges"]=T),L.length>0&&(c["!cols"]=L),U.length>0&&(c["!rows"]=U),c}function ZQ(e,t,r,n,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=It(t),t.z=t.z||Le[14],t.v=kr(Rt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Al(s.cellXfs,t,s),t.l&&i["!links"].push([ze(c),t.l]),t.c&&i["!comments"].push([ze(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=_k(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ye(e,18,vQ(t,c)):ye(e,7,gQ(t,c))):(c.t="str",o?ye(e,17,AQ(t,c)):ye(e,6,TQ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ye(e,13,SQ(t,c)):ye(e,2,jQ(t,c)):o?ye(e,16,_Q(t,c)):ye(e,5,bQ(t,c)),!0;case"b":return c.t="b",o?ye(e,15,dQ(t,c)):ye(e,4,lQ(t,c)),!0;case"e":return c.t="e",o?ye(e,14,pQ(t,c)):ye(e,3,hQ(t,c)),!0}return o?ye(e,12,iQ(t,c)):ye(e,1,sQ(t,c)),!0}function eJ(e,t,r,n){var s=ct(t["!ref"]||"A1"),i,o="",l=[];ye(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var h=s.s.r;h<=u;++h){o=ar(h),QY(e,t,s,h);var f=!1;if(h<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){h===s.s.r&&(l[m]=Vt(m)),i=l[m]+o;var g=c?(t[h]||[])[m]:t[i];if(!g){f=!1;continue}f=ZQ(e,g,h,m,n,t,f)}}ye(e,146)}function tJ(e,t){!t||!t["!merges"]||(ye(e,177,IQ(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,RQ(r))}),ye(e,178))}function rJ(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,n){r&&ye(e,60,VQ(n,r))}),ye(e,391))}function nJ(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,KQ(ct(t["!ref"]))),ye(e,650))}function sJ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=_t(r,-1,n[1].Target.replace(/#.*$/,""),Je.HLINK);ye(e,494,LQ(n,s))}}),delete t["!links"]}function aJ(e,t,r,n){if(t["!comments"].length>0){var s=_t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Je.VML);ye(e,551,lk("rId"+s)),t["!legacy"]=s}}function iJ(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:He(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=rs(i);l.s.r==l.e.r&&(l.e.r=rs(t["!ref"]).e.r,i=He(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ye(e,161,Ku(ct(i))),ye(e,162)}}function oJ(e,t,r){ye(e,133),ye(e,137,qQ(t,r)),ye(e,138),ye(e,134)}function lJ(e,t){t["!protect"]&&ye(e,535,XQ(t["!protect"]))}function cJ(e,t,r,n){var s=ts(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ct(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ye(s,129),(r.vbaraw||o["!outline"])&&ye(s,147,rQ(l,o["!outline"])),ye(s,148,ZY(c)),oJ(s,o,r.Workbook),rJ(s,o),eJ(s,o,e,t),lJ(s,o),iJ(s,o,r,e),tJ(s,o),sJ(s,o,n),o["!margins"]&&ye(s,476,WQ(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&nJ(s,o),aJ(s,o,e,n),ye(s,130),s.end()}function dJ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function uJ(e,t,r,n,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=dJ(f);h.s.r=h.s.c=0,h.e.c=l,u=Vt(l),m[0].forEach(function(g,v){o[u+ar(v)]={t:"n",v:g,z:m[1]},c=v}),h.e.r<c&&(h.e.r=c),++l}),l>0&&(o["!ref"]=He(h)),o}function hJ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(I8);return l&&wk(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function fJ(e,t){e.l+=10;var r=un(e);return{name:r}}function pJ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return io(e,function(c,u,h){switch(h){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var jk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mJ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gJ=[],xJ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Mt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function cE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Mt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function B8(e){cE(e.WBProps,jk),cE(e.CalcPr,xJ),lE(e.WBView,mJ),lE(e.Sheets,gJ),nu.date1904=Mt(e.WBProps.date1904)}function vJ(e){return!e.Workbook||!e.Workbook.WBProps?"false":Mt(e.Workbook.WBProps.date1904)?"true":"false"}var yJ="][*?/\\".split("");function U8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yJ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bJ(e,t,r){e.forEach(function(n,s){U8(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function _J(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bJ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vY(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var wJ=/<\w+:workbook/;function jJ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(e.replace(mn,function(c,u){var h=Be(c);switch(fi(h[0])){case"<?xml":break;case"<workbook":c.match(wJ)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jk.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Mt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=Ct(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=lt(Ct(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ct(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Mt(h.hidden||"0")&&(i.Hidden=!0),o=u+c.length;break;case"</definedName>":i.Ref=lt(Ct(e.slice(o,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),td.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return B8(r),r}function V8(e){var t=[ir];t[t.length]=ke("workbook",null,{xmlns:td[0],"xmlns:r":br.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jk.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ke("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:kt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ke("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ke("definedName",kt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function kJ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=c2(e),r.name=un(e),r}function SJ(e,t){return t||(t=fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),lk(e.strRelID,t),Dr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function CJ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?un(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $J(e,t){t||(t=fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),MD(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function TJ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function EJ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=aH(e),o=hY(e,0,r),l=ok(e);e.l=n;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function AJ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],P0[16]={n:"BrtFRTArchID$",f:TJ},io(e,function(c,u,h){switch(h){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=tn(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,c]):o[0]=[h,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),B8(r),r.Names=i,r.supbooks=o,r}function FJ(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,SJ(s))}ye(e,144)}function PJ(e,t){t||(t=fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Dr("SheetJS",t),Dr(zx.version,t),Dr(zx.version,t),Dr("7262",t),t.length>t.l?t.slice(0,t.l):t}function DJ(e,t){t||(t=fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function MJ(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(ye(e,135),ye(e,158,DJ(s)),ye(e,136))}}function OJ(e,t){var r=ts();return ye(r,131),ye(r,128,PJ()),ye(r,153,$J(e.Workbook&&e.Workbook.WBProps||null)),MJ(r,e),FJ(r,e),ye(r,132),r.end()}function RJ(e,t,r){return t.slice(-4)===".bin"?AJ(e,r):jJ(e,r)}function IJ(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?JQ(e,n,r,s,i,o,l):EY(e,n,r,s,i,o,l)}function NJ(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?pJ(e,n,r,s,i):hJ(e,n,r,s,i)}function LJ(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?BK():UK()}function zJ(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?LK():zK()}function BJ(e,t,r,n){return t.slice(-4)===".bin"?Rq(e,r,n):kq(e,r,n)}function UJ(e,t,r){return j8(e,r)}function VJ(e,t,r){return t.slice(-4)===".bin"?VG(e,r):zG(e,r)}function HJ(e,t,r){return t.slice(-4)===".bin"?MK(e,r):SK(e,r)}function WJ(e,t,r){return t.slice(-4)===".bin"?wK(e):bK(e)}function GJ(e,t,r,n){return r.slice(-4)===".bin"?jK(e,t,r,n):void 0}function qJ(e,t,r){return t.slice(-4)===".bin"?xK(e,t,r):yK(e,t,r)}function KJ(e,t,r){return(t.slice(-4)===".bin"?OJ:V8)(e)}function XJ(e,t,r,n,s){return(t.slice(-4)===".bin"?cJ:N8)(e,r,n,s)}function YJ(e,t,r){return(t.slice(-4)===".bin"?Gq:_8)(e,r)}function QJ(e,t,r){return(t.slice(-4)===".bin"?GG:f8)(e,r)}function JJ(e,t,r){return(t.slice(-4)===".bin"?OK:C8)(e)}function ZJ(e){return(e.slice(-4)===".bin"?vK:k8)()}var H8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,W8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ga(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(H8),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(W8),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function eZ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(H8),s,i,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(W8),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Xf;function tZ(e,t){var r=Xf[e]||lt(e);return r==="General"?Hc(t):ra(r,t)}function rZ(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Mt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Rt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=s}function nZ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=j0(e.v):e.w=Hc(e.v):e.w=tZ(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Xf[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Wu(n)){var s=pc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function sZ(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=gq[n.Pattern]||n.Pattern)}e[t.ID]=t}function aZ(e,t,r,n,s,i,o,l,c,u){var h="General",f=n.StyleID,m={};u=u||{};var g=[],v=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(h=i[f].nf),i[f].Interior&&g.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Mt(e);break;case"String":n.t="s",n.r=CT(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Rt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=LD[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=CT(t||e));break}if(nZ(n,h,u),u.cellFormula!==!1)if(n.Formula){var x=lt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=ru(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=ru("RC:RC",s):n.ArrayRange&&(n.F=ru(n.ArrayRange,s),c.push([ct(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);u.cellStyles&&(g.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iZ(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xy(e,t){var r=t||{};Gu();var n=Cf(tk(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ct(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=It(r);return o.type="string",Du.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Nt){s.indexOf("<"+Nt)>=0&&(i=!0)}),i)return WZ(n,r);Xf={"General Number":"General","General Date":Le[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Le[15],"Short Date":Le[14],"Long Time":Le[19],"Medium Time":Le[18],"Short Time":Le[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Le[2],Standard:Le[4],Percent:Le[10],Scientific:Le[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,h={},f=[],m=r.dense?[]:{},g="",v={},x={},y=ga('<Data ss:Type="String">'),_=0,b=0,w=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},T={},k="",M=0,A=[],O={},F={},B=0,L=[],U=[],P={},Q=[],re,Z=!1,W=[],ce=[],te={},D=0,R=0,N={Sheets:[],WBProps:{date1904:!1}},H={};C0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";l=C0.exec(n);)switch(l[3]=(ee=l[3]).toLowerCase()){case"data":if(ee=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?aZ(n.slice(_,l.index),k,y,c[c.length-1][0]=="comment"?P:v,{c:b,r:w},j,Q[b],x,W,r):(k="",y=ga(l[0]),_=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(U.length>0&&(v.c=U),(!r.sheetRows||r.sheetRows>w)&&v.v!==void 0&&(r.dense?(m[w]||(m[w]=[]),m[w][b]=v):m[Vt(b)+ar(w)]=v),v.HRef&&(v.l={Target:lt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(D=b+(parseInt(v.MergeAcross,10)|0),R=w+(parseInt(v.MergeDown,10)|0),A.push({s:{c:b,r:w},e:{c:D,r:R}})),!r.sheetStubs)v.MergeAcross?b=D+1:++b;else if(v.MergeAcross||v.MergeDown){for(var J=b;J<=D;++J)for(var he=w;he<=R;++he)(J>b||he>w)&&(r.dense?(m[he]||(m[he]=[]),m[he][J]={t:"z"}):m[Vt(J)+ar(he)]={t:"z"});b=D+1}else++b;else v=eZ(l[0]),v.Index&&(b=+v.Index-1),b<C.s.c&&(C.s.c=b),b>C.e.c&&(C.e.c=b),l[0].slice(-2)==="/>"&&++b,U=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<C.s.r&&(C.s.r=w),w>C.e.r&&(C.e.r=w),l[0].slice(-2)==="/>"&&(x=ga(l[0]),x.Index&&(w=+x.Index-1)),b=0,++w):(x=ga(l[0]),x.Index&&(w=+x.Index-1),te={},(x.AutoFitHeight=="0"||x.Height)&&(te.hpx=parseInt(x.Height,10),te.hpt=F0(te.hpx),ce[w]=te),x.Hidden=="1"&&(te.hidden=!0,ce[w]=te));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(g),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(m["!ref"]=He(C),r.sheetRows&&r.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=r.sheetRows-1,m["!ref"]=He(C))),A.length&&(m["!merges"]=A),Q.length>0&&(m["!cols"]=Q),ce.length>0&&(m["!rows"]=ce),h[g]=m}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([l[3],!1]),u=ga(l[0]),g=lt(u.Name),m=r.dense?[]:{},A=[],W=[],ce=[],H={name:g,Hidden:0},N.Sheets.push(H);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),Q=[],Z=!1}break;case"style":l[1]==="/"?sZ(j,T,r):T=ga(l[0]);break;case"numberformat":T.nf=lt(ga(l[0]).Format||"General"),Xf[T.nf]&&(T.nf=Xf[T.nf]);for(var ge=0;ge!=392&&Le[ge]!=T.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(Le[ge]==null){Yi(T.nf,ge);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(re=ga(l[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!Z&&re.wpx>10){Z=!0,nn=y8;for(var xe=0;xe<Q.length;++xe)Q[xe]&&_l(Q[xe])}Z&&_l(re),Q[re.Index-1||Q.length]=re;for(var De=0;De<+re.Span;++De)Q[Q.length]=It(re);break;case"namedrange":if(l[1]==="/")break;N.Names||(N.Names=[]);var X=Be(l[0]),rt={Name:X.Name,Ref:ru(X.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(rt.Sheet=N.Sheets.length-1),N.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?k+=n.slice(M,l.index):M=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=ga(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?AH(O,ee,n.slice(B,l.index)):B=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));iZ(P),U.push(P)}else c.push([l[3],!1]),u=ga(l[0]),P={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var We=ga(l[0]);m["!autofilter"]={ref:ru(We.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return pE(n,r);var dt=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(l[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(B,l.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else B=l.index+l[0].length;break;case"header":m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(m["!margins"].header=+Be(l[0]).Margin);break;case"footer":m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(m["!margins"].footer=+Be(l[0]).Margin);break;case"pagemargins":var pe=Be(l[0]);m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+pe.Top)||(m["!margins"].top=+pe.Top),isNaN(+pe.Left)||(m["!margins"].left=+pe.Left),isNaN(+pe.Right)||(m["!margins"].right=+pe.Right),isNaN(+pe.Bottom)||(m["!margins"].bottom=+pe.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?rZ(F,ee,L,n.slice(B,l.index)):(L=l,B=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ve={};return!r.bookSheets&&!r.bookProps&&(ve.Sheets=h),ve.SheetNames=f,ve.Workbook=N,ve.SSF=It(Le),ve.Props=O,ve.Custprops=F,ve}function g2(e,t){switch(Sk(t=t||{}),t.type||"base64"){case"base64":return Xy(bs(e),t);case"binary":case"buffer":case"file":return Xy(e,t);case"array":return Xy(Tl(e),t)}}function oZ(e,t){var r=[];return e.Props&&r.push(FH(e.Props,t)),e.Custprops&&r.push(PH(e.Props,e.Custprops)),r.join("")}function lZ(){return""}function cZ(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(ke("NumberFormat",null,{"ss:Format":kt(Le[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(ke("Style",i.join(""),o))}),ke("Styles",r.join(""))}function G8(e){return ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+yk(e.Ref,{r:0,c:0})})}function dZ(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(G8(s)))}return ke("Names",r.join(""))}function uZ(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(G8(l)))}return i.join("")}function hZ(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(ke("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(ke("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Hr("ProtectContents","True")),e["!protect"].objects&&s.push(Hr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Hr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Hr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Hr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":ke("WorksheetOptions",s.join(""),{xmlns:hs.x})}function fZ(e){return e.map(function(t){var r=MV(t.t||""),n=ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ke("Comment",n,{"ss:Author":t.a})}).join("")}function pZ(e,t,r,n,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+kt(yk(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Ht(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=kt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=kt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],h=0;h!=u.length;++h)u[h].s.c!=o.c||u[h].s.r!=o.r||(u[h].e.c>u[h].s.c&&(l["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(l["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=oo[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Le[14]);break;case"s":f="String",m=DV(e.v||"");break}var g=Al(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+g),l["ss:Index"]=o.c+1;var v=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=fZ(e.c)),ke("Cell",x,l)}function mZ(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Mu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gZ(e,t,r,n){if(!e["!ref"])return"";var s=ct(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,_){_l(y);var b=!!y.width,w=U1(_,y),C={"ss:Index":_+1};b&&(C["ss:Width"]=E0(w.width)),y.hidden&&(C["ss:Hidden"]="1"),l.push(ke("Column",null,C))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var h=[mZ(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>u)&&!(i[o].e.c<f)&&!(i[o].e.r<u)){(i[o].s.c!=f||i[o].s.r!=u)&&(m=!0);break}if(!m){var g={r:u,c:f},v=ze(g),x=c?(e[u]||[])[f]:e[v];h.push(pZ(x,v,e,t,r,n,g))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function xZ(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?uZ(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?gZ(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(hZ(i,t,e,r)),n.join("")}function vZ(e,t){t||(t={}),e.SSF||(e.SSF=It(Le)),e.SSF&&(Gu(),O1(e.SSF),t.revssf=I1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Al(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(oZ(e,t)),r.push(lZ()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ke("Worksheet",xZ(n,t,e),{"ss:Name":kt(e.SheetNames[n])}));return r[2]=cZ(e,t),r[3]=dZ(e),ir+ke("Workbook",r.join(""),{xmlns:hs.ss,"xmlns:o":hs.o,"xmlns:x":hs.x,"xmlns:ss":hs.ss,"xmlns:dt":hs.dt,"xmlns:html":hs.html})}function yZ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=dH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=uH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var bZ=[60,1084,2066,2165,2175];function _Z(e,t,r,n,s){var i=n,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Wi(r,r.l),u=x2[c],h=0;u!=null&&bZ.indexOf(c)>-1;)i=Wi(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),l=r.slice(h,r.l+4+i),o.push(l),r.l+=4+i,u=x2[c=Wi(r,r.l)];var f=Pr(o);Vr(f,0);var m=0;f.lens=[];for(var g=0;g<o.length;++g)f.lens.push(m),m+=o[g].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function Va(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Le[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=j0(e.v):e.w=Hc(e.v):e.w=ra(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Wu(Le[n]||String(n))){var s=pc(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function gm(e,t,r){return{v:e,ixfe:t,t:r}}function wZ(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},o={},l=null,c=[],u="",h={},f,m="",g,v,x,y,_={},b=[],w,C,j=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},A=function(Ge){return Ge<8?Ac[Ge]:Ge<64&&T[Ge-8]||Ac[Ge]},O=function(Ge,Lt,xn){var Kt=Lt.XF.data;if(!(!Kt||!Kt.patternType||!xn||!xn.cellStyles)){Lt.s={},Lt.s.patternType=Kt.patternType;var Oa;(Oa=T0(A(Kt.icvFore)))&&(Lt.s.fgColor={rgb:Oa}),(Oa=T0(A(Kt.icvBack)))&&(Lt.s.bgColor={rgb:Oa})}},F=function(Ge,Lt,xn){if(!(te>1)&&!(xn.sheetRows&&Ge.r>=xn.sheetRows)){if(xn.cellStyles&&Lt.XF&&Lt.XF.data&&O(Ge,Lt,xn),delete Lt.ixfe,delete Lt.XF,f=Ge,m=ze(Ge),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<o.s.r&&(o.s.r=Ge.r),Ge.c<o.s.c&&(o.s.c=Ge.c),Ge.r+1>o.e.r&&(o.e.r=Ge.r+1),Ge.c+1>o.e.c&&(o.e.c=Ge.c+1),xn.cellFormula&&Lt.f){for(var Kt=0;Kt<b.length;++Kt)if(!(b[Kt][0].s.c>Ge.c||b[Kt][0].s.r>Ge.r)&&!(b[Kt][0].e.c<Ge.c||b[Kt][0].e.r<Ge.r)){Lt.F=He(b[Kt][0]),(b[Kt][0].s.c!=Ge.c||b[Kt][0].s.r!=Ge.r)&&delete Lt.f,Lt.f&&(Lt.f=""+tn(b[Kt][1],o,Ge,W,B));break}}xn.dense?(s[Ge.r]||(s[Ge.r]=[]),s[Ge.r][Ge.c]=Lt):s[m]=Lt}},B={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(B.password=t.password);var L,U=[],P=[],Q=[],re=[],Z=!1,W=[];W.SheetNames=B.snames,W.sharedf=B.sharedf,W.arrayf=B.arrayf,W.names=[],W.XTI=[];var ce=0,te=0,D=0,R=[],N=[],H;B.codepage=1200,Sa(1200);for(var ee=!1;e.l<e.length-1;){var J=e.l,he=e.read_shift(2);if(he===0&&ce===10)break;var ge=e.l===e.length?0:e.read_shift(2),xe=x2[he];if(xe&&xe.f){if(t.bookSheets&&ce===133&&he!==133)break;if(ce=he,xe.r===2||xe.r==12){var De=e.read_shift(2);if(ge-=2,!B.enc&&De!==he&&((De&255)<<8|De>>8)!==he)throw new Error("rt mismatch: "+De+"!="+he);xe.r==12&&(e.l+=10,ge-=10)}var X={};if(he===10?X=xe.f(e,ge,B):X=_Z(he,xe,e,ge,B),te==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(he){case 34:r.opts.Date1904=k.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=X;break;case 66:var rt=Number(X);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}Sa(B.codepage=rt),ee=!0;break;case 317:B.rrtabid=X;break;case 25:B.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:B.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(s["!type"]="dialog"),X.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),X.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(X);break;case 430:W.push([X]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(X);break;case 24:case 536:H={Name:X.Name,Ref:tn(X.rgce,o,null,W,B)},X.itab>0&&(H.Sheet=X.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(N[X.itab-1]={ref:He(X.rgce[0][0][1][2])});break;case 22:B.ExternCount=X;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(X),W.XTI=W.XTI.concat(X);break;case 2196:if(B.biff<8)break;H!=null&&(H.Comment=X[1]);break;case 18:s["!protect"]=X;break;case 19:X!==0&&B.WTF&&console.error("Password verifier: "+X);break;case 133:i[X.pos]=X,B.snames.push(X.name);break;case 10:{if(--te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=He(o),t.sheetRows&&t.sheetRows<=o.e.r){var We=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=He(o),o.e.r=We}o.e.r++,o.e.c++}U.length>0&&(s["!merges"]=U),P.length>0&&(s["!objects"]=P),Q.length>0&&(s["!cols"]=Q),re.length>0&&(s["!rows"]=re),k.Sheets.push(M)}u===""?h=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[he]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),B.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(B.biff=5,ee=!0,Sa(B.codepage=28591)),B.biff==8&&X.BIFFVer==0&&X.dt==16&&(B.biff=2),te++)break;if(s=t.dense?[]:{},B.biff<8&&!ee&&(ee=!0,Sa(B.codepage=t.codepage||1252)),B.biff<5||X.BIFFVer==0&&X.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:e.l-ge,name:u};i[dt.pos]=dt,B.snames.push(u)}else u=(i[J]||{name:""}).name;X.dt==32&&(s["!type"]="chart"),X.dt==64&&(s["!type"]="macro"),U=[],P=[],B.arrayf=b=[],Q=[],re=[],Z=!1,M={Hidden:(i[J]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[X.r]||[])[X.c]:s[ze({c:X.c,r:X.r})])&&++X.c,w={ixfe:X.ixfe,XF:j[X.ixfe]||{},v:X.val,t:"n"},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 5:case 517:w={ixfe:X.ixfe,XF:j[X.ixfe],v:X.val,t:X.t},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 638:w={ixfe:X.ixfe,XF:j[X.ixfe],v:X.rknum,t:"n"},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 189:for(var pe=X.c;pe<=X.C;++pe){var ve=X.rkrec[pe-X.c][0];w={ixfe:ve,XF:j[ve],v:X.rkrec[pe-X.c][1],t:"n"},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:pe,r:X.r},w,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){l=X;break}if(w=gm(X.val,X.cell.ixfe,X.tt),w.XF=j[w.ixfe],t.cellFormula){var Nt=X.formula;if(Nt&&Nt[0]&&Nt[0][0]&&Nt[0][0][0]=="PtgExp"){var gn=Nt[0][0][1][0],ns=Nt[0][0][1][1],js=ze({r:gn,c:ns});_[js]?w.f=""+tn(X.formula,o,X.cell,W,B):w.F=((t.dense?(s[gn]||[])[ns]:s[js])||{}).F}else w.f=""+tn(X.formula,o,X.cell,W,B)}D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F(X.cell,w,t),l=X}break;case 7:case 519:if(l)l.val=X,w=gm(X,l.cell.ixfe,"s"),w.XF=j[w.ixfe],t.cellFormula&&(w.f=""+tn(l.formula,o,l.cell,W,B)),D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(X);var lo=ze(X[0].s);if(g=t.dense?(s[X[0].s.r]||[])[X[0].s.c]:s[lo],t.cellFormula&&g){if(!l||!lo||!g)break;g.f=""+tn(X[1],o,X[0],W,B),g.F=He(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!l)break;_[ze(l.cell)]=X[0],g=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[ze(l.cell)],(g||{}).f=""+tn(X[0],o,f,W,B)}}break;case 253:w=gm(c[X.isst].t,X.ixfe,"s"),c[X.isst].h&&(w.h=c[X.isst].h),w.XF=j[w.ixfe],D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:X.ixfe,XF:j[X.ixfe],t:"z"},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t));break;case 190:if(t.sheetStubs)for(var ia=X.c;ia<=X.C;++ia){var Xr=X.ixfe[ia-X.c];w={ixfe:Xr,XF:j[Xr],t:"z"},D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:ia,r:X.r},w,t)}break;case 214:case 516:case 4:w=gm(X.val,X.ixfe,"s"),w.XF=j[w.ixfe],D>0&&(w.z=R[w.ixfe>>8&63]),Va(w,t,r.opts.Date1904),F({c:X.c,r:X.r},w,t);break;case 0:case 512:te===1&&(o=X);break;case 252:c=X;break;case 1054:if(B.biff==4){R[D++]=X[1];for(var ks=0;ks<D+163&&Le[ks]!=X[1];++ks);ks>=163&&Yi(X[1],D+163)}else Yi(X[1],X[0]);break;case 30:{R[D++]=X;for(var oa=0;oa<D+163&&Le[oa]!=X;++oa);oa>=163&&Yi(X,D+163)}break;case 229:U=U.concat(X);break;case 93:P[X.cmo[0]]=B.lastobj=X;break;case 438:B.lastobj.TxO=X;break;case 127:B.lastobj.ImData=X;break;case 440:for(y=X[0].s.r;y<=X[0].e.r;++y)for(x=X[0].s.c;x<=X[0].e.c;++x)g=t.dense?(s[y]||[])[x]:s[ze({c:x,r:y})],g&&(g.l=X[1]);break;case 2048:for(y=X[0].s.r;y<=X[0].e.r;++y)for(x=X[0].s.c;x<=X[0].e.c;++x)g=t.dense?(s[y]||[])[x]:s[ze({c:x,r:y})],g&&g.l&&(g.l.Tooltip=X[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;g=t.dense?(s[X[0].r]||[])[X[0].c]:s[ze(X[0])];var co=P[X[2]];g||(t.dense?(s[X[0].r]||(s[X[0].r]=[]),g=s[X[0].r][X[0].c]={t:"z"}):g=s[ze(X[0])]={t:"z"},o.e.r=Math.max(o.e.r,X[0].r),o.s.r=Math.min(o.s.r,X[0].r),o.e.c=Math.max(o.e.c,X[0].c),o.s.c=Math.min(o.s.c,X[0].c)),g.c||(g.c=[]),v={a:X[1],t:co.TxO.t},g.c.push(v)}break;case 2173:cK(j[X.ixfe],X.ext);break;case 125:{if(!B.cellStyles)break;for(;X.e>=X.s;)Q[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},Z||(Z=!0,gk(X.w/256)),_l(Q[X.e+1])}break;case 520:{var Cr={};X.level!=null&&(re[X.r]=Cr,Cr.level=X.level),X.hidden&&(re[X.r]=Cr,Cr.hidden=!0),X.hpt&&(re[X.r]=Cr,Cr.hpt=X.hpt,Cr.hpx=Mu(X.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Dc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[he]]=X;break;case 161:s["!margins"]||Dc(s["!margins"]={}),s["!margins"].header=X.header,s["!margins"].footer=X.footer;break;case 574:X.RTL&&(k.Views[0].RTL=!0);break;case 146:T=X;break;case 2198:L=X;break;case 140:C=X;break;case 442:u?M.CodeName=X||M.name:k.WBProps.CodeName=X||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+he.toString(16)),e.l+=ge}return r.SheetNames=er(i).sort(function(ss,Ge){return Number(ss)-Number(Ge)}).map(function(ss){return i[ss].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&N.forEach(function(ss,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=ss}),r.Strings=c,r.SSF=It(Le),B.enc&&(r.Encryption=B.enc),L&&(r.Themes=L),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),W.names.length>0&&(k.Names=W.names),r.Workbook=k,r}var Yf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jZ(e,t,r){var n=Ie.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=HT(n,d2,Yf.DSI);for(var i in s)t[i]=s[i]}catch(u){if(r.WTF)throw u}var o=Ie.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=HT(o,u2,Yf.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(WD(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function kZ(e,t){var r=[],n=[],s=[],i=0,o,l=bT(d2,"n"),c=bT(u2,"n");if(e.Props)for(o=er(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=er(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<s.length;++i)JD.indexOf(s[i][0])>-1||HD.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&Ie.utils.cfb_add(t,"/SummaryInformation",WT(n,Yf.SI,c,u2)),(r.length||u.length)&&Ie.utils.cfb_add(t,"/DocumentSummaryInformation",WT(r,Yf.DSI,l,d2,u.length?u:null,Yf.UDI))}function q8(e,t){t||(t={}),Sk(t),Gj(),t.codepage&&Wj(t.codepage);var r,n;if(e.FullPaths){if(Ie.find(e,"/encryption"))throw new Error("File is password-protected");r=Ie.find(e,"!CompObj"),n=Ie.find(e,"/Workbook")||Ie.find(e,"/Book")}else{switch(t.type){case"base64":e=ps(bs(e));break;case"binary":e=ps(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Vr(e,0),n={content:e}}var s,i;if(r&&yZ(r),t.bookProps&&!t.bookSheets)s={};else{var o=Qe?"buffer":"array";if(n&&n.content)s=wZ(n.content,t);else if((i=Ie.find(e,"PerfectOffice_MAIN"))&&i.content)s=Pc.to_workbook(i.content,(t.type=o,t));else if((i=Ie.find(e,"NativeContent_MAIN"))&&i.content)s=Pc.to_workbook(i.content,(t.type=o,t));else throw(i=Ie.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ie.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=IK(e))}var l={};return e.FullPaths&&jZ(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function SZ(e,t){var r=t||{},n=Ie.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ie.utils.cfb_add(n,s,K8(e,r)),r.biff==8&&(e.Props||e.Custprops)&&kZ(e,n),r.biff==8&&e.vbaraw&&NK(n,Ie.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var P0={0:{f:XY},1:{f:nQ},2:{f:wQ},3:{f:uQ},4:{f:oQ},5:{f:yQ},6:{f:$Q},7:{f:mQ},8:{f:MQ},9:{f:DQ},10:{f:FQ},11:{f:PQ},12:{f:aQ},13:{f:kQ},14:{f:fQ},15:{f:cQ},16:{f:L8},17:{f:EQ},18:{f:xQ},19:{f:ik},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:EJ},40:{},42:{},43:{f:$q},44:{f:Sq},45:{f:Aq},46:{f:Pq},47:{f:Fq},48:{},49:{f:JV},50:{},51:{f:hK},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c8},62:{f:CQ},63:{f:_K},64:{f:YQ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:GQ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tQ},148:{f:JY,p:16},151:{f:zQ},152:{},153:{f:CJ},154:{},155:{},156:{f:kJ},157:{},158:{},159:{T:1,f:UG},160:{T:-1},161:{T:1,f:ad},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:OQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dK},336:{T:-1},337:{f:mK,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:c2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:l8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:BQ},427:{f:UQ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:HQ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eQ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:c2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PK},633:{T:1},634:{T:-1},635:{T:1,f:AK},636:{T:-1},637:{f:rH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fJ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:QQ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},x2={6:{f:qy},10:{f:_o},12:{f:ur},13:{f:ur},14:{f:rr},15:{f:rr},16:{f:an},17:{f:rr},18:{f:rr},19:{f:ur},20:{f:QT},21:{f:QT},23:{f:l8},24:{f:ZT},25:{f:rr},26:{},27:{},28:{f:QW},29:{},34:{f:rr},35:{f:JT},38:{f:an},39:{f:an},40:{f:an},41:{f:an},42:{f:rr},43:{f:rr},47:{f:cq},49:{f:kW},51:{f:ur},60:{},61:{f:yW},64:{f:rr},65:{f:jW},66:{f:ur},77:{},80:{},81:{},82:{},85:{f:ur},89:{},90:{},91:{},92:{f:lW},93:{f:eG},94:{},95:{f:rr},96:{},97:{},99:{f:rr},125:{f:c8},128:{f:LW},129:{f:dW},130:{f:ur},131:{f:rr},132:{f:rr},133:{f:uW},134:{},140:{f:lG},141:{f:ur},144:{},146:{f:uG},151:{},152:{},153:{},154:{},155:{},156:{f:ur},157:{},158:{},160:{f:vG},161:{f:pG},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:OW},190:{f:RW},193:{f:_o},197:{},198:{},199:{},200:{},201:{},202:{f:rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ur},220:{},221:{f:rr},222:{},224:{f:NW},225:{f:oW},226:{f:_o},227:{},229:{f:JW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fW},253:{f:CW},255:{f:mW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZD},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rr},353:{f:_o},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:HW},431:{f:rr},432:{},433:{},434:{},437:{},438:{f:nG},439:{f:rr},440:{f:sG},441:{},442:{f:op},443:{},444:{f:ur},445:{},446:{},448:{f:_o},449:{f:vW,r:2},450:{f:_o},512:{f:KT},513:{f:xG},515:{f:UW},516:{f:TW},517:{f:YT},519:{f:yG},520:{f:gW},523:{},545:{f:eE},549:{f:qT},566:{},574:{f:_W},638:{f:MW},659:{},1048:{},1054:{f:AW},1084:{},1212:{f:KW},2048:{f:iG},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_o},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hG,r:12},2173:{f:lK,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:qW,r:12},2197:{},2198:{f:rK,r:12},2199:{},2200:{},2201:{},2202:{f:XW,r:12},2203:{f:_o},2204:{},2205:{},2206:{},2207:{},2211:{f:xW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ur},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mG},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dG},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:KT},1:{},2:{f:kG},3:{f:wG},4:{f:_G},5:{f:YT},7:{f:CG},8:{},9:{f:fm},11:{},22:{f:ur},30:{f:PW},31:{},32:{},33:{f:eE},36:{},37:{f:qT},50:{f:$G},62:{},52:{},67:{},68:{f:ur},69:{},86:{},126:{},127:{f:bG},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:TG},223:{},234:{},354:{},421:{},518:{f:qy},521:{f:fm},536:{f:ZT},547:{f:JT},561:{},579:{},1030:{f:qy},1033:{f:fm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Se(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&nk(r)&&e.push(r)}}function CZ(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Se(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,i),h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(h=e.next(4),h.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function up(e,t,r){return e||(e=fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function $Z(e,t,r,n){var s=fe(9);return up(s,e,t),e8(r,n||"b",s),s}function TZ(e,t,r){var n=fe(8+2*r.length);return up(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function EZ(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?kr(Rt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Se(e,2,SG(r,n,s)):Se(e,3,jG(r,n,s));return;case"b":case"e":Se(e,5,$Z(r,n,t.v,t.t));return;case"s":case"str":Se(e,4,TZ(r,n,(t.v||"").slice(0,255)));return}Se(e,1,up(null,r,n))}function AZ(e,t,r,n){var s=Array.isArray(t),i=ct(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=He(i)}for(var u=i.s.r;u<=i.e.r;++u){l=ar(u);for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(c[h]=Vt(h)),o=c[h]+l;var f=s?(t[u]||[])[h]:t[o];f&&EZ(e,f,u,h)}}}function FZ(e,t){for(var r=t||{},n=ts(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(n,r.biff==4?1033:r.biff==3?521:9,fk(e,16,r)),AZ(n,e.Sheets[e.SheetNames[s]],s,r),Se(n,10),n.end()}function PZ(e,t,r){Se(e,49,SW({sz:12,name:"Arial"},r))}function DZ(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Se(e,1054,FW(s,t[s],r))})}function MZ(e,t){var r=fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(e,2151,r),r=fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),a8(ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Se(e,2152,r)}function OZ(e,t){for(var r=0;r<16;++r)Se(e,224,XT({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Se(e,224,XT(n,0,t))})}function RZ(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Se(e,440,aG(n)),n[1].Tooltip&&Se(e,2048,oG(n))}delete t["!links"]}function IZ(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Se(e,125,fG(U1(s,n),s))})}}function NZ(e,t,r,n,s){var i=16+Al(s.cellXfs,t,s);if(t.v==null&&!t.bf){Se(e,513,Kc(r,n,i));return}if(t.bf)Se(e,6,dY(t,r,n,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?kr(Rt(t.v)):t.v;Se(e,515,VW(r,n,o,i));break;case"b":case"e":Se(e,517,BW(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=_k(s.Strings,t.v,s.revStrings);Se(e,253,$W(r,n,l,i))}else Se(e,516,EW(r,n,(t.v||"").slice(0,255),i,s));break;default:Se(e,513,Kc(r,n,i))}}function LZ(e,t,r){var n=ts(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,h,f="",m=[],g=ct(i["!ref"]||"A1"),v=u?65536:16384;if(g.e.c>255||g.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}Se(n,2057,fk(r,16,t)),Se(n,13,Ws(1)),Se(n,12,Ws(100)),Se(n,15,Tn(!0)),Se(n,17,Tn(!1)),Se(n,16,Gc(.001)),Se(n,95,Tn(!0)),Se(n,42,Tn(!1)),Se(n,43,Tn(!1)),Se(n,130,Ws(1)),Se(n,128,zW()),Se(n,131,Tn(!1)),Se(n,132,Tn(!1)),u&&IZ(n,i["!cols"]),Se(n,512,DW(g,t)),u&&(i["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){f=ar(x);for(var y=g.s.c;y<=g.e.c;++y){x===g.s.r&&(m[y]=Vt(y)),h=m[y]+f;var _=c?(i[x]||[])[y]:i[h];_&&(NZ(n,_,x,y,t),u&&_.l&&i["!links"].push([h,_.l]))}}var b=l.CodeName||l.name||s;return u&&Se(n,574,wW((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&Se(n,229,ZW(i["!merges"])),u&&RZ(n,i),Se(n,442,t8(b)),u&&MZ(n,i),Se(n,10),n.end()}function zZ(e,t,r){var n=ts(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Se(n,2057,fk(e,5,r)),r.bookType=="xla"&&Se(n,135),Se(n,225,l?Ws(1200):null),Se(n,193,BH(2)),c&&Se(n,191),c&&Se(n,192),Se(n,226),Se(n,92,cW("SheetJS",r)),Se(n,66,Ws(l?1200:1252)),l&&Se(n,353,Ws(0)),l&&Se(n,448),Se(n,317,gG(e.SheetNames.length)),l&&e.vbaraw&&Se(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Se(n,442,t8(u))}Se(n,156,Ws(17)),Se(n,25,Tn(!1)),Se(n,18,Tn(!1)),Se(n,19,Ws(0)),l&&Se(n,431,Tn(!1)),l&&Se(n,444,Ws(0)),Se(n,61,bW()),Se(n,64,Tn(!1)),Se(n,141,Ws(0)),Se(n,34,Tn(vJ(e)=="true")),Se(n,14,Tn(!0)),l&&Se(n,439,Tn(!1)),Se(n,218,Ws(0)),PZ(n,e,r),DZ(n,e.SSF,r),OZ(n,r),l&&Se(n,352,Tn(!1));var h=n.end(),f=ts();l&&Se(f,140,cG()),l&&r.Strings&&CZ(f,252,pW(r.Strings)),Se(f,10);var m=f.end(),g=ts(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var y=h.length+v+m.length;for(x=0;x<e.SheetNames.length;++x){var _=i[x]||{};Se(g,133,hW({pos:y,hs:_.Hidden||0,dt:0,name:e.SheetNames[x]},r)),y+=t[x].length}var b=g.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var w=[];return h.length&&w.push(h),b.length&&w.push(b),m.length&&w.push(m),Pr(w)}function BZ(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=It(Le)),e&&e.SSF&&(Gu(),O1(e.SSF),r.revssf=I1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ck(r),r.cellXfs=[],Al(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=LZ(s,r,e);return n.unshift(zZ(e,n,r)),Pr(n)}function K8(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=rs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return BZ(e,t);case 4:case 3:case 2:return FZ(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function dE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=SV(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,f=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<c.length;++o){var x=c[o].trim(),y=x.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(y!="<td"&&y!="<th")){var _=x.split(/<\/t[dh]>/i);for(l=0;l<_.length;++l){var b=_[l].trim();if(b.match(/<t[dh]/i)){for(var w=b,C=0;w.charAt(0)=="<"&&(C=w.indexOf(">"))>-1;)w=w.slice(C+1);for(var j=0;j<v.length;++j){var T=v[j];T.s.c==h&&T.s.r<u&&u<=T.e.r&&(h=T.e.c+1,j=-1)}var k=Be(b.slice(0,b.indexOf(">")));m=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||m>1)&&v.push({s:{r:u,c:h},e:{r:u+(f||1)-1,c:h+m-1}});var M=k.t||k["data-t"]||"";if(!w.length){h+=m;continue}if(w=vD(w),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!w.length){h+=m;continue}var A={t:"s",v:w};r.raw||!w.trim().length||M=="s"||(w==="TRUE"?A={t:"b",v:!0}:w==="FALSE"?A={t:"b",v:!1}:isNaN(Aa(w))?isNaN(Pu(w).getDate())||(A={t:"d",v:Rt(w)},r.cellDates||(A={t:"n",v:kr(A.v)}),A.z=r.dateNF||Le[14]):A={t:"n",v:Aa(w)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=A):n[ze({r:u,c:h})]=A,h+=m}}}}return n["!ref"]=He(g),v.length&&(n["!merges"]=v),n}function UZ(e,t,r,n){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var h=ze({r,c:o}),f=n.dense?(e[r]||[])[o]:e[h],m=f&&f.v!=null&&(f.h||ek(f.w||(no(f),f.w)||""))||"",g={};l>1&&(g.rowspan=l),c>1&&(g.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(g["data-t"]=f&&f.t||"z",f.v!=null&&(g["data-v"]=f.v),f.z!=null&&(g["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(ke("td",m,g))}}var v="<tr>";return v+i.join("")+"</tr>"}var VZ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HZ="</body></html>";function WZ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return El(dE(r[0],t),t);var n=Ek();return r.forEach(function(s,i){Ak(n,dE(s,t),"Sheet"+(i+1))}),n}function GZ(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function X8(e,t){var r=t||{},n=r.header!=null?r.header:VZ,s=r.footer!=null?r.footer:HZ,i=[n],o=rs(e["!ref"]);r.dense=Array.isArray(e),i.push(GZ(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(UZ(e,o,l,r));return i.push("</table>"+s),i.join("")}function Y8(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Ht(n.origin):n.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var h=rs(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),s==-1&&(u.e.r=s=h.e.r+1)}var f=[],m=0,g=e["!rows"]||(e["!rows"]=[]),v=0,x=0,y=0,_=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&x<c;++v){var C=l[v];if(uE(C)){if(n.display)continue;g[x]={hidden:!0}}var j=C.children;for(y=_=0;y<j.length;++y){var T=j[y];if(!(n.display&&uE(T))){var k=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):vD(T.innerHTML),M=T.getAttribute("data-z")||T.getAttribute("z");for(m=0;m<f.length;++m){var A=f[m];A.s.c==_+i&&A.s.r<x+s&&x+s<=A.e.r&&(_=A.e.c+1-i,m=-1)}w=+T.getAttribute("colspan")||1,((b=+T.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:x+s,c:_+i},e:{r:x+s+(b||1)-1,c:_+i+(w||1)-1}});var O={t:"s",v:k},F=T.getAttribute("data-t")||T.getAttribute("t")||"";k!=null&&(k.length==0?O.t=F||"z":n.raw||k.trim().length==0||F=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(Aa(k))?isNaN(Pu(k).getDate())||(O={t:"d",v:Rt(k)},n.cellDates||(O={t:"n",v:kr(O.v)}),O.z=n.dateNF||Le[14]):O={t:"n",v:Aa(k)})),O.z===void 0&&M!=null&&(O.z=M);var B="",L=T.getElementsByTagName("A");if(L&&L.length)for(var U=0;U<L.length&&!(L[U].hasAttribute("href")&&(B=L[U].getAttribute("href"),B.charAt(0)!="#"));++U);B&&B.charAt(0)!="#"&&(O.l={Target:B}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][_+i]=O):e[ze({c:_+i,r:x+s})]=O,u.e.c<_+i&&(u.e.c=_+i),_+=w}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+s),e["!ref"]=He(u),x>=c&&(e["!fullref"]=He((u.e.r=l.length-v+x-1+s,u))),e}function Q8(e,t){var r=t||{},n=r.dense?[]:{};return Y8(n,e,t)}function qZ(e,t){return El(Q8(e,t),t)}function uE(e){var t="",r=KZ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KZ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function XZ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var hE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function J8(e,t){var r=t||{},n=tk(e),s=[],i,o,l={name:""},c="",u=0,h,f,m={},g=[],v=r.dense?[]:{},x,y,_={value:""},b="",w=0,C=[],j=-1,T=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,A={},O=[],F={},B=0,L=0,U=[],P=1,Q=1,re=[],Z={Names:[]},W={},ce=["",""],te=[],D={},R="",N=0,H=!1,ee=!1,J=0;for(C0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=C0.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?v["!ref"]=He(k):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=He(k)),O.length&&(v["!merges"]=O),U.length&&(v["!rows"]=U),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),m[h.name]=v,ee=!1):x[0].charAt(x[0].length-2)!=="/"&&(h=Be(x[0],!1),j=T=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,v=r.dense?[]:{},O=[],U=[],ee=!0);break;case"table-row-group":x[1]==="/"?--M:++M;break;case"table-row":case"":if(x[1]==="/"){j+=P,P=1;break}if(f=Be(x[0],!1),f.?j=f.-1:j==-1&&(j=0),P=+f["number-rows-repeated"]||1,P<10)for(J=0;J<P;++J)M>0&&(U[j+J]={level:M});T=-1;break;case"covered-table-cell":x[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(v[j]||(v[j]=[]),v[j][T]={t:"z"}):v[ze({r:j,c:T})]={t:"z"}),b="",C=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++T,_=Be(x[0],!1),Q=parseInt(_["number-columns-repeated"]||"1",10),y={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(y.f=oE(lt(_.formula))),(_.||_["value-type"])=="string"&&(y.t="s",y.v=lt(_["string-value"]||""),r.dense?(v[j]||(v[j]=[]),v[j][T]=y):v[ze({r:j,c:T})]=y),T+=Q-1;else if(x[1]!=="/"){++T,b="",w=0,C=[],Q=1;var he=P?j+P-1:j;if(T>k.e.c&&(k.e.c=T),T<k.s.c&&(k.s.c=T),j<k.s.r&&(k.s.r=j),he>k.e.r&&(k.e.r=he),_=Be(x[0],!1),te=[],D={},y={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=lt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(B=parseInt(_["number-matrix-rows-spanned"],10)||0,L=parseInt(_["number-matrix-columns-spanned"],10)||0,F={s:{r:j,c:T},e:{r:j+B-1,c:T+L-1}},y.F=He(F),re.push([F,y.F])),_.formula)y.f=oE(_.formula);else for(J=0;J<re.length;++J)j>=re[J][0].s.r&&j<=re[J][0].e.r&&T>=re[J][0].s.c&&T<=re[J][0].e.c&&(y.F=re[J][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(B=parseInt(_["number-rows-spanned"],10)||0,L=parseInt(_["number-columns-spanned"],10)||0,F={s:{r:j,c:T},e:{r:j+B-1,c:T+L-1}},O.push(F)),_["number-columns-repeated"]&&(Q=parseInt(_["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Mt(_["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(_.value);break;case"percentage":y.t="n",y.v=parseFloat(_.value);break;case"currency":y.t="n",y.v=parseFloat(_.value);break;case"date":y.t="d",y.v=Rt(_["date-value"]),r.cellDates||(y.t="n",y.v=kr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=wV(_["time-value"])/86400,r.cellDates&&(y.t="d",y.v=N1(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(_.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",_["string-value"]!=null&&(b=lt(_["string-value"]),C=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(H=!1,y.t==="s"&&(y.v=b||"",C.length&&(y.R=C),H=w==0),W.Target&&(y.l=W),te.length>0&&(y.c=te,te=[]),b&&r.cellText!==!1&&(y.w=b),H&&(y.t="z",delete y.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var ge=0;ge<P;++ge){if(Q=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[j+ge]||(v[j+ge]=[]),v[j+ge][T]=ge==0?y:It(y);--Q>0;)v[j+ge][T+Q]=It(y);else for(v[ze({r:j+ge,c:T})]=y;--Q>0;)v[ze({r:j+ge,c:T+Q})]=It(y);k.e.c<=T&&(k.e.c=T)}Q=parseInt(_["number-columns-repeated"]||"1",10),T+=Q-1,Q=0,y={},b="",C=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i;D.t=b,C.length&&(D.R=C),D.a=R,te.push(D)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);R="",N=0,b="",w=0,C=[];break;case"creator":x[1]==="/"?R=n.slice(N,x.index):N=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);b="",w=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(A[l.name]=c,(i=s.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=Be(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Be(x[0],!1),c+=hE[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Be(x[0],!1),c+=hE[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":o=Be(x[0],!1),ce=Ky(o["cell-range-address"]);var xe={Name:o.name,Ref:ce[0]+"!"+ce[1]};ee&&(xe.Sheet=g.length),Z.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!_||!_["string-value"])){var De=XZ(n.slice(w,x.index));b=(b.length>0?b+`
`:"")+De[0]}else Be(x[0],!1),w=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ce=Ky(Be(x[0])["target-range-address"]),m[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(W=Be(x[0],!1),!W.href)break;W.Target=lt(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(ce=Ky(W.Target.slice(1)),W.Target="#"+ce[0]+"!"+ce[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var X={Sheets:m,SheetNames:g,Workbook:Z};return r.bookSheets&&delete X.Sheets,X}function fE(e,t){t=t||{},Vs(e,"META-INF/manifest.xml")&&wH(dr(e,"META-INF/manifest.xml"),t);var r=ms(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=J8(Ct(r),t);return Vs(e,"meta.xml")&&(n.Props=UD(dr(e,"meta.xml"))),n}function pE(e,t){return J8(e,t)}var YZ=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+S0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ir+t}}(),mE=function(){var e=function(i){return kt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+kt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,h=0,f=rs(i["!ref"]||"A1"),m=i["!merges"]||[],g=0,v=Array.isArray(i);if(i["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",y=i["!rows"]||[];for(u=0;u<f.s.r;++u)x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)c.push(t);for(;h<=f.e.c;++h){var _=!1,b={},w="";for(g=0;g!=m.length;++g)if(!(m[g].s.c>h)&&!(m[g].s.r>u)&&!(m[g].e.c<h)&&!(m[g].e.r<u)){(m[g].s.c!=h||m[g].s.r!=u)&&(_=!0),b["table:number-columns-spanned"]=m[g].e.c-m[g].s.c+1,b["table:number-rows-spanned"]=m[g].e.r-m[g].s.r+1;break}if(_){c.push(r);continue}var C=ze({r:u,c:h}),j=v?(i[u]||[])[h]:i[C];if(j&&j.f&&(b["table:formula"]=kt(gY(j.f)),j.F&&j.F.slice(0,C.length)==C)){var T=rs(j.F);b["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,b["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":w=j.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=j.v?"true":"false";break;case"n":w=j.w||String(j.v||0),b["office:value-type"]="float",b["office:value"]=j.v||0;break;case"s":case"str":w=j.v==null?"":j.v,b["office:value-type"]="string";break;case"d":w=j.w||Rt(j.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Rt(j.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(w);if(j.l&&j.l.Target){var M=j.l.Target;M=M.charAt(0)=="#"?"#"+xY(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),k=ke("text:a",k,{"xlink:href":M.replace(/&/g,"&amp;")})}c.push("          "+ke("table:table-cell",ke("text:p",k,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;_l(f),f.ods=l;var m=u["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=c;var f=u["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ir],u=S0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=S0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+h+`>
`),c.push(BD().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Z8(e,t){if(t.bookType=="fods")return mE(e,t);var r=Qj(),n="",s=[],i=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,mE(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",qe(r,n,YZ(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",qe(r,n,ir+BD()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,SH(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,jH(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function v2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ct(Tl(e))}function QZ(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ps(ci(e))}function JZ(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function jl(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function gE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ZZ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function eee(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function D0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function bt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Jt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ht(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=D0(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=D0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Br(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(bt(n*8+s.type)),s.type==2&&t.push(bt(s.data.length)),t.push(s.data))})}),jl(t)}function kk(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function zs(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=D0(e,n),i=ht(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Jt(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=ht(l.data),u=Jt(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=Jt(i[3][0].data)>>>0>0),r.push(o)}return r}function vd(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:bt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:bt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:bt(o.data.length)}],n[2].push({data:Br(o.meta),type:2})});var i=Br(n);t.push(bt(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),jl(t)}function tee(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=D0(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[jl(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var h=jl(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Bs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tee(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return jl(t)}function yd(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=bt(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return jl(t)}function ree(e,t,r,n){var s=Xc(e),i=s.getUint32(4,!0),o=(n>1?12:8)+gE(i&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,h=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=gE(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(u=s.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function nee(e,t,r){var n=Xc(e),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);s&1&&(c=ZZ(e,i),i+=16),s&2&&(u=n.getFloat64(i,!0),i+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Yy(e,t){var r=new Uint8Array(32),n=Xc(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,eee(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Qy(e,t){var r=new Uint8Array(32),n=Xc(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function see(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ree(e,t,r,e[0]);case 5:return nee(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function en(e){var t=ht(e);return D0(t[1][0].data)}function xE(e,t){var r=ht(t.data),n=Jt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=ht(o.data),c=Jt(l[1][0].data)>>>0;switch(n){case 1:i[c]=v2(l[3][0].data);break;case 8:{var u=e[en(l[9][0].data)][0],h=ht(u.data),f=e[en(h[1][0].data)][0],m=Jt(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=ht(f.data);i[c]=g[3].map(function(v){return v2(v.data)}).join("")}break}}),i}function aee(e,t){var r,n,s,i,o,l,c,u,h,f,m,g,v,x,y=ht(e),_=Jt(y[1][0].data)>>>0,b=Jt(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Jt(y[8][0].data)>0||!1,C,j;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&t!=0)C=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(h=y[4])==null?void 0:h[0])!=null&&f.data&&t!=1)C=(g=(m=y[4])==null?void 0:m[0])==null?void 0:g.data,j=(x=(v=y[3])==null?void 0:v[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=w?4:1,k=Xc(C),M=[],A=0;A<C.length/2;++A){var O=k.getUint16(A*2,!0);O<65535&&M.push([A,O])}if(M.length!=b)throw"Expected ".concat(b," cells, found ").concat(M.length);var F=[];for(A=0;A<M.length-1;++A)F[M[A][0]]=j.subarray(M[A][1]*T,M[A+1][1]*T);return M.length>=1&&(F[M[M.length-1][0]]=j.subarray(M[M.length-1][1]*T)),{R:_,cells:F}}function iee(e,t){var r,n=ht(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Jt(n[7][0].data)>>>0>0?1:0:-1,i=kk(n[5],function(o){return aee(o,s)});return{nrows:Jt(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function oee(e,t,r){var n,s=ht(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Jt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Jt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=He(i);var o=ht(s[4][0].data),l=xE(e,e[en(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?xE(e,e[en(o[17][0].data)][0]):[],u=ht(o[3][0].data),h=0;u[1].forEach(function(f){var m=ht(f.data),g=e[en(m[2][0].data)][0],v=Jt(g.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var x=iee(e,g);x.data.forEach(function(y,_){y.forEach(function(b,w){var C=ze({r:h+_,c:w}),j=see(b,l,c);j&&(r[C]=j)})}),h+=x.nrows})}function lee(e,t){var r=ht(t.data),n={"!ref":"A1"},s=e[en(r[2][0].data)],i=Jt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return oee(e,s[0],n),n}function cee(e,t){var r,n=ht(t.data),s={name:(r=n[1])!=null&&r[0]?v2(n[1][0].data):"",sheets:[]},i=kk(n[2],en);return i.forEach(function(o){e[o].forEach(function(l){var c=Jt(l.meta[1][0].data);c==6e3&&s.sheets.push(lee(e,l))})}),s}function dee(e,t){var r=Ek(),n=ht(t.data),s=kk(n[1],en);if(s.forEach(function(i){e[i].forEach(function(o){var l=Jt(o.meta[1][0].data);if(l==2){var c=cee(e,o);c.sheets.forEach(function(u,h){Ak(r,u,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Jy(e){var t,r,n,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Bs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=zs(u)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Jt(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(u){var h=Jt(u.meta[1][0].data)>>>0;if(h==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return dee(i,l)}function uee(e,t,r){var n,s,i,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Jt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Xc(e[7][0].data),h=0,f=[],m=Xc(e[4][0].data),g=0,v=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),m.setUint16(x*2,g,!0);var y,_;switch(typeof t[x]){case"string":y=Yy({t:"s",v:t[x]},r),_=Qy({t:"s",v:t[x]},r);break;case"number":y=Yy({t:"n",v:t[x]},r),_=Qy({t:"n",v:t[x]},r);break;case"boolean":y=Yy({t:"b",v:t[x]},r),_=Qy({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(y),h+=y.length,v.push(_),g+=_.length,++c}for(e[2][0].data=bt(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=jl(f),e[3][0].data=jl(v),c}function hee(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=rs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(He(n)));var i=Jx(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(N){typeof N=="string"&&o.push(N)})});var l={},c=[],u=Ie.read(t.numbers,{type:"base64"});u.FileIndex.map(function(R,N){return[R,u.FullPaths[N]]}).forEach(function(R){var N=R[0],H=R[1];if(N.type==2&&N.name.match(/\.iwa/)){var ee=N.content,J=Bs(ee),he=zs(J);he.forEach(function(ge){c.push(ge.id),l[ge.id]={deps:[],location:H,type:Jt(ge.messages[0].meta[1][0].data)}})}}),c.sort(function(R,N){return R-N});var h=c.filter(function(R){return R>1}).map(function(R){return[R,bt(R)]});u.FileIndex.map(function(R,N){return[R,u.FullPaths[N]]}).forEach(function(R){var N=R[0];if(R[1],!!N.name.match(/\.iwa/)){var H=zs(Bs(N.content));H.forEach(function(ee){ee.messages.forEach(function(J){h.forEach(function(he){ee.messages.some(function(ge){return Jt(ge.meta[1][0].data)!=11006&&JZ(ge.data,he[1])})&&l[he[0]].deps.push(ee.id)})})})}});for(var f=Ie.find(u,l[1].location),m=zs(Bs(f.content)),g,v=0;v<m.length;++v){var x=m[v];x.id==1&&(g=x)}var y=en(ht(g.messages[0].data)[1][0].data);for(f=Ie.find(u,l[y].location),m=zs(Bs(f.content)),v=0;v<m.length;++v)x=m[v],x.id==y&&(g=x);for(y=en(ht(g.messages[0].data)[2][0].data),f=Ie.find(u,l[y].location),m=zs(Bs(f.content)),v=0;v<m.length;++v)x=m[v],x.id==y&&(g=x);for(y=en(ht(g.messages[0].data)[2][0].data),f=Ie.find(u,l[y].location),m=zs(Bs(f.content)),v=0;v<m.length;++v)x=m[v],x.id==y&&(g=x);var _=ht(g.messages[0].data);{_[6][0].data=bt(n.e.r+1),_[7][0].data=bt(n.e.c+1);var b=en(_[46][0].data),w=Ie.find(u,l[b].location),C=zs(Bs(w.content));{for(var j=0;j<C.length&&C[j].id!=b;++j);if(C[j].id!=b)throw"Bad ColumnRowUIDMapArchive";var T=ht(C[j].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var k=0;k<=n.e.c;++k){var M=[];M[1]=M[2]=[{type:0,data:bt(k+420690)}],T[1].push({type:2,data:Br(M)}),T[2].push({type:0,data:bt(k)}),T[3].push({type:0,data:bt(k)})}T[4]=[],T[5]=[],T[6]=[];for(var A=0;A<=n.e.r;++A)M=[],M[1]=M[2]=[{type:0,data:bt(A+726270)}],T[4].push({type:2,data:Br(M)}),T[5].push({type:0,data:bt(A)}),T[6].push({type:0,data:bt(A)});C[j].messages[0].data=Br(T)}w.content=yd(vd(C)),w.size=w.content.length,delete _[46];var O=ht(_[4][0].data);{O[7][0].data=bt(n.e.r+1);var F=ht(O[1][0].data),B=en(F[2][0].data);w=Ie.find(u,l[B].location),C=zs(Bs(w.content));{if(C[0].id!=B)throw"Bad HeaderStorageBucket";var L=ht(C[0].messages[0].data);for(A=0;A<i.length;++A){var U=ht(L[2][0].data);U[1][0].data=bt(A),U[4][0].data=bt(i[A].length),L[2][A]={type:L[2][0].type,data:Br(U)}}C[0].messages[0].data=Br(L)}w.content=yd(vd(C)),w.size=w.content.length;var P=en(O[2][0].data);w=Ie.find(u,l[P].location),C=zs(Bs(w.content));{if(C[0].id!=P)throw"Bad HeaderStorageBucket";for(L=ht(C[0].messages[0].data),k=0;k<=n.e.c;++k)U=ht(L[2][0].data),U[1][0].data=bt(k),U[4][0].data=bt(n.e.r+1),L[2][k]={type:L[2][0].type,data:Br(U)};C[0].messages[0].data=Br(L)}w.content=yd(vd(C)),w.size=w.content.length;var Q=en(O[4][0].data);(function(){for(var R=Ie.find(u,l[Q].location),N=zs(Bs(R.content)),H,ee=0;ee<N.length;++ee){var J=N[ee];J.id==Q&&(H=J)}var he=ht(H.messages[0].data);{he[3]=[];var ge=[];o.forEach(function(X,rt){ge[1]=[{type:0,data:bt(rt)}],ge[2]=[{type:0,data:bt(1)}],ge[3]=[{type:2,data:QZ(X)}],he[3].push({type:2,data:Br(ge)})})}H.messages[0].data=Br(he);var xe=vd(N),De=yd(xe);R.content=De,R.size=R.content.length})();var re=ht(O[3][0].data);{var Z=re[1][0];delete re[2];var W=ht(Z.data);{var ce=en(W[2][0].data);(function(){for(var R=Ie.find(u,l[ce].location),N=zs(Bs(R.content)),H,ee=0;ee<N.length;++ee){var J=N[ee];J.id==ce&&(H=J)}var he=ht(H.messages[0].data);{delete he[6],delete re[7];var ge=new Uint8Array(he[5][0].data);he[5]=[];for(var xe=0,De=0;De<=n.e.r;++De){var X=ht(ge);xe+=uee(X,i[De],o),X[1][0].data=bt(De),he[5].push({data:Br(X),type:2})}he[1]=[{type:0,data:bt(n.e.c+1)}],he[2]=[{type:0,data:bt(n.e.r+1)}],he[3]=[{type:0,data:bt(xe)}],he[4]=[{type:0,data:bt(n.e.r+1)}]}H.messages[0].data=Br(he);var rt=vd(N),We=yd(rt);R.content=We,R.size=R.content.length})()}Z.data=Br(W)}O[3][0].data=Br(re)}_[4][0].data=Br(O)}g.messages[0].data=Br(_);var te=vd(m),D=yd(te);return f.content=D,f.size=f.content.length,u}function e6(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Sk(e){e6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ck(e){e6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function fee(e){return Je.WS.indexOf(e)>-1?"sheet":e==Je.CS?"chart":e==Je.DS?"dialog":e==Je.MS?"macro":e&&e.length?e:"sheet"}function pee(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,fee(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mee(e,t,r,n,s,i,o,l,c,u,h,f){try{i[n]=Gf(ms(e,r,!0),t);var m=dr(e,t),g;switch(l){case"sheet":g=IJ(m,t,s,c,i[n],u,h,f);break;case"chart":if(g=NJ(m,t,s,c,i[n],u,h,f),!g||!g["!drawel"])break;var v=Tf(g["!drawel"].Target,t),x=$0(v),y=kK(ms(e,v,!0),Gf(ms(e,x,!0),v)),_=Tf(y,v),b=$0(_);g=uJ(ms(e,_,!0),_,c,Gf(ms(e,b,!0),_),u,g);break;case"macro":g=LJ(m,t,s,c,i[n],u,h,f);break;case"dialog":g=zJ(m,t,s,c,i[n],u,h,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=g;var w=[];i&&i[n]&&er(i[n]).forEach(function(C){var j="";if(i[n][C].Type==Je.CMNT){j=Tf(i[n][C].Target,t);var T=HJ(dr(e,j,!0),j,c);if(!T||!T.length)return;rE(g,T,!1)}i[n][C].Type==Je.TCMNT&&(j=Tf(i[n][C].Target,t),w=w.concat(CK(dr(e,j,!0),c)))}),w&&w.length&&rE(g,w,!0,c.people||[])}catch(C){if(c.WTF)throw C}}function Os(e){return e.charAt(0)=="/"?e.slice(1):e}function gee(e,t){if(Gu(),t=t||{},Sk(t),Vs(e,"META-INF/manifest.xml")||Vs(e,"objectdata.xml"))return fE(e,t);if(Vs(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Jy<"u"){if(e.FileIndex)return Jy(e);var r=Ie.utils.cfb_new();return jT(e).forEach(function(U){qe(r,U,$V(e,U))}),Jy(r)}throw new Error("Unsupported NUMBERS file")}if(!Vs(e,"[Content_Types].xml"))throw Vs(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vs(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=jT(e),s=bH(ms(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",dr(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!dr(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(qf=[],s.sst)try{qf=VJ(dr(e,Os(s.sst)),s.sst,t)}catch(U){if(t.WTF)throw U}t.cellStyles&&s.themes.length&&(c=UJ(ms(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=BJ(dr(e,Os(s.style)),s.style,c,t))}s.links.map(function(U){try{var P=Gf(ms(e,$0(Os(U))),U);return GJ(dr(e,Os(U)),P,U,t)}catch{}});var h=RJ(dr(e,Os(s.workbooks[0])),s.workbooks[0],t),f={},m="";s.coreprops.length&&(m=dr(e,Os(s.coreprops[0]),!0),m&&(f=UD(m)),s.extprops.length!==0&&(m=dr(e,Os(s.extprops[0]),!0),m&&$H(m,f,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=ms(e,Os(s.custprops[0]),!0),m&&(g=EH(m,t)));var v={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(P){return P.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(v.Props=f,v.Custprops=g),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var x={};t.bookDeps&&s.calcchain&&(x=WJ(dr(e,Os(s.calcchain)),s.calcchain));var y=0,_={},b,w;{var C=h.Sheets;f.Worksheets=C.length,f.SheetNames=[];for(var j=0;j!=C.length;++j)f.SheetNames[j]=C[j].name}var T=i?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),M=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Vs(e,M)||(M="xl/_rels/workbook."+T+".rels");var A=Gf(ms(e,M,!0),M.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=qJ(dr(e,Os(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=TK(dr(e,Os(s.people[0])),t)),A&&(A=pee(A,h.Sheets));var O=dr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var F="sheet";if(A&&A[y]?(b="xl/"+A[y][1].replace(/[\/]?xl\//,""),Vs(e,b)||(b=A[y][1]),Vs(e,b)||(b=M.replace(/_rels\/.*$/,"")+A[y][1]),F=A[y][2]):(b="xl/worksheets/sheet"+(y+1-O)+"."+T,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var B=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==y&&(B=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[y].toLowerCase()&&(B=1);if(!B)continue e}}mee(e,b,w,f.SheetNames[y],y,_,o,F,t,h,c,u)}return v={Directory:s,Workbook:h,Props:f,Custprops:g,Deps:x,Sheets:o,SheetNames:f.SheetNames,Strings:qf,Styles:u,Themes:c,SSF:It(Le)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(U,P){U=U.replace(/^Root Entry[\/]/,""),v.keys.push(U),v.files[U]=e.FileIndex[P]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=dr(e,Os(s.vba[0]),!0):s.defaults&&s.defaults.bin===RK&&(v.vbaraw=dr(e,"xl/vbaProject.bin",!0))),v}function xee(e,t){var r=t||{},n="Workbook",s=Ie.find(e,n);try{if(n="/!DataSpaces/Version",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(qG(s.content),n="/!DataSpaces/DataSpaceMap",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=XG(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=YG(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);JG(s.content)}catch{}if(n="/EncryptionInfo",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=ZG(s.content);if(n="/EncryptedPackage",s=Ie.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function vee(e,t){return t.bookType=="ods"?Z8(e,t):t.bookType=="numbers"?hee(e,t):t.bookType=="xlsb"?yee(e,t):bee(e,t)}function yee(e,t){Gd=1024,e&&!e.SSF&&(e.SSF=It(Le)),e&&e.SSF&&(Gu(),O1(e.SSF),t.revssf=I1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=$8.indexOf(t.bookType)>-1,s=uk();Ck(t=t||{});var i=Qj(),o="",l=0;if(t.cellXfs=[],Al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(i,o,VD(e.Props,t)),s.coreprops.push(o),_t(t.rels,2,o,Je.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,qe(i,o,GD(e.Props)),s.extprops.push(o),_t(t.rels,3,o,Je.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(i,o,qD(e.Custprops)),s.custprops.push(o),_t(t.rels,4,o,Je.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,qe(i,o,XJ(l-1,o,t,e,h)),s.sheets.push(o),_t(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Je.WS[0])}if(f){var g=f["!comments"],v=!1,x="";g&&g.length>0&&(x="xl/comments"+l+"."+r,qe(i,x,JJ(g,x)),s.comments.push(x),_t(h,-1,"../comments"+l+"."+r,Je.CMNT),v=!0),f["!legacy"]&&v&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",S8(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qe(i,$0(o),tu(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(i,o,QJ(t.Strings,o,t)),s.strs.push(o),_t(t.wbrels,-1,"sharedStrings."+r,Je.SST)),o="xl/workbook."+r,qe(i,o,KJ(e,o)),s.workbooks.push(o),_t(t.rels,1,o,Je.WB),o="xl/theme/theme1.xml",qe(i,o,xk(e.Themes,t)),s.themes.push(o),_t(t.wbrels,-1,"theme/theme1.xml",Je.THEME),o="xl/styles."+r,qe(i,o,YJ(e,o,t)),s.styles.push(o),_t(t.wbrels,-1,"styles."+r,Je.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",qe(i,o,e.vbaraw),s.vba.push(o),_t(t.wbrels,-1,"vbaProject.bin",Je.VBA)),o="xl/metadata."+r,qe(i,o,ZJ(o)),s.metadata.push(o),_t(t.wbrels,-1,"metadata."+r,Je.XLMETA),qe(i,"[Content_Types].xml",zD(s,t)),qe(i,"_rels/.rels",tu(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",tu(t.wbrels)),delete t.revssf,delete t.ssf,i}function bee(e,t){Gd=1024,e&&!e.SSF&&(e.SSF=It(Le)),e&&e.SSF&&(Gu(),O1(e.SSF),t.revssf=I1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=$8.indexOf(t.bookType)>-1,s=uk();Ck(t=t||{});var i=Qj(),o="",l=0;if(t.cellXfs=[],Al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(i,o,VD(e.Props,t)),s.coreprops.push(o),_t(t.rels,2,o,Je.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,o,GD(e.Props)),s.extprops.push(o),_t(t.rels,3,o,Je.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(i,o,qD(e.Custprops)),s.custprops.push(o),_t(t.rels,4,o,Je.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,qe(i,o,N8(l-1,t,e,f)),s.sheets.push(o),_t(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Je.WS[0])}if(m){var v=m["!comments"],x=!1,y="";if(v&&v.length>0){var _=!1;v.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(_=!0)})}),_&&(y="xl/threadedComments/threadedComment"+l+"."+r,qe(i,y,$K(v,h,t)),s.threadedcomments.push(y),_t(f,-1,"../threadedComments/threadedComment"+l+"."+r,Je.TCMNT)),y="xl/comments"+l+"."+r,qe(i,y,C8(v)),s.comments.push(y),_t(f,-1,"../comments"+l+"."+r,Je.CMNT),x=!0}m["!legacy"]&&x&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",S8(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&qe(i,$0(o),tu(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(i,o,f8(t.Strings,t)),s.strs.push(o),_t(t.wbrels,-1,"sharedStrings."+r,Je.SST)),o="xl/workbook."+r,qe(i,o,V8(e)),s.workbooks.push(o),_t(t.rels,1,o,Je.WB),o="xl/theme/theme1.xml",qe(i,o,xk(e.Themes,t)),s.themes.push(o),_t(t.wbrels,-1,"theme/theme1.xml",Je.THEME),o="xl/styles."+r,qe(i,o,_8(e,t)),s.styles.push(o),_t(t.wbrels,-1,"styles."+r,Je.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",qe(i,o,e.vbaraw),s.vba.push(o),_t(t.wbrels,-1,"vbaProject.bin",Je.VBA)),o="xl/metadata."+r,qe(i,o,k8()),s.metadata.push(o),_t(t.wbrels,-1,"metadata."+r,Je.XLMETA),h.length>1&&(o="xl/persons/person.xml",qe(i,o,EK(h)),s.people.push(o),_t(t.wbrels,-1,"persons/person.xml",Je.PEOPLE)),qe(i,"[Content_Types].xml",zD(s,t)),qe(i,"_rels/.rels",tu(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",tu(t.wbrels)),delete t.revssf,delete t.ssf,i}function $k(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _ee(e,t){return Ie.find(e,"EncryptedPackage")?xee(e,t):q8(e,t)}function wee(e,t){var r,n=e,s=t||{};return s.type||(s.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=mD(n,s),gee(r,s)}function t6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return g2(e.slice(r),t);default:break e}return Du.to_workbook(e,t)}function jee(e,t){var r="",n=$k(e,t);switch(t.type){case"base64":r=bs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Wc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ct(r)),t.type="binary",t6(r,t)}function kee(e,t){var r=e;return t.type=="base64"&&(r=bs(r)),r=_0.utils.decode(1200,r.slice(2),"str"),t.type="binary",t6(r,t)}function See(e){return e.match(/[^\x00-\x7F]/)?ci(e):e}function Zy(e,t,r,n){return n?(r.type="string",Du.to_workbook(e,r)):Du.to_workbook(t,r)}function y2(e,t){Gj();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return y2(new Uint8Array(e),(r=It(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),nu={},r.dateNF&&(nu.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=yV(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=See(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=It(r),r.type="array",y2(qj(n),r)}switch((s=$k(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return _ee(Ie.read(n,r),r);break;case 9:if(s[1]<=8)return q8(n,r);break;case 60:return g2(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return AG(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return u8.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?wee(n,r):Zy(e,n,r,i);case 239:return s[3]===60?g2(n,r):Zy(e,n,r,i);case 255:if(s[1]===254)return kee(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Pc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Pc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return m2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return v8.to_workbook(n,r);break;case 10:case 13:case 32:return jee(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return EG.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?m2.to_workbook(n,r):Zy(e,n,r,i)}function r6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return sp(t.file,Ie.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ie.write(e,t)}function Cee(e,t){var r=It(t||{}),n=vee(e,r);return $ee(n,r)}function $ee(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ie.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(M1(s))}return t.password&&typeof encrypt_agile<"u"?r6(encrypt_agile(s,t.password),t):t.type==="file"?sp(t.file,s):t.type=="string"?Ct(s):s}function Tee(e,t){var r=t||{},n=SZ(e,r);return r6(n,r)}function Ja(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return w0(ci(n));case"binary":return ci(n);case"string":return e;case"file":return sp(t.file,n,"utf8");case"buffer":return Qe?ao(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ja(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Eee(e,t){switch(t.type){case"base64":return w0(e);case"binary":return e;case"string":return e;case"file":return sp(t.file,e,"binary");case"buffer":return Qe?ao(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function xm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?w0(r):t.type=="string"?Ct(r):r;case"file":return sp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function n6(e,t){Gj(),_J(e);var r=It(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=n6(e,r);return r.type="array",M1(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ja(vZ(e,r),r);case"slk":case"sylk":return Ja(d8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ja(X8(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Eee(s6(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ja(Tk(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ja(u8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return xm(m2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ja(Du.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ja(v8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ja(h8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ja(Z8(e,r),r);case"wk1":return xm(Pc.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return xm(Pc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xm(K8(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Tee(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Cee(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Aee(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Fee(e,t,r){var n={};return n.type="file",n.file=t,Aee(n),n6(e,n)}function Pee(e,t,r,n,s,i,o,l){var c=ar(r),u=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var g=t.s.c;g<=t.e.c;++g){var v=o?e[r][g]:e[n[g]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;i[g]!=null&&(m[i[g]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[g]!=null){if(x==null)if(v.t=="e"&&x===null)m[i[g]]=null;else if(u!==void 0)m[i[g]]=u;else if(h&&x===null)m[i[g]]=null;else continue;else m[i[g]]=h&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?x:no(v,x,l);x!=null&&(f=!1)}}return{row:m,isempty:f}}function Jx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":c=ct(h);break;case"number":c=ct(e["!ref"]),c.s.r=h;break;default:c=h}n>0&&(s=0);var f=ar(c.s.r),m=[],g=[],v=0,x=0,y=Array.isArray(e),_=c.s.r,b=0,w={};y&&!e[_]&&(e[_]=[]);var C=u.skipHidden&&e["!cols"]||[],j=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(C[b]||{}).hidden)switch(m[b]=Vt(b),r=y?e[_][b]:e[m[b]+f],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=m[b];break;case 3:i[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=no(r,null,u),x=w[o]||0,!x)w[o]=1;else{do l=o+"_"+x++;while(w[l]);w[o]=x,w[l]=1}i[b]=l}for(_=c.s.r+s;_<=c.e.r;++_)if(!(j[_]||{}).hidden){var T=Pee(e,c,_,m,n,i,y,u);(T.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[v++]=T.row)}return g.length=v,g}var vE=/"/g;function Dee(e,t,r,n,s,i,o,l){for(var c=!0,u=[],h="",f=ar(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var g=l.dense?(e[r]||[])[m]:e[n[m]+f];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(l.rawNumbers&&g.t=="n"?g.v:no(g,null,l));for(var v=0,x=0;v!==h.length;++v)if((x=h.charCodeAt(v))===s||x===i||x===34||l.forceQuotes){h='"'+h.replace(vE,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(vE,'""')+'"')):h="";u.push(h)}return l.blankrows===!1&&c?null:u.join(o)}function Tk(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=ct(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),h="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(m[v]||{}).hidden||(f[v]=Vt(v));for(var x=0,y=s.s.r;y<=s.e.r;++y)(g[y]||{}).hidden||(h=Dee(e,s,y,f,o,c,i,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((x++?l:"")+h)));return delete n.dense,r.join("")}function s6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Tk(e,t);return r}function Mee(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=ct(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Vt(l);for(var h=s.s.r;h<=s.e.r;++h)for(i=ar(h),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=u?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function a6(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ht(n.origin):n.origin;o=c.r,l=c.c}var u,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var f=ct(i["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),o==-1&&(o=f.e.r+1,h.e.r=o+t.length-1+s)}else o==-1&&(o=0,h.e.r=t.length-1+s);var m=n.header||[],g=0;t.forEach(function(x,y){er(x).forEach(function(_){(g=m.indexOf(_))==-1&&(m[g=m.length]=_);var b=x[_],w="z",C="",j=ze({c:l+g,r:o+y+s});u=M0(i,j),b&&typeof b=="object"&&!(b instanceof Date)?i[j]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=kr(b)),C=n.dateNF||Le[14]):b===null&&n.nullError&&(w="e",b=0),u?(u.t=w,u.v=b,delete u.w,delete u.R,C&&(u.z=C)):i[j]=u={t:w,v:b},C&&(u.z=C))})}),h.e.c=Math.max(h.e.c,l+m.length-1);var v=ar(o);if(s)for(g=0;g<m.length;++g)i[Vt(g+l)+v]={t:"s",v:m[g]};return i["!ref"]=He(h),i}function Oee(e,t){return a6(null,e,t)}function M0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ht(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?M0(e,ze(t)):M0(e,ze({r:t,c:r||0}))}function Ree(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ek(){return{SheetNames:[],Sheets:{}}}function Ak(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(U8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Iee(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Ree(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Nee(e,t){return e.z=t,e}function i6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Lee(e,t,r){return i6(e,"#"+t,r)}function zee(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Bee(e,t,r,n){for(var s=typeof t!="string"?t:ct(t),i=typeof t=="string"?t:He(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=M0(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var vm={encode_col:Vt,encode_row:ar,encode_cell:ze,encode_range:He,decode_col:ak,decode_row:sk,split_cell:QV,decode_cell:Ht,decode_range:rs,format_cell:no,sheet_add_aoa:DD,sheet_add_json:a6,sheet_add_dom:Y8,aoa_to_sheet:qu,json_to_sheet:Oee,table_to_sheet:Q8,table_to_book:qZ,sheet_to_csv:Tk,sheet_to_txt:s6,sheet_to_json:Jx,sheet_to_html:X8,sheet_to_formulae:Mee,sheet_to_row_object_array:Jx,sheet_get_cell:M0,book_new:Ek,book_append_sheet:Ak,book_set_sheet_visibility:Iee,cell_set_number_format:Nee,cell_set_hyperlink:i6,cell_set_internal_link:Lee,cell_add_comment:zee,sheet_set_array_formula:Bee,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Uee=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,Vee=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,Hee=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,Wee=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`,Gee=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.xl};
`,eb=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  background: ${({$active:e,$completed:t})=>e?d.colors.primary:t?`${d.colors.success}20`:d.colors.bgLight};
  color: ${({$active:e,$completed:t})=>e?"white":t?d.colors.success:d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,tb=p.span`
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: ${({$active:e})=>e?"white":"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:"inherit"};
  border: 2px solid currentColor;
`,rb=p.div`
  margin-bottom: ${d.spacing.xl};
`,nb=p.h3`
  font-size: ${d.typography.sizes.h4};
  color: ${d.colors.textPrimary};
  margin: 0 0 ${d.spacing.md} 0;
`,qee=p.div`
  border: 2px dashed ${({$isDragging:e,$hasFile:t})=>e?d.colors.primary:t?d.colors.success:d.colors.border};
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  text-align: center;
  background: ${({$isDragging:e})=>e?`${d.colors.primary}05`:"transparent"};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    background: ${d.colors.primary}05;
  }
`,Kee=p.div`
  font-size: 48px;
  margin-bottom: ${d.spacing.md};
`,Xee=p.p`
  color: ${d.colors.textSecondary};
  margin: 0 0 ${d.spacing.sm} 0;
`,Yee=p.span`
  color: ${d.colors.textMuted};
  font-size: ${d.typography.sizes.small};
`,Qee=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.md};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  margin-top: ${d.spacing.md};
`,Jee=p.span`
  flex: 1;
  font-weight: ${d.typography.weights.medium};
`,Zee=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,ete=p.button`
  background: none;
  border: none;
  color: ${d.colors.danger};
  cursor: pointer;
  padding: ${d.spacing.xs};

  &:hover {
    opacity: 0.7;
  }
`,yE=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: ${d.typography.sizes.small};
`,Eh=p.th`
  text-align: left;
  padding: ${d.spacing.sm};
  background: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
`,Ah=p.td`
  padding: ${d.spacing.sm};
  border: 1px solid ${d.colors.border};
  background: ${({$error:e})=>e?`${d.colors.danger}10`:"transparent"};
`,tte=p.span`
  color: ${d.colors.danger};
  font-size: ${d.typography.sizes.tiny};
  display: block;
`,bE=p.div`
  max-height: 400px;
  overflow: auto;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
`,_E=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
`,Il=p.div`
  padding: ${d.spacing.md};
  background: ${({$color:e})=>e?`${e}10`:d.colors.bgLight};
  border-radius: ${d.radius.md};
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Nl=p.div`
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  color: ${d.colors.textPrimary};
`,Ll=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
`,wE=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,ym=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,bm=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:e==="error"?`${d.colors.danger}15`:`${d.colors.primary}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:e==="error"?d.colors.danger:d.colors.primary};
`,rte=p.div`
  width: 100%;
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  margin: ${d.spacing.md} 0;
`,nte=p.div`
  width: ${({$percent:e})=>e}%;
  height: 100%;
  background: ${d.colors.primary};
  transition: width 0.3s ease;
`,jE=p.a`
  color: ${d.colors.primary};
  text-decoration: none;
  font-size: ${d.typography.sizes.small};
  cursor: pointer;

  &:hover {
    text-decoration: underline;
  }
`,ste=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  min-width: 250px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,ate=p.div`
  margin-bottom: ${d.spacing.md};
`,ite=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`;function ote({tablaKey:e,onNavigate:t}){const[r,n]=E.useState(1),[s,i]=E.useState(e||""),[o,l]=E.useState(null),[c,u]=E.useState([]),[h,f]=E.useState(null),[m,g]=E.useState(!1),[v,x]=E.useState([]),[y,_]=E.useState(!1),[b,w]=E.useState(0),[C,j]=E.useState(null),[T,k]=E.useState(null),M=E.useRef(null);E.useEffect(()=>{(async()=>{try{const N=await Ri.getTablas();if(u(N),e){const H=N.find(ee=>ee.key===e);H&&l(H)}}catch(N){console.error("Error loading tablas:",N)}})()},[e]);const A=E.useCallback(async R=>{if(i(R),f(null),x([]),R){const N=c.find(H=>H.key===R);N&&l(N)}else l(null)},[c]),O=R=>{R.preventDefault(),g(!0)},F=()=>{g(!1)},B=R=>{R.preventDefault(),g(!1);const N=R.dataTransfer.files[0];N&&U(N)},L=R=>{var H;const N=(H=R.target.files)==null?void 0:H[0];N&&U(N)},U=async R=>{if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(R.type)&&!R.name.match(/\.(csv|xlsx|xls)$/i)){k("Formato de archivo no valido. Use CSV o Excel (.xlsx, .xls)");return}f(R),k(null);try{let H;if(R.name.match(/\.(xlsx|xls)$/i)){const ee=await R.arrayBuffer(),J=y2(ee,{type:"array"}),he=J.SheetNames[0],ge=J.Sheets[he];H=vm.sheet_to_json(ge,{header:1,raw:!1,defval:""})}else{const ee=await R.text();H=P(ee)}Q(H)}catch(H){k("Error al leer el archivo. Verifique que el formato sea correcto."),console.error(H)}},P=R=>R.trim().split(`
`).map(H=>{const ee=[];let J="",he=!1;for(const ge of H)ge==='"'?he=!he:(ge===","||ge===";")&&!he?(ee.push(J.trim()),J=""):J+=ge;return ee.push(J.trim()),ee}),Q=R=>{if(R.length<2){k("El archivo debe tener al menos una fila de encabezados y una de datos");return}const N=R[0].map(J=>J.toLowerCase().trim()),H=(o==null?void 0:o.columns.filter(J=>J!=="id"&&J!=="active"&&J!=="created_at"&&J!=="updated_at"))||[],ee=R.slice(1).map((J,he)=>{const ge={},xe=[];return N.forEach((De,X)=>{const rt=J[X]||"";ge[De]=rt}),H.forEach(De=>{!ge[De]&&De!=="active"&&["nombre","codigo","descripcion","denominacion"].includes(De)&&(ge[De]||xe.push(`Campo "${De}" es requerido`))}),{rowIndex:he+2,data:ge,errors:xe,isValid:xe.length===0}});x(ee),ee.length>0&&n(2)},re=()=>{f(null),x([]),n(1),M.current&&(M.current.value="")},Z=async()=>{if(!s||v.length===0)return;_(!0),w(10),j(null);const R=v.filter(N=>N.isValid);try{w(30);const N=R.map(J=>({data:J.data})),H=await Ri.bulkUpload(s,N);w(100);const ee={success:H.insertados,failed:H.errores,errors:H.detalles_errores.map(J=>({row:J.fila,error:J.error}))};j(ee)}catch(N){const H={success:0,failed:R.length,errors:[{row:0,error:N instanceof Error?N.message:"Error en carga masiva"}]};j(H)}_(!1),n(3)},W=(R="xlsx")=>{if(!o)return;const N=o.columns.filter(H=>H!=="id"&&H!=="active"&&H!=="created_at"&&H!=="updated_at");if(R==="xlsx"){const H=[N],ee=vm.aoa_to_sheet(H);ee["!cols"]=N.map(()=>({wch:20}));const J=vm.book_new();vm.book_append_sheet(J,ee,o.display_name),Fee(J,`plantilla_${s}.xlsx`)}else{const H=N.join(",")+`
`,ee=new Blob([H],{type:"text/csv"}),J=URL.createObjectURL(ee),he=document.createElement("a");he.href=J,he.download=`plantilla_${s}.csv`,he.click(),URL.revokeObjectURL(J)}},ce=v.filter(R=>R.isValid).length,te=v.filter(R=>!R.isValid).length,D=R=>R<1024?R+" B":R<1024*1024?(R/1024).toFixed(1)+" KB":(R/(1024*1024)).toFixed(1)+" MB";return a.jsxs(Uee,{children:[a.jsxs(Vee,{children:[a.jsx(Wee,{onClick:()=>t("mantenedores"),children:" Volver a Mantenedores"}),a.jsx(Hee,{children:"Carga Masiva"})]}),a.jsxs(Gee,{children:[a.jsxs(eb,{$active:r===1,$completed:r>1,children:[a.jsx(tb,{$active:r===1,$completed:r>1,children:r>1?"":"1"}),"Seleccionar Archivo"]}),a.jsxs(eb,{$active:r===2,$completed:r>2,children:[a.jsx(tb,{$active:r===2,$completed:r>2,children:r>2?"":"2"}),"Validar Datos"]}),a.jsxs(eb,{$active:r===3,$completed:!1,children:[a.jsx(tb,{$active:r===3,$completed:!1,children:"3"}),"Resultados"]})]}),T&&a.jsx(bm,{$type:"error",children:T}),r===1&&a.jsxs(rb,{children:[a.jsxs(ate,{children:[a.jsx(ite,{children:"Seleccione el mantenedor"}),a.jsxs(ste,{value:s,onChange:R=>A(R.target.value),children:[a.jsx("option",{value:"",children:"-- Seleccionar --"}),c.map(R=>a.jsx("option",{value:R.key,children:R.display_name},R.key))]})]}),s&&o&&a.jsxs(a.Fragment,{children:[a.jsxs(bm,{$type:"info",children:["Columnas esperadas: ",o.columns.filter(R=>R!=="id"&&R!=="active"&&R!=="created_at"&&R!=="updated_at").join(", ")]}),a.jsxs(qee,{$isDragging:m,$hasFile:!!h,onDragOver:O,onDragLeave:F,onDrop:B,onClick:()=>{var R;return(R=M.current)==null?void 0:R.click()},children:[a.jsx("input",{ref:M,type:"file",accept:".csv,.xlsx,.xls",onChange:L,style:{display:"none"}}),a.jsx(Kee,{children:""}),a.jsx(Xee,{children:m?"Suelte el archivo aqui":"Arrastre un archivo o haga clic para seleccionar"}),a.jsx(Yee,{children:"Formatos soportados: CSV, Excel (.xlsx, .xls)"})]}),a.jsxs("div",{style:{marginTop:d.spacing.md,display:"flex",gap:d.spacing.md},children:[a.jsx(jE,{onClick:()=>W("xlsx"),children:" Descargar plantilla Excel"}),a.jsx(jE,{onClick:()=>W("csv"),children:" Descargar plantilla CSV"})]}),h&&a.jsxs(Qee,{children:[a.jsx("span",{children:""}),a.jsx(Jee,{children:h.name}),a.jsx(Zee,{children:D(h.size)}),a.jsx(ete,{onClick:re,children:""})]})]})]}),r===2&&a.jsxs(rb,{children:[a.jsx(nb,{children:"Vista Previa de Datos"}),a.jsxs(_E,{children:[a.jsxs(Il,{$color:d.colors.primary,children:[a.jsx(Nl,{children:v.length}),a.jsx(Ll,{children:"Total Filas"})]}),a.jsxs(Il,{$color:d.colors.success,children:[a.jsx(Nl,{children:ce}),a.jsx(Ll,{children:"Validos"})]}),a.jsxs(Il,{$color:d.colors.danger,children:[a.jsx(Nl,{children:te}),a.jsx(Ll,{children:"Con Errores"})]}),a.jsxs(Il,{$color:d.colors.warning,children:[a.jsxs(Nl,{children:[Math.round(ce/v.length*100),"%"]}),a.jsx(Ll,{children:"Tasa Exito"})]})]}),a.jsx(bE,{children:a.jsxs(yE,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Eh,{children:"#"}),o==null?void 0:o.columns.filter(R=>R!=="id"&&R!=="active"&&R!=="created_at"&&R!=="updated_at").map(R=>a.jsx(Eh,{children:R},R)),a.jsx(Eh,{children:"Estado"})]})}),a.jsx("tbody",{children:v.slice(0,100).map((R,N)=>a.jsxs("tr",{children:[a.jsx(Ah,{children:R.rowIndex}),o==null?void 0:o.columns.filter(H=>H!=="id"&&H!=="active"&&H!=="created_at"&&H!=="updated_at").map(H=>a.jsxs(Ah,{$error:R.errors.some(ee=>ee.includes(H)),children:[R.data[H]||"-",R.errors.filter(ee=>ee.includes(H)).map((ee,J)=>a.jsx(tte,{children:ee},J))]},H)),a.jsx(Ah,{children:R.isValid?a.jsx("span",{style:{color:d.colors.success},children:" Valido"}):a.jsx("span",{style:{color:d.colors.danger},children:" Error"})})]},N))})]})}),v.length>100&&a.jsxs(bm,{$type:"info",children:["Mostrando primeras 100 filas de ",v.length]}),y&&a.jsxs(a.Fragment,{children:[a.jsx(rte,{children:a.jsx(nte,{$percent:b})}),a.jsxs("div",{style:{textAlign:"center",color:d.colors.textSecondary},children:["Procesando... ",b,"%"]})]}),a.jsxs(wE,{children:[a.jsx(ym,{$variant:"secondary",onClick:()=>n(1),disabled:y,children:"Atras"}),a.jsx(ym,{$variant:"success",onClick:Z,disabled:y||ce===0,children:y?"Procesando...":`Cargar ${ce} registros`})]})]}),r===3&&C&&a.jsxs(rb,{children:[a.jsx(nb,{children:"Resultados de la Carga"}),a.jsxs(_E,{children:[a.jsxs(Il,{$color:d.colors.success,children:[a.jsx(Nl,{children:C.success}),a.jsx(Ll,{children:"Exitosos"})]}),a.jsxs(Il,{$color:d.colors.danger,children:[a.jsx(Nl,{children:C.failed}),a.jsx(Ll,{children:"Fallidos"})]}),a.jsxs(Il,{$color:d.colors.primary,children:[a.jsxs(Nl,{children:[Math.round(C.success/(C.success+C.failed)*100),"%"]}),a.jsx(Ll,{children:"Tasa Exito"})]})]}),C.success>0&&a.jsxs(bm,{$type:"success",children:["Se cargaron ",C.success," registros exitosamente."]}),C.errors.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(nb,{children:"Errores Encontrados"}),a.jsx(bE,{style:{maxHeight:"200px"},children:a.jsxs(yE,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Eh,{children:"Fila"}),a.jsx(Eh,{children:"Error"})]})}),a.jsx("tbody",{children:C.errors.map((R,N)=>a.jsxs("tr",{children:[a.jsx(Ah,{children:R.row}),a.jsx(Ah,{$error:!0,children:R.error})]},N))})]})})]}),a.jsxs(wE,{children:[a.jsx(ym,{$variant:"secondary",onClick:()=>{n(1),f(null),x([]),j(null)},children:"Nueva Carga"}),a.jsx(ym,{onClick:()=>t("mantenedores"),children:"Volver a Mantenedores"})]})]})]})}p.div`
  padding: 1.5rem;
  max-width: 100%;
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`;p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`;p.div`
  display: flex;
  gap: 0.75rem;
`;p.button`
  padding: 0.5rem 1rem;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border: none;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"secondary":return`
          background: white;
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgLight}; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border: none;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
`;p.div`
  display: grid;
  grid-template-columns: 1fr 200px auto;
  gap: 1rem;
  align-items: end;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`;p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`;p.input`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.select`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`;p.table`
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
`;p.th`
  padding: 0.75rem 1rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`;p.td`
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
`;p.span`
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;

  ${({$variant:e})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"info":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`;p.button`
  padding: 0.25rem 0.5rem;
  border: none;
  background: ${({$color:e})=>e?`${e}15`:`${d.colors.primary}15`};
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  margin-right: 0.25rem;

  &:hover {
    background: ${({$color:e})=>e?`${e}25`:`${d.colors.primary}25`};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 1rem;
  padding: 0.75rem;
  background: white;
  border-radius: 8px;
`;p.span`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`;p.div`
  display: flex;
  gap: 0.5rem;
`;p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 1rem;
`;p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`;p.textarea`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  min-height: 80px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.div`
  padding: 0.75rem 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${({$type:e})=>e==="success"?`background: ${d.colors.success}15; color: ${d.colors.success}; border: 1px solid ${d.colors.success}30;`:`background: ${d.colors.danger}15; color: ${d.colors.danger}; border: 1px solid ${d.colors.danger}30;`}
`;p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`;p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`;const lte=p.div`
  max-width: 500px;
  margin: 0 auto;
  padding: ${d.spacing.xl};
`,cte=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.xl};
`,dte=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0 0 ${d.spacing.xs} 0;
`,ute=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
`,hte=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,sb=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,ab=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,ib=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }
`,ob=p.div`
  position: relative;
`,lb=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,kE=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>e==="primary"?`
        background: ${d.colors.primary};
        color: white;
      `:`
        background: ${d.colors.bgLight};
        color: ${d.colors.textSecondary};
        border: 1px solid ${d.colors.border};
      `}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,SE=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`,fte=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,pte=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,_m=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,mte=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`,gte=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  padding: 0;
  margin-bottom: ${d.spacing.lg};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`;function xte({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(!1),[u,h]=E.useState(!1),[f,m]=E.useState(!1),[g,v]=E.useState(!1),[x,y]=E.useState(!1),[_,b]=E.useState(null),w=n.length>=6,C=/[A-Z]/.test(n),j=/[a-z]/.test(n),T=/[0-9]/.test(n),k=n===i&&i!=="",M=w&&k,A=async F=>{var B,L;if(F.preventDefault(),b(null),y(!1),!t){b("Ingrese su contrasea actual");return}if(!M){b("La nueva contrasea no cumple con los requisitos");return}v(!0);try{await Ec.changePassword(t,n),y(!0),r(""),s(""),o("")}catch(U){const P=U instanceof Error?U.message:((L=(B=U==null?void 0:U.response)==null?void 0:B.data)==null?void 0:L.detail)||"Error al cambiar la contrasea";b(P)}finally{v(!1)}},O=()=>{r(""),s(""),o(""),b(null),y(!1)};return a.jsxs(lte,{children:[a.jsx(gte,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"}),a.jsxs(cte,{children:[a.jsx(dte,{children:"Cambiar Contrasea"}),a.jsx(ute,{children:"Ingrese su contrasea actual y luego la nueva contrasea que desea usar."}),x&&a.jsx(SE,{$type:"success",children:" Su contrasea ha sido actualizada exitosamente."}),_&&a.jsxs(SE,{$type:"error",children:[" ",_]}),a.jsxs(hte,{onSubmit:A,children:[a.jsxs(sb,{children:[a.jsx(ab,{children:"Contrasea Actual"}),a.jsxs(ob,{children:[a.jsx(ib,{type:l?"text":"password",value:t,onChange:F=>r(F.target.value),placeholder:"Ingrese su contrasea actual",disabled:g}),a.jsx(lb,{type:"button",onClick:()=>c(!l),children:l?"":""})]})]}),a.jsxs(sb,{children:[a.jsx(ab,{children:"Nueva Contrasea"}),a.jsxs(ob,{children:[a.jsx(ib,{type:u?"text":"password",value:n,onChange:F=>s(F.target.value),placeholder:"Ingrese la nueva contrasea",disabled:g}),a.jsx(lb,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs(fte,{children:[a.jsx(pte,{children:"Requisitos de la contrasea:"}),a.jsxs(_m,{$valid:w,children:[w?"":""," Minimo 6 caracteres"]}),a.jsxs(_m,{$valid:C,children:[C?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs(_m,{$valid:j,children:[j?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs(_m,{$valid:T,children:[T?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(sb,{children:[a.jsx(ab,{children:"Confirmar Nueva Contrasea"}),a.jsxs(ob,{children:[a.jsx(ib,{type:f?"text":"password",value:i,onChange:F=>o(F.target.value),placeholder:"Repita la nueva contrasea",disabled:g}),a.jsx(lb,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),i&&!k&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contraseas no coinciden"}),k&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contraseas coinciden"})]}),a.jsxs(mte,{children:[a.jsx(kE,{type:"button",$variant:"secondary",onClick:O,disabled:g,children:"Limpiar"}),a.jsx(kE,{type:"submit",disabled:g||!M,children:g?"Guardando...":"Cambiar Contrasea"})]})]})]})]})}const vte=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,yte=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,bte=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,_te=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,wte=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,jte=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,kte=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,Ste=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,Cte=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,$te=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,Tte=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,CE=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,$E=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary}}};
`,Ete=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,Ate=p.div`
  margin-top: ${d.spacing.lg};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  border: 1px dashed ${d.colors.border};
`,Fte=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${d.colors.textMuted};
  margin-bottom: ${d.spacing.xs};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,TE=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
  word-break: break-all;
  font-family: monospace;
`;function Pte({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(!1),[i,o]=E.useState(!1),[l,c]=E.useState(null),[u,h]=E.useState(null),[f,m]=E.useState(null),g=y=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y),v=async y=>{var _,b;if(y.preventDefault(),c(null),o(!1),h(null),m(null),!t.trim()){c("Ingrese su correo electronico");return}if(!g(t)){c("Ingrese un correo electronico valido");return}s(!0);try{const w=await Ec.forgotPassword(t);o(!0),w._dev_token&&(h(w._dev_token),m(w._dev_reset_url||null))}catch(w){const C=w instanceof Error?w.message:((b=(_=w==null?void 0:w.response)==null?void 0:_.data)==null?void 0:b.detail)||"Error al procesar la solicitud";c(C)}finally{s(!1)}},x=()=>{u&&e("reset-password",{token:u,email:t})};return a.jsx(vte,{children:a.jsxs(yte,{children:[a.jsxs(bte,{children:[a.jsx(_te,{children:"INVEB"}),a.jsx(wte,{children:"Sistema de Gestion"})]}),a.jsx(jte,{children:"Recuperar Contrasena"}),a.jsx(kte,{children:"Ingresa tu correo electronico y te enviaremos instrucciones para restablecer tu contrasena."}),i&&a.jsx($E,{$type:"success",children:"Si el correo esta registrado, recibiras instrucciones para restablecer tu contrasena."}),l&&a.jsx($E,{$type:"error",children:l}),!i&&a.jsxs(Ste,{onSubmit:v,children:[a.jsxs(Cte,{children:[a.jsx($te,{children:"Correo Electronico"}),a.jsx(Tte,{type:"email",value:t,onChange:y=>r(y.target.value),placeholder:"ejemplo@empresa.com",disabled:n,autoComplete:"email",autoFocus:!0})]}),a.jsx(CE,{type:"submit",disabled:n||!t.trim(),children:n?"Enviando...":"Enviar Instrucciones"})]}),u&&a.jsxs(Ate,{children:[a.jsx(Fte,{children:"Modo Desarrollo"}),a.jsxs(TE,{children:["Token: ",u.substring(0,20),"..."]}),f&&a.jsxs(a.Fragment,{children:[a.jsxs(TE,{style:{marginTop:"8px"},children:["URL: ",f]}),a.jsx(CE,{type:"button",onClick:x,style:{marginTop:"12px",width:"100%"},children:"Ir a Restablecer Contrasena"})]})]}),a.jsx(Ete,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const wm=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,jm=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,km=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,Sm=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Cm=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,cb=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,Dte=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,Mte=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,EE=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,AE=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,FE=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,PE=p.div`
  position: relative;
`,DE=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,db=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,ub=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`;case"warning":return`${d.colors.warning}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary;case"warning":return d.colors.warning}}};
`,Ote=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,Rte=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,$m=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,ME=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,Ite=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function Nte({onNavigate:e,token:t,email:r}){const[n,s]=E.useState(r||""),[i,o]=E.useState(""),[l,c]=E.useState(""),[u,h]=E.useState(!1),[f,m]=E.useState(!1),[g,v]=E.useState(!1),[x,y]=E.useState(!0),[_,b]=E.useState(!1),[w,C]=E.useState(!1),[j,T]=E.useState(null),k=i.length>=6,M=/[A-Z]/.test(i),A=/[a-z]/.test(i),O=/[0-9]/.test(i),F=i===l&&l!=="",B=k&&F;E.useEffect(()=>{(async()=>{if(!t||!n){y(!1),T("Enlace invalido. Por favor solicita uno nuevo.");return}try{const P=await Ec.validateResetToken(t,n);b(P.valid),P.valid||T(P.message||"El enlace es invalido o ha expirado.")}catch{T("Error al validar el enlace.")}finally{y(!1)}})()},[t,n]);const L=async U=>{var P,Q;if(U.preventDefault(),T(null),!B){T("La contrasena no cumple con los requisitos");return}if(!t){T("Token no valido");return}v(!0);try{await Ec.resetPassword(t,n,i),C(!0)}catch(re){const Z=re instanceof Error?re.message:((Q=(P=re==null?void 0:re.response)==null?void 0:P.data)==null?void 0:Q.detail)||"Error al restablecer la contrasena";T(Z)}finally{v(!1)}};return x?a.jsx(wm,{children:a.jsxs(jm,{children:[a.jsxs(km,{children:[a.jsx(Sm,{children:"INVEB"}),a.jsx(Cm,{children:"Sistema de Gestion"})]}),a.jsx(Ite,{children:"Validando enlace..."})]})}):!_&&!w?a.jsx(wm,{children:a.jsxs(jm,{children:[a.jsxs(km,{children:[a.jsx(Sm,{children:"INVEB"}),a.jsx(Cm,{children:"Sistema de Gestion"})]}),a.jsx(cb,{children:"Enlace Invalido"}),a.jsx(ub,{$type:"error",children:j||"El enlace de recuperacion es invalido o ha expirado."}),a.jsx(db,{type:"button",onClick:()=>e("forgot-password"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Solicitar Nuevo Enlace"}),a.jsx(ME,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})}):w?a.jsx(wm,{children:a.jsxs(jm,{children:[a.jsxs(km,{children:[a.jsx(Sm,{children:"INVEB"}),a.jsx(Cm,{children:"Sistema de Gestion"})]}),a.jsx(cb,{children:"Contrasena Restablecida"}),a.jsx(ub,{$type:"success",children:"Tu contrasena ha sido restablecida exitosamente. Ya puedes iniciar sesion con tu nueva contrasena."}),a.jsx(db,{type:"button",onClick:()=>e("login"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Ir a Iniciar Sesion"})]})}):a.jsx(wm,{children:a.jsxs(jm,{children:[a.jsxs(km,{children:[a.jsx(Sm,{children:"INVEB"}),a.jsx(Cm,{children:"Sistema de Gestion"})]}),a.jsx(cb,{children:"Nueva Contrasena"}),a.jsxs(Dte,{children:["Ingresa tu nueva contrasena para la cuenta: ",a.jsx("strong",{children:n})]}),j&&a.jsx(ub,{$type:"error",children:j}),a.jsxs(Mte,{onSubmit:L,children:[a.jsxs(EE,{children:[a.jsx(AE,{children:"Nueva Contrasena"}),a.jsxs(PE,{children:[a.jsx(FE,{type:u?"text":"password",value:i,onChange:U=>o(U.target.value),placeholder:"Ingresa tu nueva contrasena",disabled:g,autoComplete:"new-password",autoFocus:!0}),a.jsx(DE,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs(Ote,{children:[a.jsx(Rte,{children:"Requisitos de la contrasena:"}),a.jsxs($m,{$valid:k,children:[k?"":""," Minimo 6 caracteres"]}),a.jsxs($m,{$valid:M,children:[M?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs($m,{$valid:A,children:[A?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs($m,{$valid:O,children:[O?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(EE,{children:[a.jsx(AE,{children:"Confirmar Contrasena"}),a.jsxs(PE,{children:[a.jsx(FE,{type:f?"text":"password",value:l,onChange:U=>c(U.target.value),placeholder:"Repite la nueva contrasena",disabled:g,autoComplete:"new-password"}),a.jsx(DE,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),l&&!F&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contrasenas no coinciden"}),F&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contrasenas coinciden"})]}),a.jsx(db,{type:"submit",disabled:g||!B,children:g?"Guardando...":"Restablecer Contrasena"})]}),a.jsx(ME,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const hb=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,fb=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,pb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,mb=p.div`
  display: flex;
  gap: 0.75rem;
`,bd=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Lte=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,zte=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,gb=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,xb=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Bte=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Ute=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Vte=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Hte=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,_i=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,wi=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,Wte=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,OE=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"borrador":return`
          background: #6c757d15;
          color: #6c757d;
        `;case"pendiente":return`
          background: ${d.colors.warning}15;
          color: ${d.colors.warning};
        `;case"aprobada":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"rechazada":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"vencida":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Fh=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"edit":return`
          background: ${d.colors.warning};
          color: white;
          &:hover { background: #e0a800; }
        `;case"copy":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"delete":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Gte=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,qte=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Kte=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Xte=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,RE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Yte=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Qte=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,vb=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,IE=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Jte={1:{label:"Borrador",type:"borrador"},2:{label:"Pendiente",type:"pendiente"},3:{label:"Aprobada",type:"aprobada"},4:{label:"Vigente",type:"aprobada"},5:{label:"Vencida",type:"vencida"},6:{label:"Rechazada",type:"rechazada"}};function Zte({onNavigate:e}){const t=Sr(),[r,n]=E.useState({page:1,page_size:20}),[s,i]=E.useState(""),[o,l]=E.useState(""),[c,u]=E.useState(null),[h,f]=E.useState(null),{data:m,isLoading:g,error:v}=Bt({queryKey:["cotizaciones",r],queryFn:()=>ka.list(r)}),{data:x}=Bt({queryKey:["cotizacion-estados"],queryFn:()=>ka.getEstados()}),y=Et({mutationFn:Q=>ka.delete(Q),onSuccess:()=>{t.invalidateQueries({queryKey:["cotizaciones"]}),u("Cotizacion eliminada correctamente"),setTimeout(()=>u(null),3e3)},onError:Q=>{f(Q.message||"Error al eliminar cotizacion"),setTimeout(()=>f(null),5e3)}}),_=Et({mutationFn:Q=>ka.duplicar(Q),onSuccess:Q=>{t.invalidateQueries({queryKey:["cotizaciones"]}),u(`Cotizacion duplicada. Nueva ID: ${Q.nueva_id}`),setTimeout(()=>u(null),3e3)},onError:Q=>{f(Q.message||"Error al duplicar cotizacion"),setTimeout(()=>f(null),5e3)}}),b=E.useCallback(Q=>{Q.preventDefault();const re={...r,page:1};s?re.cotizacion_id=parseInt(s,10):delete re.cotizacion_id,o?re.estado_id=[parseInt(o,10)]:delete re.estado_id,n(re)},[r,s,o]),w=E.useCallback(()=>{i(""),l(""),n({page:1,page_size:20})},[]),C=E.useCallback(()=>{e("cotizacion-nueva")},[e]),j=E.useCallback(Q=>{e("cotizacion-editar",Q)},[e]),T=E.useCallback(Q=>{e("cotizacion-editar",Q)},[e]),k=E.useCallback(Q=>{window.confirm("Desea duplicar esta cotizacion?")&&_.mutate(Q)},[_]),M=E.useCallback(Q=>{window.confirm("Esta seguro de eliminar esta cotizacion?")&&y.mutate(Q)},[y]),A=E.useCallback(Q=>{n(re=>({...re,page:Q}))},[]),O=Q=>Q?new Date(Q).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",F=Q=>{const re=Jte[Q]||{label:"Desconocido",type:"info"};return a.jsx(OE,{$type:re.type,children:re.label})};if(g)return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsx(pb,{children:"Cotizaciones"}),a.jsx(mb,{children:a.jsx(bd,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(qte,{children:[a.jsx(Kte,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(v)return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsx(pb,{children:"Cotizaciones"}),a.jsx(mb,{children:a.jsx(bd,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(vb,{$type:"error",children:["Error al cargar cotizaciones: ",v.message]})]});const B=(m==null?void 0:m.items)||[],L=(m==null?void 0:m.total)||0,U=(m==null?void 0:m.total_pages)||1,P=(m==null?void 0:m.page)||1;return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsxs(pb,{children:["Cotizaciones (",L,")"]}),a.jsxs(mb,{children:[a.jsx(bd,{$variant:"primary",onClick:C,children:"+ Nueva Cotizacion"}),a.jsx(bd,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]})]}),c&&a.jsx(vb,{$type:"success",children:c}),h&&a.jsx(vb,{$type:"error",children:h}),a.jsx(Lte,{children:a.jsx("form",{onSubmit:b,children:a.jsxs(zte,{children:[a.jsxs(gb,{children:[a.jsx(xb,{children:"ID Cotizacion"}),a.jsx(Bte,{type:"number",placeholder:"Buscar por ID...",value:s,onChange:Q=>i(Q.target.value)})]}),a.jsxs(gb,{children:[a.jsx(xb,{children:"Estado"}),a.jsxs(Ute,{value:o,onChange:Q=>l(Q.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),x==null?void 0:x.map(Q=>a.jsx("option",{value:Q.id,children:Q.nombre},Q.id))]})]}),a.jsxs(gb,{children:[a.jsx(xb,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(bd,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(bd,{type:"button",onClick:w,children:"Limpiar"})]})]})]})})}),a.jsxs(Qte,{children:["Mostrando ",B.length," de ",L," cotizaciones"]}),a.jsx(Vte,{children:B.length===0?a.jsx(Gte,{children:a.jsx("p",{children:"No se encontraron cotizaciones"})}):a.jsxs(a.Fragment,{children:[a.jsxs(Hte,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(_i,{children:"ID"}),a.jsx(_i,{children:"Fecha"}),a.jsx(_i,{children:"Cliente"}),a.jsx(_i,{children:"Contacto"}),a.jsx(_i,{children:"Creador"}),a.jsx(_i,{children:"Estado"}),a.jsx(_i,{children:"Detalles"}),a.jsx(_i,{children:"Version"}),a.jsx(_i,{children:"Acciones"})]})}),a.jsx("tbody",{children:B.map(Q=>a.jsxs(Wte,{children:[a.jsx(wi,{children:a.jsxs("strong",{children:["#",Q.id]})}),a.jsx(wi,{children:O(Q.created_at)}),a.jsx(wi,{children:a.jsx(IE,{title:Q.cliente_nombre||"-",children:Q.cliente_nombre||"-"})}),a.jsx(wi,{children:a.jsx(IE,{title:Q.nombre_contacto||"-",children:Q.nombre_contacto||"-"})}),a.jsx(wi,{children:Q.usuario_nombre||"-"}),a.jsx(wi,{children:F(Q.estado_id)}),a.jsx(wi,{children:a.jsx(OE,{$type:"info",children:Q.total_detalles})}),a.jsx(wi,{children:Q.version_number?`v${Q.version_number}`:"-"}),a.jsxs(wi,{children:[a.jsx(Fh,{$variant:"view",onClick:()=>j(Q.id),title:"Ver detalle",children:"Ver"}),a.jsx(Fh,{$variant:"copy",onClick:()=>b0.downloadCotizacion(Q.id),title:"Descargar PDF",children:"PDF"}),Q.estado_id===1&&a.jsx(Fh,{$variant:"edit",onClick:()=>T(Q.id),title:"Editar",children:"Editar"}),a.jsx(Fh,{$variant:"copy",onClick:()=>k(Q.id),disabled:_.isPending,title:"Duplicar",children:"Copiar"}),Q.estado_id===1&&a.jsx(Fh,{$variant:"delete",onClick:()=>M(Q.id),disabled:y.isPending,title:"Eliminar",children:"Eliminar"})]})]},Q.id))})]}),U>1&&a.jsxs(Xte,{children:[a.jsx(RE,{disabled:P===1,onClick:()=>A(P-1),children:"Anterior"}),a.jsxs(Yte,{children:["Pagina ",P," de ",U]}),a.jsx(RE,{disabled:P===U,onClick:()=>A(P+1),children:"Siguiente"})]})]})})]})}const ere=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
  z-index: 1000;
  overflow-y: auto;
`,tre=p.div`
  background: white;
  border-radius: 8px;
  width: 100%;
  max-width: 1200px;
  margin: 20px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
`,rre=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #e0e0e0;
  background: #f5f5f5;
  border-radius: 8px 8px 0 0;
`,nre=p.h2`
  margin: 0;
  font-size: 18px;
  color: #333;
`,sre=p.button`
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
  padding: 0;
  line-height: 1;

  &:hover {
    color: #333;
  }
`,are=p.div`
  padding: 24px;
  max-height: calc(100vh - 200px);
  overflow-y: auto;
`,wo=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 600px) {
    grid-template-columns: 1fr;
  }
`,ji=p.div`
  margin-bottom: 24px;

  &:last-child {
    margin-bottom: 0;
  }
`,Ha=p.h3`
  font-size: 14px;
  font-weight: 600;
  color: #1976d2;
  margin: 0 0 12px 0;
  padding-bottom: 8px;
  border-bottom: 2px solid #1976d2;
`,it=p.div`
  display: flex;
  flex-direction: column;
  grid-column: ${e=>e.$span?`span ${e.$span}`:"span 1"};
`,mt=p.label`
  font-size: 12px;
  font-weight: 500;
  color: #555;
  margin-bottom: 4px;
`,xr=p.input`
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;

  &:focus {
    outline: none;
    border-color: #1976d2;
    box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.1);
  }

  &:disabled {
    background: #f5f5f5;
    color: #999;
  }
`,xa=p.select`
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  background: white;

  &:focus {
    outline: none;
    border-color: #1976d2;
    box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.1);
  }
`,Wa=p.input.attrs({type:"checkbox"})`
  width: 16px;
  height: 16px;
  margin-right: 8px;
`,Ga=p.label`
  display: flex;
  align-items: center;
  font-size: 14px;
  color: #333;
  cursor: pointer;
  padding: 8px 0;
`,ire=p.div`
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
`,NE=p.button`
  padding: 10px 20px;
  border: 2px solid ${e=>e.$active?"#1976d2":"#ddd"};
  background: ${e=>e.$active?"#1976d2":"white"};
  color: ${e=>e.$active?"white":"#333"};
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: ${e=>e.$active?"#1565c0":"#f5f5f5"};
  }
`,ore=p.div`
  background: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 16px;
  margin-top: 20px;
`,lre=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;

  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,zl=p.div`
  text-align: center;
  ${e=>e.$span&&`grid-column: span ${e.$span};`}
`,Bl=p.div`
  font-size: 11px;
  color: #666;
  margin-bottom: 4px;
`,Ul=p.div`
  font-size: ${e=>e.$highlight?"18px":"14px"};
  font-weight: ${e=>e.$highlight?"700":"600"};
  color: ${e=>e.$highlight?"#1976d2":"#333"};
`,cre=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 16px 24px;
  border-top: 1px solid #e0e0e0;
  background: #f5f5f5;
  border-radius: 0 0 8px 8px;
`,yb=p.button`
  padding: 10px 24px;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>{switch(e.$variant){case"primary":return`
          background: #1976d2;
          color: white;
          &:hover { background: #1565c0; }
        `;case"success":return`
          background: #2e7d32;
          color: white;
          &:hover { background: #1b5e20; }
        `;default:return`
          background: #e0e0e0;
          color: #333;
          &:hover { background: #d0d0d0; }
        `}}}

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
`,dre=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;

  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,ure={tipo_detalle_id:1,cantidad:1e3,product_type_id:1,numero_colores:0,planta_id:1,variable_cotizador_id:1,largo:0,ancho:0,alto:0,area_hc:0,anchura:0,largura:0,carton_id:null,impresion:0,golpes_largo:1,golpes_ancho:1,process_id:null,cinta_desgarro:0,pegado_terminacion:0,porcentaje_cera_interno:0,porcentaje_cera_externo:0,rubro_id:null,coverage_type_id:null,coverage:0,print_type_id:null,ink_type_id:null,barniz_type_id:null,pegado_id:null,largo_esquinero:0,carton_esquinero_id:null,funda_esquinero:0,tipo_destino_esquinero:null,tipo_camion_esquinero:null,matriz:0,clisse:0,royalty:0,maquila:0,maquila_servicio_id:null,armado_automatico:0,armado_usd_caja:0,pallet:0,zuncho:null,funda:0,stretch_film:0,pallet_height_id:null,ciudad_id:null,pallets_apilados:2,margen:0,margen_sugerido:null},hre=[{value:1,label:"Caja Regular"},{value:2,label:"Caja Troquelada"},{value:3,label:"Bandeja"},{value:4,label:"Display"},{value:5,label:"Separador"}],fre=[{value:1,label:"BC 450"},{value:2,label:"BC 480"},{value:3,label:"BC 550"},{value:4,label:"C 350"},{value:5,label:"C 380"},{value:6,label:"C 400"},{value:7,label:"B 280"},{value:8,label:"B 300"}],pre=[{value:1,label:"Flexo 1 color"},{value:2,label:"Flexo 2 colores"},{value:3,label:"Flexo 3 colores"},{value:4,label:"Flexo 4 colores"},{value:5,label:"Alta Grfica"},{value:6,label:"Offset"}],mre=[{value:1,label:"Agroindustria"},{value:2,label:"Alimentos"},{value:3,label:"Bebidas"},{value:4,label:"Farmacutico"},{value:5,label:"Industrial"}],LE=[{value:1,label:"Santiago"},{value:2,label:"Valparaso"},{value:3,label:"Concepcin"},{value:4,label:"Antofagasta"},{value:5,label:"Temuco"}],gre=[{value:1,label:"Flexografa"},{value:2,label:"Offset"},{value:3,label:"Digital"}],xre=[{value:1,label:"Estndar"},{value:2,label:"Alta Grfica"},{value:3,label:"Metalizada"}],vre=[{value:0,label:"Sin barniz"},{value:1,label:"Barniz Acuoso"},{value:2,label:"Barniz UV"}],yre=[{value:1,label:"Pegado Simple"},{value:2,label:"Pegado Doble"},{value:3,label:"Pegado Triple"}],bre=[{value:1,label:"Esquinero 50x50x3"},{value:2,label:"Esquinero 60x60x4"},{value:3,label:"Esquinero 70x70x5"}];function _re({detalle:e,plantaId:t,onSubmit:r,onCancel:n}){var b,w,C,j,T,k,M;const[s,i]=E.useState(e||{...ure,planta_id:t||1}),[o,l]=E.useState(!1),[c,u]=E.useState({}),h=!!(e!=null&&e.id),f=s.tipo_detalle_id===1;E.useEffect(()=>{if(f&&s.anchura>0&&s.largura>0){const A=s.anchura*s.largura/1e6;i(O=>({...O,area_hc:parseFloat(A.toFixed(4))}))}},[s.anchura,s.largura,f]),E.useEffect(()=>{t&&t!==s.planta_id&&i(A=>({...A,planta_id:t}))},[t]);const m=E.useCallback(A=>{const{name:O,value:F,type:B}=A.target;let L=F;B==="number"?L=F===""?0:parseFloat(F):A.target.tagName==="SELECT"&&(L=F===""?null:parseInt(F)),i(U=>({...U,[O]:L})),c[O]&&u(U=>{const P={...U};return delete P[O],P})},[c]),g=E.useCallback(A=>{const{name:O,checked:F}=A.target;i(B=>({...B,[O]:F?1:0}))},[]),v=E.useCallback(A=>{i(O=>({...O,tipo_detalle_id:A}))},[]),x=E.useCallback(async()=>{l(!0),await new Promise(re=>setTimeout(re,500));const A=s.anchura*s.largura/1e6,O=A*.15,F=A*.02,B=s.numero_colores*.01,L=s.barniz_type_id?.005:0,U=O+F+B+L,P=s.margen/100,Q=U/(1-P);i(re=>({...re,precios:{costo_papel_usd_caja:parseFloat(O.toFixed(4)),costo_adhesivo_usd_caja:parseFloat(F.toFixed(4)),costo_tinta_usd_caja:parseFloat(B.toFixed(4)),costo_barniz_usd_caja:parseFloat(L.toFixed(4)),costo_total_usd_caja:parseFloat(U.toFixed(4)),precio_final_usd_caja:parseFloat(Q.toFixed(4)),margen_porcentaje:s.margen}})),l(!1)},[s.anchura,s.largura,s.numero_colores,s.barniz_type_id,s.margen]),y=E.useCallback(()=>{const A={};return s.cantidad<=0&&(A.cantidad="La cantidad debe ser mayor a 0"),f?(s.carton_id||(A.carton_id="Seleccione un cartn"),s.anchura<=0&&(A.anchura="La anchura debe ser mayor a 0"),s.largura<=0&&(A.largura="La largura debe ser mayor a 0")):(s.carton_esquinero_id||(A.carton_esquinero_id="Seleccione un tipo de esquinero"),s.largo_esquinero<=0&&(A.largo_esquinero="El largo debe ser mayor a 0")),u(A),Object.keys(A).length===0},[s,f]),_=E.useCallback(()=>{y()&&r(s)},[s,y,r]);return E.useEffect(()=>{const A=O=>{O.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[n]),a.jsx(ere,{onClick:A=>A.target===A.currentTarget&&n(),children:a.jsxs(tre,{children:[a.jsxs(rre,{children:[a.jsx(nre,{children:h?"Editar Detalle":"Nuevo Detalle de Cotizacin"}),a.jsx(sre,{onClick:n,children:""})]}),a.jsxs(are,{children:[a.jsxs(ire,{children:[a.jsx(NE,{$active:f,onClick:()=>v(1),children:"Corrugado"}),a.jsx(NE,{$active:!f,onClick:()=>v(2),children:"Esquinero"})]}),f?a.jsxs(a.Fragment,{children:[a.jsxs(ji,{children:[a.jsx(Ha,{children:"Informacin General"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Tipo de Producto *"}),a.jsx(xa,{name:"product_type_id",value:s.product_type_id||"",onChange:m,children:hre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Cantidad *"}),a.jsx(xr,{type:"number",name:"cantidad",value:s.cantidad,onChange:m,min:1}),c.cantidad&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.cantidad})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Rubro"}),a.jsxs(xa,{name:"rubro_id",value:s.rubro_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),mre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Ciudad Destino"}),a.jsxs(xa,{name:"ciudad_id",value:s.ciudad_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),LE.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Dimensiones de la Caja (mm)"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Largo"}),a.jsx(xr,{type:"number",name:"largo",value:s.largo,onChange:m,min:0})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Ancho"}),a.jsx(xr,{type:"number",name:"ancho",value:s.ancho,onChange:m,min:0})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Alto"}),a.jsx(xr,{type:"number",name:"alto",value:s.alto,onChange:m,min:0})]})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Hoja Corrugada"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Anchura (mm) *"}),a.jsx(xr,{type:"number",name:"anchura",value:s.anchura,onChange:m,min:0}),c.anchura&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.anchura})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Largura (mm) *"}),a.jsx(xr,{type:"number",name:"largura",value:s.largura,onChange:m,min:0}),c.largura&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.largura})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"rea HC (m)"}),a.jsx(xr,{type:"number",name:"area_hc",value:s.area_hc,disabled:!0})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Cartn *"}),a.jsxs(xa,{name:"carton_id",value:s.carton_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),fre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]}),c.carton_id&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.carton_id})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Golpes Largo"}),a.jsx(xr,{type:"number",name:"golpes_largo",value:s.golpes_largo,onChange:m,min:1})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Golpes Ancho"}),a.jsx(xr,{type:"number",name:"golpes_ancho",value:s.golpes_ancho,onChange:m,min:1})]})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Impresin"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Proceso"}),a.jsxs(xa,{name:"process_id",value:s.process_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Sin impresin"}),pre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Nmero de Colores"}),a.jsx(xr,{type:"number",name:"numero_colores",value:s.numero_colores,onChange:m,min:0,max:8})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Tipo Impresin"}),a.jsxs(xa,{name:"print_type_id",value:s.print_type_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),gre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Tipo Tinta"}),a.jsxs(xa,{name:"ink_type_id",value:s.ink_type_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),xre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Coverage (%)"}),a.jsx(xr,{type:"number",name:"coverage",value:s.coverage,onChange:m,min:0,max:100})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Barniz"}),a.jsx(xa,{name:"barniz_type_id",value:s.barniz_type_id??"",onChange:m,children:vre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))})]})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Pegado y Terminacin"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Tipo Pegado"}),a.jsxs(xa,{name:"pegado_id",value:s.pegado_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Sin pegado"}),yre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Cera Interno (%)"}),a.jsx(xr,{type:"number",name:"porcentaje_cera_interno",value:s.porcentaje_cera_interno,onChange:m,min:0,max:100})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Cera Externo (%)"}),a.jsx(xr,{type:"number",name:"porcentaje_cera_externo",value:s.porcentaje_cera_externo,onChange:m,min:0,max:100})]}),a.jsx(it,{children:a.jsxs(Ga,{children:[a.jsx(Wa,{name:"cinta_desgarro",checked:s.cinta_desgarro===1,onChange:g}),"Cinta de desgarro"]})})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Servicios Adicionales"}),a.jsxs(dre,{children:[a.jsxs(Ga,{children:[a.jsx(Wa,{name:"matriz",checked:s.matriz===1,onChange:g}),"Matriz"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"clisse",checked:s.clisse===1,onChange:g}),"Cliss"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"royalty",checked:s.royalty===1,onChange:g}),"Royalty"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"maquila",checked:s.maquila===1,onChange:g}),"Maquila"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"armado_automatico",checked:s.armado_automatico===1,onChange:g}),"Armado Automtico"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"pallet",checked:s.pallet===1,onChange:g}),"Pallet"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"funda",checked:s.funda===1,onChange:g}),"Funda"]}),a.jsxs(Ga,{children:[a.jsx(Wa,{name:"stretch_film",checked:s.stretch_film===1,onChange:g}),"Stretch Film"]})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Margen y Precio"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Margen (%)"}),a.jsx(xr,{type:"number",name:"margen",value:s.margen,onChange:m,min:0,max:100,step:.1})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Margen Sugerido"}),a.jsx(xr,{type:"number",value:s.margen_sugerido||"-",disabled:!0})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Pallets Apilados"}),a.jsx(xr,{type:"number",name:"pallets_apilados",value:s.pallets_apilados,onChange:m,min:1,max:10})]}),a.jsx(it,{children:a.jsx(yb,{type:"button",$variant:"primary",onClick:x,disabled:o,children:o?"Calculando...":"Calcular Precios"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs(ji,{children:[a.jsx(Ha,{children:"Informacin del Esquinero"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Tipo de Esquinero *"}),a.jsxs(xa,{name:"carton_esquinero_id",value:s.carton_esquinero_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),bre.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]}),c.carton_esquinero_id&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.carton_esquinero_id})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Largo (mm) *"}),a.jsx(xr,{type:"number",name:"largo_esquinero",value:s.largo_esquinero,onChange:m,min:0}),c.largo_esquinero&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.largo_esquinero})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Cantidad *"}),a.jsx(xr,{type:"number",name:"cantidad",value:s.cantidad,onChange:m,min:1}),c.cantidad&&a.jsx("span",{style:{color:"red",fontSize:"11px"},children:c.cantidad})]}),a.jsx(it,{children:a.jsxs(Ga,{children:[a.jsx(Wa,{name:"funda_esquinero",checked:s.funda_esquinero===1,onChange:g}),"Con Funda"]})})]})]}),a.jsxs(ji,{children:[a.jsx(Ha,{children:"Destino y Transporte"}),a.jsxs(wo,{children:[a.jsxs(it,{children:[a.jsx(mt,{children:"Ciudad Destino"}),a.jsxs(xa,{name:"ciudad_id",value:s.ciudad_id||"",onChange:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),LE.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs(it,{children:[a.jsx(mt,{children:"Margen (%)"}),a.jsx(xr,{type:"number",name:"margen",value:s.margen,onChange:m,min:0,max:100,step:.1})]})]})]})]}),s.precios&&a.jsxs(ore,{children:[a.jsx(Ha,{children:"Precios Calculados (USD/caja)"}),a.jsxs(lre,{children:[a.jsxs(zl,{children:[a.jsx(Bl,{children:"Costo Papel"}),a.jsxs(Ul,{children:["$",((b=s.precios.costo_papel_usd_caja)==null?void 0:b.toFixed(4))||"0.0000"]})]}),a.jsxs(zl,{children:[a.jsx(Bl,{children:"Costo Adhesivo"}),a.jsxs(Ul,{children:["$",((w=s.precios.costo_adhesivo_usd_caja)==null?void 0:w.toFixed(4))||"0.0000"]})]}),a.jsxs(zl,{children:[a.jsx(Bl,{children:"Costo Tinta"}),a.jsxs(Ul,{children:["$",((C=s.precios.costo_tinta_usd_caja)==null?void 0:C.toFixed(4))||"0.0000"]})]}),a.jsxs(zl,{children:[a.jsx(Bl,{children:"Costo Barniz"}),a.jsxs(Ul,{children:["$",((j=s.precios.costo_barniz_usd_caja)==null?void 0:j.toFixed(4))||"0.0000"]})]}),a.jsxs(zl,{children:[a.jsx(Bl,{children:"Costo Total"}),a.jsxs(Ul,{children:["$",((T=s.precios.costo_total_usd_caja)==null?void 0:T.toFixed(4))||"0.0000"]})]}),a.jsxs(zl,{children:[a.jsx(Bl,{children:"Margen"}),a.jsxs(Ul,{children:[((k=s.precios.margen_porcentaje)==null?void 0:k.toFixed(1))||"0.0","%"]})]}),a.jsxs(zl,{$span:2,children:[a.jsx(Bl,{children:"PRECIO FINAL"}),a.jsxs(Ul,{$highlight:!0,children:["$",((M=s.precios.precio_final_usd_caja)==null?void 0:M.toFixed(4))||"0.0000"]})]})]})]})]}),a.jsxs(cre,{children:[a.jsx(yb,{onClick:n,children:"Cancelar"}),a.jsx(yb,{$variant:"success",onClick:_,children:h?"Guardar Cambios":"Agregar Detalle"})]})]})})}const wre=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,jre=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,kre=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Sre=p.div`
  display: flex;
  gap: 0.75rem;
`,Tm=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,zE=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
`,BE=p.h2`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
`,Cre=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
`,_d=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,wd=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,$re=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,Em=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Tre=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Ere=p.div`
  margin-top: 1.5rem;
`,Are=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
`,Fre=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,jo=p.th`
  background: ${d.colors.bgLight};
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  border-bottom: 2px solid ${d.colors.border};
`,ko=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,Pre=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,UE=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.warning};
          color: white;
          &:hover { background: #e0a800; }
        `;case"delete":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}
`,Dre=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  background: ${d.colors.bgLight};
  border-radius: 8px;
`,Mre=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-radius: 8px;
  padding: 1.5rem;
  color: white;
  margin-top: 1.5rem;
`,Ore=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
`,bb=p.div`
  text-align: center;
`,_b=p.div`
  font-size: 0.75rem;
  text-transform: uppercase;
  opacity: 0.8;
  margin-bottom: 0.25rem;
`,wb=p.div`
  font-size: 1.25rem;
  font-weight: 600;
  font-family: 'Consolas', monospace;
`,VE=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}

  ${e=>e.$type==="warning"&&`
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeeba;
  `}
`,Rre=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,Ire=[{id:1,nombre:"Vina Concha y Toro S.A."},{id:2,nombre:"Frutas del Sur Ltda."},{id:3,nombre:"Exportadora ABC"}],Nre=[{id:1,nombre:"Juan Perez"},{id:2,nombre:"Maria Garcia"}],Lre=[{id:1,nombre:"Planta Santiago"},{id:2,nombre:"Planta Rancagua"}];function Am({cotizacionId:e,onNavigate:t,isExterno:r=!1}){const n=!!e,s=r?"cotizador-externo":"cotizaciones",[i,o]=E.useState({cliente_id:null,vendedor_id:null,planta_id:null,variable_cotizador_id:1,fecha_vencimiento:"",condicion_pago:"",observaciones:"",detalles:[]}),[l,c]=E.useState(!1),[u,h]=E.useState(null),[f,m]=E.useState(null),[g,v]=E.useState(null),[x,y]=E.useState(!1);E.useEffect(()=>{e&&console.log("Loading cotizacion:",e)},[e]);const _=E.useCallback((A,O)=>{o(F=>({...F,[A]:O}))},[]),b=E.useCallback(()=>{h(null),c(!0)},[]),w=E.useCallback((A,O)=>{h({...A,id:O}),c(!0)},[]),C=E.useCallback(A=>{window.confirm("Esta seguro de eliminar este detalle?")&&o(O=>({...O,detalles:O.detalles.filter((F,B)=>B!==A)}))},[]),j=E.useCallback(A=>{var F,B,L;const O={id:A.id,tipo_detalle_id:A.tipo_detalle_id,descripcion:`${A.tipo_detalle_id===1?"Corrugado":"Esquinero"} ${A.largo}x${A.ancho}x${A.alto}`,cantidad:A.cantidad,carton_id:A.carton_id,carton_nombre:A.carton_id?`Carton ${A.carton_id}`:"-",proceso_id:A.process_id,proceso_nombre:A.process_id?`Proceso ${A.process_id}`:"-",largo:A.largo,ancho:A.ancho,alto:A.alto,area_hc:A.area_hc,precio_usd_mm2:((F=A.precios)==null?void 0:F.precio_final_usd_caja)||0,precio_usd_caja:((B=A.precios)==null?void 0:B.precio_final_usd_caja)||0,total_usd:(((L=A.precios)==null?void 0:L.precio_final_usd_caja)||0)*A.cantidad};o(U=>{if(u!==null&&u.id!==void 0){const P=[...U.detalles];return P[u.id]=O,{...U,detalles:P}}else return{...U,detalles:[...U.detalles,O]}}),c(!1),h(null)},[u]),T=E.useCallback(async()=>{if(!i.cliente_id){v("Debe seleccionar un cliente");return}if(!i.planta_id){v("Debe seleccionar una planta");return}if(i.detalles.length===0){v("Debe agregar al menos un detalle");return}y(!0),v(null);try{console.log("Saving cotizacion:",i),await new Promise(A=>setTimeout(A,1e3)),m(n?"Cotizacion actualizada correctamente":"Cotizacion creada correctamente"),setTimeout(()=>{t(s)},1500)}catch{v("Error al guardar la cotizacion")}finally{y(!1)}},[i,n,t,s]),k=i.detalles.reduce((A,O)=>({totalUsd:A.totalUsd+O.total_usd,totalCajas:A.totalCajas+O.cantidad,totalItems:A.totalItems+1}),{totalUsd:0,totalCajas:0,totalItems:0}),M=A=>`$${A.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return l?a.jsx(_re,{detalle:u,plantaId:i.planta_id,onSubmit:j,onCancel:()=>{c(!1),h(null)}}):a.jsxs(wre,{children:[a.jsxs(jre,{children:[a.jsx(kre,{children:n?`Editar Cotizacion #${e}`:"Nueva Cotizacion"}),a.jsx(Sre,{children:a.jsx(Tm,{onClick:()=>t(s),children:" Volver a Lista"})})]}),f&&a.jsx(VE,{$type:"success",children:f}),g&&a.jsx(VE,{$type:"error",children:g}),a.jsxs(zE,{children:[a.jsx(BE,{children:"Datos Generales"}),a.jsxs(Cre,{children:[a.jsxs(_d,{children:[a.jsx(wd,{children:"Cliente *"}),a.jsxs(Em,{value:i.cliente_id||"",onChange:A=>_("cliente_id",A.target.value?Number(A.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),Ire.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(_d,{children:[a.jsx(wd,{children:"Vendedor"}),a.jsxs(Em,{value:i.vendedor_id||"",onChange:A=>_("vendedor_id",A.target.value?Number(A.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),Nre.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(_d,{children:[a.jsx(wd,{children:"Planta *"}),a.jsxs(Em,{value:i.planta_id||"",onChange:A=>_("planta_id",A.target.value?Number(A.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),Lre.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(_d,{children:[a.jsx(wd,{children:"Fecha Vencimiento"}),a.jsx($re,{type:"date",value:i.fecha_vencimiento,onChange:A=>_("fecha_vencimiento",A.target.value)})]}),a.jsxs(_d,{children:[a.jsx(wd,{children:"Condicion de Pago"}),a.jsxs(Em,{value:i.condicion_pago,onChange:A=>_("condicion_pago",A.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"contado",children:"Contado"}),a.jsx("option",{value:"30",children:"30 dias"}),a.jsx("option",{value:"60",children:"60 dias"}),a.jsx("option",{value:"90",children:"90 dias"})]})]})]}),a.jsxs(_d,{style:{marginTop:"1rem"},children:[a.jsx(wd,{children:"Observaciones"}),a.jsx(Tre,{value:i.observaciones,onChange:A=>_("observaciones",A.target.value),placeholder:"Observaciones adicionales..."})]})]}),a.jsx(zE,{children:a.jsxs(Ere,{children:[a.jsxs(Are,{children:[a.jsxs(BE,{style:{margin:0,border:"none",paddingBottom:0},children:["Detalles de la Cotizacion (",i.detalles.length,")"]}),a.jsx(Tm,{$variant:"primary",onClick:b,children:"+ Agregar Item"})]}),i.detalles.length===0?a.jsxs(Dre,{children:[a.jsx("p",{children:"No hay items en la cotizacion"}),a.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:'Haga clic en "Agregar Item" para comenzar'})]}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs(Fre,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(jo,{children:"#"}),a.jsx(jo,{children:"Descripcion"}),a.jsx(jo,{children:"Carton"}),a.jsx(jo,{children:"Dimensiones"}),a.jsx(jo,{children:"Cantidad"}),a.jsx(jo,{children:"Precio/Caja"}),a.jsx(jo,{children:"Total USD"}),a.jsx(jo,{children:"Acciones"})]})}),a.jsx("tbody",{children:i.detalles.map((A,O)=>a.jsxs(Pre,{children:[a.jsx(ko,{children:O+1}),a.jsx(ko,{children:A.descripcion||"-"}),a.jsx(ko,{children:A.carton_nombre||"-"}),a.jsxs(ko,{children:[A.largo,"x",A.ancho,"x",A.alto]}),a.jsx(ko,{children:A.cantidad.toLocaleString()}),a.jsx(ko,{children:M(A.precio_usd_caja)}),a.jsx(ko,{children:a.jsx("strong",{children:M(A.total_usd)})}),a.jsxs(ko,{children:[a.jsx(UE,{$variant:"edit",onClick:()=>w(A,O),children:"Editar"}),a.jsx(UE,{$variant:"delete",onClick:()=>C(O),children:"Eliminar"})]})]},O))})]})})]})}),i.detalles.length>0&&a.jsx(Mre,{children:a.jsxs(Ore,{children:[a.jsxs(bb,{children:[a.jsx(_b,{children:"Items"}),a.jsx(wb,{children:k.totalItems})]}),a.jsxs(bb,{children:[a.jsx(_b,{children:"Total Cajas"}),a.jsx(wb,{children:k.totalCajas.toLocaleString()})]}),a.jsxs(bb,{children:[a.jsx(_b,{children:"Total USD"}),a.jsx(wb,{children:M(k.totalUsd)})]})]})}),a.jsxs(Rre,{children:[a.jsx(Tm,{onClick:()=>t(s),children:"Cancelar"}),a.jsx(Tm,{$variant:"primary",onClick:T,disabled:x,children:x?"Guardando...":n?"Actualizar Cotizacion":"Crear Cotizacion"})]})]})}const HE="/api/v1",WE=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,GE=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,qE=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,KE=p.div`
  display: flex;
  gap: 0.75rem;
`,Vl=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,zre=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Bre=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,Fm=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Pm=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Ure=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Vre=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Hre=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Wre=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,ki=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Si=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,Gre=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,XE=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: ${d.colors.warning}15;
          color: ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,jb=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"approve":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"reject":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,qre=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Kre=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Xre=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Yre=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,YE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Qre=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Jre=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,QE=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Zre=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,ene=p.span`
  font-family: 'Consolas', monospace;
  font-weight: 500;
`,tne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,rne=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
`,nne=p.h2`
  font-size: 1.25rem;
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,sne=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1.5rem;
`,ane=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;function ine({onNavigate:e}){const[t,r]=E.useState([]),[n,s]=E.useState(1),[i,o]=E.useState(""),[l,c]=E.useState(""),[u,h]=E.useState(null),[f,m]=E.useState(null),[g,v]=E.useState(!0),[x,y]=E.useState(1),[_,b]=E.useState(0),[w,C]=E.useState(!1),[j,T]=E.useState("aprobar"),[k,M]=E.useState(null),[A,O]=E.useState(""),[F,B]=E.useState(!1),L=E.useCallback(async()=>{v(!0);try{const R=new URLSearchParams;R.append("page",n.toString()),R.append("page_size","20"),R.append("estado_id","2"),l&&R.append("user_id",l),i&&R.append("cotizacion_id",i);const N=await fetch(`${HE}/cotizaciones/?${R.toString()}`);if(!N.ok)throw new Error("Error al cargar cotizaciones");const H=await N.json();r(H.items||[]),b(H.total||0),y(H.total_pages||1)}catch(R){console.error("Error fetching cotizaciones:",R),m("Error al cargar las cotizaciones pendientes"),r([{id:1,client_id:1,cliente_nombre:"Vina Concha y Toro S.A.",usuario_nombre:"Juan Perez",user_id:1,estado_id:2,nivel_aprobacion:1,role_can_show:3,version_number:1,total_detalles:3,monto_total_usd:12500,created_at:"2024-01-15T10:30:00",updated_at:"2024-01-15T10:30:00"},{id:2,client_id:2,cliente_nombre:"Frutas del Sur Ltda.",usuario_nombre:"Maria Garcia",user_id:2,estado_id:2,nivel_aprobacion:2,role_can_show:15,version_number:1,total_detalles:2,monto_total_usd:8750.5,created_at:"2024-01-14T14:20:00",updated_at:"2024-01-14T14:20:00"}]),b(2),y(1)}finally{v(!1)}},[n,i,l]);E.useEffect(()=>{L()},[L]);const U=E.useCallback(R=>{R.preventDefault(),s(1),L()},[L]),P=E.useCallback(()=>{o(""),c(""),s(1)},[]),Q=E.useCallback(R=>{e("cotizacion-editar",R)},[e]),re=E.useCallback((R,N)=>{M(R),T(N),O(""),C(!0)},[]),Z=E.useCallback(()=>{C(!1),M(null),O(""),B(!1)},[]),W=E.useCallback(async()=>{if(k){B(!0);try{if(!(await fetch(`${HE}/cotizaciones/${k.id}/gestionar-aprobacion`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:j,motivo:A})})).ok)throw new Error("Error al procesar la aprobacion");const N=j==="aprobar"?"aprobada":"rechazada";h(`Cotizacion #${k.id} ${N} correctamente`),Z(),L(),setTimeout(()=>h(null),4e3)}catch(R){console.error("Error:",R),m("Error al procesar la aprobacion"),setTimeout(()=>m(null),4e3)}finally{B(!1)}}},[k,j,A,Z,L]),ce=R=>`$${R.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,te=R=>{try{return new Date(R).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return R}},D=R=>{switch(R){case 1:return"Jefe Ventas";case 2:return"Gerente Comercial";case 3:return"Gerente General";default:return`Nivel ${R}`}};return g?a.jsxs(WE,{children:[a.jsxs(GE,{children:[a.jsx(qE,{children:"Aprobaciones"}),a.jsx(KE,{children:a.jsx(Vl,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})})]}),a.jsxs(Kre,{children:[a.jsx(Xre,{}),a.jsx("span",{children:"Cargando cotizaciones pendientes..."})]})]}):a.jsxs(WE,{children:[a.jsxs(GE,{children:[a.jsx(qE,{children:"Cotizaciones por Aprobar"}),a.jsxs(KE,{children:[a.jsx(Vl,{onClick:()=>L(),children:"Actualizar"}),a.jsx(Vl,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})]})]}),u&&a.jsx(QE,{$type:"success",children:u}),f&&a.jsx(QE,{$type:"error",children:f}),a.jsx(zre,{children:a.jsx("form",{onSubmit:U,children:a.jsxs(Bre,{children:[a.jsxs(Fm,{children:[a.jsx(Pm,{children:"N Cotizacion"}),a.jsx(Ure,{type:"text",placeholder:"ID de cotizacion...",value:i,onChange:R=>o(R.target.value)})]}),a.jsxs(Fm,{children:[a.jsx(Pm,{children:"Creador"}),a.jsxs(Vre,{value:l,onChange:R=>c(R.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Juan Perez"}),a.jsx("option",{value:"2",children:"Maria Garcia"})]})]}),a.jsxs(Fm,{children:[a.jsx(Pm,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Vl,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(Vl,{type:"button",onClick:P,children:"Limpiar"})]})]})]})})}),a.jsx(Jre,{children:_===0?"No hay cotizaciones pendientes de aprobacion":`${_} cotizacion${_!==1?"es":""} pendiente${_!==1?"s":""} de aprobacion`}),a.jsx(Hre,{children:t.length===0?a.jsxs(qre,{children:[a.jsx("p",{children:"No hay cotizaciones pendientes de aprobacion"}),a.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"Las cotizaciones aparecen aqui cuando un vendedor solicita su aprobacion."})]}):a.jsxs(a.Fragment,{children:[a.jsxs(Wre,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ki,{children:"Cotizacion N"}),a.jsx(ki,{children:"Fecha Creacion"}),a.jsx(ki,{children:"Creador"}),a.jsx(ki,{children:"Cliente"}),a.jsx(ki,{children:"N Productos"}),a.jsx(ki,{children:"Monto Total (USD)"}),a.jsx(ki,{children:"Version"}),a.jsx(ki,{children:"Nivel"}),a.jsx(ki,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(R=>a.jsxs(Gre,{children:[a.jsx(Si,{children:a.jsx("strong",{children:R.id})}),a.jsx(Si,{children:te(R.created_at)}),a.jsx(Si,{children:R.usuario_nombre||"-"}),a.jsx(Si,{children:a.jsx(Zre,{title:R.cliente_nombre,children:R.cliente_nombre||"-"})}),a.jsx(Si,{children:a.jsx(XE,{$type:"info",children:R.total_detalles})}),a.jsx(Si,{children:a.jsx(ene,{children:R.monto_total_usd?ce(R.monto_total_usd):"-"})}),a.jsx(Si,{children:R.version_number||1}),a.jsx(Si,{children:a.jsx(XE,{$type:"warning",children:D(R.nivel_aprobacion)})}),a.jsxs(Si,{children:[a.jsx(jb,{$variant:"view",onClick:()=>Q(R.id),title:"Ver detalle",children:"Ver"}),a.jsx(jb,{$variant:"approve",onClick:()=>re(R,"aprobar"),title:"Aprobar",children:"Aprobar"}),a.jsx(jb,{$variant:"reject",onClick:()=>re(R,"rechazar"),title:"Rechazar",children:"Rechazar"})]})]},R.id))})]}),x>1&&a.jsxs(Yre,{children:[a.jsx(YE,{disabled:n===1,onClick:()=>s(R=>R-1),children:"Anterior"}),a.jsxs(Qre,{children:["Pagina ",n," de ",x]}),a.jsx(YE,{disabled:n===x,onClick:()=>s(R=>R+1),children:"Siguiente"})]})]})}),w&&k&&a.jsx(tne,{onClick:Z,children:a.jsxs(rne,{onClick:R=>R.stopPropagation(),children:[a.jsxs(nne,{children:[j==="aprobar"?"Aprobar":"Rechazar"," Cotizacion #",k.id]}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",k.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Creador:"})," ",k.usuario_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Productos:"})," ",k.total_detalles]})]}),a.jsxs(Fm,{children:[a.jsxs(Pm,{children:["Observacion ",j==="rechazar"&&"(Requerido)"]}),a.jsx(ane,{value:A,onChange:R=>O(R.target.value),placeholder:j==="aprobar"?"Ingrese una observacion opcional...":"Ingrese el motivo del rechazo...",required:j==="rechazar"})]}),a.jsxs(sne,{children:[a.jsx(Vl,{onClick:Z,disabled:F,children:"Cancelar"}),a.jsx(Vl,{$variant:j==="aprobar"?"success":"danger",onClick:W,disabled:F||j==="rechazar"&&!A.trim(),children:F?"Procesando...":j==="aprobar"?"Confirmar Aprobacion":"Confirmar Rechazo"})]})]})})]})}const one=p.div`
  padding: ${d.spacing.lg};
  max-width: 1400px;
  margin: 0 auto;
`,lne=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,cne=p.h1`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,dne=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
  margin-bottom: ${d.spacing.lg};
`,une=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: ${d.spacing.md};
  align-items: end;
`,Ph=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,Dm=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,kb=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,Dh=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};

  ${({$variant:e="primary"})=>{switch(e){case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"secondary":return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgMedium}; }
        `;default:return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,hne=p.table`
  width: 100%;
  border-collapse: collapse;
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  overflow: hidden;
  box-shadow: ${d.shadows.sm};
`,qa=p.th`
  background: ${d.colors.primary};
  color: white;
  padding: ${d.spacing.md};
  text-align: left;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  white-space: nowrap;
`,Ka=p.td`
  padding: ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  vertical-align: middle;
`,fne=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,Mm=p.span`
  display: inline-block;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};

  ${({$variant:e="info"})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`,pne=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.bold};

  ${({$dias:e})=>e<=2?`background: ${d.colors.success}; color: white;`:e<=5?`background: ${d.colors.warning}; color: white;`:`background: ${d.colors.danger}; color: white;`}
`,mne=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,Om=p.button`
  width: 32px;
  height: 32px;
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;

  ${({$variant:e="view"})=>{switch(e){case"approve":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"reject":return`
          background: ${d.colors.danger}20;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;default:return`
          background: ${d.colors.primary}20;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}
`,JE=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,gne=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,xne=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,Sb=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.md};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  cursor: pointer;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,vne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,yne=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
`,ZE=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg} 0;
`,e5=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.xl};
`,bne=p.textarea`
  width: 100%;
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,_ne=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
  font-size: ${d.typography.sizes.small};

  th, td {
    padding: ${d.spacing.sm};
    border: 1px solid ${d.colors.border};
    text-align: left;
  }

  th {
    background: ${d.colors.bgLight};
    font-weight: ${d.typography.weights.semibold};
  }
`,t5=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`;function wne({onNavigate:e}){const[t,r]=E.useState([]),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),[u,h]=E.useState(1),[f,m]=E.useState(1),[g,v]=E.useState(0),[x,y]=E.useState({date_desde:"",date_hasta:"",cotizacion_id:""}),[_,b]=E.useState(!1),[w,C]=E.useState("aprobar"),[j,T]=E.useState(null),[k,M]=E.useState(""),[A,O]=E.useState(!1),[F,B]=E.useState([]),L=E.useCallback(async()=>{s(!0),o(null);try{const D={page:u,page_size:20};x.date_desde&&(D.date_desde=x.date_desde),x.date_hasta&&(D.date_hasta=x.date_hasta),x.cotizacion_id&&(D.cotizacion_id=parseInt(x.cotizacion_id));const R=await ka.getPendientesAprobacionExterno(D);r(R.items||[]),v(R.total||0),m(R.total_pages||1)}catch(D){console.error("Error loading cotizaciones:",D),o("Error al cargar las cotizaciones pendientes")}finally{s(!1)}},[u,x]);E.useEffect(()=>{L()},[L]);const U=(D,R)=>{y(N=>({...N,[D]:R})),h(1)},P=()=>{h(1),L()},Q=()=>{y({date_desde:"",date_hasta:"",cotizacion_id:""}),h(1)},re=(D,R)=>{T(D),C(R),M(""),b(!0),R==="historial"&&W(D.id)},Z=()=>{b(!1),T(null),M(""),B([])},W=async D=>{try{const R=await ka.getHistorialAprobaciones(D);B(R.historial||[])}catch(R){console.error("Error loading historial:",R)}},ce=async()=>{if(j){O(!0),o(null);try{await ka.gestionarAprobacionExterno(j.id,{action:w==="aprobar"?"aprobar":"rechazar",motivo:k||void 0}),c(`Cotizacin #${j.id} ${w==="aprobar"?"aprobada":"rechazada"} exitosamente`),Z(),L(),setTimeout(()=>c(null),5e3)}catch(D){console.error("Error gestionando aprobacin:",D),o("Error al procesar la accin")}finally{O(!1)}}},te=D=>D?new Date(D).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}):"-";return a.jsxs(one,{children:[a.jsxs(lne,{children:[a.jsx(cne,{children:"Aprobacin Externa de Cotizaciones"}),a.jsxs(Mm,{$variant:"info",children:[g," pendientes"]})]}),l&&a.jsx(t5,{$type:"success",children:l}),i&&a.jsx(t5,{$type:"error",children:i}),a.jsx(dne,{children:a.jsxs(une,{children:[a.jsxs(Ph,{children:[a.jsx(Dm,{children:"Fecha Desde"}),a.jsx(kb,{type:"date",value:x.date_desde,onChange:D=>U("date_desde",D.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Dm,{children:"Fecha Hasta"}),a.jsx(kb,{type:"date",value:x.date_hasta,onChange:D=>U("date_hasta",D.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Dm,{children:"N Cotizacin"}),a.jsx(kb,{type:"number",placeholder:"ID",value:x.cotizacion_id,onChange:D=>U("cotizacion_id",D.target.value)})]}),a.jsxs(Ph,{style:{flexDirection:"row",alignItems:"flex-end",gap:d.spacing.sm},children:[a.jsx(Dh,{onClick:P,children:"Filtrar"}),a.jsx(Dh,{$variant:"secondary",onClick:Q,children:"Limpiar"})]})]})}),n?a.jsx(gne,{children:"Cargando cotizaciones..."}):t.length===0?a.jsxs(JE,{children:[a.jsx("div",{style:{fontSize:"3rem",marginBottom:d.spacing.md},children:""}),a.jsx("div",{children:"No hay cotizaciones pendientes de aprobacin externa"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(hne,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(qa,{children:"N"}),a.jsx(qa,{children:"Das"}),a.jsx(qa,{children:"Cliente"}),a.jsx(qa,{children:"Descripcin"}),a.jsx(qa,{children:"CAD"}),a.jsx(qa,{children:"Detalles"}),a.jsx(qa,{children:"Versin"}),a.jsx(qa,{children:"Creador"}),a.jsx(qa,{children:"Fecha"}),a.jsx(qa,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(D=>a.jsxs(fne,{children:[a.jsx(Ka,{children:a.jsx("strong",{children:D.id})}),a.jsx(Ka,{children:a.jsxs(pne,{$dias:D.dias_pendiente,children:[D.dias_pendiente,"d"]})}),a.jsx(Ka,{children:D.cliente_nombre||"-"}),a.jsx(Ka,{children:D.primer_detalle_descripcion||"-"}),a.jsx(Ka,{children:D.primer_detalle_cad||"-"}),a.jsxs(Ka,{children:[a.jsx("span",{children:D.total_detalles}),D.detalles_ganados>0&&a.jsxs(Mm,{$variant:"success",style:{marginLeft:"4px"},children:["+",D.detalles_ganados]}),D.detalles_perdidos>0&&a.jsxs(Mm,{$variant:"danger",style:{marginLeft:"4px"},children:["-",D.detalles_perdidos]})]}),a.jsxs(Ka,{children:["v",D.version_number||1]}),a.jsx(Ka,{children:D.creador_nombre||"-"}),a.jsx(Ka,{children:te(D.created_at)}),a.jsx(Ka,{children:a.jsxs(mne,{children:[a.jsx(Om,{$variant:"view",onClick:()=>e("cotizacion-editar",D.id),title:"Ver detalle",children:""}),a.jsx(Om,{$variant:"view",onClick:()=>re(D,"historial"),title:"Ver historial",children:""}),a.jsx(Om,{$variant:"approve",onClick:()=>re(D,"aprobar"),title:"Aprobar",children:""}),a.jsx(Om,{$variant:"reject",onClick:()=>re(D,"rechazar"),title:"Rechazar",children:""})]})})]},D.id))})]}),f>1&&a.jsxs(xne,{children:[a.jsx(Sb,{onClick:()=>h(D=>Math.max(1,D-1)),disabled:u===1,children:""}),Array.from({length:Math.min(5,f)},(D,R)=>{const N=Math.max(1,Math.min(u-2,f-4))+R;return N>f?null:a.jsx(Sb,{$active:u===N,onClick:()=>h(N),children:N},N)}),a.jsx(Sb,{onClick:()=>h(D=>Math.min(f,D+1)),disabled:u===f,children:""})]})]}),_&&j&&a.jsx(vne,{onClick:Z,children:a.jsx(yne,{onClick:D=>D.stopPropagation(),children:w==="historial"?a.jsxs(a.Fragment,{children:[a.jsxs(ZE,{children:["Historial de Aprobaciones - Cotizacin #",j.id]}),F.length===0?a.jsx(JE,{children:"No hay historial de aprobaciones"}):a.jsxs(_ne,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Fecha"}),a.jsx("th",{children:"Usuario"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Accin"}),a.jsx("th",{children:"Motivo"})]})}),a.jsx("tbody",{children:F.map(D=>a.jsxs("tr",{children:[a.jsx("td",{children:te(D.created_at)}),a.jsx("td",{children:D.usuario_nombre||"-"}),a.jsx("td",{children:D.rol_nombre}),a.jsx("td",{children:a.jsx(Mm,{$variant:D.action_made.includes("Rechazo")?"danger":"success",children:D.action_made})}),a.jsx("td",{children:D.motivo||"-"})]},D.id))})]}),a.jsx(e5,{children:a.jsx(Dh,{$variant:"secondary",onClick:Z,children:"Cerrar"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs(ZE,{children:[w==="aprobar"?" Aprobar":" Rechazar"," Cotizacin #",j.id]}),a.jsxs("div",{style:{marginBottom:d.spacing.lg},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",j.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Descripcin:"})," ",j.primer_detalle_descripcion||"-"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Detalles:"})," ",j.total_detalles]})]}),a.jsxs(Ph,{children:[a.jsx(Dm,{children:w==="aprobar"?"Observaciones (opcional)":"Motivo del rechazo"}),a.jsx(bne,{value:k,onChange:D=>M(D.target.value),placeholder:w==="aprobar"?"Ingrese observaciones adicionales...":"Indique el motivo del rechazo...",required:w==="rechazar"})]}),a.jsxs(e5,{children:[a.jsx(Dh,{$variant:"secondary",onClick:Z,disabled:A,children:"Cancelar"}),a.jsx(Dh,{$variant:w==="aprobar"?"success":"danger",onClick:ce,disabled:A||w==="rechazar"&&!k.trim(),children:A?"Procesando...":w==="aprobar"?"Confirmar Aprobacin":"Confirmar Rechazo"})]})]})})})]})}const jne=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.md};
  padding: ${d.spacing.xl};
`,kne=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,Sne=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.semibold};
  margin: 0;
`,Cne=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,$ne=p.div`
  background: ${d.colors.bgBlueLight};
  border-left: 4px solid ${d.colors.primary};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,Tne=p.p`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.body};
  margin: 0;
`,Ene=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
`,Ci=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.cardHeader};
  color: white;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};

  &:first-child {
    border-radius: ${d.radius.md} 0 0 0;
  }

  &:last-child {
    border-radius: 0 ${d.radius.md} 0 0;
  }
`,$i=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textPrimary};
`,Ane=p.tr`
  &:hover {
    background-color: ${d.colors.bgLight};
  }
`,Fne=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }
`,Pne=p.span`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$color:e})=>e||d.colors.primary}20;
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`,Dne=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,r5=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    background-color: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Mne=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,One=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,Rne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
`,Ine=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  max-width: 500px;
  width: 90%;
  box-shadow: ${d.shadows.lg};
`,Nne=p.h3`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg};
`,Lne=p.div`
  margin-bottom: ${d.spacing.lg};
`,zne=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textPrimary};
`,Bne=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Une=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,Vne=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.bgLight};
  color: ${d.colors.textSecondary};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.border};
  }
`,Hne=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Wne=p.div`
  background: ${d.colors.bgLight};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,Cb=p.div`
  display: flex;
  justify-content: space-between;
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};

  &:not(:last-child) {
    border-bottom: 1px solid ${d.colors.border};
  }
`,$b=p.span`
  color: ${d.colors.textSecondary};
`,Tb=p.span`
  color: ${d.colors.textPrimary};
  font-weight: ${d.typography.weights.medium};
`,Gne=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background-color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}15;
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  border: 1px solid ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}30;
`,qne=[{id:1,nombre:"Desarrollo Completo"},{id:5,nombre:"Arte con Material"}];function Kne({onNavigate:e}){const[t,r]=E.useState([]),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(1),[u,h]=E.useState(1),[f,m]=E.useState(0),[g,v]=E.useState(!1),[x,y]=E.useState(null),[_,b]=E.useState(1),[w,C]=E.useState(!1),j=E.useCallback(async()=>{s(!0),o(null);try{const O=await ka.getDetallesParaOT(void 0,l,20);r(O.items),h(O.total_pages),m(O.total)}catch(O){console.error("Error cargando detalles:",O),o("Error al cargar los detalles de cotizaciones")}finally{s(!1)}},[l]);E.useEffect(()=>{j()},[j]);const T=O=>{y(O),b(1),v(!0)},k=async()=>{if(x){C(!0);try{const O=await ka.getDetalleParaOT(x.detalle_id,_);O.success&&(v(!1),e("crear-ot-desde-cotizacion",void 0,O.datos_ot))}catch(O){console.error("Error obteniendo datos para OT:",O),o("Error al preparar los datos para la OT")}finally{C(!1)}}},M=O=>{try{return new Date(O).toLocaleDateString("es-CL")}catch{return O}},A=(O,F,B)=>!O&&!F&&!B?"-":`${O||0} x ${F||0} x ${B||0}`;return a.jsxs(jne,{children:[a.jsxs(kne,{children:[a.jsx(Sne,{children:"Crear OT desde Cotizacion"}),a.jsx(Cne,{onClick:()=>e("cotizaciones"),children:"Volver a Cotizaciones"})]}),a.jsx($ne,{children:a.jsx(Tne,{children:"Seleccione un detalle de cotizacion aprobada para crear una nueva Orden de Trabajo. Solo se muestran detalles de cotizaciones aprobadas que aun no tienen OT asociada."})}),i&&a.jsx(Gne,{$type:"error",children:i}),n?a.jsx(Mne,{children:"Cargando detalles..."}):t.length===0?a.jsxs(One,{children:[a.jsx("p",{children:"No hay detalles disponibles para crear OT."}),a.jsx("p",{children:"Los detalles deben pertenecer a cotizaciones aprobadas."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Mostrando ",t.length," de ",f," detalles disponibles"]}),a.jsxs(Ene,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ci,{children:"Cot. #"}),a.jsx(Ci,{children:"Cliente"}),a.jsx(Ci,{children:"Descripcion"}),a.jsx(Ci,{children:"Dimensiones"}),a.jsx(Ci,{children:"CAD"}),a.jsx(Ci,{children:"Carton"}),a.jsx(Ci,{children:"Estado"}),a.jsx(Ci,{children:"Fecha"}),a.jsx(Ci,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(O=>a.jsxs(Ane,{children:[a.jsx($i,{children:a.jsxs("strong",{children:["#",O.cotizacion_id]})}),a.jsx($i,{children:O.cliente_nombre}),a.jsx($i,{children:O.descripcion_material_detalle||O.descripcion||"-"}),a.jsx($i,{children:A(O.largura,O.anchura,O.altura)}),a.jsx($i,{children:O.cad_codigo||"-"}),a.jsx($i,{children:O.carton_codigo||"-"}),a.jsx($i,{children:a.jsx(Pne,{$color:d.colors.success,children:O.estado_nombre})}),a.jsx($i,{children:M(O.cotizacion_fecha)}),a.jsx($i,{children:a.jsx(Fne,{onClick:()=>T(O),children:"Crear OT"})})]},O.detalle_id))})]}),u>1&&a.jsxs(Dne,{children:[a.jsx(r5,{onClick:()=>c(O=>Math.max(1,O-1)),disabled:l===1,children:"Anterior"}),a.jsxs("span",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Pagina ",l," de ",u]}),a.jsx(r5,{onClick:()=>c(O=>Math.min(u,O+1)),disabled:l===u,children:"Siguiente"})]})]}),g&&x&&a.jsx(Rne,{onClick:()=>v(!1),children:a.jsxs(Ine,{onClick:O=>O.stopPropagation(),children:[a.jsx(Nne,{children:"Crear Orden de Trabajo"}),a.jsxs(Wne,{children:[a.jsxs(Cb,{children:[a.jsx($b,{children:"Cotizacion:"}),a.jsxs(Tb,{children:["#",x.cotizacion_id]})]}),a.jsxs(Cb,{children:[a.jsx($b,{children:"Cliente:"}),a.jsx(Tb,{children:x.cliente_nombre})]}),a.jsxs(Cb,{children:[a.jsx($b,{children:"Descripcion:"}),a.jsx(Tb,{children:x.descripcion_material_detalle||x.descripcion||"-"})]})]}),a.jsxs(Lne,{children:[a.jsx(zne,{htmlFor:"tipo_solicitud",children:"Tipo de Solicitud *"}),a.jsx(Bne,{id:"tipo_solicitud",value:_,onChange:O=>b(Number(O.target.value)),children:qne.map(O=>a.jsx("option",{value:O.id,children:O.nombre},O.id))})]}),a.jsxs(Une,{children:[a.jsx(Vne,{onClick:()=>v(!1),children:"Cancelar"}),a.jsx(Hne,{onClick:k,disabled:w,children:w?"Procesando...":"Continuar"})]})]})})]})}p.div`
  padding: 1.5rem;
  max-width: 1200px;
  margin: 0 auto;
`;p.div`
  margin-bottom: 2rem;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  margin-bottom: 0.5rem;

  &:hover {
    text-decoration: underline;
  }
`;p.h1`
  font-size: 1.75rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.5rem 0;
`;p.p`
  font-size: 1rem;
  color: ${d.colors.textSecondary};
  margin: 0;
`;p.div`
  display: grid;
  grid-template-columns: 250px 1fr;
  gap: 2rem;

  @media (max-width: 900px) {
    grid-template-columns: 1fr;
  }
`;p.nav`
  background: white;
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  position: sticky;
  top: 1rem;
  height: fit-content;
`;p.h3`
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin: 0 0 0.75rem 0;
  padding: 0 0.5rem;
`;p.a`
  display: block;
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  background: ${({$active:e})=>e?`${d.colors.primary}10`:"transparent"};
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  margin-bottom: 0.25rem;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
`;p.section`
  margin-bottom: 2.5rem;

  &:last-child {
    margin-bottom: 0;
  }
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary}20;
`;p.p`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin: 0 0 1rem 0;
`;p.ul`
  margin: 0 0 1rem 0;
  padding-left: 1.5rem;
`;p.li`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin-bottom: 0.5rem;
`;p.div`
  display: flex;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`;p.div`
  width: 32px;
  height: 32px;
  background: ${d.colors.primary};
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  flex-shrink: 0;
`;p.div`
  flex: 1;
`;p.h4`
  font-size: 0.9375rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`;p.p`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`;p.div`
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;

  ${({$type:e="info"})=>{switch(e){case"warning":return`
          background: ${d.colors.warning}15;
          border-left: 4px solid ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          border-left: 4px solid ${d.colors.success};
        `;default:return`
          background: ${d.colors.primary}10;
          border-left: 4px solid ${d.colors.primary};
        `}}}
`;p.div`
  font-weight: 600;
  font-size: 0.875rem;
  margin-bottom: 0.25rem;
`;p.div`
  font-size: 0.875rem;
  line-height: 1.5;
`;p.table`
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
  font-size: 0.875rem;
`;p.th`
  text-align: left;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
`;p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
`;p.code`
  background: ${d.colors.bgLight};
  padding: 0.125rem 0.375rem;
  border-radius: 4px;
  font-family: 'Consolas', monospace;
  font-size: 0.85em;
`;const Eb=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Ab=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Fb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Pb=p.div`
  display: flex;
  gap: 0.75rem;
`,Mh=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Xne=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Yne=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  align-items: end;
`,jd=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,kd=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Rm=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Qne=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Jne=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Zne=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,Rs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Is=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
  text-align: center;
`,ese=p.tr`
  ${e=>e.$inactive&&`
    color: #999;
  `}

  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,tse=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"borrador":return`
          background: #6c757d;
          color: white;
        `;case"pendiente":return`
          background: ${d.colors.warning};
          color: #333;
        `;case"aprobada":return`
          background: ${d.colors.success};
          color: white;
        `;case"rechazada":return`
          background: ${d.colors.danger};
          color: white;
        `;case"vencida":return`
          background: #6c757d;
          color: white;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,rse=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
`,Db=p.span`
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 0.75rem;

  ${e=>{switch(e.$type){case"ganados":return`color: ${d.colors.success};`;case"perdidos":return`color: ${d.colors.danger};`;default:return"color: #666;"}}}
`,n5=p.button`
  padding: 0.3rem 0.5rem;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"edit":return`
          background: ${d.colors.warning};
          color: white;
          &:hover { background: #e0a800; }
        `;case"pdf":return`
          background: #e74c3c;
          color: white;
          &:hover { background: #c0392b; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,nse=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,sse=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,ase=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,ise=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,s5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,ose=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,a5=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Im=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,lse={1:{label:"Borrador",type:"borrador"},2:{label:"Pendiente",type:"pendiente"},3:{label:"Aprobada",type:"aprobada"},4:{label:"Vigente",type:"aprobada"},5:{label:"Vencida",type:"vencida"},6:{label:"Rechazada",type:"rechazada"}},Nm=()=>{const e=new Date;return e.setMonth(e.getMonth()-3),e.toISOString().split("T")[0]},Lm=()=>new Date().toISOString().split("T")[0];function cse({onNavigate:e}){const[t,r]=E.useState({page:1,page_size:20,date_desde:Nm(),date_hasta:Lm()}),[n,s]=E.useState(""),[i,o]=E.useState(Nm()),[l,c]=E.useState(Lm()),[u,h]=E.useState(""),[f,m]=E.useState(""),[g,v]=E.useState(null),{data:x,isLoading:y,error:_}=Bt({queryKey:["cotizaciones-externo",t],queryFn:()=>ka.list(t)}),{data:b}=Bt({queryKey:["cotizacion-estados"],queryFn:()=>ka.getEstados()}),w=E.useCallback(P=>{P.preventDefault();const Q={...t,page:1,date_desde:i,date_hasta:l};n?Q.cotizacion_id=parseInt(n,10):delete Q.cotizacion_id,u?Q.estado_id=[parseInt(u,10)]:delete Q.estado_id,f?Q.cad=f:delete Q.cad,r(Q)},[t,n,u,f,i,l]),C=E.useCallback(()=>{s(""),h(""),m(""),o(Nm()),c(Lm()),r({page:1,page_size:20,date_desde:Nm(),date_hasta:Lm()})},[]),j=E.useCallback(()=>{e("cotizacion-externa-nueva")},[e]),T=E.useCallback(P=>{e("cotizacion-externa-editar",P.id)},[e]),k=E.useCallback(P=>{const Q=`/api/v1/api/cotizaciones/${P}/pdf`;window.open(Q,"_blank"),v("Descargando PDF..."),setTimeout(()=>v(null),2e3)},[]),M=E.useCallback(P=>{r(Q=>({...Q,page:P}))},[]),A=P=>P?new Date(P).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",O=P=>{const Q=lse[P]||{label:"Desconocido",type:"info"};return a.jsx(tse,{$type:Q.type,children:Q.label})};if(y)return a.jsxs(Eb,{children:[a.jsxs(Ab,{children:[a.jsx(Fb,{children:"Cotizaciones"}),a.jsx(Pb,{children:a.jsx(Mh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(sse,{children:[a.jsx(ase,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(_)return a.jsxs(Eb,{children:[a.jsxs(Ab,{children:[a.jsx(Fb,{children:"Cotizaciones"}),a.jsx(Pb,{children:a.jsx(Mh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(a5,{$type:"error",children:["Error al cargar cotizaciones: ",_.message]})]});const F=(x==null?void 0:x.items)||[],B=(x==null?void 0:x.total)||0,L=(x==null?void 0:x.total_pages)||1,U=(x==null?void 0:x.page)||1;return a.jsxs(Eb,{children:[a.jsxs(Ab,{children:[a.jsxs(Fb,{children:["Cotizaciones (",B,")"]}),a.jsx(Pb,{children:a.jsx(Mh,{$variant:"primary",onClick:j,children:"Crear Cotizacion"})})]}),g&&a.jsx(a5,{$type:"success",children:g}),a.jsx(Xne,{children:a.jsx("form",{onSubmit:w,children:a.jsxs(Yne,{children:[a.jsxs(jd,{children:[a.jsx(kd,{children:"Desde"}),a.jsx(Rm,{type:"date",value:i,onChange:P=>o(P.target.value)})]}),a.jsxs(jd,{children:[a.jsx(kd,{children:"Hasta"}),a.jsx(Rm,{type:"date",value:l,onChange:P=>c(P.target.value)})]}),a.jsxs(jd,{children:[a.jsx(kd,{children:"N Cotizacion"}),a.jsx(Rm,{type:"number",placeholder:"ID...",value:n,onChange:P=>s(P.target.value)})]}),a.jsxs(jd,{children:[a.jsx(kd,{children:"Estado"}),a.jsxs(Qne,{value:u,onChange:P=>h(P.target.value),children:[a.jsx("option",{value:"",children:"Selecciona..."}),b==null?void 0:b.map(P=>a.jsx("option",{value:P.id,children:P.nombre},P.id))]})]}),a.jsxs(jd,{children:[a.jsx(kd,{children:"CAD"}),a.jsx(Rm,{type:"text",placeholder:"CAD...",value:f,onChange:P=>m(P.target.value)})]}),a.jsxs(jd,{children:[a.jsx(kd,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Mh,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(Mh,{type:"button",onClick:C,children:"Limpiar"})]})]})]})})}),a.jsx(Jne,{children:F.length===0?a.jsx(nse,{children:a.jsx("p",{children:"No hay cotizaciones actualmente"})}):a.jsxs(a.Fragment,{children:[a.jsxs(Zne,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Rs,{children:"Cotizacion N"}),a.jsx(Rs,{children:"N de Productos"}),a.jsx(Rs,{children:"Creador"}),a.jsx(Rs,{children:"Cliente"}),a.jsx(Rs,{children:"Fecha 1ra Ver."}),a.jsx(Rs,{children:"Fecha Ult. Ver."}),a.jsx(Rs,{children:"Descrip."}),a.jsx(Rs,{children:"CAD"}),a.jsx(Rs,{children:"OT"}),a.jsx(Rs,{children:"N Version"}),a.jsx(Rs,{children:"Estado"}),a.jsx(Rs,{children:"Acciones"})]})}),a.jsx("tbody",{children:F.map(P=>a.jsxs(ese,{$inactive:P.active===0,children:[a.jsx(Is,{children:a.jsx("strong",{children:P.id})}),a.jsx(Is,{children:a.jsxs(rse,{children:[a.jsx(Db,{$type:"total",title:"Total Detalles",children:P.total_detalles||0}),a.jsxs(Db,{$type:"ganados",title:"Detalles Ganados",style:{opacity:P.estado_id>=3?1:.15},children:["+",P.detalles_ganados||0]}),a.jsxs(Db,{$type:"perdidos",title:"Detalles Perdidos",style:{opacity:P.estado_id>=3?1:.15},children:["-",P.detalles_perdidos||0]})]})}),a.jsx(Is,{children:a.jsx(Im,{title:P.usuario_nombre||"-",children:P.usuario_nombre||"-"})}),a.jsx(Is,{children:a.jsx(Im,{title:P.cliente_nombre||"-",children:P.cliente_nombre||"-"})}),a.jsx(Is,{children:A(P.fecha_primera_version||P.created_at)}),a.jsx(Is,{children:A(P.created_at)}),a.jsx(Is,{children:a.jsx(Im,{title:P.primer_detalle_descripcion||"-",children:P.primer_detalle_descripcion||"-"})}),a.jsx(Is,{children:a.jsx(Im,{title:P.primer_detalle_cad||"-",children:P.primer_detalle_cad||"-"})}),a.jsx(Is,{children:P.primer_detalle_ot||"-"}),a.jsx(Is,{children:P.version_number||"-"}),a.jsx(Is,{children:O(P.estado_id)}),a.jsxs(Is,{children:[a.jsx(n5,{$variant:P.estado_id===3?"view":"edit",onClick:()=>T(P),title:P.estado_id===3?"Ver":"Editar",children:P.estado_id===3?"Ver":"Editar"}),P.estado_id===3&&a.jsx(n5,{$variant:"pdf",onClick:()=>k(P.id),title:"Descargar PDF",children:"PDF"})]})]},P.id))})]}),L>1&&a.jsxs(ise,{children:[a.jsx(s5,{disabled:U===1,onClick:()=>M(U-1),children:"Anterior"}),a.jsxs(ose,{children:["Pagina ",U," de ",L]}),a.jsx(s5,{disabled:U===L,onClick:()=>M(U+1),children:"Siguiente"})]})]})})]})}const Mb=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Ob=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Rb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,dse=p.div`
  display: flex;
  gap: 0.75rem;
`,Ib=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,use=p.button`
  padding: 0.5rem 1.25rem;
  border: none;
  border-radius: 50px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: ${d.colors.primaryDark};
  }
`,i5=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,hse=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Ti=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ei=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,o5=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,fse=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"priority":return`
          background: #ff572215;
          color: #ff5722;
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,pse=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$estado){case 0:return"background: #6c757d15; color: #6c757d;";case 1:return"background: #2196f315; color: #2196f3;";case 2:return`background: ${d.colors.danger}15; color: ${d.colors.danger};`;case 3:return`background: ${d.colors.success}15; color: ${d.colors.success};`;case 4:return"background: #9e9e9e15; color: #9e9e9e;";case 5:return"background: #ff980015; color: #ff9800;";case 6:return"background: #9c27b015; color: #9c27b0;";default:return"background: #6c757d15; color: #6c757d;"}}}
`,va=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;case"warning":return`
          background: #ffc10715;
          color: #ffc107;
          &:hover { background: #ffc107; color: white; }
        `;case"info":return`
          background: #2196f315;
          color: #2196f3;
          &:hover { background: #2196f3; color: white; }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,l5=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,c5=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,d5=p.p`
  font-size: 1rem;
  margin: 0;
`,mse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,gse=p.div`
  display: flex;
  gap: 0.25rem;
  flex-wrap: wrap;
  justify-content: flex-start;
`,zm=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,xse=p.span`
  color: #ff5722;
  font-weight: bold;
  margin-right: 0.25rem;
`,Nb=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,Lb=p.div`
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  max-width: 400px;
  width: 100%;
`,zb=p.h3`
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,u5=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,vse=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Bb=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
`,Sd=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function yse({otId:e,onNavigate:t,onCreateMuestra:r}){var ee;const n=Sr(),[s,i]=E.useState(!1),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[h,f]=E.useState(null),[m,g]=E.useState(""),[v,x]=E.useState(null),{data:y,isLoading:_,error:b}=Bt({queryKey:["muestras",e],queryFn:()=>Us.listByOT(e)}),{data:w}=Bt({queryKey:["muestras-options"],queryFn:()=>Us.getOptions()}),C=Et({mutationFn:J=>Us.terminar(J),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),j=Et({mutationFn:({id:J,obs:he})=>Us.rechazar(J,he),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),i(!1),g("")}}),T=Et({mutationFn:J=>Us.anular(J),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),k=Et({mutationFn:({id:J,obs:he})=>Us.devolver(J,he),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),l(!1),g("")}}),M=Et({mutationFn:J=>Us.togglePrioritaria(J),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),A=Et({mutationFn:J=>Us.delete(J),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),O=Et({mutationFn:({id:J,salaId:he})=>Us.asignarSalaCorte(J,he),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),u(!1),x(null)}}),F=Et({mutationFn:J=>Us.iniciarProceso(J),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),B=E.useCallback(J=>{window.confirm("Marcar muestra como terminada?")&&C.mutate(J)},[C]),L=E.useCallback(J=>{f(J),i(!0)},[]),U=E.useCallback(J=>{window.confirm("Anular esta muestra?")&&T.mutate(J)},[T]),P=E.useCallback(J=>{f(J),l(!0)},[]),Q=E.useCallback(J=>{M.mutate(J)},[M]),re=E.useCallback(J=>{window.confirm("Eliminar esta muestra? Esta accin no se puede deshacer.")&&A.mutate(J)},[A]),Z=E.useCallback(J=>{f(J),u(!0)},[]),W=E.useCallback(J=>{window.confirm("Iniciar proceso de esta muestra?")&&F.mutate(J)},[F]),ce=()=>{h&&j.mutate({id:h,obs:m})},te=()=>{h&&k.mutate({id:h,obs:m})},D=()=>{h&&v&&O.mutate({id:h,salaId:v})},R=J=>{const he=[],ge=J.estado;switch(he.push(a.jsx(va,{$variant:"primary",onClick:()=>t("muestra-detalle",J.id),title:"Ver detalle",children:"Ver"},"ver")),he.push(a.jsx(va,{$variant:"info",onClick:()=>b0.downloadEtiquetaMuestra(J.id,"producto"),title:"Etiqueta Producto (10x10cm)",children:"Etq"},"etq-prod")),he.push(a.jsx(va,{$variant:"info",onClick:()=>b0.downloadEtiquetaMuestra(J.id,"cliente"),title:"Etiqueta Cliente (A4)",children:"Envo"},"etq-cli")),ge!==3&&ge!==4&&he.push(a.jsx(va,{$variant:J.prioritaria?"warning":"info",onClick:()=>Q(J.id),title:J.prioritaria?"Quitar prioridad":"Marcar prioritaria",disabled:M.isPending,children:J.prioritaria?"":""},"priority")),ge){case 0:he.push(a.jsx(va,{$variant:"info",onClick:()=>Z(J.id),title:"Asignar sala de corte",children:"Sala"},"sala")),he.push(a.jsx(va,{$variant:"danger",onClick:()=>re(J.id),title:"Eliminar",disabled:A.isPending,children:""},"delete"));break;case 1:he.push(a.jsx(va,{$variant:"success",onClick:()=>B(J.id),title:"Terminar",disabled:C.isPending,children:""},"terminar")),he.push(a.jsx(va,{$variant:"danger",onClick:()=>L(J.id),title:"Rechazar",children:""},"rechazar")),he.push(a.jsx(va,{$variant:"warning",onClick:()=>P(J.id),title:"Devolver",children:""},"devolver"));break;case 6:he.push(a.jsx(va,{$variant:"info",onClick:()=>W(J.id),title:"Iniciar proceso",disabled:F.isPending,children:""},"iniciar"));break;case 3:case 4:break;default:ge!==4&&he.push(a.jsx(va,{$variant:"danger",onClick:()=>U(J.id),title:"Anular",disabled:T.isPending,children:"Anular"},"anular"))}return he};if(_)return a.jsxs(Mb,{children:[a.jsxs(Ob,{children:[a.jsxs(Rb,{children:["Muestras de OT #",e]}),a.jsx(Ib,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsx(mse,{children:"Cargando..."})]});if(b)return a.jsxs(Mb,{children:[a.jsxs(Ob,{children:[a.jsxs(Rb,{children:["Muestras de OT #",e]}),a.jsx(Ib,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsxs(l5,{children:[a.jsx(c5,{children:"!"}),a.jsx(d5,{children:"Error al cargar las muestras"})]})]});const N=(y==null?void 0:y.items)||[],H=(y==null?void 0:y.total)||0;return a.jsxs(Mb,{children:[a.jsxs(Ob,{children:[a.jsxs(Rb,{children:["Muestras de OT #",e," (",H,")"]}),a.jsxs(dse,{children:[a.jsx(use,{onClick:r,children:"+ Nueva Muestra"}),a.jsx(Ib,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]})]}),N.length===0?a.jsx(i5,{children:a.jsxs(l5,{children:[a.jsx(c5,{children:""}),a.jsx(d5,{children:"No hay muestras para esta OT"})]})}):a.jsx(i5,{children:a.jsxs(hse,{children:[a.jsx("thead",{children:a.jsxs(o5,{children:[a.jsx(Ti,{style:{width:"60px"},children:"ID"}),a.jsx(Ti,{style:{width:"90px"},children:"Estado"}),a.jsx(Ti,{children:"CAD"}),a.jsx(Ti,{children:"Cartn"}),a.jsx(Ti,{children:"Sala Corte"}),a.jsx(Ti,{style:{width:"80px"},children:"Cantidad"}),a.jsx(Ti,{style:{width:"100px"},children:"Creado"}),a.jsx(Ti,{children:"Creador"}),a.jsx(Ti,{style:{width:"180px"},children:"Acciones"})]})}),a.jsx("tbody",{children:N.map(J=>a.jsxs(o5,{children:[a.jsxs(Ei,{children:[J.prioritaria&&a.jsx(xse,{title:"Prioritaria",children:""}),a.jsx(fse,{children:J.id})]}),a.jsx(Ei,{children:a.jsx(pse,{$estado:J.estado,children:xz[J.estado]||"Desconocido"})}),a.jsx(Ei,{children:a.jsx(zm,{title:J.cad||"",children:J.cad||"-"})}),a.jsx(Ei,{children:a.jsx(zm,{title:J.carton||"",children:J.carton||"-"})}),a.jsx(Ei,{children:a.jsx(zm,{title:J.sala_corte||"",children:J.sala_corte||"-"})}),a.jsx(Ei,{children:J.cantidad_total}),a.jsx(Ei,{children:J.created_at}),a.jsx(Ei,{children:a.jsx(zm,{title:J.creador_nombre||"",children:J.creador_nombre||"-"})}),a.jsx(Ei,{children:a.jsx(gse,{children:R(J)})})]},J.id))})]})}),s&&a.jsx(Nb,{onClick:()=>i(!1),children:a.jsxs(Lb,{onClick:J=>J.stopPropagation(),children:[a.jsx(zb,{children:"Rechazar Muestra"}),a.jsx(u5,{placeholder:"Motivo del rechazo (opcional)",value:m,onChange:J=>g(J.target.value)}),a.jsxs(Bb,{children:[a.jsx(Sd,{onClick:()=>i(!1),children:"Cancelar"}),a.jsx(Sd,{$primary:!0,onClick:ce,disabled:j.isPending,children:j.isPending?"Rechazando...":"Rechazar"})]})]})}),o&&a.jsx(Nb,{onClick:()=>l(!1),children:a.jsxs(Lb,{onClick:J=>J.stopPropagation(),children:[a.jsx(zb,{children:"Devolver Muestra"}),a.jsx(u5,{placeholder:"Motivo de la devolucin (opcional)",value:m,onChange:J=>g(J.target.value)}),a.jsxs(Bb,{children:[a.jsx(Sd,{onClick:()=>l(!1),children:"Cancelar"}),a.jsx(Sd,{$primary:!0,onClick:te,disabled:k.isPending,children:k.isPending?"Devolviendo...":"Devolver"})]})]})}),c&&a.jsx(Nb,{onClick:()=>u(!1),children:a.jsxs(Lb,{onClick:J=>J.stopPropagation(),children:[a.jsx(zb,{children:"Asignar Sala de Corte"}),a.jsxs(vse,{value:v||"",onChange:J=>x(Number(J.target.value)||null),children:[a.jsx("option",{value:"",children:"Seleccionar sala..."}),(ee=w==null?void 0:w.salas_corte)==null?void 0:ee.map(J=>a.jsx("option",{value:J.id,children:J.nombre},J.id))]}),a.jsxs(Bb,{children:[a.jsx(Sd,{onClick:()=>u(!1),children:"Cancelar"}),a.jsx(Sd,{$primary:!0,onClick:D,disabled:!v||O.isPending,children:O.isPending?"Asignando...":"Asignar"})]})]})})]})}const h5=p.div`
  padding: 1.5rem;
  max-width: 900px;
`,f5=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,p5=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,m5=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,bse=p.form`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
`,g5=p.div`
  margin-bottom: 1.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }
`,x5=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,v5=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;

  &:last-child {
    margin-bottom: 0;
  }
`,Nr=p.div`
  display: flex;
  flex-direction: column;
`,Lr=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.375rem;
  text-transform: uppercase;
`,is=p.input`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,Ub=p.select`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,_se=p.textarea`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Oh=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,Rh=p.input`
  width: 1rem;
  height: 1rem;
  cursor: pointer;
`,Ih=p.label`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;
`,Nh=p.div`
  background: ${e=>e.$enabled?d.colors.primary+"08":d.colors.bgLight};
  border: 1px solid ${e=>e.$enabled?d.colors.primary+"40":d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  transition: all 0.2s;
`,Lh=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
`,zh=p.span`
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,Bh=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 0.75rem;
`,wse=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid ${d.colors.border};
`,y5=p.button`
  padding: 0.625rem 1.5rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,jse=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}40;
  border-radius: 4px;
  padding: 0.75rem;
  color: ${d.colors.danger};
  font-size: 0.875rem;
  margin-bottom: 1rem;
`,kse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Sse={work_order_id:0,sala_corte_id:void 0,cad_id:void 0,carton_id:void 0,observacion_muestra:"",vendedor_nombre:"",vendedor_direccion:"",vendedor_ciudad:"",vendedor_check:0,cantidad_vendedor:0,disenador_nombre:"",disenador_direccion:"",disenador_ciudad:"",disenador_check:0,cantidad_disenador:0,laboratorio_check:0,cantidad_laboratorio:0,cliente_check:0,cantidad_cliente:0,disenador_revision_nombre:"",disenador_revision_direccion:"",disenador_revision_check:0,cantidad_disenador_revision:0};function Cse({otId:e,onNavigate:t,onSuccess:r}){var x,y,_;const n=Sr(),[s,i]=E.useState({...Sse,work_order_id:e}),[o,l]=E.useState(null),{data:c,isLoading:u}=Bt({queryKey:["muestras-options"],queryFn:()=>Us.getOptions()}),h=Et({mutationFn:b=>Us.create(b),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),r?r():t("muestras-list",e)},onError:b=>{const w=b instanceof Error?b.message:"Error al crear la muestra";l(w)}}),f=E.useCallback((b,w)=>{i(C=>({...C,[b]:w}))},[]),m=E.useCallback((b,w)=>{i(C=>({...C,[b]:w?1:0}))},[]),g=E.useCallback(b=>{if(b.preventDefault(),l(null),(s.cantidad_vendedor||0)+(s.cantidad_disenador||0)+(s.cantidad_laboratorio||0)+(s.cantidad_cliente||0)+(s.cantidad_disenador_revision||0)===0){l("Debe especificar al menos una cantidad en algn destino");return}h.mutate(s)},[s,h]),v=E.useCallback(()=>{t("muestras-list",e)},[t,e]);return u?a.jsxs(h5,{children:[a.jsxs(f5,{children:[a.jsxs(p5,{children:["Nueva Muestra para OT #",e]}),a.jsx(m5,{onClick:v,children:"Cancelar"})]}),a.jsx(kse,{children:"Cargando opciones..."})]}):a.jsxs(h5,{children:[a.jsxs(f5,{children:[a.jsxs(p5,{children:["Nueva Muestra para OT #",e]}),a.jsx(m5,{onClick:v,children:"Cancelar"})]}),a.jsxs(bse,{onSubmit:g,children:[o&&a.jsx(jse,{children:o}),a.jsxs(g5,{children:[a.jsx(x5,{children:"Informacin General"}),a.jsxs(v5,{children:[a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Sala de Corte"}),a.jsxs(Ub,{value:s.sala_corte_id||"",onChange:b=>f("sala_corte_id",b.target.value?Number(b.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(x=c==null?void 0:c.salas_corte)==null?void 0:x.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"CAD"}),a.jsxs(Ub,{value:s.cad_id||"",onChange:b=>f("cad_id",b.target.value?Number(b.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(y=c==null?void 0:c.cads)==null?void 0:y.map(b=>a.jsx("option",{value:b.id,children:b.codigo},b.id))]})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cartn"}),a.jsxs(Ub,{value:s.carton_id||"",onChange:b=>f("carton_id",b.target.value?Number(b.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(_=c==null?void 0:c.cartones)==null?void 0:_.map(b=>a.jsx("option",{value:b.id,children:b.codigo},b.id))]})]})]}),a.jsx(v5,{children:a.jsxs(Nr,{style:{gridColumn:"1 / -1"},children:[a.jsx(Lr,{children:"Observacin"}),a.jsx(_se,{value:s.observacion_muestra||"",onChange:b=>f("observacion_muestra",b.target.value),placeholder:"Observaciones generales de la muestra..."})]})})]}),a.jsxs(g5,{children:[a.jsx(x5,{children:"Destinos de Muestras"}),a.jsxs(Nh,{$enabled:!!s.vendedor_check,style:{marginBottom:"1rem"},children:[a.jsx(Lh,{children:a.jsxs(Oh,{children:[a.jsx(Rh,{type:"checkbox",id:"vendedor_check",checked:!!s.vendedor_check,onChange:b=>m("vendedor_check",b.target.checked)}),a.jsx(Ih,{htmlFor:"vendedor_check",children:a.jsx(zh,{children:"Vendedor"})})]})}),s.vendedor_check?a.jsxs(Bh,{children:[a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Nombre"}),a.jsx(is,{value:s.vendedor_nombre||"",onChange:b=>f("vendedor_nombre",b.target.value),placeholder:"Nombre del vendedor"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Direccin"}),a.jsx(is,{value:s.vendedor_direccion||"",onChange:b=>f("vendedor_direccion",b.target.value),placeholder:"Direccin"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Ciudad"}),a.jsx(is,{value:s.vendedor_ciudad||"",onChange:b=>f("vendedor_ciudad",b.target.value),placeholder:"Ciudad"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cantidad"}),a.jsx(is,{type:"number",min:"0",value:s.cantidad_vendedor||"",onChange:b=>f("cantidad_vendedor",b.target.value?Number(b.target.value):0)})]})]}):null]}),a.jsxs(Nh,{$enabled:!!s.disenador_check,style:{marginBottom:"1rem"},children:[a.jsx(Lh,{children:a.jsxs(Oh,{children:[a.jsx(Rh,{type:"checkbox",id:"disenador_check",checked:!!s.disenador_check,onChange:b=>m("disenador_check",b.target.checked)}),a.jsx(Ih,{htmlFor:"disenador_check",children:a.jsx(zh,{children:"Diseador"})})]})}),s.disenador_check?a.jsxs(Bh,{children:[a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Nombre"}),a.jsx(is,{value:s.disenador_nombre||"",onChange:b=>f("disenador_nombre",b.target.value),placeholder:"Nombre del diseador"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Direccin"}),a.jsx(is,{value:s.disenador_direccion||"",onChange:b=>f("disenador_direccion",b.target.value),placeholder:"Direccin"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Ciudad"}),a.jsx(is,{value:s.disenador_ciudad||"",onChange:b=>f("disenador_ciudad",b.target.value),placeholder:"Ciudad"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cantidad"}),a.jsx(is,{type:"number",min:"0",value:s.cantidad_disenador||"",onChange:b=>f("cantidad_disenador",b.target.value?Number(b.target.value):0)})]})]}):null]}),a.jsxs(Nh,{$enabled:!!s.laboratorio_check,style:{marginBottom:"1rem"},children:[a.jsx(Lh,{children:a.jsxs(Oh,{children:[a.jsx(Rh,{type:"checkbox",id:"laboratorio_check",checked:!!s.laboratorio_check,onChange:b=>m("laboratorio_check",b.target.checked)}),a.jsx(Ih,{htmlFor:"laboratorio_check",children:a.jsx(zh,{children:"Laboratorio"})})]})}),s.laboratorio_check?a.jsx(Bh,{children:a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cantidad"}),a.jsx(is,{type:"number",min:"0",value:s.cantidad_laboratorio||"",onChange:b=>f("cantidad_laboratorio",b.target.value?Number(b.target.value):0)})]})}):null]}),a.jsxs(Nh,{$enabled:!!s.cliente_check,style:{marginBottom:"1rem"},children:[a.jsx(Lh,{children:a.jsxs(Oh,{children:[a.jsx(Rh,{type:"checkbox",id:"cliente_check",checked:!!s.cliente_check,onChange:b=>m("cliente_check",b.target.checked)}),a.jsx(Ih,{htmlFor:"cliente_check",children:a.jsx(zh,{children:"Cliente"})})]})}),s.cliente_check?a.jsx(Bh,{children:a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cantidad"}),a.jsx(is,{type:"number",min:"0",value:s.cantidad_cliente||"",onChange:b=>f("cantidad_cliente",b.target.value?Number(b.target.value):0)})]})}):null]}),a.jsxs(Nh,{$enabled:!!s.disenador_revision_check,children:[a.jsx(Lh,{children:a.jsxs(Oh,{children:[a.jsx(Rh,{type:"checkbox",id:"disenador_revision_check",checked:!!s.disenador_revision_check,onChange:b=>m("disenador_revision_check",b.target.checked)}),a.jsx(Ih,{htmlFor:"disenador_revision_check",children:a.jsx(zh,{children:"Diseador Revisin"})})]})}),s.disenador_revision_check?a.jsxs(Bh,{children:[a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Nombre"}),a.jsx(is,{value:s.disenador_revision_nombre||"",onChange:b=>f("disenador_revision_nombre",b.target.value),placeholder:"Nombre del diseador revisor"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Direccin"}),a.jsx(is,{value:s.disenador_revision_direccion||"",onChange:b=>f("disenador_revision_direccion",b.target.value),placeholder:"Direccin"})]}),a.jsxs(Nr,{children:[a.jsx(Lr,{children:"Cantidad"}),a.jsx(is,{type:"number",min:"0",value:s.cantidad_disenador_revision||"",onChange:b=>f("cantidad_disenador_revision",b.target.value?Number(b.target.value):0)})]})]}):null]})]}),a.jsxs(wse,{children:[a.jsx(y5,{type:"button",onClick:v,children:"Cancelar"}),a.jsx(y5,{type:"submit",$primary:!0,disabled:h.isPending,children:h.isPending?"Creando...":"Crear Muestra"})]})]})]})}const $se=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Tse=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,Ese=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Ase=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1rem;
`,Fse=p.div`
  margin-bottom: 2rem;
`,Pse=p.h2`
  font-size: 1.1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Dse=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  cursor: ${({$status:e})=>e==="available"?"pointer":"default"};
  transition: all 0.2s;
  opacity: ${({$status:e})=>e==="disabled"?.5:1};

  &:hover {
    ${({$status:e})=>e==="available"&&`
      border-color: ${d.colors.primary};
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    `}
  }
`,Mse=p.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.5rem;
`,Ose=p.h3`
  font-size: 0.95rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Rse=p.span`
  font-size: 0.65rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  text-transform: uppercase;

  ${({$status:e})=>{switch(e){case"available":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"pending":return`
          background: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `;case"disabled":return`
          background: ${d.colors.textSecondary}20;
          color: ${d.colors.textSecondary};
        `}}}
`,Ise=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,Nse=p.div`
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
`,b5=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,_5=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,Vb=[{name:"OTs y Gestion",reports:[{id:"active-ots-per-area",title:"OTs Activas por Usuario",description:"Visualiza la distribucion de OTs activas por usuario y area",icon:"",status:"available",route:"reporte-ots-activas"},{id:"completed-ots",title:"OTs Completadas",description:"Resumen de OTs completadas con metricas de tiempo",icon:"",status:"available",route:"reporte-ots-completadas"},{id:"completed-ots-dates",title:"OTs Completadas Entre Fechas",description:"Filtro avanzado de OTs completadas por rango de fechas",icon:"",status:"available",route:"reporte-ots-completadas-fechas"},{id:"gestion-ot-actives",title:"Gestion OTs Activas",description:"Dashboard de gestion de OTs en proceso",icon:"",status:"available",route:"reporte-gestion-ots-activas"},{id:"gestion-load-month",title:"Carga de OTs por Mes",description:"Analisis de carga de trabajo mensual",icon:"",status:"available",route:"reporte-carga-mensual"}]},{name:"Tiempos y Rendimiento",reports:[{id:"time-by-area",title:"Tiempo por Area",description:"Tiempo promedio de OTs por area mensual",icon:"",status:"available",route:"reporte-tiempo-area"},{id:"tiempo-disenador-externo",title:"Tiempo Disenador Externo",description:"Metricas de tiempo para disenadores externos",icon:"",status:"available",route:"reporte-tiempo-disenador-externo"},{id:"tiempo-primera-muestra",title:"Tiempo Primera Muestra",description:"Tiempo hasta la primera muestra por OT",icon:"",status:"available",route:"reporte-tiempo-primera-muestra"}]},{name:"Sala de Muestras",reports:[{id:"sala-muestra",title:"Sala de Muestra",description:"Estado y gestion de la sala de muestras",icon:"",status:"available",route:"reporte-sala-muestra"},{id:"indicador-sala-muestra",title:"Indicador Sala Muestra",description:"KPIs de la sala de muestras",icon:"",status:"available",route:"reporte-indicador-sala-muestra"},{id:"diseno-estructural-sala",title:"Diseno Estructural y Sala Muestra",description:"Relacion entre diseno y sala de muestras",icon:"",status:"available",route:"reporte-diseno-estructural-sala"},{id:"muestras",title:"Muestras",description:"Listado y estado de muestras",icon:"",status:"available",route:"reporte-muestras"}]},{name:"Rechazos y Anulaciones",reports:[{id:"anulaciones",title:"Anulaciones",description:"Registro de OTs anuladas con motivos y tendencias",icon:"",status:"available",route:"reporte-anulaciones"},{id:"rechazos-mes",title:"Rechazos por Mes",description:"Tendencia de rechazos mensual",icon:"",status:"available",route:"reporte-rechazos"},{id:"reasons-rejection",title:"Motivos de Rechazo",description:"Analisis de razones de rechazo por mes",icon:"",status:"available",route:"reporte-motivos-rechazo"}]}];function Lse({onNavigate:e}){const[t,r]=E.useState(null),n=l=>{l.status==="available"&&l.route?e(l.route):l.status==="pending"&&(r(l.id),setTimeout(()=>r(null),2e3))},s=l=>{switch(l){case"available":return"Disponible";case"pending":return"En desarrollo";case"disabled":return"Deshabilitado"}},i=Vb.reduce((l,c)=>l+c.reports.length,0),o=Vb.reduce((l,c)=>l+c.reports.filter(u=>u.status==="available").length,0);return a.jsxs($se,{children:[a.jsx(Tse,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsxs(Ese,{children:["Reporteria (",o,"/",i," disponibles)"]}),a.jsx(b5,{children:a.jsx(_5,{children:'Los reportes estan siendo migrados desde el sistema Laravel. Cada reporte mostrara graficos interactivos con Chart.js y permitira filtrar por fechas, areas y usuarios. Los reportes marcados como "En desarrollo" estaran disponibles proximamente.'})}),t&&a.jsx(b5,{style:{background:`${d.colors.warning}10`,borderColor:`${d.colors.warning}30`},children:a.jsx(_5,{style:{color:d.colors.warning},children:"Este reporte esta en desarrollo. Estara disponible proximamente."})}),Vb.map(l=>a.jsxs(Fse,{children:[a.jsx(Pse,{children:l.name}),a.jsx(Ase,{children:l.reports.map(c=>a.jsxs(Dse,{$status:c.status,onClick:()=>n(c),children:[a.jsx(Nse,{children:c.icon}),a.jsxs(Mse,{children:[a.jsx(Ose,{children:c.title}),a.jsx(Rse,{$status:c.status,children:s(c.status)})]}),a.jsx(Ise,{children:c.description})]},c.id))})]},l.name))]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function hp(e){return e+.5|0}const sl=(e,t,r)=>Math.max(Math.min(e,r),t);function Ef(e){return sl(hp(e*2.55),0,255)}function xl(e){return sl(hp(e*255),0,255)}function Ni(e){return sl(hp(e/2.55)/100,0,1)}function w5(e){return sl(hp(e*100),0,100)}const Ns={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},b2=[..."0123456789ABCDEF"],zse=e=>b2[e&15],Bse=e=>b2[(e&240)>>4]+b2[e&15],Bm=e=>(e&240)>>4===(e&15),Use=e=>Bm(e.r)&&Bm(e.g)&&Bm(e.b)&&Bm(e.a);function Vse(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&Ns[e[1]]*17,g:255&Ns[e[2]]*17,b:255&Ns[e[3]]*17,a:t===5?Ns[e[4]]*17:255}:(t===7||t===9)&&(r={r:Ns[e[1]]<<4|Ns[e[2]],g:Ns[e[3]]<<4|Ns[e[4]],b:Ns[e[5]]<<4|Ns[e[6]],a:t===9?Ns[e[7]]<<4|Ns[e[8]]:255})),r}const Hse=(e,t)=>e<255?t(e):"";function Wse(e){var t=Use(e)?zse:Bse;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Hse(e.a,t):void 0}const Gse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function o6(e,t,r){const n=t*Math.min(r,1-r),s=(i,o=(i+e/30)%12)=>r-n*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function qse(e,t,r){const n=(s,i=(s+e/60)%6)=>r-r*t*Math.max(Math.min(i,4-i,1),0);return[n(5),n(3),n(1)]}function Kse(e,t,r){const n=o6(e,1,.5);let s;for(t+r>1&&(s=1/(t+r),t*=s,r*=s),s=0;s<3;s++)n[s]*=1-t-r,n[s]+=t;return n}function Xse(e,t,r,n,s){return e===s?(t-r)/n+(t<r?6:0):t===s?(r-e)/n+2:(e-t)/n+4}function Fk(e){const r=e.r/255,n=e.g/255,s=e.b/255,i=Math.max(r,n,s),o=Math.min(r,n,s),l=(i+o)/2;let c,u,h;return i!==o&&(h=i-o,u=l>.5?h/(2-i-o):h/(i+o),c=Xse(r,n,s,h,i),c=c*60+.5),[c|0,u||0,l]}function Pk(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(xl)}function Dk(e,t,r){return Pk(o6,e,t,r)}function Yse(e,t,r){return Pk(Kse,e,t,r)}function Qse(e,t,r){return Pk(qse,e,t,r)}function l6(e){return(e%360+360)%360}function Jse(e){const t=Gse.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?Ef(+t[5]):xl(+t[5]));const s=l6(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=Yse(s,i,o):t[1]==="hsv"?n=Qse(s,i,o):n=Dk(s,i,o),{r:n[0],g:n[1],b:n[2],a:r}}function Zse(e,t){var r=Fk(e);r[0]=l6(r[0]+t),r=Dk(r),e.r=r[0],e.g=r[1],e.b=r[2]}function eae(e){if(!e)return;const t=Fk(e),r=t[0],n=w5(t[1]),s=w5(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${s}%, ${Ni(e.a)})`:`hsl(${r}, ${n}%, ${s}%)`}const j5={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},k5={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function tae(){const e={},t=Object.keys(k5),r=Object.keys(j5);let n,s,i,o,l;for(n=0;n<t.length;n++){for(o=l=t[n],s=0;s<r.length;s++)i=r[s],l=l.replace(i,j5[i]);i=parseInt(k5[o],16),e[l]=[i>>16&255,i>>8&255,i&255]}return e}let Um;function rae(e){Um||(Um=tae(),Um.transparent=[0,0,0,0]);const t=Um[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const nae=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function sae(e){const t=nae.exec(e);let r=255,n,s,i;if(t){if(t[7]!==n){const o=+t[7];r=t[8]?Ef(o):sl(o*255,0,255)}return n=+t[1],s=+t[3],i=+t[5],n=255&(t[2]?Ef(n):sl(n,0,255)),s=255&(t[4]?Ef(s):sl(s,0,255)),i=255&(t[6]?Ef(i):sl(i,0,255)),{r:n,g:s,b:i,a:r}}}function aae(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Ni(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const Hb=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Cd=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function iae(e,t,r){const n=Cd(Ni(e.r)),s=Cd(Ni(e.g)),i=Cd(Ni(e.b));return{r:xl(Hb(n+r*(Cd(Ni(t.r))-n))),g:xl(Hb(s+r*(Cd(Ni(t.g))-s))),b:xl(Hb(i+r*(Cd(Ni(t.b))-i))),a:e.a+r*(t.a-e.a)}}function Vm(e,t,r){if(e){let n=Fk(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=Dk(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function c6(e,t){return e&&Object.assign(t||{},e)}function S5(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=xl(e[3]))):(t=c6(e,{r:0,g:0,b:0,a:1}),t.a=xl(t.a)),t}function oae(e){return e.charAt(0)==="r"?sae(e):Jse(e)}class O0{constructor(t){if(t instanceof O0)return t;const r=typeof t;let n;r==="object"?n=S5(t):r==="string"&&(n=Vse(t)||rae(t)||oae(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=c6(this._rgb);return t&&(t.a=Ni(t.a)),t}set rgb(t){this._rgb=S5(t)}rgbString(){return this._valid?aae(this._rgb):void 0}hexString(){return this._valid?Wse(this._rgb):void 0}hslString(){return this._valid?eae(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,s=t.rgb;let i;const o=r===i?.5:r,l=2*o-1,c=n.a-s.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;i=1-u,n.r=255&u*n.r+i*s.r+.5,n.g=255&u*n.g+i*s.g+.5,n.b=255&u*n.b+i*s.b+.5,n.a=o*n.a+(1-o)*s.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=iae(this._rgb,t._rgb,r)),this}clone(){return new O0(this.rgb)}alpha(t){return this._rgb.a=xl(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=hp(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Vm(this._rgb,2,t),this}darken(t){return Vm(this._rgb,2,-t),this}saturate(t){return Vm(this._rgb,1,t),this}desaturate(t){return Vm(this._rgb,1,-t),this}rotate(t){return Zse(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ai(){}const lae=(()=>{let e=0;return()=>e++})();function xt(e){return e==null}function pr(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function et(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function pn(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Xa(e,t){return pn(e)?e:t}function Ye(e,t){return typeof e>"u"?t:e}const cae=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,d6=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Dt(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function wt(e,t,r,n){let s,i,o;if(pr(e))for(i=e.length,s=0;s<i;s++)t.call(r,e[s],s);else if(et(e))for(o=Object.keys(e),i=o.length,s=0;s<i;s++)t.call(r,e[o[s]],o[s])}function Zx(e,t){let r,n,s,i;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(s=e[r],i=t[r],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function e1(e){if(pr(e))return e.map(e1);if(et(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let s=0;for(;s<n;++s)t[r[s]]=e1(e[r[s]]);return t}return e}function u6(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function dae(e,t,r,n){if(!u6(e))return;const s=t[e],i=r[e];et(s)&&et(i)?R0(s,i,n):t[e]=e1(i)}function R0(e,t,r){const n=pr(t)?t:[t],s=n.length;if(!et(e))return e;r=r||{};const i=r.merger||dae;let o;for(let l=0;l<s;++l){if(o=n[l],!et(o))continue;const c=Object.keys(o);for(let u=0,h=c.length;u<h;++u)i(c[u],e,o,r)}return e}function Qf(e,t){return R0(e,t,{merger:uae})}function uae(e,t,r){if(!u6(e))return;const n=t[e],s=r[e];et(n)&&et(s)?Qf(n,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=e1(s))}const C5={"":e=>e,x:e=>e.x,y:e=>e.y};function hae(e){const t=e.split("."),r=[];let n="";for(const s of t)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function fae(e){const t=hae(e);return r=>{for(const n of t){if(n==="")break;r=r&&r[n]}return r}}function Yc(e,t){return(C5[t]||(C5[t]=fae(t)))(e)}function Mk(e){return e.charAt(0).toUpperCase()+e.slice(1)}const I0=e=>typeof e<"u",kl=e=>typeof e=="function",$5=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function pae(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const jt=Math.PI,Wt=2*jt,mae=Wt+jt,t1=Number.POSITIVE_INFINITY,gae=jt/180,wr=jt/2,Hl=jt/4,T5=jt*2/3,h6=Math.log10,hi=Math.sign;function Jf(e,t,r){return Math.abs(e-t)<r}function E5(e){const t=Math.round(e);e=Jf(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(h6(e))),n=e/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function xae(e){const t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n===0&&(t.push(n),t.push(e/n));return r===(r|0)&&t.push(r),t.sort((s,i)=>s-i).pop(),t}function vae(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function N0(e){return!vae(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function yae(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}function bae(e,t,r){let n,s,i;for(n=0,s=e.length;n<s;n++)i=e[n][r],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function Gi(e){return e*(jt/180)}function _ae(e){return e*(180/jt)}function A5(e){if(!pn(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function f6(e,t){const r=t.x-e.x,n=t.y-e.y,s=Math.sqrt(r*r+n*n);let i=Math.atan2(n,r);return i<-.5*jt&&(i+=Wt),{angle:i,distance:s}}function _2(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function wae(e,t){return(e-t+mae)%Wt-jt}function us(e){return(e%Wt+Wt)%Wt}function L0(e,t,r,n){const s=us(e),i=us(t),o=us(r),l=us(i-s),c=us(o-s),u=us(s-i),h=us(s-o);return s===i||s===o||n&&i===o||l>c&&u<h}function ln(e,t,r){return Math.max(t,Math.min(r,e))}function jae(e){return ln(e,-32768,32767)}function qi(e,t,r,n=1e-6){return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function Ok(e,t,r){r=r||(o=>e[o]<t);let n=e.length-1,s=0,i;for(;n-s>1;)i=s+n>>1,r(i)?s=i:n=i;return{lo:s,hi:n}}const mc=(e,t,r,n)=>Ok(e,r,n?s=>{const i=e[s][t];return i<r||i===r&&e[s+1][t]===r}:s=>e[s][t]<r),kae=(e,t,r)=>Ok(e,r,n=>e[n][t]>=r);function Sae(e,t,r){let n=0,s=e.length;for(;n<s&&e[n]<t;)n++;for(;s>n&&e[s-1]>r;)s--;return n>0||s<e.length?e.slice(n,s):e}const p6=["push","pop","shift","splice","unshift"];function Cae(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),p6.forEach(r=>{const n="_onData"+Mk(r),s=e[r];Object.defineProperty(e,r,{configurable:!0,enumerable:!1,value(...i){const o=s.apply(this,i);return e._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...i)}),o}})})}function F5(e,t){const r=e._chartjs;if(!r)return;const n=r.listeners,s=n.indexOf(t);s!==-1&&n.splice(s,1),!(n.length>0)&&(p6.forEach(i=>{delete e[i]}),delete e._chartjs)}function m6(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const g6=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function x6(e,t){let r=[],n=!1;return function(...s){r=s,n||(n=!0,g6.call(window,()=>{n=!1,e.apply(t,r)}))}}function $ae(e,t){let r;return function(...n){return t?(clearTimeout(r),r=setTimeout(e,t,n)):e.apply(this,n),t}}const Rk=e=>e==="start"?"left":e==="end"?"right":"center",Zr=(e,t,r)=>e==="start"?t:e==="end"?r:(t+r)/2,Tae=(e,t,r,n)=>e===(n?"left":"right")?r:e==="center"?(t+r)/2:t;function Eae(e,t,r){const n=t.length;let s=0,i=n;if(e._sorted){const{iScale:o,vScale:l,_parsed:c}=e,u=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,h=o.axis,{min:f,max:m,minDefined:g,maxDefined:v}=o.getUserBounds();if(g){if(s=Math.min(mc(c,h,f).lo,r?n:mc(t,h,o.getPixelForValue(f)).lo),u){const x=c.slice(0,s+1).reverse().findIndex(y=>!xt(y[l.axis]));s-=Math.max(0,x)}s=ln(s,0,n-1)}if(v){let x=Math.max(mc(c,o.axis,m,!0).hi+1,r?0:mc(t,h,o.getPixelForValue(m),!0).hi+1);if(u){const y=c.slice(x-1).findIndex(_=>!xt(_[l.axis]));x+=Math.max(0,y)}i=ln(x,s,n)-s}else i=n-s}return{start:s,count:i}}function Aae(e){const{xScale:t,yScale:r,_scaleRanges:n}=e,s={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!n)return e._scaleRanges=s,!0;const i=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,s),i}const Hm=e=>e===0||e===1,P5=(e,t,r)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Wt/r)),D5=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*Wt/r)+1,Zf={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*wr)+1,easeOutSine:e=>Math.sin(e*wr),easeInOutSine:e=>-.5*(Math.cos(jt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Hm(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Hm(e)?e:P5(e,.075,.3),easeOutElastic:e=>Hm(e)?e:D5(e,.075,.3),easeInOutElastic(e){return Hm(e)?e:e<.5?.5*P5(e*2,.1125,.45):.5+.5*D5(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Zf.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Zf.easeInBounce(e*2)*.5:Zf.easeOutBounce(e*2-1)*.5+.5};function Ik(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function M5(e){return Ik(e)?e:new O0(e)}function Wb(e){return Ik(e)?e:new O0(e).saturate(.5).darken(.1).hexString()}const Fae=["x","y","borderWidth","radius","tension"],Pae=["color","borderColor","backgroundColor"];function Dae(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:Pae},numbers:{type:"number",properties:Fae}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Mae(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const O5=new Map;function Oae(e,t){t=t||{};const r=e+JSON.stringify(t);let n=O5.get(r);return n||(n=new Intl.NumberFormat(e,t),O5.set(r,n)),n}function Nk(e,t,r){return Oae(t,r).format(e)}const Rae={values(e){return pr(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let s,i=e;if(r.length>1){const u=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(u<1e-4||u>1e15)&&(s="scientific"),i=Iae(e,r)}const o=h6(Math.abs(i)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),Nk(e,n,c)}};function Iae(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var v6={formatters:Rae};function Nae(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:v6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Qc=Object.create(null),w2=Object.create(null);function e0(e,t){if(!t)return e;const r=t.split(".");for(let n=0,s=r.length;n<s;++n){const i=r[n];e=e[i]||(e[i]=Object.create(null))}return e}function Gb(e,t,r){return typeof t=="string"?R0(e0(e,t),r):R0(e0(e,""),t)}class Lae{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>Wb(s.backgroundColor),this.hoverBorderColor=(n,s)=>Wb(s.borderColor),this.hoverColor=(n,s)=>Wb(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return Gb(this,t,r)}get(t){return e0(this,t)}describe(t,r){return Gb(w2,t,r)}override(t,r){return Gb(Qc,t,r)}route(t,r,n,s){const i=e0(this,t),o=e0(this,n),l="_"+r;Object.defineProperties(i,{[l]:{value:i[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],u=o[s];return et(c)?Object.assign({},u,c):Ye(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(r=>r(this))}}var sr=new Lae({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Dae,Mae,Nae]);function zae(e){return!e||xt(e.size)||xt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function R5(e,t,r,n,s){let i=t[s];return i||(i=t[s]=e.measureText(s).width,r.push(s)),i>n&&(n=i),n}function Wl(e,t,r){const n=e.currentDevicePixelRatio,s=r!==0?Math.max(r/2,.5):0;return Math.round((t-s)*n)/n+s}function I5(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function j2(e,t,r,n){y6(e,t,r,n,null)}function y6(e,t,r,n,s){let i,o,l,c,u,h,f,m;const g=t.pointStyle,v=t.rotation,x=t.radius;let y=(v||0)*gae;if(g&&typeof g=="object"&&(i=g.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){e.save(),e.translate(r,n),e.rotate(y),e.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),e.restore();return}if(!(isNaN(x)||x<=0)){switch(e.beginPath(),g){default:s?e.ellipse(r,n,s/2,x,0,0,Wt):e.arc(r,n,x,0,Wt),e.closePath();break;case"triangle":h=s?s/2:x,e.moveTo(r+Math.sin(y)*h,n-Math.cos(y)*x),y+=T5,e.lineTo(r+Math.sin(y)*h,n-Math.cos(y)*x),y+=T5,e.lineTo(r+Math.sin(y)*h,n-Math.cos(y)*x),e.closePath();break;case"rectRounded":u=x*.516,c=x-u,o=Math.cos(y+Hl)*c,f=Math.cos(y+Hl)*(s?s/2-u:c),l=Math.sin(y+Hl)*c,m=Math.sin(y+Hl)*(s?s/2-u:c),e.arc(r-f,n-l,u,y-jt,y-wr),e.arc(r+m,n-o,u,y-wr,y),e.arc(r+f,n+l,u,y,y+wr),e.arc(r-m,n+o,u,y+wr,y+jt),e.closePath();break;case"rect":if(!v){c=Math.SQRT1_2*x,h=s?s/2:c,e.rect(r-h,n-c,2*h,2*c);break}y+=Hl;case"rectRot":f=Math.cos(y)*(s?s/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,m=Math.sin(y)*(s?s/2:x),e.moveTo(r-f,n-l),e.lineTo(r+m,n-o),e.lineTo(r+f,n+l),e.lineTo(r-m,n+o),e.closePath();break;case"crossRot":y+=Hl;case"cross":f=Math.cos(y)*(s?s/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,m=Math.sin(y)*(s?s/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"star":f=Math.cos(y)*(s?s/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,m=Math.sin(y)*(s?s/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o),y+=Hl,f=Math.cos(y)*(s?s/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,m=Math.sin(y)*(s?s/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"line":o=s?s/2:Math.cos(y)*x,l=Math.sin(y)*x,e.moveTo(r-o,n-l),e.lineTo(r+o,n+l);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(y)*(s?s/2:x),n+Math.sin(y)*x);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function z0(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function V1(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function H1(e){e.restore()}function Bae(e,t,r,n,s){if(!t)return e.lineTo(r.x,r.y);if(s==="middle"){const i=(t.x+r.x)/2;e.lineTo(i,t.y),e.lineTo(i,r.y)}else s==="after"!=!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function Uae(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function Vae(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),xt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Hae(e,t,r,n,s){if(s.strikethrough||s.underline){const i=e.measureText(n),o=t-i.actualBoundingBoxLeft,l=t+i.actualBoundingBoxRight,c=r-i.actualBoundingBoxAscent,u=r+i.actualBoundingBoxDescent,h=s.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(o,h),e.lineTo(l,h),e.stroke()}}function Wae(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function B0(e,t,r,n,s,i={}){const o=pr(t)?t:[t],l=i.strokeWidth>0&&i.strokeColor!=="";let c,u;for(e.save(),e.font=s.string,Vae(e,i),c=0;c<o.length;++c)u=o[c],i.backdrop&&Wae(e,i.backdrop),l&&(i.strokeColor&&(e.strokeStyle=i.strokeColor),xt(i.strokeWidth)||(e.lineWidth=i.strokeWidth),e.strokeText(u,r,n,i.maxWidth)),e.fillText(u,r,n,i.maxWidth),Hae(e,r,n,u,i),n+=Number(s.lineHeight);e.restore()}function r1(e,t){const{x:r,y:n,w:s,h:i,radius:o}=t;e.arc(r+o.topLeft,n+o.topLeft,o.topLeft,1.5*jt,jt,!0),e.lineTo(r,n+i-o.bottomLeft),e.arc(r+o.bottomLeft,n+i-o.bottomLeft,o.bottomLeft,jt,wr,!0),e.lineTo(r+s-o.bottomRight,n+i),e.arc(r+s-o.bottomRight,n+i-o.bottomRight,o.bottomRight,wr,0,!0),e.lineTo(r+s,n+o.topRight),e.arc(r+s-o.topRight,n+o.topRight,o.topRight,0,-wr,!0),e.lineTo(r+o.topLeft,n)}const Gae=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,qae=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Kae(e,t){const r=(""+e).match(Gae);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const Xae=e=>+e||0;function Lk(e,t){const r={},n=et(t),s=n?Object.keys(t):t,i=et(e)?n?o=>Ye(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of s)r[o]=Xae(i(o));return r}function b6(e){return Lk(e,{top:"y",right:"x",bottom:"y",left:"x"})}function su(e){return Lk(e,["topLeft","topRight","bottomLeft","bottomRight"])}function na(e){const t=b6(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function cn(e,t){e=e||{},t=t||sr.font;let r=Ye(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=Ye(e.style,t.style);n&&!(""+n).match(qae)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:Ye(e.family,t.family),lineHeight:Kae(Ye(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:Ye(e.weight,t.weight),string:""};return s.string=zae(s),s}function Wm(e,t,r,n){let s,i,o;for(s=0,i=e.length;s<i;++s)if(o=e[s],o!==void 0&&o!==void 0)return o}function Yae(e,t,r){const{min:n,max:s}=e,i=d6(t,(s-n)/2),o=(l,c)=>r&&l===0?0:l+c;return{min:o(n,-Math.abs(i)),max:o(s,i)}}function od(e,t){return Object.assign(Object.create(e),t)}function zk(e,t=[""],r,n,s=()=>e[0]){const i=r||e;typeof n>"u"&&(n=k6("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:n,_getTarget:s,override:l=>zk([l,...e],t,i,n)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return w6(l,c,()=>sie(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return L5(l).includes(c)},ownKeys(l){return L5(l)},set(l,c,u){const h=l._storage||(l._storage=s());return l[c]=h[c]=u,delete l._keys,!0}})}function Ou(e,t,r,n){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:_6(e,n),setContext:i=>Ou(e,i,r,n),override:i=>Ou(e.override(i),t,r,n)};return new Proxy(s,{deleteProperty(i,o){return delete i[o],delete e[o],!0},get(i,o,l){return w6(i,o,()=>Jae(i,o,l))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(i,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(i,o,l){return e[o]=l,delete i[o],!0}})}function _6(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:r,indexable:n,isScriptable:kl(r)?r:()=>r,isIndexable:kl(n)?n:()=>n}}const Qae=(e,t)=>e?e+Mk(t):t,Bk=(e,t)=>et(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function w6(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const n=r();return e[t]=n,n}function Jae(e,t,r){const{_proxy:n,_context:s,_subProxy:i,_descriptors:o}=e;let l=n[t];return kl(l)&&o.isScriptable(t)&&(l=Zae(t,l,e,r)),pr(l)&&l.length&&(l=eie(t,l,e,o.isIndexable)),Bk(t,l)&&(l=Ou(l,s,i&&i[t],o)),l}function Zae(e,t,r,n){const{_proxy:s,_context:i,_subProxy:o,_stack:l}=r;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(i,o||n);return l.delete(e),Bk(e,c)&&(c=Uk(s._scopes,s,e,c)),c}function eie(e,t,r,n){const{_proxy:s,_context:i,_subProxy:o,_descriptors:l}=r;if(typeof i.index<"u"&&n(e))return t[i.index%t.length];if(et(t[0])){const c=t,u=s._scopes.filter(h=>h!==c);t=[];for(const h of c){const f=Uk(u,s,e,h);t.push(Ou(f,i,o&&o[e],l))}}return t}function j6(e,t,r){return kl(e)?e(t,r):e}const tie=(e,t)=>e===!0?t:typeof e=="string"?Yc(t,e):void 0;function rie(e,t,r,n,s){for(const i of t){const o=tie(r,i);if(o){e.add(o);const l=j6(o._fallback,r,s);if(typeof l<"u"&&l!==r&&l!==n)return l}else if(o===!1&&typeof n<"u"&&r!==n)return null}return!1}function Uk(e,t,r,n){const s=t._rootScopes,i=j6(t._fallback,r,n),o=[...e,...s],l=new Set;l.add(n);let c=N5(l,o,r,i||r,n);return c===null||typeof i<"u"&&i!==r&&(c=N5(l,o,i,c,n),c===null)?!1:zk(Array.from(l),[""],s,i,()=>nie(t,r,n))}function N5(e,t,r,n,s){for(;r;)r=rie(e,t,r,n,s);return r}function nie(e,t,r){const n=e._getTarget();t in n||(n[t]={});const s=n[t];return pr(s)&&et(r)?r:s||{}}function sie(e,t,r,n){let s;for(const i of t)if(s=k6(Qae(i,e),r),typeof s<"u")return Bk(e,s)?Uk(r,n,e,s):s}function k6(e,t){for(const r of t){if(!r)continue;const n=r[e];if(typeof n<"u")return n}}function L5(e){let t=e._keys;return t||(t=e._keys=aie(e._scopes)),t}function aie(e){const t=new Set;for(const r of e)for(const n of Object.keys(r).filter(s=>!s.startsWith("_")))t.add(n);return Array.from(t)}const iie=Number.EPSILON||1e-14,Ru=(e,t)=>t<e.length&&!e[t].skip&&e[t],S6=e=>e==="x"?"y":"x";function oie(e,t,r,n){const s=e.skip?t:e,i=t,o=r.skip?t:r,l=_2(i,s),c=_2(o,i);let u=l/(l+c),h=c/(l+c);u=isNaN(u)?0:u,h=isNaN(h)?0:h;const f=n*u,m=n*h;return{previous:{x:i.x-f*(o.x-s.x),y:i.y-f*(o.y-s.y)},next:{x:i.x+m*(o.x-s.x),y:i.y+m*(o.y-s.y)}}}function lie(e,t,r){const n=e.length;let s,i,o,l,c,u=Ru(e,0);for(let h=0;h<n-1;++h)if(c=u,u=Ru(e,h+1),!(!c||!u)){if(Jf(t[h],0,iie)){r[h]=r[h+1]=0;continue}s=r[h]/t[h],i=r[h+1]/t[h],l=Math.pow(s,2)+Math.pow(i,2),!(l<=9)&&(o=3/Math.sqrt(l),r[h]=s*o*t[h],r[h+1]=i*o*t[h])}}function cie(e,t,r="x"){const n=S6(r),s=e.length;let i,o,l,c=Ru(e,0);for(let u=0;u<s;++u){if(o=l,l=c,c=Ru(e,u+1),!l)continue;const h=l[r],f=l[n];o&&(i=(h-o[r])/3,l[`cp1${r}`]=h-i,l[`cp1${n}`]=f-i*t[u]),c&&(i=(c[r]-h)/3,l[`cp2${r}`]=h+i,l[`cp2${n}`]=f+i*t[u])}}function die(e,t="x"){const r=S6(t),n=e.length,s=Array(n).fill(0),i=Array(n);let o,l,c,u=Ru(e,0);for(o=0;o<n;++o)if(l=c,c=u,u=Ru(e,o+1),!!c){if(u){const h=u[t]-c[t];s[o]=h!==0?(u[r]-c[r])/h:0}i[o]=l?u?hi(s[o-1])!==hi(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}lie(e,s,i),cie(e,i,t)}function Gm(e,t,r){return Math.max(Math.min(e,r),t)}function uie(e,t){let r,n,s,i,o,l=z0(e[0],t);for(r=0,n=e.length;r<n;++r)o=i,i=l,l=r<n-1&&z0(e[r+1],t),i&&(s=e[r],o&&(s.cp1x=Gm(s.cp1x,t.left,t.right),s.cp1y=Gm(s.cp1y,t.top,t.bottom)),l&&(s.cp2x=Gm(s.cp2x,t.left,t.right),s.cp2y=Gm(s.cp2y,t.top,t.bottom)))}function hie(e,t,r,n,s){let i,o,l,c;if(t.spanGaps&&(e=e.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")die(e,s);else{let u=n?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)l=e[i],c=oie(u,l,e[Math.min(i+1,o-(n?0:1))%o],t.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}t.capBezierPoints&&uie(e,r)}function Vk(){return typeof window<"u"&&typeof document<"u"}function Hk(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function n1(e,t,r){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[r])):n=e,n}const W1=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function fie(e,t){return W1(e).getPropertyValue(t)}const pie=["top","right","bottom","left"];function Mc(e,t,r){const n={};r=r?"-"+r:"";for(let s=0;s<4;s++){const i=pie[s];n[i]=parseFloat(e[t+"-"+i+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const mie=(e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot);function gie(e,t){const r=e.touches,n=r&&r.length?r[0]:e,{offsetX:s,offsetY:i}=n;let o=!1,l,c;if(mie(s,i,e.target))l=s,c=i;else{const u=t.getBoundingClientRect();l=n.clientX-u.left,c=n.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function ac(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:n}=t,s=W1(r),i=s.boxSizing==="border-box",o=Mc(s,"padding"),l=Mc(s,"border","width"),{x:c,y:u,box:h}=gie(e,r),f=o.left+(h&&l.left),m=o.top+(h&&l.top);let{width:g,height:v}=t;return i&&(g-=o.width+l.width,v-=o.height+l.height),{x:Math.round((c-f)/g*r.width/n),y:Math.round((u-m)/v*r.height/n)}}function xie(e,t,r){let n,s;if(t===void 0||r===void 0){const i=e&&Hk(e);if(!i)t=e.clientWidth,r=e.clientHeight;else{const o=i.getBoundingClientRect(),l=W1(i),c=Mc(l,"border","width"),u=Mc(l,"padding");t=o.width-u.width-c.width,r=o.height-u.height-c.height,n=n1(l.maxWidth,i,"clientWidth"),s=n1(l.maxHeight,i,"clientHeight")}}return{width:t,height:r,maxWidth:n||t1,maxHeight:s||t1}}const al=e=>Math.round(e*10)/10;function vie(e,t,r,n){const s=W1(e),i=Mc(s,"margin"),o=n1(s.maxWidth,e,"clientWidth")||t1,l=n1(s.maxHeight,e,"clientHeight")||t1,c=xie(e,t,r);let{width:u,height:h}=c;if(s.boxSizing==="content-box"){const m=Mc(s,"border","width"),g=Mc(s,"padding");u-=g.width+m.width,h-=g.height+m.height}return u=Math.max(0,u-i.width),h=Math.max(0,n?u/n:h-i.height),u=al(Math.min(u,o,c.maxWidth)),h=al(Math.min(h,l,c.maxHeight)),u&&!h&&(h=al(u/2)),(t!==void 0||r!==void 0)&&n&&c.height&&h>c.height&&(h=c.height,u=al(Math.floor(h*n))),{width:u,height:h}}function z5(e,t,r){const n=t||1,s=al(e.height*n),i=al(e.width*n);e.height=al(e.height),e.width=al(e.width);const o=e.canvas;return o.style&&(r||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||o.height!==s||o.width!==i?(e.currentDevicePixelRatio=n,o.height=s,o.width=i,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const yie=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Vk()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function B5(e,t){const r=fie(e,t),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function ic(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function bie(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:n==="middle"?r<.5?e.y:t.y:n==="after"?r<1?e.y:t.y:r>0?t.y:e.y}}function _ie(e,t,r,n){const s={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=ic(e,s,r),l=ic(s,i,r),c=ic(i,t,r),u=ic(o,l,r),h=ic(l,c,r);return ic(u,h,r)}const wie=function(e,t){return{x(r){return e+e+t-r},setWidth(r){t=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},jie=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function au(e,t,r){return e?wie(t,r):jie()}function C6(e,t){let r,n;(t==="ltr"||t==="rtl")&&(r=e.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function $6(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function T6(e){return e==="angle"?{between:L0,compare:wae,normalize:us}:{between:qi,compare:(t,r)=>t-r,normalize:t=>t}}function U5({start:e,end:t,count:r,loop:n,style:s}){return{start:e%r,end:t%r,loop:n&&(t-e+1)%r===0,style:s}}function kie(e,t,r){const{property:n,start:s,end:i}=r,{between:o,normalize:l}=T6(n),c=t.length;let{start:u,end:h,loop:f}=e,m,g;if(f){for(u+=c,h+=c,m=0,g=c;m<g&&o(l(t[u%c][n]),s,i);++m)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:f,style:e.style}}function E6(e,t,r){if(!r)return[e];const{property:n,start:s,end:i}=r,o=t.length,{compare:l,between:c,normalize:u}=T6(n),{start:h,end:f,loop:m,style:g}=kie(e,t,r),v=[];let x=!1,y=null,_,b,w;const C=()=>c(s,w,_)&&l(s,w)!==0,j=()=>l(i,_)===0||c(i,w,_),T=()=>x||C(),k=()=>!x||j();for(let M=h,A=h;M<=f;++M)b=t[M%o],!b.skip&&(_=u(b[n]),_!==w&&(x=c(_,s,i),y===null&&T()&&(y=l(_,s)===0?M:A),y!==null&&k()&&(v.push(U5({start:y,end:M,loop:m,count:o,style:g})),y=null),A=M,w=_));return y!==null&&v.push(U5({start:y,end:f,loop:m,count:o,style:g})),v}function A6(e,t){const r=[],n=e.segments;for(let s=0;s<n.length;s++){const i=E6(n[s],e.points,t);i.length&&r.push(...i)}return r}function Sie(e,t,r,n){let s=0,i=t-1;if(r&&!n)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,r&&(i+=s);i>s&&e[i%t].skip;)i--;return i%=t,{start:s,end:i}}function Cie(e,t,r,n){const s=e.length,i=[];let o=t,l=e[t],c;for(c=t+1;c<=r;++c){const u=e[c%s];u.skip||u.stop?l.skip||(n=!1,i.push({start:t%s,end:(c-1)%s,loop:n}),t=o=u.stop?c:null):(o=c,l.skip&&(t=c)),l=u}return o!==null&&i.push({start:t%s,end:o%s,loop:n}),i}function $ie(e,t){const r=e.points,n=e.options.spanGaps,s=r.length;if(!s)return[];const i=!!e._loop,{start:o,end:l}=Sie(r,s,i,n);if(n===!0)return V5(e,[{start:o,end:l,loop:i}],r,t);const c=l<o?l+s:l,u=!!e._fullLoop&&o===0&&l===s-1;return V5(e,Cie(r,o,c,u),r,t)}function V5(e,t,r,n){return!n||!n.setContext||!r?t:Tie(e,t,r,n)}function Tie(e,t,r,n){const s=e._chart.getContext(),i=H5(e.options),{_datasetIndex:o,options:{spanGaps:l}}=e,c=r.length,u=[];let h=i,f=t[0].start,m=f;function g(v,x,y,_){const b=l?-1:1;if(v!==x){for(v+=c;r[v%c].skip;)v-=b;for(;r[x%c].skip;)x+=b;v%c!==x%c&&(u.push({start:v%c,end:x%c,loop:y,style:_}),h=_,f=x%c)}}for(const v of t){f=l?f:v.start;let x=r[f%c],y;for(m=f+1;m<=v.end;m++){const _=r[m%c];y=H5(n.setContext(od(s,{type:"segment",p0:x,p1:_,p0DataIndex:(m-1)%c,p1DataIndex:m%c,datasetIndex:o}))),Eie(y,h)&&g(f,m-1,v.loop,h),x=_,h=y}f<m-1&&g(f,m-1,v.loop,h)}return u}function H5(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Eie(e,t){if(!t)return!1;const r=[],n=function(s,i){return Ik(i)?(r.includes(i)||r.push(i),r.indexOf(i)):i};return JSON.stringify(e,n)!==JSON.stringify(t,n)}function qm(e,t,r){return e.options.clip?e[r]:t[r]}function Aie(e,t){const{xScale:r,yScale:n}=e;return r&&n?{left:qm(r,t,"left"),right:qm(r,t,"right"),top:qm(n,t,"top"),bottom:qm(n,t,"bottom")}:t}function F6(e,t){const r=t._clip;if(r.disabled)return!1;const n=Aie(t,e.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?e.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?e.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Fie{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,n,s){const i=r.listeners[s],o=r.duration;i.forEach(l=>l({chart:t,initial:r.initial,numSteps:o,currentStep:Math.min(n-r.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=g6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let r=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const i=n.items;let o=i.length-1,l=!1,c;for(;o>=0;--o)c=i[o],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(t),l=!0):(i[o]=i[i.length-1],i.pop());l&&(s.draw(),this._notify(s,n,t,"progress")),i.length||(n.running=!1,this._notify(s,n,t,"complete"),n.initial=!1),r+=i.length}),this._lastDate=t,r===0&&(this._running=!1)}_getAnims(t){const r=this._charts;let n=r.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(t,n)),n}listen(t,r,n){this._getAnims(t).listeners[r].push(n)}add(t,r){!r||!r.length||this._getAnims(t).items.push(...r)}has(t){return this._getAnims(t).items.length>0}start(t){const r=this._charts.get(t);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const r=this._charts.get(t);return!(!r||!r.running||!r.items.length)}stop(t){const r=this._charts.get(t);if(!r||!r.items.length)return;const n=r.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Pi=new Fie;const W5="transparent",Pie={boolean(e,t,r){return r>.5?t:e},color(e,t,r){const n=M5(e||W5),s=n.valid&&M5(t||W5);return s&&s.valid?s.mix(n,r).hexString():t},number(e,t,r){return e+(t-e)*r}};class Die{constructor(t,r,n,s){const i=r[n];s=Wm([t.to,s,i,t.from]);const o=Wm([t.from,i,s]);this._active=!0,this._fn=t.fn||Pie[t.type||typeof o],this._easing=Zf[t.easing]||Zf.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=r,this._prop=n,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,r,n){if(this._active){this._notify(!1);const s=this._target[this._prop],i=n-this._start,o=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=i,this._loop=!!t.loop,this._to=Wm([t.to,r,s,t.from]),this._from=Wm([t.from,s,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const r=t-this._start,n=this._duration,s=this._prop,i=this._from,o=this._loop,l=this._to;let c;if(this._active=i!==l&&(o||r<n),!this._active){this._target[s]=l,this._notify(!0);return}if(r<0){this._target[s]=i;return}c=r/n%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(i,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((r,n)=>{t.push({res:r,rej:n})})}_notify(t){const r=t?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][r]()}}class P6{constructor(t,r){this._chart=t,this._properties=new Map,this.configure(r)}configure(t){if(!et(t))return;const r=Object.keys(sr.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const i=t[s];if(!et(i))return;const o={};for(const l of r)o[l]=i[l];(pr(i.properties)&&i.properties||[s]).forEach(l=>{(l===s||!n.has(l))&&n.set(l,o)})})}_animateOptions(t,r){const n=r.options,s=Oie(t,n);if(!s)return[];const i=this._createAnimations(s,n);return n.$shared&&Mie(t.options.$animations,n).then(()=>{t.options=n},()=>{}),i}_createAnimations(t,r){const n=this._properties,s=[],i=t.$animations||(t.$animations={}),o=Object.keys(r),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){s.push(...this._animateOptions(t,r));continue}const h=r[u];let f=i[u];const m=n.get(u);if(f)if(m&&f.active()){f.update(m,h,l);continue}else f.cancel();if(!m||!m.duration){t[u]=h;continue}i[u]=f=new Die(m,t,u,h),s.push(f)}return s}update(t,r){if(this._properties.size===0){Object.assign(t,r);return}const n=this._createAnimations(t,r);if(n.length)return Pi.add(this._chart,n),!0}}function Mie(e,t){const r=[],n=Object.keys(t);for(let s=0;s<n.length;s++){const i=e[n[s]];i&&i.active()&&r.push(i.wait())}return Promise.all(r)}function Oie(e,t){if(!t)return;let r=e.options;if(!r){e.options=t;return}return r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function G5(e,t){const r=e&&e.options||{},n=r.reverse,s=r.min===void 0?t:0,i=r.max===void 0?t:0;return{start:n?i:s,end:n?s:i}}function Rie(e,t,r){if(r===!1)return!1;const n=G5(e,r),s=G5(t,r);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function Iie(e){let t,r,n,s;return et(e)?(t=e.top,r=e.right,n=e.bottom,s=e.left):t=r=n=s=e,{top:t,right:r,bottom:n,left:s,disabled:e===!1}}function D6(e,t){const r=[],n=e._getSortedDatasetMetas(t);let s,i;for(s=0,i=n.length;s<i;++s)r.push(n[s].index);return r}function q5(e,t,r,n={}){const s=e.keys,i=n.mode==="single";let o,l,c,u;if(t===null)return;let h=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===r){if(h=!0,n.all)continue;break}u=e.values[c],pn(u)&&(i||t===0||hi(t)===hi(u))&&(t+=u)}return!h&&!n.all?0:t}function Nie(e,t){const{iScale:r,vScale:n}=t,s=r.axis==="x"?"x":"y",i=n.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,h;for(c=0,u=o.length;c<u;++c)h=o[c],l[c]={[s]:h,[i]:e[h]};return l}function qb(e,t){const r=e&&e.options.stacked;return r||r===void 0&&t.stack!==void 0}function Lie(e,t,r){return`${e.id}.${t.id}.${r.stack||r.type}`}function zie(e){const{min:t,max:r,minDefined:n,maxDefined:s}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:s?r:Number.POSITIVE_INFINITY}}function Bie(e,t,r){const n=e[t]||(e[t]={});return n[r]||(n[r]={})}function K5(e,t,r,n){for(const s of t.getMatchingVisibleMetas(n).reverse()){const i=e[s.index];if(r&&i>0||!r&&i<0)return s.index}return null}function X5(e,t){const{chart:r,_cachedMeta:n}=e,s=r._stacks||(r._stacks={}),{iScale:i,vScale:o,index:l}=n,c=i.axis,u=o.axis,h=Lie(i,o,n),f=t.length;let m;for(let g=0;g<f;++g){const v=t[g],{[c]:x,[u]:y}=v,_=v._stacks||(v._stacks={});m=_[u]=Bie(s,h,x),m[l]=y,m._top=K5(m,o,!0,n.type),m._bottom=K5(m,o,!1,n.type);const b=m._visualValues||(m._visualValues={});b[l]=y}}function Kb(e,t){const r=e.scales;return Object.keys(r).filter(n=>r[n].axis===t).shift()}function Uie(e,t){return od(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Vie(e,t,r){return od(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function Uh(e,t){const r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const s of t){const i=s._stacks;if(!i||i[n]===void 0||i[n][r]===void 0)return;delete i[n][r],i[n]._visualValues!==void 0&&i[n]._visualValues[r]!==void 0&&delete i[n]._visualValues[r]}}}const Xb=e=>e==="reset"||e==="none",Y5=(e,t)=>t?e:Object.assign({},e),Hie=(e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:D6(r,!0),values:null};class Oc{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=qb(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Uh(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,n=this.getDataset(),s=(f,m,g,v)=>f==="x"?m:f==="r"?v:g,i=r.xAxisID=Ye(n.xAxisID,Kb(t,"x")),o=r.yAxisID=Ye(n.yAxisID,Kb(t,"y")),l=r.rAxisID=Ye(n.rAxisID,Kb(t,"r")),c=r.indexAxis,u=r.iAxisID=s(c,i,o,l),h=r.vAxisID=s(c,o,i,l);r.xScale=this.getScaleForId(i),r.yScale=this.getScaleForId(o),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&F5(this._data,this),t._stacked&&Uh(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),n=this._data;if(et(r)){const s=this._cachedMeta;this._data=Nie(r,s)}else if(n!==r){if(n){F5(n,this);const s=this._cachedMeta;Uh(s),s._parsed=[]}r&&Object.isExtensible(r)&&Cae(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const i=r._stacked;r._stacked=qb(r.vScale,r),r.stack!==n.stack&&(s=!0,Uh(r),r.stack=n.stack),this._resyncElements(t),(s||i!==r._stacked)&&(X5(this,r._parsed),r._stacked=qb(r.vScale,r))}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:n,_data:s}=this,{iScale:i,_stacked:o}=n,l=i.axis;let c=t===0&&r===s.length?!0:n._sorted,u=t>0&&n._parsed[t-1],h,f,m;if(this._parsing===!1)n._parsed=s,n._sorted=!0,m=s;else{pr(s[t])?m=this.parseArrayData(n,s,t,r):et(s[t])?m=this.parseObjectData(n,s,t,r):m=this.parsePrimitiveData(n,s,t,r);const g=()=>f[l]===null||u&&f[l]<u[l];for(h=0;h<r;++h)n._parsed[h+t]=f=m[h],c&&(g()&&(c=!1),u=f);n._sorted=c}o&&X5(this,m)}parsePrimitiveData(t,r,n,s){const{iScale:i,vScale:o}=t,l=i.axis,c=o.axis,u=i.getLabels(),h=i===o,f=new Array(s);let m,g,v;for(m=0,g=s;m<g;++m)v=m+n,f[m]={[l]:h||i.parse(u[v],v),[c]:o.parse(r[v],v)};return f}parseArrayData(t,r,n,s){const{xScale:i,yScale:o}=t,l=new Array(s);let c,u,h,f;for(c=0,u=s;c<u;++c)h=c+n,f=r[h],l[c]={x:i.parse(f[0],h),y:o.parse(f[1],h)};return l}parseObjectData(t,r,n,s){const{xScale:i,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(s);let h,f,m,g;for(h=0,f=s;h<f;++h)m=h+n,g=r[m],u[h]={x:i.parse(Yc(g,l),m),y:o.parse(Yc(g,c),m)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,n){const s=this.chart,i=this._cachedMeta,o=r[t.axis],l={keys:D6(s,!0),values:r._stacks[t.axis]._visualValues};return q5(l,o,i.index,{mode:n})}updateRangeFromParsed(t,r,n,s){const i=n[r.axis];let o=i===null?NaN:i;const l=s&&n._stacks[r.axis];s&&l&&(s.values=l,o=q5(s,i,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,r){const n=this._cachedMeta,s=n._parsed,i=n._sorted&&t===n.iScale,o=s.length,l=this._getOtherScale(t),c=Hie(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=zie(l);let m,g;function v(){g=s[m];const x=g[l.axis];return!pn(g[t.axis])||h>x||f<x}for(m=0;m<o&&!(!v()&&(this.updateRangeFromParsed(u,t,g,c),i));++m);if(i){for(m=o-1;m>=0;--m)if(!v()){this.updateRangeFromParsed(u,t,g,c);break}}return u}getAllParsedValues(t){const r=this._cachedMeta._parsed,n=[];let s,i,o;for(s=0,i=r.length;s<i;++s)o=r[s][t.axis],pn(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,n=r.iScale,s=r.vScale,i=this.getParsed(t);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=Iie(Ye(this.options.clip,Rie(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,r=this.chart,n=this._cachedMeta,s=n.data||[],i=r.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,u=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(t,i,l,c),h=l;h<l+c;++h){const f=s[h];f.hidden||(f.active&&u?o.push(f):f.draw(t,i))}for(h=0;h<o.length;++h)o[h].draw(t,i)}getStyle(t,r){const n=r?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,r,n){const s=this.getDataset();let i;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];i=o.$context||(o.$context=Vie(this.getContext(),t,o)),i.parsed=this.getParsed(t),i.raw=s.data[t],i.index=i.dataIndex=t}else i=this.$context||(this.$context=Uie(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!r,i.mode=n,i}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",n){const s=r==="active",i=this._cachedDataOpts,o=t+"-"+r,l=i[o],c=this.enableOptionSharing&&I0(n);if(l)return Y5(l,c);const u=this.chart.config,h=u.datasetElementScopeKeys(this._type,t),f=s?[`${t}Hover`,"hover",t,""]:[t,""],m=u.getOptionScopes(this.getDataset(),h),g=Object.keys(sr.elements[t]),v=()=>this.getContext(n,s,r),x=u.resolveNamedOptions(m,g,v,f);return x.$shared&&(x.$shared=c,i[o]=Object.freeze(Y5(x,c))),x}_resolveAnimations(t,r,n){const s=this.chart,i=this._cachedDataOpts,o=`animation-${r}`,l=i[o];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,r),m=h.getOptionScopes(this.getDataset(),f);c=h.createResolver(m,this.getContext(t,n,r))}const u=new P6(s,c&&c.animations);return c&&c._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||Xb(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const n=this.resolveDataElementOptions(t,r),s=this._sharedOptions,i=this.getSharedOptions(n),o=this.includeOptions(r,i)||i!==s;return this.updateSharedOptions(i,r,n),{sharedOptions:i,includeOptions:o}}updateElement(t,r,n,s){Xb(s)?Object.assign(t,n):this._resolveAnimations(r,s).update(t,n)}updateSharedOptions(t,r,n){t&&!Xb(r)&&this._resolveAnimations(void 0,r).update(t,n)}_setStyle(t,r,n,s){t.active=s;const i=this.getStyle(r,s);this._resolveAnimations(r,n,s).update(t,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(t,r,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,r,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,n=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const s=n.length,i=r.length,o=Math.min(i,s);o&&this.parse(0,o),i>s?this._insertElements(s,i-s,t):i<s&&this._removeElements(i,s-i)}_insertElements(t,r,n=!0){const s=this._cachedMeta,i=s.data,o=t+r;let l;const c=u=>{for(u.length+=r,l=u.length-1;l>=o;l--)u[l]=u[l-r]};for(c(i),l=t;l<o;++l)i[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(t,r),n&&this.updateElements(i,t,r,"reset")}updateElements(t,r,n,s){}_removeElements(t,r){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(t,r);n._stacked&&Uh(n,s)}n.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,n,s]=t;this[r](n,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Fe(Oc,"defaults",{}),Fe(Oc,"datasetElementType",null),Fe(Oc,"dataElementType",null);function Wie(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let n=[];for(let s=0,i=r.length;s<i;s++)n=n.concat(r[s].controller.getAllParsedValues(e));e._cache.$bar=m6(n.sort((s,i)=>s-i))}return e._cache.$bar}function Gie(e){const t=e.iScale,r=Wie(t,e.type);let n=t._length,s,i,o,l;const c=()=>{o===32767||o===-32768||(I0(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(s=0,i=r.length;s<i;++s)o=t.getPixelForValue(r[s]),c();for(l=void 0,s=0,i=t.ticks.length;s<i;++s)o=t.getPixelForTick(s),c();return n}function qie(e,t,r,n){const s=r.barThickness;let i,o;return xt(s)?(i=t.min*r.categoryPercentage,o=r.barPercentage):(i=s*n,o=1),{chunk:i/n,ratio:o,start:t.pixels[e]-i/2}}function Kie(e,t,r,n){const s=t.pixels,i=s[e];let o=e>0?s[e-1]:null,l=e<s.length-1?s[e+1]:null;const c=r.categoryPercentage;o===null&&(o=i-(l===null?t.end-t.start:l-i)),l===null&&(l=i+i-o);const u=i-(i-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/n,ratio:r.barPercentage,start:u}}function Xie(e,t,r,n){const s=r.parse(e[0],n),i=r.parse(e[1],n),o=Math.min(s,i),l=Math.max(s,i);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[r.axis]=u,t._custom={barStart:c,barEnd:u,start:s,end:i,min:o,max:l}}function M6(e,t,r,n){return pr(e)?Xie(e,t,r,n):t[r.axis]=r.parse(e,n),t}function Q5(e,t,r,n){const s=e.iScale,i=e.vScale,o=s.getLabels(),l=s===i,c=[];let u,h,f,m;for(u=r,h=r+n;u<h;++u)m=t[u],f={},f[s.axis]=l||s.parse(o[u],u),c.push(M6(m,f,i,u));return c}function Yb(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Yie(e,t,r){return e!==0?hi(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}function Qie(e){let t,r,n,s,i;return e.horizontal?(t=e.base>e.x,r="left",n="right"):(t=e.base<e.y,r="bottom",n="top"),t?(s="end",i="start"):(s="start",i="end"),{start:r,end:n,reverse:t,top:s,bottom:i}}function Jie(e,t,r,n){let s=t.borderSkipped;const i={};if(!s){e.borderSkipped=i;return}if(s===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:h}=Qie(e);s==="middle"&&r&&(e.enableBorderRadius=!0,(r._top||0)===n?s=u:(r._bottom||0)===n?s=h:(i[J5(h,o,l,c)]=!0,s=u)),i[J5(s,o,l,c)]=!0,e.borderSkipped=i}function J5(e,t,r,n){return n?(e=Zie(e,t,r),e=Z5(e,r,t)):e=Z5(e,t,r),e}function Zie(e,t,r){return e===t?r:e===r?t:e}function Z5(e,t,r){return e==="start"?t:e==="end"?r:e}function eoe(e,{inflateAmount:t},r){e.inflateAmount=t==="auto"?r===1?.33:0:t}class rx extends Oc{parsePrimitiveData(t,r,n,s){return Q5(t,r,n,s)}parseArrayData(t,r,n,s){return Q5(t,r,n,s)}parseObjectData(t,r,n,s){const{iScale:i,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=i.axis==="x"?l:c,h=o.axis==="x"?l:c,f=[];let m,g,v,x;for(m=n,g=n+s;m<g;++m)x=r[m],v={},v[i.axis]=i.parse(Yc(x,u),m),f.push(M6(Yc(x,h),v,o,m));return f}updateRangeFromParsed(t,r,n,s){super.updateRangeFromParsed(t,r,n,s);const i=n._custom;i&&r===this._cachedMeta.vScale&&(t.min=Math.min(t.min,i.min),t.max=Math.max(t.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const r=this._cachedMeta,{iScale:n,vScale:s}=r,i=this.getParsed(t),o=i._custom,l=Yb(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(i[s.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,t)}updateElements(t,r,n,s){const i=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),h=this._getRuler(),{sharedOptions:f,includeOptions:m}=this._getSharedOptions(r,s);for(let g=r;g<r+n;g++){const v=this.getParsed(g),x=i||xt(v[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(g),y=this._calculateBarIndexPixels(g,h),_=(v._stacks||{})[l.axis],b={horizontal:u,base:x.base,enableBorderRadius:!_||Yb(v._custom)||o===_._top||o===_._bottom,x:u?x.head:y.center,y:u?y.center:x.head,height:u?y.size:Math.abs(x.size),width:u?Math.abs(x.size):y.size};m&&(b.options=f||this.resolveDataElementOptions(g,t[g].active?"active":s));const w=b.options||t[g].options;Jie(b,w,_,o),eoe(b,w,h.ratio),this.updateElement(t[g],g,b,s)}}_getStacks(t,r){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),i=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(r),c=l&&l[n.axis],u=h=>{const f=h._parsed.find(g=>g[n.axis]===c),m=f&&f[h.vScale.axis];if(xt(m)||isNaN(m))return!0};for(const h of s)if(!(r!==void 0&&u(h))&&((i===!1||o.indexOf(h.stack)===-1||i===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===r).shift()}_getAxis(){const t={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[Ye(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(t)}_getStackIndex(t,r,n){const s=this._getStacks(t,n),i=r!==void 0?s.indexOf(r):-1;return i===-1?s.length-1:i}_getRuler(){const t=this.options,r=this._cachedMeta,n=r.iScale,s=[];let i,o;for(i=0,o=r.data.length;i<o;++i)s.push(n.getPixelForValue(this.getParsed(i)[n.axis],i));const l=t.barThickness;return{min:l||Gie(r),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:r,_stacked:n,index:s},options:{base:i,minBarLength:o}}=this,l=i||0,c=this.getParsed(t),u=c._custom,h=Yb(u);let f=c[r.axis],m=0,g=n?this.applyStack(r,c,n):f,v,x;g!==f&&(m=g-f,g=f),h&&(f=u.barStart,g=u.barEnd-u.barStart,f!==0&&hi(f)!==hi(u.barEnd)&&(m=0),m+=f);const y=!xt(i)&&!h?i:m;let _=r.getPixelForValue(y);if(this.chart.getDataVisibility(t)?v=r.getPixelForValue(m+g):v=_,x=v-_,Math.abs(x)<o){x=Yie(x,r,l)*o,f===l&&(_-=x/2);const b=r.getPixelForDecimal(0),w=r.getPixelForDecimal(1),C=Math.min(b,w),j=Math.max(b,w);_=Math.max(Math.min(_,j),C),v=_+x,n&&!h&&(c._stacks[r.axis]._visualValues[s]=r.getValueForPixel(v)-r.getValueForPixel(_))}if(_===r.getPixelForValue(l)){const b=hi(x)*r.getLineWidthForValue(l)/2;_+=b,x-=b}return{size:x,base:_,head:v,center:v+x/2}}_calculateBarIndexPixels(t,r){const n=r.scale,s=this.options,i=s.skipNull,o=Ye(s.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(r.grouped){const h=i?this._getStackCount(t):r.stackCount,f=s.barThickness==="flex"?Kie(t,r,s,h*u):qie(t,r,s,h*u),m=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(Ye(m,this.getFirstScaleIdForIndexAxis())),v=this._getStackIndex(this.index,this._cachedMeta.stack,i?t:void 0)+g;l=f.start+f.chunk*v+f.chunk/2,c=Math.min(o,f.chunk*f.ratio)}else l=n.getPixelForValue(this.getParsed(t)[n.axis],t),c=Math.min(o,r.min*r.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,r=t.vScale,n=t.data,s=n.length;let i=0;for(;i<s;++i)this.getParsed(i)[r.axis]!==null&&!n[i].hidden&&n[i].draw(this._ctx)}}Fe(rx,"id","bar"),Fe(rx,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Fe(rx,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function toe(e,t,r){let n=1,s=1,i=0,o=0;if(t<Wt){const l=e,c=l+t,u=Math.cos(l),h=Math.sin(l),f=Math.cos(c),m=Math.sin(c),g=(w,C,j)=>L0(w,l,c,!0)?1:Math.max(C,C*r,j,j*r),v=(w,C,j)=>L0(w,l,c,!0)?-1:Math.min(C,C*r,j,j*r),x=g(0,u,f),y=g(wr,h,m),_=v(jt,u,f),b=v(jt+wr,h,m);n=(x-_)/2,s=(y-b)/2,i=-(x+_)/2,o=-(y+b)/2}return{ratioX:n,ratioY:s,offsetX:i,offsetY:o}}class qd extends Oc{constructor(t,r){super(t,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,r){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let i=c=>+n[c];if(et(n[t])){const{key:c="value"}=this._parsing;i=u=>+Yc(n[u],c)}let o,l;for(o=t,l=t+r;o<l;++o)s._parsed[o]=i(o)}}_getRotation(){return Gi(this.options.rotation-90)}_getCircumference(){return Gi(this.options.circumference)}_getRotationExtents(){let t=Wt,r=-Wt;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,i=s._getRotation(),o=s._getCircumference();t=Math.min(t,i),r=Math.max(r,i+o)}return{rotation:t,circumference:r-t}}update(t){const r=this.chart,{chartArea:n}=r,s=this._cachedMeta,i=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),c=Math.min(cae(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:h,rotation:f}=this._getRotationExtents(),{ratioX:m,ratioY:g,offsetX:v,offsetY:x}=toe(f,h,c),y=(n.width-o)/m,_=(n.height-o)/g,b=Math.max(Math.min(y,_)/2,0),w=d6(this.options.radius,b),C=Math.max(w*c,0),j=(w-C)/this._getVisibleDatasetWeightTotal();this.offsetX=v*w,this.offsetY=x*w,s.total=this.calculateTotal(),this.outerRadius=w-j*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-j*u,0),this.updateElements(i,0,i.length,t)}_circumference(t,r){const n=this.options,s=this._cachedMeta,i=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*i/Wt)}updateElements(t,r,n,s){const i=s==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,h=(l.left+l.right)/2,f=(l.top+l.bottom)/2,m=i&&u.animateScale,g=m?0:this.innerRadius,v=m?0:this.outerRadius,{sharedOptions:x,includeOptions:y}=this._getSharedOptions(r,s);let _=this._getRotation(),b;for(b=0;b<r;++b)_+=this._circumference(b,i);for(b=r;b<r+n;++b){const w=this._circumference(b,i),C=t[b],j={x:h+this.offsetX,y:f+this.offsetY,startAngle:_,endAngle:_+w,circumference:w,outerRadius:v,innerRadius:g};y&&(j.options=x||this.resolveDataElementOptions(b,C.active?"active":s)),_+=w,this.updateElement(C,b,j,s)}}calculateTotal(){const t=this._cachedMeta,r=t.data;let n=0,s;for(s=0;s<r.length;s++){const i=t._parsed[s];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(s)&&!r[s].hidden&&(n+=Math.abs(i))}return n}calculateCircumference(t){const r=this._cachedMeta.total;return r>0&&!isNaN(t)?Wt*(Math.abs(t)/r):0}getLabelAndValue(t){const r=this._cachedMeta,n=this.chart,s=n.data.labels||[],i=Nk(r._parsed[t],n.options.locale);return{label:s[t]||"",value:i}}getMaxBorderWidth(t){let r=0;const n=this.chart;let s,i,o,l,c;if(!t){for(s=0,i=n.data.datasets.length;s<i;++s)if(n.isDatasetVisible(s)){o=n.getDatasetMeta(s),t=o.data,l=o.controller;break}}if(!t)return 0;for(s=0,i=t.length;s<i;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(t){let r=0;for(let n=0,s=t.length;n<s;++n){const i=this.resolveDataElementOptions(n);r=Math.max(r,i.offset||0,i.hoverOffset||0)}return r}_getRingWeightOffset(t){let r=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(t){return Math.max(Ye(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Fe(qd,"id","doughnut"),Fe(qd,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Fe(qd,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Fe(qd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data,{labels:{pointStyle:n,textAlign:s,color:i,useBorderRadius:o,borderRadius:l}}=t.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,u)=>{const f=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:f.backgroundColor,fontColor:i,hidden:!t.getDataVisibility(u),lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:f.borderWidth,strokeStyle:f.borderColor,textAlign:s,pointStyle:n,borderRadius:o&&(l||f.borderRadius),index:u}}):[]}},onClick(t,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}});class nx extends Oc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const r=this._cachedMeta,{dataset:n,data:s=[],_dataset:i}=r,o=this.chart._animationsDisabled;let{start:l,count:c}=Eae(r,s,o);this._drawStart=l,this._drawCount=c,Aae(r)&&(l=0,c=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=s;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:u},t),this.updateElements(s,l,c,t)}updateElements(t,r,n,s){const i=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:f}=this._getSharedOptions(r,s),m=o.axis,g=l.axis,{spanGaps:v,segment:x}=this.options,y=N0(v)?v:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||i||s==="none",b=r+n,w=t.length;let C=r>0&&this.getParsed(r-1);for(let j=0;j<w;++j){const T=t[j],k=_?T:{};if(j<r||j>=b){k.skip=!0;continue}const M=this.getParsed(j),A=xt(M[g]),O=k[m]=o.getPixelForValue(M[m],j),F=k[g]=i||A?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,M,c):M[g],j);k.skip=isNaN(O)||isNaN(F)||A,k.stop=j>0&&Math.abs(M[m]-C[m])>y,x&&(k.parsed=M,k.raw=u.data[j]),f&&(k.options=h||this.resolveDataElementOptions(j,T.active?"active":s)),_||this.updateElement(T,j,k,s),C=M}}getMaxOverflow(){const t=this._cachedMeta,r=t.dataset,n=r.options&&r.options.borderWidth||0,s=t.data||[];if(!s.length)return n;const i=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,i,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Fe(nx,"id","line"),Fe(nx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Fe(nx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class k2 extends qd{}Fe(k2,"id","pie"),Fe(k2,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Gl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Wk{constructor(t){Fe(this,"options");this.options=t||{}}static override(t){Object.assign(Wk.prototype,t)}init(){}formats(){return Gl()}parse(){return Gl()}format(){return Gl()}add(){return Gl()}diff(){return Gl()}startOf(){return Gl()}endOf(){return Gl()}}var roe={_date:Wk};function noe(e,t,r,n){const{controller:s,data:i,_sorted:o}=e,l=s._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&i.length){const u=l._reversePixels?kae:mc;if(n){if(s._sharedOptions){const h=i[0],f=typeof h.getRange=="function"&&h.getRange(t);if(f){const m=u(i,t,r-f),g=u(i,t,r+f);return{lo:m.lo,hi:g.hi}}}}else{const h=u(i,t,r);if(c){const{vScale:f}=s._cachedMeta,{_parsed:m}=e,g=m.slice(0,h.lo+1).reverse().findIndex(x=>!xt(x[f.axis]));h.lo-=Math.max(0,g);const v=m.slice(h.hi).findIndex(x=>!xt(x[f.axis]));h.hi+=Math.max(0,v)}return h}}return{lo:0,hi:i.length-1}}function G1(e,t,r,n,s){const i=e.getSortedVisibleDatasetMetas(),o=r[t];for(let l=0,c=i.length;l<c;++l){const{index:u,data:h}=i[l],{lo:f,hi:m}=noe(i[l],t,o,s);for(let g=f;g<=m;++g){const v=h[g];v.skip||n(v,u,g)}}}function soe(e){const t=e.indexOf("x")!==-1,r=e.indexOf("y")!==-1;return function(n,s){const i=t?Math.abs(n.x-s.x):0,o=r?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Qb(e,t,r,n,s){const i=[];return!s&&!e.isPointInArea(t)||G1(e,r,t,function(l,c,u){!s&&!z0(l,e.chartArea,0)||l.inRange(t.x,t.y,n)&&i.push({element:l,datasetIndex:c,index:u})},!0),i}function aoe(e,t,r,n){let s=[];function i(o,l,c){const{startAngle:u,endAngle:h}=o.getProps(["startAngle","endAngle"],n),{angle:f}=f6(o,{x:t.x,y:t.y});L0(f,u,h)&&s.push({element:o,datasetIndex:l,index:c})}return G1(e,r,t,i),s}function ioe(e,t,r,n,s,i){let o=[];const l=soe(r);let c=Number.POSITIVE_INFINITY;function u(h,f,m){const g=h.inRange(t.x,t.y,s);if(n&&!g)return;const v=h.getCenterPoint(s);if(!(!!i||e.isPointInArea(v))&&!g)return;const y=l(t,v);y<c?(o=[{element:h,datasetIndex:f,index:m}],c=y):y===c&&o.push({element:h,datasetIndex:f,index:m})}return G1(e,r,t,u),o}function Jb(e,t,r,n,s,i){return!i&&!e.isPointInArea(t)?[]:r==="r"&&!n?aoe(e,t,r,s):ioe(e,t,r,n,s,i)}function e4(e,t,r,n,s){const i=[],o=r==="x"?"inXRange":"inYRange";let l=!1;return G1(e,r,t,(c,u,h)=>{c[o]&&c[o](t[r],s)&&(i.push({element:c,datasetIndex:u,index:h}),l=l||c.inRange(t.x,t.y,s))}),n&&!l?[]:i}var ooe={modes:{index(e,t,r,n){const s=ac(t,e),i=r.axis||"x",o=r.includeInvisible||!1,l=r.intersect?Qb(e,s,i,n,o):Jb(e,s,i,!1,n,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const h=l[0].index,f=u.data[h];f&&!f.skip&&c.push({element:f,datasetIndex:u.index,index:h})}),c):[]},dataset(e,t,r,n){const s=ac(t,e),i=r.axis||"xy",o=r.includeInvisible||!1;let l=r.intersect?Qb(e,s,i,n,o):Jb(e,s,i,!1,n,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let h=0;h<u.length;++h)l.push({element:u[h],datasetIndex:c,index:h})}return l},point(e,t,r,n){const s=ac(t,e),i=r.axis||"xy",o=r.includeInvisible||!1;return Qb(e,s,i,n,o)},nearest(e,t,r,n){const s=ac(t,e),i=r.axis||"xy",o=r.includeInvisible||!1;return Jb(e,s,i,r.intersect,n,o)},x(e,t,r,n){const s=ac(t,e);return e4(e,s,"x",r.intersect,n)},y(e,t,r,n){const s=ac(t,e);return e4(e,s,"y",r.intersect,n)}}};const O6=["left","top","right","bottom"];function Vh(e,t){return e.filter(r=>r.pos===t)}function t4(e,t){return e.filter(r=>O6.indexOf(r.pos)===-1&&r.box.axis===t)}function Hh(e,t){return e.sort((r,n)=>{const s=t?n:r,i=t?r:n;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function loe(e){const t=[];let r,n,s,i,o,l;for(r=0,n=(e||[]).length;r<n;++r)s=e[r],{position:i,options:{stack:o,stackWeight:l=1}}=s,t.push({index:r,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&i+o,stackWeight:l});return t}function coe(e){const t={};for(const r of e){const{stack:n,pos:s,stackWeight:i}=r;if(!n||!O6.includes(s))continue;const o=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}function doe(e,t){const r=coe(e),{vBoxMaxWidth:n,hBoxMaxHeight:s}=t;let i,o,l;for(i=0,o=e.length;i<o;++i){l=e[i];const{fullSize:c}=l.box,u=r[l.stack],h=u&&l.stackWeight/u.weight;l.horizontal?(l.width=h?h*n:c&&t.availableWidth,l.height=s):(l.width=n,l.height=h?h*s:c&&t.availableHeight)}return r}function uoe(e){const t=loe(e),r=Hh(t.filter(u=>u.box.fullSize),!0),n=Hh(Vh(t,"left"),!0),s=Hh(Vh(t,"right")),i=Hh(Vh(t,"top"),!0),o=Hh(Vh(t,"bottom")),l=t4(t,"x"),c=t4(t,"y");return{fullSize:r,leftAndTop:n.concat(i),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:Vh(t,"chartArea"),vertical:n.concat(s).concat(c),horizontal:i.concat(o).concat(l)}}function r4(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function R6(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function hoe(e,t,r,n){const{pos:s,box:i}=r,o=e.maxPadding;if(!et(s)){r.size&&(e[s]-=r.size);const f=n[r.stack]||{size:0,count:1};f.size=Math.max(f.size,r.horizontal?i.height:i.width),r.size=f.size/f.count,e[s]+=r.size}i.getPadding&&R6(o,i.getPadding());const l=Math.max(0,t.outerWidth-r4(o,e,"left","right")),c=Math.max(0,t.outerHeight-r4(o,e,"top","bottom")),u=l!==e.w,h=c!==e.h;return e.w=l,e.h=c,r.horizontal?{same:u,other:h}:{same:h,other:u}}function foe(e){const t=e.maxPadding;function r(n){const s=Math.max(t[n]-e[n],0);return e[n]+=s,s}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}function poe(e,t){const r=t.maxPadding;function n(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{i[o]=Math.max(t[o],r[o])}),i}return n(e?["left","right"]:["top","bottom"])}function Af(e,t,r,n){const s=[];let i,o,l,c,u,h;for(i=0,o=e.length,u=0;i<o;++i){l=e[i],c=l.box,c.update(l.width||t.w,l.height||t.h,poe(l.horizontal,t));const{same:f,other:m}=hoe(t,r,l,n);u|=f&&s.length,h=h||m,c.fullSize||s.push(l)}return u&&Af(s,t,r,n)||h}function Km(e,t,r,n,s){e.top=r,e.left=t,e.right=t+n,e.bottom=r+s,e.width=n,e.height=s}function n4(e,t,r,n){const s=r.padding;let{x:i,y:o}=t;for(const l of e){const c=l.box,u=n[l.stack]||{placed:0,weight:1},h=l.stackWeight/u.weight||1;if(l.horizontal){const f=t.w*h,m=u.size||c.height;I0(u.start)&&(o=u.start),c.fullSize?Km(c,s.left,o,r.outerWidth-s.right-s.left,m):Km(c,t.left+u.placed,o,f,m),u.start=o,u.placed+=f,o=c.bottom}else{const f=t.h*h,m=u.size||c.width;I0(u.start)&&(i=u.start),c.fullSize?Km(c,i,s.top,m,r.outerHeight-s.bottom-s.top):Km(c,i,t.top+u.placed,m,f),u.start=i,u.placed+=f,i=c.right}}t.x=i,t.y=o}var Ys={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;r!==-1&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,n){if(!e)return;const s=na(e.options.layout.padding),i=Math.max(t-s.width,0),o=Math.max(r-s.height,0),l=uoe(e.boxes),c=l.vertical,u=l.horizontal;wt(e.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const h=c.reduce((x,y)=>y.box.options&&y.box.options.display===!1?x:x+1,0)||1,f=Object.freeze({outerWidth:t,outerHeight:r,padding:s,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/h,hBoxMaxHeight:o/2}),m=Object.assign({},s);R6(m,na(n));const g=Object.assign({maxPadding:m,w:i,h:o,x:s.left,y:s.top},s),v=doe(c.concat(u),f);Af(l.fullSize,g,f,v),Af(c,g,f,v),Af(u,g,f,v)&&Af(c,g,f,v),foe(g),n4(l.leftAndTop,g,f,v),g.x+=g.w,g.y+=g.h,n4(l.rightAndBottom,g,f,v),e.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},wt(l.chartArea,x=>{const y=x.box;Object.assign(y,e.chartArea),y.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class I6{acquireContext(t,r){}releaseContext(t){return!1}addEventListener(t,r,n){}removeEventListener(t,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,r,n,s){return r=Math.max(0,r||t.width),n=n||t.height,{width:r,height:Math.max(0,s?Math.floor(r/s):n)}}isAttached(t){return!0}updateConfig(t){}}class moe extends I6{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const sx="$chartjs",goe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},s4=e=>e===null||e==="";function xoe(e,t){const r=e.style,n=e.getAttribute("height"),s=e.getAttribute("width");if(e[sx]={initial:{height:n,width:s,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",s4(s)){const i=B5(e,"width");i!==void 0&&(e.width=i)}if(s4(n))if(e.style.height==="")e.height=e.width/(t||2);else{const i=B5(e,"height");i!==void 0&&(e.height=i)}return e}const N6=yie?{passive:!0}:!1;function voe(e,t,r){e&&e.addEventListener(t,r,N6)}function yoe(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,N6)}function boe(e,t){const r=goe[e.type]||e.type,{x:n,y:s}=ac(e,t);return{type:r,chart:t,native:e,x:n!==void 0?n:null,y:s!==void 0?s:null}}function s1(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function _oe(e,t,r){const n=e.canvas,s=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||s1(l.addedNodes,n),o=o&&!s1(l.removedNodes,n);o&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}function woe(e,t,r){const n=e.canvas,s=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||s1(l.removedNodes,n),o=o&&!s1(l.addedNodes,n);o&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}const U0=new Map;let a4=0;function L6(){const e=window.devicePixelRatio;e!==a4&&(a4=e,U0.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function joe(e,t){U0.size||window.addEventListener("resize",L6),U0.set(e,t)}function koe(e){U0.delete(e),U0.size||window.removeEventListener("resize",L6)}function Soe(e,t,r){const n=e.canvas,s=n&&Hk(n);if(!s)return;const i=x6((l,c)=>{const u=s.clientWidth;r(l,c),u<s.clientWidth&&r()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,h=c.contentRect.height;u===0&&h===0||i(u,h)});return o.observe(s),joe(e,i),o}function Zb(e,t,r){r&&r.disconnect(),t==="resize"&&koe(e)}function Coe(e,t,r){const n=e.canvas,s=x6(i=>{e.ctx!==null&&r(boe(i,e))},e);return voe(n,t,s),s}class $oe extends I6{acquireContext(t,r){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(xoe(t,r),n):null}releaseContext(t){const r=t.canvas;if(!r[sx])return!1;const n=r[sx].initial;["height","width"].forEach(i=>{const o=n[i];xt(o)?r.removeAttribute(i):r.setAttribute(i,o)});const s=n.style||{};return Object.keys(s).forEach(i=>{r.style[i]=s[i]}),r.width=r.width,delete r[sx],!0}addEventListener(t,r,n){this.removeEventListener(t,r);const s=t.$proxies||(t.$proxies={}),o={attach:_oe,detach:woe,resize:Soe}[r]||Coe;s[r]=o(t,r,n)}removeEventListener(t,r){const n=t.$proxies||(t.$proxies={}),s=n[r];if(!s)return;({attach:Zb,detach:Zb,resize:Zb}[r]||yoe)(t,r,s),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,r,n,s){return vie(t,r,n,s)}isAttached(t){const r=t&&Hk(t);return!!(r&&r.isConnected)}}function Toe(e){return!Vk()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?moe:$oe}class Da{constructor(){Fe(this,"x");Fe(this,"y");Fe(this,"active",!1);Fe(this,"options");Fe(this,"$animations")}tooltipPosition(t){const{x:r,y:n}=this.getProps(["x","y"],t);return{x:r,y:n}}hasValue(){return N0(this.x)&&N0(this.y)}getProps(t,r){const n=this.$animations;if(!r||!n)return this;const s={};return t.forEach(i=>{s[i]=n[i]&&n[i].active()?n[i]._to:this[i]}),s}}Fe(Da,"defaults",{}),Fe(Da,"defaultRoutes");function Eoe(e,t){const r=e.options.ticks,n=Aoe(e),s=Math.min(r.maxTicksLimit||n,n),i=r.major.enabled?Poe(t):[],o=i.length,l=i[0],c=i[o-1],u=[];if(o>s)return Doe(t,u,i,o/s),u;const h=Foe(i,t,s);if(o>0){let f,m;const g=o>1?Math.round((c-l)/(o-1)):null;for(Xm(t,u,h,xt(g)?0:l-g,l),f=0,m=o-1;f<m;f++)Xm(t,u,h,i[f],i[f+1]);return Xm(t,u,h,c,xt(g)?t.length:c+g),u}return Xm(t,u,h),u}function Aoe(e){const t=e.options.offset,r=e._tickSize(),n=e._length/r+(t?0:1),s=e._maxLength/r;return Math.floor(Math.min(n,s))}function Foe(e,t,r){const n=Moe(e),s=t.length/r;if(!n)return Math.max(s,1);const i=xae(n);for(let o=0,l=i.length-1;o<l;o++){const c=i[o];if(c>s)return c}return Math.max(s,1)}function Poe(e){const t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}function Doe(e,t,r,n){let s=0,i=r[0],o;for(n=Math.ceil(n),o=0;o<e.length;o++)o===i&&(t.push(e[o]),s++,i=r[s*n])}function Xm(e,t,r,n,s){const i=Ye(n,0),o=Math.min(Ye(s,e.length),e.length);let l=0,c,u,h;for(r=Math.ceil(r),s&&(c=s-n,r=c/Math.floor(c/r)),h=i;h<0;)l++,h=Math.round(i+l*r);for(u=Math.max(i,0);u<o;u++)u===h&&(t.push(e[u]),l++,h=Math.round(i+l*r))}function Moe(e){const t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}const Ooe=e=>e==="left"?"right":e==="right"?"left":e,i4=(e,t,r)=>t==="top"||t==="left"?e[t]+r:e[t]-r,o4=(e,t)=>Math.min(t||e,e);function l4(e,t){const r=[],n=e.length/t,s=e.length;let i=0;for(;i<s;i+=n)r.push(e[Math.floor(i)]);return r}function Roe(e,t,r){const n=e.ticks.length,s=Math.min(t,n-1),i=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(s),u;if(!(r&&(n===1?u=Math.max(c-i,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(s-1))/2,c+=s<t?u:-u,c<i-l||c>o+l)))return c}function Ioe(e,t){wt(e,r=>{const n=r.gc,s=n.length/2;let i;if(s>t){for(i=0;i<s;++i)delete r.data[n[i]];n.splice(0,s)}})}function Wh(e){return e.drawTicks?e.tickLength:0}function c4(e,t){if(!e.display)return 0;const r=cn(e.font,t),n=na(e.padding);return(pr(e.text)?e.text.length:1)*r.lineHeight+n.height}function Noe(e,t){return od(e,{scale:t,type:"scale"})}function Loe(e,t,r){return od(e,{tick:r,index:t,type:"tick"})}function zoe(e,t,r){let n=Rk(e);return(r&&t!=="right"||!r&&t==="right")&&(n=Ooe(n)),n}function Boe(e,t,r,n){const{top:s,left:i,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:h}=c;let f=0,m,g,v;const x=o-s,y=l-i;if(e.isHorizontal()){if(g=Zr(n,i,l),et(r)){const _=Object.keys(r)[0],b=r[_];v=h[_].getPixelForValue(b)+x-t}else r==="center"?v=(u.bottom+u.top)/2+x-t:v=i4(e,r,t);m=l-i}else{if(et(r)){const _=Object.keys(r)[0],b=r[_];g=h[_].getPixelForValue(b)-y+t}else r==="center"?g=(u.left+u.right)/2-y+t:g=i4(e,r,t);v=Zr(n,o,s),f=r==="left"?-wr:wr}return{titleX:g,titleY:v,maxWidth:m,rotation:f}}class Xu extends Da{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:n,_suggestedMax:s}=this;return t=Xa(t,Number.POSITIVE_INFINITY),r=Xa(r,Number.NEGATIVE_INFINITY),n=Xa(n,Number.POSITIVE_INFINITY),s=Xa(s,Number.NEGATIVE_INFINITY),{min:Xa(t,n),max:Xa(r,s),minDefined:pn(t),maxDefined:pn(r)}}getMinMax(t){let{min:r,max:n,minDefined:s,maxDefined:i}=this.getUserBounds(),o;if(s&&i)return{min:r,max:n};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),s||(r=Math.min(r,o.min)),i||(n=Math.max(n,o.max));return r=i&&r>n?n:r,n=s&&r>n?r:n,{min:Xa(r,Xa(n,r)),max:Xa(n,Xa(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Dt(this.options.beforeUpdate,[this])}update(t,r,n){const{beginAtZero:s,grace:i,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Yae(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?l4(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Eoe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,t=!t),this._startPixel=r,this._endPixel=n,this._reversePixels=t,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Dt(this.options.afterUpdate,[this])}beforeSetDimensions(){Dt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Dt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Dt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Dt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let n,s,i;for(n=0,s=t.length;n<s;n++)i=t[n],i.label=Dt(r.callback,[i.value,n,t],this)}afterTickToLabelConversion(){Dt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Dt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,n=o4(this.ticks.length,t.ticks.maxTicksLimit),s=r.minRotation||0,i=r.maxRotation;let o=s,l,c,u;if(!this._isVisible()||!r.display||s>=i||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),f=h.widest.width,m=h.highest.height,g=ln(this.chart.width-f,0,this.maxWidth);l=t.offset?this.maxWidth/n:g/(n-1),f+6>l&&(l=g/(n-(t.offset?.5:1)),c=this.maxHeight-Wh(t.grid)-r.padding-c4(t.title,this.chart.options.font),u=Math.sqrt(f*f+m*m),o=_ae(Math.min(Math.asin(ln((h.highest.height+6)/l,-1,1)),Math.asin(ln(c/u,-1,1))-Math.asin(ln(m/u,-1,1)))),o=Math.max(s,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Dt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Dt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:n,title:s,grid:i}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=c4(s,r.options.font);if(l?(t.width=this.maxWidth,t.height=Wh(i)+c):(t.height=this.maxHeight,t.width=Wh(i)+c),n.display&&this.ticks.length){const{first:u,last:h,widest:f,highest:m}=this._getLabelSizes(),g=n.padding*2,v=Gi(this.labelRotation),x=Math.cos(v),y=Math.sin(v);if(l){const _=n.mirror?0:y*f.width+x*m.height;t.height=Math.min(this.maxHeight,t.height+_+g)}else{const _=n.mirror?0:x*f.width+y*m.height;t.width=Math.min(this.maxWidth,t.width+_+g)}this._calculatePadding(u,h,y,x)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,n,s){const{ticks:{align:i,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,g=0;c?u?(m=s*t.width,g=n*r.height):(m=n*t.height,g=s*r.width):i==="start"?g=r.width:i==="end"?m=t.width:i!=="inner"&&(m=t.width/2,g=r.width/2),this.paddingLeft=Math.max((m-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-f+o)*this.width/(this.width-f),0)}else{let h=r.height/2,f=t.height/2;i==="start"?(h=0,f=t.height):i==="end"&&(h=r.height,f=0),this.paddingTop=h+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Dt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,n;for(r=0,n=t.length;r<n;r++)xt(t[r].label)&&(t.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=l4(n,r)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,n){const{ctx:s,_longestTextCache:i}=this,o=[],l=[],c=Math.floor(r/o4(r,n));let u=0,h=0,f,m,g,v,x,y,_,b,w,C,j;for(f=0;f<r;f+=c){if(v=t[f].label,x=this._resolveTickFontOptions(f),s.font=y=x.string,_=i[y]=i[y]||{data:{},gc:[]},b=x.lineHeight,w=C=0,!xt(v)&&!pr(v))w=R5(s,_.data,_.gc,w,v),C=b;else if(pr(v))for(m=0,g=v.length;m<g;++m)j=v[m],!xt(j)&&!pr(j)&&(w=R5(s,_.data,_.gc,w,j),C+=b);o.push(w),l.push(C),u=Math.max(w,u),h=Math.max(C,h)}Ioe(i,r);const T=o.indexOf(u),k=l.indexOf(h),M=A=>({width:o[A]||0,height:l[A]||0});return{first:M(0),last:M(r-1),widest:M(T),highest:M(k),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return jae(this._alignToPixels?Wl(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const n=r[t];return n.$context||(n.$context=Loe(this.getContext(),t,n))}return this.$context||(this.$context=Noe(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=Gi(this.labelRotation),n=Math.abs(Math.cos(r)),s=Math.abs(Math.sin(r)),i=this._getLabelSizes(),o=t.autoSkipPadding||0,l=i?i.widest.width+o:0,c=i?i.highest.height+o:0;return this.isHorizontal()?c*n>l*s?l/n:c/s:c*s<l*n?c/n:l/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,n=this.chart,s=this.options,{grid:i,position:o,border:l}=s,c=i.offset,u=this.isHorizontal(),f=this.ticks.length+(c?1:0),m=Wh(i),g=[],v=l.setContext(this.getContext()),x=v.display?v.width:0,y=x/2,_=function(Q){return Wl(n,Q,x)};let b,w,C,j,T,k,M,A,O,F,B,L;if(o==="top")b=_(this.bottom),k=this.bottom-m,A=b-y,F=_(t.top)+y,L=t.bottom;else if(o==="bottom")b=_(this.top),F=t.top,L=_(t.bottom)-y,k=b+y,A=this.top+m;else if(o==="left")b=_(this.right),T=this.right-m,M=b-y,O=_(t.left)+y,B=t.right;else if(o==="right")b=_(this.left),O=t.left,B=_(t.right)-y,T=b+y,M=this.left+m;else if(r==="x"){if(o==="center")b=_((t.top+t.bottom)/2+.5);else if(et(o)){const Q=Object.keys(o)[0],re=o[Q];b=_(this.chart.scales[Q].getPixelForValue(re))}F=t.top,L=t.bottom,k=b+y,A=k+m}else if(r==="y"){if(o==="center")b=_((t.left+t.right)/2);else if(et(o)){const Q=Object.keys(o)[0],re=o[Q];b=_(this.chart.scales[Q].getPixelForValue(re))}T=b-y,M=T-m,O=t.left,B=t.right}const U=Ye(s.ticks.maxTicksLimit,f),P=Math.max(1,Math.ceil(f/U));for(w=0;w<f;w+=P){const Q=this.getContext(w),re=i.setContext(Q),Z=l.setContext(Q),W=re.lineWidth,ce=re.color,te=Z.dash||[],D=Z.dashOffset,R=re.tickWidth,N=re.tickColor,H=re.tickBorderDash||[],ee=re.tickBorderDashOffset;C=Roe(this,w,c),C!==void 0&&(j=Wl(n,C,W),u?T=M=O=B=j:k=A=F=L=j,g.push({tx1:T,ty1:k,tx2:M,ty2:A,x1:O,y1:F,x2:B,y2:L,width:W,color:ce,borderDash:te,borderDashOffset:D,tickWidth:R,tickColor:N,tickBorderDash:H,tickBorderDashOffset:ee}))}return this._ticksLength=f,this._borderValue=b,g}_computeLabelItems(t){const r=this.axis,n=this.options,{position:s,ticks:i}=n,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:h,mirror:f}=i,m=Wh(n.grid),g=m+h,v=f?-h:g,x=-Gi(this.labelRotation),y=[];let _,b,w,C,j,T,k,M,A,O,F,B,L="middle";if(s==="top")T=this.bottom-v,k=this._getXAxisLabelAlignment();else if(s==="bottom")T=this.top+v,k=this._getXAxisLabelAlignment();else if(s==="left"){const P=this._getYAxisLabelAlignment(m);k=P.textAlign,j=P.x}else if(s==="right"){const P=this._getYAxisLabelAlignment(m);k=P.textAlign,j=P.x}else if(r==="x"){if(s==="center")T=(t.top+t.bottom)/2+g;else if(et(s)){const P=Object.keys(s)[0],Q=s[P];T=this.chart.scales[P].getPixelForValue(Q)+g}k=this._getXAxisLabelAlignment()}else if(r==="y"){if(s==="center")j=(t.left+t.right)/2-g;else if(et(s)){const P=Object.keys(s)[0],Q=s[P];j=this.chart.scales[P].getPixelForValue(Q)}k=this._getYAxisLabelAlignment(m).textAlign}r==="y"&&(c==="start"?L="top":c==="end"&&(L="bottom"));const U=this._getLabelSizes();for(_=0,b=l.length;_<b;++_){w=l[_],C=w.label;const P=i.setContext(this.getContext(_));M=this.getPixelForTick(_)+i.labelOffset,A=this._resolveTickFontOptions(_),O=A.lineHeight,F=pr(C)?C.length:1;const Q=F/2,re=P.color,Z=P.textStrokeColor,W=P.textStrokeWidth;let ce=k;o?(j=M,k==="inner"&&(_===b-1?ce=this.options.reverse?"left":"right":_===0?ce=this.options.reverse?"right":"left":ce="center"),s==="top"?u==="near"||x!==0?B=-F*O+O/2:u==="center"?B=-U.highest.height/2-Q*O+O:B=-U.highest.height+O/2:u==="near"||x!==0?B=O/2:u==="center"?B=U.highest.height/2-Q*O:B=U.highest.height-F*O,f&&(B*=-1),x!==0&&!P.showLabelBackdrop&&(j+=O/2*Math.sin(x))):(T=M,B=(1-F)*O/2);let te;if(P.showLabelBackdrop){const D=na(P.backdropPadding),R=U.heights[_],N=U.widths[_];let H=B-D.top,ee=0-D.left;switch(L){case"middle":H-=R/2;break;case"bottom":H-=R;break}switch(k){case"center":ee-=N/2;break;case"right":ee-=N;break;case"inner":_===b-1?ee-=N:_>0&&(ee-=N/2);break}te={left:ee,top:H,width:N+D.width,height:R+D.height,color:P.backdropColor}}y.push({label:C,font:A,textOffset:B,options:{rotation:x,color:re,strokeColor:Z,strokeWidth:W,textAlign:ce,textBaseline:L,translation:[j,T],backdrop:te}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-Gi(this.labelRotation))return t==="top"?"left":"right";let s="center";return r.align==="start"?s="left":r.align==="end"?s="right":r.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:n,mirror:s,padding:i}}=this.options,o=this._getLabelSizes(),l=t+i,c=o.widest.width;let u,h;return r==="left"?s?(h=this.right+i,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h+=c)):(h=this.right-l,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h=this.left)):r==="right"?s?(h=this.left+i,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h-=c)):(h=this.left+l,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h=this.right)):u="right",{textAlign:u,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:n,top:s,width:i,height:o}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(n,s,i,o),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const s=this.ticks.findIndex(i=>i.value===t);return s>=0?r.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const r=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let i,o;const l=(c,u,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(r.display)for(i=0,o=s.length;i<o;++i){const c=s[i];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:n,grid:s}}=this,i=n.setContext(this.getContext()),o=n.display?i.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,h,f,m;this.isHorizontal()?(u=Wl(t,this.left,o)-o/2,h=Wl(t,this.right,l)+l/2,f=m=c):(f=Wl(t,this.top,o)-o/2,m=Wl(t,this.bottom,l)+l/2,u=h=c),r.save(),r.lineWidth=i.width,r.strokeStyle=i.color,r.beginPath(),r.moveTo(u,f),r.lineTo(h,m),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&V1(n,s);const i=this.getLabelItems(t);for(const o of i){const l=o.options,c=o.font,u=o.label,h=o.textOffset;B0(n,u,0,h,c,l)}s&&H1(n)}drawTitle(){const{ctx:t,options:{position:r,title:n,reverse:s}}=this;if(!n.display)return;const i=cn(n.font),o=na(n.padding),l=n.align;let c=i.lineHeight/2;r==="bottom"||r==="center"||et(r)?(c+=o.bottom,pr(n.text)&&(c+=i.lineHeight*(n.text.length-1))):c+=o.top;const{titleX:u,titleY:h,maxWidth:f,rotation:m}=Boe(this,c,r,l);B0(t,n.text,0,0,i,{color:n.color,maxWidth:f,rotation:m,textAlign:zoe(l,r,s),textBaseline:"middle",translation:[u,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,n=Ye(t.grid&&t.grid.z,-1),s=Ye(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Xu.prototype.draw?[{z:r,draw:i=>{this.draw(i)}}]:[{z:n,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:r,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let i,o;for(i=0,o=r.length;i<o;++i){const l=r[i];l[n]===this.id&&(!t||l.type===t)&&s.push(l)}return s}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return cn(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ym{constructor(t,r,n){this.type=t,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const r=Object.getPrototypeOf(t);let n;Hoe(r)&&(n=this.register(r));const s=this.items,i=t.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+t);return i in s||(s[i]=t,Uoe(t,o,n),this.override&&sr.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const r=this.items,n=t.id,s=this.scope;n in r&&delete r[n],s&&n in sr[s]&&(delete sr[s][n],this.override&&delete Qc[n])}}function Uoe(e,t,r){const n=R0(Object.create(null),[r?sr.get(r):{},sr.get(t),e.defaults]);sr.set(t,n),e.defaultRoutes&&Voe(t,e.defaultRoutes),e.descriptors&&sr.describe(t,e.descriptors)}function Voe(e,t){Object.keys(t).forEach(r=>{const n=r.split("."),s=n.pop(),i=[e].concat(n).join("."),o=t[r].split("."),l=o.pop(),c=o.join(".");sr.route(i,s,c,l)})}function Hoe(e){return"id"in e&&"defaults"in e}class Woe{constructor(){this.controllers=new Ym(Oc,"datasets",!0),this.elements=new Ym(Da,"elements"),this.plugins=new Ym(Object,"plugins"),this.scales=new Ym(Xu,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,r,n){[...r].forEach(s=>{const i=n||this._getRegistryForType(s);n||i.isForType(s)||i===this.plugins&&s.id?this._exec(t,i,s):wt(s,o=>{const l=n||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,r,n){const s=Mk(t);Dt(n["before"+s],[],n),r[t](n),Dt(n["after"+s],[],n)}_getRegistryForType(t){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(t))return n}return this.plugins}_get(t,r,n){const s=r.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return s}}var ti=new Woe;class Goe{constructor(){this._init=void 0}notify(t,r,n,s){if(r==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const i=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(i,t,r,n);return r==="afterDestroy"&&(this._notify(i,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,r,n,s){s=s||{};for(const i of t){const o=i.plugin,l=o[n],c=[r,s,i.options];if(Dt(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){xt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),r}_createDescriptors(t,r){const n=t&&t.config,s=Ye(n.options&&n.options.plugins,{}),i=qoe(n);return s===!1&&!r?[]:Xoe(t,i,s,r)}_notifyStateChanges(t){const r=this._oldCache||[],n=this._cache,s=(i,o)=>i.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(r,n),t,"stop"),this._notify(s(n,r),t,"start")}}function qoe(e){const t={},r=[],n=Object.keys(ti.plugins.items);for(let i=0;i<n.length;i++)r.push(ti.getPlugin(n[i]));const s=e.plugins||[];for(let i=0;i<s.length;i++){const o=s[i];r.indexOf(o)===-1&&(r.push(o),t[o.id]=!0)}return{plugins:r,localIds:t}}function Koe(e,t){return!t&&e===!1?null:e===!0?{}:e}function Xoe(e,{plugins:t,localIds:r},n,s){const i=[],o=e.getContext();for(const l of t){const c=l.id,u=Koe(n[c],s);u!==null&&i.push({plugin:l,options:Yoe(e.config,{plugin:l,local:r[c]},u,o)})}return i}function Yoe(e,{plugin:t,local:r},n,s){const i=e.pluginScopeKeys(t),o=e.getOptionScopes(n,i);return r&&t.defaults&&o.push(t.defaults),e.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function S2(e,t){const r=sr.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function Qoe(e,t){let r=e;return e==="_index_"?r=t:e==="_value_"&&(r=t==="x"?"y":"x"),r}function Joe(e,t){return e===t?"_index_":"_value_"}function d4(e){if(e==="x"||e==="y"||e==="r")return e}function Zoe(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function C2(e,...t){if(d4(e))return e;for(const r of t){const n=r.axis||Zoe(r.position)||e.length>1&&d4(e[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function u4(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function ele(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(n=>n.xAxisID===e||n.yAxisID===e);if(r.length)return u4(e,"x",r[0])||u4(e,"y",r[0])}return{}}function tle(e,t){const r=Qc[e.type]||{scales:{}},n=t.scales||{},s=S2(e.type,t),i=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!et(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=C2(o,l,ele(o,e),sr.scales[l.type]),u=Joe(c,s),h=r.scales||{};i[o]=Qf(Object.create(null),[{axis:c},l,h[c],h[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||S2(l,t),h=(Qc[l]||{}).scales||{};Object.keys(h).forEach(f=>{const m=Qoe(f,c),g=o[m+"AxisID"]||m;i[g]=i[g]||Object.create(null),Qf(i[g],[{axis:m},n[g],h[f]])})}),Object.keys(i).forEach(o=>{const l=i[o];Qf(l,[sr.scales[l.type],sr.scale])}),i}function z6(e){const t=e.options||(e.options={});t.plugins=Ye(t.plugins,{}),t.scales=tle(e,t)}function B6(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function rle(e){return e=e||{},e.data=B6(e.data),z6(e),e}const h4=new Map,U6=new Set;function Qm(e,t){let r=h4.get(e);return r||(r=t(),h4.set(e,r),U6.add(r)),r}const Gh=(e,t,r)=>{const n=Yc(t,r);n!==void 0&&e.add(n)};class nle{constructor(t){this._config=rle(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=B6(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),z6(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Qm(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,r){return Qm(`${t}.transition.${r}`,()=>[[`datasets.${t}.transitions.${r}`,`transitions.${r}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,r){return Qm(`${t}-${r}`,()=>[[`datasets.${t}.elements.${r}`,`datasets.${t}`,`elements.${r}`,""]])}pluginScopeKeys(t){const r=t.id,n=this.type;return Qm(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,r){const n=this._scopeCache;let s=n.get(t);return(!s||r)&&(s=new Map,n.set(t,s)),s}getOptionScopes(t,r,n){const{options:s,type:i}=this,o=this._cachedScopes(t,n),l=o.get(r);if(l)return l;const c=new Set;r.forEach(h=>{t&&(c.add(t),h.forEach(f=>Gh(c,t,f))),h.forEach(f=>Gh(c,s,f)),h.forEach(f=>Gh(c,Qc[i]||{},f)),h.forEach(f=>Gh(c,sr,f)),h.forEach(f=>Gh(c,w2,f))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),U6.has(r)&&o.set(r,u),u}chartOptionScopes(){const{options:t,type:r}=this;return[t,Qc[r]||{},sr.datasets[r]||{},{type:r},sr,w2]}resolveNamedOptions(t,r,n,s=[""]){const i={$shared:!0},{resolver:o,subPrefixes:l}=f4(this._resolverCache,t,s);let c=o;if(ale(o,r)){i.$shared=!1,n=kl(n)?n():n;const u=this.createResolver(t,n,l);c=Ou(o,n,u)}for(const u of r)i[u]=c[u];return i}createResolver(t,r,n=[""],s){const{resolver:i}=f4(this._resolverCache,t,n);return et(r)?Ou(i,r,void 0,s):i}}function f4(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));const s=r.join();let i=n.get(s);return i||(i={resolver:zk(t,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},n.set(s,i)),i}const sle=e=>et(e)&&Object.getOwnPropertyNames(e).some(t=>kl(e[t]));function ale(e,t){const{isScriptable:r,isIndexable:n}=_6(e);for(const s of t){const i=r(s),o=n(s),l=(o||i)&&e[s];if(i&&(kl(l)||sle(l))||o&&pr(l))return!0}return!1}var ile="4.5.1";const ole=["top","bottom","left","right","chartArea"];function p4(e,t){return e==="top"||e==="bottom"||ole.indexOf(e)===-1&&t==="x"}function m4(e,t){return function(r,n){return r[e]===n[e]?r[t]-n[t]:r[e]-n[e]}}function g4(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),Dt(r&&r.onComplete,[e],t)}function lle(e){const t=e.chart,r=t.options.animation;Dt(r&&r.onProgress,[e],t)}function V6(e){return Vk()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const ax={},x4=e=>{const t=V6(e);return Object.values(ax).filter(r=>r.canvas===t).pop()};function cle(e,t,r){const n=Object.keys(e);for(const s of n){const i=+s;if(i>=t){const o=e[s];delete e[s],(r>0||i>t)&&(e[i+r]=o)}}}function dle(e,t,r,n){return!r||e.type==="mouseout"?null:n?t:e}var Ro;let Rr=(Ro=class{static register(...t){ti.add(...t),v4()}static unregister(...t){ti.remove(...t),v4()}constructor(t,r){const n=this.config=new nle(r),s=V6(t),i=x4(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Toe(s)),this.platform.updateConfig(n);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;if(this.id=lae(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Goe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=$ae(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],ax[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Pi.listen(this,"complete",g4),Pi.listen(this,"progress",lle),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:n,height:s,_aspectRatio:i}=this;return xt(t)?r&&i?i:s?n/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ti}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():z5(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return I5(this.canvas,this.ctx),this}stop(){return Pi.stop(this),this}resize(t,r){Pi.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const n=this.options,s=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,r,i),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,z5(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Dt(n.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};wt(r,(n,s)=>{n.id=s})}buildOrUpdateScales(){const t=this.options,r=t.scales,n=this.scales,s=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let i=[];r&&(i=i.concat(Object.keys(r).map(o=>{const l=r[o],c=C2(o,l),u=c==="r",h=c==="x";return{options:l,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),wt(i,o=>{const l=o.options,c=l.id,u=C2(c,l),h=Ye(l.type,o.dtype);(l.position===void 0||p4(l.position,u)!==p4(o.dposition))&&(l.position=o.dposition),s[c]=!0;let f=null;if(c in n&&n[c].type===h)f=n[c];else{const m=ti.getScale(h);f=new m({id:c,type:h,ctx:this.ctx,chart:this}),n[f.id]=f}f.init(l,t)}),wt(s,(o,l)=>{o||delete n[l]}),wt(n,o=>{Ys.configure(this,o,o.options),Ys.addBox(this,o)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,n=t.length;if(t.sort((s,i)=>s.index-i.index),n>r){for(let s=r;s<n;++s)this._destroyDatasetMeta(s);t.splice(r,n-r)}this._sortedMetasets=t.slice(0).sort(m4("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((n,s)=>{r.filter(i=>i===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=r.length;n<s;n++){const i=r[n];let o=this.getDatasetMeta(n);const l=i.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=i.indexAxis||S2(l,this.options),o.order=i.order||0,o.index=n,o.label=""+i.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const c=ti.getController(l),{datasetElementType:u,dataElementType:h}=sr.datasets[l];Object.assign(c,{dataElementType:ti.getElement(h),datasetElementType:u&&ti.getElement(u)}),o.controller=new c(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){wt(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){const{controller:f}=this.getDatasetMeta(u),m=!s&&i.indexOf(f)===-1;f.buildOrUpdateElements(m),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),s||wt(i,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(m4("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){wt(this.scales,t=>{Ys.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!$5(r,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:i}of r){const o=n==="_removeElements"?-i:i;cle(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=i=>new Set(t.filter(o=>o[0]===i).map((o,l)=>l+","+o.splice(1).join(","))),s=n(0);for(let i=1;i<r;i++)if(!$5(s,n(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ys.update(this,this.width,this.height,t);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],wt(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,kl(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const n=this.getDatasetMeta(t),s={meta:n,index:t,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(r),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Pi.has(this)?this.attached&&!Pi.running(this)&&Pi.start(this):(this.draw(),g4({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,n=[];let s,i;for(s=0,i=r.length;s<i;++s){const o=r[s];(!t||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,n={meta:t,index:t.index,cancelable:!0},s=F6(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(s&&V1(r,s),t.controller.draw(),s&&H1(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return z0(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,n,s){const i=ooe.modes[r];return typeof i=="function"?i(this,t,n,s):[]}getDatasetMeta(t){const r=this.data.datasets[t],n=this._metasets;let s=n.filter(i=>i&&i._dataset===r).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=od(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(t,r){const n=this.getDatasetMeta(t);n.hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,n){const s=n?"show":"hide",i=this.getDatasetMeta(t),o=i.controller._resolveAnimations(void 0,s);I0(r)?(i.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(i,{visible:n}),this.update(l=>l.datasetIndex===t?s:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),Pi.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),I5(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete ax[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,n=(i,o)=>{r.addEventListener(this,i,o),t[i]=o},s=(i,o,l)=>{i.offsetX=o,i.offsetY=l,this._eventHandler(i)};wt(this.options.events,i=>n(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,n=(c,u)=>{r.addEventListener(this,c,u),t[c]=u},s=(c,u)=>{t[c]&&(r.removeEventListener(this,c,u),delete t[c])},i=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),n("resize",i),n("detach",o)};o=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),n("attach",l)},r.isAttached(this.canvas)?l():o()}unbindEvents(){wt(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},wt(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,n){const s=n?"set":"remove";let i,o,l,c;for(r==="dataset"&&(i=this.getDatasetMeta(t[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],n=t.map(({datasetIndex:i,index:o})=>{const l=this.getDatasetMeta(i);if(!l)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:l.data[o],index:o}});!Zx(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(t,r,n){return this._plugins.notify(this,t,r,n)}isPluginEnabled(t){return this._plugins._cache.filter(r=>r.plugin.id===t).length===1}_updateHoverStyles(t,r,n){const s=this.options.hover,i=(c,u)=>c.filter(h=>!u.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),o=i(r,t),l=n?t:i(t,r);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(t,r){const n={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const i=this._handleEvent(t,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(i||n.changed)&&this.render(),this}_handleEvent(t,r,n){const{_active:s=[],options:i}=this,o=r,l=this._getActiveElements(t,s,n,o),c=pae(t),u=dle(t,this._lastEvent,n,c);n&&(this._lastEvent=null,Dt(i.onHover,[t,l,this],this),c&&Dt(i.onClick,[t,l,this],this));const h=!Zx(l,s);return(h||r)&&(this._active=l,this._updateHoverStyles(l,s,r)),this._lastEvent=u,h}_getActiveElements(t,r,n,s){if(t.type==="mouseout")return[];if(!n)return r;const i=this.options.hover;return this.getElementsAtEventForMode(t,i.mode,i,s)}},Fe(Ro,"defaults",sr),Fe(Ro,"instances",ax),Fe(Ro,"overrides",Qc),Fe(Ro,"registry",ti),Fe(Ro,"version",ile),Fe(Ro,"getChart",x4),Ro);function v4(){return wt(Rr.instances,e=>e._plugins.invalidate())}function ule(e,t,r){const{startAngle:n,x:s,y:i,outerRadius:o,innerRadius:l,options:c}=t,{borderWidth:u,borderJoinStyle:h}=c,f=Math.min(u/o,us(n-r));if(e.beginPath(),e.arc(s,i,o-u/2,n+f/2,r-f/2),l>0){const m=Math.min(u/l,us(n-r));e.arc(s,i,l+u/2,r-m/2,n+m/2,!0)}else{const m=Math.min(u/2,o*us(n-r));if(h==="round")e.arc(s,i,m,r-jt/2,n+jt/2,!0);else if(h==="bevel"){const g=2*m*m,v=-g*Math.cos(r+jt/2)+s,x=-g*Math.sin(r+jt/2)+i,y=g*Math.cos(n+jt/2)+s,_=g*Math.sin(n+jt/2)+i;e.lineTo(v,x),e.lineTo(y,_)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function hle(e,t,r){const{startAngle:n,pixelMargin:s,x:i,y:o,outerRadius:l,innerRadius:c}=t;let u=s/l;e.beginPath(),e.arc(i,o,l,n-u,r+u),c>s?(u=s/c,e.arc(i,o,c,r+u,n-u,!0)):e.arc(i,o,s,r+wr,n-wr),e.closePath(),e.clip()}function fle(e){return Lk(e,["outerStart","outerEnd","innerStart","innerEnd"])}function ple(e,t,r,n){const s=fle(e.options.borderRadius),i=(r-t)/2,o=Math.min(i,n*t/2),l=c=>{const u=(r-Math.min(i,c))*n/2;return ln(c,0,Math.min(i,u))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:ln(s.innerStart,0,o),innerEnd:ln(s.innerEnd,0,o)}}function $d(e,t,r,n){return{x:r+e*Math.cos(t),y:n+e*Math.sin(t)}}function a1(e,t,r,n,s,i){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:h}=t,f=Math.max(t.outerRadius+n+r-u,0),m=h>0?h+n+r+u:0;let g=0;const v=s-c;if(n){const P=h>0?h-n:0,Q=f>0?f-n:0,re=(P+Q)/2,Z=re!==0?v*re/(re+n):v;g=(v-Z)/2}const x=Math.max(.001,v*f-r/jt)/f,y=(v-x)/2,_=c+y+g,b=s-y-g,{outerStart:w,outerEnd:C,innerStart:j,innerEnd:T}=ple(t,m,f,b-_),k=f-w,M=f-C,A=_+w/k,O=b-C/M,F=m+j,B=m+T,L=_+j/F,U=b-T/B;if(e.beginPath(),i){const P=(A+O)/2;if(e.arc(o,l,f,A,P),e.arc(o,l,f,P,O),C>0){const W=$d(M,O,o,l);e.arc(W.x,W.y,C,O,b+wr)}const Q=$d(B,b,o,l);if(e.lineTo(Q.x,Q.y),T>0){const W=$d(B,U,o,l);e.arc(W.x,W.y,T,b+wr,U+Math.PI)}const re=(b-T/m+(_+j/m))/2;if(e.arc(o,l,m,b-T/m,re,!0),e.arc(o,l,m,re,_+j/m,!0),j>0){const W=$d(F,L,o,l);e.arc(W.x,W.y,j,L+Math.PI,_-wr)}const Z=$d(k,_,o,l);if(e.lineTo(Z.x,Z.y),w>0){const W=$d(k,A,o,l);e.arc(W.x,W.y,w,_-wr,A)}}else{e.moveTo(o,l);const P=Math.cos(A)*f+o,Q=Math.sin(A)*f+l;e.lineTo(P,Q);const re=Math.cos(O)*f+o,Z=Math.sin(O)*f+l;e.lineTo(re,Z)}e.closePath()}function mle(e,t,r,n,s){const{fullCircles:i,startAngle:o,circumference:l}=t;let c=t.endAngle;if(i){a1(e,t,r,n,c,s);for(let u=0;u<i;++u)e.fill();isNaN(l)||(c=o+(l%Wt||Wt))}return a1(e,t,r,n,c,s),e.fill(),c}function gle(e,t,r,n,s){const{fullCircles:i,startAngle:o,circumference:l,options:c}=t,{borderWidth:u,borderJoinStyle:h,borderDash:f,borderDashOffset:m,borderRadius:g}=c,v=c.borderAlign==="inner";if(!u)return;e.setLineDash(f||[]),e.lineDashOffset=m,v?(e.lineWidth=u*2,e.lineJoin=h||"round"):(e.lineWidth=u,e.lineJoin=h||"bevel");let x=t.endAngle;if(i){a1(e,t,r,n,x,s);for(let y=0;y<i;++y)e.stroke();isNaN(l)||(x=o+(l%Wt||Wt))}v&&hle(e,t,x),c.selfJoin&&x-o>=jt&&g===0&&h!=="miter"&&ule(e,t,x),i||(a1(e,t,r,n,x,s),e.stroke())}class Xn extends Da{constructor(r){super();Fe(this,"circumference");Fe(this,"endAngle");Fe(this,"fullCircles");Fe(this,"innerRadius");Fe(this,"outerRadius");Fe(this,"pixelMargin");Fe(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,n,s){const i=this.getProps(["x","y"],s),{angle:o,distance:l}=f6(i,{x:r,y:n}),{startAngle:c,endAngle:u,innerRadius:h,outerRadius:f,circumference:m}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),g=(this.options.spacing+this.options.borderWidth)/2,v=Ye(m,u-c),x=L0(o,c,u)&&c!==u,y=v>=Wt||x,_=qi(l,h+g,f+g);return y&&_}getCenterPoint(r){const{x:n,y:s,startAngle:i,endAngle:o,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:u,spacing:h}=this.options,f=(i+o)/2,m=(l+c+h+u)/2;return{x:n+Math.cos(f)*m,y:s+Math.sin(f)*m}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:n,circumference:s}=this,i=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Wt?Math.floor(s/Wt):0,s===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const c=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(c)*i,Math.sin(c)*i);const u=1-Math.sin(Math.min(jt,s||0)),h=i*u;r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,mle(r,this,h,o,l),gle(r,this,h,o,l),r.restore()}}Fe(Xn,"id","arc"),Fe(Xn,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Fe(Xn,"defaultRoutes",{backgroundColor:"backgroundColor"}),Fe(Xn,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});function H6(e,t,r=t){e.lineCap=Ye(r.borderCapStyle,t.borderCapStyle),e.setLineDash(Ye(r.borderDash,t.borderDash)),e.lineDashOffset=Ye(r.borderDashOffset,t.borderDashOffset),e.lineJoin=Ye(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Ye(r.borderWidth,t.borderWidth),e.strokeStyle=Ye(r.borderColor,t.borderColor)}function xle(e,t,r){e.lineTo(r.x,r.y)}function vle(e){return e.stepped?Bae:e.tension||e.cubicInterpolationMode==="monotone"?Uae:xle}function W6(e,t,r={}){const n=e.length,{start:s=0,end:i=n-1}=r,{start:o,end:l}=t,c=Math.max(s,o),u=Math.min(i,l),h=s<o&&i<o||s>l&&i>l;return{count:n,start:c,loop:t.loop,ilen:u<c&&!h?n+u-c:u-c}}function yle(e,t,r,n){const{points:s,options:i}=t,{count:o,start:l,loop:c,ilen:u}=W6(s,r,n),h=vle(i);let{move:f=!0,reverse:m}=n||{},g,v,x;for(g=0;g<=u;++g)v=s[(l+(m?u-g:g))%o],!v.skip&&(f?(e.moveTo(v.x,v.y),f=!1):h(e,x,v,m,i.stepped),x=v);return c&&(v=s[(l+(m?u:0))%o],h(e,x,v,m,i.stepped)),!!c}function ble(e,t,r,n){const s=t.points,{count:i,start:o,ilen:l}=W6(s,r,n),{move:c=!0,reverse:u}=n||{};let h=0,f=0,m,g,v,x,y,_;const b=C=>(o+(u?l-C:C))%i,w=()=>{x!==y&&(e.lineTo(h,y),e.lineTo(h,x),e.lineTo(h,_))};for(c&&(g=s[b(0)],e.moveTo(g.x,g.y)),m=0;m<=l;++m){if(g=s[b(m)],g.skip)continue;const C=g.x,j=g.y,T=C|0;T===v?(j<x?x=j:j>y&&(y=j),h=(f*h+C)/++f):(w(),e.lineTo(C,j),v=T,f=0,x=y=j),_=j}w()}function $2(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!r?ble:yle}function _le(e){return e.stepped?bie:e.tension||e.cubicInterpolationMode==="monotone"?_ie:ic}function wle(e,t,r,n){let s=t._path;s||(s=t._path=new Path2D,t.path(s,r,n)&&s.closePath()),H6(e,t.options),e.stroke(s)}function jle(e,t,r,n){const{segments:s,options:i}=t,o=$2(t);for(const l of s)H6(e,i,l.style),e.beginPath(),o(e,t,l,{start:r,end:r+n-1})&&e.closePath(),e.stroke()}const kle=typeof Path2D=="function";function Sle(e,t,r,n){kle&&!t.options.segment?wle(e,t,r,n):jle(e,t,r,n)}class jr extends Da{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;hie(this._points,n,t,s,r),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=$ie(this,this.options.segment))}first(){const t=this.segments,r=this.points;return t.length&&r[t[0].start]}last(){const t=this.segments,r=this.points,n=t.length;return n&&r[t[n-1].end]}interpolate(t,r){const n=this.options,s=t[r],i=this.points,o=A6(this,{property:r,start:s,end:s});if(!o.length)return;const l=[],c=_le(n);let u,h;for(u=0,h=o.length;u<h;++u){const{start:f,end:m}=o[u],g=i[f],v=i[m];if(g===v){l.push(g);continue}const x=Math.abs((s-g[r])/(v[r]-g[r])),y=c(g,v,x,n.stepped);y[r]=t[r],l.push(y)}return l.length===1?l[0]:l}pathSegment(t,r,n){return $2(this)(t,this,r,n)}path(t,r,n){const s=this.segments,i=$2(this);let o=this._loop;r=r||0,n=n||this.points.length-r;for(const l of s)o&=i(t,this,l,{start:r,end:r+n-1});return!!o}draw(t,r,n,s){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(t.save(),Sle(t,this,n,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Fe(jr,"id","line"),Fe(jr,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Fe(jr,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Fe(jr,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function y4(e,t,r,n){const s=e.options,{[r]:i}=e.getProps([r],n);return Math.abs(t-i)<s.radius+s.hitRadius}class Fn extends Da{constructor(r){super();Fe(this,"parsed");Fe(this,"skip");Fe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,n,s){const i=this.options,{x:o,y:l}=this.getProps(["x","y"],s);return Math.pow(r-o,2)+Math.pow(n-l,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(r,n){return y4(this,r,"x",n)}inYRange(r,n){return y4(this,r,"y",n)}getCenterPoint(r){const{x:n,y:s}=this.getProps(["x","y"],r);return{x:n,y:s}}size(r){r=r||this.options||{};let n=r.radius||0;n=Math.max(n,n&&r.hoverRadius||0);const s=n&&r.borderWidth||0;return(n+s)*2}draw(r,n){const s=this.options;this.skip||s.radius<.1||!z0(this,n,this.size(s)/2)||(r.strokeStyle=s.borderColor,r.lineWidth=s.borderWidth,r.fillStyle=s.backgroundColor,j2(r,s,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}Fe(Fn,"id","point"),Fe(Fn,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Fe(Fn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function G6(e,t){const{x:r,y:n,base:s,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,h,f;return e.horizontal?(f=o/2,l=Math.min(r,s),c=Math.max(r,s),u=n-f,h=n+f):(f=i/2,l=r-f,c=r+f,u=Math.min(n,s),h=Math.max(n,s)),{left:l,top:u,right:c,bottom:h}}function il(e,t,r,n){return e?0:ln(t,r,n)}function Cle(e,t,r){const n=e.options.borderWidth,s=e.borderSkipped,i=b6(n);return{t:il(s.top,i.top,0,r),r:il(s.right,i.right,0,t),b:il(s.bottom,i.bottom,0,r),l:il(s.left,i.left,0,t)}}function $le(e,t,r){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,i=su(s),o=Math.min(t,r),l=e.borderSkipped,c=n||et(s);return{topLeft:il(!c||l.top||l.left,i.topLeft,0,o),topRight:il(!c||l.top||l.right,i.topRight,0,o),bottomLeft:il(!c||l.bottom||l.left,i.bottomLeft,0,o),bottomRight:il(!c||l.bottom||l.right,i.bottomRight,0,o)}}function Tle(e){const t=G6(e),r=t.right-t.left,n=t.bottom-t.top,s=Cle(e,r/2,n/2),i=$le(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n,radius:i},inner:{x:t.left+s.l,y:t.top+s.t,w:r-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,i.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(s.b,s.r))}}}}function e_(e,t,r,n){const s=t===null,i=r===null,l=e&&!(s&&i)&&G6(e,n);return l&&(s||qi(t,l.left,l.right))&&(i||qi(r,l.top,l.bottom))}function Ele(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function Ale(e,t){e.rect(t.x,t.y,t.w,t.h)}function t_(e,t,r={}){const n=e.x!==r.x?-t:0,s=e.y!==r.y?-t:0,i=(e.x+e.w!==r.x+r.w?t:0)-n,o=(e.y+e.h!==r.y+r.h?t:0)-s;return{x:e.x+n,y:e.y+s,w:e.w+i,h:e.h+o,radius:e.radius}}class Or extends Da{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:r,options:{borderColor:n,backgroundColor:s}}=this,{inner:i,outer:o}=Tle(this),l=Ele(o.radius)?r1:Ale;t.save(),(o.w!==i.w||o.h!==i.h)&&(t.beginPath(),l(t,t_(o,r,i)),t.clip(),l(t,t_(i,-r,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),l(t,t_(i,r)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,r,n){return e_(this,t,r,n)}inXRange(t,r){return e_(this,t,null,r)}inYRange(t,r){return e_(this,null,t,r)}getCenterPoint(t){const{x:r,y:n,base:s,horizontal:i}=this.getProps(["x","y","base","horizontal"],t);return{x:i?(r+s)/2:r,y:i?n:(n+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Fe(Or,"id","bar"),Fe(Or,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Fe(Or,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Fle(e,t,r){const n=e.segments,s=e.points,i=t.points,o=[];for(const l of n){let{start:c,end:u}=l;u=q1(c,u,s);const h=T2(r,s[c],s[u],l.loop);if(!t.segments){o.push({source:l,target:h,start:s[c],end:s[u]});continue}const f=A6(t,h);for(const m of f){const g=T2(r,i[m.start],i[m.end],m.loop),v=E6(l,s,g);for(const x of v)o.push({source:x,target:m,start:{[r]:b4(h,g,"start",Math.max)},end:{[r]:b4(h,g,"end",Math.min)}})}}return o}function T2(e,t,r,n){if(n)return;let s=t[e],i=r[e];return e==="angle"&&(s=us(s),i=us(i)),{property:e,start:s,end:i}}function Ple(e,t){const{x:r=null,y:n=null}=e||{},s=t.points,i=[];return t.segments.forEach(({start:o,end:l})=>{l=q1(o,l,s);const c=s[o],u=s[l];n!==null?(i.push({x:c.x,y:n}),i.push({x:u.x,y:n})):r!==null&&(i.push({x:r,y:c.y}),i.push({x:r,y:u.y}))}),i}function q1(e,t,r){for(;t>e;t--){const n=r[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function b4(e,t,r,n){return e&&t?n(e[r],t[r]):e?e[r]:t?t[r]:0}function q6(e,t){let r=[],n=!1;return pr(e)?(n=!0,r=e):r=Ple(e,t),r.length?new jr({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function _4(e){return e&&e.fill!==!1}function Dle(e,t,r){let s=e[t].fill;const i=[t];let o;if(!r)return s;for(;s!==!1&&i.indexOf(s)===-1;){if(!pn(s))return s;if(o=e[s],!o)return!1;if(o.visible)return s;i.push(s),s=o.fill}return!1}function Mle(e,t,r){const n=Nle(e);if(et(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return pn(s)&&Math.floor(s)===s?Ole(n[0],t,s,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Ole(e,t,r,n){return(e==="-"||e==="+")&&(r=t+r),r===t||r<0||r>=n?!1:r}function Rle(e,t){let r=null;return e==="start"?r=t.bottom:e==="end"?r=t.top:et(e)?r=t.getPixelForValue(e.value):t.getBasePixel&&(r=t.getBasePixel()),r}function Ile(e,t,r){let n;return e==="start"?n=r:e==="end"?n=t.options.reverse?t.min:t.max:et(e)?n=e.value:n=t.getBaseValue(),n}function Nle(e){const t=e.options,r=t.fill;let n=Ye(r&&r.target,r);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function Lle(e){const{scale:t,index:r,line:n}=e,s=[],i=n.segments,o=n.points,l=zle(t,r);l.push(q6({x:null,y:t.bottom},n));for(let c=0;c<i.length;c++){const u=i[c];for(let h=u.start;h<=u.end;h++)Ble(s,o[h],l)}return new jr({points:s,options:{}})}function zle(e,t){const r=[],n=e.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const i=n[s];if(i.index===t)break;i.hidden||r.unshift(i.dataset)}return r}function Ble(e,t,r){const n=[];for(let s=0;s<r.length;s++){const i=r[s],{first:o,last:l,point:c}=Ule(i,t,"x");if(!(!c||o&&l)){if(o)n.unshift(c);else if(e.push(c),!l)break}}e.push(...n)}function Ule(e,t,r){const n=e.interpolate(t,r);if(!n)return{};const s=n[r],i=e.segments,o=e.points;let l=!1,c=!1;for(let u=0;u<i.length;u++){const h=i[u],f=o[h.start][r],m=o[h.end][r];if(qi(s,f,m)){l=s===f,c=s===m;break}}return{first:l,last:c,point:n}}class K6{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,r,n){const{x:s,y:i,radius:o}=this;return r=r||{start:0,end:Wt},t.arc(s,i,o,r.end,r.start,!0),!n.bounds}interpolate(t){const{x:r,y:n,radius:s}=this,i=t.angle;return{x:r+Math.cos(i)*s,y:n+Math.sin(i)*s,angle:i}}}function Vle(e){const{chart:t,fill:r,line:n}=e;if(pn(r))return Hle(t,r);if(r==="stack")return Lle(e);if(r==="shape")return!0;const s=Wle(e);return s instanceof K6?s:q6(s,n)}function Hle(e,t){const r=e.getDatasetMeta(t);return r&&e.isDatasetVisible(t)?r.dataset:null}function Wle(e){return(e.scale||{}).getPointPositionForValue?qle(e):Gle(e)}function Gle(e){const{scale:t={},fill:r}=e,n=Rle(r,t);if(pn(n)){const s=t.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function qle(e){const{scale:t,fill:r}=e,n=t.options,s=t.getLabels().length,i=n.reverse?t.max:t.min,o=Ile(r,t,i),l=[];if(n.grid.circular){const c=t.getPointPositionForValue(0,i);return new K6({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(t.getPointPositionForValue(c,o));return l}function r_(e,t,r){const n=Vle(t),{chart:s,index:i,line:o,scale:l,axis:c}=t,u=o.options,h=u.fill,f=u.backgroundColor,{above:m=f,below:g=f}=h||{},v=s.getDatasetMeta(i),x=F6(s,v);n&&o.points.length&&(V1(e,r),Kle(e,{line:o,target:n,above:m,below:g,area:r,scale:l,axis:c,clip:x}),H1(e))}function Kle(e,t){const{line:r,target:n,above:s,below:i,area:o,scale:l,clip:c}=t,u=r._loop?"angle":t.axis;e.save();let h=i;i!==s&&(u==="x"?(w4(e,n,o.top),n_(e,{line:r,target:n,color:s,scale:l,property:u,clip:c}),e.restore(),e.save(),w4(e,n,o.bottom)):u==="y"&&(j4(e,n,o.left),n_(e,{line:r,target:n,color:i,scale:l,property:u,clip:c}),e.restore(),e.save(),j4(e,n,o.right),h=s)),n_(e,{line:r,target:n,color:h,scale:l,property:u,clip:c}),e.restore()}function w4(e,t,r){const{segments:n,points:s}=t;let i=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=s[c],f=s[q1(c,u,s)];i?(e.moveTo(h.x,h.y),i=!1):(e.lineTo(h.x,r),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(f.x,r)}e.lineTo(t.first().x,r),e.closePath(),e.clip()}function j4(e,t,r){const{segments:n,points:s}=t;let i=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=s[c],f=s[q1(c,u,s)];i?(e.moveTo(h.x,h.y),i=!1):(e.lineTo(r,h.y),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(r,f.y)}e.lineTo(r,t.first().y),e.closePath(),e.clip()}function n_(e,t){const{line:r,target:n,property:s,color:i,scale:o,clip:l}=t,c=Fle(r,n,s);for(const{source:u,target:h,start:f,end:m}of c){const{style:{backgroundColor:g=i}={}}=u,v=n!==!0;e.save(),e.fillStyle=g,Xle(e,o,l,v&&T2(s,f,m)),e.beginPath();const x=!!r.pathSegment(e,u);let y;if(v){x?e.closePath():k4(e,n,m,s);const _=!!n.pathSegment(e,h,{move:x,reverse:!0});y=x&&_,y||k4(e,n,f,s)}e.closePath(),e.fill(y?"evenodd":"nonzero"),e.restore()}}function Xle(e,t,r,n){const s=t.chart.chartArea,{property:i,start:o,end:l}=n||{};if(i==="x"||i==="y"){let c,u,h,f;i==="x"?(c=o,u=s.top,h=l,f=s.bottom):(c=s.left,u=o,h=s.right,f=l),e.beginPath(),r&&(c=Math.max(c,r.left),h=Math.min(h,r.right),u=Math.max(u,r.top),f=Math.min(f,r.bottom)),e.rect(c,u,h-c,f-u),e.clip()}}function k4(e,t,r,n){const s=t.interpolate(r,n);s&&e.lineTo(s.x,s.y)}var Yu={id:"filler",afterDatasetsUpdate(e,t,r){const n=(e.data.datasets||[]).length,s=[];let i,o,l,c;for(o=0;o<n;++o)i=e.getDatasetMeta(o),l=i.dataset,c=null,l&&l.options&&l instanceof jr&&(c={visible:e.isDatasetVisible(o),index:o,fill:Mle(l,o,n),chart:e,axis:i.controller.options.indexAxis,scale:i.vScale,line:l}),i.$filler=c,s.push(c);for(o=0;o<n;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=Dle(s,o,r.propagate))},beforeDraw(e,t,r){const n=r.drawTime==="beforeDraw",s=e.getSortedVisibleDatasetMetas(),i=e.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(i,l.axis),n&&l.fill&&r_(e.ctx,l,i))}},beforeDatasetsDraw(e,t,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=e.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const i=n[s].$filler;_4(i)&&r_(e.ctx,i,e.chartArea)}},beforeDatasetDraw(e,t,r){const n=t.meta.$filler;!_4(n)||r.drawTime!=="beforeDatasetDraw"||r_(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const S4=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}},Yle=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class C4 extends Da{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r,n){this.maxWidth=t,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let r=Dt(t.generateLabels,[this.chart],this)||[];t.filter&&(r=r.filter(n=>t.filter(n,this.chart.data))),t.sort&&(r=r.sort((n,s)=>t.sort(n,s,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:t,ctx:r}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,s=cn(n.font),i=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=S4(n,i);let u,h;r.font=s.string,this.isHorizontal()?(u=this.maxWidth,h=this._fitRows(o,i,l,c)+10):(h=this.maxHeight,u=this._fitCols(o,s,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,r,n,s){const{ctx:i,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],h=s+l;let f=t;i.textAlign="left",i.textBaseline="middle";let m=-1,g=-h;return this.legendItems.forEach((v,x)=>{const y=n+r/2+i.measureText(v.text).width;(x===0||u[u.length-1]+y+2*l>o)&&(f+=h,u[u.length-(x>0?0:1)]=0,g+=h,m++),c[x]={left:0,top:g,row:m,width:y,height:s},u[u.length-1]+=y+l}),f}_fitCols(t,r,n,s){const{ctx:i,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],h=o-t;let f=l,m=0,g=0,v=0,x=0;return this.legendItems.forEach((y,_)=>{const{itemWidth:b,itemHeight:w}=Qle(n,r,i,y,s);_>0&&g+w+2*l>h&&(f+=m+l,u.push({width:m,height:g}),v+=m+l,x++,m=g=0),c[_]={left:v,top:g,col:x,width:b,height:w},m=Math.max(m,b),g+=w+l}),f+=m,u.push({width:m,height:g}),f}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:s},rtl:i}}=this,o=au(i,this.left,this.width);if(this.isHorizontal()){let l=0,c=Zr(n,this.left+s,this.right-this.lineWidths[l]);for(const u of r)l!==u.row&&(l=u.row,c=Zr(n,this.left+s,this.right-this.lineWidths[l])),u.top+=this.top+t+s,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+s}else{let l=0,c=Zr(n,this.top+t+s,this.bottom-this.columnSizes[l].height);for(const u of r)u.col!==l&&(l=u.col,c=Zr(n,this.top+t+s,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+s,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;V1(t,this),this._draw(),H1(t)}}_draw(){const{options:t,columnSizes:r,lineWidths:n,ctx:s}=this,{align:i,labels:o}=t,l=sr.color,c=au(t.rtl,this.left,this.width),u=cn(o.font),{padding:h}=o,f=u.size,m=f/2;let g;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=u.string;const{boxWidth:v,boxHeight:x,itemHeight:y}=S4(o,f),_=function(T,k,M){if(isNaN(v)||v<=0||isNaN(x)||x<0)return;s.save();const A=Ye(M.lineWidth,1);if(s.fillStyle=Ye(M.fillStyle,l),s.lineCap=Ye(M.lineCap,"butt"),s.lineDashOffset=Ye(M.lineDashOffset,0),s.lineJoin=Ye(M.lineJoin,"miter"),s.lineWidth=A,s.strokeStyle=Ye(M.strokeStyle,l),s.setLineDash(Ye(M.lineDash,[])),o.usePointStyle){const O={radius:x*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:A},F=c.xPlus(T,v/2),B=k+m;y6(s,O,F,B,o.pointStyleWidth&&v)}else{const O=k+Math.max((f-x)/2,0),F=c.leftForLtr(T,v),B=su(M.borderRadius);s.beginPath(),Object.values(B).some(L=>L!==0)?r1(s,{x:F,y:O,w:v,h:x,radius:B}):s.rect(F,O,v,x),s.fill(),A!==0&&s.stroke()}s.restore()},b=function(T,k,M){B0(s,M.text,T,k+y/2,u,{strikethrough:M.hidden,textAlign:c.textAlign(M.textAlign)})},w=this.isHorizontal(),C=this._computeTitleHeight();w?g={x:Zr(i,this.left+h,this.right-n[0]),y:this.top+h+C,line:0}:g={x:this.left+h,y:Zr(i,this.top+C+h,this.bottom-r[0].height),line:0},C6(this.ctx,t.textDirection);const j=y+h;this.legendItems.forEach((T,k)=>{s.strokeStyle=T.fontColor,s.fillStyle=T.fontColor;const M=s.measureText(T.text).width,A=c.textAlign(T.textAlign||(T.textAlign=o.textAlign)),O=v+m+M;let F=g.x,B=g.y;c.setWidth(this.width),w?k>0&&F+O+h>this.right&&(B=g.y+=j,g.line++,F=g.x=Zr(i,this.left+h,this.right-n[g.line])):k>0&&B+j>this.bottom&&(F=g.x=F+r[g.line].width+h,g.line++,B=g.y=Zr(i,this.top+C+h,this.bottom-r[g.line].height));const L=c.x(F);if(_(L,B,T),F=Tae(A,F+v+m,w?F+O:this.right,t.rtl),b(c.x(F),B,T),w)g.x+=O+h;else if(typeof T.text!="string"){const U=u.lineHeight;g.y+=X6(T,U)+h}else g.y+=j}),$6(this.ctx,t.textDirection)}drawTitle(){const t=this.options,r=t.title,n=cn(r.font),s=na(r.padding);if(!r.display)return;const i=au(t.rtl,this.left,this.width),o=this.ctx,l=r.position,c=n.size/2,u=s.top+c;let h,f=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),h=this.top+u,f=Zr(t.align,f,this.right-m);else{const v=this.columnSizes.reduce((x,y)=>Math.max(x,y.height),0);h=u+Zr(t.align,this.top,this.bottom-v-t.labels.padding-this._computeTitleHeight())}const g=Zr(l,f,f+m);o.textAlign=i.textAlign(Rk(l)),o.textBaseline="middle",o.strokeStyle=r.color,o.fillStyle=r.color,o.font=n.string,B0(o,r.text,g,h,n)}_computeTitleHeight(){const t=this.options.title,r=cn(t.font),n=na(t.padding);return t.display?r.lineHeight+n.height:0}_getLegendItemAt(t,r){let n,s,i;if(qi(t,this.left,this.right)&&qi(r,this.top,this.bottom)){for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(s=i[n],qi(t,s.left,s.left+s.width)&&qi(r,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(t){const r=this.options;if(!ece(t.type,r))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,i=Yle(s,n);s&&!i&&Dt(r.onLeave,[t,s,this],this),this._hoveredItem=n,n&&!i&&Dt(r.onHover,[t,n,this],this)}else n&&Dt(r.onClick,[t,n,this],this)}}function Qle(e,t,r,n,s){const i=Jle(n,e,t,r),o=Zle(s,n,t.lineHeight);return{itemWidth:i,itemHeight:o}}function Jle(e,t,r,n){let s=e.text;return s&&typeof s!="string"&&(s=s.reduce((i,o)=>i.length>o.length?i:o)),t+r.size/2+n.measureText(s).width}function Zle(e,t,r){let n=e;return typeof t.text!="string"&&(n=X6(t,r)),n}function X6(e,t){const r=e.text?e.text.length:0;return t*r}function ece(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Mn={id:"legend",_element:C4,start(e,t,r){const n=e.legend=new C4({ctx:e.ctx,options:r,chart:e});Ys.configure(e,n,r),Ys.addBox(e,n)},stop(e){Ys.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const n=e.legend;Ys.configure(e,n,r),n.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const n=t.datasetIndex,s=r.chart;s.isDatasetVisible(n)?(s.hide(n),t.hidden=!0):(s.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:s,color:i,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(r?0:void 0),h=na(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:s||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Y6 extends Da{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=r;const s=pr(n.text)?n.text.length:1;this._padding=na(n.padding);const i=s*cn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:r,left:n,bottom:s,right:i,options:o}=this,l=o.align;let c=0,u,h,f;return this.isHorizontal()?(h=Zr(l,n,i),f=r+t,u=i-n):(o.position==="left"?(h=n+t,f=Zr(l,s,r),c=jt*-.5):(h=i-t,f=Zr(l,r,s),c=jt*.5),u=s-r),{titleX:h,titleY:f,maxWidth:u,rotation:c}}draw(){const t=this.ctx,r=this.options;if(!r.display)return;const n=cn(r.font),i=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(i);B0(t,r.text,0,0,n,{color:r.color,maxWidth:c,rotation:u,textAlign:Rk(r.align),textBaseline:"middle",translation:[o,l]})}}function tce(e,t){const r=new Y6({ctx:e.ctx,options:t,chart:e});Ys.configure(e,r,t),Ys.addBox(e,r),e.titleBlock=r}var On={id:"title",_element:Y6,start(e,t,r){tce(e,r)},stop(e){const t=e.titleBlock;Ys.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const n=e.titleBlock;Ys.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ff={average(e){if(!e.length)return!1;let t,r,n=new Set,s=0,i=0;for(t=0,r=e.length;t<r;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();n.add(c.x),s+=c.y,++i}}return i===0||n.size===0?!1:{x:[...n].reduce((l,c)=>l+c)/n.size,y:s/i}},nearest(e,t){if(!e.length)return!1;let r=t.x,n=t.y,s=Number.POSITIVE_INFINITY,i,o,l;for(i=0,o=e.length;i<o;++i){const c=e[i].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),h=_2(t,u);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,n=c.y}return{x:r,y:n}}};function Za(e,t){return t&&(pr(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Di(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function rce(e,t){const{element:r,datasetIndex:n,index:s}=t,i=e.getDatasetMeta(n).controller,{label:o,value:l}=i.getLabelAndValue(s);return{chart:e,label:o,parsed:i.getParsed(s),raw:e.data.datasets[n].data[s],formattedValue:l,dataset:i.getDataset(),dataIndex:s,datasetIndex:n,element:r}}function $4(e,t){const r=e.chart.ctx,{body:n,footer:s,title:i}=e,{boxWidth:o,boxHeight:l}=t,c=cn(t.bodyFont),u=cn(t.titleFont),h=cn(t.footerFont),f=i.length,m=s.length,g=n.length,v=na(t.padding);let x=v.height,y=0,_=n.reduce((C,j)=>C+j.before.length+j.lines.length+j.after.length,0);if(_+=e.beforeBody.length+e.afterBody.length,f&&(x+=f*u.lineHeight+(f-1)*t.titleSpacing+t.titleMarginBottom),_){const C=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;x+=g*C+(_-g)*c.lineHeight+(_-1)*t.bodySpacing}m&&(x+=t.footerMarginTop+m*h.lineHeight+(m-1)*t.footerSpacing);let b=0;const w=function(C){y=Math.max(y,r.measureText(C).width+b)};return r.save(),r.font=u.string,wt(e.title,w),r.font=c.string,wt(e.beforeBody.concat(e.afterBody),w),b=t.displayColors?o+2+t.boxPadding:0,wt(n,C=>{wt(C.before,w),wt(C.lines,w),wt(C.after,w)}),b=0,r.font=h.string,wt(e.footer,w),r.restore(),y+=v.width,{width:y,height:x}}function nce(e,t){const{y:r,height:n}=t;return r<n/2?"top":r>e.height-n/2?"bottom":"center"}function sce(e,t,r,n){const{x:s,width:i}=n,o=r.caretSize+r.caretPadding;if(e==="left"&&s+i+o>t.width||e==="right"&&s-i-o<0)return!0}function ace(e,t,r,n){const{x:s,width:i}=r,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return n==="center"?u=s<=(l+c)/2?"left":"right":s<=i/2?u="left":s>=o-i/2&&(u="right"),sce(u,e,t,r)&&(u="center"),u}function T4(e,t,r){const n=r.yAlign||t.yAlign||nce(e,r);return{xAlign:r.xAlign||t.xAlign||ace(e,t,r,n),yAlign:n}}function ice(e,t){let{x:r,width:n}=e;return t==="right"?r-=n:t==="center"&&(r-=n/2),r}function oce(e,t,r){let{y:n,height:s}=e;return t==="top"?n+=r:t==="bottom"?n-=s+r:n-=s/2,n}function E4(e,t,r,n){const{caretSize:s,caretPadding:i,cornerRadius:o}=e,{xAlign:l,yAlign:c}=r,u=s+i,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:g}=su(o);let v=ice(t,l);const x=oce(t,c,u);return c==="center"?l==="left"?v+=u:l==="right"&&(v-=u):l==="left"?v-=Math.max(h,m)+s:l==="right"&&(v+=Math.max(f,g)+s),{x:ln(v,0,n.width-t.width),y:ln(x,0,n.height-t.height)}}function Jm(e,t,r){const n=na(r.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function A4(e){return Za([],Di(e))}function lce(e,t,r){return od(e,{tooltip:t,tooltipItems:r,type:"tooltip"})}function F4(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const Q6={beforeTitle:Ai,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return r[t.dataIndex]}return""},afterTitle:Ai,beforeBody:Ai,beforeLabel:Ai,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return xt(r)||(t+=r),t},labelColor(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Ai,afterBody:Ai,beforeFooter:Ai,footer:Ai,afterFooter:Ai};function zn(e,t,r,n){const s=e[t].call(r,n);return typeof s>"u"?Q6[t].call(r,n):s}class E2 extends Da{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&r.options.animation&&n.animations,i=new P6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=lce(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:n}=r,s=zn(n,"beforeTitle",this,t),i=zn(n,"title",this,t),o=zn(n,"afterTitle",this,t);let l=[];return l=Za(l,Di(s)),l=Za(l,Di(i)),l=Za(l,Di(o)),l}getBeforeBody(t,r){return A4(zn(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:n}=r,s=[];return wt(t,i=>{const o={before:[],lines:[],after:[]},l=F4(n,i);Za(o.before,Di(zn(l,"beforeLabel",this,i))),Za(o.lines,zn(l,"label",this,i)),Za(o.after,Di(zn(l,"afterLabel",this,i))),s.push(o)}),s}getAfterBody(t,r){return A4(zn(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:n}=r,s=zn(n,"beforeFooter",this,t),i=zn(n,"footer",this,t),o=zn(n,"afterFooter",this,t);let l=[];return l=Za(l,Di(s)),l=Za(l,Di(i)),l=Za(l,Di(o)),l}_createItems(t){const r=this._active,n=this.chart.data,s=[],i=[],o=[];let l=[],c,u;for(c=0,u=r.length;c<u;++c)l.push(rce(this.chart,r[c]));return t.filter&&(l=l.filter((h,f,m)=>t.filter(h,f,m,n))),t.itemSort&&(l=l.sort((h,f)=>t.itemSort(h,f,n))),wt(l,h=>{const f=F4(t.callbacks,h);s.push(zn(f,"labelColor",this,h)),i.push(zn(f,"labelPointStyle",this,h)),o.push(zn(f,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(t,r){const n=this.options.setContext(this.getContext()),s=this._active;let i,o=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const l=Ff[n.position].call(this,s,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const c=this._size=$4(this,n),u=Object.assign({},l,c),h=T4(this.chart,n,u),f=E4(n,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,i={opacity:1,x:f.x,y:f.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,n,s){const i=this.getCaretPosition(t,n,s);r.lineTo(i.x1,i.y1),r.lineTo(i.x2,i.y2),r.lineTo(i.x3,i.y3)}getCaretPosition(t,r,n){const{xAlign:s,yAlign:i}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:f}=su(l),{x:m,y:g}=t,{width:v,height:x}=r;let y,_,b,w,C,j;return i==="center"?(C=g+x/2,s==="left"?(y=m,_=y-o,w=C+o,j=C-o):(y=m+v,_=y+o,w=C-o,j=C+o),b=y):(s==="left"?_=m+Math.max(c,h)+o:s==="right"?_=m+v-Math.max(u,f)-o:_=this.caretX,i==="top"?(w=g,C=w-o,y=_-o,b=_+o):(w=g+x,C=w+o,y=_+o,b=_-o),j=w),{x1:y,x2:_,x3:b,y1:w,y2:C,y3:j}}drawTitle(t,r,n){const s=this.title,i=s.length;let o,l,c;if(i){const u=au(n.rtl,this.x,this.width);for(t.x=Jm(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",o=cn(n.titleFont),l=n.titleSpacing,r.fillStyle=n.titleColor,r.font=o.string,c=0;c<i;++c)r.fillText(s[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===i&&(t.y+=n.titleMarginBottom-l)}}_drawColorBox(t,r,n,s,i){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:c,boxWidth:u}=i,h=cn(i.bodyFont),f=Jm(this,"left",i),m=s.x(f),g=c<h.lineHeight?(h.lineHeight-c)/2:0,v=r.y+g;if(i.usePointStyle){const x={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=s.leftForLtr(m,u)+u/2,_=v+c/2;t.strokeStyle=i.multiKeyBackground,t.fillStyle=i.multiKeyBackground,j2(t,x,y,_),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,j2(t,x,y,_)}else{t.lineWidth=et(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const x=s.leftForLtr(m,u),y=s.leftForLtr(s.xPlus(m,1),u-2),_=su(o.borderRadius);Object.values(_).some(b=>b!==0)?(t.beginPath(),t.fillStyle=i.multiKeyBackground,r1(t,{x,y:v,w:u,h:c,radius:_}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),r1(t,{x:y,y:v+1,w:u-2,h:c-2,radius:_}),t.fill()):(t.fillStyle=i.multiKeyBackground,t.fillRect(x,v,u,c),t.strokeRect(x,v,u,c),t.fillStyle=o.backgroundColor,t.fillRect(y,v+1,u-2,c-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,r,n){const{body:s}=this,{bodySpacing:i,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:h}=n,f=cn(n.bodyFont);let m=f.lineHeight,g=0;const v=au(n.rtl,this.x,this.width),x=function(M){r.fillText(M,v.x(t.x+g),t.y+m/2),t.y+=m+i},y=v.textAlign(o);let _,b,w,C,j,T,k;for(r.textAlign=o,r.textBaseline="middle",r.font=f.string,t.x=Jm(this,y,n),r.fillStyle=n.bodyColor,wt(this.beforeBody,x),g=l&&y!=="right"?o==="center"?u/2+h:u+2+h:0,C=0,T=s.length;C<T;++C){for(_=s[C],b=this.labelTextColors[C],r.fillStyle=b,wt(_.before,x),w=_.lines,l&&w.length&&(this._drawColorBox(r,t,C,v,n),m=Math.max(f.lineHeight,c)),j=0,k=w.length;j<k;++j)x(w[j]),m=f.lineHeight;wt(_.after,x)}g=0,m=f.lineHeight,wt(this.afterBody,x),t.y-=i}drawFooter(t,r,n){const s=this.footer,i=s.length;let o,l;if(i){const c=au(n.rtl,this.x,this.width);for(t.x=Jm(this,n.footerAlign,n),t.y+=n.footerMarginTop,r.textAlign=c.textAlign(n.footerAlign),r.textBaseline="middle",o=cn(n.footerFont),r.fillStyle=n.footerColor,r.font=o.string,l=0;l<i;++l)r.fillText(s[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,r,n,s){const{xAlign:i,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:h}=n,{topLeft:f,topRight:m,bottomLeft:g,bottomRight:v}=su(s.cornerRadius);r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor,r.lineWidth=s.borderWidth,r.beginPath(),r.moveTo(l+f,c),o==="top"&&this.drawCaret(t,r,n,s),r.lineTo(l+u-m,c),r.quadraticCurveTo(l+u,c,l+u,c+m),o==="center"&&i==="right"&&this.drawCaret(t,r,n,s),r.lineTo(l+u,c+h-v),r.quadraticCurveTo(l+u,c+h,l+u-v,c+h),o==="bottom"&&this.drawCaret(t,r,n,s),r.lineTo(l+g,c+h),r.quadraticCurveTo(l,c+h,l,c+h-g),o==="center"&&i==="left"&&this.drawCaret(t,r,n,s),r.lineTo(l,c+f),r.quadraticCurveTo(l,c,l+f,c),r.closePath(),r.fill(),s.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,n=this.$animations,s=n&&n.x,i=n&&n.y;if(s||i){const o=Ff[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=$4(this,t),c=Object.assign({},o,this._size),u=T4(r,t,c),h=E4(t,c,u,r);(s._to!==h.x||i._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=na(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(t.save(),t.globalAlpha=n,this.drawBackground(i,t,s,r),C6(t,r.textDirection),i.y+=o.top,this.drawTitle(i,t,r),this.drawBody(i,t,r),this.drawFooter(i,t,r),$6(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const n=this._active,s=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),i=!Zx(n,s),o=this._positionChanged(s,r);(i||o)&&(this._active=s,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],o=this._getActiveElements(t,i,r,n),l=this._positionChanged(o,t),c=r||!Zx(o,i)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),c}_getActiveElements(t,r,n,s){const i=this.options;if(t.type==="mouseout")return[];if(!s)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,i.mode,i,n);return i.reverse&&o.reverse(),o}_positionChanged(t,r){const{caretX:n,caretY:s,options:i}=this,o=Ff[i.position].call(this,t,r);return o!==!1&&(n!==o.x||s!==o.y)}}Fe(E2,"positioners",Ff);var Rn={id:"tooltip",_element:E2,positioners:Ff,afterInit(e,t,r){r&&(e.tooltip=new E2({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Q6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const cce=(e,t,r,n)=>(typeof t=="string"?(r=e.push(t)-1,n.unshift({index:r,label:t})):isNaN(t)&&(r=null),r);function dce(e,t,r,n){const s=e.indexOf(t);if(s===-1)return cce(e,t,r,n);const i=e.lastIndexOf(t);return s!==i?r:s}const uce=(e,t)=>e===null?null:ln(Math.round(e),0,t);function P4(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class qr extends Xu{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:s,label:i}of r)n[s]===i&&n.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,r){if(xt(t))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===t?r:dce(n,t,Ye(r,t),this._addedLabels),uce(r,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),r||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const t=this.min,r=this.max,n=this.options.offset,s=[];let i=this.getLabels();i=t===0&&r===i.length-1?i:i.slice(t,r+1),this._valueRange=Math.max(i.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=r;o++)s.push({value:o});return s}getLabelForValue(t){return P4.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Fe(qr,"id","category"),Fe(qr,"defaults",{ticks:{callback:P4}});function hce(e,t){const r=[],{bounds:s,step:i,min:o,max:l,precision:c,count:u,maxTicks:h,maxDigits:f,includeBounds:m}=e,g=i||1,v=h-1,{min:x,max:y}=t,_=!xt(o),b=!xt(l),w=!xt(u),C=(y-x)/(f+1);let j=E5((y-x)/v/g)*g,T,k,M,A;if(j<1e-14&&!_&&!b)return[{value:x},{value:y}];A=Math.ceil(y/j)-Math.floor(x/j),A>v&&(j=E5(A*j/v/g)*g),xt(c)||(T=Math.pow(10,c),j=Math.ceil(j*T)/T),s==="ticks"?(k=Math.floor(x/j)*j,M=Math.ceil(y/j)*j):(k=x,M=y),_&&b&&i&&yae((l-o)/i,j/1e3)?(A=Math.round(Math.min((l-o)/j,h)),j=(l-o)/A,k=o,M=l):w?(k=_?o:k,M=b?l:M,A=u-1,j=(M-k)/A):(A=(M-k)/j,Jf(A,Math.round(A),j/1e3)?A=Math.round(A):A=Math.ceil(A));const O=Math.max(A5(j),A5(k));T=Math.pow(10,xt(c)?O:c),k=Math.round(k*T)/T,M=Math.round(M*T)/T;let F=0;for(_&&(m&&k!==o?(r.push({value:o}),k<o&&F++,Jf(Math.round((k+F*j)*T)/T,o,D4(o,C,e))&&F++):k<o&&F++);F<A;++F){const B=Math.round((k+F*j)*T)/T;if(b&&B>l)break;r.push({value:B})}return b&&m&&M!==l?r.length&&Jf(r[r.length-1].value,l,D4(l,C,e))?r[r.length-1].value=l:r.push({value:l}):(!b||M===l)&&r.push({value:M}),r}function D4(e,t,{horizontal:r,minRotation:n}){const s=Gi(n),i=(r?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}class fce extends Xu{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,r){return xt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:s,max:i}=this;const o=c=>s=r?s:c,l=c=>i=n?i:c;if(t){const c=hi(s),u=hi(i);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(s===i){let c=i===0?1:Math.abs(i*.05);l(i+c),t||o(s-c)}this.min=s,this.max=i}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=t,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),r=r||11),r&&(s=Math.min(r,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,r=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},i=this._range||this,o=hce(s,i);return t.bounds==="ticks"&&bae(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const s=(n-r)/Math.max(t.length-1,1)/2;r-=s,n+=s}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(t){return Nk(t,this.chart.options.locale,this.options.ticks.format)}}class Kr extends fce{determineDataLimits(){const{min:t,max:r}=this.getMinMax(!0);this.min=pn(t)?t:0,this.max=pn(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),r=t?this.width:this.height,n=Gi(this.options.ticks.minRotation),s=(t?Math.sin(n):Math.cos(n))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,i.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Fe(Kr,"id","linear"),Fe(Kr,"defaults",{ticks:{callback:v6.formatters.numeric}});const K1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},qn=Object.keys(K1);function M4(e,t){return e-t}function O4(e,t){if(xt(t))return null;const r=e._adapter,{parser:n,round:s,isoWeekday:i}=e._parseOpts;let o=t;return typeof n=="function"&&(o=n(o)),pn(o)||(o=typeof n=="string"?r.parse(o,n):r.parse(o)),o===null?null:(s&&(o=s==="week"&&(N0(i)||i===!0)?r.startOf(o,"isoWeek",i):r.startOf(o,s)),+o)}function R4(e,t,r,n){const s=qn.length;for(let i=qn.indexOf(e);i<s-1;++i){const o=K1[qn[i]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((r-t)/(l*o.size))<=n)return qn[i]}return qn[s-1]}function pce(e,t,r,n,s){for(let i=qn.length-1;i>=qn.indexOf(r);i--){const o=qn[i];if(K1[o].common&&e._adapter.diff(s,n,o)>=t-1)return o}return qn[r?qn.indexOf(r):0]}function mce(e){for(let t=qn.indexOf(e)+1,r=qn.length;t<r;++t)if(K1[qn[t]].common)return qn[t]}function I4(e,t,r){if(!r)e[t]=!0;else if(r.length){const{lo:n,hi:s}=Ok(r,t),i=r[n]>=t?r[n]:r[s];e[i]=!0}}function gce(e,t,r,n){const s=e._adapter,i=+s.startOf(t[0].value,n),o=t[t.length-1].value;let l,c;for(l=i;l<=o;l=+s.add(l,1,n))c=r[l],c>=0&&(t[c].major=!0);return t}function N4(e,t,r){const n=[],s={},i=t.length;let o,l;for(o=0;o<i;++o)l=t[o],s[l]=o,n.push({value:l,major:!1});return i===0||!r?n:gce(e,n,s,r)}class i1 extends Xu{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const n=t.time||(t.time={}),s=this._adapter=new roe._date(t.adapters.date);s.init(r),Qf(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return t===void 0?null:O4(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,n=t.time.unit||"day";let{min:s,max:i,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(s=Math.min(s,u.min)),!l&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=pn(s)&&!isNaN(s)?s:+r.startOf(Date.now(),n),i=pn(i)&&!isNaN(i)?i:+r.endOf(Date.now(),n)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],n=t[t.length-1]),{min:r,max:n}}buildTicks(){const t=this.options,r=t.time,n=t.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,o=this.max,l=Sae(s,i,o);return this._unit=r.unit||(n.autoSkip?R4(r.minUnit,this.min,this.max,this._getLabelCapacity(i)):pce(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:mce(this._unit),this.initOffsets(s),t.reverse&&l.reverse(),N4(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let r=0,n=0,s,i;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?r=1-s:r=(this.getDecimalForValue(t[1])-s)/2,i=this.getDecimalForValue(t[t.length-1]),t.length===1?n=i:n=(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=ln(r,0,o),n=ln(n,0,o),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const t=this._adapter,r=this.min,n=this.max,s=this.options,i=s.time,o=i.unit||R4(i.minUnit,r,n,this._getLabelCapacity(r)),l=Ye(s.ticks.stepSize,1),c=o==="week"?i.isoWeekday:!1,u=N0(c)||c===!0,h={};let f=r,m,g;if(u&&(f=+t.startOf(f,"isoWeek",c)),f=+t.startOf(f,u?"day":o),t.diff(n,r,o)>1e5*l)throw new Error(r+" and "+n+" are too far apart with stepSize of "+l+" "+o);const v=s.ticks.source==="data"&&this.getDataTimestamps();for(m=f,g=0;m<n;m=+t.add(m,l,o),g++)I4(h,m,v);return(m===n||s.bounds==="ticks"||g===1)&&I4(h,m,v),Object.keys(h).sort(M4).map(x=>+x)}getLabelForValue(t){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(t,n.tooltipFormat):r.format(t,n.displayFormats.datetime)}format(t,r){const s=this.options.time.displayFormats,i=this._unit,o=r||s[i];return this._adapter.format(t,o)}_tickFormatFunction(t,r,n,s){const i=this.options,o=i.ticks.callback;if(o)return Dt(o,[t,r,n],this);const l=i.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&l[c],f=u&&l[u],m=n[r],g=u&&f&&m&&m.major;return this._adapter.format(t,s||(g?f:h))}generateTickLabels(t){let r,n,s;for(r=0,n=t.length;r<n;++r)s=t[r],s.label=this._tickFormatFunction(s.value,r,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,n=this.ctx.measureText(t).width,s=Gi(this.isHorizontal()?r.maxRotation:r.minRotation),i=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:n*i+l*o,h:n*o+l*i}}_getLabelCapacity(t){const r=this.options.time,n=r.displayFormats,s=n[r.unit]||n.millisecond,i=this._tickFormatFunction(t,0,N4(this,[t],this._majorUnit),s),o=this._getLabelSize(i),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],r,n;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(r=0,n=s.length;r<n;++r)t=t.concat(s[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,n;if(t.length)return t;const s=this.getLabels();for(r=0,n=s.length;r<n;++r)t.push(O4(this,s[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return m6(t.sort(M4))}}Fe(i1,"id","time"),Fe(i1,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Zm(e,t,r){let n=0,s=e.length-1,i,o,l,c;r?(t>=e[n].pos&&t<=e[s].pos&&({lo:n,hi:s}=mc(e,"pos",t)),{pos:i,time:l}=e[n],{pos:o,time:c}=e[s]):(t>=e[n].time&&t<=e[s].time&&({lo:n,hi:s}=mc(e,"time",t)),{time:i,pos:l}=e[n],{time:o,pos:c}=e[s]);const u=o-i;return u?l+(c-l)*(t-i)/u:l}class L4 extends i1{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(t);this._minPos=Zm(r,this.min),this._tableRange=Zm(r,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:r,max:n}=this,s=[],i=[];let o,l,c,u,h;for(o=0,l=t.length;o<l;++o)u=t[o],u>=r&&u<=n&&s.push(u);if(s.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(o=0,l=s.length;o<l;++o)h=s[o+1],c=s[o-1],u=s[o],Math.round((h+c)/2)!==u&&i.push({time:u,pos:o/(l-1)});return i}_generate(){const t=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((s,i)=>s-i)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?t=this.normalize(r.concat(n)):t=r.length?r:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Zm(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return Zm(this._table,n*this._tableRange+this._minPos,!0)}}Fe(L4,"id","timeseries"),Fe(L4,"defaults",i1.defaults);const J6="label";function z4(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function xce(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function Z6(e,t){e.labels=t}function eM(e,t,r=J6){const n=[];e.datasets=t.map(s=>{const i=e.datasets.find(o=>o[r]===s[r]);return!i||!s.data||n.includes(i)?{...s}:(n.push(i),Object.assign(i,s),i)})}function vce(e,t=J6){const r={labels:[],datasets:[]};return Z6(r,e.labels),eM(r,e.datasets,t),r}function yce(e,t){const{height:r=150,width:n=300,redraw:s=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:f,...m}=e,g=E.useRef(null),v=E.useRef(null),x=()=>{g.current&&(v.current=new Rr(g.current,{type:o,data:vce(l,i),options:c&&{...c},plugins:u}),z4(t,v.current))},y=()=>{z4(t,null),v.current&&(v.current.destroy(),v.current=null)};return E.useEffect(()=>{!s&&v.current&&c&&xce(v.current,c)},[s,c]),E.useEffect(()=>{!s&&v.current&&Z6(v.current.config.data,l.labels)},[s,l.labels]),E.useEffect(()=>{!s&&v.current&&l.datasets&&eM(v.current.config.data,l.datasets,i)},[s,l.datasets]),E.useEffect(()=>{v.current&&(s?(y(),setTimeout(x)):v.current.update(f))},[s,c,l.labels,l.datasets,f]),E.useEffect(()=>{v.current&&(y(),setTimeout(x))},[o]),E.useEffect(()=>(x(),()=>y()),[]),a.jsx("canvas",{ref:g,role:"img",height:r,width:n,...m,children:h})}const bce=E.forwardRef(yce);function X1(e,t){return Rr.register(t),E.forwardRef((r,n)=>a.jsx(bce,{...r,ref:n,type:e}))}const Fl=X1("line",nx),In=X1("bar",rx),Qu=X1("doughnut",qd),Gk=X1("pie",k2);Rr.register(qr,Kr,Or,On,Rn,Mn,Xn);const _ce=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,wce=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,jce=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,kce=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Sce=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,s_=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,a_=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Cce=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,B4=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,$ce=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Tce=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,i_=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,o_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Ece=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;

  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,eg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,tg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,rg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Ace=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,ql=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,So=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Fce=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;

  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$percentage:e})=>e}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,l_=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Pce=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,ng={Ventas:"#4F46E5",Desarrollo:"#059669","Diseno Grafico":"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2","Sin asignar":"#6B7280"};function Dce({onNavigate:e}){const[t,r]=E.useState("all"),[n,s]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(!0),[u,h]=E.useState(null),[f,m]=E.useState(null),g=async()=>{c(!0),h(null);try{const k=await sa.getOTsPorUsuario({date_desde:n||void 0,date_hasta:i||void 0,area_id:t!=="all"?parseInt(t):void 0});m(k)}catch(k){console.error("Error fetching report data:",k),h("Error al cargar los datos del reporte. Intente nuevamente.")}finally{c(!1)}};E.useEffect(()=>{g()},[]);const v=()=>{g()},x=E.useMemo(()=>f?f.items.map(k=>({userId:k.usuario_id,userName:k.usuario_nombre,area:k.area_nombre,areaId:k.area_id,otsActivas:k.ots_activas,otsCompletadas:k.ots_completadas,totalOTs:k.total_ots,tiempoPromedioDias:k.tiempo_promedio})):[],[f]),y=E.useMemo(()=>({totalOTsActivas:x.reduce((k,M)=>k+M.otsActivas,0),totalCompletadas:x.reduce((k,M)=>k+M.otsCompletadas,0),totalOTs:(f==null?void 0:f.total_ots)||0,totalUsuarios:(f==null?void 0:f.total_usuarios)||0}),[x,f]),_=E.useMemo(()=>({labels:x.slice(0,10).map(k=>k.userName.split(" ")[0]),datasets:[{label:"OTs Activas",data:x.slice(0,10).map(k=>k.otsActivas),backgroundColor:"#60A5FA"},{label:"OTs Completadas",data:x.slice(0,10).map(k=>k.otsCompletadas),backgroundColor:"#34D399"}]}),[x]),b=E.useMemo(()=>{const k=x.reduce((A,O)=>{const F=O.area||"Sin asignar";return A[F]=(A[F]||0)+O.totalOTs,A},{}),M=Object.entries(k);return{labels:M.map(([A])=>A),datasets:[{data:M.map(([,A])=>A),backgroundColor:M.map(([A])=>ng[A]||"#6B7280")}]}},[x]),w={responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!1},y:{stacked:!1,beginAtZero:!0}}},C={responsive:!0,plugins:{legend:{position:"right"}}},j=Math.max(...x.map(k=>k.totalOTs),1),T=(f==null?void 0:f.areas)||[];return a.jsxs(_ce,{children:[a.jsx(wce,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(jce,{children:"OTs Activas por Usuario"}),a.jsx(kce,{children:a.jsxs(Sce,{children:[a.jsxs(s_,{children:[a.jsx(a_,{children:"Area"}),a.jsxs(Cce,{value:t,onChange:k=>r(k.target.value),children:[a.jsx("option",{value:"all",children:"Todas las Areas"}),T.map(k=>a.jsx("option",{value:k.id.toString(),children:k.nombre},k.id))]})]}),a.jsxs(s_,{children:[a.jsx(a_,{children:"Fecha Desde"}),a.jsx(B4,{type:"date",value:n,onChange:k=>s(k.target.value)})]}),a.jsxs(s_,{children:[a.jsx(a_,{children:"Fecha Hasta"}),a.jsx(B4,{type:"date",value:i,onChange:k=>o(k.target.value)})]}),a.jsx($ce,{$variant:"primary",onClick:v,disabled:l,children:l?"Cargando...":"Aplicar Filtros"})]})}),u&&a.jsx(Pce,{children:u}),l?a.jsx(l_,{children:"Cargando datos del reporte..."}):a.jsxs(a.Fragment,{children:[a.jsxs(Ece,{children:[a.jsxs(eg,{$color:d.colors.primary,children:[a.jsx(tg,{children:y.totalOTs}),a.jsx(rg,{children:"OTs Totales"})]}),a.jsxs(eg,{$color:"#60A5FA",children:[a.jsx(tg,{children:y.totalOTsActivas}),a.jsx(rg,{children:"OTs Activas"})]}),a.jsxs(eg,{$color:d.colors.success,children:[a.jsx(tg,{children:y.totalCompletadas}),a.jsx(rg,{children:"OTs Completadas"})]}),a.jsxs(eg,{$color:"#7C3AED",children:[a.jsx(tg,{children:y.totalUsuarios}),a.jsx(rg,{children:"Usuarios Activos"})]})]}),a.jsxs(Tce,{children:[a.jsxs(i_,{children:[a.jsx(o_,{children:"Top 10 Usuarios por OTs"}),x.length>0?a.jsx(In,{data:_,options:w}):a.jsx(l_,{children:"No hay datos para mostrar"})]}),a.jsxs(i_,{children:[a.jsx(o_,{children:"Distribucion por Area"}),x.length>0?a.jsx(Gk,{data:b,options:C}):a.jsx(l_,{children:"No hay datos para mostrar"})]})]}),a.jsxs(i_,{children:[a.jsxs(o_,{children:["Detalle por Usuario (",x.length," registros)"]}),a.jsxs(Ace,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ql,{children:"Usuario"}),a.jsx(ql,{children:"Area"}),a.jsx(ql,{children:"OTs Totales"}),a.jsx(ql,{children:"Activas"}),a.jsx(ql,{children:"Completadas"}),a.jsx(ql,{children:"Tiempo Prom. (dias)"}),a.jsx(ql,{style:{width:"150px"},children:"Carga"})]})}),a.jsx("tbody",{children:x.length===0?a.jsx("tr",{children:a.jsx(So,{colSpan:7,style:{textAlign:"center"},children:"No hay datos disponibles para los filtros seleccionados"})}):x.map(k=>a.jsxs("tr",{children:[a.jsx(So,{style:{fontWeight:500},children:k.userName}),a.jsx(So,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${ng[k.area]||"#6B7280"}20`,color:ng[k.area]||"#6B7280"},children:k.area})}),a.jsx(So,{style:{fontWeight:600},children:k.totalOTs}),a.jsx(So,{children:k.otsActivas}),a.jsx(So,{children:k.otsCompletadas}),a.jsx(So,{children:k.tiempoPromedioDias.toFixed(1)}),a.jsx(So,{children:a.jsx(Fce,{$percentage:k.totalOTs/j*100,$color:ng[k.area]||d.colors.primary})})]},`${k.userId}-${k.areaId}`))})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,On,Rn,Mn,Yu);const Mce=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Oce=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Rce=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Ice=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Nce=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,U4=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,V4=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,H4=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,c_=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Lce=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,sg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,ag=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,ig=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,zce=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,W4=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,G4=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Bce=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Kl=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Co=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Uce=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Vce=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Hce=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`;function Wce({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(1),[l,c]=E.useState(!0),[u,h]=E.useState(null),[f,m]=E.useState(null),g=async()=>{c(!0),h(null);try{const _=await sa.getOTsCompletadas({page:i,page_size:20,date_desde:t||void 0,date_hasta:n||void 0});m(_)}catch(_){console.error("Error fetching report:",_),h("Error al cargar los datos del reporte.")}finally{c(!1)}};E.useEffect(()=>{g()},[i]);const v=()=>{o(1),g()},x=E.useMemo(()=>{if(!f)return null;const _=[{label:"0-3 dias",min:0,max:3,color:d.colors.success},{label:"4-7 dias",min:4,max:7,color:"#60A5FA"},{label:"8-15 dias",min:8,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],b=_.map(w=>f.items.filter(C=>C.tiempo_total>=w.min&&C.tiempo_total<=w.max).length);return{labels:_.map(w=>w.label),datasets:[{label:"OTs por Tiempo",data:b,backgroundColor:_.map(w=>w.color)}]}},[f]),y={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(Mce,{children:[a.jsx(Oce,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Rce,{children:"OTs Completadas"}),a.jsx(Ice,{children:a.jsxs(Nce,{children:[a.jsxs(U4,{children:[a.jsx(V4,{children:"Desde"}),a.jsx(H4,{type:"date",value:t,onChange:_=>r(_.target.value)})]}),a.jsxs(U4,{children:[a.jsx(V4,{children:"Hasta"}),a.jsx(H4,{type:"date",value:n,onChange:_=>s(_.target.value)})]}),a.jsx(c_,{$variant:"primary",onClick:v,disabled:l,children:l?"Cargando...":"Filtrar"})]})}),u&&a.jsx(Vce,{children:u}),l?a.jsx(Uce,{children:"Cargando datos del reporte..."}):f&&a.jsxs(a.Fragment,{children:[a.jsxs(Lce,{children:[a.jsxs(sg,{$color:d.colors.success,children:[a.jsx(ag,{children:f.resumen.total_completadas}),a.jsx(ig,{children:"Total Completadas"})]}),a.jsxs(sg,{$color:d.colors.primary,children:[a.jsxs(ag,{children:[f.resumen.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(ig,{children:"Tiempo Promedio"})]}),a.jsxs(sg,{$color:"#60A5FA",children:[a.jsxs(ag,{children:[f.resumen.tiempo_minimo.toFixed(1)," dias"]}),a.jsx(ig,{children:"Tiempo Minimo"})]}),a.jsxs(sg,{$color:d.colors.warning,children:[a.jsxs(ag,{children:[f.resumen.tiempo_maximo.toFixed(1)," dias"]}),a.jsx(ig,{children:"Tiempo Maximo"})]})]}),a.jsx(zce,{children:x&&a.jsxs(W4,{children:[a.jsx(G4,{children:"Distribucion por Tiempo de Completado"}),a.jsx(In,{data:x,options:y})]})}),a.jsxs(W4,{children:[a.jsxs(G4,{children:["OTs Completadas (",f.total," registros)"]}),a.jsxs(Bce,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Kl,{children:"OT ID"}),a.jsx(Kl,{children:"Cliente"}),a.jsx(Kl,{children:"Descripcion"}),a.jsx(Kl,{children:"Creacion"}),a.jsx(Kl,{children:"Completada"}),a.jsx(Kl,{children:"Tiempo (dias)"}),a.jsx(Kl,{children:"Estado"})]})}),a.jsx("tbody",{children:f.items.length===0?a.jsx("tr",{children:a.jsx(Co,{colSpan:7,style:{textAlign:"center"},children:"No hay OTs completadas en el periodo seleccionado"})}):f.items.map(_=>{var b;return a.jsxs("tr",{children:[a.jsxs(Co,{style:{fontWeight:600},children:["#",_.id]}),a.jsx(Co,{children:_.client_name||"Sin cliente"}),a.jsxs(Co,{children:[((b=_.descripcion)==null?void 0:b.substring(0,40))||"-","..."]}),a.jsx(Co,{children:_.created_at}),a.jsx(Co,{children:_.completed_at}),a.jsx(Co,{style:{fontWeight:600,color:_.tiempo_total<=5?d.colors.success:_.tiempo_total<=10?d.colors.warning:d.colors.danger},children:_.tiempo_total.toFixed(1)}),a.jsx(Co,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${d.colors.success}20`,color:d.colors.success},children:_.estado})})]},_.id)})})]}),f.total_pages>1&&a.jsxs(Hce,{children:[a.jsx(c_,{onClick:()=>o(_=>Math.max(1,_-1)),disabled:i===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",i," de ",f.total_pages]}),a.jsx(c_,{onClick:()=>o(_=>Math.min(f.total_pages,_+1)),disabled:i===f.total_pages,children:"Siguiente"})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,On,Rn,Mn);const Gce=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,qce=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Kce=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Xce=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Yce=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Qce=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Jce=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Zce=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,ede=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,tde=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
`,rde=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,nde=p.div`
  font-size: 1.5rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,sde=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,ade=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,A2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,ide=p(A2)`
  grid-column: 1 / -1;
`,d_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,ode=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,og=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,qh=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,lde=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,cde=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Kh={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function dde({onNavigate:e}){const[t,r]=E.useState(new Date().getFullYear()),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),u=async()=>{s(!0),o(null);try{const x=await sa.getTiempoPorArea(t);c(x)}catch(x){console.error("Error fetching report:",x),o("Error al cargar los datos del reporte.")}finally{s(!1)}};E.useEffect(()=>{u()},[t]);const h=E.useMemo(()=>{if(!l)return[];const x={};return l.items.forEach(y=>{x[y.area_nombre]||(x[y.area_nombre]={total_tiempo:0,total_ots:0,count:0}),x[y.area_nombre].total_tiempo+=y.tiempo_promedio*y.total_ots,x[y.area_nombre].total_ots+=y.total_ots,x[y.area_nombre].count++}),Object.entries(x).map(([y,_])=>({area:y,tiempoPromedio:_.total_ots>0?_.total_tiempo/_.total_ots:0,totalOTs:_.total_ots}))},[l]),f=E.useMemo(()=>h.length?{labels:h.map(x=>x.area),datasets:[{label:"Tiempo Promedio (dias)",data:h.map(x=>x.tiempoPromedio),backgroundColor:h.map(x=>Kh[x.area]||"#6B7280")}]}:null,[h]),m=E.useMemo(()=>{if(!l)return null;const x=[...new Set(l.items.map(y=>y.area_nombre))];return{labels:l.meses,datasets:x.map(y=>({label:y,data:l.meses.map(_=>{const b=l.items.find(w=>w.mes===_&&w.area_nombre===y);return(b==null?void 0:b.tiempo_promedio)||0}),borderColor:Kh[y]||"#6B7280",backgroundColor:`${Kh[y]||"#6B7280"}20`,tension:.3}))}},[l]),g={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}},v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}};return a.jsxs(Gce,{children:[a.jsx(qce,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Kce,{children:"Tiempo Promedio por Area"}),a.jsx(Xce,{children:a.jsxs(Yce,{children:[a.jsxs(Qce,{children:[a.jsx(Jce,{children:"Ano"}),a.jsx(Zce,{value:t,onChange:x=>r(Number(x.target.value)),children:[2024,2023,2022,2021].map(x=>a.jsx("option",{value:x,children:x},x))})]}),a.jsx(ede,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),i&&a.jsx(cde,{children:i}),n?a.jsx(lde,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsx(tde,{children:h.map(x=>a.jsxs(rde,{$color:Kh[x.area]||"#6B7280",children:[a.jsxs(nde,{children:[x.tiempoPromedio.toFixed(1)," dias"]}),a.jsxs(sde,{children:[x.area," (",x.totalOTs," OTs)"]})]},x.area))}),a.jsxs(ade,{children:[f&&a.jsxs(A2,{children:[a.jsx(d_,{children:"Tiempo Promedio por Area"}),a.jsx(In,{data:f,options:g})]}),m&&m.datasets.length>0&&a.jsxs(A2,{children:[a.jsx(d_,{children:"Evolucion Mensual"}),a.jsx(Fl,{data:m,options:v})]})]}),a.jsxs(ide,{children:[a.jsx(d_,{children:"Detalle por Area y Mes"}),a.jsxs(ode,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(og,{children:"Mes"}),a.jsx(og,{children:"Area"}),a.jsx(og,{children:"Tiempo Promedio"}),a.jsx(og,{children:"OTs Procesadas"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(qh,{colSpan:4,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.items.map((x,y)=>a.jsxs("tr",{children:[a.jsx(qh,{style:{fontWeight:600},children:x.mes}),a.jsxs(qh,{children:[a.jsx("span",{style:{display:"inline-block",width:"10px",height:"10px",borderRadius:"50%",backgroundColor:Kh[x.area_nombre]||"#6B7280",marginRight:"0.5rem"}}),x.area_nombre]}),a.jsxs(qh,{style:{fontWeight:600},children:[x.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(qh,{children:x.total_ots})]},y))})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn,Yu);const ude=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,hde=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,fde=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,pde=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,mde=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,gde=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,xde=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,vde=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,yde=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,bde=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,lg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,cg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,dg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,q4=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,K4=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,Xh=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Yh=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,_de=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,u_=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,ug=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,wde=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,jde=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
`,kde=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,Sde=p.span`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
`,Cde=p.span`
  font-size: 0.875rem;
  font-weight: 600;
  color: ${d.colors.danger};
`,$de=p.div`
  flex: 1;
  margin: 0 1rem;
  height: 8px;
  background: white;
  border-radius: 4px;
  overflow: hidden;
`,Tde=p.div`
  height: 100%;
  width: ${({$width:e})=>e}%;
  background: ${({$color:e})=>e};
  border-radius: 4px;
`,Ede=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Ade=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,h_={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Fde({onNavigate:e}){var C,j,T,k,M;const[t,r]=E.useState(new Date().getFullYear()),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),u=async()=>{s(!0),o(null);try{const A=await sa.getRechazosMes(t);c(A)}catch(A){console.error("Error fetching report:",A),o("Error al cargar los datos del reporte.")}finally{s(!1)}};E.useEffect(()=>{u()},[t]);const h=E.useMemo(()=>{if(!l)return[];const A={};return l.items.forEach(O=>{A[O.mes]||(A[O.mes]=0),A[O.mes]+=O.total_rechazos}),Object.entries(A).map(([O,F])=>({mes:O,rechazos:F}))},[l]),f=E.useMemo(()=>h.length?{labels:h.map(A=>A.mes),datasets:[{label:"Rechazos",data:h.map(A=>A.rechazos),backgroundColor:d.colors.danger}]}:null,[h]),m=E.useMemo(()=>h.length?{labels:h.map(A=>A.mes),datasets:[{label:"Rechazos por Mes",data:h.map(A=>A.rechazos),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.3}]}:null,[h]),g=E.useMemo(()=>{var A;return(A=l==null?void 0:l.por_area)!=null&&A.length?{labels:l.por_area.map(O=>O.area),datasets:[{data:l.por_area.map(O=>O.cantidad),backgroundColor:l.por_area.map(O=>h_[O.area]||"#6B7280"),borderWidth:0}]}:null},[l]),v={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad"}}}},x={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}},y={responsive:!0,plugins:{legend:{position:"right"}}},_=(C=l==null?void 0:l.por_area)!=null&&C.length?Math.max(...l.por_area.map(A=>A.cantidad)):0,b=E.useMemo(()=>{var F,B;if(h.length<2)return"stable";const A=((F=h[h.length-1])==null?void 0:F.rechazos)||0,O=((B=h[h.length-2])==null?void 0:B.rechazos)||0;return A<O?"down":A>O?"up":"stable"},[h]),w=h.length>0?h[h.length-1].rechazos:0;return a.jsxs(ude,{children:[a.jsx(hde,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(fde,{children:"Rechazos por Mes"}),a.jsx(pde,{children:a.jsxs(mde,{children:[a.jsxs(gde,{children:[a.jsx(xde,{children:"Ano"}),a.jsx(vde,{value:t,onChange:A=>r(Number(A.target.value)),children:[2024,2023,2022,2021].map(A=>a.jsx("option",{value:A,children:A},A))})]}),a.jsx(yde,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),i&&a.jsx(Ade,{children:i}),n?a.jsx(Ede,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(bde,{children:[a.jsxs(lg,{$color:d.colors.danger,children:[a.jsx(cg,{children:l.total_rechazos}),a.jsx(dg,{children:"Total Rechazos (Ano)"})]}),a.jsxs(lg,{$color:d.colors.warning,children:[a.jsx(cg,{children:l.promedio_mensual.toFixed(1)}),a.jsx(dg,{children:"Promedio Mensual"})]}),a.jsxs(lg,{$color:b==="down"?d.colors.success:d.colors.danger,children:[a.jsx(cg,{children:w}),a.jsx(dg,{children:"Rechazos Ultimo Mes"}),a.jsx(q4,{children:b==="down"?" Mejorando":b==="up"?" Aumentando":" Estable"})]}),a.jsxs(lg,{$color:d.colors.primary,children:[a.jsx(cg,{children:((k=(T=(j=l.por_area)==null?void 0:j[0])==null?void 0:T.area)==null?void 0:k.split(" ")[0])||"-"}),a.jsx(dg,{children:"Area con mas Rechazos"}),a.jsx(q4,{children:(M=l.por_area)!=null&&M[0]?`${l.por_area[0].cantidad} casos`:""})]})]}),a.jsxs(K4,{children:[f&&a.jsxs(Xh,{children:[a.jsx(Yh,{children:"Rechazos por Mes"}),a.jsx(In,{data:f,options:v})]}),g&&a.jsxs(Xh,{children:[a.jsx(Yh,{children:"Distribucion por Area"}),a.jsx(Qu,{data:g,options:y})]})]}),a.jsxs(K4,{children:[m&&a.jsxs(Xh,{children:[a.jsx(Yh,{children:"Tendencia de Rechazos"}),a.jsx(Fl,{data:m,options:x})]}),l.por_area&&l.por_area.length>0&&a.jsxs(Xh,{children:[a.jsx(Yh,{children:"Rechazos por Area"}),a.jsx(jde,{children:l.por_area.map(A=>a.jsxs(kde,{children:[a.jsx(Sde,{children:A.area}),a.jsx($de,{children:a.jsx(Tde,{$width:A.cantidad/_*100,$color:h_[A.area]||"#6B7280"})}),a.jsx(Cde,{children:A.cantidad})]},A.area))})]})]}),a.jsxs(Xh,{children:[a.jsx(Yh,{children:"Detalle por Mes y Area"}),a.jsxs(_de,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(u_,{children:"Mes"}),a.jsx(u_,{children:"Area"}),a.jsx(u_,{children:"Rechazos"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(ug,{colSpan:3,style:{textAlign:"center"},children:"No hay datos de rechazos para el ano seleccionado"})}):l.items.map((A,O)=>a.jsxs("tr",{children:[a.jsx(ug,{style:{fontWeight:600},children:A.mes}),a.jsx(ug,{children:a.jsx(wde,{$color:h_[A.area_nombre||""]||"#6B7280",children:A.area_nombre||"Sin area"})}),a.jsx(ug,{style:{fontWeight:600,color:d.colors.danger},children:A.total_rechazos})]},O))})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,On,Rn,Mn,Yu);const Pde=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Dde=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Mde=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Ode=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Rde=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Ide=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Nde=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Lde=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,zde=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Bde=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,hg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,fg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,pg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Ude=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,F2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Vde=p(F2)`
  grid-column: 1 / -1;
`,f_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Hde=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Td=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Xl=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Wde=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Gde=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,qde=p.span`
  font-size: 0.75rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  background: ${({$trend:e})=>e==="up"?`${d.colors.success}20`:e==="down"?`${d.colors.danger}20`:`${d.colors.textSecondary}20`};
  color: ${({$trend:e})=>e==="up"?d.colors.success:e==="down"?d.colors.danger:d.colors.textSecondary};
`;function Kde({onNavigate:e}){const[t,r]=E.useState(new Date().getFullYear()),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),u=async()=>{s(!0),o(null);try{const y=await sa.getCargaMensual(t);c(y)}catch(y){console.error("Error fetching report:",y),o("Error al cargar los datos del reporte.")}finally{s(!1)}};E.useEffect(()=>{u()},[t]);const h=E.useMemo(()=>{if(!l)return[];let y=0;return l.items.map(_=>(y+=_.total_ots-_.ots_completadas,{..._,pendientesAcum:Math.max(0,y),balance:_.total_ots-_.ots_completadas}))},[l]),f=E.useMemo(()=>h.length?{labels:h.map(y=>y.mes),datasets:[{label:"OTs Nuevas",data:h.map(y=>y.ots_nuevas),backgroundColor:d.colors.primary},{label:"OTs Completadas",data:h.map(y=>y.ots_completadas),backgroundColor:d.colors.success}]}:null,[h]),m=E.useMemo(()=>h.length?{labels:h.map(y=>y.mes),datasets:[{label:"OTs Activas",data:h.map(y=>y.ots_activas),borderColor:"#7C3AED",backgroundColor:"#7C3AED20",fill:!0,tension:.3},{label:"Pendientes Acum.",data:h.map(y=>y.pendientesAcum),borderColor:d.colors.warning,backgroundColor:`${d.colors.warning}20`,fill:!0,tension:.3}]}:null,[h]),g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},x=y=>y<0?"up":y>5?"down":"stable";return a.jsxs(Pde,{children:[a.jsx(Dde,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Mde,{children:"Carga de OTs por Mes"}),a.jsx(Ode,{children:a.jsxs(Rde,{children:[a.jsxs(Ide,{children:[a.jsx(Nde,{children:"Ano"}),a.jsx(Lde,{value:t,onChange:y=>r(Number(y.target.value)),children:[2024,2023,2022].map(y=>a.jsx("option",{value:y,children:y},y))})]}),a.jsx(zde,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),i&&a.jsx(Gde,{children:i}),n?a.jsx(Wde,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(Bde,{children:[a.jsxs(hg,{$color:d.colors.primary,children:[a.jsx(fg,{children:l.total_anual}),a.jsx(pg,{children:"OTs Totales (Ano)"})]}),a.jsxs(hg,{$color:d.colors.success,children:[a.jsx(fg,{children:l.items.reduce((y,_)=>y+_.ots_completadas,0)}),a.jsx(pg,{children:"OTs Completadas (Ano)"})]}),a.jsxs(hg,{$color:"#7C3AED",children:[a.jsx(fg,{children:l.promedio_mensual.toFixed(0)}),a.jsx(pg,{children:"Promedio Mensual"})]}),a.jsxs(hg,{$color:d.colors.warning,children:[a.jsx(fg,{children:h.length>0?h[h.length-1].ots_activas:0}),a.jsx(pg,{children:"OTs Activas Actuales"})]})]}),a.jsxs(Ude,{children:[f&&a.jsxs(F2,{children:[a.jsx(f_,{children:"OTs Creadas vs Completadas"}),a.jsx(In,{data:f,options:g})]}),m&&a.jsxs(F2,{children:[a.jsx(f_,{children:"Tendencia de Carga"}),a.jsx(Fl,{data:m,options:v})]})]}),a.jsxs(Vde,{children:[a.jsx(f_,{children:"Detalle Mensual"}),a.jsxs(Hde,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Td,{children:"Mes"}),a.jsx(Td,{children:"OTs Nuevas"}),a.jsx(Td,{children:"OTs Completadas"}),a.jsx(Td,{children:"Balance"}),a.jsx(Td,{children:"OTs Activas"}),a.jsx(Td,{children:"Tendencia"})]})}),a.jsx("tbody",{children:h.length===0?a.jsx("tr",{children:a.jsx(Xl,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):h.map(y=>a.jsxs("tr",{children:[a.jsx(Xl,{style:{fontWeight:600},children:y.mes}),a.jsx(Xl,{children:y.ots_nuevas}),a.jsx(Xl,{children:y.ots_completadas}),a.jsxs(Xl,{style:{color:y.balance>0?d.colors.danger:d.colors.success},children:[y.balance>0?"+":"",y.balance]}),a.jsx(Xl,{children:y.ots_activas}),a.jsx(Xl,{children:a.jsx(qde,{$trend:x(y.balance),children:x(y.balance)==="up"?" Eficiente":x(y.balance)==="down"?" Acumulando":" Estable"})})]},y.mes))})]})]})]})]})}Rr.register(qr,Kr,Or,Xn,On,Rn,Mn);const Xde=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Yde=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Qde=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Jde=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Zde=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,X4=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Y4=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Q4=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,p_=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,eue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,mg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,gg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,xg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,tue=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,m_=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,g_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,rue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ed=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Yl=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,nue=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,sue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,aue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,iue=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,J4={"Cancelacion del cliente":"#DC2626","Error en especificaciones":"#D97706",Duplicado:"#7C3AED","Cambio de prioridades":"#059669",Otros:"#6B7280"};function oue({onNavigate:e}){var j,T;const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(1),[l,c]=E.useState(!0),[u,h]=E.useState(null),[f,m]=E.useState(null),g=async()=>{c(!0),h(null);try{const k=await sa.getAnulaciones({page:i,page_size:20,date_desde:t||void 0,date_hasta:n||void 0});m(k)}catch(k){console.error("Error fetching report:",k),h("Error al cargar los datos del reporte.")}finally{c(!1)}};E.useEffect(()=>{g()},[i]);const v=()=>{o(1),g()},x=E.useMemo(()=>{if(!f)return[];const k={};return f.items.forEach(M=>{const A=M.motivo||"Otros";k[A]||(k[A]=0),k[A]++}),Object.entries(k).map(([M,A])=>({motivo:M,cantidad:A})).sort((M,A)=>A.cantidad-M.cantidad)},[f]),y=E.useMemo(()=>{var M;return(M=f==null?void 0:f.por_mes)!=null&&M.length?(f.por_mes.reduce((A,O)=>A+O.cantidad,0)/f.por_mes.length).toFixed(1):0},[f]),_=E.useMemo(()=>{var k;return(k=f==null?void 0:f.por_mes)!=null&&k.length?{labels:f.por_mes.map(M=>M.mes),datasets:[{label:"Anulaciones",data:f.por_mes.map(M=>M.cantidad),backgroundColor:d.colors.danger}]}:null},[f]),b=E.useMemo(()=>x.length?{labels:x.map(k=>k.motivo),datasets:[{data:x.map(k=>k.cantidad),backgroundColor:x.map(k=>J4[k.motivo]||"#6B7280"),borderWidth:0}]}:null,[x]),w=((j=x[0])==null?void 0:j.motivo)||"-",C=(T=f==null?void 0:f.por_mes)!=null&&T.length?f.por_mes[f.por_mes.length-1].cantidad:0;return a.jsxs(Xde,{children:[a.jsx(Yde,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Qde,{children:"Anulaciones de OTs"}),a.jsx(Jde,{children:a.jsxs(Zde,{children:[a.jsxs(X4,{children:[a.jsx(Y4,{children:"Desde"}),a.jsx(Q4,{type:"date",value:t,onChange:k=>r(k.target.value)})]}),a.jsxs(X4,{children:[a.jsx(Y4,{children:"Hasta"}),a.jsx(Q4,{type:"date",value:n,onChange:k=>s(k.target.value)})]}),a.jsx(p_,{$variant:"primary",onClick:v,disabled:l,children:l?"Cargando...":"Filtrar"})]})}),u&&a.jsx(aue,{children:u}),l?a.jsx(sue,{children:"Cargando datos del reporte..."}):f&&a.jsxs(a.Fragment,{children:[a.jsxs(eue,{children:[a.jsxs(mg,{$color:d.colors.danger,children:[a.jsx(gg,{children:f.total}),a.jsx(xg,{children:"Total Anulaciones"})]}),a.jsxs(mg,{$color:d.colors.warning,children:[a.jsx(gg,{children:y}),a.jsx(xg,{children:"Promedio Mensual"})]}),a.jsxs(mg,{$color:d.colors.primary,children:[a.jsx(gg,{children:C}),a.jsx(xg,{children:"Ultimo Mes"})]}),a.jsxs(mg,{$color:"#7C3AED",children:[a.jsx(gg,{children:w.split(" ")[0]}),a.jsx(xg,{children:"Motivo Principal"})]})]}),a.jsxs(tue,{children:[_&&a.jsxs(m_,{children:[a.jsx(g_,{children:"Anulaciones por Mes"}),a.jsx(In,{data:_,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),b&&a.jsxs(m_,{children:[a.jsx(g_,{children:"Distribucion por Motivo"}),a.jsx(Qu,{data:b,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]})]}),a.jsxs(m_,{children:[a.jsxs(g_,{children:["Ultimas Anulaciones (",f.total," registros)"]}),a.jsxs(rue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ed,{children:"OT ID"}),a.jsx(Ed,{children:"Cliente"}),a.jsx(Ed,{children:"Descripcion"}),a.jsx(Ed,{children:"Motivo"}),a.jsx(Ed,{children:"Fecha"}),a.jsx(Ed,{children:"Usuario"})]})}),a.jsx("tbody",{children:f.items.length===0?a.jsx("tr",{children:a.jsx(Yl,{colSpan:6,style:{textAlign:"center"},children:"No hay anulaciones en el periodo seleccionado"})}):f.items.map(k=>{var M;return a.jsxs("tr",{children:[a.jsxs(Yl,{style:{fontWeight:600},children:["#",k.id]}),a.jsx(Yl,{children:k.client_name||"Sin cliente"}),a.jsxs(Yl,{children:[((M=k.descripcion)==null?void 0:M.substring(0,40))||"-","..."]}),a.jsx(Yl,{children:a.jsx(nue,{$color:J4[k.motivo||"Otros"]||"#6B7280",children:k.motivo||"Sin motivo"})}),a.jsx(Yl,{children:k.fecha}),a.jsx(Yl,{children:k.usuario})]},k.id)})})]}),f.total_pages>1&&a.jsxs(iue,{children:[a.jsx(p_,{onClick:()=>o(k=>Math.max(1,k-1)),disabled:i===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",i," de ",f.total_pages]}),a.jsx(p_,{onClick:()=>o(k=>Math.min(f.total_pages,k+1)),disabled:i===f.total_pages,children:"Siguiente"})]})]})]})]})}Rr.register(qr,Kr,Or,jr,Fn,On,Rn,Mn);const lue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,cue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,due=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,uue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,hue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,vg=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,yg=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,x_=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,fue=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Z4=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
`,pue=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Qh=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Jh=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Zh=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,mue=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,bg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,_g=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,eA=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,os=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,ls=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,v_=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,gue=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,$o=[{week:"Sem 1",completadas:45,enPlazo:38,fueraPlazo:7},{week:"Sem 2",completadas:52,enPlazo:44,fueraPlazo:8},{week:"Sem 3",completadas:48,enPlazo:42,fueraPlazo:6},{week:"Sem 4",completadas:55,enPlazo:50,fueraPlazo:5}],xue=[{area:"Diseno Grafico",completadas:85,porcentaje:42.5},{area:"Diseno Estructural",completadas:45,porcentaje:22.5},{area:"Pre-Prensa",completadas:35,porcentaje:17.5},{area:"Cotizaciones",completadas:25,porcentaje:12.5},{area:"Sala de Muestras",completadas:10,porcentaje:5}],y_=[{otId:10520,cliente:"Via Santa Rita",producto:"Caja Vino Premium",area:"Diseno Grafico",fechaCreacion:"2024-12-01",fechaCompletada:"2024-12-15",diasProceso:14,enPlazo:!0,usuario:"Juan Perez"},{otId:10518,cliente:"Nestle Chile",producto:"Display Navidad",area:"Pre-Prensa",fechaCreacion:"2024-12-03",fechaCompletada:"2024-12-14",diasProceso:11,enPlazo:!0,usuario:"Maria Garcia"},{otId:10515,cliente:"CCU",producto:"Pack Cerveza 6",area:"Diseno Estructural",fechaCreacion:"2024-12-02",fechaCompletada:"2024-12-18",diasProceso:16,enPlazo:!1,usuario:"Carlos Rodriguez"},{otId:10512,cliente:"Unilever",producto:"Caja Shampoo",area:"Cotizaciones",fechaCreacion:"2024-12-05",fechaCompletada:"2024-12-12",diasProceso:7,enPlazo:!0,usuario:"Ana Martinez"},{otId:10508,cliente:"Coca-Cola",producto:"Bandeja Promocional",area:"Diseno Grafico",fechaCreacion:"2024-12-01",fechaCompletada:"2024-12-10",diasProceso:9,enPlazo:!0,usuario:"Pedro Lopez"},{otId:10505,cliente:"Soprole",producto:"Caja Yogurt",area:"Pre-Prensa",fechaCreacion:"2024-11-28",fechaCompletada:"2024-12-15",diasProceso:17,enPlazo:!1,usuario:"Laura Sanchez"}],b_={"Diseno Grafico":"#4F46E5","Diseno Estructural":"#059669","Pre-Prensa":"#D97706",Cotizaciones:"#7C3AED","Sala de Muestras":"#DC2626"};function vue({onNavigate:e}){const[t,r]=E.useState("2024-12-01"),[n,s]=E.useState("2024-12-31"),[i,o]=E.useState("todas"),[l,c]=E.useState(""),u=$o.reduce((y,_)=>y+_.completadas,0),h=$o.reduce((y,_)=>y+_.enPlazo,0),f=$o.reduce((y,_)=>y+_.fueraPlazo,0),m=(h/u*100).toFixed(1),g=(y_.reduce((y,_)=>y+_.diasProceso,0)/y_.length).toFixed(1),v={labels:$o.map(y=>y.week),datasets:[{label:"En Plazo",data:$o.map(y=>y.enPlazo),backgroundColor:d.colors.success},{label:"Fuera de Plazo",data:$o.map(y=>y.fueraPlazo),backgroundColor:d.colors.danger}]},x={labels:$o.map(y=>y.week),datasets:[{label:"OTs Completadas",data:$o.map(y=>y.completadas),borderColor:d.colors.primary,backgroundColor:`${d.colors.primary}20`,fill:!0,tension:.4}]};return a.jsxs(lue,{children:[a.jsx(cue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(due,{children:"OTs Completadas Entre Fechas"}),a.jsx(uue,{children:a.jsxs(hue,{children:[a.jsxs(vg,{children:[a.jsx(yg,{children:"Fecha Desde"}),a.jsx(x_,{type:"date",value:t,onChange:y=>r(y.target.value)})]}),a.jsxs(vg,{children:[a.jsx(yg,{children:"Fecha Hasta"}),a.jsx(x_,{type:"date",value:n,onChange:y=>s(y.target.value)})]}),a.jsxs(vg,{children:[a.jsx(yg,{children:"Area"}),a.jsxs(fue,{value:i,onChange:y=>o(y.target.value),children:[a.jsx("option",{value:"todas",children:"Todas las Areas"}),a.jsx("option",{value:"diseno-grafico",children:"Diseno Grafico"}),a.jsx("option",{value:"diseno-estructural",children:"Diseno Estructural"}),a.jsx("option",{value:"pre-prensa",children:"Pre-Prensa"}),a.jsx("option",{value:"cotizaciones",children:"Cotizaciones"}),a.jsx("option",{value:"sala-muestras",children:"Sala de Muestras"})]})]}),a.jsxs(vg,{children:[a.jsx(yg,{children:"Cliente"}),a.jsx(x_,{type:"text",placeholder:"Buscar cliente...",value:l,onChange:y=>c(y.target.value)})]}),a.jsx(Z4,{$variant:"primary",children:"Filtrar"}),a.jsx(Z4,{children:"Exportar Excel"})]})}),a.jsxs(pue,{children:[a.jsxs(Qh,{$color:d.colors.primary,children:[a.jsx(Jh,{children:u}),a.jsx(Zh,{children:"Total Completadas"})]}),a.jsxs(Qh,{$color:d.colors.success,children:[a.jsx(Jh,{children:h}),a.jsx(Zh,{children:"En Plazo"})]}),a.jsxs(Qh,{$color:d.colors.danger,children:[a.jsx(Jh,{children:f}),a.jsx(Zh,{children:"Fuera de Plazo"})]}),a.jsxs(Qh,{$color:d.colors.warning,children:[a.jsxs(Jh,{children:[m,"%"]}),a.jsx(Zh,{children:"% Cumplimiento"})]}),a.jsxs(Qh,{$color:"#7C3AED",children:[a.jsx(Jh,{children:g}),a.jsx(Zh,{children:"Dias Promedio"})]})]}),a.jsxs(mue,{children:[a.jsxs(bg,{children:[a.jsx(_g,{children:"Completadas por Semana"}),a.jsx(In,{data:v,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}})]}),a.jsxs(bg,{children:[a.jsx(_g,{children:"Tendencia de Completadas"}),a.jsx(Fl,{data:x,options:{responsive:!0,plugins:{legend:{display:!1}}}})]})]}),a.jsxs(bg,{style:{marginBottom:"1.5rem"},children:[a.jsx(_g,{children:"Distribucion por Area"}),a.jsxs(eA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(os,{children:"Area"}),a.jsx(os,{children:"Completadas"}),a.jsx(os,{children:"Porcentaje"}),a.jsx(os,{style:{width:"40%"},children:"Progreso"})]})}),a.jsx("tbody",{children:xue.map(y=>a.jsxs("tr",{children:[a.jsx(ls,{children:a.jsx(v_,{$color:b_[y.area]||"#6B7280",children:y.area})}),a.jsx(ls,{style:{fontWeight:600},children:y.completadas}),a.jsxs(ls,{children:[y.porcentaje,"%"]}),a.jsx(ls,{children:a.jsx(gue,{$value:y.porcentaje*2,$color:b_[y.area]||"#6B7280"})})]},y.area))})]})]}),a.jsxs(bg,{children:[a.jsx(_g,{children:"Detalle de OTs Completadas"}),a.jsxs(eA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(os,{children:"OT ID"}),a.jsx(os,{children:"Cliente"}),a.jsx(os,{children:"Producto"}),a.jsx(os,{children:"Area"}),a.jsx(os,{children:"Creacion"}),a.jsx(os,{children:"Completada"}),a.jsx(os,{children:"Dias"}),a.jsx(os,{children:"Estado"}),a.jsx(os,{children:"Usuario"})]})}),a.jsx("tbody",{children:y_.map(y=>a.jsxs("tr",{children:[a.jsxs(ls,{style:{fontWeight:600},children:["#",y.otId]}),a.jsx(ls,{children:y.cliente}),a.jsx(ls,{children:y.producto}),a.jsx(ls,{children:a.jsx(v_,{$color:b_[y.area]||"#6B7280",children:y.area})}),a.jsx(ls,{children:y.fechaCreacion}),a.jsx(ls,{children:y.fechaCompletada}),a.jsx(ls,{style:{fontWeight:600},children:y.diasProceso}),a.jsx(ls,{children:a.jsx(v_,{$color:y.enPlazo?d.colors.success:d.colors.danger,children:y.enPlazo?"En Plazo":"Fuera Plazo"})}),a.jsx(ls,{children:y.usuario})]},y.otId))})]})]})]})}Rr.register(qr,Kr,Or,Xn,On,Rn,Mn);const yue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,bue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,_ue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,wue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,jue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,kue=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Sue=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,ef=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,tf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,rf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Cue=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,__=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,w_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,$ue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,nf=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Ad=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Tue=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,Eue=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  ${({$level:e})=>{switch(e){case"critical":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.success}20; color: ${d.colors.success};`}}}
`,Aue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Fue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,tA={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Pue({onNavigate:e}){var g,v,x;const[t,r]=E.useState(!0),[n,s]=E.useState(null),[i,o]=E.useState(null),l=async()=>{r(!0),s(null);try{const y=await sa.getGestionOTsActivas();o(y)}catch(y){console.error("Error fetching report:",y),s("Error al cargar los datos del reporte.")}finally{r(!1)}};E.useEffect(()=>{l()},[]);const c=E.useMemo(()=>i!=null&&i.por_area?i.por_area.reduce((y,_)=>y+_.ots_atrasadas,0):0,[i]),u=E.useMemo(()=>{var b;if(!((b=i==null?void 0:i.por_area)!=null&&b.length))return 0;const y=i.por_area.reduce((w,C)=>w+C.dias_promedio*C.total_ots,0),_=i.por_area.reduce((w,C)=>w+C.total_ots,0);return _>0?(y/_).toFixed(1):"0"},[i]),h=E.useMemo(()=>{var y;return(y=i==null?void 0:i.por_area)!=null&&y.length?{labels:i.por_area.map(_=>_.area_nombre),datasets:[{label:"Normal",data:i.por_area.map(_=>Math.max(0,_.total_ots-_.ots_atrasadas)),backgroundColor:d.colors.success},{label:"Atrasadas",data:i.por_area.map(_=>_.ots_atrasadas),backgroundColor:d.colors.danger}]}:null},[i]),f=E.useMemo(()=>{var y;return(y=i==null?void 0:i.por_area)!=null&&y.length?{labels:i.por_area.map(_=>_.area_nombre),datasets:[{data:i.por_area.map(_=>_.total_ots),backgroundColor:i.por_area.map(_=>tA[_.area_nombre]||"#6B7280"),borderWidth:0}]}:null},[i]),m=(y,_)=>{const b=_>0?y/_*100:0;return b>20?"critical":b>10?"warning":"normal"};return a.jsxs(yue,{children:[a.jsx(bue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(_ue,{children:"Gestion de OTs Activas"}),a.jsx(wue,{children:a.jsx(jue,{children:a.jsx(kue,{$variant:"primary",onClick:l,disabled:t,children:t?"Cargando...":"Actualizar"})})}),n&&a.jsx(Fue,{children:n}),t?a.jsx(Aue,{children:"Cargando datos del reporte..."}):i&&a.jsxs(a.Fragment,{children:[a.jsxs(Sue,{children:[a.jsxs(ef,{$color:d.colors.primary,children:[a.jsx(tf,{children:i.total_activas}),a.jsx(rf,{children:"Total OTs Activas"})]}),a.jsxs(ef,{$color:d.colors.success,children:[a.jsx(tf,{children:i.total_activas-c}),a.jsx(rf,{children:"En Tiempo"})]}),a.jsxs(ef,{$color:d.colors.danger,children:[a.jsx(tf,{children:c}),a.jsx(rf,{children:"Atrasadas"})]}),a.jsxs(ef,{$color:d.colors.warning,children:[a.jsxs(tf,{children:[u,"d"]}),a.jsx(rf,{children:"Dias Promedio"})]}),a.jsxs(ef,{$color:"#7C3AED",children:[a.jsx(tf,{children:((g=i.por_area)==null?void 0:g.length)||0}),a.jsx(rf,{children:"Areas con OTs"})]})]}),a.jsxs(Cue,{children:[h&&a.jsxs(__,{children:[a.jsx(w_,{children:"Estado de OTs por Area"}),a.jsx(In,{data:h,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}})]}),f&&a.jsxs(__,{children:[a.jsx(w_,{children:"Distribucion por Area"}),a.jsx(Qu,{data:f,options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})]})]}),a.jsxs(__,{children:[a.jsx(w_,{children:"Detalle por Area"}),a.jsxs($ue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(nf,{children:"Area"}),a.jsx(nf,{children:"Total OTs"}),a.jsx(nf,{children:"Dias Promedio"}),a.jsx(nf,{children:"Atrasadas"}),a.jsx(nf,{children:"Estado"})]})}),a.jsx("tbody",{children:((v=i.por_area)==null?void 0:v.length)===0?a.jsx("tr",{children:a.jsx(Ad,{colSpan:5,style:{textAlign:"center"},children:"No hay OTs activas actualmente"})}):(x=i.por_area)==null?void 0:x.map(y=>a.jsxs("tr",{children:[a.jsx(Ad,{children:a.jsx(Tue,{$color:tA[y.area_nombre]||"#6B7280",children:y.area_nombre})}),a.jsx(Ad,{style:{fontWeight:600},children:y.total_ots}),a.jsxs(Ad,{children:[y.dias_promedio.toFixed(1),"d"]}),a.jsx(Ad,{style:{fontWeight:600,color:y.ots_atrasadas>0?d.colors.danger:"inherit"},children:y.ots_atrasadas}),a.jsx(Ad,{children:a.jsx(Eue,{$level:m(y.ots_atrasadas,y.total_ots),children:m(y.ots_atrasadas,y.total_ots)==="critical"?"Critico":m(y.ots_atrasadas,y.total_ots)==="warning"?"Alerta":"Normal"})})]},y.area_id||y.area_nombre))})]})]})]})]})}Rr.register(qr,Kr,Or,jr,Fn,On,Rn,Mn,Yu);const Due=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Mue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Oue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Rue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Iue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,rA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,nA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,sA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,j_=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Nue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,wg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,jg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,kg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Lue=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,aA=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,iA=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,zue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ql=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,To=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Bue=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,Uue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Vue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Hue=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`;function Wue({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(1),[l,c]=E.useState(!0),[u,h]=E.useState(null),[f,m]=E.useState(null),g=async()=>{c(!0),h(null);try{const y=await sa.getTiempoPrimeraMuestra({page:i,page_size:20,date_desde:t||void 0,date_hasta:n||void 0});m(y)}catch(y){console.error("Error fetching report:",y),h("Error al cargar los datos del reporte.")}finally{c(!1)}};E.useEffect(()=>{g()},[i]);const v=()=>{o(1),g()},x=E.useMemo(()=>{var b;if(!((b=f==null?void 0:f.items)!=null&&b.length))return null;const y=[{label:"0-5 dias",min:0,max:5,color:d.colors.success},{label:"6-10 dias",min:6,max:10,color:"#60A5FA"},{label:"11-15 dias",min:11,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],_=y.map(w=>f.items.filter(C=>C.dias_hasta_muestra!==null&&C.dias_hasta_muestra>=w.min&&C.dias_hasta_muestra<=w.max).length);return{labels:y.map(w=>w.label),datasets:[{label:"OTs",data:_,backgroundColor:y.map(w=>w.color)}]}},[f]);return a.jsxs(Due,{children:[a.jsx(Mue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Oue,{children:"Tiempo Primera Muestra"}),a.jsx(Rue,{children:a.jsxs(Iue,{children:[a.jsxs(rA,{children:[a.jsx(nA,{children:"Desde"}),a.jsx(sA,{type:"date",value:t,onChange:y=>r(y.target.value)})]}),a.jsxs(rA,{children:[a.jsx(nA,{children:"Hasta"}),a.jsx(sA,{type:"date",value:n,onChange:y=>s(y.target.value)})]}),a.jsx(j_,{$variant:"primary",onClick:v,disabled:l,children:l?"Cargando...":"Filtrar"})]})}),u&&a.jsx(Vue,{children:u}),l?a.jsx(Uue,{children:"Cargando datos del reporte..."}):f&&a.jsxs(a.Fragment,{children:[a.jsxs(Nue,{children:[a.jsxs(wg,{$color:d.colors.primary,children:[a.jsx(jg,{children:f.total}),a.jsx(kg,{children:"Total OTs"})]}),a.jsxs(wg,{$color:d.colors.warning,children:[a.jsxs(jg,{children:[f.promedio_dias.toFixed(1),"d"]}),a.jsx(kg,{children:"Tiempo Promedio"})]}),a.jsxs(wg,{$color:d.colors.success,children:[a.jsxs(jg,{children:[f.minimo_dias.toFixed(1),"d"]}),a.jsx(kg,{children:"Tiempo Minimo"})]}),a.jsxs(wg,{$color:d.colors.danger,children:[a.jsxs(jg,{children:[f.maximo_dias.toFixed(1),"d"]}),a.jsx(kg,{children:"Tiempo Maximo"})]})]}),a.jsx(Lue,{children:x&&a.jsxs(aA,{children:[a.jsx(iA,{children:"Distribucion por Tiempo hasta Primera Muestra"}),a.jsx(In,{data:x,options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})]})}),a.jsxs(aA,{children:[a.jsxs(iA,{children:["Detalle de OTs (",f.total," registros)"]}),a.jsxs(zue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ql,{children:"OT ID"}),a.jsx(Ql,{children:"Cliente"}),a.jsx(Ql,{children:"Descripcion"}),a.jsx(Ql,{children:"Creacion"}),a.jsx(Ql,{children:"Primera Muestra"}),a.jsx(Ql,{children:"Dias"}),a.jsx(Ql,{children:"Estado"})]})}),a.jsx("tbody",{children:f.items.length===0?a.jsx("tr",{children:a.jsx(To,{colSpan:7,style:{textAlign:"center"},children:"No hay datos en el periodo seleccionado"})}):f.items.map(y=>{var _;return a.jsxs("tr",{children:[a.jsxs(To,{style:{fontWeight:600},children:["#",y.id]}),a.jsx(To,{children:y.client_name||"Sin cliente"}),a.jsxs(To,{children:[((_=y.descripcion)==null?void 0:_.substring(0,40))||"-","..."]}),a.jsx(To,{children:y.created_at}),a.jsx(To,{children:y.primera_muestra_at||"-"}),a.jsx(To,{style:{fontWeight:600,color:y.dias_hasta_muestra===null?d.colors.textSecondary:y.dias_hasta_muestra<=10?d.colors.success:y.dias_hasta_muestra<=15?d.colors.warning:d.colors.danger},children:y.dias_hasta_muestra!==null?`${y.dias_hasta_muestra}d`:"Pendiente"}),a.jsx(To,{children:a.jsx(Bue,{$color:y.dias_hasta_muestra!==null?d.colors.success:d.colors.warning,children:y.dias_hasta_muestra!==null?"Con muestra":"Sin muestra"})})]},y.id)})})]}),f.total_pages>1&&a.jsxs(Hue,{children:[a.jsx(j_,{onClick:()=>o(y=>Math.max(1,y-1)),disabled:i===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",i," de ",f.total_pages]}),a.jsx(j_,{onClick:()=>o(y=>Math.min(f.total_pages,y+1)),disabled:i===f.total_pages,children:"Siguiente"})]})]})]})]})}Rr.register(qr,Kr,Or,Xn,jr,Fn,On,Rn,Mn,Yu);const Gue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,que=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Kue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Xue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Yue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,oA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,lA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,cA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Que=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Jue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Sg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Cg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,$g=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Zue=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: 1fr 1fr; }
  @media (max-width: 768px) { grid-template-columns: 1fr; }
`,sf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,af=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,dA=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Jl=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Eo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,ehe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,the=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
  }
`,rhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,nhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,of={"Error de diseno":"#DC2626","Colores incorrectos":"#D97706","Dimensiones erroneas":"#7C3AED","Materiales inadecuados":"#059669","Texto ilegible":"#4F46E5",Otros:"#6B7280"};function she({onNavigate:e}){var b,w,C;const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(!0),[l,c]=E.useState(null),[u,h]=E.useState(null),f=async()=>{o(!0),c(null);try{const j=await sa.getMotivosRechazo({date_desde:t||void 0,date_hasta:n||void 0});h(j)}catch(j){console.error("Error fetching report:",j),c("Error al cargar los datos del reporte.")}finally{o(!1)}};E.useEffect(()=>{f()},[]);const m=()=>{f()},g=((b=u==null?void 0:u.items)==null?void 0:b[0])||null,v=(w=u==null?void 0:u.por_mes)!=null&&w.length?u.por_mes[u.por_mes.length-1]:null,x=E.useMemo(()=>{var j;return(j=u==null?void 0:u.items)!=null&&j.length?{labels:u.items.map(T=>T.motivo),datasets:[{data:u.items.map(T=>T.cantidad),backgroundColor:u.items.map(T=>of[T.motivo]||"#6B7280"),borderWidth:0}]}:null},[u]),y=E.useMemo(()=>{var j;return(j=u==null?void 0:u.items)!=null&&j.length?{labels:u.items.map(T=>T.motivo),datasets:[{label:"Rechazos",data:u.items.map(T=>T.cantidad),backgroundColor:u.items.map(T=>of[T.motivo]||"#6B7280")}]}:null},[u]),_=E.useMemo(()=>{var j;return(j=u==null?void 0:u.por_mes)!=null&&j.length?{labels:u.por_mes.map(T=>T.mes),datasets:[{label:"Cantidad Rechazos",data:u.por_mes.map(T=>T.cantidad),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.4}]}:null},[u]);return a.jsxs(Gue,{children:[a.jsx(que,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Kue,{children:"Motivos de Rechazo"}),a.jsx(Xue,{children:a.jsxs(Yue,{children:[a.jsxs(oA,{children:[a.jsx(lA,{children:"Desde"}),a.jsx(cA,{type:"date",value:t,onChange:j=>r(j.target.value)})]}),a.jsxs(oA,{children:[a.jsx(lA,{children:"Hasta"}),a.jsx(cA,{type:"date",value:n,onChange:j=>s(j.target.value)})]}),a.jsx(Que,{$variant:"primary",onClick:m,disabled:i,children:i?"Cargando...":"Filtrar"})]})}),l&&a.jsx(nhe,{children:l}),i?a.jsx(rhe,{children:"Cargando datos del reporte..."}):u&&a.jsxs(a.Fragment,{children:[a.jsxs(Jue,{children:[a.jsxs(Sg,{$color:d.colors.danger,children:[a.jsx(Cg,{children:u.total}),a.jsx($g,{children:"Total Rechazos"})]}),a.jsxs(Sg,{$color:g?of[g.motivo]||"#6B7280":d.colors.warning,children:[a.jsx(Cg,{children:(g==null?void 0:g.cantidad)||0}),a.jsxs($g,{children:["Motivo: ",(g==null?void 0:g.motivo)||"-"]})]}),a.jsxs(Sg,{$color:d.colors.primary,children:[a.jsx(Cg,{children:((C=u.items)==null?void 0:C.length)||0}),a.jsx($g,{children:"Tipos de Motivos"})]}),a.jsxs(Sg,{$color:d.colors.success,children:[a.jsx(Cg,{children:(v==null?void 0:v.cantidad)||0}),a.jsx($g,{children:"Ultimo Mes"})]})]}),a.jsxs(Zue,{children:[x&&a.jsxs(sf,{children:[a.jsx(af,{children:"Distribucion por Motivo"}),a.jsx(Gk,{data:x,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]}),y&&a.jsxs(sf,{children:[a.jsx(af,{children:"Rechazos por Motivo"}),a.jsx(In,{data:y,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),_&&a.jsxs(sf,{children:[a.jsx(af,{children:"Tendencia Mensual"}),a.jsx(Fl,{data:_,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})]})]}),a.jsxs(sf,{children:[a.jsx(af,{children:"Ranking de Motivos"}),a.jsxs(dA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Jl,{children:"#"}),a.jsx(Jl,{children:"Motivo"}),a.jsx(Jl,{children:"Cantidad"}),a.jsx(Jl,{children:"Porcentaje"}),a.jsx(Jl,{style:{width:"40%"},children:"Distribucion"})]})}),a.jsx("tbody",{children:u.items.length===0?a.jsx("tr",{children:a.jsx(Eo,{colSpan:5,style:{textAlign:"center"},children:"No hay datos de motivos de rechazo"})}):u.items.map((j,T)=>a.jsxs("tr",{children:[a.jsx(Eo,{style:{fontWeight:600},children:T+1}),a.jsx(Eo,{children:a.jsx(ehe,{$color:of[j.motivo]||"#6B7280",children:j.motivo})}),a.jsx(Eo,{style:{fontWeight:600},children:j.cantidad}),a.jsxs(Eo,{children:[j.porcentaje.toFixed(1),"%"]}),a.jsx(Eo,{children:a.jsx(the,{$value:j.porcentaje*3,$color:of[j.motivo]||"#6B7280"})})]},j.motivo))})]})]}),u.por_mes&&u.por_mes.length>0&&a.jsxs(sf,{style:{marginTop:"1.5rem"},children:[a.jsx(af,{children:"Rechazos por Mes"}),a.jsxs(dA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Jl,{children:"Mes"}),a.jsx(Jl,{children:"Cantidad"})]})}),a.jsx("tbody",{children:u.por_mes.map(j=>a.jsxs("tr",{children:[a.jsx(Eo,{style:{fontWeight:600},children:j.mes}),a.jsx(Eo,{style:{fontWeight:600,color:d.colors.danger},children:j.cantidad})]},j.mes))})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn);const ahe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ihe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,ohe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,lhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,che=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,k_=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,S_=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,dhe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,uA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,hA=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
`,uhe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,lf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,cf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,df=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,hhe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,ix=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,fhe=p(ix)`
  grid-column: 1 / -1;
`,Tg=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,phe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ao=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Fo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,mhe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$level:e})=>{switch(e){case"excellent":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"good":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"regular":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"poor":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`}}}
`,ghe=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,xhe=p.div`
  height: 8px;
  width: 80px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$width:e})=>e}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,Bn=[{id:1,nombre:"Carlos Mendez",empresa:"Diseos Pro",otsAsignadas:45,otsCompletadas:42,tiempoPromedio:3.2,tiempoMeta:4,cumplimiento:95,performance:"excellent"},{id:2,nombre:"Ana Torres",empresa:"Creative Studio",otsAsignadas:38,otsCompletadas:35,tiempoPromedio:3.8,tiempoMeta:4,cumplimiento:88,performance:"good"},{id:3,nombre:"Roberto Silva",empresa:"Freelance",otsAsignadas:52,otsCompletadas:45,tiempoPromedio:4.5,tiempoMeta:4,cumplimiento:78,performance:"regular"},{id:4,nombre:"Maria Lopez",empresa:"Diseos Pro",otsAsignadas:30,otsCompletadas:28,tiempoPromedio:2.9,tiempoMeta:4,cumplimiento:98,performance:"excellent"},{id:5,nombre:"Pedro Sanchez",empresa:"GraphicArt",otsAsignadas:25,otsCompletadas:18,tiempoPromedio:5.2,tiempoMeta:4,cumplimiento:65,performance:"poor"},{id:6,nombre:"Laura Garcia",empresa:"Creative Studio",otsAsignadas:40,otsCompletadas:38,tiempoPromedio:3.5,tiempoMeta:4,cumplimiento:92,performance:"excellent"}],C_=[{mes:"Jul",promedio:3.8,meta:4},{mes:"Ago",promedio:4.1,meta:4},{mes:"Sep",promedio:3.5,meta:4},{mes:"Oct",promedio:3.9,meta:4},{mes:"Nov",promedio:3.6,meta:4},{mes:"Dic",promedio:3.7,meta:4}];function vhe({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState("2024-07-01"),[i,o]=E.useState("2024-12-31"),l=Bn.reduce((w,C)=>w+C.otsAsignadas,0),c=Bn.reduce((w,C)=>w+C.otsCompletadas,0),u=(Bn.reduce((w,C)=>w+C.tiempoPromedio,0)/Bn.length).toFixed(1),h=(Bn.reduce((w,C)=>w+C.cumplimiento,0)/Bn.length).toFixed(0),f={labels:Bn.map(w=>w.nombre),datasets:[{label:"Tiempo Promedio (das)",data:Bn.map(w=>w.tiempoPromedio),backgroundColor:Bn.map(w=>w.tiempoPromedio<=w.tiempoMeta?d.colors.success:d.colors.warning)},{label:"Meta (das)",data:Bn.map(w=>w.tiempoMeta),backgroundColor:d.colors.textSecondary+"40"}]},m=[...new Set(Bn.map(w=>w.empresa))],g={labels:m,datasets:[{data:m.map(w=>Bn.filter(C=>C.empresa===w).reduce((C,j)=>C+j.otsCompletadas,0)),backgroundColor:[d.colors.primary,d.colors.success,"#7C3AED",d.colors.warning]}]},v={labels:C_.map(w=>w.mes),datasets:[{label:"Tiempo Promedio",data:C_.map(w=>w.promedio),borderColor:d.colors.primary,backgroundColor:d.colors.primary+"20",fill:!0,tension:.3},{label:"Meta",data:C_.map(w=>w.meta),borderColor:d.colors.danger,borderDash:[5,5],fill:!1}]},x={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Das"}}}},y={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:6}}},_={responsive:!0,plugins:{legend:{position:"right"}}},b=w=>{switch(w){case"excellent":return"Excelente";case"good":return"Bueno";case"regular":return"Regular";case"poor":return"Bajo"}};return a.jsxs(ahe,{children:[a.jsx(ihe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(ohe,{children:"Tiempo Diseador Externo"}),a.jsx(lhe,{children:a.jsxs(che,{children:[a.jsxs(k_,{children:[a.jsx(S_,{children:"Desde"}),a.jsx(uA,{type:"date",value:n,onChange:w=>s(w.target.value)})]}),a.jsxs(k_,{children:[a.jsx(S_,{children:"Hasta"}),a.jsx(uA,{type:"date",value:i,onChange:w=>o(w.target.value)})]}),a.jsxs(k_,{children:[a.jsx(S_,{children:"Empresa"}),a.jsxs(dhe,{value:t,onChange:w=>r(w.target.value),children:[a.jsx("option",{value:"",children:"Todas"}),m.map(w=>a.jsx("option",{value:w,children:w},w))]})]}),a.jsx(hA,{$variant:"primary",children:"Filtrar"}),a.jsx(hA,{children:"Exportar Excel"})]})}),a.jsxs(uhe,{children:[a.jsxs(lf,{$color:d.colors.primary,children:[a.jsx(cf,{children:Bn.length}),a.jsx(df,{children:"Diseadores Activos"})]}),a.jsxs(lf,{$color:d.colors.success,children:[a.jsx(cf,{children:l}),a.jsx(df,{children:"OTs Asignadas"})]}),a.jsxs(lf,{$color:"#7C3AED",children:[a.jsx(cf,{children:c}),a.jsx(df,{children:"OTs Completadas"})]}),a.jsxs(lf,{$color:d.colors.warning,children:[a.jsxs(cf,{children:[u,"d"]}),a.jsx(df,{children:"Tiempo Promedio"})]}),a.jsxs(lf,{$color:d.colors.success,children:[a.jsxs(cf,{children:[h,"%"]}),a.jsx(df,{children:"Cumplimiento"})]})]}),a.jsxs(hhe,{children:[a.jsxs(ix,{children:[a.jsx(Tg,{children:"Tiempo por Diseador"}),a.jsx(In,{data:f,options:x})]}),a.jsxs(ix,{children:[a.jsx(Tg,{children:"OTs por Empresa"}),a.jsx(Qu,{data:g,options:_})]})]}),a.jsxs(ix,{style:{marginBottom:"1.5rem"},children:[a.jsx(Tg,{children:"Tendencia Mensual"}),a.jsx(Fl,{data:v,options:y})]}),a.jsxs(fhe,{children:[a.jsx(Tg,{children:"Detalle por Diseador"}),a.jsxs(phe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ao,{children:"Diseador"}),a.jsx(Ao,{children:"Empresa"}),a.jsx(Ao,{children:"OTs Asignadas"}),a.jsx(Ao,{children:"OTs Completadas"}),a.jsx(Ao,{children:"Tiempo Prom."}),a.jsx(Ao,{children:"Meta"}),a.jsx(Ao,{children:"Cumplimiento"}),a.jsx(Ao,{children:"Performance"})]})}),a.jsx("tbody",{children:Bn.map(w=>a.jsxs("tr",{children:[a.jsx(Fo,{style:{fontWeight:600},children:w.nombre}),a.jsx(Fo,{children:w.empresa}),a.jsx(Fo,{children:w.otsAsignadas}),a.jsx(Fo,{children:w.otsCompletadas}),a.jsxs(Fo,{style:{color:w.tiempoPromedio<=w.tiempoMeta?d.colors.success:d.colors.warning},children:[w.tiempoPromedio," das"]}),a.jsxs(Fo,{children:[w.tiempoMeta," das"]}),a.jsx(Fo,{children:a.jsxs(ghe,{children:[a.jsx(xhe,{$width:w.cumplimiento,$color:w.cumplimiento>=90?d.colors.success:w.cumplimiento>=75?d.colors.warning:d.colors.danger}),a.jsxs("span",{children:[w.cumplimiento,"%"]})]})}),a.jsx(Fo,{children:a.jsx(mhe,{$level:w.performance,children:b(w.performance)})})]},w.id))})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn);const yhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,bhe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,_he=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,whe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,jhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,$_=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,T_=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,khe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,fA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,E_=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,She=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,uf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,hf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,ff=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Che=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,P2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,$he=p(P2)`
  grid-column: 1 / -1;
`,A_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,The=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Zl=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Po=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Ehe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,Ahe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Fhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Phe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,Dhe={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger};function Mhe({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(1),[u,h]=E.useState(!0),[f,m]=E.useState(null),[g,v]=E.useState(null),x=async()=>{h(!0),m(null);try{const T=await sa.getMuestras({page:l,page_size:20,date_desde:n||void 0,date_hasta:i||void 0,estado:t||void 0});v(T)}catch(T){console.error("Error fetching report:",T),m("Error al cargar los datos del reporte.")}finally{h(!1)}};E.useEffect(()=>{x()},[l]);const y=()=>{c(1),x()},_=E.useMemo(()=>{if(!(g!=null&&g.por_estado))return{pendientes:0,en_proceso:0,completadas:0,rechazadas:0};const T={};return g.por_estado.forEach(k=>{T[k.estado]=k.cantidad}),{pendientes:T.pendiente||0,en_proceso:T.en_proceso||0,completadas:T.completada||0,rechazadas:T.rechazada||0}},[g]),b=E.useMemo(()=>{var T;return(T=g==null?void 0:g.por_estado)!=null&&T.length?{labels:g.por_estado.map(k=>k.estado),datasets:[{data:g.por_estado.map(k=>k.cantidad),backgroundColor:g.por_estado.map(k=>Dhe[k.estado]||"#6B7280")}]}:null},[g]),w=E.useMemo(()=>{var T;return(T=g==null?void 0:g.por_tipo)!=null&&T.length?{labels:g.por_tipo.map(k=>k.tipo),datasets:[{label:"Muestras",data:g.por_tipo.map(k=>k.cantidad),backgroundColor:d.colors.primary}]}:null},[g]),C={responsive:!0,plugins:{legend:{position:"right"}}},j={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(yhe,{children:[a.jsx(bhe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(_he,{children:"Sala de Muestra"}),a.jsx(whe,{children:a.jsxs(jhe,{children:[a.jsxs($_,{children:[a.jsx(T_,{children:"Desde"}),a.jsx(fA,{type:"date",value:n,onChange:T=>s(T.target.value)})]}),a.jsxs($_,{children:[a.jsx(T_,{children:"Hasta"}),a.jsx(fA,{type:"date",value:i,onChange:T=>o(T.target.value)})]}),a.jsxs($_,{children:[a.jsx(T_,{children:"Estado"}),a.jsxs(khe,{value:t,onChange:T=>r(T.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(E_,{$variant:"primary",onClick:y,disabled:u,children:u?"Cargando...":"Filtrar"})]})}),f&&a.jsx(Fhe,{children:f}),u?a.jsx(Ahe,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(She,{children:[a.jsxs(uf,{$color:d.colors.warning,children:[a.jsx(hf,{children:_.pendientes}),a.jsx(ff,{children:"Pendientes"})]}),a.jsxs(uf,{$color:d.colors.primary,children:[a.jsx(hf,{children:_.en_proceso}),a.jsx(ff,{children:"En Proceso"})]}),a.jsxs(uf,{$color:d.colors.success,children:[a.jsx(hf,{children:_.completadas}),a.jsx(ff,{children:"Completadas"})]}),a.jsxs(uf,{$color:d.colors.danger,children:[a.jsx(hf,{children:_.rechazadas}),a.jsx(ff,{children:"Rechazadas"})]}),a.jsxs(uf,{$color:"#7C3AED",children:[a.jsx(hf,{children:g.total}),a.jsx(ff,{children:"Total Muestras"})]})]}),a.jsxs(Che,{children:[w&&a.jsxs(P2,{children:[a.jsx(A_,{children:"Muestras por Tipo"}),a.jsx(In,{data:w,options:j})]}),b&&a.jsxs(P2,{children:[a.jsx(A_,{children:"Distribucion por Estado"}),a.jsx(Qu,{data:b,options:C})]})]}),a.jsxs($he,{children:[a.jsxs(A_,{children:["Cola de Muestras (",g.total," registros)"]}),a.jsxs(The,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Zl,{children:"ID"}),a.jsx(Zl,{children:"OT"}),a.jsx(Zl,{children:"Tipo"}),a.jsx(Zl,{children:"Fecha Solicitud"}),a.jsx(Zl,{children:"Completada"}),a.jsx(Zl,{children:"Estado"}),a.jsx(Zl,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Po,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(T=>a.jsxs("tr",{children:[a.jsxs(Po,{style:{fontWeight:600},children:["#",T.id]}),a.jsxs(Po,{children:["OT-",T.ot_id]}),a.jsx(Po,{children:T.tipo}),a.jsx(Po,{children:T.created_at}),a.jsx(Po,{children:T.completed_at||"-"}),a.jsx(Po,{children:a.jsx(Ehe,{$status:T.estado,children:T.estado})}),a.jsx(Po,{children:T.responsable})]},T.id))})]}),g.total_pages>1&&a.jsxs(Phe,{children:[a.jsx(E_,{onClick:()=>c(T=>Math.max(1,T-1)),disabled:l===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",l," de ",g.total_pages]}),a.jsx(E_,{onClick:()=>c(T=>Math.min(g.total_pages,T+1)),disabled:l===g.total_pages,children:"Siguiente"})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn,Yu);const Ohe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Rhe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Ihe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Nhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Lhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,zhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Bhe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Uhe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Vhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Hhe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Eg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.25rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
  position: relative;
`,Ag=p.div`
  font-size: 2rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Fg=p.div`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Whe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,F_=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,P_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Ghe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Fd=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,ec=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,qhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Khe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`;function Xhe({onNavigate:e}){const[t,r]=E.useState(new Date().getFullYear()),[n,s]=E.useState(!0),[i,o]=E.useState(null),[l,c]=E.useState(null),u=async()=>{s(!0),o(null);try{const x=await sa.getIndicadoresSalaMuestra(t);c(x)}catch(x){console.error("Error fetching report:",x),o("Error al cargar los datos del reporte.")}finally{s(!1)}};E.useEffect(()=>{u()},[t]);const h=E.useMemo(()=>{var b;if(!((b=l==null?void 0:l.por_mes)!=null&&b.length))return{completadas:0,rechazadas:0,tasaAprobacion:0};const x=l.por_mes.reduce((w,C)=>w+C.completadas,0),y=l.por_mes.reduce((w,C)=>w+C.rechazadas,0),_=x+y;return{completadas:x,rechazadas:y,tasaAprobacion:_>0?(x/_*100).toFixed(1):"0"}},[l]),f=E.useMemo(()=>{var x;return(x=l==null?void 0:l.por_mes)!=null&&x.length?{labels:l.por_mes.map(y=>y.mes),datasets:[{label:"Tiempo Promedio (dias)",data:l.por_mes.map(y=>y.tiempo_promedio),borderColor:d.colors.primary,yAxisID:"y",tension:.3},{label:"Total Muestras",data:l.por_mes.map(y=>y.total_muestras),borderColor:d.colors.success,yAxisID:"y1",tension:.3}]}:null},[l]),m=E.useMemo(()=>{var x;return(x=l==null?void 0:l.por_mes)!=null&&x.length?{labels:l.por_mes.map(y=>y.mes),datasets:[{label:"Completadas",data:l.por_mes.map(y=>y.completadas),backgroundColor:d.colors.success},{label:"Rechazadas",data:l.por_mes.map(y=>y.rechazadas),backgroundColor:d.colors.danger}]}:null},[l]),g={responsive:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Dias"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Cantidad"},grid:{drawOnChartArea:!1}}}},v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}};return a.jsxs(Ohe,{children:[a.jsx(Rhe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Ihe,{children:"Indicadores Sala de Muestra"}),a.jsx(Nhe,{children:a.jsxs(Lhe,{children:[a.jsxs(zhe,{children:[a.jsx(Bhe,{children:"Ano"}),a.jsx(Uhe,{value:t,onChange:x=>r(Number(x.target.value)),children:[2025,2024,2023,2022].map(x=>a.jsx("option",{value:x,children:x},x))})]}),a.jsx(Vhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),i&&a.jsx(Khe,{children:i}),n?a.jsx(qhe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(Hhe,{children:[a.jsxs(Eg,{$color:d.colors.primary,children:[a.jsx(Ag,{children:l.total_muestras}),a.jsx(Fg,{children:"Total Muestras (Ano)"})]}),a.jsxs(Eg,{$color:d.colors.warning,children:[a.jsxs(Ag,{children:[l.tiempo_promedio.toFixed(1),"d"]}),a.jsx(Fg,{children:"Tiempo Promedio"})]}),a.jsxs(Eg,{$color:d.colors.success,children:[a.jsx(Ag,{children:h.completadas}),a.jsx(Fg,{children:"Completadas"})]}),a.jsxs(Eg,{$color:d.colors.danger,children:[a.jsx(Ag,{children:h.rechazadas}),a.jsx(Fg,{children:"Rechazadas"})]})]}),a.jsxs(Whe,{children:[f&&a.jsxs(F_,{children:[a.jsx(P_,{children:"Tendencia de KPIs"}),a.jsx(Fl,{data:f,options:g})]}),m&&a.jsxs(F_,{children:[a.jsx(P_,{children:"Completadas vs Rechazadas"}),a.jsx(In,{data:m,options:v})]})]}),a.jsxs(F_,{children:[a.jsx(P_,{children:"Detalle por Mes"}),a.jsxs(Ghe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Fd,{children:"Mes"}),a.jsx(Fd,{children:"Total Muestras"}),a.jsx(Fd,{children:"Completadas"}),a.jsx(Fd,{children:"Rechazadas"}),a.jsx(Fd,{children:"Tiempo Prom."}),a.jsx(Fd,{children:"Tasa Aprobacion"})]})}),a.jsx("tbody",{children:l.por_mes.length===0?a.jsx("tr",{children:a.jsx(ec,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.por_mes.map(x=>{const y=x.completadas+x.rechazadas,_=y>0?(x.completadas/y*100).toFixed(1):"0";return a.jsxs("tr",{children:[a.jsx(ec,{style:{fontWeight:600},children:x.mes}),a.jsx(ec,{children:x.total_muestras}),a.jsx(ec,{style:{color:d.colors.success,fontWeight:600},children:x.completadas}),a.jsx(ec,{style:{color:d.colors.danger,fontWeight:600},children:x.rechazadas}),a.jsxs(ec,{children:[x.tiempo_promedio.toFixed(1),"d"]}),a.jsxs(ec,{style:{color:Number(_)>=90?d.colors.success:d.colors.warning},children:[_,"%"]})]},x.mes)})})]})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn);const Yhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Qhe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Jhe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Zhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,efe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,D_=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,M_=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,tfe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,pA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,mA=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
`,rfe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,pf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,mf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,gf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,nfe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,ox=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,sfe=p(ox)`
  grid-column: 1 / -1;
`,Pg=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,afe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Do=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Mo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,ife=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"diseo":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"muestra":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"aprobado":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazado":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`}}}
`,ofe=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,lfe=p.div`
  height: 8px;
  width: 100px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$width:e})=>e}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,Ya=[{id:1,otNumero:"OT-2024-1245",cliente:"Embonor",tipoEnvase:"Caja Display",disenador:"Carlos M.",fechaDiseno:"2024-12-10",fechaMuestra:"2024-12-15",estado:"muestra",complejidad:"alta",tiempoDisenoReal:5,tiempoDisenoEstimado:4,tiempoMuestraReal:2},{id:2,otNumero:"OT-2024-1248",cliente:"CCU",tipoEnvase:"Bandeja",disenador:"Ana T.",fechaDiseno:"2024-12-08",fechaMuestra:"2024-12-14",estado:"aprobado",complejidad:"media",tiempoDisenoReal:3,tiempoDisenoEstimado:3,tiempoMuestraReal:2},{id:3,otNumero:"OT-2024-1250",cliente:"Agrosuper",tipoEnvase:"Caja Corrugada",disenador:"Roberto S.",fechaDiseno:"2024-12-12",fechaMuestra:null,estado:"diseo",complejidad:"baja",tiempoDisenoReal:2,tiempoDisenoEstimado:2,tiempoMuestraReal:null},{id:4,otNumero:"OT-2024-1252",cliente:"Nestl",tipoEnvase:"Display Premium",disenador:"Mara L.",fechaDiseno:"2024-12-05",fechaMuestra:"2024-12-12",estado:"aprobado",complejidad:"alta",tiempoDisenoReal:6,tiempoDisenoEstimado:5,tiempoMuestraReal:3},{id:5,otNumero:"OT-2024-1255",cliente:"Concha y Toro",tipoEnvase:"Caja Vino",disenador:"Carlos M.",fechaDiseno:"2024-12-06",fechaMuestra:"2024-12-13",estado:"rechazado",complejidad:"alta",tiempoDisenoReal:5,tiempoDisenoEstimado:4,tiempoMuestraReal:3},{id:6,otNumero:"OT-2024-1258",cliente:"Watts",tipoEnvase:"Bandeja Jugos",disenador:"Ana T.",fechaDiseno:"2024-12-14",fechaMuestra:null,estado:"diseo",complejidad:"media",tiempoDisenoReal:2,tiempoDisenoEstimado:3,tiempoMuestraReal:null}],Dg=[{mes:"Jul",disenosTerminados:42,muestrasCreadas:38,aprobadas:35},{mes:"Ago",disenosTerminados:48,muestrasCreadas:45,aprobadas:40},{mes:"Sep",disenosTerminados:45,muestrasCreadas:42,aprobadas:38},{mes:"Oct",disenosTerminados:52,muestrasCreadas:48,aprobadas:44},{mes:"Nov",disenosTerminados:50,muestrasCreadas:47,aprobadas:43},{mes:"Dic",disenosTerminados:55,muestrasCreadas:50,aprobadas:46}];function cfe({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState("2024-12-01"),[i,o]=E.useState("2024-12-31"),l=Ya.filter(C=>C.estado==="diseo").length,c=Ya.filter(C=>C.estado==="muestra").length,u=Ya.filter(C=>C.estado==="aprobado").length,h=Ya.filter(C=>C.estado==="rechazado").length,f=Math.round(Ya.filter(C=>C.tiempoDisenoReal<=C.tiempoDisenoEstimado).length/Ya.length*100),m={labels:Dg.map(C=>C.mes),datasets:[{label:"Diseos Terminados",data:Dg.map(C=>C.disenosTerminados),backgroundColor:d.colors.primary},{label:"Muestras Creadas",data:Dg.map(C=>C.muestrasCreadas),backgroundColor:d.colors.warning},{label:"Aprobadas",data:Dg.map(C=>C.aprobadas),backgroundColor:d.colors.success}]},g={labels:["En Diseo","En Muestra","Aprobadas","Rechazadas"],datasets:[{data:[l,c,u,h],backgroundColor:[d.colors.primary,d.colors.warning,d.colors.success,d.colors.danger]}]},v={labels:Ya.map(C=>C.otNumero),datasets:[{label:"Tiempo Real",data:Ya.map(C=>C.tiempoDisenoReal),borderColor:d.colors.primary,tension:.3},{label:"Tiempo Estimado",data:Ya.map(C=>C.tiempoDisenoEstimado),borderColor:d.colors.success,borderDash:[5,5],tension:.3}]},x={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},y={responsive:!0,plugins:{legend:{position:"right"}}},_={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Das"}}}},b=C=>{switch(C){case"diseo":return"En Diseo";case"muestra":return"En Muestra";case"aprobado":return"Aprobado";case"rechazado":return"Rechazado"}},w=C=>{switch(C){case"alta":return d.colors.danger;case"media":return d.colors.warning;case"baja":return d.colors.success}};return a.jsxs(Yhe,{children:[a.jsx(Qhe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Jhe,{children:"Diseo Estructural y Sala de Muestra"}),a.jsx(Zhe,{children:a.jsxs(efe,{children:[a.jsxs(D_,{children:[a.jsx(M_,{children:"Desde"}),a.jsx(pA,{type:"date",value:n,onChange:C=>s(C.target.value)})]}),a.jsxs(D_,{children:[a.jsx(M_,{children:"Hasta"}),a.jsx(pA,{type:"date",value:i,onChange:C=>o(C.target.value)})]}),a.jsxs(D_,{children:[a.jsx(M_,{children:"Complejidad"}),a.jsxs(tfe,{value:t,onChange:C=>r(C.target.value),children:[a.jsx("option",{value:"",children:"Todas"}),a.jsx("option",{value:"alta",children:"Alta"}),a.jsx("option",{value:"media",children:"Media"}),a.jsx("option",{value:"baja",children:"Baja"})]})]}),a.jsx(mA,{$variant:"primary",children:"Filtrar"}),a.jsx(mA,{children:"Exportar Excel"})]})}),a.jsxs(rfe,{children:[a.jsxs(pf,{$color:d.colors.primary,children:[a.jsx(mf,{children:l}),a.jsx(gf,{children:"En Diseo"})]}),a.jsxs(pf,{$color:d.colors.warning,children:[a.jsx(mf,{children:c}),a.jsx(gf,{children:"En Muestra"})]}),a.jsxs(pf,{$color:d.colors.success,children:[a.jsx(mf,{children:u}),a.jsx(gf,{children:"Aprobados"})]}),a.jsxs(pf,{$color:d.colors.danger,children:[a.jsx(mf,{children:h}),a.jsx(gf,{children:"Rechazados"})]}),a.jsxs(pf,{$color:"#7C3AED",children:[a.jsxs(mf,{children:[f,"%"]}),a.jsx(gf,{children:"Eficiencia Estimacin"})]})]}),a.jsxs(nfe,{children:[a.jsxs(ox,{children:[a.jsx(Pg,{children:"Flujo Diseo  Muestra  Aprobacin"}),a.jsx(In,{data:m,options:x})]}),a.jsxs(ox,{children:[a.jsx(Pg,{children:"Distribucin por Estado"}),a.jsx(Qu,{data:g,options:y})]})]}),a.jsxs(ox,{style:{marginBottom:"1.5rem"},children:[a.jsx(Pg,{children:"Tiempo Real vs Estimado (Diseo)"}),a.jsx(Fl,{data:v,options:_})]}),a.jsxs(sfe,{children:[a.jsx(Pg,{children:"Detalle de OTs"}),a.jsxs(afe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Do,{children:"OT"}),a.jsx(Do,{children:"Cliente"}),a.jsx(Do,{children:"Tipo Envase"}),a.jsx(Do,{children:"Diseador"}),a.jsx(Do,{children:"Complejidad"}),a.jsx(Do,{children:"Tiempo Diseo"}),a.jsx(Do,{children:"Tiempo Muestra"}),a.jsx(Do,{children:"Estado"})]})}),a.jsx("tbody",{children:Ya.map(C=>a.jsxs("tr",{children:[a.jsx(Mo,{style:{fontWeight:600},children:C.otNumero}),a.jsx(Mo,{children:C.cliente}),a.jsx(Mo,{children:C.tipoEnvase}),a.jsx(Mo,{children:C.disenador}),a.jsx(Mo,{children:a.jsxs(ofe,{children:[a.jsx(lfe,{$width:C.complejidad==="alta"?100:C.complejidad==="media"?60:30,$color:w(C.complejidad)}),a.jsx("span",{style:{fontSize:"0.75rem",textTransform:"capitalize"},children:C.complejidad})]})}),a.jsxs(Mo,{style:{color:C.tiempoDisenoReal>C.tiempoDisenoEstimado?d.colors.danger:d.colors.success},children:[C.tiempoDisenoReal,"d / ",C.tiempoDisenoEstimado,"d est."]}),a.jsx(Mo,{children:C.tiempoMuestraReal?`${C.tiempoMuestraReal}d`:"-"}),a.jsx(Mo,{children:a.jsx(ife,{$status:C.estado,children:b(C.estado)})})]},C.id))})]})]})]})}Rr.register(qr,Kr,Fn,jr,Or,Xn,On,Rn,Mn);const dfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ufe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,hfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,ffe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,pfe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,O_=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,R_=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,mfe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,gA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,I_=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,gfe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,xf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,vf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,yf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,xfe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,D2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,vfe=p(D2)`
  grid-column: 1 / -1;
`,N_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,yfe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,tc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Oo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,bfe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,_fe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$tipo:e})=>{switch(e==null?void 0:e.toLowerCase()){case"fisica":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"digital":return"background: #7C3AED20; color: #7C3AED;";case"prototipo":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,wfe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,jfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,kfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Sfe={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger},Cfe={fisica:d.colors.primary,digital:"#7C3AED",prototipo:d.colors.warning};function $fe({onNavigate:e}){const[t,r]=E.useState(""),[n,s]=E.useState(""),[i,o]=E.useState(""),[l,c]=E.useState(1),[u,h]=E.useState(!0),[f,m]=E.useState(null),[g,v]=E.useState(null),x=async()=>{h(!0),m(null);try{const T=await sa.getMuestras({page:l,page_size:20,date_desde:n||void 0,date_hasta:i||void 0,estado:t||void 0});v(T)}catch(T){console.error("Error fetching report:",T),m("Error al cargar los datos del reporte.")}finally{h(!1)}};E.useEffect(()=>{x()},[l]);const y=()=>{c(1),x()},_=E.useMemo(()=>{if(!(g!=null&&g.por_estado))return{};const T={};return g.por_estado.forEach(k=>{T[k.estado]=k.cantidad}),T},[g]),b=E.useMemo(()=>{var T;return(T=g==null?void 0:g.por_tipo)!=null&&T.length?{labels:g.por_tipo.map(k=>k.tipo),datasets:[{data:g.por_tipo.map(k=>k.cantidad),backgroundColor:g.por_tipo.map(k=>Cfe[k.tipo.toLowerCase()]||"#6B7280")}]}:null},[g]),w=E.useMemo(()=>{var T;return(T=g==null?void 0:g.por_estado)!=null&&T.length?{labels:g.por_estado.map(k=>k.estado),datasets:[{label:"Cantidad",data:g.por_estado.map(k=>k.cantidad),backgroundColor:g.por_estado.map(k=>Sfe[k.estado]||"#6B7280")}]}:null},[g]),C={responsive:!0,plugins:{legend:{position:"right"}}},j={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(dfe,{children:[a.jsx(ufe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(hfe,{children:"Muestras"}),a.jsx(ffe,{children:a.jsxs(pfe,{children:[a.jsxs(O_,{children:[a.jsx(R_,{children:"Desde"}),a.jsx(gA,{type:"date",value:n,onChange:T=>s(T.target.value)})]}),a.jsxs(O_,{children:[a.jsx(R_,{children:"Hasta"}),a.jsx(gA,{type:"date",value:i,onChange:T=>o(T.target.value)})]}),a.jsxs(O_,{children:[a.jsx(R_,{children:"Estado"}),a.jsxs(mfe,{value:t,onChange:T=>r(T.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(I_,{$variant:"primary",onClick:y,disabled:u,children:u?"Cargando...":"Filtrar"})]})}),f&&a.jsx(kfe,{children:f}),u?a.jsx(jfe,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(gfe,{children:[a.jsxs(xf,{$color:d.colors.primary,children:[a.jsx(vf,{children:g.total}),a.jsx(yf,{children:"Total Muestras"})]}),a.jsxs(xf,{$color:d.colors.warning,children:[a.jsx(vf,{children:_.pendiente||0}),a.jsx(yf,{children:"Pendientes"})]}),a.jsxs(xf,{$color:d.colors.primary,children:[a.jsx(vf,{children:_.en_proceso||0}),a.jsx(yf,{children:"En Proceso"})]}),a.jsxs(xf,{$color:d.colors.success,children:[a.jsx(vf,{children:_.completada||0}),a.jsx(yf,{children:"Completadas"})]}),a.jsxs(xf,{$color:d.colors.danger,children:[a.jsx(vf,{children:_.rechazada||0}),a.jsx(yf,{children:"Rechazadas"})]})]}),a.jsxs(xfe,{children:[b&&a.jsxs(D2,{children:[a.jsx(N_,{children:"Por Tipo de Muestra"}),a.jsx(Gk,{data:b,options:C})]}),w&&a.jsxs(D2,{children:[a.jsx(N_,{children:"Por Estado"}),a.jsx(In,{data:w,options:j})]})]}),a.jsxs(vfe,{children:[a.jsxs(N_,{children:["Listado de Muestras (",g.total," registros)"]}),a.jsxs(yfe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(tc,{children:"ID"}),a.jsx(tc,{children:"OT"}),a.jsx(tc,{children:"Tipo"}),a.jsx(tc,{children:"Fecha Solicitud"}),a.jsx(tc,{children:"Completada"}),a.jsx(tc,{children:"Estado"}),a.jsx(tc,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Oo,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(T=>a.jsxs("tr",{children:[a.jsxs(Oo,{style:{fontWeight:600},children:["#",T.id]}),a.jsxs(Oo,{children:["OT-",T.ot_id]}),a.jsx(Oo,{children:a.jsx(_fe,{$tipo:T.tipo,children:T.tipo})}),a.jsx(Oo,{children:T.created_at}),a.jsx(Oo,{children:T.completed_at||"-"}),a.jsx(Oo,{children:a.jsx(bfe,{$status:T.estado,children:T.estado})}),a.jsx(Oo,{children:T.responsable})]},T.id))})]}),g.total_pages>1&&a.jsxs(wfe,{children:[a.jsx(I_,{onClick:()=>c(T=>Math.max(1,T-1)),disabled:l===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",l," de ",g.total_pages]}),a.jsx(I_,{onClick:()=>c(T=>Math.min(g.total_pages,T+1)),disabled:l===g.total_pages,children:"Siguiente"})]})]})]})]})}const Ne={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,SuperAdministrador:18,VendedorExterno:19},Un={isAdmin:e=>e===Ne.Admin,isSuperAdministrador:e=>e===Ne.SuperAdministrador,isVendedor:e=>e===Ne.Vendedor,isVendedorExterno:e=>e===Ne.VendedorExterno,isJefeVenta:e=>e===Ne.JefeVenta,isJefeDesarrollo:e=>e===Ne.JefeDesarrollo,isGerenteGeneral:e=>e===Ne.Gerente,isGerenteComercial:e=>e===Ne.GerenteComercial,isJefeCatalogador:e=>e===Ne.JefeCatalogador,isCatalogador:e=>e===Ne.Catalogador,isIngeniero:e=>e===Ne.Ingeniero,isJefeDiseo:e=>e===Ne.JefeDiseo,isDiseador:e=>e===Ne.Diseador,isJefePrecatalogador:e=>e===Ne.JefePrecatalogador,isPrecatalogador:e=>e===Ne.Precatalogador,isJefeMuestras:e=>e===Ne.JefeMuestras,isTecnicoMuestras:e=>e===Ne.TecnicoMuestras,canApprove:e=>[Ne.Admin,Ne.SuperAdministrador,Ne.JefeVenta,Ne.JefeDesarrollo].includes(e),canViewReports:e=>[Ne.Admin,Ne.SuperAdministrador,Ne.JefeCatalogador,Ne.Gerente,Ne.GerenteComercial,Ne.JefeDesarrollo,Ne.JefeDiseo].includes(e),hasFullMantenedores:e=>[Ne.Admin,Ne.SuperAdministrador].includes(e),canUseCotizador:e=>[Ne.Admin,Ne.SuperAdministrador,Ne.Vendedor,Ne.Gerente,Ne.GerenteComercial,Ne.JefeVenta].includes(e),canApproveCotizaciones:e=>[Ne.Gerente,Ne.GerenteComercial,Ne.JefeVenta].includes(e),canAccessMantenedores:e=>[Ne.Admin,Ne.SuperAdministrador,Ne.Vendedor,Ne.JefeVenta,Ne.JefeCatalogador,Ne.Catalogador,Ne.Ingeniero,Ne.JefeDesarrollo,Ne.JefeDiseo,Ne.Diseador,Ne.JefePrecatalogador,Ne.Precatalogador].includes(e)},Tfe=new JR({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),Efe=p.div`
  min-height: 100vh;
  background-color: ${d.colors.bgLight};
`,Afe=p.header`
  background-color: white;
  border-bottom: 1px solid ${d.colors.border};
  padding: ${d.spacing.sm} ${d.spacing.xl};
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
`,Ffe=p.div`
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: ${d.spacing.md};
`,Pfe=p.div`
  display: flex;
  align-items: center;
  flex-shrink: 0;
`,Dfe=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Mfe=p.nav`
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  flex-wrap: wrap;
  justify-content: center;
  flex: 1;
`,Ofe=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  flex-shrink: 0;
`,Rfe=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  white-space: nowrap;
`,Ife=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Nfe=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.danger}15;
    border-color: ${d.colors.danger};
    color: ${d.colors.danger};
  }
`,Lfe=p.main`
  max-width: 1400px;
  margin: 0 auto;
  padding: ${d.spacing.lg} ${d.spacing.xl};
`,rc=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,L_=p.div`
  position: relative;
  display: inline-block;
`,z_=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,B_=p.span`
  display: inline-block;
  transition: transform 0.2s;
  transform: ${({$open:e})=>e?"rotate(180deg)":"rotate(0deg)"};
`,U_=p.div`
  position: absolute;
  top: 100%;
  left: 0;
  min-width: 220px;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  display: ${({$open:e})=>e?"block":"none"};
  max-height: 400px;
  overflow-y: auto;
`,zr=p.div`
  padding: ${d.spacing.xs} 0;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }
`,wn=p.div`
  padding: ${d.spacing.xs} ${d.spacing.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Pe=p.button`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  border: none;
  text-align: left;
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  transition: all 0.15s;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;function zfe({user:e,onLogout:t}){const[r,n]=E.useState("dashboard"),[s,i]=E.useState(null),[o,l]=E.useState(null),[c,u]=E.useState(null),[h,f]=E.useState(null),[m,g]=E.useState(null),[v,x]=E.useState(null),[y,_]=E.useState(!1),[b,w]=E.useState(!1),C=E.useRef(null),j=E.useRef(null),k=["clientes","usuarios","jerarquias-1","jerarquias-2","jerarquias-3","tipo-productos","estilos","colores","canales","tipos-cintas","almacenes","tipo-palet","organizaciones-ventas","grupo-imputacion-material","matrices","sectores","cartones","secuencias-operacionales","rechazo-conjunto","tiempo-tratamiento","grupo-materiales-1","grupo-materiales-2","materiales","grupo-plantas","adhesivos","cebes","clasificaciones-clientes","armados","procesos","pegados","envases","rayados","papeles","cardboards","carton-esquineros","plantas","tipo-ondas","factores-ondas","factores-desarrollos","factores-seguridads","areahcs","consumo-adhesivos","consumo-energias","consumo-adhesivo-pegados","merma-corrugadoras","merma-convertidoras","mercados","rubros","ciudades-fletes","fletes","maquila-servicios","tarifario","tarifario-margens","variables-cotizador","insumos-palletizados","detalle-precio-palletizados","paises","fsc","reference-types","recubrimiento-types"].includes(r);E.useEffect(()=>{const U=P=>{C.current&&!C.current.contains(P.target)&&_(!1),j.current&&!j.current.contains(P.target)&&w(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const[M,A]=E.useState({productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null}),O=U=>{A(U),console.log("Form data changed:",U)},F=E.useCallback((U,P,Q)=>{n(U),_(!1),w(!1),U==="editar-ot"&&P?(i(P),l(null),u(null),f(null),g(null)):U==="gestionar-ot"&&P?(l(P),i(null),u(null),f(null),g(null)):U==="editar-ot-especial"&&P?(i(P),l(null),u(null),f(null),g(null)):U==="detalle-log-ot"&&P?(u(P),i(null),l(null),f(null),g(null)):(U==="cotizacion-editar"||U==="cotizacion-externa-editar")&&P?(f(P),i(null),l(null),u(null),g(null)):U==="crear-ot-desde-cotizacion"&&Q?(g(Q),i(null),l(null),u(null),f(null),x(null)):(U==="muestras-list"||U==="muestra-nueva")&&P?(x(P),i(null),l(null),u(null),f(null),g(null)):(i(null),l(null),u(null),f(null),g(null),x(null))},[]),B=`${e.nombre} ${e.apellido}`,L=()=>{switch(r){case"dashboard":return a.jsx(XC,{onNavigate:F});case"crear-ot":return a.jsx(o$,{onNavigate:F});case"crear-ot-especial":return a.jsx(EB,{onNavigate:F});case"editar-ot-especial":return s?a.jsx(BB,{otId:s,onNavigate:F}):null;case"editar-ot":return s?a.jsx(a7,{otId:s,onNavigate:F}):null;case"cascade-form":return a.jsx(KP,{values:M,onChange:O});case"gestionar-ot":return o?a.jsx(S7,{otId:o,onNavigate:F}):null;case"notificaciones":return a.jsx(N7,{onNavigate:F});case"aprobacion-ots":return a.jsx(V7,{onNavigate:F});case"asignaciones":return a.jsx(nB,{onNavigate:F});case"cotizar-multiples-ot":return a.jsx(xB,{onNavigate:F});case"reportes":return a.jsx(Lse,{onNavigate:F});case"detalle-log-ot":return c?a.jsx(r9,{otId:c,onNavigate:F}):null;case"reporte-ots-activas":return a.jsx(Dce,{onNavigate:F});case"reporte-ots-completadas":return a.jsx(Wce,{onNavigate:F});case"reporte-tiempo-area":return a.jsx(dde,{onNavigate:F});case"reporte-rechazos":return a.jsx(Fde,{onNavigate:F});case"reporte-carga-mensual":return a.jsx(Kde,{onNavigate:F});case"reporte-anulaciones":return a.jsx(oue,{onNavigate:F});case"reporte-ots-completadas-fechas":return a.jsx(vue,{onNavigate:F});case"reporte-gestion-ots-activas":return a.jsx(Pue,{onNavigate:F});case"reporte-tiempo-primera-muestra":return a.jsx(Wue,{onNavigate:F});case"reporte-motivos-rechazo":return a.jsx(she,{onNavigate:F});case"reporte-tiempo-disenador-externo":return a.jsx(vhe,{onNavigate:F});case"reporte-sala-muestra":return a.jsx(Mhe,{onNavigate:F});case"reporte-indicador-sala-muestra":return a.jsx(Xhe,{onNavigate:F});case"reporte-diseno-estructural-sala":return a.jsx(cfe,{onNavigate:F});case"reporte-muestras":return a.jsx($fe,{onNavigate:F});case"cotizaciones":return a.jsx(Zte,{onNavigate:F});case"cotizacion-nueva":return a.jsx(Am,{onNavigate:F});case"cotizacion-editar":return h?a.jsx(Am,{cotizacionId:h,onNavigate:F}):null;case"aprobaciones":return a.jsx(ine,{onNavigate:F});case"cotizador-externo":return a.jsx(cse,{onNavigate:F});case"cotizacion-externa-nueva":return a.jsx(Am,{onNavigate:F,isExterno:!0});case"cotizacion-externa-editar":return h?a.jsx(Am,{cotizacionId:h,onNavigate:F,isExterno:!0}):null;case"aprobacion-externa-cotizaciones":return a.jsx(wne,{onNavigate:F});case"detalle-a-ot":return a.jsx(Kne,{onNavigate:F});case"crear-ot-desde-cotizacion":return m?a.jsx(o$,{onNavigate:F,initialData:m}):null;case"muestras-list":return v?a.jsx(yse,{otId:v,onNavigate:F,onCreateMuestra:()=>F("muestra-nueva",v)}):null;case"muestra-nueva":return v?a.jsx(Cse,{otId:v,onNavigate:F,onSuccess:()=>F("muestras-list",v)}):null;case"clientes":return a.jsx(N9,{onNavigate:F});case"usuarios":return a.jsx(aU,{onNavigate:F});case"jerarquias-1":return a.jsx(Ly,{nivel:1,onNavigate:F});case"jerarquias-2":return a.jsx(Ly,{nivel:2,onNavigate:F});case"jerarquias-3":return a.jsx(Ly,{nivel:3,onNavigate:F});case"tipo-productos":return a.jsx(Re,{tablaKey:"tipo_productos",onNavigate:F});case"estilos":return a.jsx(Re,{tablaKey:"estilos",onNavigate:F});case"colores":return a.jsx(Re,{tablaKey:"colores",onNavigate:F});case"canales":return a.jsx(Re,{tablaKey:"canales",onNavigate:F});case"tipos-cintas":return a.jsx(Re,{tablaKey:"tipos_cintas",onNavigate:F});case"almacenes":return a.jsx(Re,{tablaKey:"almacenes",onNavigate:F});case"tipo-palet":return a.jsx(Re,{tablaKey:"tipo_palet",onNavigate:F});case"organizaciones-ventas":return a.jsx(Re,{tablaKey:"organizaciones_ventas",onNavigate:F});case"grupo-imputacion-material":return a.jsx(Re,{tablaKey:"grupo_imputacion_material",onNavigate:F});case"matrices":return a.jsx(Re,{tablaKey:"matrices",onNavigate:F});case"sectores":return a.jsx(Re,{tablaKey:"sectores",onNavigate:F});case"cartones":return a.jsx(Re,{tablaKey:"cartones",onNavigate:F});case"secuencias-operacionales":return a.jsx(Re,{tablaKey:"secuencias_operacionales",onNavigate:F});case"rechazo-conjunto":return a.jsx(Re,{tablaKey:"rechazo_conjunto",onNavigate:F});case"tiempo-tratamiento":return a.jsx(Re,{tablaKey:"tiempo_tratamiento",onNavigate:F});case"grupo-materiales-1":return a.jsx(Re,{tablaKey:"grupo_materiales_1",onNavigate:F});case"grupo-materiales-2":return a.jsx(Re,{tablaKey:"grupo_materiales_2",onNavigate:F});case"materiales":return a.jsx(Re,{tablaKey:"materiales",onNavigate:F});case"grupo-plantas":return a.jsx(Re,{tablaKey:"grupo_plantas",onNavigate:F});case"adhesivos":return a.jsx(Re,{tablaKey:"adhesivos",onNavigate:F});case"cebes":return a.jsx(Re,{tablaKey:"cebes",onNavigate:F});case"clasificaciones-clientes":return a.jsx(Re,{tablaKey:"clasificaciones_clientes",onNavigate:F});case"armados":return a.jsx(Re,{tablaKey:"armados",onNavigate:F});case"procesos":return a.jsx(Re,{tablaKey:"procesos",onNavigate:F});case"pegados":return a.jsx(Re,{tablaKey:"pegados",onNavigate:F});case"envases":return a.jsx(Re,{tablaKey:"envases",onNavigate:F});case"rayados":return a.jsx(Re,{tablaKey:"rayados",onNavigate:F});case"papeles":return a.jsx(Re,{tablaKey:"papeles",onNavigate:F});case"cardboards":return a.jsx(Re,{tablaKey:"cardboards",onNavigate:F});case"carton-esquineros":return a.jsx(Re,{tablaKey:"carton_esquineros",onNavigate:F});case"plantas":return a.jsx(Re,{tablaKey:"plantas",onNavigate:F});case"tipo-ondas":return a.jsx(Re,{tablaKey:"tipo_ondas",onNavigate:F});case"factores-ondas":return a.jsx(Re,{tablaKey:"factores_ondas",onNavigate:F});case"factores-desarrollos":return a.jsx(Re,{tablaKey:"factores_desarrollos",onNavigate:F});case"factores-seguridads":return a.jsx(Re,{tablaKey:"factores_seguridads",onNavigate:F});case"areahcs":return a.jsx(Re,{tablaKey:"areahcs",onNavigate:F});case"consumo-adhesivos":return a.jsx(Re,{tablaKey:"consumo_adhesivos",onNavigate:F});case"consumo-energias":return a.jsx(Re,{tablaKey:"consumo_energias",onNavigate:F});case"consumo-adhesivo-pegados":return a.jsx(Re,{tablaKey:"consumo_adhesivo_pegados",onNavigate:F});case"merma-corrugadoras":return a.jsx(Re,{tablaKey:"merma_corrugadoras",onNavigate:F});case"merma-convertidoras":return a.jsx(Re,{tablaKey:"merma_convertidoras",onNavigate:F});case"mercados":return a.jsx(Re,{tablaKey:"mercados",onNavigate:F});case"rubros":return a.jsx(Re,{tablaKey:"rubros",onNavigate:F});case"ciudades-fletes":return a.jsx(Re,{tablaKey:"ciudades_fletes",onNavigate:F});case"fletes":return a.jsx(Re,{tablaKey:"fletes",onNavigate:F});case"maquila-servicios":return a.jsx(Re,{tablaKey:"maquila_servicios",onNavigate:F});case"tarifario":return a.jsx(Re,{tablaKey:"tarifario",onNavigate:F});case"tarifario-margens":return a.jsx(Re,{tablaKey:"tarifario_margens",onNavigate:F});case"variables-cotizador":return a.jsx(Re,{tablaKey:"variables_cotizador",onNavigate:F});case"insumos-palletizados":return a.jsx(Re,{tablaKey:"insumos_palletizados",onNavigate:F});case"detalle-precio-palletizados":return a.jsx(Re,{tablaKey:"detalle_precio_palletizados",onNavigate:F});case"paises":return a.jsx(Re,{tablaKey:"paises",onNavigate:F});case"fsc":return a.jsx(Re,{tablaKey:"fsc",onNavigate:F});case"reference-types":return a.jsx(Re,{tablaKey:"reference_types",onNavigate:F});case"recubrimiento-types":return a.jsx(Re,{tablaKey:"recubrimiento_types",onNavigate:F});case"carga-masiva":return a.jsx(ote,{onNavigate:F});case"cambiar-contrasena":return a.jsx(xte,{onNavigate:F});default:return a.jsx(XC,{onNavigate:F})}};return a.jsxs(Efe,{children:[a.jsx(Afe,{children:a.jsxs(Ffe,{children:[a.jsx(Pfe,{children:a.jsx(Dfe,{children:"INVEB"})}),a.jsxs(Mfe,{children:[!Un.isVendedorExterno(e.role_id)&&a.jsx(rc,{$active:r==="dashboard",onClick:()=>F("dashboard"),children:"Ordenes de Trabajo"}),Un.isVendedorExterno(e.role_id)?a.jsxs(a.Fragment,{children:[a.jsx(rc,{$active:r==="dashboard",onClick:()=>F("dashboard"),children:"Ordenes de Trabajo"}),a.jsxs(L_,{ref:C,children:[a.jsxs(z_,{$active:r==="cotizador-externo",onClick:()=>_(!y),children:["Cotizador",a.jsx(B_,{$open:y,children:""})]}),a.jsx(U_,{$open:y,children:a.jsx(zr,{children:a.jsx(Pe,{$active:r==="cotizador-externo",onClick:()=>F("cotizador-externo"),children:"Cotizaciones"})})})]})]}):a.jsxs(a.Fragment,{children:[!Un.isAdmin(e.role_id)&&!Un.isVendedor(e.role_id)&&a.jsx(rc,{$active:r==="notificaciones",onClick:()=>F("notificaciones"),children:"Notificaciones"}),!Un.isAdmin(e.role_id)&&!Un.isVendedor(e.role_id)&&a.jsx(rc,{$active:r==="asignaciones",onClick:()=>F("asignaciones"),children:"Asignaciones"}),Un.canApprove(e.role_id)&&a.jsx(rc,{$active:r==="aprobacion-ots",onClick:()=>F("aprobacion-ots"),children:"Aprobaciones"}),Un.canViewReports(e.role_id)&&a.jsx(rc,{$active:r==="reportes",onClick:()=>F("reportes"),children:"Reporteria"}),Un.canAccessMantenedores(e.role_id)&&a.jsxs(L_,{ref:C,children:[a.jsxs(z_,{$active:k,onClick:()=>_(!y),children:["Mantenedores",a.jsx(B_,{$open:y,children:""})]}),a.jsxs(U_,{$open:y,children:[a.jsxs(zr,{children:[a.jsx(wn,{children:"Principales"}),a.jsx(Pe,{$active:r==="clientes",onClick:()=>F("clientes"),children:"Clientes"}),Un.hasFullMantenedores(e.role_id)&&a.jsx(Pe,{$active:r==="usuarios",onClick:()=>F("usuarios"),children:"Usuarios"})]}),Un.hasFullMantenedores(e.role_id)&&a.jsxs(a.Fragment,{children:[a.jsxs(zr,{children:[a.jsx(wn,{children:"Jerarquias"}),a.jsx(Pe,{$active:r==="jerarquias-1",onClick:()=>F("jerarquias-1"),children:"Jerarquias Nivel 1"}),a.jsx(Pe,{$active:r==="jerarquias-2",onClick:()=>F("jerarquias-2"),children:"Jerarquias Nivel 2"}),a.jsx(Pe,{$active:r==="jerarquias-3",onClick:()=>F("jerarquias-3"),children:"Jerarquias Nivel 3"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Productos"}),a.jsx(Pe,{$active:r==="tipo-productos",onClick:()=>F("tipo-productos"),children:"Tipo de Productos"}),a.jsx(Pe,{$active:r==="estilos",onClick:()=>F("estilos"),children:"Estilos"}),a.jsx(Pe,{$active:r==="colores",onClick:()=>F("colores"),children:"Colores"}),a.jsx(Pe,{$active:r==="canales",onClick:()=>F("canales"),children:"Canales"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Logistica"}),a.jsx(Pe,{$active:r==="tipos-cintas",onClick:()=>F("tipos-cintas"),children:"Tipos de Cintas"}),a.jsx(Pe,{$active:r==="almacenes",onClick:()=>F("almacenes"),children:"Almacenes"}),a.jsx(Pe,{$active:r==="tipo-palet",onClick:()=>F("tipo-palet"),children:"Tipo de Palet"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Comercial"}),a.jsx(Pe,{$active:r==="organizaciones-ventas",onClick:()=>F("organizaciones-ventas"),children:"Organizaciones de Ventas"}),a.jsx(Pe,{$active:r==="grupo-imputacion-material",onClick:()=>F("grupo-imputacion-material"),children:"Grupo Imputacion Material"}),a.jsx(Pe,{$active:r==="matrices",onClick:()=>F("matrices"),children:"Matrices"}),a.jsx(Pe,{$active:r==="clasificaciones-clientes",onClick:()=>F("clasificaciones-clientes"),children:"Clasificaciones Clientes"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Produccion"}),a.jsx(Pe,{$active:r==="sectores",onClick:()=>F("sectores"),children:"Sectores"}),a.jsx(Pe,{$active:r==="cartones",onClick:()=>F("cartones"),children:"Cartones"}),a.jsx(Pe,{$active:r==="secuencias-operacionales",onClick:()=>F("secuencias-operacionales"),children:"Secuencias Operacionales"}),a.jsx(Pe,{$active:r==="rechazo-conjunto",onClick:()=>F("rechazo-conjunto"),children:"Rechazo Conjunto"}),a.jsx(Pe,{$active:r==="tiempo-tratamiento",onClick:()=>F("tiempo-tratamiento"),children:"Tiempo de Tratamiento"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Materiales"}),a.jsx(Pe,{$active:r==="materiales",onClick:()=>F("materiales"),children:"Materiales"}),a.jsx(Pe,{$active:r==="grupo-materiales-1",onClick:()=>F("grupo-materiales-1"),children:"Grupo Materiales 1"}),a.jsx(Pe,{$active:r==="grupo-materiales-2",onClick:()=>F("grupo-materiales-2"),children:"Grupo Materiales 2"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Configuracion"}),a.jsx(Pe,{$active:r==="grupo-plantas",onClick:()=>F("grupo-plantas"),children:"Grupo de Plantas"}),a.jsx(Pe,{$active:r==="adhesivos",onClick:()=>F("adhesivos"),children:"Adhesivos"}),a.jsx(Pe,{$active:r==="cebes",onClick:()=>F("cebes"),children:"CEBES"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Procesos"}),a.jsx(Pe,{$active:r==="armados",onClick:()=>F("armados"),children:"Armados"}),a.jsx(Pe,{$active:r==="procesos",onClick:()=>F("procesos"),children:"Procesos"}),a.jsx(Pe,{$active:r==="pegados",onClick:()=>F("pegados"),children:"Pegados"}),a.jsx(Pe,{$active:r==="envases",onClick:()=>F("envases"),children:"Envases"}),a.jsx(Pe,{$active:r==="rayados",onClick:()=>F("rayados"),children:"Rayados"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Papeles"}),a.jsx(Pe,{$active:r==="papeles",onClick:()=>F("papeles"),children:"Papeles"}),a.jsx(Pe,{$active:r==="cardboards",onClick:()=>F("cardboards"),children:"Cardboards"}),a.jsx(Pe,{$active:r==="carton-esquineros",onClick:()=>F("carton-esquineros"),children:"Carton Esquineros"}),a.jsx(Pe,{$active:r==="tipo-ondas",onClick:()=>F("tipo-ondas"),children:"Tipo Ondas"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Plantas"}),a.jsx(Pe,{$active:r==="plantas",onClick:()=>F("plantas"),children:"Plantas"}),a.jsx(Pe,{$active:r==="factores-ondas",onClick:()=>F("factores-ondas"),children:"Factores Ondas"}),a.jsx(Pe,{$active:r==="factores-desarrollos",onClick:()=>F("factores-desarrollos"),children:"Factores Desarrollos"}),a.jsx(Pe,{$active:r==="factores-seguridads",onClick:()=>F("factores-seguridads"),children:"Factores Seguridad"}),a.jsx(Pe,{$active:r==="areahcs",onClick:()=>F("areahcs"),children:"Area HCs"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Consumos"}),a.jsx(Pe,{$active:r==="consumo-adhesivos",onClick:()=>F("consumo-adhesivos"),children:"Consumo Adhesivos"}),a.jsx(Pe,{$active:r==="consumo-energias",onClick:()=>F("consumo-energias"),children:"Consumo Energias"}),a.jsx(Pe,{$active:r==="consumo-adhesivo-pegados",onClick:()=>F("consumo-adhesivo-pegados"),children:"Consumo Adhesivo Pegados"}),a.jsx(Pe,{$active:r==="merma-corrugadoras",onClick:()=>F("merma-corrugadoras"),children:"Merma Corrugadoras"}),a.jsx(Pe,{$active:r==="merma-convertidoras",onClick:()=>F("merma-convertidoras"),children:"Merma Convertidoras"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Comercial"}),a.jsx(Pe,{$active:r==="mercados",onClick:()=>F("mercados"),children:"Mercados"}),a.jsx(Pe,{$active:r==="rubros",onClick:()=>F("rubros"),children:"Rubros"}),a.jsx(Pe,{$active:r==="ciudades-fletes",onClick:()=>F("ciudades-fletes"),children:"Ciudades Fletes"}),a.jsx(Pe,{$active:r==="fletes",onClick:()=>F("fletes"),children:"Fletes"}),a.jsx(Pe,{$active:r==="maquila-servicios",onClick:()=>F("maquila-servicios"),children:"Maquila Servicios"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Tarifas"}),a.jsx(Pe,{$active:r==="tarifario",onClick:()=>F("tarifario"),children:"Tarifario"}),a.jsx(Pe,{$active:r==="tarifario-margens",onClick:()=>F("tarifario-margens"),children:"Tarifario Margenes"}),a.jsx(Pe,{$active:r==="variables-cotizador",onClick:()=>F("variables-cotizador"),children:"Variables Cotizador"}),a.jsx(Pe,{$active:r==="insumos-palletizados",onClick:()=>F("insumos-palletizados"),children:"Insumos Palletizados"}),a.jsx(Pe,{$active:r==="detalle-precio-palletizados",onClick:()=>F("detalle-precio-palletizados"),children:"Precio Palletizados"})]}),a.jsxs(zr,{children:[a.jsx(wn,{children:"Cotizador - Catalogos"}),a.jsx(Pe,{$active:r==="paises",onClick:()=>F("paises"),children:"Paises"}),a.jsx(Pe,{$active:r==="fsc",onClick:()=>F("fsc"),children:"FSC"}),a.jsx(Pe,{$active:r==="reference-types",onClick:()=>F("reference-types"),children:"Tipos Referencia"}),a.jsx(Pe,{$active:r==="recubrimiento-types",onClick:()=>F("recubrimiento-types"),children:"Tipos Recubrimiento"})]})]})]})]}),Un.canUseCotizador(e.role_id)&&a.jsxs(L_,{ref:j,children:[a.jsxs(z_,{$active:r==="cotizaciones"||r==="aprobaciones",onClick:()=>w(!b),children:["Cotizador",a.jsx(B_,{$open:b,children:""})]}),a.jsx(U_,{$open:b,children:a.jsxs(zr,{children:[a.jsx(Pe,{$active:r==="cotizaciones",onClick:()=>F("cotizaciones"),children:"Cotizaciones"}),Un.canApproveCotizaciones(e.role_id)&&a.jsx(Pe,{$active:r==="aprobaciones",onClick:()=>F("aprobaciones"),children:"Aprobar Cotizaciones"})]})})]}),Un.isVendedor(e.role_id)&&a.jsx(rc,{$active:r==="notificaciones",onClick:()=>F("notificaciones"),children:"Notificaciones"})]})]}),a.jsxs(Ofe,{children:[a.jsx(Rfe,{children:B}),a.jsx(Ife,{onClick:()=>F("cambiar-contrasena"),children:"Clave"}),a.jsx(Nfe,{onClick:t,children:"Salir"})]})]})}),a.jsx(Lfe,{children:L()})]})}function Bfe(){const[e,t]=E.useState(null),[r,n]=E.useState(!0),[s,i]=E.useState("login"),[o,l]=E.useState({});E.useEffect(()=>{const f=Ec.getStoredUser();f&&t(f),n(!1)},[]);const c=E.useCallback(async(f,m)=>{try{const g=await Ec.login({rut:f,password:m});return t(g.user),!0}catch(g){return console.error("Login failed:",g),!1}},[]),u=E.useCallback(()=>{Ec.logout(),t(null),i("login")},[]),h=E.useCallback((f,m)=>{i(f),m&&l(m)},[]);if(r)return null;if(!e)switch(s){case"forgot-password":return a.jsx(Pte,{onNavigate:h});case"reset-password":return a.jsx(Nte,{onNavigate:h,token:o.token,email:o.email});default:return a.jsx(Az,{onLogin:c,onNavigate:h})}return a.jsx(zfe,{user:e,onLogout:u})}function Ufe(){return a.jsxs(ZR,{client:Tfe,children:[a.jsx(vN,{}),a.jsx(Bfe,{})]})}V_.createRoot(document.getElementById("root")).render(a.jsx(li.StrictMode,{children:a.jsx(Ufe,{})}));
//# sourceMappingURL=index-yxwUN8RY.js.map
