var Y6=Object.defineProperty;var SC=e=>{throw TypeError(e)};var Q6=(e,t,r)=>t in e?Y6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Le=(e,t,r)=>Q6(e,typeof t!="symbol"?t+"":t,r),jv=(e,t,r)=>t.has(e)||SC("Cannot "+r);var te=(e,t,r)=>(jv(e,t,"read from private field"),r?r.call(e):t.get(e)),He=(e,t,r)=>t.has(e)?SC("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Oe=(e,t,r,n)=>(jv(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),it=(e,t,r)=>(jv(e,t,"access private method"),r);var Np=(e,t,r,n)=>({set _(i){Oe(e,t,i,r)},get _(){return te(e,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function J6(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var w3={exports:{}},D1={},k3={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cp=Symbol.for("react.element"),Z6=Symbol.for("react.portal"),eO=Symbol.for("react.fragment"),tO=Symbol.for("react.strict_mode"),rO=Symbol.for("react.profiler"),nO=Symbol.for("react.provider"),aO=Symbol.for("react.context"),iO=Symbol.for("react.forward_ref"),sO=Symbol.for("react.suspense"),oO=Symbol.for("react.memo"),lO=Symbol.for("react.lazy"),$C=Symbol.iterator;function cO(e){return e===null||typeof e!="object"?null:(e=$C&&e[$C]||e["@@iterator"],typeof e=="function"?e:null)}var C3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S3=Object.assign,$3={};function Ju(e,t,r){this.props=e,this.context=t,this.refs=$3,this.updater=r||C3}Ju.prototype.isReactComponent={};Ju.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ju.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function E3(){}E3.prototype=Ju.prototype;function h2(e,t,r){this.props=e,this.context=t,this.refs=$3,this.updater=r||C3}var f2=h2.prototype=new E3;f2.constructor=h2;S3(f2,Ju.prototype);f2.isPureReactComponent=!0;var EC=Array.isArray,T3=Object.prototype.hasOwnProperty,p2={current:null},A3={key:!0,ref:!0,__self:!0,__source:!0};function F3(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)T3.call(t,n)&&!A3.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:cp,type:e,key:s,ref:o,props:i,_owner:p2.current}}function dO(e,t){return{$$typeof:cp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function m2(e){return typeof e=="object"&&e!==null&&e.$$typeof===cp}function uO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var TC=/\/+/g;function wv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uO(""+e.key):t.toString(36)}function sx(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case cp:case Z6:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+wv(o,0):n,EC(i)?(r="",e!=null&&(r=e.replace(TC,"$&/")+"/"),sx(i,t,r,"",function(u){return u})):i!=null&&(m2(i)&&(i=dO(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(TC,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",EC(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+wv(s,l);o+=sx(s,t,r,c,i)}else if(c=cO(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+wv(s,l++),o+=sx(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function zp(e,t,r){if(e==null)return e;var n=[],i=0;return sx(e,n,"","",function(s){return t.call(r,s,i++)}),n}function hO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ta={current:null},ox={transition:null},fO={ReactCurrentDispatcher:ta,ReactCurrentBatchConfig:ox,ReactCurrentOwner:p2};function D3(){throw Error("act(...) is not supported in production builds of React.")}mt.Children={map:zp,forEach:function(e,t,r){zp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zp(e,function(){t++}),t},toArray:function(e){return zp(e,function(t){return t})||[]},only:function(e){if(!m2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};mt.Component=Ju;mt.Fragment=eO;mt.Profiler=rO;mt.PureComponent=h2;mt.StrictMode=tO;mt.Suspense=sO;mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fO;mt.act=D3;mt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=S3({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=p2.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T3.call(t,c)&&!A3.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:cp,type:e.type,key:i,ref:s,props:n,_owner:o}};mt.createContext=function(e){return e={$$typeof:aO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nO,_context:e},e.Consumer=e};mt.createElement=F3;mt.createFactory=function(e){var t=F3.bind(null,e);return t.type=e,t};mt.createRef=function(){return{current:null}};mt.forwardRef=function(e){return{$$typeof:iO,render:e}};mt.isValidElement=m2;mt.lazy=function(e){return{$$typeof:lO,_payload:{_status:-1,_result:e},_init:hO}};mt.memo=function(e,t){return{$$typeof:oO,type:e,compare:t===void 0?null:t}};mt.startTransition=function(e){var t=ox.transition;ox.transition={};try{e()}finally{ox.transition=t}};mt.unstable_act=D3;mt.useCallback=function(e,t){return ta.current.useCallback(e,t)};mt.useContext=function(e){return ta.current.useContext(e)};mt.useDebugValue=function(){};mt.useDeferredValue=function(e){return ta.current.useDeferredValue(e)};mt.useEffect=function(e,t){return ta.current.useEffect(e,t)};mt.useId=function(){return ta.current.useId()};mt.useImperativeHandle=function(e,t,r){return ta.current.useImperativeHandle(e,t,r)};mt.useInsertionEffect=function(e,t){return ta.current.useInsertionEffect(e,t)};mt.useLayoutEffect=function(e,t){return ta.current.useLayoutEffect(e,t)};mt.useMemo=function(e,t){return ta.current.useMemo(e,t)};mt.useReducer=function(e,t,r){return ta.current.useReducer(e,t,r)};mt.useRef=function(e){return ta.current.useRef(e)};mt.useState=function(e){return ta.current.useState(e)};mt.useSyncExternalStore=function(e,t,r){return ta.current.useSyncExternalStore(e,t,r)};mt.useTransition=function(){return ta.current.useTransition()};mt.version="18.3.1";k3.exports=mt;var S=k3.exports;const As=J6(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pO=S,mO=Symbol.for("react.element"),gO=Symbol.for("react.fragment"),xO=Object.prototype.hasOwnProperty,vO=pO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_O={key:!0,ref:!0,__self:!0,__source:!0};function P3(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)xO.call(t,n)&&!_O.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:mO,type:e,key:s,ref:o,props:i,_owner:vO.current}}D1.Fragment=gO;D1.jsx=P3;D1.jsxs=P3;w3.exports=D1;var a=w3.exports,gj={},M3={exports:{}},qa={},O3={exports:{}},R3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,z){var ie=q.length;q.push(z);e:for(;0<ie;){var he=ie-1>>>1,O=q[he];if(0<i(O,z))q[he]=z,q[ie]=O,ie=he;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var z=q[0],ie=q.pop();if(ie!==z){q[0]=ie;e:for(var he=0,O=q.length,R=O>>>1;he<R;){var I=2*(he+1)-1,K=q[I],ne=I+1,ee=q[ne];if(0>i(K,ie))ne<O&&0>i(ee,K)?(q[he]=ee,q[ne]=ie,he=ne):(q[he]=K,q[I]=ie,he=I);else if(ne<O&&0>i(ee,ie))q[he]=ee,q[ne]=ie,he=ne;else break e}}return z}function i(q,z){var ie=q.sortIndex-z.sortIndex;return ie!==0?ie:q.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,v=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(q){for(var z=r(u);z!==null;){if(z.callback===null)n(u);else if(z.startTime<=q)n(u),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(u)}}function k(q){if(x=!1,j(q),!g)if(r(c)!==null)g=!0,ae(E);else{var z=r(u);z!==null&&U(k,z.startTime-q)}}function E(q,z){g=!1,x&&(x=!1,b(P),P=-1),v=!0;var ie=m;try{for(j(z),f=r(c);f!==null&&(!(f.expirationTime>z)||q&&!D());){var he=f.callback;if(typeof he=="function"){f.callback=null,m=f.priorityLevel;var O=he(f.expirationTime<=z);z=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),j(z)}else n(c);f=r(c)}if(f!==null)var R=!0;else{var I=r(u);I!==null&&U(k,I.startTime-z),R=!1}return R}finally{f=null,m=ie,v=!1}}var A=!1,w=null,P=-1,M=5,F=-1;function D(){return!(e.unstable_now()-F<M)}function W(){if(w!==null){var q=e.unstable_now();F=q;var z=!0;try{z=w(!0,q)}finally{z?B():(A=!1,w=null)}}else A=!1}var B;if(typeof y=="function")B=function(){y(W)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Y=G.port2;G.port1.onmessage=W,B=function(){Y.postMessage(null)}}else B=function(){_(W,0)};function ae(q){w=q,A||(A=!0,B())}function U(q,z){P=_(function(){q(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){g||v||(g=!0,ae(E))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(m){case 1:case 2:case 3:var z=3;break;default:z=m}var ie=m;m=z;try{return q()}finally{m=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,z){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ie=m;m=q;try{return z()}finally{m=ie}},e.unstable_scheduleCallback=function(q,z,ie){var he=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?he+ie:he):ie=he,q){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ie+O,q={id:h++,callback:z,priorityLevel:q,startTime:ie,expirationTime:O,sortIndex:-1},ie>he?(q.sortIndex=ie,t(u,q),r(c)===null&&q===r(u)&&(x?(b(P),P=-1):x=!0,U(k,ie-he))):(q.sortIndex=O,t(c,q),g||v||(g=!0,ae(E))),q},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(q){var z=m;return function(){var ie=m;m=z;try{return q.apply(this,arguments)}finally{m=ie}}}})(R3);O3.exports=R3;var yO=O3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bO=S,Wa=yO;function Ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var N3=new Set,x0={};function pd(e,t){Pu(e,t),Pu(e+"Capture",t)}function Pu(e,t){for(x0[e]=t,e=0;e<t.length;e++)N3.add(t[e])}var yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xj=Object.prototype.hasOwnProperty,jO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AC={},FC={};function wO(e){return xj.call(FC,e)?!0:xj.call(AC,e)?!1:jO.test(e)?FC[e]=!0:(AC[e]=!0,!1)}function kO(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CO(e,t,r,n){if(t===null||typeof t>"u"||kO(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ra(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var pn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pn[e]=new ra(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pn[t]=new ra(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){pn[e]=new ra(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pn[e]=new ra(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pn[e]=new ra(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){pn[e]=new ra(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){pn[e]=new ra(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){pn[e]=new ra(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){pn[e]=new ra(e,5,!1,e.toLowerCase(),null,!1,!1)});var g2=/[\-:]([a-z])/g;function x2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g2,x2);pn[t]=new ra(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g2,x2);pn[t]=new ra(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g2,x2);pn[t]=new ra(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){pn[e]=new ra(e,1,!1,e.toLowerCase(),null,!1,!1)});pn.xlinkHref=new ra("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){pn[e]=new ra(e,1,!1,e.toLowerCase(),null,!0,!0)});function v2(e,t,r,n){var i=pn.hasOwnProperty(t)?pn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CO(t,r,i,n)&&(r=null),n||i===null?wO(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Co=bO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ip=Symbol.for("react.element"),qd=Symbol.for("react.portal"),Kd=Symbol.for("react.fragment"),_2=Symbol.for("react.strict_mode"),vj=Symbol.for("react.profiler"),z3=Symbol.for("react.provider"),I3=Symbol.for("react.context"),y2=Symbol.for("react.forward_ref"),_j=Symbol.for("react.suspense"),yj=Symbol.for("react.suspense_list"),b2=Symbol.for("react.memo"),nl=Symbol.for("react.lazy"),L3=Symbol.for("react.offscreen"),DC=Symbol.iterator;function mh(e){return e===null||typeof e!="object"?null:(e=DC&&e[DC]||e["@@iterator"],typeof e=="function"?e:null)}var or=Object.assign,kv;function Rf(e){if(kv===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);kv=t&&t[1]||""}return`
`+kv+e}var Cv=!1;function Sv(e,t){if(!e||Cv)return"";Cv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Cv=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Rf(e):""}function SO(e){switch(e.tag){case 5:return Rf(e.type);case 16:return Rf("Lazy");case 13:return Rf("Suspense");case 19:return Rf("SuspenseList");case 0:case 2:case 15:return e=Sv(e.type,!1),e;case 11:return e=Sv(e.type.render,!1),e;case 1:return e=Sv(e.type,!0),e;default:return""}}function bj(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kd:return"Fragment";case qd:return"Portal";case vj:return"Profiler";case _2:return"StrictMode";case _j:return"Suspense";case yj:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case I3:return(e.displayName||"Context")+".Consumer";case z3:return(e._context.displayName||"Context")+".Provider";case y2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case b2:return t=e.displayName||null,t!==null?t:bj(e.type)||"Memo";case nl:t=e._payload,e=e._init;try{return bj(e(t))}catch{}}return null}function $O(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bj(t);case 8:return t===_2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ml(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function B3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function EO(e){var t=B3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lp(e){e._valueTracker||(e._valueTracker=EO(e))}function U3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=B3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Dx(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jj(e,t){var r=t.checked;return or({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function PC(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ml(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function V3(e,t){t=t.checked,t!=null&&v2(e,"checked",t,!1)}function wj(e,t){V3(e,t);var r=Ml(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?kj(e,t.type,r):t.hasOwnProperty("defaultValue")&&kj(e,t.type,Ml(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function MC(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function kj(e,t,r){(t!=="number"||Dx(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Nf=Array.isArray;function lu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ml(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Cj(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ce(91));return or({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function OC(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ce(92));if(Nf(r)){if(1<r.length)throw Error(Ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ml(r)}}function H3(e,t){var r=Ml(t.value),n=Ml(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function RC(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sj(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Bp,G3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Bp=Bp||document.createElement("div"),Bp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function v0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Kf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},TO=["Webkit","ms","Moz","O"];Object.keys(Kf).forEach(function(e){TO.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kf[t]=Kf[e]})});function q3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Kf.hasOwnProperty(e)&&Kf[e]?(""+t).trim():t+"px"}function K3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=q3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var AO=or({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $j(e,t){if(t){if(AO[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ce(62))}}function Ej(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tj=null;function j2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Aj=null,cu=null,du=null;function NC(e){if(e=hp(e)){if(typeof Aj!="function")throw Error(Ce(280));var t=e.stateNode;t&&(t=N1(t),Aj(e.stateNode,e.type,t))}}function X3(e){cu?du?du.push(e):du=[e]:cu=e}function Y3(){if(cu){var e=cu,t=du;if(du=cu=null,NC(e),t)for(e=0;e<t.length;e++)NC(t[e])}}function Q3(e,t){return e(t)}function J3(){}var $v=!1;function Z3(e,t,r){if($v)return e(t,r);$v=!0;try{return Q3(e,t,r)}finally{$v=!1,(cu!==null||du!==null)&&(J3(),Y3())}}function _0(e,t){var r=e.stateNode;if(r===null)return null;var n=N1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ce(231,t,typeof r));return r}var Fj=!1;if(yo)try{var gh={};Object.defineProperty(gh,"passive",{get:function(){Fj=!0}}),window.addEventListener("test",gh,gh),window.removeEventListener("test",gh,gh)}catch{Fj=!1}function FO(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(h){this.onError(h)}}var Xf=!1,Px=null,Mx=!1,Dj=null,DO={onError:function(e){Xf=!0,Px=e}};function PO(e,t,r,n,i,s,o,l,c){Xf=!1,Px=null,FO.apply(DO,arguments)}function MO(e,t,r,n,i,s,o,l,c){if(PO.apply(this,arguments),Xf){if(Xf){var u=Px;Xf=!1,Px=null}else throw Error(Ce(198));Mx||(Mx=!0,Dj=u)}}function md(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function eF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function zC(e){if(md(e)!==e)throw Error(Ce(188))}function OO(e){var t=e.alternate;if(!t){if(t=md(e),t===null)throw Error(Ce(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return zC(i),e;if(s===n)return zC(i),t;s=s.sibling}throw Error(Ce(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Ce(189))}}if(r.alternate!==n)throw Error(Ce(190))}if(r.tag!==3)throw Error(Ce(188));return r.stateNode.current===r?e:t}function tF(e){return e=OO(e),e!==null?rF(e):null}function rF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rF(e);if(t!==null)return t;e=e.sibling}return null}var nF=Wa.unstable_scheduleCallback,IC=Wa.unstable_cancelCallback,RO=Wa.unstable_shouldYield,NO=Wa.unstable_requestPaint,yr=Wa.unstable_now,zO=Wa.unstable_getCurrentPriorityLevel,w2=Wa.unstable_ImmediatePriority,aF=Wa.unstable_UserBlockingPriority,Ox=Wa.unstable_NormalPriority,IO=Wa.unstable_LowPriority,iF=Wa.unstable_IdlePriority,P1=null,Ds=null;function LO(e){if(Ds&&typeof Ds.onCommitFiberRoot=="function")try{Ds.onCommitFiberRoot(P1,e,void 0,(e.current.flags&128)===128)}catch{}}var Zi=Math.clz32?Math.clz32:VO,BO=Math.log,UO=Math.LN2;function VO(e){return e>>>=0,e===0?32:31-(BO(e)/UO|0)|0}var Up=64,Vp=4194304;function zf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Rx(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=zf(l):(s&=o,s!==0&&(n=zf(s)))}else o=r&~i,o!==0?n=zf(o):s!==0&&(n=zf(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Zi(t),i=1<<r,n|=e[r],t&=~i;return n}function HO(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WO(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Zi(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=HO(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Pj(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sF(){var e=Up;return Up<<=1,!(Up&4194240)&&(Up=64),e}function Ev(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function dp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Zi(t),e[t]=r}function GO(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Zi(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function k2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Zi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Nt=0;function oF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lF,C2,cF,dF,uF,Mj=!1,Hp=[],wl=null,kl=null,Cl=null,y0=new Map,b0=new Map,il=[],qO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function LC(e,t){switch(e){case"focusin":case"focusout":wl=null;break;case"dragenter":case"dragleave":kl=null;break;case"mouseover":case"mouseout":Cl=null;break;case"pointerover":case"pointerout":y0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":b0.delete(t.pointerId)}}function xh(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=hp(t),t!==null&&C2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function KO(e,t,r,n,i){switch(t){case"focusin":return wl=xh(wl,e,t,r,n,i),!0;case"dragenter":return kl=xh(kl,e,t,r,n,i),!0;case"mouseover":return Cl=xh(Cl,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return y0.set(s,xh(y0.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,b0.set(s,xh(b0.get(s)||null,e,t,r,n,i)),!0}return!1}function hF(e){var t=Cc(e.target);if(t!==null){var r=md(t);if(r!==null){if(t=r.tag,t===13){if(t=eF(r),t!==null){e.blockedOn=t,uF(e.priority,function(){cF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lx(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Oj(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Tj=n,r.target.dispatchEvent(n),Tj=null}else return t=hp(r),t!==null&&C2(t),e.blockedOn=r,!1;t.shift()}return!0}function BC(e,t,r){lx(e)&&r.delete(t)}function XO(){Mj=!1,wl!==null&&lx(wl)&&(wl=null),kl!==null&&lx(kl)&&(kl=null),Cl!==null&&lx(Cl)&&(Cl=null),y0.forEach(BC),b0.forEach(BC)}function vh(e,t){e.blockedOn===t&&(e.blockedOn=null,Mj||(Mj=!0,Wa.unstable_scheduleCallback(Wa.unstable_NormalPriority,XO)))}function j0(e){function t(i){return vh(i,e)}if(0<Hp.length){vh(Hp[0],e);for(var r=1;r<Hp.length;r++){var n=Hp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(wl!==null&&vh(wl,e),kl!==null&&vh(kl,e),Cl!==null&&vh(Cl,e),y0.forEach(t),b0.forEach(t),r=0;r<il.length;r++)n=il[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<il.length&&(r=il[0],r.blockedOn===null);)hF(r),r.blockedOn===null&&il.shift()}var uu=Co.ReactCurrentBatchConfig,Nx=!0;function YO(e,t,r,n){var i=Nt,s=uu.transition;uu.transition=null;try{Nt=1,S2(e,t,r,n)}finally{Nt=i,uu.transition=s}}function QO(e,t,r,n){var i=Nt,s=uu.transition;uu.transition=null;try{Nt=4,S2(e,t,r,n)}finally{Nt=i,uu.transition=s}}function S2(e,t,r,n){if(Nx){var i=Oj(e,t,r,n);if(i===null)zv(e,t,n,zx,r),LC(e,n);else if(KO(i,e,t,r,n))n.stopPropagation();else if(LC(e,n),t&4&&-1<qO.indexOf(e)){for(;i!==null;){var s=hp(i);if(s!==null&&lF(s),s=Oj(e,t,r,n),s===null&&zv(e,t,n,zx,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else zv(e,t,n,null,r)}}var zx=null;function Oj(e,t,r,n){if(zx=null,e=j2(n),e=Cc(e),e!==null)if(t=md(e),t===null)e=null;else if(r=t.tag,r===13){if(e=eF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zx=e,null}function fF(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zO()){case w2:return 1;case aF:return 4;case Ox:case IO:return 16;case iF:return 536870912;default:return 16}default:return 16}}var gl=null,$2=null,cx=null;function pF(){if(cx)return cx;var e,t=$2,r=t.length,n,i="value"in gl?gl.value:gl.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return cx=i.slice(e,1<n?1-n:void 0)}function dx(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Wp(){return!0}function UC(){return!1}function Ka(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Wp:UC,this.isPropagationStopped=UC,this}return or(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Wp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Wp)},persist:function(){},isPersistent:Wp}),t}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},E2=Ka(Zu),up=or({},Zu,{view:0,detail:0}),JO=Ka(up),Tv,Av,_h,M1=or({},up,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:T2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_h&&(_h&&e.type==="mousemove"?(Tv=e.screenX-_h.screenX,Av=e.screenY-_h.screenY):Av=Tv=0,_h=e),Tv)},movementY:function(e){return"movementY"in e?e.movementY:Av}}),VC=Ka(M1),ZO=or({},M1,{dataTransfer:0}),eR=Ka(ZO),tR=or({},up,{relatedTarget:0}),Fv=Ka(tR),rR=or({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),nR=Ka(rR),aR=or({},Zu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),iR=Ka(aR),sR=or({},Zu,{data:0}),HC=Ka(sR),oR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cR[e])?!!t[e]:!1}function T2(){return dR}var uR=or({},up,{key:function(e){if(e.key){var t=oR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=dx(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:T2,charCode:function(e){return e.type==="keypress"?dx(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?dx(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),hR=Ka(uR),fR=or({},M1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),WC=Ka(fR),pR=or({},up,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:T2}),mR=Ka(pR),gR=or({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),xR=Ka(gR),vR=or({},M1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_R=Ka(vR),yR=[9,13,27,32],A2=yo&&"CompositionEvent"in window,Yf=null;yo&&"documentMode"in document&&(Yf=document.documentMode);var bR=yo&&"TextEvent"in window&&!Yf,mF=yo&&(!A2||Yf&&8<Yf&&11>=Yf),GC=" ",qC=!1;function gF(e,t){switch(e){case"keyup":return yR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xd=!1;function jR(e,t){switch(e){case"compositionend":return xF(t);case"keypress":return t.which!==32?null:(qC=!0,GC);case"textInput":return e=t.data,e===GC&&qC?null:e;default:return null}}function wR(e,t){if(Xd)return e==="compositionend"||!A2&&gF(e,t)?(e=pF(),cx=$2=gl=null,Xd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mF&&t.locale!=="ko"?null:t.data;default:return null}}var kR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!kR[e.type]:t==="textarea"}function vF(e,t,r,n){X3(n),t=Ix(t,"onChange"),0<t.length&&(r=new E2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Qf=null,w0=null;function CR(e){TF(e,0)}function O1(e){var t=Jd(e);if(U3(t))return e}function SR(e,t){if(e==="change")return t}var _F=!1;if(yo){var Dv;if(yo){var Pv="oninput"in document;if(!Pv){var XC=document.createElement("div");XC.setAttribute("oninput","return;"),Pv=typeof XC.oninput=="function"}Dv=Pv}else Dv=!1;_F=Dv&&(!document.documentMode||9<document.documentMode)}function YC(){Qf&&(Qf.detachEvent("onpropertychange",yF),w0=Qf=null)}function yF(e){if(e.propertyName==="value"&&O1(w0)){var t=[];vF(t,w0,e,j2(e)),Z3(CR,t)}}function $R(e,t,r){e==="focusin"?(YC(),Qf=t,w0=r,Qf.attachEvent("onpropertychange",yF)):e==="focusout"&&YC()}function ER(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return O1(w0)}function TR(e,t){if(e==="click")return O1(t)}function AR(e,t){if(e==="input"||e==="change")return O1(t)}function FR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var as=typeof Object.is=="function"?Object.is:FR;function k0(e,t){if(as(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!xj.call(t,i)||!as(e[i],t[i]))return!1}return!0}function QC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function JC(e,t){var r=QC(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=QC(r)}}function bF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bF(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jF(){for(var e=window,t=Dx();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Dx(e.document)}return t}function F2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function DR(e){var t=jF(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&bF(r.ownerDocument.documentElement,r)){if(n!==null&&F2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=JC(r,s);var o=JC(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var PR=yo&&"documentMode"in document&&11>=document.documentMode,Yd=null,Rj=null,Jf=null,Nj=!1;function ZC(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nj||Yd==null||Yd!==Dx(n)||(n=Yd,"selectionStart"in n&&F2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Jf&&k0(Jf,n)||(Jf=n,n=Ix(Rj,"onSelect"),0<n.length&&(t=new E2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Yd)))}function Gp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Qd={animationend:Gp("Animation","AnimationEnd"),animationiteration:Gp("Animation","AnimationIteration"),animationstart:Gp("Animation","AnimationStart"),transitionend:Gp("Transition","TransitionEnd")},Mv={},wF={};yo&&(wF=document.createElement("div").style,"AnimationEvent"in window||(delete Qd.animationend.animation,delete Qd.animationiteration.animation,delete Qd.animationstart.animation),"TransitionEvent"in window||delete Qd.transitionend.transition);function R1(e){if(Mv[e])return Mv[e];if(!Qd[e])return e;var t=Qd[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in wF)return Mv[e]=t[r];return e}var kF=R1("animationend"),CF=R1("animationiteration"),SF=R1("animationstart"),$F=R1("transitionend"),EF=new Map,eS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bl(e,t){EF.set(e,t),pd(t,[e])}for(var Ov=0;Ov<eS.length;Ov++){var Rv=eS[Ov],MR=Rv.toLowerCase(),OR=Rv[0].toUpperCase()+Rv.slice(1);Bl(MR,"on"+OR)}Bl(kF,"onAnimationEnd");Bl(CF,"onAnimationIteration");Bl(SF,"onAnimationStart");Bl("dblclick","onDoubleClick");Bl("focusin","onFocus");Bl("focusout","onBlur");Bl($F,"onTransitionEnd");Pu("onMouseEnter",["mouseout","mouseover"]);Pu("onMouseLeave",["mouseout","mouseover"]);Pu("onPointerEnter",["pointerout","pointerover"]);Pu("onPointerLeave",["pointerout","pointerover"]);pd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pd("onBeforeInput",["compositionend","keypress","textInput","paste"]);pd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var If="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RR=new Set("cancel close invalid load scroll toggle".split(" ").concat(If));function tS(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,MO(n,t,void 0,e),e.currentTarget=null}function TF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;tS(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;tS(i,l,u),s=c}}}if(Mx)throw e=Dj,Mx=!1,Dj=null,e}function Wt(e,t){var r=t[Uj];r===void 0&&(r=t[Uj]=new Set);var n=e+"__bubble";r.has(n)||(AF(t,e,2,!1),r.add(n))}function Nv(e,t,r){var n=0;t&&(n|=4),AF(r,e,n,t)}var qp="_reactListening"+Math.random().toString(36).slice(2);function C0(e){if(!e[qp]){e[qp]=!0,N3.forEach(function(r){r!=="selectionchange"&&(RR.has(r)||Nv(r,!1,e),Nv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qp]||(t[qp]=!0,Nv("selectionchange",!1,t))}}function AF(e,t,r,n){switch(fF(t)){case 1:var i=YO;break;case 4:i=QO;break;default:i=S2}r=i.bind(null,t,r,e),i=void 0,!Fj||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function zv(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Cc(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}Z3(function(){var u=s,h=j2(r),f=[];e:{var m=EF.get(e);if(m!==void 0){var v=E2,g=e;switch(e){case"keypress":if(dx(r)===0)break e;case"keydown":case"keyup":v=hR;break;case"focusin":g="focus",v=Fv;break;case"focusout":g="blur",v=Fv;break;case"beforeblur":case"afterblur":v=Fv;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=VC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=eR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=mR;break;case kF:case CF:case SF:v=nR;break;case $F:v=xR;break;case"scroll":v=JO;break;case"wheel":v=_R;break;case"copy":case"cut":case"paste":v=iR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=WC}var x=(t&4)!==0,_=!x&&e==="scroll",b=x?m!==null?m+"Capture":null:m;x=[];for(var y=u,j;y!==null;){j=y;var k=j.stateNode;if(j.tag===5&&k!==null&&(j=k,b!==null&&(k=_0(y,b),k!=null&&x.push(S0(y,k,j)))),_)break;y=y.return}0<x.length&&(m=new v(m,g,null,r,h),f.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",m&&r!==Tj&&(g=r.relatedTarget||r.fromElement)&&(Cc(g)||g[bo]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(g=r.relatedTarget||r.toElement,v=u,g=g?Cc(g):null,g!==null&&(_=md(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(v=null,g=u),v!==g)){if(x=VC,k="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(x=WC,k="onPointerLeave",b="onPointerEnter",y="pointer"),_=v==null?m:Jd(v),j=g==null?m:Jd(g),m=new x(k,y+"leave",v,r,h),m.target=_,m.relatedTarget=j,k=null,Cc(h)===u&&(x=new x(b,y+"enter",g,r,h),x.target=j,x.relatedTarget=_,k=x),_=k,v&&g)t:{for(x=v,b=g,y=0,j=x;j;j=Sd(j))y++;for(j=0,k=b;k;k=Sd(k))j++;for(;0<y-j;)x=Sd(x),y--;for(;0<j-y;)b=Sd(b),j--;for(;y--;){if(x===b||b!==null&&x===b.alternate)break t;x=Sd(x),b=Sd(b)}x=null}else x=null;v!==null&&rS(f,m,v,x,!1),g!==null&&_!==null&&rS(f,_,g,x,!0)}}e:{if(m=u?Jd(u):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var E=SR;else if(KC(m))if(_F)E=AR;else{E=ER;var A=$R}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=TR);if(E&&(E=E(e,u))){vF(f,E,r,h);break e}A&&A(e,m,u),e==="focusout"&&(A=m._wrapperState)&&A.controlled&&m.type==="number"&&kj(m,"number",m.value)}switch(A=u?Jd(u):window,e){case"focusin":(KC(A)||A.contentEditable==="true")&&(Yd=A,Rj=u,Jf=null);break;case"focusout":Jf=Rj=Yd=null;break;case"mousedown":Nj=!0;break;case"contextmenu":case"mouseup":case"dragend":Nj=!1,ZC(f,r,h);break;case"selectionchange":if(PR)break;case"keydown":case"keyup":ZC(f,r,h)}var w;if(A2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Xd?gF(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(mF&&r.locale!=="ko"&&(Xd||P!=="onCompositionStart"?P==="onCompositionEnd"&&Xd&&(w=pF()):(gl=h,$2="value"in gl?gl.value:gl.textContent,Xd=!0)),A=Ix(u,P),0<A.length&&(P=new HC(P,e,null,r,h),f.push({event:P,listeners:A}),w?P.data=w:(w=xF(r),w!==null&&(P.data=w)))),(w=bR?jR(e,r):wR(e,r))&&(u=Ix(u,"onBeforeInput"),0<u.length&&(h=new HC("onBeforeInput","beforeinput",null,r,h),f.push({event:h,listeners:u}),h.data=w))}TF(f,t)})}function S0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ix(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_0(e,r),s!=null&&n.unshift(S0(e,s,i)),s=_0(e,t),s!=null&&n.push(S0(e,s,i))),e=e.return}return n}function Sd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rS(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=_0(r,s),c!=null&&o.unshift(S0(r,c,l))):i||(c=_0(r,s),c!=null&&o.push(S0(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var NR=/\r\n?/g,zR=/\u0000|\uFFFD/g;function nS(e){return(typeof e=="string"?e:""+e).replace(NR,`
`).replace(zR,"")}function Kp(e,t,r){if(t=nS(t),nS(e)!==t&&r)throw Error(Ce(425))}function Lx(){}var zj=null,Ij=null;function Lj(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bj=typeof setTimeout=="function"?setTimeout:void 0,IR=typeof clearTimeout=="function"?clearTimeout:void 0,aS=typeof Promise=="function"?Promise:void 0,LR=typeof queueMicrotask=="function"?queueMicrotask:typeof aS<"u"?function(e){return aS.resolve(null).then(e).catch(BR)}:Bj;function BR(e){setTimeout(function(){throw e})}function Iv(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),j0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);j0(t)}function Sl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function iS(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var eh=Math.random().toString(36).slice(2),Ts="__reactFiber$"+eh,$0="__reactProps$"+eh,bo="__reactContainer$"+eh,Uj="__reactEvents$"+eh,UR="__reactListeners$"+eh,VR="__reactHandles$"+eh;function Cc(e){var t=e[Ts];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bo]||r[Ts]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=iS(e);e!==null;){if(r=e[Ts])return r;e=iS(e)}return t}e=r,r=e.parentNode}return null}function hp(e){return e=e[Ts]||e[bo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ce(33))}function N1(e){return e[$0]||null}var Vj=[],Zd=-1;function Ul(e){return{current:e}}function Xt(e){0>Zd||(e.current=Vj[Zd],Vj[Zd]=null,Zd--)}function Vt(e,t){Zd++,Vj[Zd]=e.current,e.current=t}var Ol={},zn=Ul(Ol),ya=Ul(!1),Jc=Ol;function Mu(e,t){var r=e.type.contextTypes;if(!r)return Ol;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ba(e){return e=e.childContextTypes,e!=null}function Bx(){Xt(ya),Xt(zn)}function sS(e,t,r){if(zn.current!==Ol)throw Error(Ce(168));Vt(zn,t),Vt(ya,r)}function FF(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ce(108,$O(e)||"Unknown",i));return or({},r,n)}function Ux(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ol,Jc=zn.current,Vt(zn,e),Vt(ya,ya.current),!0}function oS(e,t,r){var n=e.stateNode;if(!n)throw Error(Ce(169));r?(e=FF(e,t,Jc),n.__reactInternalMemoizedMergedChildContext=e,Xt(ya),Xt(zn),Vt(zn,e)):Xt(ya),Vt(ya,r)}var ro=null,z1=!1,Lv=!1;function DF(e){ro===null?ro=[e]:ro.push(e)}function HR(e){z1=!0,DF(e)}function Vl(){if(!Lv&&ro!==null){Lv=!0;var e=0,t=Nt;try{var r=ro;for(Nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ro=null,z1=!1}catch(i){throw ro!==null&&(ro=ro.slice(e+1)),nF(w2,Vl),i}finally{Nt=t,Lv=!1}}return null}var eu=[],tu=0,Vx=null,Hx=0,bi=[],ji=0,Zc=null,lo=1,co="";function yc(e,t){eu[tu++]=Hx,eu[tu++]=Vx,Vx=e,Hx=t}function PF(e,t,r){bi[ji++]=lo,bi[ji++]=co,bi[ji++]=Zc,Zc=e;var n=lo;e=co;var i=32-Zi(n)-1;n&=~(1<<i),r+=1;var s=32-Zi(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,lo=1<<32-Zi(t)+i|r<<i|n,co=s+e}else lo=1<<s|r<<i|n,co=e}function D2(e){e.return!==null&&(yc(e,1),PF(e,1,0))}function P2(e){for(;e===Vx;)Vx=eu[--tu],eu[tu]=null,Hx=eu[--tu],eu[tu]=null;for(;e===Zc;)Zc=bi[--ji],bi[ji]=null,co=bi[--ji],bi[ji]=null,lo=bi[--ji],bi[ji]=null}var Ha=null,Ua=null,Zt=!1,Yi=null;function MF(e,t){var r=wi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function lS(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ha=e,Ua=Sl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ha=e,Ua=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zc!==null?{id:lo,overflow:co}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ha=e,Ua=null,!0):!1;default:return!1}}function Hj(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Wj(e){if(Zt){var t=Ua;if(t){var r=t;if(!lS(e,t)){if(Hj(e))throw Error(Ce(418));t=Sl(r.nextSibling);var n=Ha;t&&lS(e,t)?MF(n,r):(e.flags=e.flags&-4097|2,Zt=!1,Ha=e)}}else{if(Hj(e))throw Error(Ce(418));e.flags=e.flags&-4097|2,Zt=!1,Ha=e}}}function cS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ha=e}function Xp(e){if(e!==Ha)return!1;if(!Zt)return cS(e),Zt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Lj(e.type,e.memoizedProps)),t&&(t=Ua)){if(Hj(e))throw OF(),Error(Ce(418));for(;t;)MF(e,t),t=Sl(t.nextSibling)}if(cS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ua=Sl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ua=null}}else Ua=Ha?Sl(e.stateNode.nextSibling):null;return!0}function OF(){for(var e=Ua;e;)e=Sl(e.nextSibling)}function Ou(){Ua=Ha=null,Zt=!1}function M2(e){Yi===null?Yi=[e]:Yi.push(e)}var WR=Co.ReactCurrentBatchConfig;function yh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ce(309));var n=r.stateNode}if(!n)throw Error(Ce(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ce(284));if(!r._owner)throw Error(Ce(290,e))}return e}function Yp(e,t){throw e=Object.prototype.toString.call(t),Error(Ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function dS(e){var t=e._init;return t(e._payload)}function RF(e){function t(b,y){if(e){var j=b.deletions;j===null?(b.deletions=[y],b.flags|=16):j.push(y)}}function r(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function n(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function i(b,y){return b=Al(b,y),b.index=0,b.sibling=null,b}function s(b,y,j){return b.index=j,e?(j=b.alternate,j!==null?(j=j.index,j<y?(b.flags|=2,y):j):(b.flags|=2,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,y,j,k){return y===null||y.tag!==6?(y=qv(j,b.mode,k),y.return=b,y):(y=i(y,j),y.return=b,y)}function c(b,y,j,k){var E=j.type;return E===Kd?h(b,y,j.props.children,k,j.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===nl&&dS(E)===y.type)?(k=i(y,j.props),k.ref=yh(b,y,j),k.return=b,k):(k=xx(j.type,j.key,j.props,null,b.mode,k),k.ref=yh(b,y,j),k.return=b,k)}function u(b,y,j,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==j.containerInfo||y.stateNode.implementation!==j.implementation?(y=Kv(j,b.mode,k),y.return=b,y):(y=i(y,j.children||[]),y.return=b,y)}function h(b,y,j,k,E){return y===null||y.tag!==7?(y=Vc(j,b.mode,k,E),y.return=b,y):(y=i(y,j),y.return=b,y)}function f(b,y,j){if(typeof y=="string"&&y!==""||typeof y=="number")return y=qv(""+y,b.mode,j),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ip:return j=xx(y.type,y.key,y.props,null,b.mode,j),j.ref=yh(b,null,y),j.return=b,j;case qd:return y=Kv(y,b.mode,j),y.return=b,y;case nl:var k=y._init;return f(b,k(y._payload),j)}if(Nf(y)||mh(y))return y=Vc(y,b.mode,j,null),y.return=b,y;Yp(b,y)}return null}function m(b,y,j,k){var E=y!==null?y.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return E!==null?null:l(b,y,""+j,k);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ip:return j.key===E?c(b,y,j,k):null;case qd:return j.key===E?u(b,y,j,k):null;case nl:return E=j._init,m(b,y,E(j._payload),k)}if(Nf(j)||mh(j))return E!==null?null:h(b,y,j,k,null);Yp(b,j)}return null}function v(b,y,j,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return b=b.get(j)||null,l(y,b,""+k,E);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ip:return b=b.get(k.key===null?j:k.key)||null,c(y,b,k,E);case qd:return b=b.get(k.key===null?j:k.key)||null,u(y,b,k,E);case nl:var A=k._init;return v(b,y,j,A(k._payload),E)}if(Nf(k)||mh(k))return b=b.get(j)||null,h(y,b,k,E,null);Yp(y,k)}return null}function g(b,y,j,k){for(var E=null,A=null,w=y,P=y=0,M=null;w!==null&&P<j.length;P++){w.index>P?(M=w,w=null):M=w.sibling;var F=m(b,w,j[P],k);if(F===null){w===null&&(w=M);break}e&&w&&F.alternate===null&&t(b,w),y=s(F,y,P),A===null?E=F:A.sibling=F,A=F,w=M}if(P===j.length)return r(b,w),Zt&&yc(b,P),E;if(w===null){for(;P<j.length;P++)w=f(b,j[P],k),w!==null&&(y=s(w,y,P),A===null?E=w:A.sibling=w,A=w);return Zt&&yc(b,P),E}for(w=n(b,w);P<j.length;P++)M=v(w,b,P,j[P],k),M!==null&&(e&&M.alternate!==null&&w.delete(M.key===null?P:M.key),y=s(M,y,P),A===null?E=M:A.sibling=M,A=M);return e&&w.forEach(function(D){return t(b,D)}),Zt&&yc(b,P),E}function x(b,y,j,k){var E=mh(j);if(typeof E!="function")throw Error(Ce(150));if(j=E.call(j),j==null)throw Error(Ce(151));for(var A=E=null,w=y,P=y=0,M=null,F=j.next();w!==null&&!F.done;P++,F=j.next()){w.index>P?(M=w,w=null):M=w.sibling;var D=m(b,w,F.value,k);if(D===null){w===null&&(w=M);break}e&&w&&D.alternate===null&&t(b,w),y=s(D,y,P),A===null?E=D:A.sibling=D,A=D,w=M}if(F.done)return r(b,w),Zt&&yc(b,P),E;if(w===null){for(;!F.done;P++,F=j.next())F=f(b,F.value,k),F!==null&&(y=s(F,y,P),A===null?E=F:A.sibling=F,A=F);return Zt&&yc(b,P),E}for(w=n(b,w);!F.done;P++,F=j.next())F=v(w,b,P,F.value,k),F!==null&&(e&&F.alternate!==null&&w.delete(F.key===null?P:F.key),y=s(F,y,P),A===null?E=F:A.sibling=F,A=F);return e&&w.forEach(function(W){return t(b,W)}),Zt&&yc(b,P),E}function _(b,y,j,k){if(typeof j=="object"&&j!==null&&j.type===Kd&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case Ip:e:{for(var E=j.key,A=y;A!==null;){if(A.key===E){if(E=j.type,E===Kd){if(A.tag===7){r(b,A.sibling),y=i(A,j.props.children),y.return=b,b=y;break e}}else if(A.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===nl&&dS(E)===A.type){r(b,A.sibling),y=i(A,j.props),y.ref=yh(b,A,j),y.return=b,b=y;break e}r(b,A);break}else t(b,A);A=A.sibling}j.type===Kd?(y=Vc(j.props.children,b.mode,k,j.key),y.return=b,b=y):(k=xx(j.type,j.key,j.props,null,b.mode,k),k.ref=yh(b,y,j),k.return=b,b=k)}return o(b);case qd:e:{for(A=j.key;y!==null;){if(y.key===A)if(y.tag===4&&y.stateNode.containerInfo===j.containerInfo&&y.stateNode.implementation===j.implementation){r(b,y.sibling),y=i(y,j.children||[]),y.return=b,b=y;break e}else{r(b,y);break}else t(b,y);y=y.sibling}y=Kv(j,b.mode,k),y.return=b,b=y}return o(b);case nl:return A=j._init,_(b,y,A(j._payload),k)}if(Nf(j))return g(b,y,j,k);if(mh(j))return x(b,y,j,k);Yp(b,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,y!==null&&y.tag===6?(r(b,y.sibling),y=i(y,j),y.return=b,b=y):(r(b,y),y=qv(j,b.mode,k),y.return=b,b=y),o(b)):r(b,y)}return _}var Ru=RF(!0),NF=RF(!1),Wx=Ul(null),Gx=null,ru=null,O2=null;function R2(){O2=ru=Gx=null}function N2(e){var t=Wx.current;Xt(Wx),e._currentValue=t}function Gj(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function hu(e,t){Gx=e,O2=ru=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(va=!0),e.firstContext=null)}function Ei(e){var t=e._currentValue;if(O2!==e)if(e={context:e,memoizedValue:t,next:null},ru===null){if(Gx===null)throw Error(Ce(308));ru=e,Gx.dependencies={lanes:0,firstContext:e}}else ru=ru.next=e;return t}var Sc=null;function z2(e){Sc===null?Sc=[e]:Sc.push(e)}function zF(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,z2(t)):(r.next=i.next,i.next=r),t.interleaved=r,jo(e,n)}function jo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var al=!1;function I2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IF(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function po(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $l(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,bt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,jo(e,r)}return i=n.interleaved,i===null?(t.next=t,z2(n)):(t.next=i.next,i.next=t),n.interleaved=t,jo(e,r)}function ux(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k2(e,r)}}function uS(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function qx(e,t,r,n){var i=e.updateQueue;al=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,h=u=c=null,l=s;do{var m=l.lane,v=l.eventTime;if((n&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,x=l;switch(m=t,v=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){f=g.call(v,f,m);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,m=typeof g=="function"?g.call(v,f,m):g,m==null)break e;f=or({},f,m);break e;case 2:al=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else v={eventTime:v,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=v,c=f):h=h.next=v,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);td|=o,e.lanes=o,e.memoizedState=f}}function hS(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ce(191,i));i.call(n)}}}var fp={},Ps=Ul(fp),E0=Ul(fp),T0=Ul(fp);function $c(e){if(e===fp)throw Error(Ce(174));return e}function L2(e,t){switch(Vt(T0,t),Vt(E0,e),Vt(Ps,fp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sj(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sj(t,e)}Xt(Ps),Vt(Ps,t)}function Nu(){Xt(Ps),Xt(E0),Xt(T0)}function LF(e){$c(T0.current);var t=$c(Ps.current),r=Sj(t,e.type);t!==r&&(Vt(E0,e),Vt(Ps,r))}function B2(e){E0.current===e&&(Xt(Ps),Xt(E0))}var rr=Ul(0);function Kx(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bv=[];function U2(){for(var e=0;e<Bv.length;e++)Bv[e]._workInProgressVersionPrimary=null;Bv.length=0}var hx=Co.ReactCurrentDispatcher,Uv=Co.ReactCurrentBatchConfig,ed=0,sr=null,Rr=null,Qr=null,Xx=!1,Zf=!1,A0=0,GR=0;function vn(){throw Error(Ce(321))}function V2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!as(e[r],t[r]))return!1;return!0}function H2(e,t,r,n,i,s){if(ed=s,sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hx.current=e===null||e.memoizedState===null?YR:QR,e=r(n,i),Zf){s=0;do{if(Zf=!1,A0=0,25<=s)throw Error(Ce(301));s+=1,Qr=Rr=null,t.updateQueue=null,hx.current=JR,e=r(n,i)}while(Zf)}if(hx.current=Yx,t=Rr!==null&&Rr.next!==null,ed=0,Qr=Rr=sr=null,Xx=!1,t)throw Error(Ce(300));return e}function W2(){var e=A0!==0;return A0=0,e}function ws(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?sr.memoizedState=Qr=e:Qr=Qr.next=e,Qr}function Ti(){if(Rr===null){var e=sr.alternate;e=e!==null?e.memoizedState:null}else e=Rr.next;var t=Qr===null?sr.memoizedState:Qr.next;if(t!==null)Qr=t,Rr=e;else{if(e===null)throw Error(Ce(310));Rr=e,e={memoizedState:Rr.memoizedState,baseState:Rr.baseState,baseQueue:Rr.baseQueue,queue:Rr.queue,next:null},Qr===null?sr.memoizedState=Qr=e:Qr=Qr.next=e}return Qr}function F0(e,t){return typeof t=="function"?t(e):t}function Vv(e){var t=Ti(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=Rr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((ed&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,sr.lanes|=h,td|=h}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,as(n,t.memoizedState)||(va=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,sr.lanes|=s,td|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Hv(e){var t=Ti(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);as(s,t.memoizedState)||(va=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function BF(){}function UF(e,t){var r=sr,n=Ti(),i=t(),s=!as(n.memoizedState,i);if(s&&(n.memoizedState=i,va=!0),n=n.queue,G2(WF.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Qr!==null&&Qr.memoizedState.tag&1){if(r.flags|=2048,D0(9,HF.bind(null,r,n,i,t),void 0,null),tn===null)throw Error(Ce(349));ed&30||VF(r,t,i)}return i}function VF(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=sr.updateQueue,t===null?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function HF(e,t,r,n){t.value=r,t.getSnapshot=n,GF(t)&&qF(e)}function WF(e,t,r){return r(function(){GF(t)&&qF(e)})}function GF(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!as(e,r)}catch{return!0}}function qF(e){var t=jo(e,1);t!==null&&es(t,e,1,-1)}function fS(e){var t=ws();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:F0,lastRenderedState:e},t.queue=e,e=e.dispatch=XR.bind(null,sr,e),[t.memoizedState,e]}function D0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=sr.updateQueue,t===null?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function KF(){return Ti().memoizedState}function fx(e,t,r,n){var i=ws();sr.flags|=e,i.memoizedState=D0(1|t,r,void 0,n===void 0?null:n)}function I1(e,t,r,n){var i=Ti();n=n===void 0?null:n;var s=void 0;if(Rr!==null){var o=Rr.memoizedState;if(s=o.destroy,n!==null&&V2(n,o.deps)){i.memoizedState=D0(t,r,s,n);return}}sr.flags|=e,i.memoizedState=D0(1|t,r,s,n)}function pS(e,t){return fx(8390656,8,e,t)}function G2(e,t){return I1(2048,8,e,t)}function XF(e,t){return I1(4,2,e,t)}function YF(e,t){return I1(4,4,e,t)}function QF(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function JF(e,t,r){return r=r!=null?r.concat([e]):null,I1(4,4,QF.bind(null,t,e),r)}function q2(){}function ZF(e,t){var r=Ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&V2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function eD(e,t){var r=Ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&V2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function tD(e,t,r){return ed&21?(as(r,t)||(r=sF(),sr.lanes|=r,td|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,va=!0),e.memoizedState=r)}function qR(e,t){var r=Nt;Nt=r!==0&&4>r?r:4,e(!0);var n=Uv.transition;Uv.transition={};try{e(!1),t()}finally{Nt=r,Uv.transition=n}}function rD(){return Ti().memoizedState}function KR(e,t,r){var n=Tl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nD(e))aD(t,r);else if(r=zF(e,t,r,n),r!==null){var i=Jn();es(r,e,n,i),iD(r,t,n)}}function XR(e,t,r){var n=Tl(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nD(e))aD(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,as(l,o)){var c=t.interleaved;c===null?(i.next=i,z2(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=zF(e,t,i,n),r!==null&&(i=Jn(),es(r,e,n,i),iD(r,t,n))}}function nD(e){var t=e.alternate;return e===sr||t!==null&&t===sr}function aD(e,t){Zf=Xx=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function iD(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k2(e,r)}}var Yx={readContext:Ei,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},YR={readContext:Ei,useCallback:function(e,t){return ws().memoizedState=[e,t===void 0?null:t],e},useContext:Ei,useEffect:pS,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,fx(4194308,4,QF.bind(null,t,e),r)},useLayoutEffect:function(e,t){return fx(4194308,4,e,t)},useInsertionEffect:function(e,t){return fx(4,2,e,t)},useMemo:function(e,t){var r=ws();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ws();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=KR.bind(null,sr,e),[n.memoizedState,e]},useRef:function(e){var t=ws();return e={current:e},t.memoizedState=e},useState:fS,useDebugValue:q2,useDeferredValue:function(e){return ws().memoizedState=e},useTransition:function(){var e=fS(!1),t=e[0];return e=qR.bind(null,e[1]),ws().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=sr,i=ws();if(Zt){if(r===void 0)throw Error(Ce(407));r=r()}else{if(r=t(),tn===null)throw Error(Ce(349));ed&30||VF(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,pS(WF.bind(null,n,s,e),[e]),n.flags|=2048,D0(9,HF.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ws(),t=tn.identifierPrefix;if(Zt){var r=co,n=lo;r=(n&~(1<<32-Zi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=A0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=GR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},QR={readContext:Ei,useCallback:ZF,useContext:Ei,useEffect:G2,useImperativeHandle:JF,useInsertionEffect:XF,useLayoutEffect:YF,useMemo:eD,useReducer:Vv,useRef:KF,useState:function(){return Vv(F0)},useDebugValue:q2,useDeferredValue:function(e){var t=Ti();return tD(t,Rr.memoizedState,e)},useTransition:function(){var e=Vv(F0)[0],t=Ti().memoizedState;return[e,t]},useMutableSource:BF,useSyncExternalStore:UF,useId:rD,unstable_isNewReconciler:!1},JR={readContext:Ei,useCallback:ZF,useContext:Ei,useEffect:G2,useImperativeHandle:JF,useInsertionEffect:XF,useLayoutEffect:YF,useMemo:eD,useReducer:Hv,useRef:KF,useState:function(){return Hv(F0)},useDebugValue:q2,useDeferredValue:function(e){var t=Ti();return Rr===null?t.memoizedState=e:tD(t,Rr.memoizedState,e)},useTransition:function(){var e=Hv(F0)[0],t=Ti().memoizedState;return[e,t]},useMutableSource:BF,useSyncExternalStore:UF,useId:rD,unstable_isNewReconciler:!1};function Gi(e,t){if(e&&e.defaultProps){t=or({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qj(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:or({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var L1={isMounted:function(e){return(e=e._reactInternals)?md(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=Tl(e),s=po(n,i);s.payload=t,r!=null&&(s.callback=r),t=$l(e,s,i),t!==null&&(es(t,e,i,n),ux(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jn(),i=Tl(e),s=po(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=$l(e,s,i),t!==null&&(es(t,e,i,n),ux(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jn(),n=Tl(e),i=po(r,n);i.tag=2,t!=null&&(i.callback=t),t=$l(e,i,n),t!==null&&(es(t,e,n,r),ux(t,e,n))}};function mS(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!k0(r,n)||!k0(i,s):!0}function sD(e,t,r){var n=!1,i=Ol,s=t.contextType;return typeof s=="object"&&s!==null?s=Ei(s):(i=ba(t)?Jc:zn.current,n=t.contextTypes,s=(n=n!=null)?Mu(e,i):Ol),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=L1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function gS(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&L1.enqueueReplaceState(t,t.state,null)}function Kj(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},I2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ei(s):(s=ba(t)?Jc:zn.current,i.context=Mu(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(qj(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&L1.enqueueReplaceState(i,i.state,null),qx(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function zu(e,t){try{var r="",n=t;do r+=SO(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Wv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Xj(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ZR=typeof WeakMap=="function"?WeakMap:Map;function oD(e,t,r){r=po(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Jx||(Jx=!0,iw=n),Xj(e,t)},r}function lD(e,t,r){r=po(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Xj(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Xj(e,t),typeof n!="function"&&(El===null?El=new Set([this]):El.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function xS(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ZR;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=fN.bind(null,e,t,r),t.then(e,e))}function vS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _S(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=po(-1,1),t.tag=2,$l(r,t,1))),r.lanes|=1),e)}var eN=Co.ReactCurrentOwner,va=!1;function Kn(e,t,r,n){t.child=e===null?NF(t,null,r,n):Ru(t,e.child,r,n)}function yS(e,t,r,n,i){r=r.render;var s=t.ref;return hu(t,i),n=H2(e,t,r,n,s,i),r=W2(),e!==null&&!va?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,wo(e,t,i)):(Zt&&r&&D2(t),t.flags|=1,Kn(e,t,n,i),t.child)}function bS(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!tk(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,cD(e,t,s,n,i)):(e=xx(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:k0,r(o,n)&&e.ref===t.ref)return wo(e,t,i)}return t.flags|=1,e=Al(s,n),e.ref=t.ref,e.return=t,t.child=e}function cD(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(k0(s,n)&&e.ref===t.ref)if(va=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(va=!0);else return t.lanes=e.lanes,wo(e,t,i)}return Yj(e,t,r,n,i)}function dD(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(au,Ra),Ra|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Vt(au,Ra),Ra|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Vt(au,Ra),Ra|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Vt(au,Ra),Ra|=n;return Kn(e,t,i,r),t.child}function uD(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Yj(e,t,r,n,i){var s=ba(r)?Jc:zn.current;return s=Mu(t,s),hu(t,i),r=H2(e,t,r,n,s,i),n=W2(),e!==null&&!va?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,wo(e,t,i)):(Zt&&n&&D2(t),t.flags|=1,Kn(e,t,r,i),t.child)}function jS(e,t,r,n,i){if(ba(r)){var s=!0;Ux(t)}else s=!1;if(hu(t,i),t.stateNode===null)px(e,t),sD(t,r,n),Kj(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ei(u):(u=ba(r)?Jc:zn.current,u=Mu(t,u));var h=r.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&gS(t,o,n,u),al=!1;var m=t.memoizedState;o.state=m,qx(t,n,o,i),c=t.memoizedState,l!==n||m!==c||ya.current||al?(typeof h=="function"&&(qj(t,r,h,n),c=t.memoizedState),(l=al||mS(t,r,l,n,m,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,IF(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Gi(t.type,l),o.props=u,f=t.pendingProps,m=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ei(c):(c=ba(r)?Jc:zn.current,c=Mu(t,c));var v=r.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&gS(t,o,n,c),al=!1,m=t.memoizedState,o.state=m,qx(t,n,o,i);var g=t.memoizedState;l!==f||m!==g||ya.current||al?(typeof v=="function"&&(qj(t,r,v,n),g=t.memoizedState),(u=al||mS(t,r,u,n,m,g,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Qj(e,t,r,n,s,i)}function Qj(e,t,r,n,i,s){uD(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&oS(t,r,!1),wo(e,t,s);n=t.stateNode,eN.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Ru(t,e.child,null,s),t.child=Ru(t,null,l,s)):Kn(e,t,l,s),t.memoizedState=n.state,i&&oS(t,r,!0),t.child}function hD(e){var t=e.stateNode;t.pendingContext?sS(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sS(e,t.context,!1),L2(e,t.containerInfo)}function wS(e,t,r,n,i){return Ou(),M2(i),t.flags|=256,Kn(e,t,r,n),t.child}var Jj={dehydrated:null,treeContext:null,retryLane:0};function Zj(e){return{baseLanes:e,cachePool:null,transitions:null}}function fD(e,t,r){var n=t.pendingProps,i=rr.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Vt(rr,i&1),e===null)return Wj(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=V1(o,n,0,null),e=Vc(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Zj(r),t.memoizedState=Jj,e):K2(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return tN(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Al(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Al(l,s):(s=Vc(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?Zj(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Jj,n}return s=e.child,e=s.sibling,n=Al(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function K2(e,t){return t=V1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Qp(e,t,r,n){return n!==null&&M2(n),Ru(t,e.child,null,r),e=K2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tN(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Wv(Error(Ce(422))),Qp(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=V1({mode:"visible",children:n.children},i,0,null),s=Vc(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ru(t,e.child,null,o),t.child.memoizedState=Zj(o),t.memoizedState=Jj,s);if(!(t.mode&1))return Qp(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Ce(419)),n=Wv(s,n,void 0),Qp(e,t,o,n)}if(l=(o&e.childLanes)!==0,va||l){if(n=tn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jo(e,i),es(n,e,i,-1))}return ek(),n=Wv(Error(Ce(421))),Qp(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=pN.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Ua=Sl(i.nextSibling),Ha=t,Zt=!0,Yi=null,e!==null&&(bi[ji++]=lo,bi[ji++]=co,bi[ji++]=Zc,lo=e.id,co=e.overflow,Zc=t),t=K2(t,n.children),t.flags|=4096,t)}function kS(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Gj(e.return,t,r)}function Gv(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function pD(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Kn(e,t,n.children,r),n=rr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&kS(e,r,t);else if(e.tag===19)kS(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Vt(rr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Kx(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Gv(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Kx(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Gv(t,!0,r,null,s);break;case"together":Gv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function px(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),td|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ce(153));if(t.child!==null){for(e=t.child,r=Al(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Al(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function rN(e,t,r){switch(t.tag){case 3:hD(t),Ou();break;case 5:LF(t);break;case 1:ba(t.type)&&Ux(t);break;case 4:L2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Vt(Wx,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Vt(rr,rr.current&1),t.flags|=128,null):r&t.child.childLanes?fD(e,t,r):(Vt(rr,rr.current&1),e=wo(e,t,r),e!==null?e.sibling:null);Vt(rr,rr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return pD(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Vt(rr,rr.current),n)break;return null;case 22:case 23:return t.lanes=0,dD(e,t,r)}return wo(e,t,r)}var mD,ew,gD,xD;mD=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ew=function(){};gD=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,$c(Ps.current);var s=null;switch(r){case"input":i=jj(e,i),n=jj(e,n),s=[];break;case"select":i=or({},i,{value:void 0}),n=or({},n,{value:void 0}),s=[];break;case"textarea":i=Cj(e,i),n=Cj(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Lx)}$j(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(x0.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(x0.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Wt("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};xD=function(e,t,r,n){r!==n&&(t.flags|=4)};function bh(e,t){if(!Zt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _n(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function nN(e,t,r){var n=t.pendingProps;switch(P2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(t),null;case 1:return ba(t.type)&&Bx(),_n(t),null;case 3:return n=t.stateNode,Nu(),Xt(ya),Xt(zn),U2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Xp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yi!==null&&(lw(Yi),Yi=null))),ew(e,t),_n(t),null;case 5:B2(t);var i=$c(T0.current);if(r=t.type,e!==null&&t.stateNode!=null)gD(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ce(166));return _n(t),null}if(e=$c(Ps.current),Xp(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ts]=t,n[$0]=s,e=(t.mode&1)!==0,r){case"dialog":Wt("cancel",n),Wt("close",n);break;case"iframe":case"object":case"embed":Wt("load",n);break;case"video":case"audio":for(i=0;i<If.length;i++)Wt(If[i],n);break;case"source":Wt("error",n);break;case"img":case"image":case"link":Wt("error",n),Wt("load",n);break;case"details":Wt("toggle",n);break;case"input":PC(n,s),Wt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Wt("invalid",n);break;case"textarea":OC(n,s),Wt("invalid",n)}$j(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Kp(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Kp(n.textContent,l,e),i=["children",""+l]):x0.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Wt("scroll",n)}switch(r){case"input":Lp(n),MC(n,s,!0);break;case"textarea":Lp(n),RC(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Lx)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ts]=t,e[$0]=n,mD(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ej(r,n),r){case"dialog":Wt("cancel",e),Wt("close",e),i=n;break;case"iframe":case"object":case"embed":Wt("load",e),i=n;break;case"video":case"audio":for(i=0;i<If.length;i++)Wt(If[i],e);i=n;break;case"source":Wt("error",e),i=n;break;case"img":case"image":case"link":Wt("error",e),Wt("load",e),i=n;break;case"details":Wt("toggle",e),i=n;break;case"input":PC(e,n),i=jj(e,n),Wt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=or({},n,{value:void 0}),Wt("invalid",e);break;case"textarea":OC(e,n),i=Cj(e,n),Wt("invalid",e);break;default:i=n}$j(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?K3(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&G3(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&v0(e,c):typeof c=="number"&&v0(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(x0.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Wt("scroll",e):c!=null&&v2(e,s,c,o))}switch(r){case"input":Lp(e),MC(e,n,!1);break;case"textarea":Lp(e),RC(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ml(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?lu(e,!!n.multiple,s,!1):n.defaultValue!=null&&lu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Lx)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _n(t),null;case 6:if(e&&t.stateNode!=null)xD(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ce(166));if(r=$c(T0.current),$c(Ps.current),Xp(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ts]=t,(s=n.nodeValue!==r)&&(e=Ha,e!==null))switch(e.tag){case 3:Kp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Kp(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ts]=t,t.stateNode=n}return _n(t),null;case 13:if(Xt(rr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Zt&&Ua!==null&&t.mode&1&&!(t.flags&128))OF(),Ou(),t.flags|=98560,s=!1;else if(s=Xp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Ce(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ce(317));s[Ts]=t}else Ou(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_n(t),s=!1}else Yi!==null&&(lw(Yi),Yi=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||rr.current&1?Lr===0&&(Lr=3):ek())),t.updateQueue!==null&&(t.flags|=4),_n(t),null);case 4:return Nu(),ew(e,t),e===null&&C0(t.stateNode.containerInfo),_n(t),null;case 10:return N2(t.type._context),_n(t),null;case 17:return ba(t.type)&&Bx(),_n(t),null;case 19:if(Xt(rr),s=t.memoizedState,s===null)return _n(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)bh(s,!1);else{if(Lr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Kx(e),o!==null){for(t.flags|=128,bh(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Vt(rr,rr.current&1|2),t.child}e=e.sibling}s.tail!==null&&yr()>Iu&&(t.flags|=128,n=!0,bh(s,!1),t.lanes=4194304)}else{if(!n)if(e=Kx(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Zt)return _n(t),null}else 2*yr()-s.renderingStartTime>Iu&&r!==1073741824&&(t.flags|=128,n=!0,bh(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=yr(),t.sibling=null,r=rr.current,Vt(rr,n?r&1|2:r&1),t):(_n(t),null);case 22:case 23:return Z2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ra&1073741824&&(_n(t),t.subtreeFlags&6&&(t.flags|=8192)):_n(t),null;case 24:return null;case 25:return null}throw Error(Ce(156,t.tag))}function aN(e,t){switch(P2(t),t.tag){case 1:return ba(t.type)&&Bx(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Nu(),Xt(ya),Xt(zn),U2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return B2(t),null;case 13:if(Xt(rr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ce(340));Ou()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xt(rr),null;case 4:return Nu(),null;case 10:return N2(t.type._context),null;case 22:case 23:return Z2(),null;case 24:return null;default:return null}}var Jp=!1,En=!1,iN=typeof WeakSet=="function"?WeakSet:Set,ze=null;function nu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ur(e,t,n)}else r.current=null}function tw(e,t,r){try{r()}catch(n){ur(e,t,n)}}var CS=!1;function sN(e,t){if(zj=Nx,e=jF(),F2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,m=null;t:for(;;){for(var v;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)m=f,f=v;for(;;){if(f===e)break t;if(m===r&&++u===i&&(l=o),m===s&&++h===n&&(c=o),(v=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=v}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ij={focusedElem:e,selectionRange:r},Nx=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,_=g.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?x:Gi(t.type,x),_);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var j=t.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ce(163))}}catch(k){ur(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return g=CS,CS=!1,g}function e0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&tw(t,r,s)}i=i.next}while(i!==n)}}function B1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function rw(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function vD(e){var t=e.alternate;t!==null&&(e.alternate=null,vD(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ts],delete t[$0],delete t[Uj],delete t[UR],delete t[VR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _D(e){return e.tag===5||e.tag===3||e.tag===4}function SS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_D(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Lx));else if(n!==4&&(e=e.child,e!==null))for(nw(e,t,r),e=e.sibling;e!==null;)nw(e,t,r),e=e.sibling}function aw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(aw(e,t,r),e=e.sibling;e!==null;)aw(e,t,r),e=e.sibling}var dn=null,Xi=!1;function Do(e,t,r){for(r=r.child;r!==null;)yD(e,t,r),r=r.sibling}function yD(e,t,r){if(Ds&&typeof Ds.onCommitFiberUnmount=="function")try{Ds.onCommitFiberUnmount(P1,r)}catch{}switch(r.tag){case 5:En||nu(r,t);case 6:var n=dn,i=Xi;dn=null,Do(e,t,r),dn=n,Xi=i,dn!==null&&(Xi?(e=dn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):dn.removeChild(r.stateNode));break;case 18:dn!==null&&(Xi?(e=dn,r=r.stateNode,e.nodeType===8?Iv(e.parentNode,r):e.nodeType===1&&Iv(e,r),j0(e)):Iv(dn,r.stateNode));break;case 4:n=dn,i=Xi,dn=r.stateNode.containerInfo,Xi=!0,Do(e,t,r),dn=n,Xi=i;break;case 0:case 11:case 14:case 15:if(!En&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&tw(r,t,o),i=i.next}while(i!==n)}Do(e,t,r);break;case 1:if(!En&&(nu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ur(r,t,l)}Do(e,t,r);break;case 21:Do(e,t,r);break;case 22:r.mode&1?(En=(n=En)||r.memoizedState!==null,Do(e,t,r),En=n):Do(e,t,r);break;default:Do(e,t,r)}}function $S(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new iN),t.forEach(function(n){var i=mN.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ri(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:dn=l.stateNode,Xi=!1;break e;case 3:dn=l.stateNode.containerInfo,Xi=!0;break e;case 4:dn=l.stateNode.containerInfo,Xi=!0;break e}l=l.return}if(dn===null)throw Error(Ce(160));yD(s,o,i),dn=null,Xi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ur(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bD(t,e),t=t.sibling}function bD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ri(t,e),cs(e),n&4){try{e0(3,e,e.return),B1(3,e)}catch(x){ur(e,e.return,x)}try{e0(5,e,e.return)}catch(x){ur(e,e.return,x)}}break;case 1:Ri(t,e),cs(e),n&512&&r!==null&&nu(r,r.return);break;case 5:if(Ri(t,e),cs(e),n&512&&r!==null&&nu(r,r.return),e.flags&32){var i=e.stateNode;try{v0(i,"")}catch(x){ur(e,e.return,x)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&V3(i,s),Ej(l,o);var u=Ej(l,s);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?K3(i,f):h==="dangerouslySetInnerHTML"?G3(i,f):h==="children"?v0(i,f):v2(i,h,f,u)}switch(l){case"input":wj(i,s);break;case"textarea":H3(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?lu(i,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?lu(i,!!s.multiple,s.defaultValue,!0):lu(i,!!s.multiple,s.multiple?[]:"",!1))}i[$0]=s}catch(x){ur(e,e.return,x)}}break;case 6:if(Ri(t,e),cs(e),n&4){if(e.stateNode===null)throw Error(Ce(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){ur(e,e.return,x)}}break;case 3:if(Ri(t,e),cs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{j0(t.containerInfo)}catch(x){ur(e,e.return,x)}break;case 4:Ri(t,e),cs(e);break;case 13:Ri(t,e),cs(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Q2=yr())),n&4&&$S(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(En=(u=En)||h,Ri(t,e),En=u):Ri(t,e),cs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(ze=e,h=e.child;h!==null;){for(f=ze=h;ze!==null;){switch(m=ze,v=m.child,m.tag){case 0:case 11:case 14:case 15:e0(4,m,m.return);break;case 1:nu(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(x){ur(n,r,x)}}break;case 5:nu(m,m.return);break;case 22:if(m.memoizedState!==null){TS(f);continue}}v!==null?(v.return=m,ze=v):TS(f)}h=h.sibling}e:for(h=null,f=e;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=q3("display",o))}catch(x){ur(e,e.return,x)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){ur(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ri(t,e),cs(e),n&4&&$S(e);break;case 21:break;default:Ri(t,e),cs(e)}}function cs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_D(r)){var n=r;break e}r=r.return}throw Error(Ce(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(v0(i,""),n.flags&=-33);var s=SS(e);aw(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=SS(e);nw(e,l,o);break;default:throw Error(Ce(161))}}catch(c){ur(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oN(e,t,r){ze=e,jD(e)}function jD(e,t,r){for(var n=(e.mode&1)!==0;ze!==null;){var i=ze,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Jp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||En;l=Jp;var u=En;if(Jp=o,(En=c)&&!u)for(ze=i;ze!==null;)o=ze,c=o.child,o.tag===22&&o.memoizedState!==null?AS(i):c!==null?(c.return=o,ze=c):AS(i);for(;s!==null;)ze=s,jD(s),s=s.sibling;ze=i,Jp=l,En=u}ES(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ze=s):ES(e)}}function ES(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:En||B1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!En)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Gi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&hS(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}hS(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&j0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ce(163))}En||t.flags&512&&rw(t)}catch(m){ur(t,t.return,m)}}if(t===e){ze=null;break}if(r=t.sibling,r!==null){r.return=t.return,ze=r;break}ze=t.return}}function TS(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ze=r;break}ze=t.return}}function AS(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{B1(4,t)}catch(c){ur(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){ur(t,i,c)}}var s=t.return;try{rw(t)}catch(c){ur(t,s,c)}break;case 5:var o=t.return;try{rw(t)}catch(c){ur(t,o,c)}}}catch(c){ur(t,t.return,c)}if(t===e){ze=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ze=l;break}ze=t.return}}var lN=Math.ceil,Qx=Co.ReactCurrentDispatcher,X2=Co.ReactCurrentOwner,Si=Co.ReactCurrentBatchConfig,bt=0,tn=null,Dr=null,fn=0,Ra=0,au=Ul(0),Lr=0,P0=null,td=0,U1=0,Y2=0,t0=null,ga=null,Q2=0,Iu=1/0,Zs=null,Jx=!1,iw=null,El=null,Zp=!1,xl=null,Zx=0,r0=0,sw=null,mx=-1,gx=0;function Jn(){return bt&6?yr():mx!==-1?mx:mx=yr()}function Tl(e){return e.mode&1?bt&2&&fn!==0?fn&-fn:WR.transition!==null?(gx===0&&(gx=sF()),gx):(e=Nt,e!==0||(e=window.event,e=e===void 0?16:fF(e.type)),e):1}function es(e,t,r,n){if(50<r0)throw r0=0,sw=null,Error(Ce(185));dp(e,r,n),(!(bt&2)||e!==tn)&&(e===tn&&(!(bt&2)&&(U1|=r),Lr===4&&sl(e,fn)),ja(e,n),r===1&&bt===0&&!(t.mode&1)&&(Iu=yr()+500,z1&&Vl()))}function ja(e,t){var r=e.callbackNode;WO(e,t);var n=Rx(e,e===tn?fn:0);if(n===0)r!==null&&IC(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&IC(r),t===1)e.tag===0?HR(FS.bind(null,e)):DF(FS.bind(null,e)),LR(function(){!(bt&6)&&Vl()}),r=null;else{switch(oF(n)){case 1:r=w2;break;case 4:r=aF;break;case 16:r=Ox;break;case 536870912:r=iF;break;default:r=Ox}r=AD(r,wD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function wD(e,t){if(mx=-1,gx=0,bt&6)throw Error(Ce(327));var r=e.callbackNode;if(fu()&&e.callbackNode!==r)return null;var n=Rx(e,e===tn?fn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=e1(e,n);else{t=n;var i=bt;bt|=2;var s=CD();(tn!==e||fn!==t)&&(Zs=null,Iu=yr()+500,Uc(e,t));do try{uN();break}catch(l){kD(e,l)}while(!0);R2(),Qx.current=s,bt=i,Dr!==null?t=0:(tn=null,fn=0,t=Lr)}if(t!==0){if(t===2&&(i=Pj(e),i!==0&&(n=i,t=ow(e,i))),t===1)throw r=P0,Uc(e,0),sl(e,n),ja(e,yr()),r;if(t===6)sl(e,n);else{if(i=e.current.alternate,!(n&30)&&!cN(i)&&(t=e1(e,n),t===2&&(s=Pj(e),s!==0&&(n=s,t=ow(e,s))),t===1))throw r=P0,Uc(e,0),sl(e,n),ja(e,yr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ce(345));case 2:bc(e,ga,Zs);break;case 3:if(sl(e,n),(n&130023424)===n&&(t=Q2+500-yr(),10<t)){if(Rx(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Jn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Bj(bc.bind(null,e,ga,Zs),t);break}bc(e,ga,Zs);break;case 4:if(sl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Zi(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=yr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lN(n/1960))-n,10<n){e.timeoutHandle=Bj(bc.bind(null,e,ga,Zs),n);break}bc(e,ga,Zs);break;case 5:bc(e,ga,Zs);break;default:throw Error(Ce(329))}}}return ja(e,yr()),e.callbackNode===r?wD.bind(null,e):null}function ow(e,t){var r=t0;return e.current.memoizedState.isDehydrated&&(Uc(e,t).flags|=256),e=e1(e,t),e!==2&&(t=ga,ga=r,t!==null&&lw(t)),e}function lw(e){ga===null?ga=e:ga.push.apply(ga,e)}function cN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!as(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sl(e,t){for(t&=~Y2,t&=~U1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Zi(t),n=1<<r;e[r]=-1,t&=~n}}function FS(e){if(bt&6)throw Error(Ce(327));fu();var t=Rx(e,0);if(!(t&1))return ja(e,yr()),null;var r=e1(e,t);if(e.tag!==0&&r===2){var n=Pj(e);n!==0&&(t=n,r=ow(e,n))}if(r===1)throw r=P0,Uc(e,0),sl(e,t),ja(e,yr()),r;if(r===6)throw Error(Ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,ga,Zs),ja(e,yr()),null}function J2(e,t){var r=bt;bt|=1;try{return e(t)}finally{bt=r,bt===0&&(Iu=yr()+500,z1&&Vl())}}function rd(e){xl!==null&&xl.tag===0&&!(bt&6)&&fu();var t=bt;bt|=1;var r=Si.transition,n=Nt;try{if(Si.transition=null,Nt=1,e)return e()}finally{Nt=n,Si.transition=r,bt=t,!(bt&6)&&Vl()}}function Z2(){Ra=au.current,Xt(au)}function Uc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,IR(r)),Dr!==null)for(r=Dr.return;r!==null;){var n=r;switch(P2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Bx();break;case 3:Nu(),Xt(ya),Xt(zn),U2();break;case 5:B2(n);break;case 4:Nu();break;case 13:Xt(rr);break;case 19:Xt(rr);break;case 10:N2(n.type._context);break;case 22:case 23:Z2()}r=r.return}if(tn=e,Dr=e=Al(e.current,null),fn=Ra=t,Lr=0,P0=null,Y2=U1=td=0,ga=t0=null,Sc!==null){for(t=0;t<Sc.length;t++)if(r=Sc[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Sc=null}return e}function kD(e,t){do{var r=Dr;try{if(R2(),hx.current=Yx,Xx){for(var n=sr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Xx=!1}if(ed=0,Qr=Rr=sr=null,Zf=!1,A0=0,X2.current=null,r===null||r.return===null){Lr=1,P0=t,Dr=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=fn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=vS(o);if(v!==null){v.flags&=-257,_S(v,o,l,s,t),v.mode&1&&xS(s,u,t),t=v,c=u;var g=t.updateQueue;if(g===null){var x=new Set;x.add(c),t.updateQueue=x}else g.add(c);break e}else{if(!(t&1)){xS(s,u,t),ek();break e}c=Error(Ce(426))}}else if(Zt&&l.mode&1){var _=vS(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),_S(_,o,l,s,t),M2(zu(c,l));break e}}s=c=zu(c,l),Lr!==4&&(Lr=2),t0===null?t0=[s]:t0.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=oD(s,c,t);uS(s,b);break e;case 1:l=c;var y=s.type,j=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(El===null||!El.has(j)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=lD(s,l,t);uS(s,k);break e}}s=s.return}while(s!==null)}$D(r)}catch(E){t=E,Dr===r&&r!==null&&(Dr=r=r.return);continue}break}while(!0)}function CD(){var e=Qx.current;return Qx.current=Yx,e===null?Yx:e}function ek(){(Lr===0||Lr===3||Lr===2)&&(Lr=4),tn===null||!(td&268435455)&&!(U1&268435455)||sl(tn,fn)}function e1(e,t){var r=bt;bt|=2;var n=CD();(tn!==e||fn!==t)&&(Zs=null,Uc(e,t));do try{dN();break}catch(i){kD(e,i)}while(!0);if(R2(),bt=r,Qx.current=n,Dr!==null)throw Error(Ce(261));return tn=null,fn=0,Lr}function dN(){for(;Dr!==null;)SD(Dr)}function uN(){for(;Dr!==null&&!RO();)SD(Dr)}function SD(e){var t=TD(e.alternate,e,Ra);e.memoizedProps=e.pendingProps,t===null?$D(e):Dr=t,X2.current=null}function $D(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=aN(r,t),r!==null){r.flags&=32767,Dr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Lr=6,Dr=null;return}}else if(r=nN(r,t,Ra),r!==null){Dr=r;return}if(t=t.sibling,t!==null){Dr=t;return}Dr=t=e}while(t!==null);Lr===0&&(Lr=5)}function bc(e,t,r){var n=Nt,i=Si.transition;try{Si.transition=null,Nt=1,hN(e,t,r,n)}finally{Si.transition=i,Nt=n}return null}function hN(e,t,r,n){do fu();while(xl!==null);if(bt&6)throw Error(Ce(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ce(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(GO(e,s),e===tn&&(Dr=tn=null,fn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Zp||(Zp=!0,AD(Ox,function(){return fu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Si.transition,Si.transition=null;var o=Nt;Nt=1;var l=bt;bt|=4,X2.current=null,sN(e,r),bD(r,e),DR(Ij),Nx=!!zj,Ij=zj=null,e.current=r,oN(r),NO(),bt=l,Nt=o,Si.transition=s}else e.current=r;if(Zp&&(Zp=!1,xl=e,Zx=i),s=e.pendingLanes,s===0&&(El=null),LO(r.stateNode),ja(e,yr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Jx)throw Jx=!1,e=iw,iw=null,e;return Zx&1&&e.tag!==0&&fu(),s=e.pendingLanes,s&1?e===sw?r0++:(r0=0,sw=e):r0=0,Vl(),null}function fu(){if(xl!==null){var e=oF(Zx),t=Si.transition,r=Nt;try{if(Si.transition=null,Nt=16>e?16:e,xl===null)var n=!1;else{if(e=xl,xl=null,Zx=0,bt&6)throw Error(Ce(331));var i=bt;for(bt|=4,ze=e.current;ze!==null;){var s=ze,o=s.child;if(ze.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ze=u;ze!==null;){var h=ze;switch(h.tag){case 0:case 11:case 15:e0(8,h,s)}var f=h.child;if(f!==null)f.return=h,ze=f;else for(;ze!==null;){h=ze;var m=h.sibling,v=h.return;if(vD(h),h===u){ze=null;break}if(m!==null){m.return=v,ze=m;break}ze=v}}}var g=s.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}ze=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ze=o;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:e0(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,ze=b;break e}ze=s.return}}var y=e.current;for(ze=y;ze!==null;){o=ze;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,ze=j;else e:for(o=y;ze!==null;){if(l=ze,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:B1(9,l)}}catch(E){ur(l,l.return,E)}if(l===o){ze=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,ze=k;break e}ze=l.return}}if(bt=i,Vl(),Ds&&typeof Ds.onPostCommitFiberRoot=="function")try{Ds.onPostCommitFiberRoot(P1,e)}catch{}n=!0}return n}finally{Nt=r,Si.transition=t}}return!1}function DS(e,t,r){t=zu(r,t),t=oD(e,t,1),e=$l(e,t,1),t=Jn(),e!==null&&(dp(e,1,t),ja(e,t))}function ur(e,t,r){if(e.tag===3)DS(e,e,r);else for(;t!==null;){if(t.tag===3){DS(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(El===null||!El.has(n))){e=zu(r,e),e=lD(t,e,1),t=$l(t,e,1),e=Jn(),t!==null&&(dp(t,1,e),ja(t,e));break}}t=t.return}}function fN(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jn(),e.pingedLanes|=e.suspendedLanes&r,tn===e&&(fn&r)===r&&(Lr===4||Lr===3&&(fn&130023424)===fn&&500>yr()-Q2?Uc(e,0):Y2|=r),ja(e,t)}function ED(e,t){t===0&&(e.mode&1?(t=Vp,Vp<<=1,!(Vp&130023424)&&(Vp=4194304)):t=1);var r=Jn();e=jo(e,t),e!==null&&(dp(e,t,r),ja(e,r))}function pN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ED(e,r)}function mN(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ce(314))}n!==null&&n.delete(t),ED(e,r)}var TD;TD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ya.current)va=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return va=!1,rN(e,t,r);va=!!(e.flags&131072)}else va=!1,Zt&&t.flags&1048576&&PF(t,Hx,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;px(e,t),e=t.pendingProps;var i=Mu(t,zn.current);hu(t,r),i=H2(null,t,n,e,i,r);var s=W2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ba(n)?(s=!0,Ux(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,I2(t),i.updater=L1,t.stateNode=i,i._reactInternals=t,Kj(t,n,e,r),t=Qj(null,t,n,!0,s,r)):(t.tag=0,Zt&&s&&D2(t),Kn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(px(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=xN(n),e=Gi(n,e),i){case 0:t=Yj(null,t,n,e,r);break e;case 1:t=jS(null,t,n,e,r);break e;case 11:t=yS(null,t,n,e,r);break e;case 14:t=bS(null,t,n,Gi(n.type,e),r);break e}throw Error(Ce(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Gi(n,i),Yj(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Gi(n,i),jS(e,t,n,i,r);case 3:e:{if(hD(t),e===null)throw Error(Ce(387));n=t.pendingProps,s=t.memoizedState,i=s.element,IF(e,t),qx(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=zu(Error(Ce(423)),t),t=wS(e,t,n,r,i);break e}else if(n!==i){i=zu(Error(Ce(424)),t),t=wS(e,t,n,r,i);break e}else for(Ua=Sl(t.stateNode.containerInfo.firstChild),Ha=t,Zt=!0,Yi=null,r=NF(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ou(),n===i){t=wo(e,t,r);break e}Kn(e,t,n,r)}t=t.child}return t;case 5:return LF(t),e===null&&Wj(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Lj(n,i)?o=null:s!==null&&Lj(n,s)&&(t.flags|=32),uD(e,t),Kn(e,t,o,r),t.child;case 6:return e===null&&Wj(t),null;case 13:return fD(e,t,r);case 4:return L2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ru(t,null,n,r):Kn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Gi(n,i),yS(e,t,n,i,r);case 7:return Kn(e,t,t.pendingProps,r),t.child;case 8:return Kn(e,t,t.pendingProps.children,r),t.child;case 12:return Kn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Vt(Wx,n._currentValue),n._currentValue=o,s!==null)if(as(s.value,o)){if(s.children===i.children&&!ya.current){t=wo(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=po(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Gj(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ce(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Gj(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Kn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,hu(t,r),i=Ei(i),n=n(i),t.flags|=1,Kn(e,t,n,r),t.child;case 14:return n=t.type,i=Gi(n,t.pendingProps),i=Gi(n.type,i),bS(e,t,n,i,r);case 15:return cD(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Gi(n,i),px(e,t),t.tag=1,ba(n)?(e=!0,Ux(t)):e=!1,hu(t,r),sD(t,n,i),Kj(t,n,i,r),Qj(null,t,n,!0,e,r);case 19:return pD(e,t,r);case 22:return dD(e,t,r)}throw Error(Ce(156,t.tag))};function AD(e,t){return nF(e,t)}function gN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(e,t,r,n){return new gN(e,t,r,n)}function tk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xN(e){if(typeof e=="function")return tk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===y2)return 11;if(e===b2)return 14}return 2}function Al(e,t){var r=e.alternate;return r===null?(r=wi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function xx(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")tk(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Kd:return Vc(r.children,i,s,t);case _2:o=8,i|=8;break;case vj:return e=wi(12,r,t,i|2),e.elementType=vj,e.lanes=s,e;case _j:return e=wi(13,r,t,i),e.elementType=_j,e.lanes=s,e;case yj:return e=wi(19,r,t,i),e.elementType=yj,e.lanes=s,e;case L3:return V1(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case z3:o=10;break e;case I3:o=9;break e;case y2:o=11;break e;case b2:o=14;break e;case nl:o=16,n=null;break e}throw Error(Ce(130,e==null?e:typeof e,""))}return t=wi(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Vc(e,t,r,n){return e=wi(7,e,n,t),e.lanes=r,e}function V1(e,t,r,n){return e=wi(22,e,n,t),e.elementType=L3,e.lanes=r,e.stateNode={isHidden:!1},e}function qv(e,t,r){return e=wi(6,e,null,t),e.lanes=r,e}function Kv(e,t,r){return t=wi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vN(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ev(0),this.expirationTimes=Ev(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ev(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rk(e,t,r,n,i,s,o,l,c){return e=new vN(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=wi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},I2(s),e}function _N(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function FD(e){if(!e)return Ol;e=e._reactInternals;e:{if(md(e)!==e||e.tag!==1)throw Error(Ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ba(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ce(171))}if(e.tag===1){var r=e.type;if(ba(r))return FF(e,r,t)}return t}function DD(e,t,r,n,i,s,o,l,c){return e=rk(r,n,!0,e,i,s,o,l,c),e.context=FD(null),r=e.current,n=Jn(),i=Tl(r),s=po(n,i),s.callback=t??null,$l(r,s,i),e.current.lanes=i,dp(e,i,n),ja(e,n),e}function H1(e,t,r,n){var i=t.current,s=Jn(),o=Tl(i);return r=FD(r),t.context===null?t.context=r:t.pendingContext=r,t=po(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=$l(i,t,o),e!==null&&(es(e,i,o,s),ux(e,i,o)),o}function t1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function PS(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function nk(e,t){PS(e,t),(e=e.alternate)&&PS(e,t)}function yN(){return null}var PD=typeof reportError=="function"?reportError:function(e){console.error(e)};function ak(e){this._internalRoot=e}W1.prototype.render=ak.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ce(409));H1(e,t,null,null)};W1.prototype.unmount=ak.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rd(function(){H1(null,e,null,null)}),t[bo]=null}};function W1(e){this._internalRoot=e}W1.prototype.unstable_scheduleHydration=function(e){if(e){var t=dF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<il.length&&t!==0&&t<il[r].priority;r++);il.splice(r,0,e),r===0&&hF(e)}};function ik(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function G1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function MS(){}function bN(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=t1(o);s.call(u)}}var o=DD(t,n,e,0,null,!1,!1,"",MS);return e._reactRootContainer=o,e[bo]=o.current,C0(e.nodeType===8?e.parentNode:e),rd(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=t1(c);l.call(u)}}var c=rk(e,0,!1,null,null,!1,!1,"",MS);return e._reactRootContainer=c,e[bo]=c.current,C0(e.nodeType===8?e.parentNode:e),rd(function(){H1(t,c,r,n)}),c}function q1(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=t1(o);l.call(c)}}H1(t,o,e,i)}else o=bN(r,t,e,i,n);return t1(o)}lF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=zf(t.pendingLanes);r!==0&&(k2(t,r|1),ja(t,yr()),!(bt&6)&&(Iu=yr()+500,Vl()))}break;case 13:rd(function(){var n=jo(e,1);if(n!==null){var i=Jn();es(n,e,1,i)}}),nk(e,1)}};C2=function(e){if(e.tag===13){var t=jo(e,134217728);if(t!==null){var r=Jn();es(t,e,134217728,r)}nk(e,134217728)}};cF=function(e){if(e.tag===13){var t=Tl(e),r=jo(e,t);if(r!==null){var n=Jn();es(r,e,t,n)}nk(e,t)}};dF=function(){return Nt};uF=function(e,t){var r=Nt;try{return Nt=e,t()}finally{Nt=r}};Aj=function(e,t,r){switch(t){case"input":if(wj(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=N1(n);if(!i)throw Error(Ce(90));U3(n),wj(n,i)}}}break;case"textarea":H3(e,r);break;case"select":t=r.value,t!=null&&lu(e,!!r.multiple,t,!1)}};Q3=J2;J3=rd;var jN={usingClientEntryPoint:!1,Events:[hp,Jd,N1,X3,Y3,J2]},jh={findFiberByHostInstance:Cc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wN={bundleType:jh.bundleType,version:jh.version,rendererPackageName:jh.rendererPackageName,rendererConfig:jh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Co.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=tF(e),e===null?null:e.stateNode},findFiberByHostInstance:jh.findFiberByHostInstance||yN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!em.isDisabled&&em.supportsFiber)try{P1=em.inject(wN),Ds=em}catch{}}qa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jN;qa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ik(t))throw Error(Ce(200));return _N(e,t,null,r)};qa.createRoot=function(e,t){if(!ik(e))throw Error(Ce(299));var r=!1,n="",i=PD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=rk(e,1,!1,null,null,r,!1,n,i),e[bo]=t.current,C0(e.nodeType===8?e.parentNode:e),new ak(t)};qa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ce(188)):(e=Object.keys(e).join(","),Error(Ce(268,e)));return e=tF(t),e=e===null?null:e.stateNode,e};qa.flushSync=function(e){return rd(e)};qa.hydrate=function(e,t,r){if(!G1(t))throw Error(Ce(200));return q1(null,e,t,!0,r)};qa.hydrateRoot=function(e,t,r){if(!ik(e))throw Error(Ce(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=PD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=DD(t,null,e,1,r??null,i,!1,s,o),e[bo]=t.current,C0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new W1(t)};qa.render=function(e,t,r){if(!G1(t))throw Error(Ce(200));return q1(null,e,t,!1,r)};qa.unmountComponentAtNode=function(e){if(!G1(e))throw Error(Ce(40));return e._reactRootContainer?(rd(function(){q1(null,null,e,!1,function(){e._reactRootContainer=null,e[bo]=null})}),!0):!1};qa.unstable_batchedUpdates=J2;qa.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!G1(r))throw Error(Ce(200));if(e==null||e._reactInternals===void 0)throw Error(Ce(38));return q1(e,t,r,!1,n)};qa.version="18.3.1-next-f1338f8080-20240426";function MD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MD)}catch(e){console.error(e)}}MD(),M3.exports=qa;var kN=M3.exports,OS=kN;gj.createRoot=OS.createRoot,gj.hydrateRoot=OS.hydrateRoot;var th=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},CN={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},ol,u2,h3,SN=(h3=class{constructor(){He(this,ol,CN);He(this,u2,!1)}setTimeoutProvider(e){Oe(this,ol,e)}setTimeout(e,t){return te(this,ol).setTimeout(e,t)}clearTimeout(e){te(this,ol).clearTimeout(e)}setInterval(e,t){return te(this,ol).setInterval(e,t)}clearInterval(e){te(this,ol).clearInterval(e)}},ol=new WeakMap,u2=new WeakMap,h3),Ec=new SN;function $N(e){setTimeout(e,0)}var nd=typeof window>"u"||"Deno"in globalThis;function Xn(){}function EN(e,t){return typeof e=="function"?e(t):e}function cw(e){return typeof e=="number"&&e>=0&&e!==1/0}function OD(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Fl(e,t){return typeof e=="function"?e(t):e}function yi(e,t){return typeof e=="function"?e(t):e}function RS(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==sk(o,t.options))return!1}else if(!M0(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||i&&i!==t.state.fetchStatus||s&&!s(t))}function NS(e,t){const{exact:r,status:n,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(ad(t.options.mutationKey)!==ad(s))return!1}else if(!M0(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function sk(e,t){return((t==null?void 0:t.queryKeyHashFn)||ad)(e)}function ad(e){return JSON.stringify(e,(t,r)=>dw(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function M0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>M0(e[r],t[r])):!1}var TN=Object.prototype.hasOwnProperty;function RD(e,t){if(e===t)return e;const r=zS(e)&&zS(t);if(!r&&!(dw(e)&&dw(t)))return t;const i=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),o=s.length,l=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const h=r?u:s[u],f=e[h],m=t[h];if(f===m){l[h]=f,(r?u<i:TN.call(e,h))&&c++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){l[h]=m;continue}const v=RD(f,m);l[h]=v,v===f&&c++}return i===o&&c===i?e:l}function r1(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function zS(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function dw(e){if(!IS(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!IS(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function IS(e){return Object.prototype.toString.call(e)==="[object Object]"}function AN(e){return new Promise(t=>{Ec.setTimeout(t,e)})}function uw(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?RD(e,t):t}function FN(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function DN(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ok=Symbol();function ND(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ok?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function zD(e,t){return typeof e=="function"?e(...t):!!e}var Pc,ll,bu,f3,PN=(f3=class extends th{constructor(){super();He(this,Pc);He(this,ll);He(this,bu);Oe(this,bu,t=>{if(!nd&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){te(this,ll)||this.setEventListener(te(this,bu))}onUnsubscribe(){var t;this.hasListeners()||((t=te(this,ll))==null||t.call(this),Oe(this,ll,void 0))}setEventListener(t){var r;Oe(this,bu,t),(r=te(this,ll))==null||r.call(this),Oe(this,ll,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){te(this,Pc)!==t&&(Oe(this,Pc,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof te(this,Pc)=="boolean"?te(this,Pc):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Pc=new WeakMap,ll=new WeakMap,bu=new WeakMap,f3),lk=new PN;function hw(){let e,t;const r=new Promise((i,s)=>{e=i,t=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}var MN=$N;function ON(){let e=[],t=0,r=l=>{l()},n=l=>{l()},i=MN;const s=l=>{t?e.push(l):i(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&i(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{s(()=>{l(...c)})},schedule:s,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var zr=ON(),ju,cl,wu,p3,RN=(p3=class extends th{constructor(){super();He(this,ju,!0);He(this,cl);He(this,wu);Oe(this,wu,t=>{if(!nd&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){te(this,cl)||this.setEventListener(te(this,wu))}onUnsubscribe(){var t;this.hasListeners()||((t=te(this,cl))==null||t.call(this),Oe(this,cl,void 0))}setEventListener(t){var r;Oe(this,wu,t),(r=te(this,cl))==null||r.call(this),Oe(this,cl,t(this.setOnline.bind(this)))}setOnline(t){te(this,ju)!==t&&(Oe(this,ju,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return te(this,ju)}},ju=new WeakMap,cl=new WeakMap,wu=new WeakMap,p3),n1=new RN;function NN(e){return Math.min(1e3*2**e,3e4)}function ID(e){return(e??"online")==="online"?n1.isOnline():!0}var fw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function LD(e){let t=!1,r=0,n;const i=hw(),s=()=>i.status!=="pending",o=x=>{var _;if(!s()){const b=new fw(x);m(b),(_=e.onCancel)==null||_.call(e,b)}},l=()=>{t=!0},c=()=>{t=!1},u=()=>lk.isFocused()&&(e.networkMode==="always"||n1.isOnline())&&e.canRun(),h=()=>ID(e.networkMode)&&e.canRun(),f=x=>{s()||(n==null||n(),i.resolve(x))},m=x=>{s()||(n==null||n(),i.reject(x))},v=()=>new Promise(x=>{var _;n=b=>{(s()||u())&&x(b)},(_=e.onPause)==null||_.call(e)}).then(()=>{var x;n=void 0,s()||(x=e.onContinue)==null||x.call(e)}),g=()=>{if(s())return;let x;const _=r===0?e.initialPromise:void 0;try{x=_??e.fn()}catch(b){x=Promise.reject(b)}Promise.resolve(x).then(f).catch(b=>{var A;if(s())return;const y=e.retry??(nd?0:3),j=e.retryDelay??NN,k=typeof j=="function"?j(r,b):j,E=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,b);if(t||!E){m(b);return}r++,(A=e.onFail)==null||A.call(e,r,b),AN(k).then(()=>u()?void 0:v()).then(()=>{t?m(b):g()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?g():v().then(g),i)}}var Mc,m3,BD=(m3=class{constructor(){He(this,Mc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),cw(this.gcTime)&&Oe(this,Mc,Ec.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(nd?1/0:5*60*1e3))}clearGcTimeout(){te(this,Mc)&&(Ec.clearTimeout(te(this,Mc)),Oe(this,Mc,void 0))}},Mc=new WeakMap,m3),Oc,ku,vi,Rc,Xr,ap,Nc,qi,Ys,g3,zN=(g3=class extends BD{constructor(t){super();He(this,qi);He(this,Oc);He(this,ku);He(this,vi);He(this,Rc);He(this,Xr);He(this,ap);He(this,Nc);Oe(this,Nc,!1),Oe(this,ap,t.defaultOptions),this.setOptions(t.options),this.observers=[],Oe(this,Rc,t.client),Oe(this,vi,te(this,Rc).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Oe(this,Oc,BS(this.options)),this.state=t.state??te(this,Oc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=te(this,Xr))==null?void 0:t.promise}setOptions(t){if(this.options={...te(this,ap),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=BS(this.options);r.data!==void 0&&(this.setState(LS(r.data,r.dataUpdatedAt)),Oe(this,Oc,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&te(this,vi).remove(this)}setData(t,r){const n=uw(this.state.data,t,this.options);return it(this,qi,Ys).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){it(this,qi,Ys).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=te(this,Xr))==null?void 0:n.promise;return(i=te(this,Xr))==null||i.cancel(t),r?r.then(Xn).catch(Xn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(te(this,Oc))}isActive(){return this.observers.some(t=>yi(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ok||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Fl(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!OD(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=te(this,Xr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=te(this,Xr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),te(this,vi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(te(this,Xr)&&(te(this,Nc)?te(this,Xr).cancel({revert:!0}):te(this,Xr).cancelRetry()),this.scheduleGc()),te(this,vi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||it(this,qi,Ys).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,h,f,m,v,g,x,_,b,y,j;if(this.state.fetchStatus!=="idle"&&((c=te(this,Xr))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(te(this,Xr))return te(this,Xr).continueRetry(),te(this,Xr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const k=this.observers.find(E=>E.options.queryFn);k&&this.setOptions(k.options)}const n=new AbortController,i=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(Oe(this,Nc,!0),n.signal)})},s=()=>{const k=ND(this.options,r),A=(()=>{const w={client:te(this,Rc),queryKey:this.queryKey,meta:this.meta};return i(w),w})();return Oe(this,Nc,!1),this.options.persister?this.options.persister(k,A,this):k(A)},l=(()=>{const k={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:te(this,Rc),state:this.state,fetchFn:s};return i(k),k})();(u=this.options.behavior)==null||u.onFetch(l,this),Oe(this,ku,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&it(this,qi,Ys).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta}),Oe(this,Xr,LD({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:k=>{k instanceof fw&&k.revert&&this.setState({...te(this,ku),fetchStatus:"idle"}),n.abort()},onFail:(k,E)=>{it(this,qi,Ys).call(this,{type:"failed",failureCount:k,error:E})},onPause:()=>{it(this,qi,Ys).call(this,{type:"pause"})},onContinue:()=>{it(this,qi,Ys).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const k=await te(this,Xr).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(v=(m=te(this,vi).config).onSuccess)==null||v.call(m,k,this),(x=(g=te(this,vi).config).onSettled)==null||x.call(g,k,this.state.error,this),k}catch(k){if(k instanceof fw){if(k.silent)return te(this,Xr).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw it(this,qi,Ys).call(this,{type:"error",error:k}),(b=(_=te(this,vi).config).onError)==null||b.call(_,k,this),(j=(y=te(this,vi).config).onSettled)==null||j.call(y,this.state.data,k,this),k}finally{this.scheduleGc()}}},Oc=new WeakMap,ku=new WeakMap,vi=new WeakMap,Rc=new WeakMap,Xr=new WeakMap,ap=new WeakMap,Nc=new WeakMap,qi=new WeakSet,Ys=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...UD(n.data,this.options),fetchMeta:t.meta??null};case"success":const i={...n,...LS(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Oe(this,ku,t.manual?i:void 0),i;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),zr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),te(this,vi).notify({query:this,type:"updated",action:t})})},g3);function UD(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ID(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function LS(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function BS(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var fa,vt,ip,Gn,zc,Cu,ao,dl,sp,Su,$u,Ic,Lc,ul,Eu,At,Lf,pw,mw,gw,xw,vw,_w,yw,VD,x3,IN=(x3=class extends th{constructor(t,r){super();He(this,At);He(this,fa);He(this,vt);He(this,ip);He(this,Gn);He(this,zc);He(this,Cu);He(this,ao);He(this,dl);He(this,sp);He(this,Su);He(this,$u);He(this,Ic);He(this,Lc);He(this,ul);He(this,Eu,new Set);this.options=r,Oe(this,fa,t),Oe(this,dl,null),Oe(this,ao,hw()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(te(this,vt).addObserver(this),US(te(this,vt),this.options)?it(this,At,Lf).call(this):this.updateResult(),it(this,At,xw).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bw(te(this,vt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bw(te(this,vt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,it(this,At,vw).call(this),it(this,At,_w).call(this),te(this,vt).removeObserver(this)}setOptions(t){const r=this.options,n=te(this,vt);if(this.options=te(this,fa).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof yi(this.options.enabled,te(this,vt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");it(this,At,yw).call(this),te(this,vt).setOptions(this.options),r._defaulted&&!r1(this.options,r)&&te(this,fa).getQueryCache().notify({type:"observerOptionsUpdated",query:te(this,vt),observer:this});const i=this.hasListeners();i&&VS(te(this,vt),n,this.options,r)&&it(this,At,Lf).call(this),this.updateResult(),i&&(te(this,vt)!==n||yi(this.options.enabled,te(this,vt))!==yi(r.enabled,te(this,vt))||Fl(this.options.staleTime,te(this,vt))!==Fl(r.staleTime,te(this,vt)))&&it(this,At,pw).call(this);const s=it(this,At,mw).call(this);i&&(te(this,vt)!==n||yi(this.options.enabled,te(this,vt))!==yi(r.enabled,te(this,vt))||s!==te(this,ul))&&it(this,At,gw).call(this,s)}getOptimisticResult(t){const r=te(this,fa).getQueryCache().build(te(this,fa),t),n=this.createResult(r,t);return BN(this,n)&&(Oe(this,Gn,n),Oe(this,Cu,this.options),Oe(this,zc,te(this,vt).state)),n}getCurrentResult(){return te(this,Gn)}trackResult(t,r){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),r==null||r(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&te(this,ao).status==="pending"&&te(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){te(this,Eu).add(t)}getCurrentQuery(){return te(this,vt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=te(this,fa).defaultQueryOptions(t),n=te(this,fa).getQueryCache().build(te(this,fa),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return it(this,At,Lf).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),te(this,Gn)))}createResult(t,r){var M;const n=te(this,vt),i=this.options,s=te(this,Gn),o=te(this,zc),l=te(this,Cu),u=t!==n?t.state:te(this,ip),{state:h}=t;let f={...h},m=!1,v;if(r._optimisticResults){const F=this.hasListeners(),D=!F&&US(t,r),W=F&&VS(t,n,r,i);(D||W)&&(f={...f,...UD(h.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:g,errorUpdatedAt:x,status:_}=f;v=f.data;let b=!1;if(r.placeholderData!==void 0&&v===void 0&&_==="pending"){let F;s!=null&&s.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(F=s.data,b=!0):F=typeof r.placeholderData=="function"?r.placeholderData((M=te(this,$u))==null?void 0:M.state.data,te(this,$u)):r.placeholderData,F!==void 0&&(_="success",v=uw(s==null?void 0:s.data,F,r),m=!0)}if(r.select&&v!==void 0&&!b)if(s&&v===(o==null?void 0:o.data)&&r.select===te(this,sp))v=te(this,Su);else try{Oe(this,sp,r.select),v=r.select(v),v=uw(s==null?void 0:s.data,v,r),Oe(this,Su,v),Oe(this,dl,null)}catch(F){Oe(this,dl,F)}te(this,dl)&&(g=te(this,dl),v=te(this,Su),x=Date.now(),_="error");const y=f.fetchStatus==="fetching",j=_==="pending",k=_==="error",E=j&&y,A=v!==void 0,P={status:_,fetchStatus:f.fetchStatus,isPending:j,isSuccess:_==="success",isError:k,isInitialLoading:E,isLoading:E,data:v,dataUpdatedAt:f.dataUpdatedAt,error:g,errorUpdatedAt:x,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!j,isLoadingError:k&&!A,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:k&&A,isStale:ck(t,r),refetch:this.refetch,promise:te(this,ao),isEnabled:yi(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const F=B=>{P.status==="error"?B.reject(P.error):P.data!==void 0&&B.resolve(P.data)},D=()=>{const B=Oe(this,ao,P.promise=hw());F(B)},W=te(this,ao);switch(W.status){case"pending":t.queryHash===n.queryHash&&F(W);break;case"fulfilled":(P.status==="error"||P.data!==W.value)&&D();break;case"rejected":(P.status!=="error"||P.error!==W.reason)&&D();break}}return P}updateResult(){const t=te(this,Gn),r=this.createResult(te(this,vt),this.options);if(Oe(this,zc,te(this,vt).state),Oe(this,Cu,this.options),te(this,zc).data!==void 0&&Oe(this,$u,te(this,vt)),r1(r,t))return;Oe(this,Gn,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!te(this,Eu).size)return!0;const o=new Set(s??te(this,Eu));return this.options.throwOnError&&o.add("error"),Object.keys(te(this,Gn)).some(l=>{const c=l;return te(this,Gn)[c]!==t[c]&&o.has(c)})};it(this,At,VD).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&it(this,At,xw).call(this)}},fa=new WeakMap,vt=new WeakMap,ip=new WeakMap,Gn=new WeakMap,zc=new WeakMap,Cu=new WeakMap,ao=new WeakMap,dl=new WeakMap,sp=new WeakMap,Su=new WeakMap,$u=new WeakMap,Ic=new WeakMap,Lc=new WeakMap,ul=new WeakMap,Eu=new WeakMap,At=new WeakSet,Lf=function(t){it(this,At,yw).call(this);let r=te(this,vt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Xn)),r},pw=function(){it(this,At,vw).call(this);const t=Fl(this.options.staleTime,te(this,vt));if(nd||te(this,Gn).isStale||!cw(t))return;const n=OD(te(this,Gn).dataUpdatedAt,t)+1;Oe(this,Ic,Ec.setTimeout(()=>{te(this,Gn).isStale||this.updateResult()},n))},mw=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(te(this,vt)):this.options.refetchInterval)??!1},gw=function(t){it(this,At,_w).call(this),Oe(this,ul,t),!(nd||yi(this.options.enabled,te(this,vt))===!1||!cw(te(this,ul))||te(this,ul)===0)&&Oe(this,Lc,Ec.setInterval(()=>{(this.options.refetchIntervalInBackground||lk.isFocused())&&it(this,At,Lf).call(this)},te(this,ul)))},xw=function(){it(this,At,pw).call(this),it(this,At,gw).call(this,it(this,At,mw).call(this))},vw=function(){te(this,Ic)&&(Ec.clearTimeout(te(this,Ic)),Oe(this,Ic,void 0))},_w=function(){te(this,Lc)&&(Ec.clearInterval(te(this,Lc)),Oe(this,Lc,void 0))},yw=function(){const t=te(this,fa).getQueryCache().build(te(this,fa),this.options);if(t===te(this,vt))return;const r=te(this,vt);Oe(this,vt,t),Oe(this,ip,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},VD=function(t){zr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(te(this,Gn))}),te(this,fa).getQueryCache().notify({query:te(this,vt),type:"observerResultsUpdated"})})},x3);function LN(e,t){return yi(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function US(e,t){return LN(e,t)||e.state.data!==void 0&&bw(e,t,t.refetchOnMount)}function bw(e,t,r){if(yi(t.enabled,e)!==!1&&Fl(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&ck(e,t)}return!1}function VS(e,t,r,n){return(e!==t||yi(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&ck(e,r)}function ck(e,t){return yi(t.enabled,e)!==!1&&e.isStaleByTime(Fl(t.staleTime,e))}function BN(e,t){return!r1(e.getCurrentResult(),t)}function HS(e){return{onFetch:(t,r)=>{var h,f,m,v,g;const n=t.options,i=(m=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:m.direction,s=((v=t.state.data)==null?void 0:v.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let x=!1;const _=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(t.signal.aborted?x=!0:t.signal.addEventListener("abort",()=>{x=!0}),t.signal)})},b=ND(t.options,t.fetchOptions),y=async(j,k,E)=>{if(x)return Promise.reject();if(k==null&&j.pages.length)return Promise.resolve(j);const w=(()=>{const D={client:t.client,queryKey:t.queryKey,pageParam:k,direction:E?"backward":"forward",meta:t.options.meta};return _(D),D})(),P=await b(w),{maxPages:M}=t.options,F=E?DN:FN;return{pages:F(j.pages,P,M),pageParams:F(j.pageParams,k,M)}};if(i&&s.length){const j=i==="backward",k=j?UN:WS,E={pages:s,pageParams:o},A=k(n,E);l=await y(E,A,j)}else{const j=e??s.length;do{const k=c===0?o[0]??n.initialPageParam:WS(n,l);if(c>0&&k==null)break;l=await y(l,k),c++}while(c<j)}return l};t.options.persister?t.fetchFn=()=>{var x,_;return(_=(x=t.options).persister)==null?void 0:_.call(x,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function WS(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function UN(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var op,Cs,qn,Bc,Ss,Zo,v3,VN=(v3=class extends BD{constructor(t){super();He(this,Ss);He(this,op);He(this,Cs);He(this,qn);He(this,Bc);Oe(this,op,t.client),this.mutationId=t.mutationId,Oe(this,qn,t.mutationCache),Oe(this,Cs,[]),this.state=t.state||HD(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){te(this,Cs).includes(t)||(te(this,Cs).push(t),this.clearGcTimeout(),te(this,qn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Oe(this,Cs,te(this,Cs).filter(r=>r!==t)),this.scheduleGc(),te(this,qn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){te(this,Cs).length||(this.state.status==="pending"?this.scheduleGc():te(this,qn).remove(this))}continue(){var t;return((t=te(this,Bc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,u,h,f,m,v,g,x,_,b,y,j,k,E,A,w,P,M;const r=()=>{it(this,Ss,Zo).call(this,{type:"continue"})},n={client:te(this,op),meta:this.options.meta,mutationKey:this.options.mutationKey};Oe(this,Bc,LD({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(F,D)=>{it(this,Ss,Zo).call(this,{type:"failed",failureCount:F,error:D})},onPause:()=>{it(this,Ss,Zo).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>te(this,qn).canRun(this)}));const i=this.state.status==="pending",s=!te(this,Bc).canStart();try{if(i)r();else{it(this,Ss,Zo).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(o=te(this,qn).config).onMutate)==null?void 0:l.call(o,t,this,n));const D=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,n));D!==this.state.context&&it(this,Ss,Zo).call(this,{type:"pending",context:D,variables:t,isPaused:s})}const F=await te(this,Bc).start();return await((f=(h=te(this,qn).config).onSuccess)==null?void 0:f.call(h,F,t,this.state.context,this,n)),await((v=(m=this.options).onSuccess)==null?void 0:v.call(m,F,t,this.state.context,n)),await((x=(g=te(this,qn).config).onSettled)==null?void 0:x.call(g,F,null,this.state.variables,this.state.context,this,n)),await((b=(_=this.options).onSettled)==null?void 0:b.call(_,F,null,t,this.state.context,n)),it(this,Ss,Zo).call(this,{type:"success",data:F}),F}catch(F){try{throw await((j=(y=te(this,qn).config).onError)==null?void 0:j.call(y,F,t,this.state.context,this,n)),await((E=(k=this.options).onError)==null?void 0:E.call(k,F,t,this.state.context,n)),await((w=(A=te(this,qn).config).onSettled)==null?void 0:w.call(A,void 0,F,this.state.variables,this.state.context,this,n)),await((M=(P=this.options).onSettled)==null?void 0:M.call(P,void 0,F,t,this.state.context,n)),F}finally{it(this,Ss,Zo).call(this,{type:"error",error:F})}}finally{te(this,qn).runNext(this)}}},op=new WeakMap,Cs=new WeakMap,qn=new WeakMap,Bc=new WeakMap,Ss=new WeakSet,Zo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),zr.batch(()=>{te(this,Cs).forEach(n=>{n.onMutationUpdate(t)}),te(this,qn).notify({mutation:this,type:"updated",action:t})})},v3);function HD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var io,Ki,lp,_3,HN=(_3=class extends th{constructor(t={}){super();He(this,io);He(this,Ki);He(this,lp);this.config=t,Oe(this,io,new Set),Oe(this,Ki,new Map),Oe(this,lp,0)}build(t,r,n){const i=new VN({client:t,mutationCache:this,mutationId:++Np(this,lp)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){te(this,io).add(t);const r=tm(t);if(typeof r=="string"){const n=te(this,Ki).get(r);n?n.push(t):te(this,Ki).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(te(this,io).delete(t)){const r=tm(t);if(typeof r=="string"){const n=te(this,Ki).get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&te(this,Ki).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=tm(t);if(typeof r=="string"){const n=te(this,Ki).get(r),i=n==null?void 0:n.find(s=>s.state.status==="pending");return!i||i===t}else return!0}runNext(t){var n;const r=tm(t);if(typeof r=="string"){const i=(n=te(this,Ki).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){zr.batch(()=>{te(this,io).forEach(t=>{this.notify({type:"removed",mutation:t})}),te(this,io).clear(),te(this,Ki).clear()})}getAll(){return Array.from(te(this,io))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>NS(r,n))}findAll(t={}){return this.getAll().filter(r=>NS(t,r))}notify(t){zr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return zr.batch(()=>Promise.all(t.map(r=>r.continue().catch(Xn))))}},io=new WeakMap,Ki=new WeakMap,lp=new WeakMap,_3);function tm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var so,hl,pa,oo,_o,vx,jw,y3,WN=(y3=class extends th{constructor(r,n){super();He(this,_o);He(this,so);He(this,hl);He(this,pa);He(this,oo);Oe(this,so,r),this.setOptions(n),this.bindMethods(),it(this,_o,vx).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=te(this,so).defaultMutationOptions(r),r1(this.options,n)||te(this,so).getMutationCache().notify({type:"observerOptionsUpdated",mutation:te(this,pa),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ad(n.mutationKey)!==ad(this.options.mutationKey)?this.reset():((i=te(this,pa))==null?void 0:i.state.status)==="pending"&&te(this,pa).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=te(this,pa))==null||r.removeObserver(this)}onMutationUpdate(r){it(this,_o,vx).call(this),it(this,_o,jw).call(this,r)}getCurrentResult(){return te(this,hl)}reset(){var r;(r=te(this,pa))==null||r.removeObserver(this),Oe(this,pa,void 0),it(this,_o,vx).call(this),it(this,_o,jw).call(this)}mutate(r,n){var i;return Oe(this,oo,n),(i=te(this,pa))==null||i.removeObserver(this),Oe(this,pa,te(this,so).getMutationCache().build(te(this,so),this.options)),te(this,pa).addObserver(this),te(this,pa).execute(r)}},so=new WeakMap,hl=new WeakMap,pa=new WeakMap,oo=new WeakMap,_o=new WeakSet,vx=function(){var n;const r=((n=te(this,pa))==null?void 0:n.state)??HD();Oe(this,hl,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},jw=function(r){zr.batch(()=>{var n,i,s,o,l,c,u,h;if(te(this,oo)&&this.hasListeners()){const f=te(this,hl).variables,m=te(this,hl).context,v={client:te(this,so),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((i=(n=te(this,oo)).onSuccess)==null||i.call(n,r.data,f,m,v),(o=(s=te(this,oo)).onSettled)==null||o.call(s,r.data,null,f,m,v)):(r==null?void 0:r.type)==="error"&&((c=(l=te(this,oo)).onError)==null||c.call(l,r.error,f,m,v),(h=(u=te(this,oo)).onSettled)==null||h.call(u,void 0,r.error,f,m,v))}this.listeners.forEach(f=>{f(te(this,hl))})})},y3),$s,b3,GN=(b3=class extends th{constructor(t={}){super();He(this,$s);this.config=t,Oe(this,$s,new Map)}build(t,r,n){const i=r.queryKey,s=r.queryHash??sk(i,r);let o=this.get(s);return o||(o=new zN({client:t,queryKey:i,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(o)),o}add(t){te(this,$s).has(t.queryHash)||(te(this,$s).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=te(this,$s).get(t.queryHash);r&&(t.destroy(),r===t&&te(this,$s).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){zr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return te(this,$s).get(t)}getAll(){return[...te(this,$s).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>RS(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>RS(t,n)):r}notify(t){zr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){zr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){zr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},$s=new WeakMap,b3),dr,fl,pl,Tu,Au,ml,Fu,Du,j3,qN=(j3=class{constructor(e={}){He(this,dr);He(this,fl);He(this,pl);He(this,Tu);He(this,Au);He(this,ml);He(this,Fu);He(this,Du);Oe(this,dr,e.queryCache||new GN),Oe(this,fl,e.mutationCache||new HN),Oe(this,pl,e.defaultOptions||{}),Oe(this,Tu,new Map),Oe(this,Au,new Map),Oe(this,ml,0)}mount(){Np(this,ml)._++,te(this,ml)===1&&(Oe(this,Fu,lk.subscribe(async e=>{e&&(await this.resumePausedMutations(),te(this,dr).onFocus())})),Oe(this,Du,n1.subscribe(async e=>{e&&(await this.resumePausedMutations(),te(this,dr).onOnline())})))}unmount(){var e,t;Np(this,ml)._--,te(this,ml)===0&&((e=te(this,Fu))==null||e.call(this),Oe(this,Fu,void 0),(t=te(this,Du))==null||t.call(this),Oe(this,Du,void 0))}isFetching(e){return te(this,dr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return te(this,fl).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=te(this,dr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=te(this,dr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Fl(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return te(this,dr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=te(this,dr).get(n.queryHash),s=i==null?void 0:i.state.data,o=EN(t,s);if(o!==void 0)return te(this,dr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return zr.batch(()=>te(this,dr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=te(this,dr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=te(this,dr);zr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=te(this,dr);return zr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=zr.batch(()=>te(this,dr).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(Xn).catch(Xn)}invalidateQueries(e,t={}){return zr.batch(()=>(te(this,dr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=zr.batch(()=>te(this,dr).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(Xn)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(Xn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=te(this,dr).build(this,t);return r.isStaleByTime(Fl(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Xn).catch(Xn)}fetchInfiniteQuery(e){return e.behavior=HS(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Xn).catch(Xn)}ensureInfiniteQueryData(e){return e.behavior=HS(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return n1.isOnline()?te(this,fl).resumePausedMutations():Promise.resolve()}getQueryCache(){return te(this,dr)}getMutationCache(){return te(this,fl)}getDefaultOptions(){return te(this,pl)}setDefaultOptions(e){Oe(this,pl,e)}setQueryDefaults(e,t){te(this,Tu).set(ad(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...te(this,Tu).values()],r={};return t.forEach(n=>{M0(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){te(this,Au).set(ad(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...te(this,Au).values()],r={};return t.forEach(n=>{M0(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...te(this,pl).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=sk(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ok&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...te(this,pl).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){te(this,dr).clear(),te(this,fl).clear()}},dr=new WeakMap,fl=new WeakMap,pl=new WeakMap,Tu=new WeakMap,Au=new WeakMap,ml=new WeakMap,Fu=new WeakMap,Du=new WeakMap,j3),WD=S.createContext(void 0),Mr=e=>{const t=S.useContext(WD);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},KN=({client:e,children:t})=>(S.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(WD.Provider,{value:e,children:t})),GD=S.createContext(!1),XN=()=>S.useContext(GD);GD.Provider;function YN(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var QN=S.createContext(YN()),JN=()=>S.useContext(QN),ZN=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},ez=e=>{S.useEffect(()=>{e.clearReset()},[e])},tz=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&e.data===void 0||zD(r,[e.error,n])),rz=e=>{if(e.suspense){const r=i=>i==="static"?i:Math.max(i??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...i)=>r(n(...i)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},nz=(e,t)=>e.isLoading&&e.isFetching&&!t,az=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,GS=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function iz(e,t,r){var f,m,v,g,x;const n=XN(),i=JN(),s=Mr(),o=s.defaultQueryOptions(e);(m=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||m.call(f,o),o._optimisticResults=n?"isRestoring":"optimistic",rz(o),ZN(o,i),ez(i);const l=!s.getQueryCache().get(o.queryHash),[c]=S.useState(()=>new t(s,o)),u=c.getOptimisticResult(o),h=!n&&e.subscribed!==!1;if(S.useSyncExternalStore(S.useCallback(_=>{const b=h?c.subscribe(zr.batchCalls(_)):Xn;return c.updateResult(),b},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),S.useEffect(()=>{c.setOptions(o)},[o,c]),az(o,u))throw GS(o,c,i);if(tz({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((g=(v=s.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||g.call(v,o,u),o.experimental_prefetchInRender&&!nd&&nz(u,n)){const _=l?GS(o,c,i):(x=s.getQueryCache().get(o.queryHash))==null?void 0:x.promise;_==null||_.catch(Xn).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function zt(e,t){return iz(e,IN)}function Ct(e,t){const r=Mr(),[n]=S.useState(()=>new WN(r,e));S.useEffect(()=>{n.setOptions(e)},[n,e]);const i=S.useSyncExternalStore(S.useCallback(o=>n.subscribe(zr.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=S.useCallback((o,l)=>{n.mutate(o,l).catch(Xn)},[n]);if(i.error&&zD(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}var Pn=function(){return Pn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Pn.apply(this,arguments)};function Lu(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Gt="-ms-",n0="-moz-",Et="-webkit-",qD="comm",K1="rule",dk="decl",sz="@import",KD="@keyframes",oz="@layer",XD=Math.abs,uk=String.fromCharCode,ww=Object.assign;function lz(e,t){return Jr(e,0)^45?(((t<<2^Jr(e,0))<<2^Jr(e,1))<<2^Jr(e,2))<<2^Jr(e,3):0}function YD(e){return e.trim()}function eo(e,t){return(e=t.exec(e))?e[0]:e}function st(e,t,r){return e.replace(t,r)}function _x(e,t,r){return e.indexOf(t,r)}function Jr(e,t){return e.charCodeAt(t)|0}function Bu(e,t,r){return e.slice(t,r)}function Es(e){return e.length}function QD(e){return e.length}function Bf(e,t){return t.push(e),e}function cz(e,t){return e.map(t).join("")}function qS(e,t){return e.filter(function(r){return!eo(r,t)})}var X1=1,Uu=1,JD=0,Ai=0,Fr=0,rh="";function Y1(e,t,r,n,i,s,o,l){return{value:e,root:t,parent:r,type:n,props:i,children:s,line:X1,column:Uu,length:o,return:"",siblings:l}}function el(e,t){return ww(Y1("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function $d(e){for(;e.root;)e=el(e.root,{children:[e]});Bf(e,e.siblings)}function dz(){return Fr}function uz(){return Fr=Ai>0?Jr(rh,--Ai):0,Uu--,Fr===10&&(Uu=1,X1--),Fr}function ts(){return Fr=Ai<JD?Jr(rh,Ai++):0,Uu++,Fr===10&&(Uu=1,X1++),Fr}function Hc(){return Jr(rh,Ai)}function yx(){return Ai}function Q1(e,t){return Bu(rh,e,t)}function kw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function hz(e){return X1=Uu=1,JD=Es(rh=e),Ai=0,[]}function fz(e){return rh="",e}function Xv(e){return YD(Q1(Ai-1,Cw(e===91?e+2:e===40?e+1:e)))}function pz(e){for(;(Fr=Hc())&&Fr<33;)ts();return kw(e)>2||kw(Fr)>3?"":" "}function mz(e,t){for(;--t&&ts()&&!(Fr<48||Fr>102||Fr>57&&Fr<65||Fr>70&&Fr<97););return Q1(e,yx()+(t<6&&Hc()==32&&ts()==32))}function Cw(e){for(;ts();)switch(Fr){case e:return Ai;case 34:case 39:e!==34&&e!==39&&Cw(Fr);break;case 40:e===41&&Cw(e);break;case 92:ts();break}return Ai}function gz(e,t){for(;ts()&&e+Fr!==57;)if(e+Fr===84&&Hc()===47)break;return"/*"+Q1(t,Ai-1)+"*"+uk(e===47?e:ts())}function xz(e){for(;!kw(Hc());)ts();return Q1(e,Ai)}function vz(e){return fz(bx("",null,null,null,[""],e=hz(e),0,[0],e))}function bx(e,t,r,n,i,s,o,l,c){for(var u=0,h=0,f=o,m=0,v=0,g=0,x=1,_=1,b=1,y=0,j="",k=i,E=s,A=n,w=j;_;)switch(g=y,y=ts()){case 40:if(g!=108&&Jr(w,f-1)==58){_x(w+=st(Xv(y),"&","&\f"),"&\f",XD(u?l[u-1]:0))!=-1&&(b=-1);break}case 34:case 39:case 91:w+=Xv(y);break;case 9:case 10:case 13:case 32:w+=pz(g);break;case 92:w+=mz(yx()-1,7);continue;case 47:switch(Hc()){case 42:case 47:Bf(_z(gz(ts(),yx()),t,r,c),c);break;default:w+="/"}break;case 123*x:l[u++]=Es(w)*b;case 125*x:case 59:case 0:switch(y){case 0:case 125:_=0;case 59+h:b==-1&&(w=st(w,/\f/g,"")),v>0&&Es(w)-f&&Bf(v>32?XS(w+";",n,r,f-1,c):XS(st(w," ","")+";",n,r,f-2,c),c);break;case 59:w+=";";default:if(Bf(A=KS(w,t,r,u,h,i,l,j,k=[],E=[],f,s),s),y===123)if(h===0)bx(w,t,A,A,k,s,f,l,E);else switch(m===99&&Jr(w,3)===110?100:m){case 100:case 108:case 109:case 115:bx(e,A,A,n&&Bf(KS(e,A,A,0,0,i,l,j,i,k=[],f,E),E),i,E,f,l,n?k:E);break;default:bx(w,A,A,A,[""],E,0,l,E)}}u=h=v=0,x=b=1,j=w="",f=o;break;case 58:f=1+Es(w),v=g;default:if(x<1){if(y==123)--x;else if(y==125&&x++==0&&uz()==125)continue}switch(w+=uk(y),y*x){case 38:b=h>0?1:(w+="\f",-1);break;case 44:l[u++]=(Es(w)-1)*b,b=1;break;case 64:Hc()===45&&(w+=Xv(ts())),m=Hc(),h=f=Es(j=w+=xz(yx())),y++;break;case 45:g===45&&Es(w)==2&&(x=0)}}return s}function KS(e,t,r,n,i,s,o,l,c,u,h,f){for(var m=i-1,v=i===0?s:[""],g=QD(v),x=0,_=0,b=0;x<n;++x)for(var y=0,j=Bu(e,m+1,m=XD(_=o[x])),k=e;y<g;++y)(k=YD(_>0?v[y]+" "+j:st(j,/&\f/g,v[y])))&&(c[b++]=k);return Y1(e,t,r,i===0?K1:l,c,u,h,f)}function _z(e,t,r,n){return Y1(e,t,r,qD,uk(dz()),Bu(e,2,-2),0,n)}function XS(e,t,r,n,i){return Y1(e,t,r,dk,Bu(e,0,n),Bu(e,n+1,-1),n,i)}function ZD(e,t,r){switch(lz(e,t)){case 5103:return Et+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Et+e+e;case 4789:return n0+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Et+e+n0+e+Gt+e+e;case 5936:switch(Jr(e,t+11)){case 114:return Et+e+Gt+st(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Et+e+Gt+st(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Et+e+Gt+st(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return Et+e+Gt+e+e;case 6165:return Et+e+Gt+"flex-"+e+e;case 5187:return Et+e+st(e,/(\w+).+(:[^]+)/,Et+"box-$1$2"+Gt+"flex-$1$2")+e;case 5443:return Et+e+Gt+"flex-item-"+st(e,/flex-|-self/g,"")+(eo(e,/flex-|baseline/)?"":Gt+"grid-row-"+st(e,/flex-|-self/g,""))+e;case 4675:return Et+e+Gt+"flex-line-pack"+st(e,/align-content|flex-|-self/g,"")+e;case 5548:return Et+e+Gt+st(e,"shrink","negative")+e;case 5292:return Et+e+Gt+st(e,"basis","preferred-size")+e;case 6060:return Et+"box-"+st(e,"-grow","")+Et+e+Gt+st(e,"grow","positive")+e;case 4554:return Et+st(e,/([^-])(transform)/g,"$1"+Et+"$2")+e;case 6187:return st(st(st(e,/(zoom-|grab)/,Et+"$1"),/(image-set)/,Et+"$1"),e,"")+e;case 5495:case 3959:return st(e,/(image-set\([^]*)/,Et+"$1$`$1");case 4968:return st(st(e,/(.+:)(flex-)?(.*)/,Et+"box-pack:$3"+Gt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Et+e+e;case 4200:if(!eo(e,/flex-|baseline/))return Gt+"grid-column-align"+Bu(e,t)+e;break;case 2592:case 3360:return Gt+st(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(n,i){return t=i,eo(n.props,/grid-\w+-end/)})?~_x(e+(r=r[t].value),"span",0)?e:Gt+st(e,"-start","")+e+Gt+"grid-row-span:"+(~_x(r,"span",0)?eo(r,/\d+/):+eo(r,/\d+/)-+eo(e,/\d+/))+";":Gt+st(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(n){return eo(n.props,/grid-\w+-start/)})?e:Gt+st(st(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return st(e,/(.+)-inline(.+)/,Et+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Es(e)-1-t>6)switch(Jr(e,t+1)){case 109:if(Jr(e,t+4)!==45)break;case 102:return st(e,/(.+:)(.+)-([^]+)/,"$1"+Et+"$2-$3$1"+n0+(Jr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~_x(e,"stretch",0)?ZD(st(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return st(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,i,s,o,l,c,u){return Gt+i+":"+s+u+(o?Gt+i+"-span:"+(l?c:+c-+s)+u:"")+e});case 4949:if(Jr(e,t+6)===121)return st(e,":",":"+Et)+e;break;case 6444:switch(Jr(e,Jr(e,14)===45?18:11)){case 120:return st(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Et+(Jr(e,14)===45?"inline-":"")+"box$3$1"+Et+"$2$3$1"+Gt+"$2box$3")+e;case 100:return st(e,":",":"+Gt)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return st(e,"scroll-","scroll-snap-")+e}return e}function a1(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function yz(e,t,r,n){switch(e.type){case oz:if(e.children.length)break;case sz:case dk:return e.return=e.return||e.value;case qD:return"";case KD:return e.return=e.value+"{"+a1(e.children,n)+"}";case K1:if(!Es(e.value=e.props.join(",")))return""}return Es(r=a1(e.children,n))?e.return=e.value+"{"+r+"}":""}function bz(e){var t=QD(e);return function(r,n,i,s){for(var o="",l=0;l<t;l++)o+=e[l](r,n,i,s)||"";return o}}function jz(e){return function(t){t.root||(t=t.return)&&e(t)}}function wz(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case dk:e.return=ZD(e.value,e.length,r);return;case KD:return a1([el(e,{value:st(e.value,"@","@"+Et)})],n);case K1:if(e.length)return cz(r=e.props,function(i){switch(eo(i,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":$d(el(e,{props:[st(i,/:(read-\w+)/,":"+n0+"$1")]})),$d(el(e,{props:[i]})),ww(e,{props:qS(r,n)});break;case"::placeholder":$d(el(e,{props:[st(i,/:(plac\w+)/,":"+Et+"input-$1")]})),$d(el(e,{props:[st(i,/:(plac\w+)/,":"+n0+"$1")]})),$d(el(e,{props:[st(i,/:(plac\w+)/,Gt+"input-$1")]})),$d(el(e,{props:[i]})),ww(e,{props:qS(r,n)});break}return""})}}var kz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Oa={},Vu=typeof process<"u"&&Oa!==void 0&&(Oa.REACT_APP_SC_ATTR||Oa.SC_ATTR)||"data-styled",eP="active",tP="data-styled-version",J1="6.1.19",hk=`/*!sc*/
`,i1=typeof window<"u"&&typeof document<"u",Cz=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Oa!==void 0&&Oa.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Oa.REACT_APP_SC_DISABLE_SPEEDY!==""?Oa.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Oa.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Oa!==void 0&&Oa.SC_DISABLE_SPEEDY!==void 0&&Oa.SC_DISABLE_SPEEDY!==""&&Oa.SC_DISABLE_SPEEDY!=="false"&&Oa.SC_DISABLE_SPEEDY),Sz={},Z1=Object.freeze([]),Hu=Object.freeze({});function rP(e,t,r){return r===void 0&&(r=Hu),e.theme!==r.theme&&e.theme||t||r.theme}var nP=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),$z=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ez=/(^-|-$)/g;function YS(e){return e.replace($z,"-").replace(Ez,"")}var Tz=/(a)(d)/gi,rm=52,QS=function(e){return String.fromCharCode(e+(e>25?39:97))};function Sw(e){var t,r="";for(t=Math.abs(e);t>rm;t=t/rm|0)r=QS(t%rm)+r;return(QS(t%rm)+r).replace(Tz,"$1-$2")}var Yv,aP=5381,iu=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},iP=function(e){return iu(aP,e)};function fk(e){return Sw(iP(e)>>>0)}function Az(e){return e.displayName||e.name||"Component"}function Qv(e){return typeof e=="string"&&!0}var sP=typeof Symbol=="function"&&Symbol.for,oP=sP?Symbol.for("react.memo"):60115,Fz=sP?Symbol.for("react.forward_ref"):60112,Dz={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Pz={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},lP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Mz=((Yv={})[Fz]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Yv[oP]=lP,Yv);function JS(e){return("type"in(t=e)&&t.type.$$typeof)===oP?lP:"$$typeof"in e?Mz[e.$$typeof]:Dz;var t}var Oz=Object.defineProperty,Rz=Object.getOwnPropertyNames,ZS=Object.getOwnPropertySymbols,Nz=Object.getOwnPropertyDescriptor,zz=Object.getPrototypeOf,e$=Object.prototype;function cP(e,t,r){if(typeof t!="string"){if(e$){var n=zz(t);n&&n!==e$&&cP(e,n,r)}var i=Rz(t);ZS&&(i=i.concat(ZS(t)));for(var s=JS(e),o=JS(t),l=0;l<i.length;++l){var c=i[l];if(!(c in Pz||r&&r[c]||o&&c in o||s&&c in s)){var u=Nz(t,c);try{Oz(e,c,u)}catch{}}}}return e}function Wu(e){return typeof e=="function"}function pk(e){return typeof e=="object"&&"styledComponentId"in e}function Tc(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function s1(e,t){if(e.length===0)return"";for(var r=e[0],n=1;n<e.length;n++)r+=e[n];return r}function O0(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function $w(e,t,r){if(r===void 0&&(r=!1),!r&&!O0(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)e[n]=$w(e[n],t[n]);else if(O0(t))for(var n in t)e[n]=$w(e[n],t[n]);return e}function mk(e,t){Object.defineProperty(e,"toString",{value:t})}function pp(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Iz=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,n=0;n<t;n++)r+=this.groupSizes[n];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var n=this.groupSizes,i=n.length,s=i;t>=s;)if((s<<=1)<0)throw pp(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(n),this.length=s;for(var o=i;o<s;o++)this.groupSizes[o]=0}for(var l=this.indexOfGroup(t+1),c=(o=0,r.length);o<c;o++)this.tag.insertRule(l,r[o])&&(this.groupSizes[t]++,l++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],n=this.indexOfGroup(t),i=n+r;this.groupSizes[t]=0;for(var s=n;s<i;s++)this.tag.deleteRule(n)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var n=this.groupSizes[t],i=this.indexOfGroup(t),s=i+n,o=i;o<s;o++)r+="".concat(this.tag.getRule(o)).concat(hk);return r},e}(),jx=new Map,o1=new Map,wx=1,nm=function(e){if(jx.has(e))return jx.get(e);for(;o1.has(wx);)wx++;var t=wx++;return jx.set(e,t),o1.set(t,e),t},Lz=function(e,t){wx=t+1,jx.set(e,t),o1.set(t,e)},Bz="style[".concat(Vu,"][").concat(tP,'="').concat(J1,'"]'),Uz=new RegExp("^".concat(Vu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Vz=function(e,t,r){for(var n,i=r.split(","),s=0,o=i.length;s<o;s++)(n=i[s])&&e.registerName(t,n)},Hz=function(e,t){for(var r,n=((r=t.textContent)!==null&&r!==void 0?r:"").split(hk),i=[],s=0,o=n.length;s<o;s++){var l=n[s].trim();if(l){var c=l.match(Uz);if(c){var u=0|parseInt(c[1],10),h=c[2];u!==0&&(Lz(h,u),Vz(e,h,c[3]),e.getTag().insertRules(u,i)),i.length=0}else i.push(l)}}},t$=function(e){for(var t=document.querySelectorAll(Bz),r=0,n=t.length;r<n;r++){var i=t[r];i&&i.getAttribute(Vu)!==eP&&(Hz(e,i),i.parentNode&&i.parentNode.removeChild(i))}};function Wz(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var dP=function(e){var t=document.head,r=e||t,n=document.createElement("style"),i=function(l){var c=Array.from(l.querySelectorAll("style[".concat(Vu,"]")));return c[c.length-1]}(r),s=i!==void 0?i.nextSibling:null;n.setAttribute(Vu,eP),n.setAttribute(tP,J1);var o=Wz();return o&&n.setAttribute("nonce",o),r.insertBefore(n,s),n},Gz=function(){function e(t){this.element=dP(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var n=document.styleSheets,i=0,s=n.length;i<s;i++){var o=n[i];if(o.ownerNode===r)return o}throw pp(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),qz=function(){function e(t){this.element=dP(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var n=document.createTextNode(r);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),Kz=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),r$=i1,Xz={isServer:!i1,useCSSOMInjection:!Cz},l1=function(){function e(t,r,n){t===void 0&&(t=Hu),r===void 0&&(r={});var i=this;this.options=Pn(Pn({},Xz),t),this.gs=r,this.names=new Map(n),this.server=!!t.isServer,!this.server&&i1&&r$&&(r$=!1,t$(this)),mk(this,function(){return function(s){for(var o=s.getTag(),l=o.length,c="",u=function(f){var m=function(b){return o1.get(b)}(f);if(m===void 0)return"continue";var v=s.names.get(m),g=o.getGroup(f);if(v===void 0||!v.size||g.length===0)return"continue";var x="".concat(Vu,".g").concat(f,'[id="').concat(m,'"]'),_="";v!==void 0&&v.forEach(function(b){b.length>0&&(_+="".concat(b,","))}),c+="".concat(g).concat(x,'{content:"').concat(_,'"}').concat(hk)},h=0;h<l;h++)u(h);return c}(i)})}return e.registerId=function(t){return nm(t)},e.prototype.rehydrate=function(){!this.server&&i1&&t$(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(Pn(Pn({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var n=r.useCSSOMInjection,i=r.target;return r.isServer?new Kz(i):n?new Gz(i):new qz(i)}(this.options),new Iz(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(nm(t),this.names.has(t))this.names.get(t).add(r);else{var n=new Set;n.add(r),this.names.set(t,n)}},e.prototype.insertRules=function(t,r,n){this.registerName(t,r),this.getTag().insertRules(nm(t),n)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(nm(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),Yz=/&/g,Qz=/^\s*\/\/.*$/gm;function uP(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(n){return"".concat(t," ").concat(n)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=uP(r.children,t)),r})}function Jz(e){var t,r,n,i=Hu,s=i.options,o=s===void 0?Hu:s,l=i.plugins,c=l===void 0?Z1:l,u=function(m,v,g){return g.startsWith(r)&&g.endsWith(r)&&g.replaceAll(r,"").length>0?".".concat(t):m},h=c.slice();h.push(function(m){m.type===K1&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(Yz,r).replace(n,u))}),o.prefix&&h.push(wz),h.push(yz);var f=function(m,v,g,x){v===void 0&&(v=""),g===void 0&&(g=""),x===void 0&&(x="&"),t=x,r=v,n=new RegExp("\\".concat(r,"\\b"),"g");var _=m.replace(Qz,""),b=vz(g||v?"".concat(g," ").concat(v," { ").concat(_," }"):_);o.namespace&&(b=uP(b,o.namespace));var y=[];return a1(b,bz(h.concat(jz(function(j){return y.push(j)})))),y};return f.hash=c.length?c.reduce(function(m,v){return v.name||pp(15),iu(m,v.name)},aP).toString():"",f}var Zz=new l1,Ew=Jz(),hP=As.createContext({shouldForwardProp:void 0,styleSheet:Zz,stylis:Ew});hP.Consumer;As.createContext(void 0);function Tw(){return S.useContext(hP)}var fP=function(){function e(t,r){var n=this;this.inject=function(i,s){s===void 0&&(s=Ew);var o=n.name+s.hash;i.hasNameForId(n.id,o)||i.insertRules(n.id,o,s(n.rules,o,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,mk(this,function(){throw pp(12,String(n.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Ew),this.name+t.hash},e}(),eI=function(e){return e>="A"&&e<="Z"};function n$(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(r===1&&n==="-"&&e[0]==="-")return e;eI(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var pP=function(e){return e==null||e===!1||e===""},mP=function(e){var t,r,n=[];for(var i in e){var s=e[i];e.hasOwnProperty(i)&&!pP(s)&&(Array.isArray(s)&&s.isCss||Wu(s)?n.push("".concat(n$(i),":"),s,";"):O0(s)?n.push.apply(n,Lu(Lu(["".concat(i," {")],mP(s),!1),["}"],!1)):n.push("".concat(n$(i),": ").concat((t=i,(r=s)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in kz||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return n};function Dl(e,t,r,n){if(pP(e))return[];if(pk(e))return[".".concat(e.styledComponentId)];if(Wu(e)){if(!Wu(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var i=e(t);return Dl(i,t,r,n)}var s;return e instanceof fP?r?(e.inject(r,n),[e.getName(n)]):[e]:O0(e)?mP(e):Array.isArray(e)?Array.prototype.concat.apply(Z1,e.map(function(o){return Dl(o,t,r,n)})):[e.toString()]}function gP(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(Wu(r)&&!pk(r))return!1}return!0}var tI=iP(J1),rI=function(){function e(t,r,n){this.rules=t,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&gP(t),this.componentId=r,this.baseHash=iu(tI,r),this.baseStyle=n,l1.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,n){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))i=Tc(i,this.staticRulesId);else{var s=s1(Dl(this.rules,t,r,n)),o=Sw(iu(this.baseHash,s)>>>0);if(!r.hasNameForId(this.componentId,o)){var l=n(s,".".concat(o),void 0,this.componentId);r.insertRules(this.componentId,o,l)}i=Tc(i,o),this.staticRulesId=o}else{for(var c=iu(this.baseHash,n.hash),u="",h=0;h<this.rules.length;h++){var f=this.rules[h];if(typeof f=="string")u+=f;else if(f){var m=s1(Dl(f,t,r,n));c=iu(c,m+h),u+=m}}if(u){var v=Sw(c>>>0);r.hasNameForId(this.componentId,v)||r.insertRules(this.componentId,v,n(u,".".concat(v),void 0,this.componentId)),i=Tc(i,v)}}return i},e}(),gk=As.createContext(void 0);gk.Consumer;var Jv={};function nI(e,t,r){var n=pk(e),i=e,s=!Qv(e),o=t.attrs,l=o===void 0?Z1:o,c=t.componentId,u=c===void 0?function(k,E){var A=typeof k!="string"?"sc":YS(k);Jv[A]=(Jv[A]||0)+1;var w="".concat(A,"-").concat(fk(J1+A+Jv[A]));return E?"".concat(E,"-").concat(w):w}(t.displayName,t.parentComponentId):c,h=t.displayName,f=h===void 0?function(k){return Qv(k)?"styled.".concat(k):"Styled(".concat(Az(k),")")}(e):h,m=t.displayName&&t.componentId?"".concat(YS(t.displayName),"-").concat(t.componentId):t.componentId||u,v=n&&i.attrs?i.attrs.concat(l).filter(Boolean):l,g=t.shouldForwardProp;if(n&&i.shouldForwardProp){var x=i.shouldForwardProp;if(t.shouldForwardProp){var _=t.shouldForwardProp;g=function(k,E){return x(k,E)&&_(k,E)}}else g=x}var b=new rI(r,m,n?i.componentStyle:void 0);function y(k,E){return function(A,w,P){var M=A.attrs,F=A.componentStyle,D=A.defaultProps,W=A.foldedComponentIds,B=A.styledComponentId,G=A.target,Y=As.useContext(gk),ae=Tw(),U=A.shouldForwardProp||ae.shouldForwardProp,q=rP(w,Y,D)||Hu,z=function(K,ne,ee){for(var ge,L=Pn(Pn({},ne),{className:void 0,theme:ee}),se=0;se<K.length;se+=1){var ke=Wu(ge=K[se])?ge(L):ge;for(var V in ke)L[V]=V==="className"?Tc(L[V],ke[V]):V==="style"?Pn(Pn({},L[V]),ke[V]):ke[V]}return ne.className&&(L.className=Tc(L.className,ne.className)),L}(M,w,q),ie=z.as||G,he={};for(var O in z)z[O]===void 0||O[0]==="$"||O==="as"||O==="theme"&&z.theme===q||(O==="forwardedAs"?he.as=z.forwardedAs:U&&!U(O,ie)||(he[O]=z[O]));var R=function(K,ne){var ee=Tw(),ge=K.generateAndInjectStyles(ne,ee.styleSheet,ee.stylis);return ge}(F,z),I=Tc(W,B);return R&&(I+=" "+R),z.className&&(I+=" "+z.className),he[Qv(ie)&&!nP.has(ie)?"class":"className"]=I,P&&(he.ref=P),S.createElement(ie,he)}(j,k,E)}y.displayName=f;var j=As.forwardRef(y);return j.attrs=v,j.componentStyle=b,j.displayName=f,j.shouldForwardProp=g,j.foldedComponentIds=n?Tc(i.foldedComponentIds,i.styledComponentId):"",j.styledComponentId=m,j.target=n?i.target:e,Object.defineProperty(j,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(k){this._foldedDefaultProps=n?function(E){for(var A=[],w=1;w<arguments.length;w++)A[w-1]=arguments[w];for(var P=0,M=A;P<M.length;P++)$w(E,M[P],!0);return E}({},i.defaultProps,k):k}}),mk(j,function(){return".".concat(j.styledComponentId)}),s&&cP(j,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),j}function a$(e,t){for(var r=[e[0]],n=0,i=t.length;n<i;n+=1)r.push(t[n],e[n+1]);return r}var i$=function(e){return Object.assign(e,{isCss:!0})};function Va(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Wu(e)||O0(e))return i$(Dl(a$(Z1,Lu([e],t,!0))));var n=e;return t.length===0&&n.length===1&&typeof n[0]=="string"?Dl(n):i$(Dl(a$(n,t)))}function Aw(e,t,r){if(r===void 0&&(r=Hu),!t)throw pp(1,t);var n=function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return e(t,r,Va.apply(void 0,Lu([i],s,!1)))};return n.attrs=function(i){return Aw(e,t,Pn(Pn({},r),{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},n.withConfig=function(i){return Aw(e,t,Pn(Pn({},r),i))},n}var xP=function(e){return Aw(nI,e)},p=xP;nP.forEach(function(e){p[e]=xP(e)});var aI=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=gP(t),l1.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,n,i){var s=i(s1(Dl(this.rules,r,n,i)),""),o=this.componentId+t;n.insertRules(o,o,s)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,n,i){t>2&&l1.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,r,n,i)},e}();function iI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Va.apply(void 0,Lu([e],t,!1)),i="sc-global-".concat(fk(JSON.stringify(n))),s=new aI(n,i),o=function(c){var u=Tw(),h=As.useContext(gk),f=As.useRef(u.styleSheet.allocateGSInstance(i)).current;return u.styleSheet.server&&l(f,c,u.styleSheet,h,u.stylis),As.useLayoutEffect(function(){if(!u.styleSheet.server)return l(f,c,u.styleSheet,h,u.stylis),function(){return s.removeStyles(f,u.styleSheet)}},[f,c,u.styleSheet,h,u.stylis]),null};function l(c,u,h,f,m){if(s.isStatic)s.renderStyles(c,Sz,h,m);else{var v=Pn(Pn({},u),{theme:rP(u,f,o.defaultProps)});s.renderStyles(c,v,h,m)}}return As.memo(o)}function sI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=s1(Va.apply(void 0,Lu([e],t,!1))),i=fk(n);return new fP(i,n)}const oI={primary:"#003A81",primaryDark:"#002654",secondary:"#EC7126",accent:"#05C1CA",cardHeader:"#01214d",bgWhite:"#FFFFFF",bgLight:"#F2F2F2",bgMedium:"#E9ECEF",bgBlueLight:"#D1E3F8",success:"#28A745",warning:"#FFC107",danger:"#DC3545",error:"#DC3545",info:"#17A2B8",disabled:"#9E9E9E",textPrimary:"#212529",textSecondary:"#6C757D",textMuted:"#9E9E9E",textWhite:"#FFFFFF",link:"#003A81",linkHover:"#002654",border:"#dee2e6"},lI={fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",weights:{regular:400,medium:500,semibold:600,bold:700},sizes:{h1:"2rem",h2:"1.5rem",h3:"1.25rem",h4:"1rem",body:"0.875rem",small:"0.75rem",tiny:"0.625rem"},lineHeights:{tight:1.2,normal:1.5}},cI={xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem",xxl:"3rem"},dI={sm:"4px",md:"8px",lg:"12px",full:"50%"},uI={sm:"0 1px 3px rgba(0, 0, 0, 0.08)",md:"0 2px 8px rgba(0, 0, 0, 0.1)",lg:"0 4px 16px rgba(0, 0, 0, 0.12)"},hI={fast:"0.15s ease",normal:"0.2s ease"},d={colors:oI,typography:lI,spacing:cI,radius:dI,shadows:uI,transitions:hI},fI=iI`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
  }

  body {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
    font-weight: ${d.typography.weights.regular};
    line-height: ${d.typography.lineHeights.normal};
    color: ${d.colors.textPrimary};
    background-color: ${d.colors.bgLight};
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1, h2, h3, h4, h5, h6 {
    font-weight: ${d.typography.weights.semibold};
    line-height: ${d.typography.lineHeights.tight};
    color: ${d.colors.textPrimary};
    margin-bottom: ${d.spacing.md};
  }

  h1 { font-size: ${d.typography.sizes.h1}; }
  h2 { font-size: ${d.typography.sizes.h2}; }
  h3 { font-size: ${d.typography.sizes.h3}; }
  h4 { font-size: ${d.typography.sizes.h4}; }

  a {
    color: ${d.colors.link};
    text-decoration: none;
    transition: color ${d.transitions.fast};

    &:hover {
      color: ${d.colors.linkHover};
    }
  }

  button {
    font-family: ${d.typography.fontFamily};
    cursor: pointer;
  }

  input, select, textarea {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
  }

  #root {
    min-height: 100vh;
  }
`,pI={primary:Va`
    background-color: ${d.colors.primary};
    border-color: ${d.colors.primary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: ${d.colors.linkHover};
      border-color: ${d.colors.linkHover};
    }
  `,secondary:Va`
    background-color: ${d.colors.secondary};
    border-color: ${d.colors.secondary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #d4631f;
      border-color: #d4631f;
    }
  `,outline:Va`
    background-color: transparent;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};

    &:hover:not(:disabled) {
      background-color: ${d.colors.primary};
      color: ${d.colors.textWhite};
    }
  `,danger:Va`
    background-color: ${d.colors.danger};
    border-color: ${d.colors.danger};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #c82333;
      border-color: #c82333;
    }
  `},mI={sm:Va`
    padding: 0.375rem 0.75rem;
    font-size: ${d.typography.sizes.small};
  `,md:Va`
    padding: 0.5rem 1.25rem;
    font-size: ${d.typography.sizes.body};
  `,lg:Va`
    padding: 0.75rem 1.5rem;
    font-size: ${d.typography.sizes.h4};
  `},gI=p.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: ${d.spacing.xs};
  font-family: ${d.typography.fontFamily};
  font-weight: ${d.typography.weights.medium};
  border: 2px solid;
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};

  ${({$variant:e="primary"})=>pI[e]}
  ${({$size:e="md"})=>mI[e]}
  ${({$fullWidth:e})=>e&&Va`width: 100%;`}

  &:disabled {
    background-color: ${d.colors.disabled};
    border-color: ${d.colors.disabled};
    color: ${d.colors.textWhite};
    cursor: not-allowed;
    opacity: 0.7;
  }

  &:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.25);
  }
`;p.div`
  background-color: ${d.colors.bgWhite};
  border-radius: ${d.radius.md};
  box-shadow: ${d.shadows.md};
  overflow: hidden;
`;p.div`
  background-color: ${d.colors.cardHeader};
  color: ${d.colors.textWhite};
  padding: ${d.spacing.md} ${d.spacing.lg};
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`;p.div`
  padding: ${d.spacing.lg};
`;p.div`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border-top: 1px solid ${d.colors.border};
  background-color: ${d.colors.bgLight};
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
`;const xI=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};

  ${({$disabled:e})=>e&&Va`
      opacity: 0.6;
      pointer-events: none;
    `}
`,vI=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,_I=p.select`
  width: 100%;
  padding: 0.75rem 1rem;
  font-family: ${d.typography.fontFamily};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: ${({$hasError:e})=>e?"#fff5f5":d.colors.bgWhite};
  border: 1px solid ${({$hasError:e})=>e?"#dc3545":d.colors.border};
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236C757D' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.25rem;
  padding-right: 2.5rem;

  ${({$hasValue:e,$hasError:t})=>e&&!t&&Va`
      border-color: ${d.colors.accent};
      background-color: ${d.colors.bgBlueLight}15;
    `}

  &:hover:not(:disabled) {
    border-color: ${d.colors.accent};
  }

  &:focus {
    outline: none;
    border-color: ${d.colors.accent};
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.15);
  }

  &:disabled {
    background-color: ${d.colors.bgLight};
    cursor: not-allowed;
    opacity: 0.7;
  }

  option {
    padding: 0.5rem;
  }
`,yI=p.span`
  font-size: ${d.typography.sizes.small};
  color: ${({$error:e})=>e?d.colors.danger:d.colors.textMuted};
`;function Ns({label:e,value:t,options:r,onChange:n,disabled:i=!1,placeholder:s="Seleccione...",helperText:o,error:l,stepNumber:c}){return a.jsxs(xI,{$disabled:i,children:[a.jsxs(vI,{style:{color:l?"#dc3545":void 0},children:[c&&a.jsx(bI,{children:c}),e]}),a.jsxs(_I,{value:t??"",onChange:u=>n(u.target.value),disabled:i,$hasValue:t!==null&&t!=="",$hasError:l,children:[a.jsx("option",{value:"",children:s}),r.map(u=>a.jsx("option",{value:u.value,children:u.label},u.value))]}),o&&a.jsx(yI,{$error:l,children:o})]})}const bI=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: ${d.spacing.xs};
  background-color: ${d.colors.primary};
  color: ${d.colors.textWhite};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.semibold};
`,jI=sI`
  to {
    transform: rotate(360deg);
  }
`,s$={sm:"1rem",md:"1.5rem",lg:"2rem"},wI=p.div`
  width: ${({$size:e="md"})=>s$[e]};
  height: ${({$size:e="md"})=>s$[e]};
  border: 2px solid ${d.colors.bgLight};
  border-top-color: ${d.colors.accent};
  border-radius: ${d.radius.full};
  animation: ${jI} 0.8s linear infinite;
`,kI=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: ${d.spacing.xl};
`;function CI({size:e="md"}){return a.jsx(kI,{children:a.jsx(wI,{$size:e})})}const SI=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: ${e=>e.$isOpen?"flex":"none"};
  justify-content: center;
  align-items: flex-start;
  padding: 2rem;
  z-index: 1000;
  overflow-y: auto;
`,$I=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  width: 100%;
  max-width: ${e=>{switch(e.$size){case"sm":return"400px";case"md":return"600px";case"lg":return"800px";case"xl":return"1140px";default:return"600px"}}};
  max-height: calc(100vh - 4rem);
  overflow: hidden;
  display: flex;
  flex-direction: column;
`,EI=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 1rem 1.25rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,TI=p.h2`
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
`,AI=p.button`
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
  opacity: 0.8;
  transition: opacity 0.2s;

  &:hover {
    opacity: 1;
  }
`,FI=p.div`
  padding: 1.25rem;
  overflow-y: auto;
  flex: 1;
  background: #f2f4fd;
`;function DI({isOpen:e,onClose:t,title:r,children:n,size:i="lg",showCloseButton:s=!0}){const o=S.useCallback(c=>{c.key==="Escape"&&t()},[t]),l=S.useCallback(c=>{c.target===c.currentTarget&&t()},[t]);return S.useEffect(()=>(e&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}),[e,o]),e?a.jsx(SI,{$isOpen:e,onClick:l,children:a.jsxs($I,{$size:i,children:[a.jsxs(EI,{children:[a.jsx(TI,{children:r}),s&&a.jsx(AI,{onClick:t,children:""})]}),a.jsx(FI,{children:n})]})}):null}function vP(e,t){return function(){return e.apply(t,arguments)}}const{toString:PI}=Object.prototype,{getPrototypeOf:xk}=Object,{iterator:ev,toStringTag:_P}=Symbol,tv=(e=>t=>{const r=PI.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ss=e=>(e=e.toLowerCase(),t=>tv(t)===e),rv=e=>t=>typeof t===e,{isArray:nh}=Array,Gu=rv("undefined");function mp(e){return e!==null&&!Gu(e)&&e.constructor!==null&&!Gu(e.constructor)&&wa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const yP=ss("ArrayBuffer");function MI(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&yP(e.buffer),t}const OI=rv("string"),wa=rv("function"),bP=rv("number"),gp=e=>e!==null&&typeof e=="object",RI=e=>e===!0||e===!1,kx=e=>{if(tv(e)!=="object")return!1;const t=xk(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(_P in e)&&!(ev in e)},NI=e=>{if(!gp(e)||mp(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},zI=ss("Date"),II=ss("File"),LI=ss("Blob"),BI=ss("FileList"),UI=e=>gp(e)&&wa(e.pipe),VI=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||wa(e.append)&&((t=tv(e))==="formdata"||t==="object"&&wa(e.toString)&&e.toString()==="[object FormData]"))},HI=ss("URLSearchParams"),[WI,GI,qI,KI]=["ReadableStream","Request","Response","Headers"].map(ss),XI=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),nh(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(mp(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function jP(e,t){if(mp(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Ac=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,wP=e=>!Gu(e)&&e!==Ac;function Fw(){const{caseless:e,skipUndefined:t}=wP(this)&&this||{},r={},n=(i,s)=>{const o=e&&jP(r,s)||s;kx(r[o])&&kx(i)?r[o]=Fw(r[o],i):kx(i)?r[o]=Fw({},i):nh(i)?r[o]=i.slice():(!t||!Gu(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&xp(arguments[i],n);return r}const YI=(e,t,r,{allOwnKeys:n}={})=>(xp(t,(i,s)=>{r&&wa(i)?e[s]=vP(i,r):e[s]=i},{allOwnKeys:n}),e),QI=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),JI=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},ZI=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&xk(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},eL=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},tL=e=>{if(!e)return null;if(nh(e))return e;let t=e.length;if(!bP(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},rL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&xk(Uint8Array)),nL=(e,t)=>{const n=(e&&e[ev]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},aL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},iL=ss("HTMLFormElement"),sL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),o$=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),oL=ss("RegExp"),kP=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};xp(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},lL=e=>{kP(e,(t,r)=>{if(wa(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(wa(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},cL=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return nh(e)?n(e):n(String(e).split(t)),r},dL=()=>{},uL=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function hL(e){return!!(e&&wa(e.append)&&e[_P]==="FormData"&&e[ev])}const fL=e=>{const t=new Array(10),r=(n,i)=>{if(gp(n)){if(t.indexOf(n)>=0)return;if(mp(n))return n;if(!("toJSON"in n)){t[i]=n;const s=nh(n)?[]:{};return xp(n,(o,l)=>{const c=r(o,i+1);!Gu(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},pL=ss("AsyncFunction"),mL=e=>e&&(gp(e)||wa(e))&&wa(e.then)&&wa(e.catch),CP=((e,t)=>e?setImmediate:t?((r,n)=>(Ac.addEventListener("message",({source:i,data:s})=>{i===Ac&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Ac.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",wa(Ac.postMessage)),gL=typeof queueMicrotask<"u"?queueMicrotask.bind(Ac):typeof process<"u"&&process.nextTick||CP,xL=e=>e!=null&&wa(e[ev]),me={isArray:nh,isArrayBuffer:yP,isBuffer:mp,isFormData:VI,isArrayBufferView:MI,isString:OI,isNumber:bP,isBoolean:RI,isObject:gp,isPlainObject:kx,isEmptyObject:NI,isReadableStream:WI,isRequest:GI,isResponse:qI,isHeaders:KI,isUndefined:Gu,isDate:zI,isFile:II,isBlob:LI,isRegExp:oL,isFunction:wa,isStream:UI,isURLSearchParams:HI,isTypedArray:rL,isFileList:BI,forEach:xp,merge:Fw,extend:YI,trim:XI,stripBOM:QI,inherits:JI,toFlatObject:ZI,kindOf:tv,kindOfTest:ss,endsWith:eL,toArray:tL,forEachEntry:nL,matchAll:aL,isHTMLForm:iL,hasOwnProperty:o$,hasOwnProp:o$,reduceDescriptors:kP,freezeMethods:lL,toObjectSet:cL,toCamelCase:sL,noop:dL,toFiniteNumber:uL,findKey:jP,global:Ac,isContextDefined:wP,isSpecCompliantForm:hL,toJSONObject:fL,isAsyncFn:pL,isThenable:mL,setImmediate:CP,asap:gL,isIterable:xL};function tt(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}me.inherits(tt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:me.toJSONObject(this.config),code:this.code,status:this.status}}});const SP=tt.prototype,$P={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{$P[e]={value:e}});Object.defineProperties(tt,$P);Object.defineProperty(SP,"isAxiosError",{value:!0});tt.from=(e,t,r,n,i,s)=>{const o=Object.create(SP);me.toFlatObject(e,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return tt.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const vL=null;function Dw(e){return me.isPlainObject(e)||me.isArray(e)}function EP(e){return me.endsWith(e,"[]")?e.slice(0,-2):e}function l$(e,t,r){return e?e.concat(t).map(function(i,s){return i=EP(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function _L(e){return me.isArray(e)&&!e.some(Dw)}const yL=me.toFlatObject(me,{},null,function(t){return/^is[A-Z]/.test(t)});function nv(e,t,r){if(!me.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=me.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,_){return!me.isUndefined(_[x])});const n=r.metaTokens,i=r.visitor||h,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&me.isSpecCompliantForm(t);if(!me.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(me.isDate(g))return g.toISOString();if(me.isBoolean(g))return g.toString();if(!c&&me.isBlob(g))throw new tt("Blob is not supported. Use a Buffer instead.");return me.isArrayBuffer(g)||me.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function h(g,x,_){let b=g;if(g&&!_&&typeof g=="object"){if(me.endsWith(x,"{}"))x=n?x:x.slice(0,-2),g=JSON.stringify(g);else if(me.isArray(g)&&_L(g)||(me.isFileList(g)||me.endsWith(x,"[]"))&&(b=me.toArray(g)))return x=EP(x),b.forEach(function(j,k){!(me.isUndefined(j)||j===null)&&t.append(o===!0?l$([x],k,s):o===null?x:x+"[]",u(j))}),!1}return Dw(g)?!0:(t.append(l$(_,x,s),u(g)),!1)}const f=[],m=Object.assign(yL,{defaultVisitor:h,convertValue:u,isVisitable:Dw});function v(g,x){if(!me.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(g),me.forEach(g,function(b,y){(!(me.isUndefined(b)||b===null)&&i.call(t,b,me.isString(y)?y.trim():y,x,m))===!0&&v(b,x?x.concat(y):[y])}),f.pop()}}if(!me.isObject(e))throw new TypeError("data must be an object");return v(e),t}function c$(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function vk(e,t){this._pairs=[],e&&nv(e,this,t)}const TP=vk.prototype;TP.append=function(t,r){this._pairs.push([t,r])};TP.toString=function(t){const r=t?function(n){return t.call(this,n,c$)}:c$;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function bL(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function AP(e,t,r){if(!t)return e;const n=r&&r.encode||bL;me.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=me.isURLSearchParams(t)?t.toString():new vk(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class d${constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){me.forEach(this.handlers,function(n){n!==null&&t(n)})}}const FP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jL=typeof URLSearchParams<"u"?URLSearchParams:vk,wL=typeof FormData<"u"?FormData:null,kL=typeof Blob<"u"?Blob:null,CL={isBrowser:!0,classes:{URLSearchParams:jL,FormData:wL,Blob:kL},protocols:["http","https","file","blob","url","data"]},_k=typeof window<"u"&&typeof document<"u",Pw=typeof navigator=="object"&&navigator||void 0,SL=_k&&(!Pw||["ReactNative","NativeScript","NS"].indexOf(Pw.product)<0),$L=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",EL=_k&&window.location.href||"http://localhost",TL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:_k,hasStandardBrowserEnv:SL,hasStandardBrowserWebWorkerEnv:$L,navigator:Pw,origin:EL},Symbol.toStringTag,{value:"Module"})),An={...TL,...CL};function AL(e,t){return nv(e,new An.classes.URLSearchParams,{visitor:function(r,n,i,s){return An.isNode&&me.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function FL(e){return me.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function DL(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function DP(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&me.isArray(i)?i.length:o,c?(me.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!me.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&me.isArray(i[o])&&(i[o]=DL(i[o])),!l)}if(me.isFormData(e)&&me.isFunction(e.entries)){const r={};return me.forEachEntry(e,(n,i)=>{t(FL(n),i,r,0)}),r}return null}function PL(e,t,r){if(me.isString(e))try{return(t||JSON.parse)(e),me.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const vp={transitional:FP,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=me.isObject(t);if(s&&me.isHTMLForm(t)&&(t=new FormData(t)),me.isFormData(t))return i?JSON.stringify(DP(t)):t;if(me.isArrayBuffer(t)||me.isBuffer(t)||me.isStream(t)||me.isFile(t)||me.isBlob(t)||me.isReadableStream(t))return t;if(me.isArrayBufferView(t))return t.buffer;if(me.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return AL(t,this.formSerializer).toString();if((l=me.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return nv(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),PL(t)):t}],transformResponse:[function(t){const r=this.transitional||vp.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(me.isResponse(t)||me.isReadableStream(t))return t;if(t&&me.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?tt.from(l,tt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:An.classes.FormData,Blob:An.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};me.forEach(["delete","get","head","post","put","patch"],e=>{vp.headers[e]={}});const ML=me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),OL=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&ML[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},u$=Symbol("internals");function wh(e){return e&&String(e).trim().toLowerCase()}function Cx(e){return e===!1||e==null?e:me.isArray(e)?e.map(Cx):String(e)}function RL(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const NL=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Zv(e,t,r,n,i){if(me.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!me.isString(t)){if(me.isString(n))return t.indexOf(n)!==-1;if(me.isRegExp(n))return n.test(t)}}function zL(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function IL(e,t){const r=me.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let ka=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const h=wh(c);if(!h)throw new Error("header name must be a non-empty string");const f=me.findKey(i,h);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=Cx(l))}const o=(l,c)=>me.forEach(l,(u,h)=>s(u,h,c));if(me.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(me.isString(t)&&(t=t.trim())&&!NL(t))o(OL(t),r);else if(me.isObject(t)&&me.isIterable(t)){let l={},c,u;for(const h of t){if(!me.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?me.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=wh(t),t){const n=me.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return RL(i);if(me.isFunction(r))return r.call(this,i,n);if(me.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=wh(t),t){const n=me.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Zv(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=wh(o),o){const l=me.findKey(n,o);l&&(!r||Zv(n,n[l],l,r))&&(delete n[l],i=!0)}}return me.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||Zv(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return me.forEach(this,(i,s)=>{const o=me.findKey(n,s);if(o){r[o]=Cx(i),delete r[s];return}const l=t?zL(s):String(s).trim();l!==s&&delete r[s],r[l]=Cx(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return me.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&me.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[u$]=this[u$]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=wh(o);n[l]||(IL(i,o),n[l]=!0)}return me.isArray(t)?t.forEach(s):s(t),this}};ka.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);me.reduceDescriptors(ka.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});me.freezeMethods(ka);function e_(e,t){const r=this||vp,n=t||r,i=ka.from(n.headers);let s=n.data;return me.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function PP(e){return!!(e&&e.__CANCEL__)}function ah(e,t,r){tt.call(this,e??"canceled",tt.ERR_CANCELED,t,r),this.name="CanceledError"}me.inherits(ah,tt,{__CANCEL__:!0});function MP(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new tt("Request failed with status code "+r.status,[tt.ERR_BAD_REQUEST,tt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function LL(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function BL(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),h=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,m=0;for(;f!==i;)m+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const v=h&&u-h;return v?Math.round(m*1e3/v):void 0}}function UL(e,t){let r=0,n=1e3/t,i,s;const o=(u,h=Date.now())=>{r=h,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const h=Date.now(),f=h-r;f>=n?o(u,h):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const c1=(e,t,r=3)=>{let n=0;const i=BL(50,250);return UL(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),h=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},h$=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},f$=e=>(...t)=>me.asap(()=>e(...t)),VL=An.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,An.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(An.origin),An.navigator&&/(msie|trident)/i.test(An.navigator.userAgent)):()=>!0,HL=An.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];me.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),me.isString(n)&&l.push(`path=${n}`),me.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),me.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function WL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function GL(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function OP(e,t,r){let n=!WL(t);return e&&(n||r==!1)?GL(e,t):t}const p$=e=>e instanceof ka?{...e}:e;function id(e,t){t=t||{};const r={};function n(u,h,f,m){return me.isPlainObject(u)&&me.isPlainObject(h)?me.merge.call({caseless:m},u,h):me.isPlainObject(h)?me.merge({},h):me.isArray(h)?h.slice():h}function i(u,h,f,m){if(me.isUndefined(h)){if(!me.isUndefined(u))return n(void 0,u,f,m)}else return n(u,h,f,m)}function s(u,h){if(!me.isUndefined(h))return n(void 0,h)}function o(u,h){if(me.isUndefined(h)){if(!me.isUndefined(u))return n(void 0,u)}else return n(void 0,h)}function l(u,h,f){if(f in t)return n(u,h);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,h,f)=>i(p$(u),p$(h),f,!0)};return me.forEach(Object.keys({...e,...t}),function(h){const f=c[h]||i,m=f(e[h],t[h],h);me.isUndefined(m)&&f!==l||(r[h]=m)}),r}const RP=e=>{const t=id({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=ka.from(o),t.url=AP(OP(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),me.isFormData(r)){if(An.hasStandardBrowserEnv||An.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(me.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([h,f])=>{u.includes(h.toLowerCase())&&o.set(h,f)})}}if(An.hasStandardBrowserEnv&&(n&&me.isFunction(n)&&(n=n(t)),n||n!==!1&&VL(t.url))){const c=i&&s&&HL.read(s);c&&o.set(i,c)}return t},qL=typeof XMLHttpRequest<"u",KL=qL&&function(e){return new Promise(function(r,n){const i=RP(e);let s=i.data;const o=ka.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,h,f,m,v,g;function x(){v&&v(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let _=new XMLHttpRequest;_.open(i.method.toUpperCase(),i.url,!0),_.timeout=i.timeout;function b(){if(!_)return;const j=ka.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),E={data:!l||l==="text"||l==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:j,config:e,request:_};MP(function(w){r(w),x()},function(w){n(w),x()},E),_=null}"onloadend"in _?_.onloadend=b:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(b)},_.onabort=function(){_&&(n(new tt("Request aborted",tt.ECONNABORTED,e,_)),_=null)},_.onerror=function(k){const E=k&&k.message?k.message:"Network Error",A=new tt(E,tt.ERR_NETWORK,e,_);A.event=k||null,n(A),_=null},_.ontimeout=function(){let k=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const E=i.transitional||FP;i.timeoutErrorMessage&&(k=i.timeoutErrorMessage),n(new tt(k,E.clarifyTimeoutError?tt.ETIMEDOUT:tt.ECONNABORTED,e,_)),_=null},s===void 0&&o.setContentType(null),"setRequestHeader"in _&&me.forEach(o.toJSON(),function(k,E){_.setRequestHeader(E,k)}),me.isUndefined(i.withCredentials)||(_.withCredentials=!!i.withCredentials),l&&l!=="json"&&(_.responseType=i.responseType),u&&([m,g]=c1(u,!0),_.addEventListener("progress",m)),c&&_.upload&&([f,v]=c1(c),_.upload.addEventListener("progress",f),_.upload.addEventListener("loadend",v)),(i.cancelToken||i.signal)&&(h=j=>{_&&(n(!j||j.type?new ah(null,e,_):j),_.abort(),_=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const y=LL(i.url);if(y&&An.protocols.indexOf(y)===-1){n(new tt("Unsupported protocol "+y+":",tt.ERR_BAD_REQUEST,e));return}_.send(s||null)})},XL=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const h=u instanceof Error?u:this.reason;n.abort(h instanceof tt?h:new ah(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new tt(`timeout ${t} of ms exceeded`,tt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>me.asap(l),c}},YL=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},QL=async function*(e,t){for await(const r of JL(e))yield*YL(r,t)},JL=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},m$=(e,t,r,n)=>{const i=QL(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await i.next();if(u){l(),c.close();return}let f=h.byteLength;if(r){let m=s+=f;r(m)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},g$=64*1024,{isFunction:am}=me,ZL=(({Request:e,Response:t})=>({Request:e,Response:t}))(me.global),{ReadableStream:x$,TextEncoder:v$}=me.global,_$=(e,...t)=>{try{return!!e(...t)}catch{return!1}},e7=e=>{e=me.merge.call({skipUndefined:!0},ZL,e);const{fetch:t,Request:r,Response:n}=e,i=t?am(t):typeof fetch=="function",s=am(r),o=am(n);if(!i)return!1;const l=i&&am(x$),c=i&&(typeof v$=="function"?(g=>x=>g.encode(x))(new v$):async g=>new Uint8Array(await new r(g).arrayBuffer())),u=s&&l&&_$(()=>{let g=!1;const x=new r(An.origin,{body:new x$,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!x}),h=o&&l&&_$(()=>me.isReadableStream(new n("").body)),f={stream:h&&(g=>g.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(x,_)=>{let b=x&&x[g];if(b)return b.call(x);throw new tt(`Response type '${g}' is not supported`,tt.ERR_NOT_SUPPORT,_)})});const m=async g=>{if(g==null)return 0;if(me.isBlob(g))return g.size;if(me.isSpecCompliantForm(g))return(await new r(An.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(me.isArrayBufferView(g)||me.isArrayBuffer(g))return g.byteLength;if(me.isURLSearchParams(g)&&(g=g+""),me.isString(g))return(await c(g)).byteLength},v=async(g,x)=>{const _=me.toFiniteNumber(g.getContentLength());return _??m(x)};return async g=>{let{url:x,method:_,data:b,signal:y,cancelToken:j,timeout:k,onDownloadProgress:E,onUploadProgress:A,responseType:w,headers:P,withCredentials:M="same-origin",fetchOptions:F}=RP(g),D=t||fetch;w=w?(w+"").toLowerCase():"text";let W=XL([y,j&&j.toAbortSignal()],k),B=null;const G=W&&W.unsubscribe&&(()=>{W.unsubscribe()});let Y;try{if(A&&u&&_!=="get"&&_!=="head"&&(Y=await v(P,b))!==0){let he=new r(x,{method:"POST",body:b,duplex:"half"}),O;if(me.isFormData(b)&&(O=he.headers.get("content-type"))&&P.setContentType(O),he.body){const[R,I]=h$(Y,c1(f$(A)));b=m$(he.body,g$,R,I)}}me.isString(M)||(M=M?"include":"omit");const ae=s&&"credentials"in r.prototype,U={...F,signal:W,method:_.toUpperCase(),headers:P.normalize().toJSON(),body:b,duplex:"half",credentials:ae?M:void 0};B=s&&new r(x,U);let q=await(s?D(B,F):D(x,U));const z=h&&(w==="stream"||w==="response");if(h&&(E||z&&G)){const he={};["status","statusText","headers"].forEach(K=>{he[K]=q[K]});const O=me.toFiniteNumber(q.headers.get("content-length")),[R,I]=E&&h$(O,c1(f$(E),!0))||[];q=new n(m$(q.body,g$,R,()=>{I&&I(),G&&G()}),he)}w=w||"text";let ie=await f[me.findKey(f,w)||"text"](q,g);return!z&&G&&G(),await new Promise((he,O)=>{MP(he,O,{data:ie,headers:ka.from(q.headers),status:q.status,statusText:q.statusText,config:g,request:B})})}catch(ae){throw G&&G(),ae&&ae.name==="TypeError"&&/Load failed|fetch/i.test(ae.message)?Object.assign(new tt("Network Error",tt.ERR_NETWORK,g,B),{cause:ae.cause||ae}):tt.from(ae,ae&&ae.code,g,B)}}},t7=new Map,NP=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,h=t7;for(;l--;)c=s[l],u=h.get(c),u===void 0&&h.set(c,u=l?new Map:e7(t)),h=u;return u};NP();const yk={http:vL,xhr:KL,fetch:{get:NP}};me.forEach(yk,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const y$=e=>`- ${e}`,r7=e=>me.isFunction(e)||e===null||e===!1;function n7(e,t){e=me.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!r7(n)&&(i=yk[(l=String(n)).toLowerCase()],i===void 0))throw new tt(`Unknown adapter '${l}'`);if(i&&(me.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(y$).join(`
`):" "+y$(o[0]):"as no adapter specified";throw new tt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const zP={getAdapter:n7,adapters:yk};function t_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ah(null,e)}function b$(e){return t_(e),e.headers=ka.from(e.headers),e.data=e_.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),zP.getAdapter(e.adapter||vp.adapter,e)(e).then(function(n){return t_(e),n.data=e_.call(e,e.transformResponse,n),n.headers=ka.from(n.headers),n},function(n){return PP(n)||(t_(e),n&&n.response&&(n.response.data=e_.call(e,e.transformResponse,n.response),n.response.headers=ka.from(n.response.headers))),Promise.reject(n)})}const IP="1.13.2",av={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{av[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const j$={};av.transitional=function(t,r,n){function i(s,o){return"[Axios v"+IP+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new tt(i(o," has been removed"+(r?" in "+r:"")),tt.ERR_DEPRECATED);return r&&!j$[o]&&(j$[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};av.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function a7(e,t,r){if(typeof e!="object")throw new tt("options must be an object",tt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new tt("option "+s+" must be "+c,tt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new tt("Unknown option "+s,tt.ERR_BAD_OPTION)}}const Sx={assertOptions:a7,validators:av},ds=Sx.validators;let Wc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new d$,response:new d$}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=id(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Sx.assertOptions(n,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),i!=null&&(me.isFunction(i)?r.paramsSerializer={serialize:i}:Sx.assertOptions(i,{encode:ds.function,serialize:ds.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Sx.assertOptions(r,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&me.merge(s.common,s[r.method]);s&&me.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=ka.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const u=[];this.interceptors.response.forEach(function(x){u.push(x.fulfilled,x.rejected)});let h,f=0,m;if(!c){const g=[b$.bind(this),void 0];for(g.unshift(...l),g.push(...u),m=g.length,h=Promise.resolve(r);f<m;)h=h.then(g[f++],g[f++]);return h}m=l.length;let v=r;for(;f<m;){const g=l[f++],x=l[f++];try{v=g(v)}catch(_){x.call(this,_);break}}try{h=b$.call(this,v)}catch(g){return Promise.reject(g)}for(f=0,m=u.length;f<m;)h=h.then(u[f++],u[f++]);return h}getUri(t){t=id(this.defaults,t);const r=OP(t.baseURL,t.url,t.allowAbsoluteUrls);return AP(r,t.params,t.paramsSerializer)}};me.forEach(["delete","get","head","options"],function(t){Wc.prototype[t]=function(r,n){return this.request(id(n||{},{method:t,url:r,data:(n||{}).data}))}});me.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(id(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Wc.prototype[t]=r(),Wc.prototype[t+"Form"]=r(!0)});let i7=class LP{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new ah(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new LP(function(i){t=i}),cancel:t}}};function s7(e){return function(r){return e.apply(null,r)}}function o7(e){return me.isObject(e)&&e.isAxiosError===!0}const Mw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Mw).forEach(([e,t])=>{Mw[t]=e});function BP(e){const t=new Wc(e),r=vP(Wc.prototype.request,t);return me.extend(r,Wc.prototype,t,{allOwnKeys:!0}),me.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return BP(id(e,i))},r}const pr=BP(vp);pr.Axios=Wc;pr.CanceledError=ah;pr.CancelToken=i7;pr.isCancel=PP;pr.VERSION=IP;pr.toFormData=nv;pr.AxiosError=tt;pr.Cancel=pr.CanceledError;pr.all=function(t){return Promise.all(t)};pr.spread=s7;pr.isAxiosError=o7;pr.mergeConfig=id;pr.AxiosHeaders=ka;pr.formToJSON=e=>DP(me.isHTMLForm(e)?new FormData(e):e);pr.getAdapter=zP.getAdapter;pr.HttpStatusCode=Mw;pr.default=pr;const{Axios:jme,AxiosError:wme,CanceledError:kme,isCancel:Cme,CancelToken:Sme,VERSION:$me,all:Eme,Cancel:Tme,isAxiosError:Ame,spread:Fme,toFormData:Dme,AxiosHeaders:Pme,HttpStatusCode:Mme,formToJSON:Ome,getAdapter:Rme,mergeConfig:Nme}=pr,l7="https://inveb-api-production.up.railway.app/api/v1",c7="https://inveb-api-production.up.railway.app",a0="inveb_cascade_token",$x="inveb_cascade_user",de=pr.create({baseURL:l7,headers:{"Content-Type":"application/json"}}),d7=pr.create({baseURL:c7,headers:{"Content-Type":"application/json"}});de.interceptors.request.use(e=>{var r;const t=localStorage.getItem(a0);return t&&(e.headers.Authorization=`Bearer ${t}`),console.log(`[API] ${(r=e.method)==null?void 0:r.toUpperCase()} ${e.url}`),e},e=>Promise.reject(e));de.interceptors.response.use(e=>e,e=>{var t,r;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem(a0),localStorage.removeItem($x)),console.error("[API Error]",((r=e.response)==null?void 0:r.data)||e.message),Promise.reject(e)});const mo={login:async e=>{const t=await de.post("/auth/login",e);return localStorage.setItem(a0,t.data.access_token),localStorage.setItem($x,JSON.stringify(t.data.user)),t.data},logout:()=>{localStorage.removeItem(a0),localStorage.removeItem($x)},getCurrentUser:async()=>(await de.get("/auth/me")).data,isAuthenticated:()=>!!localStorage.getItem(a0),getStoredUser:()=>{const e=localStorage.getItem($x);if(e)try{return JSON.parse(e)}catch{return null}return null},verifyToken:async()=>{try{return(await de.post("/auth/verify")).data.valid}catch{return!1}},changePassword:async(e,t)=>(await de.post("/auth/change-password",{current_password:e,new_password:t})).data,forgotPassword:async e=>(await de.post("/auth/forgot-password",{email:e})).data,validateResetToken:async(e,t)=>(await de.post("/auth/validate-reset-token",{token:e,email:t})).data,resetPassword:async(e,t,r)=>(await de.post("/auth/reset-password",{token:e,email:t,new_password:r})).data},Rn={list:async(e={})=>{var n,i,s,o,l,c,u;const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.id_ot&&t.append("id_ot",e.id_ot.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.carton&&t.append("carton",e.carton),e.material&&t.append("material",e.material),e.descripcion&&t.append("descripcion",e.descripcion),(n=e.client_id)==null||n.forEach(h=>t.append("client_id",h.toString())),(i=e.estado_id)==null||i.forEach(h=>t.append("estado_id",h.toString())),(s=e.area_id)==null||s.forEach(h=>t.append("area_id",h.toString())),(o=e.canal_id)==null||o.forEach(h=>t.append("canal_id",h.toString())),(l=e.vendedor_id)==null||l.forEach(h=>t.append("vendedor_id",h.toString())),(c=e.planta_id)==null||c.forEach(h=>t.append("planta_id",h.toString())),(u=e.tipo_solicitud)==null||u.forEach(h=>t.append("tipo_solicitud",h.toString())),(await de.get(`/work-orders/?${t.toString()}`)).data},getFilterOptions:async()=>(await de.get("/work-orders/filter-options")).data,get:async e=>(await de.get(`/work-orders/${e}`)).data,create:async e=>(await de.post("/work-orders/",e)).data,update:async(e,t)=>(await de.put(`/work-orders/${e}`,t)).data,getManagementHistory:async e=>(await de.get(`/work-orders/${e}/management`)).data,getWorkflowOptions:async e=>(await de.get(`/work-orders/${e}/workflow-options`)).data,transition:async(e,t)=>(await de.post(`/work-orders/${e}/transition`,t)).data,getPendingApproval:async(e=1,t=20)=>(await de.get(`/work-orders/pending-approval?page=${e}&page_size=${t}`)).data,approve:async e=>(await de.put(`/work-orders/${e}/approve`)).data,reject:async e=>(await de.put(`/work-orders/${e}/reject`)).data,getFilesByArea:async e=>[],createAnswer:async(e,t,r)=>({id:0,message:"No implementado"})},u7={downloadOTExcel:async e=>{const t=await de.get(`/exports/ot/${e}/excel`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTSAP:async e=>{const t=await de.get(`/exports/ot/${e}/sap`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`SAP_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTsListExcel:async(e={})=>{const t=new URLSearchParams;e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.area_id&&t.append("area_id",e.area_id.toString()),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.client_id&&t.append("client_id",e.client_id.toString()),e.fecha_desde&&t.append("fecha_desde",e.fecha_desde),e.fecha_hasta&&t.append("fecha_hasta",e.fecha_hasta);const r=await de.get(`/exports/ots/excel?${t.toString()}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=n,i.setAttribute("download",`Lista_OTs_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(n)},getOTLog:async(e,t={})=>{const r=new URLSearchParams;return t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString()),t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),(await de.get(`/exports/ot/${e}/log?${r.toString()}`)).data},downloadOTLogExcel:async(e,t={})=>{const r=new URLSearchParams;t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString());const n=await de.get(`/exports/ot/${e}/log/excel?${r.toString()}`,{responseType:"blob"}),i=window.URL.createObjectURL(new Blob([n.data])),s=document.createElement("a");s.href=i,s.setAttribute("download",`Log_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(i)}},d1={downloadEtiquetaMuestra:async(e,t="producto")=>{const r=await de.get(`/pdfs/etiqueta-muestra/${e}?tipo=${t}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=n,i.setAttribute("download",`Etiqueta_${t==="producto"?"Producto":"Cliente"}_${e}.pdf`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(n)},downloadFichaDiseno:async e=>{const t=await de.get(`/pdfs/ficha-diseno/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Ficha_Diseno_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadEstudioBench:async e=>{const t=await de.get(`/pdfs/estudio-bench/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Estudio_Benchmarking_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadCotizacion:async e=>{const t=await de.get(`/pdfs/cotizacion/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Cotizacion_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)}},pu={getInstalacionesCliente:async e=>(await de.get(`/cascades/clientes/${e}/instalaciones`)).data,getInstalacionesClienteCotiza:async e=>(await de.get(`/cascades/clientes/${e}/instalaciones-cotiza`)).data,getContactosCliente:async(e,t)=>{const r=t?`?instalacion_id=${t}`:"";return(await de.get(`/cascades/clientes/${e}/contactos${r}`)).data},getInformacionInstalacion:async e=>(await de.get(`/cascades/instalaciones/${e}`)).data,getDatosContacto:async e=>(await de.get(`/cascades/contactos/${e}`)).data,getServiciosMaquila:async e=>(await de.get(`/cascades/productos/${e}/servicios-maquila`)).data,getRubro:async e=>(await de.get(`/cascades/jerarquias/${e}/rubro`)).data,getJerarquia2Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await de.get(`/cascades/jerarquias/nivel2-rubro?hierarchy_id=${e}${r}`)).data},getJerarquia3Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await de.get(`/cascades/jerarquias/nivel3-rubro?subhierarchy_id=${e}${r}`)).data}},UP={getRules:async()=>(await de.get("/cascade-rules/")).data,getRule:async e=>(await de.get(`/cascade-rules/${e}`)).data,getRulesByTrigger:async e=>(await de.get(`/cascade-rules/trigger/${e}`)).data,validateCombination:async e=>(await de.get("/cascade-combinations/validate/",{params:e})).data,healthCheck:async()=>(await d7.get("/health")).data,getFormOptions:async()=>(await de.get("/form-options/")).data,getCADDetails:async e=>(await de.get(`/work-orders/cad/${e}`)).data},VP={list:async(e=1,t=20)=>(await de.get("/notifications/",{params:{page:e,page_size:t}})).data,markAsRead:async e=>(await de.put(`/notifications/${e}/read`)).data,create:async e=>(await de.post("/notifications/",e)).data,getCount:async()=>(await de.get("/notifications/count")).data},Hl={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.clasificacion_id&&t.append("clasificacion_id",e.clasificacion_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await de.get(`/mantenedores/clients/?${t.toString()}`)).data},get:async e=>(await de.get(`/mantenedores/clients/${e}`)).data,create:async e=>(await de.post("/mantenedores/clients/",e)).data,update:async(e,t)=>(await de.put(`/mantenedores/clients/${e}`,t)).data,activate:async e=>(await de.put(`/mantenedores/clients/${e}/activate`)).data,deactivate:async e=>(await de.put(`/mantenedores/clients/${e}/deactivate`)).data,getClasificaciones:async()=>(await de.get("/mantenedores/clients/clasificaciones")).data},gd={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.role_id&&t.append("role_id",e.role_id.toString()),e.work_space_id&&t.append("work_space_id",e.work_space_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await de.get(`/mantenedores/users/?${t.toString()}`)).data},get:async e=>(await de.get(`/mantenedores/users/${e}`)).data,create:async e=>(await de.post("/mantenedores/users/",e)).data,update:async(e,t)=>(await de.put(`/mantenedores/users/${e}`,t)).data,activate:async e=>(await de.put(`/mantenedores/users/${e}/activate`)).data,deactivate:async e=>(await de.put(`/mantenedores/users/${e}/deactivate`)).data,getRoles:async()=>(await de.get("/mantenedores/users/roles")).data,getWorkSpaces:async()=>(await de.get("/mantenedores/users/workspaces")).data},to={getTablas:async()=>(await de.get("/mantenedores/generic/tablas")).data,list:async(e,t={})=>{const r=new URLSearchParams;return t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),t.search&&r.append("search",t.search),t.activo!==void 0&&r.append("activo",t.activo.toString()),(await de.get(`/mantenedores/generic/${e}?${r.toString()}`)).data},get:async(e,t)=>(await de.get(`/mantenedores/generic/${e}/${t}`)).data,create:async(e,t)=>(await de.post(`/mantenedores/generic/${e}`,{data:t})).data,update:async(e,t,r)=>(await de.put(`/mantenedores/generic/${e}/${t}`,{data:r})).data,activate:async(e,t)=>(await de.put(`/mantenedores/generic/${e}/${t}/activate`)).data,deactivate:async(e,t)=>(await de.put(`/mantenedores/generic/${e}/${t}/deactivate`)).data,bulkUpload:async(e,t)=>(await de.post(`/mantenedores/generic/${e}/bulk`,{items:t})).data},kr={listNivel1:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await de.get(`/mantenedores/jerarquias/nivel1?${t.toString()}`)).data},getNivel1:async e=>(await de.get(`/mantenedores/jerarquias/nivel1/${e}`)).data,createNivel1:async e=>(await de.post("/mantenedores/jerarquias/nivel1",e)).data,updateNivel1:async(e,t)=>(await de.put(`/mantenedores/jerarquias/nivel1/${e}`,t)).data,activateNivel1:async e=>(await de.put(`/mantenedores/jerarquias/nivel1/${e}/activate`)).data,deactivateNivel1:async e=>(await de.put(`/mantenedores/jerarquias/nivel1/${e}/deactivate`)).data,getNivel2Parents:async()=>(await de.get("/mantenedores/jerarquias/nivel2/parents")).data,listNivel2:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),(await de.get(`/mantenedores/jerarquias/nivel2?${t.toString()}`)).data},getNivel2:async e=>(await de.get(`/mantenedores/jerarquias/nivel2/${e}`)).data,createNivel2:async e=>(await de.post("/mantenedores/jerarquias/nivel2",e)).data,updateNivel2:async(e,t)=>(await de.put(`/mantenedores/jerarquias/nivel2/${e}`,t)).data,activateNivel2:async e=>(await de.put(`/mantenedores/jerarquias/nivel2/${e}/activate`)).data,deactivateNivel2:async e=>(await de.put(`/mantenedores/jerarquias/nivel2/${e}/deactivate`)).data,getNivel3Parents:async e=>{const t=new URLSearchParams;return e&&t.append("hierarchy_id",e.toString()),(await de.get(`/mantenedores/jerarquias/nivel3/parents?${t.toString()}`)).data},listNivel3:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),e.subhierarchy_id&&t.append("subhierarchy_id",e.subhierarchy_id.toString()),(await de.get(`/mantenedores/jerarquias/nivel3?${t.toString()}`)).data},getNivel3:async e=>(await de.get(`/mantenedores/jerarquias/nivel3/${e}`)).data,createNivel3:async e=>(await de.post("/mantenedores/jerarquias/nivel3",e)).data,updateNivel3:async(e,t)=>(await de.put(`/mantenedores/jerarquias/nivel3/${e}`,t)).data,activateNivel3:async e=>(await de.put(`/mantenedores/jerarquias/nivel3/${e}/activate`)).data,deactivateNivel3:async e=>(await de.put(`/mantenedores/jerarquias/nivel3/${e}/deactivate`)).data},Fn={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.user_id&&t.append("user_id",e.user_id.toString()),e.cotizacion_id&&t.append("cotizacion_id",e.cotizacion_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.estado_id&&e.estado_id.forEach(n=>t.append("estado_id",n.toString())),e.client_id&&e.client_id.forEach(n=>t.append("client_id",n.toString())),(await de.get(`/cotizaciones/?${t.toString()}`)).data},get:async e=>(await de.get(`/cotizaciones/${e}`)).data,create:async e=>(await de.post("/cotizaciones/",e)).data,update:async(e,t)=>(await de.put(`/cotizaciones/${e}`,t)).data,delete:async e=>(await de.delete(`/cotizaciones/${e}`)).data,solicitarAprobacion:async e=>(await de.post(`/cotizaciones/${e}/solicitar-aprobacion`)).data,gestionarAprobacion:async(e,t,r)=>(await de.post(`/cotizaciones/${e}/gestionar-aprobacion`,{action:t,motivo:r})).data,getAprobaciones:async e=>(await de.get(`/cotizaciones/${e}/aprobaciones`)).data,duplicar:async e=>(await de.post(`/cotizaciones/${e}/duplicar`)).data,versionar:async e=>(await de.post(`/cotizaciones/${e}/versionar`)).data,retomar:async e=>(await de.post(`/cotizaciones/${e}/retomar`)).data,getEstados:async()=>(await de.get("/cotizaciones/estados/")).data,getPendientesAprobacion:async e=>{const t=new URLSearchParams;return e&&t.append("role_id",e.toString()),(await de.get(`/cotizaciones/pendientes-aprobacion/?${t.toString()}`)).data},exportPdf:async e=>{const t=await de.get(`/cotizaciones/${e}/export-pdf`,{responseType:"blob"}),r=new Blob([t.data],{type:t.headers["content-type"]}),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n;const s=t.headers["content-disposition"];let o=`cotizacion_${e}.pdf`;if(s){const l=s.match(/filename=(.+)/);l&&(o=l[1])}i.setAttribute("download",o),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)},getPendientesAprobacionExterno:async(e={})=>{const t=new URLSearchParams;return Object.entries(e).forEach(([n,i])=>{i!=null&&i!==""&&t.append(n,i.toString())}),(await de.get(`/cotizaciones/pendientes-aprobacion-externo/?${t.toString()}`)).data},solicitarAprobacionExterno:async(e,t)=>(await de.post(`/cotizaciones/${e}/solicitar-aprobacion-externo?user_id=${t}`)).data,gestionarAprobacionExterno:async(e,t)=>(await de.post(`/cotizaciones/${e}/gestionar-aprobacion-externo`,t)).data,getHistorialAprobaciones:async e=>(await de.get(`/cotizaciones/${e}/historial-aprobaciones`)).data,getDetalleParaOT:async(e,t)=>(await de.get(`/cotizaciones/detalle/${e}/para-ot`,{params:{tipo_solicitud:t}})).data,getDetallesParaOT:async(e,t=1,r=20)=>{const n=new URLSearchParams;return n.append("page",t.toString()),n.append("page_size",r.toString()),e&&n.append("cotizacion_id",e.toString()),(await de.get(`/cotizaciones/detalles-para-ot/?${n.toString()}`)).data},getCostosResumen:async e=>(await de.get(`/cotizaciones/${e}/costos-resumen`)).data,createDetalle:async(e,t)=>(await de.post(`/cotizaciones/${e}/detalles`,t)).data,getDetalles:async e=>(await de.get(`/cotizaciones/${e}/detalles`)).data,createFromOT:async(e,t)=>(await de.post(`/cotizaciones/from-ot/${e}`,t||{})).data},r_={getPendingAssignment:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.asignado&&t.append("asignado",e.asignado),e.tipo_solicitud&&t.append("tipo_solicitud",e.tipo_solicitud),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.vendedor_id&&t.append("vendedor_id",e.vendedor_id.toString()),e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await de.get(`/work-orders/pending-assignment?${t.toString()}`)).data},assign:async(e,t)=>(await de.put(`/work-orders/${e}/assign`,{profesional_id:t})).data,assignWithMessage:async(e,t)=>(await de.put(`/work-orders/${e}/assign`,t)).data,getProfessionals:async()=>(await de.get("/work-orders/professionals")).data},na={getOTsPorUsuario:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.area_id&&t.append("area_id",e.area_id.toString()),(await de.get(`/reports/ots-por-usuario?${t.toString()}`)).data},getOTsCompletadas:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.client_id&&t.append("client_id",e.client_id.toString()),(await de.get(`/reports/ots-completadas?${t.toString()}`)).data},getTiempoPorArea:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await de.get(`/reports/tiempo-por-area?${t.toString()}`)).data},getCargaMensual:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await de.get(`/reports/carga-mensual?${t.toString()}`)).data},getRechazosMes:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await de.get(`/reports/rechazos-mes?${t.toString()}`)).data},getAnulaciones:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await de.get(`/reports/anulaciones?${t.toString()}`)).data},getMotivosRechazo:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await de.get(`/reports/motivos-rechazo?${t.toString()}`)).data},getTiempoPrimeraMuestra:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await de.get(`/reports/tiempo-primera-muestra?${t.toString()}`)).data},getGestionOTsActivas:async e=>{const t=new URLSearchParams;return e&&t.append("area_id",e.toString()),(await de.get(`/reports/gestion-ots-activas?${t.toString()}`)).data},getIndicadoresSalaMuestra:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await de.get(`/reports/indicadores-sala-muestra?${t.toString()}`)).data},getDisenoEstructuralSala:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await de.get(`/reports/diseno-estructural-sala?${t.toString()}`)).data},getTiempoDisenadorExterno:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await de.get(`/reports/tiempo-disenador-externo?${t.toString()}`)).data},getMuestras:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.estado&&t.append("estado",e.estado),(await de.get(`/reports/muestras?${t.toString()}`)).data}},h7={0:"Sin Asignar",1:"En Proceso",2:"Rechazada",3:"Terminada",4:"Anulada",5:"Devuelta",6:"Sala de Corte"},_r={listByOT:async e=>(await de.get(`/muestras/ot/${e}`)).data,getOptions:async()=>(await de.get("/muestras/options")).data,get:async e=>(await de.get(`/muestras/${e}`)).data,create:async e=>(await de.post("/muestras/",e)).data,update:async(e,t)=>(await de.put(`/muestras/${e}`,t)).data,terminar:async e=>(await de.put(`/muestras/${e}/terminar`)).data,rechazar:async(e,t)=>(await de.put(`/muestras/${e}/rechazar`,{observacion:t})).data,anular:async e=>(await de.put(`/muestras/${e}/anular`)).data,devolver:async(e,t)=>(await de.put(`/muestras/${e}/devolver`,{observacion:t})).data,togglePrioritaria:async e=>(await de.put(`/muestras/${e}/prioritaria`)).data,delete:async e=>(await de.delete(`/muestras/${e}`)).data,asignarSalaCorte:async(e,t)=>(await de.put(`/muestras/${e}/sala-corte?sala_corte_id=${t}`)).data,iniciarProceso:async e=>(await de.put(`/muestras/${e}/en-proceso`)).data},f7={...Rn,getFormOptionsComplete:async()=>(await de.get("/work-orders/form-options-complete")).data,duplicate:async e=>(await de.post(`/work-orders/${e}/duplicate`)).data},p7={uploadOTFile:async(e,t,r)=>{const n=new FormData;return n.append("file",t),n.append("file_type",r),(await de.post(`/uploads/ot/${e}/file`,n,{headers:{"Content-Type":"multipart/form-data"}})).data},getOTFiles:async e=>(await de.get(`/uploads/ot/${e}/files`)).data,deleteOTFile:async(e,t)=>(await de.delete(`/uploads/ot/${e}/file/${t}`)).data,uploadManagementFile:async(e,t)=>{const r=new FormData;return r.append("file",t),(await de.post(`/uploads/management/${e}/file`,r,{headers:{"Content-Type":"multipart/form-data"}})).data},getManagementFiles:async e=>(await de.get(`/uploads/management/${e}/files`)).data,deleteFile:async e=>(await de.delete(`/uploads/file/${e}`)).data,getFileUrl:e=>{var r;return`${((r=de.defaults.baseURL)==null?void 0:r.replace("/api/v1",""))||""}${e}`}};function m7(){return zt({queryKey:["form-options"],queryFn:UP.getFormOptions,staleTime:10*60*1e3})}p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`;p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: ${d.spacing.lg};
`;const g7=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: ${d.spacing.md};

  @media (max-width: 992px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 576px) {
    grid-template-columns: 1fr;
  }
`;p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`;p.h3`
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.primary};
  margin-bottom: ${d.spacing.sm};
  padding-bottom: ${d.spacing.xs};
  border-bottom: 2px solid ${d.colors.accent};
`;p.span`
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};

  ${({$status:e})=>{switch(e){case"valid":return`
          background-color: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"invalid":return`
          background-color: ${d.colors.danger}20;
          color: ${d.colors.danger};
        `;default:return`
          background-color: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `}}}
`;p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.md};
`;p.div`
  flex: 1;
  height: 4px;
  border-radius: 2px;
  transition: background-color ${d.transitions.normal};

  ${({$active:e,$completed:t})=>t?`background-color: ${d.colors.success};`:e?`background-color: ${d.colors.accent};`:`background-color: ${d.colors.border};`}
`;p.div`
  background-color: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`;p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};

  &:not(:last-child) {
    border-bottom: 1px dashed ${d.colors.border};
  }
`;p.code`
  background-color: ${d.colors.primary}15;
  color: ${d.colors.primary};
  padding: 2px 6px;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`;const zs=[];function bk({values:e,onChange:t,fieldErrors:r={}}){const{data:n,isLoading:i}=m7(),s=S.useMemo(()=>({productType:(n==null?void 0:n.product_types)||zs,impresion:(n==null?void 0:n.impresion_types)||zs,fsc:(n==null?void 0:n.fsc_options)||zs,cinta:(n==null?void 0:n.cinta_options)||zs,coverageInternal:(n==null?void 0:n.coverage_internal)||zs,coverageExternal:(n==null?void 0:n.coverage_external)||zs,planta:(n==null?void 0:n.plantas)||zs,cartonColor:(n==null?void 0:n.carton_colors)||zs,carton:(n==null?void 0:n.cartones)||zs}),[n]),o=S.useCallback((c,u)=>{const h={...u};return c<=2&&(h.impresion=null),c<=3&&(h.fsc=null),c<=4&&(h.cinta=null),c<=5&&(h.coverageInternalId=null),c<=6&&(h.coverageExternalId=null),c<=7&&(h.plantaId=null),c<=8&&(h.cartonColor=null),c<=9&&(h.cartonId=null),h},[]),l=S.useCallback((c,u)=>{const h={productTypeId:1,impresion:2,fsc:3,cinta:4,coverageInternalId:5,coverageExternalId:6,plantaId:7,cartonColor:8,cartonId:9};let f=u;u===""||u===null?f=null:["productTypeId","coverageInternalId","coverageExternalId","plantaId","cartonId"].includes(c)&&(f=parseInt(u,10));const m=h[c];let v={...e,[c]:f};v=o(m+1,v),t(v)},[e,t,o]);return i?a.jsx(CI,{}):a.jsxs(g7,{children:[a.jsx(Ns,{label:"Tipo Item *",value:e.productTypeId,options:s.productType,onChange:c=>l("productTypeId",c),placeholder:"Seleccionar...",error:!!r.product_type_id,helperText:r.product_type_id}),a.jsx(Ns,{label:"Cinta",value:e.cinta,options:s.cinta,onChange:c=>l("cinta",c),disabled:!e.fsc,placeholder:"Seleccionar...",error:!!r.cinta,helperText:r.cinta}),a.jsx(Ns,{label:"Planta Objetivo",value:e.plantaId,options:s.planta,onChange:c=>l("plantaId",c),disabled:!e.coverageExternalId,placeholder:"Seleccionar...",error:!!r.planta_id,helperText:r.planta_id}),a.jsx(Ns,{label:"Impresion *",value:e.impresion,options:s.impresion,onChange:c=>l("impresion",c),disabled:!e.productTypeId,placeholder:"Seleccionar...",error:!!r.impresion,helperText:r.impresion}),a.jsx(Ns,{label:"Recubrimiento Interno",value:e.coverageInternalId,options:s.coverageInternal,onChange:c=>l("coverageInternalId",c),disabled:!e.cinta,placeholder:"Seleccionar...",error:!!r.coverage_internal_id,helperText:r.coverage_internal_id}),a.jsx(Ns,{label:"Color Carton *",value:e.cartonColor,options:s.cartonColor,onChange:c=>l("cartonColor",c),disabled:!e.plantaId,placeholder:"Seleccionar...",error:!!r.carton_color,helperText:r.carton_color}),a.jsx(Ns,{label:"FSC",value:e.fsc,options:s.fsc,onChange:c=>l("fsc",c),disabled:!e.impresion,placeholder:"Seleccionar...",error:!!r.fsc,helperText:r.fsc}),a.jsx(Ns,{label:"Recubrimiento Externo",value:e.coverageExternalId,options:s.coverageExternal,onChange:c=>l("coverageExternalId",c),disabled:!e.coverageInternalId,placeholder:"Seleccionar...",error:!!r.coverage_external_id,helperText:r.coverage_external_id}),a.jsx(Ns,{label:"Carton",value:e.cartonId,options:s.carton,onChange:c=>l("cartonId",c),disabled:!e.cartonColor,placeholder:"Seleccionar...",error:!!r.carton_id,helperText:r.carton_id})]})}const x7=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.primary} 0%, ${d.colors.primaryDark} 100%);
  padding: ${d.spacing.lg};
`,v7=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 400px;
`,_7=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,y7=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h1};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,b7=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0;
`,j7=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`,w$=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,k$=p.label`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,C$=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s, box-shadow 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textSecondary};
  }
`,w7=p.div`
  background-color: ${d.colors.danger}15;
  color: ${d.colors.danger};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
`,k7=p.div`
  margin-top: ${d.spacing.lg};
  text-align: center;
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,C7=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.sm};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`;function S7({onLogin:e,onNavigate:t}){const[r,n]=S.useState(""),[i,s]=S.useState(""),[o,l]=S.useState(null),[c,u]=S.useState(!1),h=S.useCallback(v=>{let g=v.replace(/[^0-9kK]/g,"");if(g.length>9&&(g=g.slice(0,9)),g.length>1){const x=g.slice(-1);return`${g.slice(0,-1)}-${x.toUpperCase()}`}return g},[]),f=S.useCallback(v=>{const g=h(v.target.value);n(g),l(null)},[h]),m=S.useCallback(async v=>{if(v.preventDefault(),l(null),!r||!i){l("Por favor complete todos los campos");return}u(!0);try{e?await e(r,i)||l("RUT o contrasea incorrectos"):(console.log("Login attempt:",{rut:r,password:i}),l("Modo demo - autenticacion no implementada"))}catch{l("Error de conexion. Intente nuevamente.")}finally{u(!1)}},[r,i,e]);return a.jsx(x7,{children:a.jsxs(v7,{children:[a.jsxs(_7,{children:[a.jsx(y7,{children:"INVEB"}),a.jsx(b7,{children:"Sistema de Ordenes de Trabajo"})]}),a.jsxs(j7,{onSubmit:m,children:[a.jsxs(w$,{children:[a.jsx(k$,{htmlFor:"rut",children:"RUT"}),a.jsx(C$,{id:"rut",type:"text",value:r,onChange:f,placeholder:"12345678-9",autoComplete:"username",disabled:c})]}),a.jsxs(w$,{children:[a.jsx(k$,{htmlFor:"password",children:"Contrasea"}),a.jsx(C$,{id:"password",type:"password",value:i,onChange:v=>{s(v.target.value),l(null)},placeholder:"",autoComplete:"current-password",disabled:c})]}),o&&a.jsx(w7,{children:o}),a.jsx(gI,{type:"submit",$variant:"primary",disabled:c,style:{width:"100%",marginTop:d.spacing.sm},children:c?"Ingresando...":"Ingresar"}),t&&a.jsx(C7,{type:"button",onClick:()=>t("forgot-password"),children:"Olvide mi contrasena"})]}),a.jsx(k7,{children:"MS-004 CascadeService v1.0"})]})})}function ca({onNavigate:e}){const[t,r]=S.useState([]),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),[u,h]=S.useState(1),[f,m]=S.useState(1),[v,g]=S.useState(0),[x,_]=S.useState({page:1,page_size:20}),[b,y]=S.useState({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]});S.useEffect(()=>{(async()=>{try{const G=await Rn.getFilterOptions();c(G)}catch(G){console.error("Error loading filter options:",G)}})()},[]);const j=S.useCallback(async()=>{i(!0),o(null);try{const B=await Rn.list(x);r(B.items),g(B.total),m(B.total_pages),h(B.page)}catch(B){o("Error cargando ordenes de trabajo"),console.error(B)}finally{i(!1)}},[x]);S.useEffect(()=>{j()},[j]);const k=B=>{B.preventDefault();const G={page:1,page_size:20};b.id_ot&&(G.id_ot=parseInt(b.id_ot)),b.date_desde&&(G.date_desde=b.date_desde),b.date_hasta&&(G.date_hasta=b.date_hasta),b.cad&&(G.cad=b.cad),b.carton&&(G.carton=b.carton),b.material&&(G.material=b.material),b.descripcion&&(G.descripcion=b.descripcion),b.client_id.length&&(G.client_id=b.client_id),b.estado_id.length&&(G.estado_id=b.estado_id),b.area_id.length&&(G.area_id=b.area_id),b.canal_id.length&&(G.canal_id=b.canal_id),b.vendedor_id.length&&(G.vendedor_id=b.vendedor_id),b.planta_id.length&&(G.planta_id=b.planta_id),_(G)},E=B=>{_(G=>({...G,page:B}))},A=B=>{e&&e("gestionar-ot",B)},[w,P]=S.useState(!1),M=async()=>{P(!0);try{await u7.downloadOTsListExcel({estado_id:b.estado_id[0],area_id:b.area_id[0],canal_id:b.canal_id[0],client_id:b.client_id[0],fecha_desde:b.date_desde||void 0,fecha_hasta:b.date_hasta||void 0})}catch(B){console.error("Error exportando a Excel:",B),alert("Error al exportar a Excel")}finally{P(!1)}},F=(B,G)=>{switch(B){case 1:case 5:return G<=1?"badge-success":G<=2?"badge-warning":"badge-danger";case 2:return G<=1?"badge-success":G<=2?"badge-warning":"badge-danger";case 3:case 4:return G<=2?"badge-success":G<=3?"badge-warning":"badge-danger";case 6:return G<=3?"badge-success":G<=5?"badge-warning":"badge-danger";default:return G<=2?"badge-success":G<=5?"badge-warning":"badge-danger"}},D=(B,G,Y=!1,ae=null,U=0)=>{if(B==null||B===0)return a.jsx("span",{className:"badge badge-secondary",children:"0"});const q=F(U,B);return Y&&ae?a.jsxs("span",{className:`badge ${q}`,title:`${G}: ${B} dias (desde ${ae})`,children:[ae," ",a.jsx("strong",{children:B.toFixed(1)})]}):a.jsx("span",{className:`badge ${q}`,title:`${G}: ${B} dias`,children:B.toFixed(1)})},W=B=>{switch(B){case 6:return a.jsx("span",{className:"ot-icon",title:"Licitacion",children:""});case 7:return a.jsx("span",{className:"ot-icon",title:"Proyecto Innovacion",children:""});default:return null}};return a.jsxs("div",{className:"work-orders-dashboard",children:[a.jsxs("div",{className:"dashboard-header",children:[a.jsx("h1",{children:"Ordenes de Trabajo"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("crear-ot"),children:"Crear OT"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("notificaciones"),children:"Notificaciones OT"}),a.jsx("button",{className:"btn btn-secondary",onClick:M,disabled:w,title:"Exportar lista de OTs a Excel",children:w?"Exportando...":"Exportar Excel"})]})]}),a.jsxs("form",{className:"filters-form",onSubmit:k,children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Desde"}),a.jsx("input",{type:"date",value:b.date_desde,onChange:B=>y(G=>({...G,date_desde:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Hasta"}),a.jsx("input",{type:"date",value:b.date_hasta,onChange:B=>y(G=>({...G,date_hasta:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"ID OT"}),a.jsx("input",{type:"text",value:b.id_ot,onChange:B=>y(G=>({...G,id_ot:B.target.value})),placeholder:"Ej: 26590"})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Material"}),a.jsx("input",{type:"text",value:b.material,onChange:B=>y(G=>({...G,material:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Creador"}),a.jsx("select",{multiple:!0,value:b.vendedor_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,vendedor_id:G}))},children:l==null?void 0:l.vendedores.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Canal"}),a.jsx("select",{multiple:!0,value:b.canal_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,canal_id:G}))},children:l==null?void 0:l.canales.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsx("select",{multiple:!0,value:b.estado_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,estado_id:G}))},children:l==null?void 0:l.estados.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Area"}),a.jsx("select",{multiple:!0,value:b.area_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,area_id:G}))},children:l==null?void 0:l.areas.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Cliente"}),a.jsx("select",{multiple:!0,value:b.client_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,client_id:G}))},children:l==null?void 0:l.clientes.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"CAD"}),a.jsx("input",{type:"text",value:b.cad,onChange:B=>y(G=>({...G,cad:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Carton"}),a.jsx("input",{type:"text",value:b.carton,onChange:B=>y(G=>({...G,carton:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Descripcion"}),a.jsx("input",{type:"text",value:b.descripcion,onChange:B=>y(G=>({...G,descripcion:B.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Planta"}),a.jsx("select",{multiple:!0,value:b.planta_id.map(String),onChange:B=>{const G=Array.from(B.target.selectedOptions,Y=>parseInt(Y.value));y(Y=>({...Y,planta_id:G}))},children:l==null?void 0:l.plantas.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))})]})]}),a.jsxs("div",{className:"filter-actions",children:[a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Filtrar"}),a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{y({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]}),_({page:1,page_size:20})},children:"Limpiar"})]})]}),a.jsx("div",{className:"results-info",children:a.jsxs("span",{children:["Mostrando ",t.length," de ",v," registros"]})}),s&&a.jsxs("div",{className:"alert alert-error",children:[s,a.jsx("button",{onClick:j,children:"Reintentar"})]}),n&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{children:"Cargando..."})]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"ot-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"OT"}),a.jsx("th",{children:"Creacion"}),a.jsx("th",{children:"Cliente"}),a.jsx("th",{children:"Descripcion"}),a.jsx("th",{children:"Canal"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{title:"Tiempo Total",children:"T"}),a.jsx("th",{children:"Ventas"}),a.jsx("th",{children:"Dis. Estructural"}),a.jsx("th",{children:"Muestra"}),a.jsx("th",{children:"Dis. Grafico"}),a.jsx("th",{children:"Dis. Externo"}),a.jsx("th",{children:"Calc. Paletizado"}),a.jsx("th",{children:"Catalogacion"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(B=>{var G;return a.jsxs("tr",{children:[a.jsxs("td",{children:[W(B.tipo_solicitud),a.jsx("span",{title:`Creador: ${B.creador_nombre}`,children:B.id})]}),a.jsx("td",{children:B.created_at}),a.jsx("td",{className:"truncate",title:B.client_name,children:B.client_name}),a.jsx("td",{className:"truncate",title:B.descripcion,children:B.descripcion}),a.jsx("td",{className:"center",children:(G=B.canal)==null?void 0:G.charAt(0)}),a.jsx("td",{children:B.item_tipo}),a.jsx("td",{title:B.estado,children:B.estado_abrev}),a.jsx("td",{className:"time-cell time-total",children:a.jsxs("span",{className:"badge badge-total",title:`Tiempo Total: ${B.tiempo_total} dias`,children:[" ",Math.round(B.tiempo_total||0)]})}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_venta,"Ventas",B.current_area_id===1,B.ultimo_cambio_area,1)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_desarrollo,"Desarrollo",B.current_area_id===2,B.ultimo_cambio_area,2)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_muestra,"Muestra",B.current_area_id===6,B.ultimo_cambio_area,6)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_diseno,"Diseno",B.current_area_id===3,B.ultimo_cambio_area,3)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_externo,"Externo",!1,null,0)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_precatalogacion,"Precatalogacion",B.current_area_id===5,B.ultimo_cambio_area,5)}),a.jsx("td",{className:"time-cell",children:D(B.tiempo_catalogacion,"Catalogacion",B.current_area_id===4,B.ultimo_cambio_area,4)}),a.jsx("td",{className:"actions",children:a.jsx("button",{className:"btn-icon",onClick:()=>A(B.id),title:"Ver OT",children:""})})]},B.id)})})]})}),f>1&&a.jsxs("div",{className:"pagination",children:[a.jsx("button",{disabled:u===1,onClick:()=>E(u-1),children:"Anterior"}),a.jsxs("span",{children:["Pagina ",u," de ",f]}),a.jsx("button",{disabled:u===f,onClick:()=>E(u+1),children:"Siguiente"})]})]})}const S$={cad_id:null,carton_id:null,pegado_id:null,tiempo_unitario:"",carton_muestra_id:null,destinatarios_id:[],cantidad_vendedor:null,comentario_vendedor:"Retira Vendedor",cantidad_disenador:null,comentario_disenador:"",cantidad_disenador_revision:null,comentario_disenador_revision:"",cantidad_laboratorio:null,comentario_laboratorio:"",destinatario_1:"",comuna_1:null,direccion_1:"",cantidad_1:null,comentario_1:"",destinatario_2:"",comuna_2:null,direccion_2:"",cantidad_2:null,comentario_2:"",destinatario_3:"",comuna_3:null,direccion_3:"",cantidad_3:null,comentario_3:"",destinatario_4:"",comuna_4:null,direccion_4:"",cantidad_4:null,comentario_4:""},$7=[{id:"1",nombre:"Retira Ventas VB"},{id:"2",nombre:"Retira Diseador VB"},{id:"3",nombre:"Envo Laboratorio"},{id:"4",nombre:"Envo Cliente VB"},{id:"5",nombre:"Retira Diseador Revisin"}],E7=[{id:1,nombre:"Sin Pegar"},{id:2,nombre:"Pegado Flexo Interior"},{id:3,nombre:"Pegado Flexo Exterior"},{id:4,nombre:"Pegado Diecutter"},{id:5,nombre:"Pegado Cajas Fruta"},{id:6,nombre:"Pegado con Cinta"},{id:7,nombre:"Sin Pegar con Cinta"}],im=[{id:"Chile Express",nombre:"Chile Express"},{id:"Auto Correo",nombre:"Auto Correo"},{id:"Camin",nombre:"Camin"}],$$=p.div`
  background: white;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
`,E$=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
`,T$=p.h3`
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,A$=p.div`
  padding: 1rem;
`,us=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,_t=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,yt=p.label`
  font-size: 0.8rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,gr=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Za=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,T7=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,kh=p.div`
  display: ${e=>e.$visible?"block":"none"};
  margin-top: 1rem;
  padding: 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  background: #fafafa;
`,Ch=p.h4`
  text-align: center;
  color: ${d.colors.primary};
  margin: 0 0 1rem 0;
  font-size: 0.95rem;
`,A7=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,F$=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border: none;

    &:hover {
      background: ${d.colors.primaryDark};
    }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border: 1px solid ${d.colors.border};

    &:hover {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,F7=[4,17];function D7({isOpen:e,onClose:t,onSave:r,cadId:n,cartonId:i,tipoSolicitud:s,cads:o=[],cartones:l=[],cartonesMuestra:c=[],comunas:u=[],roleId:h}){const[f,m]=S.useState({...S$,cad_id:n||null,carton_id:i||null}),v=S.useMemo(()=>h?F7.includes(h):!1,[h]),g=S.useMemo(()=>s===1||s===4||s===7,[s]),x=S.useMemo(()=>({vendedor:f.destinatarios_id.includes("1"),disenador:f.destinatarios_id.includes("2"),laboratorio:f.destinatarios_id.includes("3"),clientes:f.destinatarios_id.includes("4"),disenadorRevision:f.destinatarios_id.includes("5")}),[f.destinatarios_id]),_=S.useCallback((k,E)=>{m(A=>({...A,[k]:E}))},[]),b=S.useCallback(k=>{const E=Array.from(k.target.selectedOptions).map(A=>A.value);m(A=>({...A,destinatarios_id:E}))},[]),y=S.useCallback(()=>{let k=0;x.vendedor&&f.cantidad_vendedor&&(k+=f.cantidad_vendedor),x.disenador&&f.cantidad_disenador&&(k+=f.cantidad_disenador),x.disenadorRevision&&f.cantidad_disenador_revision&&(k+=f.cantidad_disenador_revision),x.laboratorio&&f.cantidad_laboratorio&&(k+=f.cantidad_laboratorio),x.clientes&&(k+=(f.cantidad_1||0)+(f.cantidad_2||0)+(f.cantidad_3||0)+(f.cantidad_4||0)),r(f,k)},[f,x,r]),j=S.useCallback(()=>{m({...S$,cad_id:n||null,carton_id:i||null}),t()},[n,i,t]);return a.jsxs(DI,{isOpen:e,onClose:j,title:"Crear Muestra",size:"xl",children:[a.jsxs($$,{children:[a.jsx(E$,{children:a.jsx(T$,{children:"Caracteristicas de Muestra"})}),a.jsx(A$,{children:a.jsxs(us,{$columns:3,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"CAD"}),a.jsxs(Za,{value:f.cad_id||"",onChange:k=>_("cad_id",k.target.value?Number(k.target.value):null),disabled:g||v,style:v?{backgroundColor:"#f5f5f5"}:void 0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),o.map(k=>a.jsx("option",{value:k.id,children:k.codigo||k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cartn"}),a.jsxs(Za,{value:f.carton_id||"",onChange:k=>_("carton_id",k.target.value?Number(k.target.value):null),disabled:v,style:v?{backgroundColor:"#f5f5f5"}:void 0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),l.map(k=>a.jsx("option",{value:k.id,children:k.codigo||k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Tipo de Pegado"}),a.jsxs(Za,{value:f.pegado_id||"",onChange:k=>_("pegado_id",k.target.value?Number(k.target.value):null),disabled:v,style:v?{backgroundColor:"#f5f5f5"}:void 0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),E7.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Tiempo Unitario"}),a.jsx(gr,{type:"time",value:f.tiempo_unitario,onChange:k=>_("tiempo_unitario",k.target.value),disabled:!0})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cartn Muestra"}),a.jsxs(Za,{value:f.carton_muestra_id||"",onChange:k=>_("carton_muestra_id",k.target.value?Number(k.target.value):null),disabled:v,style:v?{backgroundColor:"#f5f5f5"}:void 0,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),c.map(k=>a.jsx("option",{value:k.id,children:k.codigo||k.nombre||k.id},String(k.id)))]})]})]})})]}),a.jsxs($$,{children:[a.jsx(E$,{children:a.jsx(T$,{children:"Destinos"})}),a.jsxs(A$,{children:[a.jsx(us,{$columns:1,children:a.jsxs(_t,{children:[a.jsx(yt,{children:"Enviar Muestras a"}),a.jsx(T7,{multiple:!0,value:f.destinatarios_id,onChange:b,children:$7.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))})]})}),a.jsx("h4",{style:{textAlign:"center",color:"#7f7f7f",marginTop:"1.5rem"},children:"Datos de Muestra"}),a.jsxs(kh,{$visible:x.vendedor,children:[a.jsx(Ch,{children:"Retira Ventas VB"}),a.jsxs(us,{$columns:3,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_vendedor||"",onChange:k=>_("cantidad_vendedor",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Entrega"}),a.jsx(gr,{type:"text",value:f.comentario_vendedor,onChange:k=>_("comentario_vendedor",k.target.value),disabled:!0,readOnly:!0})]})]})]}),a.jsxs(kh,{$visible:x.disenador,children:[a.jsx(Ch,{children:"Retira Diseador VB"}),a.jsxs(us,{$columns:3,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_disenador||"",onChange:k=>_("cantidad_disenador",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Entrega"}),a.jsx(gr,{type:"text",value:f.comentario_disenador,onChange:k=>_("comentario_disenador",k.target.value)})]})]})]}),a.jsxs(kh,{$visible:x.disenadorRevision,children:[a.jsx(Ch,{children:"Retira Diseador Revisin"}),a.jsxs(us,{$columns:3,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_disenador_revision||"",onChange:k=>_("cantidad_disenador_revision",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Entrega"}),a.jsx(gr,{type:"text",value:f.comentario_disenador_revision,onChange:k=>_("comentario_disenador_revision",k.target.value)})]})]})]}),a.jsxs(kh,{$visible:x.laboratorio,children:[a.jsx(Ch,{children:"Envo Laboratorio"}),a.jsxs(us,{$columns:3,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_laboratorio||"",onChange:k=>_("cantidad_laboratorio",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Envo"}),a.jsx(gr,{type:"text",value:f.comentario_laboratorio,onChange:k=>_("comentario_laboratorio",k.target.value)})]})]})]}),a.jsxs(kh,{$visible:x.clientes,children:[a.jsx(Ch,{children:"Envo Cliente VB"}),a.jsxs(us,{$columns:v?4:5,style:{marginBottom:"1rem"},children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Destinatario 1"}),a.jsx(gr,{type:"text",value:f.destinatario_1,onChange:k=>_("destinatario_1",k.target.value)})]}),!v&&a.jsxs(_t,{children:[a.jsx(yt,{children:"Comuna"}),a.jsxs(Za,{value:f.comuna_1||"",onChange:k=>_("comuna_1",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(k=>a.jsx("option",{value:k.id,children:k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Direccin"}),a.jsx(gr,{type:"text",value:f.direccion_1,onChange:k=>_("direccion_1",k.target.value)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_1||"",onChange:k=>_("cantidad_1",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Envo"}),a.jsxs(Za,{value:f.comentario_1,onChange:k=>_("comentario_1",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),im.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]}),a.jsxs(us,{$columns:v?4:5,style:{marginBottom:"1rem"},children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Destinatario 2"}),a.jsx(gr,{type:"text",value:f.destinatario_2,onChange:k=>_("destinatario_2",k.target.value)})]}),!v&&a.jsxs(_t,{children:[a.jsx(yt,{children:"Comuna"}),a.jsxs(Za,{value:f.comuna_2||"",onChange:k=>_("comuna_2",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(k=>a.jsx("option",{value:k.id,children:k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Direccin"}),a.jsx(gr,{type:"text",value:f.direccion_2,onChange:k=>_("direccion_2",k.target.value)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_2||"",onChange:k=>_("cantidad_2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Envo"}),a.jsxs(Za,{value:f.comentario_2,onChange:k=>_("comentario_2",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),im.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]}),a.jsxs(us,{$columns:v?4:5,style:{marginBottom:"1rem"},children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Destinatario 3"}),a.jsx(gr,{type:"text",value:f.destinatario_3,onChange:k=>_("destinatario_3",k.target.value)})]}),!v&&a.jsxs(_t,{children:[a.jsx(yt,{children:"Comuna"}),a.jsxs(Za,{value:f.comuna_3||"",onChange:k=>_("comuna_3",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(k=>a.jsx("option",{value:k.id,children:k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Direccin"}),a.jsx(gr,{type:"text",value:f.direccion_3,onChange:k=>_("direccion_3",k.target.value)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_3||"",onChange:k=>_("cantidad_3",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Envo"}),a.jsxs(Za,{value:f.comentario_3,onChange:k=>_("comentario_3",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),im.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]}),a.jsxs(us,{$columns:v?4:5,children:[a.jsxs(_t,{children:[a.jsx(yt,{children:"Destinatario 4"}),a.jsx(gr,{type:"text",value:f.destinatario_4,onChange:k=>_("destinatario_4",k.target.value)})]}),!v&&a.jsxs(_t,{children:[a.jsx(yt,{children:"Comuna"}),a.jsxs(Za,{value:f.comuna_4||"",onChange:k=>_("comuna_4",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(k=>a.jsx("option",{value:k.id,children:k.nombre||k.id},String(k.id)))]})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Direccin"}),a.jsx(gr,{type:"text",value:f.direccion_4,onChange:k=>_("direccion_4",k.target.value)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Cantidad"}),a.jsx(gr,{type:"number",min:"0",value:f.cantidad_4||"",onChange:k=>_("cantidad_4",k.target.value?Number(k.target.value):null)})]}),a.jsxs(_t,{children:[a.jsx(yt,{children:"Forma de Envo"}),a.jsxs(Za,{value:f.comentario_4,onChange:k=>_("comentario_4",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),im.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]})]})]})]}),a.jsxs(A7,{children:[a.jsx(F$,{type:"button",onClick:j,children:"Cancelar"}),a.jsx(F$,{type:"button",$variant:"primary",onClick:y,children:"Guardar Muestra"})]})]})}const P7=p.div`
  position: relative;
  width: 100%;
`,M7=p.div`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$isOpen?"#17a2b8":"#ddd"};
  border-radius: 4px;
  font-size: 0.85rem;
  background: ${e=>e.$disabled?"#f5f5f5":"white"};
  cursor: ${e=>e.$disabled?"not-allowed":"pointer"};
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 38px;
  color: ${e=>e.$disabled?"#666":"#333"};

  ${e=>e.$isOpen&&`
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  `}

  &:hover {
    border-color: ${e=>e.$disabled?"#ddd":"#17a2b8"};
  }
`,O7=p.span`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
  color: ${e=>e.$isPlaceholder?"#999":"inherit"};
`,R7=p.span`
  margin-left: 0.5rem;
  transition: transform 0.2s;
  transform: ${e=>e.$isOpen?"rotate(180deg)":"rotate(0)"};
  color: #666;
`,N7=p.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid #17a2b8;
  border-top: none;
  border-radius: 0 0 4px 4px;
  z-index: 1000;
  display: ${e=>e.$isOpen?"block":"none"};
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  max-height: 300px;
  overflow: hidden;
`,z7=p.input`
  width: 100%;
  padding: 0.5rem;
  border: none;
  border-bottom: 1px solid #eee;
  font-size: 0.85rem;
  outline: none;
  box-sizing: border-box;

  &:focus {
    border-bottom-color: #17a2b8;
  }
`,I7=p.div`
  max-height: 250px;
  overflow-y: auto;
`,D$=p.div`
  padding: 0.5rem 0.75rem;
  cursor: pointer;
  font-size: 0.85rem;
  background: ${e=>e.$isSelected?"#e3f2fd":e.$isHighlighted?"#f5f5f5":"white"};
  color: ${e=>e.$isSelected?"#17a2b8":"#333"};

  &:hover {
    background: ${e=>e.$isSelected?"#e3f2fd":"#f5f5f5"};
  }
`,L7=p.div`
  padding: 0.75rem;
  text-align: center;
  color: #666;
  font-size: 0.85rem;
`;function Ow({options:e,value:t,onChange:r,getOptionValue:n,getOptionLabel:i,placeholder:s="Seleccionar...",disabled:o=!1,loading:l=!1}){const[c,u]=S.useState(!1),[h,f]=S.useState(""),[m,v]=S.useState(-1),g=S.useRef(null),x=S.useRef(null),_=e.find(w=>n(w)===t),b=_?i(_):s,y=e.filter(w=>i(w).toLowerCase().includes(h.toLowerCase()));S.useEffect(()=>{const w=P=>{g.current&&!g.current.contains(P.target)&&(u(!1),f(""))};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),S.useEffect(()=>{c&&x.current&&x.current.focus()},[c]),S.useEffect(()=>{v(-1)},[h]);const j=S.useCallback(()=>{!o&&!l&&(u(w=>!w),c||f(""))},[o,l,c]),k=S.useCallback(w=>{r(n(w)),u(!1),f("")},[r,n]),E=S.useCallback(w=>{w.stopPropagation(),r(null)},[r]),A=S.useCallback(w=>{if(c)switch(w.key){case"ArrowDown":w.preventDefault(),v(P=>P<y.length-1?P+1:P);break;case"ArrowUp":w.preventDefault(),v(P=>P>0?P-1:P);break;case"Enter":w.preventDefault(),m>=0&&m<y.length&&k(y[m]);break;case"Escape":u(!1),f("");break}},[c,m,y,k]);return a.jsxs(P7,{ref:g,children:[a.jsxs(M7,{onClick:j,$isOpen:c,$disabled:o||l,children:[a.jsx(O7,{$isPlaceholder:!_,children:l?"Cargando...":b}),_&&!o&&a.jsx("span",{onClick:E,style:{marginRight:"0.5rem",color:"#999",cursor:"pointer"},children:""}),a.jsx(R7,{$isOpen:c,children:""})]}),a.jsxs(N7,{$isOpen:c,children:[a.jsx(z7,{ref:x,type:"text",value:h,onChange:w=>f(w.target.value),onKeyDown:A,placeholder:"Buscar..."}),a.jsxs(I7,{children:[a.jsx(D$,{$isSelected:!t,$isHighlighted:m===-1,onClick:()=>{r(null),u(!1),f("")},children:"-"}),y.length===0?a.jsx(L7,{children:"No se encontraron resultados"}):y.map((w,P)=>a.jsx(D$,{$isSelected:n(w)===t,$isHighlighted:P===m,onClick:()=>k(w),children:i(w)},n(w)))]})]})]})}function HP(){return zt({queryKey:["workOrderFilterOptions"],queryFn:()=>Rn.getFilterOptions(),staleTime:1e3*60*10})}function WP(e){return zt({queryKey:["workOrder",e],queryFn:()=>Rn.get(e),enabled:!!e})}function B7(e){return zt({queryKey:["managementHistory",e],queryFn:()=>Rn.getManagementHistory(e),enabled:!!e})}function U7(e){return zt({queryKey:["workflowOptions",e],queryFn:()=>Rn.getWorkflowOptions(e),enabled:!!e})}function V7(){const e=Mr();return Ct({mutationFn:({id:t,data:r})=>Rn.transition(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["managementHistory",r.id]}),e.invalidateQueries({queryKey:["workOrders"]}),e.invalidateQueries({queryKey:["workOrder",r.id]}),e.invalidateQueries({queryKey:["filesByArea",r.id]})}})}function H7(e=1,t=20){return zt({queryKey:["notifications",e,t],queryFn:()=>VP.list(e,t)})}function W7(){const e=Mr();return Ct({mutationFn:t=>VP.markAsRead(t),onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]}),e.invalidateQueries({queryKey:["notificationsCount"]})}})}function GP(){return zt({queryKey:["formOptionsComplete"],queryFn:()=>f7.getFormOptionsComplete(),staleTime:1e3*60*5})}const et={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,API:17,SuperAdministrador:18,VendedorExterno:19},lt=()=>{try{const e=localStorage.getItem("inveb_ot_user");if(e)return JSON.parse(e).role_id||et.Vendedor}catch{}return et.Vendedor},G7=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,q7=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,K7=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,P$=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Ea=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,yn=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,bn=p.div`
  padding: 1rem;
`,ei=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,X7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.75rem;
  width: 100%;
  max-width: 100%;
  overflow: hidden;

  & > div {
    min-width: 0;
    overflow: hidden;
  }

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Y7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: 1fr 1fr;
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,n_=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  overflow: hidden;
`,pe=p.div`
  display: flex;
  flex-direction: column;
`,oe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,we=p.input`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,We=p.select`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: ${e=>e.$hasError?"#fff5f5":"white"};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Q7=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }
`,$t=p.span`
  font-size: 0.7rem;
  color: #dc3545;
  margin-top: 0.25rem;
  display: block;
`,J7=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,Hn=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,Z7=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,eB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,M$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,O$={client_id:null,descripcion:"",tipo_solicitud:null,canal_id:null,org_venta_id:null,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",volumen_venta_anual:null,usd_monto:"",codigo_producto:"",oc:null,hierarchy_id:null,subhierarchy_id:null,subsubhierarchy_id:null,ant_des_correo_cliente:!1,ant_des_plano_actual:!1,ant_des_boceto_actual:!1,ant_des_spec:!1,ant_des_otro:!1,ant_des_cj_referencia_de:!1,ant_des_cj_referencia_dg:!1,ant_des_envase_primario:!1,ant_des_conservar_muestra:null,armado_automatico:null,analisis:!1,prueba_industrial:!1,muestra:!1,numero_muestras:null,reference_type:null,reference_id:null,bloqueo_referencia:null,indicador_facturacion:null,ant_des_vb_muestra:!1,ant_des_vb_boceto:!1,file_correo_cliente:null,file_plano_actual:null,file_boceto_actual:null,file_otro:null,file_oc:null,file_vb_muestra:null,file_vb_boceto:null,cascadeData:{productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null},cad_id:null,cad_text:"",matriz_id:null,tipo_matriz_text:"",items_set:null,veces_item:null,style_id:null,caracteristicas_adicionales:"",largura_hm:null,anchura_hm:null,area_producto_m2:null,recorte_adicional_m2:null,longitud_pegado_mm:null,golpes_largo:null,golpes_ancho:null,separacion_golpes_largo:null,separacion_golpes_ancho:null,cuchillas_ml:null,rayado_c1_r1:null,rayado_r1_r2:null,rayado_r2_c2:null,pallet_qa_id:null,pais_id:null,restriccion_pallet:null,tamano_pallet_type_id:null,altura_pallet:null,permite_sobresalir_carga:null,bulto_zunchado_pallet:null,formato_etiqueta_pallet:null,etiquetas_por_pallet:null,termocontraible:null,bct_min_lb:null,bct_min_kg:null,bct_humedo_lb:null,ect_min_lb_pulg:null,gramaje_g_m2:null,mullen_lb_pulg2:null,fct_lb_pulg2:null,dst_bpi:null,espesor_placa_mm:null,espesor_caja_mm:null,cobb_interior_g_m2:null,cobb_exterior_g_m2:null,flexion_aleta_n:null,peso_cliente_g:null,incision_rayado_longitudinal:"",incision_rayado_transversal:"",porosidad:"",brillo:"",rigidez_4_ptos_long:"",rigidez_4_ptos_transv:"",angulo_deslizamiento_exterior:"",angulo_deslizamiento_interior:"",resistencia_frote:"",contenido_reciclado:"",interno_largo:null,interno_ancho:null,interno_alto:null,externo_largo:null,externo_ancho:null,externo_alto:null,process_id:null,armado_id:null,sentido_armado:null,numero_colores:null,color_1_id:null,color_2_id:null,color_3_id:null,color_4_id:null,color_5_id:null,color_6_id:null,trazabilidad:null,design_type_id:null,complejidad:"",percentage_coverage_internal:null,percentage_coverage_external:null,impresion_1:null,impresion_2:null,impresion_3:null,impresion_4:null,impresion_5:null,impresion_6:null,cm2_clisse_color_1:null,cm2_clisse_color_2:null,cm2_clisse_color_3:null,cm2_clisse_color_4:null,cm2_clisse_color_5:null,cm2_clisse_color_6:null,cm2_clisse_color_7:null,barniz_uv:null,porcentaje_barniz_uv:null,indicador_facturacion_diseno_grafico:"",prueba_color:null,impresion_borde:"",impresion_sobre_rayado:"",total_cm2_clisse:null,pegado_terminacion:null,maquila:null,maquila_servicio_id:null,material_asignado:"",descripcion_material:"",product_type_developing_id:null,food_type_id:null,expected_use_id:null,recycled_use_id:null,class_substance_packed_id:null,transportation_way_id:null,peso_contenido_caja:null,autosoportante:null,envase_id:null,cantidad_cajas_apiladas:null,pallet_sobre_pallet:null,cantidad:null,target_market_id:null,observacion:"",planta_id:null,so_planta_original:null,so_planta_original_select_values:"",so_planta_alt1:null,so_planta_alt1_select_values:"",so_planta_alt2:null,so_planta_alt2_select_values:"",secuencia_operacional_matrix:Array(6).fill(null).map(()=>Array(6).fill(null)),distancia_cinta_1:null,distancia_cinta_2:null,distancia_cinta_3:null,distancia_cinta_4:null,distancia_cinta_5:null,distancia_cinta_6:null},R$=[{id:1,nombre:"Desarrollo Completo"},{id:3,nombre:"Muestra con CAD"},{id:7,nombre:"OT Proyectos Innovacin"},{id:5,nombre:"Arte con Material"},{id:6,nombre:"Otras Solicitudes Desarrollo"}],tB=(e,t)=>e===et.VendedorExterno?R$.filter(r=>r.id===1||r.id===5):R$,rB=p.button`
  padding: 0.5rem 1rem;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: background 0.2s;

  &:hover {
    background: #218838;
  }
`,nB=p.div`
  display: flex;
  gap: 1rem;
  align-items: flex-end;
`;function N$({onNavigate:e,initialData:t}){var ie,he,O,R,I,K,ne,ee,ge,L,se,ke,V,Ve,Ke,ye,T,_e,St,Hr,xn,Un,Mi,la,re,De,Wr,Oi,Gr,$a,nt,Jt,Vn,lr,os,uh,Tp,Ap,hh,fh,ph,Fp,Dp,Kl,Pp,Mp,Op;const[r,n]=S.useState(O$),[i,s]=S.useState(null),[o,l]=S.useState(null),[c,u]=S.useState({}),[h,f]=S.useState([]),[m,v]=S.useState([]),[g,x]=S.useState(!1),[_,b]=S.useState(!1),[y,j]=S.useState(!1),k=Mr(),{data:E,isLoading:A}=HP(),{data:w,isLoading:P}=GP(),M=S.useMemo(()=>!(w!=null&&w.subhierarchies)||!r.hierarchy_id?[]:w.subhierarchies.filter(C=>C.hierarchy_id===r.hierarchy_id),[w==null?void 0:w.subhierarchies,r.hierarchy_id]),F=S.useMemo(()=>!(w!=null&&w.subsubhierarchies)||!r.subhierarchy_id?[]:w.subsubhierarchies.filter(C=>C.subhierarchy_id===r.subhierarchy_id),[w==null?void 0:w.subsubhierarchies,r.subhierarchy_id]),D=S.useMemo(()=>{const C=lt();return tB(C)},[]);S.useEffect(()=>{r.hierarchy_id&&n(C=>({...C,subhierarchy_id:null,subsubhierarchy_id:null}))},[r.hierarchy_id]),S.useEffect(()=>{r.tipo_solicitud===3&&(j(!0),n(C=>({...C,muestra:!0})))},[r.tipo_solicitud]),S.useEffect(()=>{r.subhierarchy_id&&n(C=>({...C,subsubhierarchy_id:null}))},[r.subhierarchy_id]),S.useEffect(()=>{if(r.canal_id&&(E!=null&&E.canales)&&(w!=null&&w.hierarchies)){const C=E.canales.find($e=>$e.id===r.canal_id);if(C){const $e=w.hierarchies.find(xt=>{var qr,Ht;return((qr=xt.nombre)==null?void 0:qr.toUpperCase())===((Ht=C.nombre)==null?void 0:Ht.toUpperCase())});$e&&n(xt=>({...xt,hierarchy_id:Number($e.id),subhierarchy_id:null,subsubhierarchy_id:null}))}}},[r.canal_id,E==null?void 0:E.canales,w==null?void 0:w.hierarchies]),S.useEffect(()=>{console.log("[DEBUG] useEffect client_id ejecutado, client_id=",r.client_id),r.client_id?(x(!0),f([]),v([]),n(C=>({...C,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:""})),console.log("[DEBUG] Llamando cascadesApi.getInstalacionesCliente con client_id=",r.client_id),pu.getInstalacionesCliente(r.client_id).then(C=>{console.log("[DEBUG] Instalaciones recibidas:",C),f(C)}).catch(C=>console.error("[DEBUG] Error cargando instalaciones:",C)).finally(()=>x(!1))):(f([]),v([]))},[r.client_id]),S.useEffect(()=>{r.client_id&&(b(!0),v([]),pu.getContactosCliente(r.client_id,r.instalacion_cliente_id||void 0).then(C=>v(C)).catch(C=>console.error("Error cargando contactos:",C)).finally(()=>b(!1)))},[r.client_id,r.instalacion_cliente_id]),S.useEffect(()=>{r.instalacion_cliente_id?pu.getInformacionInstalacion(r.instalacion_cliente_id).then(C=>{n($e=>({...$e,bulto_zunchado_pallet:C.bulto_zunchado??null,formato_etiqueta_pallet:C.formato_etiqueta?Number(C.formato_etiqueta):$e.formato_etiqueta_pallet,etiquetas_por_pallet:C.etiquetas_pallet??$e.etiquetas_por_pallet}))}).catch(C=>console.error("Error cargando informacin de instalacin:",C)):n(C=>({...C,bulto_zunchado_pallet:null,formato_etiqueta_pallet:null,etiquetas_por_pallet:null}))},[r.instalacion_cliente_id]),S.useEffect(()=>{if(r.contactos_cliente_id){const C=m.find($e=>$e.id===r.contactos_cliente_id);C&&n($e=>({...$e,nombre_contacto:C.nombre||"",email_contacto:C.email||"",telefono_contacto:C.telefono||""}))}},[r.contactos_cliente_id,m]),S.useEffect(()=>{t&&n(C=>({...C,client_id:t.client_id||null,descripcion:t.descripcion||"",tipo_solicitud:t.tipo_solicitud||null,nombre_contacto:t.nombre_contacto||"",email_contacto:t.email_contacto||"",telefono_contacto:t.telefono_contacto||"",codigo_producto:t.material_codigo||"",interno_largo:t.largo_interno||null,interno_ancho:t.ancho_interno||null,interno_alto:t.alto_interno||null,externo_largo:t.largo_externo||null,externo_ancho:t.ancho_externo||null,externo_alto:t.alto_externo||null,cantidad:t.cantidad||null}))},[t]),S.useEffect(()=>{var C;(C=r.cascadeData)!=null&&C.plantaId&&n($e=>({...$e,so_planta_original:r.cascadeData.plantaId}))},[(ie=r.cascadeData)==null?void 0:ie.plantaId]);const W=async C=>{const $e=[];r.file_correo_cliente&&$e.push({file:r.file_correo_cliente,type:"correo_cliente"}),r.file_plano_actual&&$e.push({file:r.file_plano_actual,type:"plano"}),r.file_boceto_actual&&$e.push({file:r.file_boceto_actual,type:"boceto"}),r.file_otro&&$e.push({file:r.file_otro,type:"otro"}),r.file_oc&&$e.push({file:r.file_oc,type:"oc"}),r.file_vb_muestra&&$e.push({file:r.file_vb_muestra,type:"vb_muestra"}),r.file_vb_boceto&&$e.push({file:r.file_vb_boceto,type:"vb_boceto"});const xt=$e.map(({file:qr,type:Ht})=>p7.uploadOTFile(C,qr,Ht).catch(Xa=>(console.error(`Error subiendo archivo ${Ht}:`,Xa),null)));await Promise.all(xt)},B=Ct({mutationFn:C=>Rn.create(C),onSuccess:async C=>{const $e=[r.file_correo_cliente,r.file_plano_actual,r.file_boceto_actual,r.file_otro,r.file_oc,r.file_vb_muestra,r.file_vb_boceto].filter(Boolean);if($e.length>0){s(`Orden de trabajo #${C.id} creada. Subiendo archivos...`);try{await W(C.id),s(`Orden de trabajo #${C.id} creada exitosamente con ${$e.length} archivo(s)`)}catch(xt){console.error("Error subiendo archivos:",xt),s(`Orden de trabajo #${C.id} creada, pero algunos archivos no se pudieron subir`)}}else s(`Orden de trabajo #${C.id} creada exitosamente`);l(null),k.invalidateQueries({queryKey:["workOrders"]}),setTimeout(()=>{e("dashboard")},2e3)},onError:C=>{l(C.message||"Error al crear la orden de trabajo"),s(null)}}),G=S.useCallback(C=>{n($e=>({...$e,cascadeData:C}))},[]),Y=S.useCallback(async C=>{if(n($e=>({...$e,cad_id:C})),C)try{const $e=await UP.getCADDetails(C);n(xt=>({...xt,cad_text:$e.cad,interno_largo:$e.interno_largo||null,interno_ancho:$e.interno_ancho||null,interno_alto:$e.interno_alto||null,externo_largo:$e.externo_largo||null,externo_ancho:$e.externo_ancho||null,externo_alto:$e.externo_alto||null}))}catch($e){console.error("Error al cargar datos del CAD:",$e)}else n($e=>({...$e,cad_text:"",interno_largo:null,interno_ancho:null,interno_alto:null,externo_largo:null,externo_ancho:null,externo_alto:null}))},[]),ae=S.useCallback(()=>{var Z,ce,ve,le,ue,fe,je,Ae,Re,Se,Me,Je,Lt,Bt,Or,To,Ao,Fo,ls,Cd,Ja,CC;const C={},$e=lt(),xt=r.tipo_solicitud,qr=xt===1||xt===4||xt===7,Ht=xt!==3,Xa=xt===3,Ya=xt===5,Kr=$e===et.Vendedor,Qa=$e===et.VendedorExterno,N=$e===et.Ingeniero,Q=$e===et.JefeDesarrollo,H=$e===et.Diseador,X=$e===et.JefeVenta;if(r.client_id||(C.client_id="Campo obligatorio"),r.descripcion.trim()?r.descripcion.length>40&&(C.descripcion="Mximo 40 caracteres"):C.descripcion="Campo obligatorio",xt||(C.tipo_solicitud="Campo obligatorio"),r.canal_id||(C.canal_id="Campo obligatorio"),r.hierarchy_id&&!r.subhierarchy_id&&(C.subhierarchy_id="Campo obligatorio"),r.subhierarchy_id&&!r.subsubhierarchy_id&&(C.subsubhierarchy_id="Campo obligatorio"),(Z=r.nombre_contacto)!=null&&Z.trim()||(C.nombre_contacto="Campo obligatorio"),(ce=r.email_contacto)!=null&&ce.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email_contacto)||(C.email_contacto="Email invlido"):C.email_contacto="Campo obligatorio",(ve=r.telefono_contacto)!=null&&ve.trim()||(C.telefono_contacto="Campo obligatorio"),(le=r.observacion)!=null&&le.trim()?r.observacion.trim().length<10?C.observacion="Mnimo 10 caracteres":r.observacion.length>1e3&&(C.observacion="Mximo 1000 caracteres"):C.observacion="Campo obligatorio",(ue=r.cascadeData)!=null&&ue.impresion||(C.impresion="Campo obligatorio"),(fe=r.cascadeData)!=null&&fe.fsc||(C.fsc="Campo obligatorio"),r.sentido_armado||(C.sentido_armado="Campo obligatorio"),Ht&&xt&&(r.volumen_venta_anual||(C.volumen_venta_anual="Campo obligatorio"),(je=r.usd_monto)!=null&&je.trim()||(C.usd_monto="Campo obligatorio")),qr&&((Ae=r.cascadeData)!=null&&Ae.productTypeId||(C.product_type_id="Campo obligatorio"),r.peso_contenido_caja||(C.peso_contenido_caja="Campo obligatorio"),(r.autosoportante===null||r.autosoportante===void 0)&&(C.autosoportante="Campo obligatorio"),r.envase_id||(C.envase_id="Campo obligatorio"),r.cantidad_cajas_apiladas||(C.cantidad_cajas_apiladas="Campo obligatorio"),(r.pallet_sobre_pallet===null||r.pallet_sobre_pallet===void 0)&&(C.pallet_sobre_pallet="Campo obligatorio"),r.pallet_sobre_pallet===!0&&!r.cantidad&&(C.cantidad="Campo obligatorio")),(xt===1||xt===5||xt===7)&&((Re=r.cascadeData)!=null&&Re.cinta||(C.cinta="Campo obligatorio")),!((Se=r.cascadeData)!=null&&Se.cartonId)&&!((Me=r.cascadeData)!=null&&Me.cartonColor)&&qr&&(C.carton_color="Campo obligatorio"),Ya&&(r.reference_type||(C.reference_type="Campo obligatorio"),r.reference_type&&r.reference_type!==2&&(r.reference_id||(C.reference_id="Campo obligatorio"),r.bloqueo_referencia||(C.bloqueo_referencia="Campo obligatorio"))),(Kr||Qa||X)&&(Kr&&!r.org_venta_id&&(C.org_venta_id="Campo obligatorio"),(Kr||X||Qa||H)&&(qr||Ya)&&(r.restriccion_pallet===null||r.restriccion_pallet===void 0)&&(C.restriccion_pallet="Campo obligatorio"),Kr&&r.termocontraible===null&&(C.termocontraible="Campo obligatorio"),Kr&&r.armado_automatico===null&&(C.armado_automatico="Campo obligatorio"),(Kr||Qa)&&Ht&&((Je=r.cascadeData)!=null&&Je.coverageInternalId||(C.coverage_internal_id="Campo obligatorio"),(Lt=r.cascadeData)!=null&&Lt.coverageExternalId||(C.coverage_external_id="Campo obligatorio"),(Bt=r.cascadeData)!=null&&Bt.coverageInternalId&&r.cascadeData.coverageInternalId!==1&&(r.percentage_coverage_internal||(C.percentage_coverage_internal="Campo obligatorio")),(Or=r.cascadeData)!=null&&Or.coverageExternalId&&r.cascadeData.coverageExternalId!==1&&(r.percentage_coverage_external||(C.percentage_coverage_external="Campo obligatorio"))),(Kr||Qa||N)&&!((To=r.cascadeData)!=null&&To.plantaId)&&(C.planta_id="Campo obligatorio"),(Kr||X||Q||N)&&!r.impresion_borde&&(C.impresion_borde="Campo obligatorio"),(Kr||X||Q||N)&&!r.impresion_sobre_rayado&&(C.impresion_sobre_rayado="Campo obligatorio"),(Kr||Q||N||H)&&!r.pegado_terminacion&&(C.pegado_terminacion="Campo obligatorio")),(N||Q)&&((Ao=r.cascadeData)!=null&&Ao.plantaId||(C.planta_id="Campo obligatorio"),r.maquila||(C.maquila="Campo obligatorio"),r.impresion_borde||(C.impresion_borde="Campo obligatorio"),r.impresion_sobre_rayado||(C.impresion_sobre_rayado="Campo obligatorio"),(Fo=r.caracteristicas_adicionales)!=null&&Fo.trim()||(C.caracteristicas_adicionales="Campo obligatorio")),Q&&!r.armado_id&&(C.armado_id="Campo obligatorio"),(Xa||Ya)&&(Kr||Qa)&&((ls=r.cascadeData)!=null&&ls.cartonId||(C.carton_id="Campo obligatorio")),String((Cd=r.cascadeData)==null?void 0:Cd.fsc)==="1"&&(r.pais_id||(C.pais_id="Campo obligatorio")),r.restriccion_pallet===1&&(r.tamano_pallet_type_id||(C.tamano_pallet_type_id="Campo obligatorio"),r.altura_pallet||(C.altura_pallet="Campo obligatorio"),r.permite_sobresalir_carga===null&&(C.permite_sobresalir_carga="Campo obligatorio"),r.pallet_qa_id||(C.pallet_qa_id="Campo obligatorio"),r.instalacion_cliente_id&&(r.bulto_zunchado_pallet===null&&(C.bulto_zunchado_pallet="Campo obligatorio"),r.formato_etiqueta_pallet||(C.formato_etiqueta_pallet="Campo obligatorio"),r.etiquetas_por_pallet||(C.etiquetas_por_pallet="Campo obligatorio"))),Ht&&xt){const Rp=Number((Ja=r.cascadeData)==null?void 0:Ja.impresion);Rp!==5&&Rp!==6&&Rp!==7&&!r.numero_colores&&r.numero_colores!==0&&(C.numero_colores="Campo obligatorio")}return(qr||Ya)&&Number((CC=r.cascadeData)==null?void 0:CC.impresion)===2&&!r.design_type_id&&(C.design_type_id="Campo obligatorio"),$e===et.SuperAdministrador||(r.product_type_developing_id||(C.product_type_developing_id="Campo obligatorio"),r.target_market_id||(C.target_market_id="Campo obligatorio")),r.ant_des_vb_muestra&&!r.file_vb_muestra&&(C.file_vb_muestra="Debe adjuntar archivo para VB Muestra"),r.ant_des_vb_boceto&&!r.file_vb_boceto&&(C.file_vb_boceto="Debe adjuntar archivo para VB Boceto"),C},[r]),U=S.useCallback((C,$e)=>{n(xt=>({...xt,[C]:$e})),u(xt=>{if(xt[C]){const{[C]:qr,...Ht}=xt;return Ht}return xt})},[]),q=S.useCallback(C=>{var qr,Ht,Xa,Ya,Kr,Qa,N,Q;C.preventDefault();const $e=ae();if(u($e),Object.keys($e).length>0){const H=Object.keys($e).length;l(`Por favor complete los ${H} campo(s) obligatorio(s) marcados en rojo`);const X=document.querySelector('[data-has-error="true"]');X&&X.scrollIntoView({behavior:"smooth",block:"center"});return}l(null);const xt={client_id:r.client_id,descripcion:r.descripcion,tipo_solicitud:r.tipo_solicitud,canal_id:r.canal_id,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,oc:r.oc!==null?r.oc:void 0,subsubhierarchy_id:r.subsubhierarchy_id,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:((qr=r.cascadeData)==null?void 0:qr.productTypeId)||void 0,impresion:(Ht=r.cascadeData)!=null&&Ht.impresion?Number(r.cascadeData.impresion):void 0,fsc:((Xa=r.cascadeData)==null?void 0:Xa.fsc)||void 0,cinta:(Ya=r.cascadeData)!=null&&Ya.cinta?Number(r.cascadeData.cinta):void 0,coverage_internal_id:((Kr=r.cascadeData)==null?void 0:Kr.coverageInternalId)||void 0,coverage_external_id:((Qa=r.cascadeData)==null?void 0:Qa.coverageExternalId)||void 0,carton_color:(N=r.cascadeData)!=null&&N.cartonColor?Number(r.cascadeData.cartonColor):void 0,carton_id:((Q=r.cascadeData)==null?void 0:Q.cartonId)||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.planta_id||void 0};B.mutate(xt)},[r,B]),z=S.useCallback(()=>{n(O$),u({}),s(null),l(null)},[]);return a.jsxs(G7,{children:[a.jsxs(q7,{children:[a.jsx(K7,{children:"Crear Nueva Orden de Trabajo"}),a.jsx(P$,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]}),i&&a.jsx(M$,{$type:"success",children:i}),o&&a.jsx(M$,{$type:"error",children:o}),a.jsxs("form",{onSubmit:q,children:[a.jsxs(Ea,{children:[a.jsx(yn,{children:"1.- Seleccione el Tipo de Solicitud"}),a.jsx(bn,{children:a.jsxs(nB,{children:[a.jsxs(pe,{style:{minWidth:"300px"},children:[a.jsx(oe,{children:"Tipo de solicitud:"}),a.jsxs(We,{id:"tipo_solicitud_select",value:r.tipo_solicitud||"",onChange:C=>U("tipo_solicitud",C.target.value?Number(C.target.value):null),disabled:!!r.tipo_solicitud,children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),D.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsx(rB,{type:"button",onClick:z,children:"Reiniciar Solicitud"})]})})]}),r.tipo_solicitud&&a.jsxs(a.Fragment,{children:[a.jsxs(Ea,{children:[a.jsx(yn,{children:"2.- Datos comerciales"}),a.jsxs(bn,{children:[a.jsxs(ei,{$columns:3,children:[a.jsxs(pe,{"data-has-error":!!c.client_id,children:[a.jsx(oe,{style:{color:c.client_id?"#dc3545":void 0},children:"Cliente *"}),a.jsx(Ow,{options:(E==null?void 0:E.clientes)||[],value:r.client_id,onChange:C=>U("client_id",C?Number(C):null),getOptionValue:C=>C.id,getOptionLabel:C=>`${C.nombre}${C.codigo?` - ${C.codigo}`:""}`,placeholder:"Seleccione cliente...",disabled:A,loading:A}),c.client_id&&a.jsx($t,{children:c.client_id})]}),a.jsxs(pe,{"data-has-error":!!c.descripcion,children:[a.jsx(oe,{style:{color:c.descripcion?"#dc3545":void 0},children:"Descripcion del Producto *"}),a.jsx(we,{$hasError:!!c.descripcion,type:"text",maxLength:40,value:r.descripcion,onChange:C=>U("descripcion",C.target.value),placeholder:"Max 40 caracteres"}),c.descripcion&&a.jsx($t,{children:c.descripcion})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Codigo Producto"}),a.jsx(we,{type:"text",value:r.codigo_producto,onChange:C=>U("codigo_producto",C.target.value)})]})]}),a.jsxs(ei,{$columns:4,style:{marginTop:"1rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Tipo Solicitud *"}),a.jsxs(We,{value:r.tipo_solicitud||"",disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),D.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{"data-has-error":!!c.volumen_venta_anual,children:[a.jsxs(oe,{style:{color:c.volumen_venta_anual?"#dc3545":void 0},children:["Vol Vta Anual ",r.tipo_solicitud!==3?"*":""]}),a.jsx(we,{$hasError:!!c.volumen_venta_anual,type:"number",value:r.volumen_venta_anual||"",onChange:C=>U("volumen_venta_anual",C.target.value?Number(C.target.value):null)}),c.volumen_venta_anual&&a.jsx($t,{children:c.volumen_venta_anual})]}),a.jsxs(pe,{"data-has-error":!!c.usd_monto,children:[a.jsxs(oe,{style:{color:c.usd_monto?"#dc3545":void 0},children:["USD ",r.tipo_solicitud!==3?"*":""]}),a.jsx(we,{$hasError:!!c.usd_monto,type:"text",value:r.usd_monto,onChange:C=>U("usd_monto",C.target.value),placeholder:"Monto USD"})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Jerarquia 1"}),a.jsxs(We,{value:r.hierarchy_id||"",onChange:C=>U("hierarchy_id",C.target.value?Number(C.target.value):null),disabled:!0,style:{backgroundColor:"#f5f5f5"},title:"Se sincroniza automticamente con el Canal seleccionado",children:[a.jsx("option",{value:"",children:r.canal_id?"Sincronizado con Canal":"Seleccione Canal primero"}),w==null?void 0:w.hierarchies.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]})]}),a.jsxs(ei,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Instalacion Cliente"}),a.jsxs(We,{value:r.instalacion_cliente_id||"",onChange:C=>U("instalacion_cliente_id",C.target.value?Number(C.target.value):null),disabled:!r.client_id||g,children:[a.jsx("option",{value:"",children:g?"Cargando...":"Seleccione..."}),h.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{"data-has-error":!!c.org_venta_id,children:[a.jsx(oe,{style:{color:c.org_venta_id?"#dc3545":void 0},children:"Org Venta"}),a.jsxs(We,{$hasError:!!c.org_venta_id,value:r.org_venta_id||"",onChange:C=>U("org_venta_id",C.target.value?Number(C.target.value):null),disabled:A,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(he=E==null?void 0:E.org_ventas)==null?void 0:he.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.org_venta_id&&a.jsx($t,{children:c.org_venta_id})]}),a.jsxs(pe,{"data-has-error":!!c.subhierarchy_id,children:[a.jsx(oe,{style:{color:c.subhierarchy_id?"#dc3545":void 0},children:"Jerarquia 2 *"}),a.jsxs(We,{$hasError:!!c.subhierarchy_id,value:r.subhierarchy_id||"",onChange:C=>U("subhierarchy_id",C.target.value?Number(C.target.value):null),disabled:!r.hierarchy_id||P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),M.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.subhierarchy_id&&a.jsx($t,{children:c.subhierarchy_id})]})]}),a.jsxs(ei,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Contactos Cliente"}),a.jsxs(We,{value:r.contactos_cliente_id||"",onChange:C=>U("contactos_cliente_id",C.target.value?Number(C.target.value):null),disabled:!r.client_id||_,children:[a.jsx("option",{value:"",children:_?"Cargando...":"Seleccionar Opcion"}),m.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{"data-has-error":!!c.canal_id,children:[a.jsx(oe,{style:{color:c.canal_id?"#dc3545":void 0},children:"Canal *"}),a.jsxs(We,{$hasError:!!c.canal_id,value:r.canal_id||"",onChange:C=>U("canal_id",C.target.value?Number(C.target.value):null),disabled:A,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),E==null?void 0:E.canales.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.canal_id&&a.jsx($t,{children:c.canal_id})]}),a.jsxs(pe,{"data-has-error":!!c.subsubhierarchy_id,children:[a.jsx(oe,{style:{color:c.subsubhierarchy_id?"#dc3545":void 0},children:"Jerarquia 3 *"}),a.jsxs(We,{$hasError:!!c.subsubhierarchy_id,value:r.subsubhierarchy_id||"",onChange:C=>U("subsubhierarchy_id",C.target.value?Number(C.target.value):null),disabled:!r.subhierarchy_id||P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),F.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.subsubhierarchy_id&&a.jsx($t,{children:c.subsubhierarchy_id})]})]}),a.jsxs(ei,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(pe,{"data-has-error":!!c.nombre_contacto,children:[a.jsx(oe,{style:{color:c.nombre_contacto?"#dc3545":void 0},children:"Nombre Contacto *"}),a.jsx(we,{$hasError:!!c.nombre_contacto,type:"text",value:r.nombre_contacto,onChange:C=>U("nombre_contacto",C.target.value)}),c.nombre_contacto&&a.jsx($t,{children:c.nombre_contacto})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"OC"}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[a.jsxs(We,{style:{flex:1},value:r.oc===null?"":r.oc,onChange:C=>U("oc",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),r.oc===1&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_oc",style:{cursor:"pointer",color:"#28a745"},title:"Adjuntar archivo OC",children:a.jsx("span",{style:{fontSize:"1.2rem"},children:""})}),a.jsx("input",{type:"file",id:"file_oc",style:{display:"none"},onChange:C=>{var $e;return U("file_oc",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_oc&&a.jsx("span",{style:{fontSize:"0.75rem",color:"#28a745",maxWidth:"100px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.file_oc.name})]})]})]}),a.jsx(pe,{})]}),a.jsxs(ei,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(pe,{"data-has-error":!!c.email_contacto,children:[a.jsx(oe,{style:{color:c.email_contacto?"#dc3545":void 0},children:"Email Contacto *"}),a.jsx(we,{$hasError:!!c.email_contacto,type:"email",value:r.email_contacto,onChange:C=>U("email_contacto",C.target.value)}),c.email_contacto&&a.jsx($t,{children:c.email_contacto})]}),a.jsx(pe,{}),a.jsx(pe,{})]}),a.jsxs(ei,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(pe,{"data-has-error":!!c.telefono_contacto,children:[a.jsx(oe,{style:{color:c.telefono_contacto?"#dc3545":void 0},children:"Telefono Contacto *"}),a.jsx(we,{$hasError:!!c.telefono_contacto,type:"tel",value:r.telefono_contacto,onChange:C=>U("telefono_contacto",C.target.value)}),c.telefono_contacto&&a.jsx($t,{children:c.telefono_contacto})]}),a.jsx(pe,{}),a.jsx(pe,{})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5fr 2fr 5fr",gap:"1rem",marginBottom:"1rem"},children:[a.jsxs(Ea,{style:{marginBottom:0},children:[a.jsx(yn,{children:"3.- Antecedentes Desarrollo"}),a.jsxs(bn,{children:[a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(oe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{minWidth:"120px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:C=>U("ant_des_correo_cliente",C.target.checked)}),"Correo Cliente"]}),r.ant_des_correo_cliente&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_correo",style:{cursor:"pointer",color:"#28a745"},title:"Adjuntar archivo",children:a.jsx("i",{className:"fa fa-paperclip",style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_correo",style:{display:"none"},onChange:C=>{var $e;return U("file_correo_cliente",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_correo_cliente&&a.jsx("span",{style:{fontSize:"0.75rem",color:"#666"},children:r.file_correo_cliente.name})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{minWidth:"120px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:C=>U("ant_des_plano_actual",C.target.checked)}),"Plano Actual"]}),r.ant_des_plano_actual&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_plano",style:{cursor:"pointer",color:"#28a745"},title:"Adjuntar archivo",children:a.jsx("i",{className:"fa fa-paperclip",style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_plano",style:{display:"none"},onChange:C=>{var $e;return U("file_plano_actual",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_plano_actual&&a.jsx("span",{style:{fontSize:"0.75rem",color:"#666"},children:r.file_plano_actual.name})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{minWidth:"120px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:C=>U("ant_des_boceto_actual",C.target.checked)}),"Boceto Actual"]}),r.ant_des_boceto_actual&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_boceto",style:{cursor:"pointer",color:"#28a745"},title:"Adjuntar archivo",children:a.jsx("i",{className:"fa fa-paperclip",style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_boceto",style:{display:"none"},onChange:C=>{var $e;return U("file_boceto_actual",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_boceto_actual&&a.jsx("span",{style:{fontSize:"0.75rem",color:"#666"},children:r.file_boceto_actual.name})]})]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:C=>U("ant_des_spec",C.target.checked)}),"Spec"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{minWidth:"120px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:C=>U("ant_des_otro",C.target.checked)}),"Otro"]}),r.ant_des_otro&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_otro",style:{cursor:"pointer",color:"#28a745"},title:"Adjuntar archivo",children:a.jsx("i",{className:"fa fa-paperclip",style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_otro",style:{display:"none"},onChange:C=>{var $e;return U("file_otro",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_otro&&a.jsx("span",{style:{fontSize:"0.75rem",color:"#666"},children:r.file_otro.name})]})]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(oe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(J7,{children:[a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:C=>U("ant_des_cj_referencia_de",C.target.checked)}),"CJ Referencia DE"]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:C=>U("ant_des_cj_referencia_dg",C.target.checked)}),"CJ Referencia DG"]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:C=>U("ant_des_envase_primario",C.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[a.jsxs(pe,{style:{flex:1},children:[a.jsx(oe,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(Hn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>U("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>U("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(pe,{style:{flex:1},"data-has-error":!!c.armado_automatico,children:[a.jsx(oe,{style:{color:c.armado_automatico?"#dc3545":void 0},children:"Armado Automatico"}),a.jsxs(We,{$hasError:!!c.armado_automatico,value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:C=>U("armado_automatico",C.target.value===""?null:C.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.armado_automatico&&a.jsx($t,{children:c.armado_automatico})]})]})]})]}),a.jsxs(Ea,{style:{marginBottom:0},children:[a.jsx(yn,{children:"4.- Solicita"}),a.jsxs(bn,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:C=>U("analisis",C.target.checked)}),"Analisis"]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:C=>U("prueba_industrial",C.target.checked)}),"Prueba Industrial"]}),a.jsxs(Hn,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:C=>{C.target.checked&&j(!0)},disabled:r.muestra,style:r.muestra?{cursor:"not-allowed"}:void 0,title:r.muestra?"No se puede deseleccionar una vez marcado":void 0}),"Muestra"]})]}),r.muestra&&a.jsxs(pe,{style:{marginTop:"1rem"},children:[a.jsx(oe,{children:"N Muestras"}),a.jsx(we,{type:"number",min:"1",value:r.numero_muestras||"",onChange:C=>U("numero_muestras",C.target.value?Number(C.target.value):null),style:{width:"100px"},disabled:!0,readOnly:!0})]})]})]}),a.jsxs(Ea,{style:{marginBottom:0},children:[a.jsx(yn,{children:"5.- Referencia Material"}),a.jsxs(bn,{children:[a.jsxs(ei,{$columns:2,children:[a.jsxs(pe,{"data-has-error":!!c.reference_type,children:[a.jsx(oe,{style:{color:c.reference_type?"#dc3545":void 0},children:"Tipo Referencia"}),a.jsxs(We,{$hasError:!!c.reference_type,value:r.reference_type===null?"":r.reference_type,onChange:C=>U("reference_type",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(O=w==null?void 0:w.reference_types)==null?void 0:O.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]}),c.reference_type&&a.jsx($t,{children:c.reference_type})]}),a.jsxs(pe,{"data-has-error":!!c.reference_id,children:[a.jsx(oe,{style:{color:c.reference_id?"#dc3545":void 0},children:"Referencia"}),a.jsx(Ow,{options:(w==null?void 0:w.materials)||[],value:r.reference_id,onChange:C=>U("reference_id",C),getOptionValue:C=>C.id,getOptionLabel:C=>`${C.codigo||C.nombre}${C.descripcion?` - ${C.descripcion}`:""}`,placeholder:"Buscar referencia...",disabled:!r.reference_type,loading:P}),c.reference_id&&a.jsx($t,{children:c.reference_id})]}),a.jsxs(pe,{"data-has-error":!!c.bloqueo_referencia,children:[a.jsx(oe,{style:{color:c.bloqueo_referencia?"#dc3545":void 0},children:"Bloqueo Referencia"}),a.jsxs(We,{$hasError:!!c.bloqueo_referencia,value:r.bloqueo_referencia===null?"":r.bloqueo_referencia,onChange:C=>U("bloqueo_referencia",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(R=w==null?void 0:w.bloqueo_referencia)==null?void 0:R.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]}),c.bloqueo_referencia&&a.jsx($t,{children:c.bloqueo_referencia})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Indicador Facturacion D.E."}),a.jsxs(We,{value:r.indicador_facturacion||"",onChange:C=>U("indicador_facturacion",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(I=w==null?void 0:w.indicador_facturacion)==null?void 0:I.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]})]})]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f8f9fa",borderRadius:"4px"},children:[a.jsx(oe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Archivo Visto Bueno"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{color:"#28a745",fontWeight:"bold",minWidth:"100px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_muestra,onChange:C=>U("ant_des_vb_muestra",C.target.checked)}),"VB Muestra"]}),r.ant_des_vb_muestra&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_vb_muestra",style:{cursor:"pointer",color:r.file_vb_muestra?"#28a745":"#dc3545"},title:"Adjuntar archivo (obligatorio)",children:a.jsx("span",{style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_vb_muestra",style:{display:"none"},onChange:C=>{var $e;return U("file_vb_muestra",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_vb_muestra?a.jsx("span",{style:{fontSize:"0.75rem",color:"#28a745"},children:r.file_vb_muestra.name}):a.jsx("span",{style:{fontSize:"0.75rem",color:"#dc3545"},children:"* Obligatorio"})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsxs(Hn,{style:{color:"#28a745",fontWeight:"bold",minWidth:"100px"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_boceto,onChange:C=>U("ant_des_vb_boceto",C.target.checked)}),"VB Boceto"]}),r.ant_des_vb_boceto&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[a.jsx("label",{htmlFor:"file_vb_boceto",style:{cursor:"pointer",color:r.file_vb_boceto?"#28a745":"#dc3545"},title:"Adjuntar archivo (obligatorio)",children:a.jsx("span",{style:{fontSize:"1rem"},children:""})}),a.jsx("input",{type:"file",id:"file_vb_boceto",style:{display:"none"},onChange:C=>{var $e;return U("file_vb_boceto",(($e=C.target.files)==null?void 0:$e[0])||null)}}),r.file_vb_boceto?a.jsx("span",{style:{fontSize:"0.75rem",color:"#28a745"},children:r.file_vb_boceto.name}):a.jsx("span",{style:{fontSize:"0.75rem",color:"#dc3545"},children:"* Obligatorio"})]})]})]})]})]})]})]}),a.jsxs(Ea,{children:[a.jsx(yn,{children:"6.- Asistente Para: Ingresos Principales"}),a.jsx(bn,{children:a.jsx(bk,{values:r.cascadeData,onChange:G,fieldErrors:c})})]}),a.jsxs(Ea,{children:[a.jsx(yn,{children:"7.- Caracteristicas"}),a.jsx(bn,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem"},children:[a.jsxs("div",{children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"CAD"}),a.jsxs(We,{value:r.cad_id||"",onChange:C=>Y(C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(K=w==null?void 0:w.cads)==null?void 0:K.map(C=>a.jsx("option",{value:C.id,children:C.codigo||C.nombre},String(C.id)))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Matriz"}),a.jsxs(We,{value:r.matriz_id||"",onChange:C=>U("matriz_id",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ne=w==null?void 0:w.matrices)==null?void 0:ne.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Tipo Matriz"}),a.jsx(we,{type:"text",value:r.tipo_matriz_text,onChange:C=>U("tipo_matriz_text",C.target.value),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Tipo Item"}),a.jsx(we,{type:"text",value:r.cascadeData.productTypeId&&((ge=(ee=w==null?void 0:w.product_types)==null?void 0:ee.find(C=>C.id===r.cascadeData.productTypeId))==null?void 0:ge.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Items del Set"}),a.jsx(we,{type:"number",min:"0",value:r.items_set||"",onChange:C=>U("items_set",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Veces Item"}),a.jsx(we,{type:"number",min:"0",value:r.veces_item||"",onChange:C=>U("veces_item",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color Carton"}),a.jsx(we,{type:"text",value:String(r.cascadeData.cartonColor)==="1"?"Caf":String(r.cascadeData.cartonColor)==="2"?"Blanco":r.cascadeData.cartonColor||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Carton"}),a.jsx(we,{type:"text",value:r.cascadeData.cartonId&&((se=(L=w==null?void 0:w.cartons)==null?void 0:L.find(C=>C.id===r.cascadeData.cartonId))==null?void 0:se.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Cinta"}),a.jsx(we,{type:"text",value:r.cascadeData.cinta!==null&&r.cascadeData.cinta!==void 0?Number(r.cascadeData.cinta)===1?"Si":"No":"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"FSC"}),a.jsx(we,{type:"text",value:r.cascadeData.fsc?((V=(ke=w==null?void 0:w.fsc)==null?void 0:ke.find(C=>C.id===Number(r.cascadeData.fsc)))==null?void 0:V.nombre)||String(r.cascadeData.fsc):"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{"data-has-error":!!c.pallet_qa_id,children:[a.jsx(oe,{style:{color:c.pallet_qa_id?"#dc3545":void 0},children:"Certificado Calidad"}),a.jsxs(We,{$hasError:!!c.pallet_qa_id,value:r.pallet_qa_id||"",onChange:C=>U("pallet_qa_id",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ve=w==null?void 0:w.pallet_qas)==null?void 0:Ve.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.pallet_qa_id&&a.jsx($t,{children:c.pallet_qa_id})]}),a.jsxs(pe,{"data-has-error":!!c.pais_id,children:[a.jsx(oe,{style:{color:c.pais_id?"#dc3545":void 0},children:"Pais/Mercado Destino"}),a.jsxs(We,{$hasError:!!c.pais_id,value:r.pais_id||"",onChange:C=>U("pais_id",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ke=w==null?void 0:w.pais_referencia)==null?void 0:Ke.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]}),c.pais_id&&a.jsx($t,{children:c.pais_id})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Planta Objetivo"}),a.jsx(we,{type:"text",value:r.cascadeData.plantaId&&((T=(ye=w==null?void 0:w.plantas)==null?void 0:ye.find(C=>C.id===r.cascadeData.plantaId))==null?void 0:T.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{"data-has-error":!!c.restriccion_pallet,children:[a.jsx(oe,{style:{color:c.restriccion_pallet?"#dc3545":void 0},children:"Restriccion Paletizado"}),a.jsxs(We,{$hasError:!!c.restriccion_pallet,value:r.restriccion_pallet===null?"":r.restriccion_pallet,onChange:C=>U("restriccion_pallet",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.restriccion_pallet&&a.jsx($t,{children:c.restriccion_pallet})]}),a.jsxs(pe,{"data-has-error":!!c.tamano_pallet_type_id,children:[a.jsx(oe,{style:{color:c.tamano_pallet_type_id?"#dc3545":void 0},children:"Tamano Pallet"}),a.jsxs(We,{$hasError:!!c.tamano_pallet_type_id,value:r.tamano_pallet_type_id||"",onChange:C=>U("tamano_pallet_type_id",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(_e=w==null?void 0:w.pallet_types)==null?void 0:_e.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]}),c.tamano_pallet_type_id&&a.jsx($t,{children:c.tamano_pallet_type_id})]}),a.jsxs(pe,{"data-has-error":!!c.altura_pallet,children:[a.jsx(oe,{style:{color:c.altura_pallet?"#dc3545":void 0},children:"Altura Pallet"}),a.jsx(we,{$hasError:!!c.altura_pallet,type:"number",min:"0",value:r.altura_pallet||"",onChange:C=>U("altura_pallet",C.target.value?Number(C.target.value):null)}),c.altura_pallet&&a.jsx($t,{children:c.altura_pallet})]}),a.jsxs(pe,{"data-has-error":!!c.permite_sobresalir_carga,children:[a.jsx(oe,{style:{color:c.permite_sobresalir_carga?"#dc3545":void 0},children:"Permite Sobresalir Carga"}),a.jsxs(We,{$hasError:!!c.permite_sobresalir_carga,value:r.permite_sobresalir_carga===null?"":r.permite_sobresalir_carga,onChange:C=>U("permite_sobresalir_carga",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.permite_sobresalir_carga&&a.jsx($t,{children:c.permite_sobresalir_carga})]})]}),a.jsxs("div",{children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Estilo"}),a.jsxs(We,{value:r.style_id||"",onChange:C=>U("style_id",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(St=w==null?void 0:w.styles)==null?void 0:St.map(C=>a.jsx("option",{value:C.id,children:C.nombre},String(C.id)))]})]}),a.jsxs(pe,{"data-has-error":!!c.caracteristicas_adicionales,children:[a.jsx(oe,{style:{color:c.caracteristicas_adicionales?"#dc3545":void 0},children:"Caracteristica Estilo"}),a.jsx(we,{$hasError:!!c.caracteristicas_adicionales,type:"text",value:r.caracteristicas_adicionales,onChange:C=>U("caracteristicas_adicionales",C.target.value),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0}),c.caracteristicas_adicionales&&a.jsx($t,{children:c.caracteristicas_adicionales})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Largura HM"}),a.jsx(we,{type:"number",value:r.largura_hm||"",onChange:C=>U("largura_hm",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Anchura HM"}),a.jsx(we,{type:"number",value:r.anchura_hm||"",onChange:C=>U("anchura_hm",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Area Producto (M2)"}),a.jsx(we,{type:"number",value:r.area_producto_m2||"",onChange:C=>U("area_producto_m2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Recorte Adicional / Area Agujero (M2)"}),a.jsx(we,{type:"number",value:r.recorte_adicional_m2||"",onChange:C=>U("recorte_adicional_m2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Longitud Pegado (MM)"}),a.jsx(we,{type:"number",value:r.longitud_pegado_mm||"",onChange:C=>U("longitud_pegado_mm",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Golpes al Largo"}),a.jsx(we,{type:"number",value:r.golpes_largo||"",onChange:C=>U("golpes_largo",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Golpes al Ancho"}),a.jsx(we,{type:"number",value:r.golpes_ancho||"",onChange:C=>U("golpes_ancho",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Separacion Golpes Largo (MM)"}),a.jsx(we,{type:"number",value:r.separacion_golpes_largo||"",onChange:C=>U("separacion_golpes_largo",C.target.value?Number(C.target.value):null),placeholder:"0"})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Separacion Golpes Ancho (MM)"}),a.jsx(we,{type:"number",value:r.separacion_golpes_ancho||"",onChange:C=>U("separacion_golpes_ancho",C.target.value?Number(C.target.value):null),placeholder:"0"})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Cuchillas (ML)"}),a.jsx(we,{type:"number",value:r.cuchillas_ml||"",onChange:C=>U("cuchillas_ml",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Rayado C1/R1 (MM)"}),a.jsx(we,{type:"number",value:r.rayado_c1_r1||"",onChange:C=>U("rayado_c1_r1",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Rayado R1/R2 (MM)"}),a.jsx(we,{type:"number",value:r.rayado_r1_r2||"",onChange:C=>U("rayado_r1_r2",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Rayado R2/C2 (MM)"}),a.jsx(we,{type:"number",value:r.rayado_r2_c2||"",onChange:C=>U("rayado_r2_c2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{"data-has-error":!!c.bulto_zunchado_pallet,children:[a.jsx(oe,{style:{color:c.bulto_zunchado_pallet?"#dc3545":void 0},children:"Bulto Zunchado al Pallet"}),a.jsxs(We,{$hasError:!!c.bulto_zunchado_pallet,value:r.bulto_zunchado_pallet===null?"":r.bulto_zunchado_pallet,onChange:C=>U("bulto_zunchado_pallet",C.target.value===""?null:Number(C.target.value)),disabled:!r.instalacion_cliente_id,style:r.instalacion_cliente_id?void 0:{backgroundColor:"#f5f5f5"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.bulto_zunchado_pallet&&a.jsx($t,{children:c.bulto_zunchado_pallet})]}),a.jsxs(pe,{"data-has-error":!!c.formato_etiqueta_pallet,children:[a.jsx(oe,{style:{color:c.formato_etiqueta_pallet?"#dc3545":void 0},children:"Formato Etiqueta Pallet"}),a.jsxs(We,{$hasError:!!c.formato_etiqueta_pallet,value:r.formato_etiqueta_pallet||"",onChange:C=>U("formato_etiqueta_pallet",C.target.value?Number(C.target.value):null),disabled:!r.instalacion_cliente_id,style:r.instalacion_cliente_id?void 0:{backgroundColor:"#f5f5f5"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Hr=w==null?void 0:w.pallet_tag_formats)==null?void 0:Hr.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.formato_etiqueta_pallet&&a.jsx($t,{children:c.formato_etiqueta_pallet})]}),a.jsxs(pe,{"data-has-error":!!c.etiquetas_por_pallet,children:[a.jsx(oe,{style:{color:c.etiquetas_por_pallet?"#dc3545":void 0},children:"N Etiquetas por Pallet"}),a.jsx(we,{$hasError:!!c.etiquetas_por_pallet,type:"number",value:r.etiquetas_por_pallet||"",onChange:C=>U("etiquetas_por_pallet",C.target.value?Number(C.target.value):null),disabled:!r.instalacion_cliente_id,style:r.instalacion_cliente_id?void 0:{backgroundColor:"#f5f5f5"}}),c.etiquetas_por_pallet&&a.jsx($t,{children:c.etiquetas_por_pallet})]}),a.jsxs(pe,{"data-has-error":!!c.termocontraible,children:[a.jsx(oe,{style:{color:c.termocontraible?"#dc3545":void 0},children:"Termocontraible"}),a.jsxs(We,{$hasError:!!c.termocontraible,value:r.termocontraible===null?"":r.termocontraible,onChange:C=>U("termocontraible",C.target.value===""?null:Number(C.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"BCT MIN (LB)"}),a.jsx(we,{type:"number",value:r.bct_min_lb||"",onChange:C=>U("bct_min_lb",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"BCT MIN (KG)"}),a.jsx(we,{type:"number",value:r.bct_min_kg||"",onChange:C=>U("bct_min_kg",C.target.value?Number(C.target.value):null),disabled:lt()===et.Vendedor||lt()===et.VendedorExterno,style:lt()===et.Vendedor||lt()===et.VendedorExterno?{backgroundColor:"#f5f5f5"}:void 0})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"BCT HUMEDO (LB)"}),a.jsx(we,{type:"number",value:r.bct_humedo_lb||"",onChange:C=>U("bct_humedo_lb",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"ECT MIN (LB/PULG)"}),a.jsx(we,{type:"number",step:"0.01",value:r.ect_min_lb_pulg||"",onChange:C=>U("ect_min_lb_pulg",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"GRAMAJE (G/M2)"}),a.jsx(we,{type:"number",value:r.gramaje_g_m2||"",onChange:C=>U("gramaje_g_m2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"MULLEN (LB/PULG2)"}),a.jsx(we,{type:"number",value:r.mullen_lb_pulg2||"",onChange:C=>U("mullen_lb_pulg2",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"FCT (LB/PULG2)"}),a.jsx(we,{type:"number",step:"0.01",value:r.fct_lb_pulg2||"",onChange:C=>U("fct_lb_pulg2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"DST (BPI)"}),a.jsx(we,{type:"number",value:r.dst_bpi||"",onChange:C=>U("dst_bpi",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"ESPESOR PLACA (MM)"}),a.jsx(we,{type:"number",value:r.espesor_placa_mm||"",onChange:C=>U("espesor_placa_mm",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"ESPESOR CAJA (MM)"}),a.jsx(we,{type:"number",value:r.espesor_caja_mm||"",onChange:C=>U("espesor_caja_mm",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"COBB INTERIOR (G/M2)"}),a.jsx(we,{type:"number",value:r.cobb_interior_g_m2||"",onChange:C=>U("cobb_interior_g_m2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"COBB EXTERIOR (G/M2)"}),a.jsx(we,{type:"number",value:r.cobb_exterior_g_m2||"",onChange:C=>U("cobb_exterior_g_m2",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"FLEXION DE ALETA (N)"}),a.jsx(we,{type:"number",value:r.flexion_aleta_n||"",onChange:C=>U("flexion_aleta_n",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"PESO CLIENTE (G)"}),a.jsx(we,{type:"number",value:r.peso_cliente_g||"",onChange:C=>U("peso_cliente_g",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Incision Rayado Longitudinal (N)"}),a.jsx(we,{type:"text",value:r.incision_rayado_longitudinal,onChange:C=>U("incision_rayado_longitudinal",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Incision Rayado Transversal (N)"}),a.jsx(we,{type:"text",value:r.incision_rayado_transversal,onChange:C=>U("incision_rayado_transversal",C.target.value)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Porosidad (SEG)"}),a.jsx(we,{type:"text",value:r.porosidad,onChange:C=>U("porosidad",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Brillo (%)"}),a.jsx(we,{type:"text",value:r.brillo,onChange:C=>U("brillo",C.target.value)})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Rigidez 4 Puntos Longitudinal (N/mm)"}),a.jsx(we,{type:"text",value:r.rigidez_4_ptos_long,onChange:C=>U("rigidez_4_ptos_long",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Rigidez 4 Puntos Transversal (N/mm)"}),a.jsx(we,{type:"text",value:r.rigidez_4_ptos_transv,onChange:C=>U("rigidez_4_ptos_transv",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Angulo Deslizamiento-Tapa Exterior"}),a.jsx(we,{type:"text",value:r.angulo_deslizamiento_exterior,onChange:C=>U("angulo_deslizamiento_exterior",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Angulo Deslizamiento-Tapa Interior"}),a.jsx(we,{type:"text",value:r.angulo_deslizamiento_interior,onChange:C=>U("angulo_deslizamiento_interior",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Resistencia al Frote"}),a.jsx(we,{type:"text",value:r.resistencia_frote,onChange:C=>U("resistencia_frote",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Contenido Reciclado (%)"}),a.jsx(we,{type:"text",value:r.contenido_reciclado,onChange:C=>U("contenido_reciclado",C.target.value)})]})]})]})})]}),Number(r.cascadeData.cinta)===1&&a.jsxs(Ea,{children:[a.jsx(yn,{children:"Distancia Cinta"}),a.jsx(bn,{children:a.jsxs(ei,{children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 1 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_1||"",onChange:C=>U("distancia_cinta_1",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 2 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_2||"",onChange:C=>U("distancia_cinta_2",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 3 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_3||"",onChange:C=>U("distancia_cinta_3",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 4 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_4||"",onChange:C=>U("distancia_cinta_4",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 5 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_5||"",onChange:C=>U("distancia_cinta_5",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Distancia Corte 1 a Cinta 6 (mm)"}),a.jsx(we,{type:"number",min:"0",value:r.distancia_cinta_6||"",onChange:C=>U("distancia_cinta_6",C.target.value?Number(C.target.value):null)})]})]})})]}),a.jsxs(Ea,{children:[a.jsx(yn,{children:"8.- Color-Cera-Barniz"}),a.jsx(bn,{children:a.jsxs(X7,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Impresin"}),a.jsx(we,{type:"text",value:r.cascadeData.impresion?((Un=(xn=w==null?void 0:w.impresiones)==null?void 0:xn.find(C=>String(C.id)===String(r.cascadeData.impresion)))==null?void 0:Un.nombre)||r.cascadeData.impresion:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Trazabilidad"}),a.jsxs(We,{value:r.trazabilidad||"",onChange:C=>U("trazabilidad",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Mi=w==null?void 0:w.trazabilidad)==null?void 0:Mi.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{"data-has-error":!!c.design_type_id,children:[a.jsx(oe,{style:{color:c.design_type_id?"#dc3545":void 0},children:"Tipo Diseo"}),a.jsxs(We,{$hasError:!!c.design_type_id,value:r.design_type_id||"",onChange:C=>U("design_type_id",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(la=w==null?void 0:w.design_types)==null?void 0:la.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.design_type_id&&a.jsx($t,{children:c.design_type_id})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Complejidad"}),a.jsx(we,{type:"text",value:r.complejidad,onChange:C=>U("complejidad",C.target.value)})]}),a.jsxs(pe,{"data-has-error":!!c.numero_colores,children:[a.jsx(oe,{style:{color:c.numero_colores?"#dc3545":void 0},children:"Nmero Colores"}),a.jsxs(We,{$hasError:!!c.numero_colores,value:r.numero_colores!==null?r.numero_colores:"",onChange:C=>U("numero_colores",C.target.value!==""?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5,6,7].map(C=>a.jsx("option",{value:C,children:C},C))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Recubrimiento Interno"}),a.jsx(we,{type:"text",value:r.cascadeData.coverageInternalId&&((De=(re=w==null?void 0:w.coverages_internal)==null?void 0:re.find(C=>C.id===r.cascadeData.coverageInternalId))==null?void 0:De.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{"data-has-error":!!c.percentage_coverage_internal,children:[a.jsx(oe,{style:{color:c.percentage_coverage_internal?"#dc3545":void 0},children:"% Recubrimiento Interno"}),a.jsx(we,{$hasError:!!c.percentage_coverage_internal,type:"number",min:"0",value:r.percentage_coverage_internal||"",onChange:C=>U("percentage_coverage_internal",C.target.value?Number(C.target.value):null)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Recubrimiento Externo"}),a.jsx(we,{type:"text",value:r.cascadeData.coverageExternalId&&((Oi=(Wr=w==null?void 0:w.coverages_external)==null?void 0:Wr.find(C=>C.id===r.cascadeData.coverageExternalId))==null?void 0:Oi.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(pe,{"data-has-error":!!c.percentage_coverage_external,children:[a.jsx(oe,{style:{color:c.percentage_coverage_external?"#dc3545":void 0},children:"% Recubrimiento Externo"}),a.jsx(we,{$hasError:!!c.percentage_coverage_external,type:"number",min:"0",value:r.percentage_coverage_external||"",onChange:C=>U("percentage_coverage_external",C.target.value?Number(C.target.value):null)})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 1 (Interior TyR)"}),a.jsxs(We,{value:r.color_1_id||"",onChange:C=>U("color_1_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Gr=w==null?void 0:w.colors)==null?void 0:Gr.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 1"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_1||"",onChange:C=>U("impresion_1",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 1"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_1||"",onChange:C=>U("cm2_clisse_color_1",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 2"}),a.jsxs(We,{value:r.color_2_id||"",onChange:C=>U("color_2_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),($a=w==null?void 0:w.colors)==null?void 0:$a.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 2"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_2||"",onChange:C=>U("impresion_2",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 2"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_2||"",onChange:C=>U("cm2_clisse_color_2",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 3"}),a.jsxs(We,{value:r.color_3_id||"",onChange:C=>U("color_3_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(nt=w==null?void 0:w.colors)==null?void 0:nt.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 3"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_3||"",onChange:C=>U("impresion_3",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 3"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_3||"",onChange:C=>U("cm2_clisse_color_3",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 4"}),a.jsxs(We,{value:r.color_4_id||"",onChange:C=>U("color_4_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Jt=w==null?void 0:w.colors)==null?void 0:Jt.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 4"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_4||"",onChange:C=>U("impresion_4",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 4"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_4||"",onChange:C=>U("cm2_clisse_color_4",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 5"}),a.jsxs(We,{value:r.color_5_id||"",onChange:C=>U("color_5_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Vn=w==null?void 0:w.colors)==null?void 0:Vn.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 5"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_5||"",onChange:C=>U("impresion_5",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 5"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_5||"",onChange:C=>U("cm2_clisse_color_5",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 6"}),a.jsxs(We,{value:r.color_6_id||"",onChange:C=>U("color_6_id",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(lr=w==null?void 0:w.colors)==null?void 0:lr.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 6"}),a.jsx(we,{type:"number",min:"0",value:r.impresion_6||"",onChange:C=>U("impresion_6",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 6"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_6||"",onChange:C=>U("cm2_clisse_color_6",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Color 7 (Barniz UV)"}),a.jsxs(We,{value:r.barniz_uv||"",onChange:C=>U("barniz_uv",C.target.value?Number(C.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(os=w==null?void 0:w.colors)==null?void 0:os.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"% Impresin 7 UV"}),a.jsx(we,{type:"number",min:"0",value:r.porcentaje_barniz_uv||"",onChange:C=>U("porcentaje_barniz_uv",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Clisse cm2 7"}),a.jsx(we,{type:"number",min:"0",value:r.cm2_clisse_color_7||"",onChange:C=>U("cm2_clisse_color_7",C.target.value?Number(C.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Indicador Facturacin D.G."}),a.jsx(we,{type:"text",value:r.indicador_facturacion_diseno_grafico,onChange:C=>U("indicador_facturacion_diseno_grafico",C.target.value)})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Prueba de Color"}),a.jsxs(We,{value:r.prueba_color!==null?r.prueba_color:"",onChange:C=>U("prueba_color",C.target.value!==""?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]})]}),a.jsxs(pe,{"data-has-error":!!c.impresion_borde,children:[a.jsx(oe,{style:{color:c.impresion_borde?"#dc3545":void 0},children:"Impresin de Borde"}),a.jsxs(We,{$hasError:!!c.impresion_borde,value:r.impresion_borde,onChange:C=>U("impresion_borde",C.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(pe,{"data-has-error":!!c.impresion_sobre_rayado,children:[a.jsx(oe,{style:{color:c.impresion_sobre_rayado?"#dc3545":void 0},children:"Impresin Sobre Rayado"}),a.jsxs(We,{$hasError:!!c.impresion_sobre_rayado,value:r.impresion_sobre_rayado,onChange:C=>U("impresion_sobre_rayado",C.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Total Clisse cm2"}),a.jsx(we,{type:"number",min:"0",value:(r.cm2_clisse_color_1||0)+(r.cm2_clisse_color_2||0)+(r.cm2_clisse_color_3||0)+(r.cm2_clisse_color_4||0)+(r.cm2_clisse_color_5||0)+(r.cm2_clisse_color_6||0)+(r.cm2_clisse_color_7||0),readOnly:!0,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"},title:"Calculado automticamente como suma de Clisse cm2 1-7"})]})]})]})})]}),a.jsxs(Y7,{children:[a.jsxs(n_,{children:[a.jsxs(yn,{children:["9.- Medidas Interiores ",r.cad_id?"(desde CAD)":""]}),a.jsx(bn,{children:a.jsxs(ei,{$columns:1,children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Largo (mm)"}),a.jsx(we,{type:"number",value:r.interno_largo||"",onChange:C=>U("interno_largo",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Ancho (mm)"}),a.jsx(we,{type:"number",value:r.interno_ancho||"",onChange:C=>U("interno_ancho",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Alto (mm)"}),a.jsx(we,{type:"number",value:r.interno_alto||"",onChange:C=>U("interno_alto",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]})]})})]}),a.jsxs(n_,{children:[a.jsxs(yn,{children:["10.- Medidas Exteriores ",r.cad_id?"(desde CAD)":""]}),a.jsx(bn,{children:a.jsxs(ei,{$columns:1,children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Largo (mm)"}),a.jsx(we,{type:"number",value:r.externo_largo||"",onChange:C=>U("externo_largo",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Ancho (mm)"}),a.jsx(we,{type:"number",value:r.externo_ancho||"",onChange:C=>U("externo_ancho",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Alto (mm)"}),a.jsx(we,{type:"number",value:r.externo_alto||"",onChange:C=>U("externo_alto",C.target.value?Number(C.target.value):null),readOnly:!!r.cad_id,style:r.cad_id?{backgroundColor:"#e9ecef",cursor:"not-allowed"}:void 0,title:r.cad_id?"Cargado desde CAD":void 0})]})]})})]}),a.jsxs(n_,{children:[a.jsx(yn,{children:"11.- Terminaciones"}),a.jsx(bn,{children:a.jsxs(ei,{$columns:1,children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"Proceso"}),a.jsxs(We,{value:r.process_id||"",onChange:C=>U("process_id",C.target.value?Number(C.target.value):null),disabled:A,children:[a.jsx("option",{value:"",children:"Seleccione..."}),E==null?void 0:E.procesos.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs(pe,{"data-has-error":!!c.pegado_terminacion,children:[a.jsx(oe,{style:{color:c.pegado_terminacion?"#dc3545":void 0},children:"Tipo Pegado"}),a.jsxs(We,{$hasError:!!c.pegado_terminacion,value:r.pegado_terminacion||"",onChange:C=>U("pegado_terminacion",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(uh=w==null?void 0:w.pegados)==null?void 0:uh.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.pegado_terminacion&&a.jsx($t,{children:c.pegado_terminacion})]}),a.jsxs(pe,{"data-has-error":!!c.armado_id,children:[a.jsx(oe,{style:{color:c.armado_id?"#dc3545":void 0},children:"Armado"}),a.jsxs(We,{$hasError:!!c.armado_id,value:r.armado_id||"",onChange:C=>U("armado_id",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Tp=w==null?void 0:w.armados)==null?void 0:Tp.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.armado_id&&a.jsx($t,{children:c.armado_id})]}),a.jsxs(pe,{"data-has-error":!!c.sentido_armado,children:[a.jsx(oe,{style:{color:c.sentido_armado?"#dc3545":void 0},children:"Sentido de Armado *"}),a.jsxs(We,{$hasError:!!c.sentido_armado,value:r.sentido_armado||"",onChange:C=>U("sentido_armado",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Ap=w==null?void 0:w.sentidos_armado)==null?void 0:Ap.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),c.sentido_armado&&a.jsx($t,{children:c.sentido_armado})]}),a.jsxs(pe,{"data-has-error":!!c.maquila,children:[a.jsx(oe,{style:{color:c.maquila?"#dc3545":void 0},children:"Maquila"}),a.jsxs(We,{$hasError:!!c.maquila,value:r.maquila||"",onChange:C=>U("maquila",C.target.value?Number(C.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]}),c.maquila&&a.jsx($t,{children:c.maquila})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"Servicios Maquila"}),a.jsxs(We,{value:r.maquila_servicio_id||"",onChange:C=>U("maquila_servicio_id",C.target.value?Number(C.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(hh=w==null?void 0:w.maquila_servicios)==null?void 0:hh.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]})]})})]})]}),a.jsxs(Ea,{children:[a.jsx(yn,{children:"12.- Secuencia Operacional"}),a.jsxs(bn,{children:[a.jsxs("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[a.jsx(oe,{style:{fontWeight:"600",minWidth:"60px"},children:"PLANTA:"}),a.jsxs(We,{value:r.so_planta_original||"",onChange:C=>U("so_planta_original",C.target.value?Number(C.target.value):null),style:{width:"200px"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),E==null?void 0:E.plantas.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ORIGINAL"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 1"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 2"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 3"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 4"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 5"})]})}),a.jsx("tbody",{children:[0,1,2,3,4,5].map(C=>a.jsx("tr",{children:[0,1,2,3,4,5].map($e=>{var xt,qr;return a.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #e5e7eb"},children:a.jsxs(We,{value:((xt=r.secuencia_operacional_matrix[C])==null?void 0:xt[$e])||"",onChange:Ht=>{const Xa=r.secuencia_operacional_matrix.map((Ya,Kr)=>Kr===C?Ya.map((Qa,N)=>N===$e?Ht.target.value||null:Qa):[...Ya]);U("secuencia_operacional_matrix",Xa)},style:{width:"100%",fontSize:"0.8rem",padding:"0.25rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(qr=w==null?void 0:w.secuencia_operacional)==null?void 0:qr.filter(Ht=>!r.so_planta_original||Ht.planta_id===r.so_planta_original).map(Ht=>a.jsx("option",{value:Ht.id,children:Ht.descripcion||Ht.nombre},Ht.id))]})},$e)})},C))})]})})]})]}),a.jsxs(Ea,{children:[a.jsx(yn,{children:"13.- Material Asignado"}),a.jsx(bn,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",maxWidth:"100%"},children:[a.jsxs(pe,{children:[a.jsx(oe,{children:"MATERIAL ASIGNADO"}),a.jsx(we,{type:"text",value:r.material_asignado,onChange:C=>U("material_asignado",C.target.value),placeholder:"Cdigo de material...",disabled:lt()!==et.SuperAdministrador,style:lt()!==et.SuperAdministrador?{backgroundColor:"#f5f5f5"}:void 0})]}),a.jsxs(pe,{children:[a.jsx(oe,{children:"DESCRIPCIN"}),a.jsx(we,{type:"text",value:r.descripcion_material,onChange:C=>U("descripcion_material",C.target.value),placeholder:"Descripcin del material...",disabled:lt()!==et.SuperAdministrador,style:lt()!==et.SuperAdministrador?{backgroundColor:"#f5f5f5"}:void 0})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"65% 35%",gap:"0.5rem",maxWidth:"100%",overflow:"hidden"},children:[a.jsxs(Ea,{style:{margin:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[a.jsx(yn,{children:"13.- Datos para desarrollo"}),a.jsx(bn,{style:{overflow:"hidden",padding:"0.5rem"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.7rem",maxWidth:"100%"},children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.product_type_developing_id?"#dc3545":void 0},children:"TIPO PRODUCTO:"}),a.jsxs(We,{$hasError:!!c.product_type_developing_id,value:r.product_type_developing_id||"",onChange:C=>U("product_type_developing_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(fh=w==null?void 0:w.product_type_developing)==null?void 0:fh.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.peso_contenido_caja?"#dc3545":void 0},children:"PESO CAJA (KG):"}),a.jsx(we,{$hasError:!!c.peso_contenido_caja,type:"number",value:r.peso_contenido_caja||"",onChange:C=>U("peso_contenido_caja",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.food_type_id?"#dc3545":void 0},children:"TIPO ALIMENTO:"}),a.jsxs(We,{$hasError:!!c.food_type_id,value:r.food_type_id||"",onChange:C=>U("food_type_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null?"#f5f5f5":void 0},disabled:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ph=w==null?void 0:w.food_types)==null?void 0:ph.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.autosoportante?"#dc3545":void 0},children:"AUTOSOPORTANTE:"}),a.jsxs(We,{$hasError:!!c.autosoportante,value:r.autosoportante===null?"":r.autosoportante?"1":"0",onChange:C=>U("autosoportante",C.target.value===""?null:C.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.expected_use_id?"#dc3545":void 0},children:"USO PREVISTO:"}),a.jsxs(We,{$hasError:!!c.expected_use_id,value:r.expected_use_id||"",onChange:C=>U("expected_use_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null?"#f5f5f5":void 0},disabled:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Fp=w==null?void 0:w.expected_uses)==null?void 0:Fp.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.envase_id?"#dc3545":void 0},children:"ENVASE PRIMARIO:"}),a.jsxs(We,{$hasError:!!c.envase_id,value:r.envase_id||"",onChange:C=>U("envase_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Dp=w==null?void 0:w.envases)==null?void 0:Dp.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.recycled_use_id?"#dc3545":void 0},children:"USO RECICLADO:"}),a.jsxs(We,{$hasError:!!c.recycled_use_id,value:r.recycled_use_id||"",onChange:C=>U("recycled_use_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null?"#f5f5f5":void 0},disabled:r.product_type_developing_id===1||r.product_type_developing_id!==3&&r.product_type_developing_id!==null,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Kl=w==null?void 0:w.recycled_uses)==null?void 0:Kl.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad_cajas_apiladas?"#dc3545":void 0},children:"CAJAS APILADAS:"}),a.jsx(we,{$hasError:!!c.cantidad_cajas_apiladas,type:"number",value:r.cantidad_cajas_apiladas||"",onChange:C=>U("cantidad_cajas_apiladas",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.class_substance_packed_id?"#dc3545":void 0},children:"CLASE SUSTANCIA:"}),a.jsxs(We,{$hasError:!!c.class_substance_packed_id,value:r.class_substance_packed_id||"",onChange:C=>U("class_substance_packed_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.product_type_developing_id===3||r.product_type_developing_id!==1&&r.product_type_developing_id!==null?"#f5f5f5":void 0},disabled:r.product_type_developing_id===3||r.product_type_developing_id!==1&&r.product_type_developing_id!==null,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Pp=w==null?void 0:w.class_substance_packeds)==null?void 0:Pp.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.pallet_sobre_pallet?"#dc3545":void 0},children:"PALLET S/ PALLET:"}),a.jsxs(We,{$hasError:!!c.pallet_sobre_pallet,value:r.pallet_sobre_pallet===null?"":r.pallet_sobre_pallet?"1":"0",onChange:C=>U("pallet_sobre_pallet",C.target.value===""?null:C.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.transportation_way_id?"#dc3545":void 0},children:"MEDIO TRANSPORTE:"}),a.jsxs(We,{$hasError:!!c.transportation_way_id,value:r.transportation_way_id||"",onChange:C=>U("transportation_way_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.product_type_developing_id===3||r.product_type_developing_id!==1&&r.product_type_developing_id!==null?"#f5f5f5":void 0},disabled:r.product_type_developing_id===3||r.product_type_developing_id!==1&&r.product_type_developing_id!==null,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Mp=w==null?void 0:w.transportation_ways)==null?void 0:Mp.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad?"#dc3545":void 0},children:"CANTIDAD:"}),a.jsx(we,{$hasError:!!c.cantidad,type:"number",value:r.cantidad||"",onChange:C=>U("cantidad",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem",backgroundColor:r.pallet_sobre_pallet!==!0?"#f5f5f5":void 0},disabled:r.pallet_sobre_pallet!==!0})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(oe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.target_market_id?"#dc3545":void 0},children:"MERCADO DESTINO:"}),a.jsxs(We,{$hasError:!!c.target_market_id,value:r.target_market_id||"",onChange:C=>U("target_market_id",C.target.value?Number(C.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Op=w==null?void 0:w.target_markets)==null?void 0:Op.map(C=>a.jsx("option",{value:C.id,children:C.nombre},C.id))]}),a.jsx("div",{}),a.jsx("div",{})]})]})})]}),a.jsxs(Ea,{style:{margin:0,minWidth:0,overflow:"hidden"},"data-has-error":!!c.observacion,children:[a.jsx(yn,{style:{background:c.observacion?"linear-gradient(135deg, #dc3545 0%, #c82333 100%)":void 0},children:"14.- Observacin del trabajo a realizar *"}),a.jsxs(bn,{style:{padding:"0.5rem",overflow:"hidden"},children:[a.jsx(Q7,{$hasError:!!c.observacion,value:r.observacion,onChange:C=>U("observacion",C.target.value),placeholder:"Observaciones adicionales (mnimo 10 caracteres)...",style:{width:"100%",height:"200px",resize:"none",fontSize:"0.75rem",boxSizing:"border-box"}}),c.observacion&&a.jsx($t,{children:c.observacion})]})]})]}),a.jsxs(eB,{children:[a.jsx(P$,{type:"button",onClick:z,children:"Limpiar Formulario"}),a.jsx(Z7,{type:"submit",disabled:B.isPending,children:B.isPending?"Creando...":"Crear Orden de Trabajo"})]})]})]}),a.jsx(D7,{isOpen:y,onClose:()=>{j(!1),r.numero_muestras||U("muestra",!1)},onSave:(C,$e)=>{U("muestra",!0),U("numero_muestras",$e),j(!1)},cadId:r.cascadeData.cartonId,cartonId:r.cascadeData.cartonId,tipoSolicitud:r.tipo_solicitud,cads:(w==null?void 0:w.cads)||[],cartones:(w==null?void 0:w.cartons)||[],cartonesMuestra:(w==null?void 0:w.cartons)||[],comunas:(w==null?void 0:w.comunas)||[],roleId:lt()})]})}const a_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,z$=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,I$=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,i_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Is=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,ti=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,ri=p.div`
  padding: 1rem;
`,Po=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,aB=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.75rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,iB=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: 1fr 1fr;
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,s_=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  overflow: hidden;
`,Ne=p.div`
  display: flex;
  flex-direction: column;
`,Fe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,Ze=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Ft=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,sB=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,o_=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,Ta=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,oB=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,lB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,l_=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}

  ${e=>e.$type==="info"&&`
    background: #cce5ff;
    color: #004085;
    border: 1px solid #b8daff;
  `}
`,cB=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,dB=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,uB=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,hB=[{id:1,nombre:"Desarrollo Completo"},{id:3,nombre:"Muestra con CAD"},{id:5,nombre:"Arte con Material"},{id:6,nombre:"Otras Solicitudes Desarrollo"},{id:7,nombre:"OT Proyectos Innovacin"}];function fB({otId:e,onNavigate:t}){var A,w,P,M,F,D,W,B,G,Y,ae,U,q,z,ie,he,O,R,I,K,ne,ee,ge,L,se,ke,V,Ve,Ke,ye;const[r,n]=S.useState(null),[i,s]=S.useState(null),[o,l]=S.useState(null),c=Mr(),{data:u,isLoading:h,error:f}=WP(e),{data:m,isLoading:v}=HP(),{data:g,isLoading:x}=GP(),_=S.useMemo(()=>!(g!=null&&g.subhierarchies)||!(r!=null&&r.hierarchy_id)?[]:g.subhierarchies.filter(T=>T.hierarchy_id===r.hierarchy_id),[g==null?void 0:g.subhierarchies,r==null?void 0:r.hierarchy_id]),b=S.useMemo(()=>!(g!=null&&g.subsubhierarchies)||!(r!=null&&r.subhierarchy_id)?[]:g.subsubhierarchies.filter(T=>T.subhierarchy_id===r.subhierarchy_id),[g==null?void 0:g.subsubhierarchies,r==null?void 0:r.subhierarchy_id]);S.useEffect(()=>{if(u){const T=u;n({client_id:T.client_id,descripcion:T.descripcion||"",tipo_solicitud:T.tipo_solicitud,canal_id:T.canal_id,org_venta_id:T.org_venta_id,nombre_contacto:T.nombre_contacto||"",email_contacto:T.email_contacto||"",telefono_contacto:T.telefono_contacto||"",volumen_venta_anual:T.volumen_venta_anual,codigo_producto:T.codigo_producto||"",hierarchy_id:T.hierarchy_id,subhierarchy_id:T.subhierarchy_id,subsubhierarchy_id:T.subsubhierarchy_id,ant_des_correo_cliente:T.ant_des_correo_cliente===1,ant_des_plano_actual:T.ant_des_plano_actual===1,ant_des_boceto_actual:T.ant_des_boceto_actual===1,ant_des_spec:T.ant_des_spec===1,ant_des_otro:T.ant_des_otro===1,ant_des_cj_referencia_de:T.ant_des_cj_referencia_de===1,ant_des_cj_referencia_dg:T.ant_des_cj_referencia_dg===1,ant_des_envase_primario:T.ant_des_envase_primario===1,ant_des_conservar_muestra:T.ant_des_conservar_muestra===null?null:T.ant_des_conservar_muestra===1,armado_automatico:T.armado_automatico===null?null:T.armado_automatico===1,analisis:T.analisis===1,prueba_industrial:T.prueba_industrial===1,muestra:T.muestra===1,numero_muestras:T.numero_muestras,cascadeData:{productTypeId:T.product_type_id,impresion:T.impresion!=null?String(T.impresion):null,fsc:T.fsc,cinta:T.cinta!=null?String(T.cinta):null,coverageInternalId:T.coverage_internal_id,coverageExternalId:T.coverage_external_id,plantaId:T.planta_id,cartonColor:T.carton_color!=null?String(T.carton_color):null,cartonId:T.carton_id},cad_id:T.cad_id,style_id:T.style_id,items_set:T.items_set,veces_item:T.veces_item,largura_hm:T.largura_hm,anchura_hm:T.anchura_hm,area_producto:T.area_producto,recorte_adicional:T.recorte_adicional,longitud_pegado:T.longitud_pegado,golpes_largo:T.golpes_largo,golpes_ancho:T.golpes_ancho,separacion_golpes_largo:T.separacion_golpes_largo,separacion_golpes_ancho:T.separacion_golpes_ancho,rayado_c1r1:T.rayado_c1r1,rayado_r1_r2:T.rayado_r1_r2,rayado_r2_c2:T.rayado_r2_c2,pallet_qa_id:T.pallet_qa_id,pais_id:T.pais_id,restriccion_pallet:T.restriccion_pallet,tamano_pallet_type_id:T.tamano_pallet_type_id,altura_pallet:T.altura_pallet,permite_sobresalir_carga:T.permite_sobresalir_carga,bct_min_lb:T.bct_min_lb,bct_min_kg:T.bct_min_kg,bct_humedo_lb:T.bct_humedo_lb,ect:T.ect,gramaje:T.gramaje,mullen:T.mullen,fct:T.fct,espesor:T.espesor,cobb_interior:T.cobb_interior,cobb_exterior:T.cobb_exterior,flexion_aleta:T.flexion_aleta,peso:T.peso,trazabilidad:T.trazabilidad,design_type_id:T.design_type_id,complejidad:T.complejidad||"",numero_colores:T.numero_colores,color_1_id:T.color_1_id,color_2_id:T.color_2_id,color_3_id:T.color_3_id,color_4_id:T.color_4_id,color_5_id:T.color_5_id,color_6_id:T.color_6_id,impresion_1:T.impresion_1,impresion_2:T.impresion_2,impresion_3:T.impresion_3,impresion_4:T.impresion_4,impresion_5:T.impresion_5,impresion_6:T.impresion_6,barniz_uv:T.barniz_uv,porcentanje_barniz_uv:T.porcentanje_barniz_uv,cera_exterior:T.cera_exterior,porcentaje_cera_exterior:T.porcentaje_cera_exterior,cera_interior:T.cera_interior,porcentaje_cera_interior:T.porcentaje_cera_interior,barniz_interior:T.barniz_interior,porcentaje_barniz_interior:T.porcentaje_barniz_interior,percentage_coverage_internal:T.percentage_coverage_internal,percentage_coverage_external:T.percentage_coverage_external,interno_largo:T.interno_largo,interno_ancho:T.interno_ancho,interno_alto:T.interno_alto,externo_largo:T.externo_largo,externo_ancho:T.externo_ancho,externo_alto:T.externo_alto,process_id:T.process_id,armado_id:T.armado_id,sentido_armado:T.sentido_armado,pegado_terminacion:T.pegado_terminacion,maquila:T.maquila,maquila_servicio_id:T.maquila_servicio_id,product_type_developing_id:T.product_type_developing_id,food_type_id:T.food_type_id,expected_use_id:T.expected_use_id,recycled_use_id:T.recycled_use_id,class_substance_packed_id:T.class_substance_packed_id,transportation_way_id:T.transportation_way_id,peso_contenido_caja:T.peso_contenido_caja,envase_id:T.envase_id,autosoportante:T.autosoportante===1,cajas_altura:T.cajas_altura,pallet_sobre_pallet:T.pallet_sobre_pallet===null?null:T.pallet_sobre_pallet===1,cantidad:T.cantidad,target_market_id:T.target_market_id,material_asignado:T.material_asignado||"",descripcion_material:T.descripcion_material||"",observacion:T.observacion||"",planta_id:T.planta_id})}},[u]);const y=Ct({mutationFn:T=>Rn.update(e,T),onSuccess:T=>{s(T.message),l(null),c.invalidateQueries({queryKey:["workOrders"]}),c.invalidateQueries({queryKey:["workOrder",e]})},onError:T=>{l(T.message||"Error al actualizar la orden de trabajo"),s(null)}}),j=S.useCallback((T,_e)=>{n(St=>St?{...St,[T]:_e}:null)},[]),k=S.useCallback(T=>{n(_e=>_e?{..._e,cascadeData:T}:null)},[]),E=S.useCallback(T=>{if(T.preventDefault(),!r)return;const _e={client_id:r.client_id||void 0,descripcion:r.descripcion||void 0,tipo_solicitud:r.tipo_solicitud||void 0,canal_id:r.canal_id||void 0,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,subsubhierarchy_id:r.subsubhierarchy_id||void 0,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:r.cascadeData.productTypeId||void 0,impresion:r.cascadeData.impresion?Number(r.cascadeData.impresion):void 0,fsc:r.cascadeData.fsc||void 0,cinta:r.cascadeData.cinta?Number(r.cascadeData.cinta):void 0,coverage_internal_id:r.cascadeData.coverageInternalId||void 0,coverage_external_id:r.cascadeData.coverageExternalId||void 0,carton_color:r.cascadeData.cartonColor?Number(r.cascadeData.cartonColor):void 0,carton_id:r.cascadeData.cartonId||void 0,cad_id:r.cad_id||void 0,style_id:r.style_id||void 0,items_set:r.items_set||void 0,veces_item:r.veces_item||void 0,largura_hm:r.largura_hm||void 0,anchura_hm:r.anchura_hm||void 0,area_producto:r.area_producto||void 0,recorte_adicional:r.recorte_adicional||void 0,longitud_pegado:r.longitud_pegado||void 0,golpes_largo:r.golpes_largo||void 0,golpes_ancho:r.golpes_ancho||void 0,pais_id:r.pais_id||void 0,design_type_id:r.design_type_id||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,barniz_uv:r.barniz_uv||void 0,porcentanje_barniz_uv:r.porcentanje_barniz_uv||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.cascadeData.plantaId||r.planta_id||void 0};y.mutate(_e)},[r,y]);return h?a.jsx(a_,{children:a.jsxs(cB,{children:[a.jsx(dB,{}),a.jsxs("span",{children:["Cargando OT #",e,"..."]})]})}):f?a.jsxs(a_,{children:[a.jsxs(z$,{children:[a.jsx(I$,{children:"Error"}),a.jsx(i_,{onClick:()=>t("dashboard"),children:"Volver al Dashboard"})]}),a.jsxs(l_,{$type:"error",children:["No se pudo cargar la OT #",e,". ",f.message]})]}):r?a.jsxs(a_,{children:[a.jsxs(z$,{children:[a.jsxs(I$,{children:["Editar Orden de Trabajo",a.jsxs(uB,{children:["OT #",e]})]}),a.jsx(i_,{onClick:()=>t("dashboard"),children:"Volver al Dashboard"})]}),i&&a.jsx(l_,{$type:"success",children:i}),o&&a.jsx(l_,{$type:"error",children:o}),a.jsxs("form",{onSubmit:E,children:[a.jsxs(Is,{children:[a.jsx(ti,{children:"1. Datos Comerciales"}),a.jsxs(ri,{children:[a.jsxs(Po,{$columns:3,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cliente"}),a.jsxs(Ft,{value:r.client_id||"",onChange:T=>j("client_id",T.target.value?Number(T.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione cliente..."}),m==null?void 0:m.clientes.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Descripcin del Producto"}),a.jsx(Ze,{type:"text",maxLength:40,value:r.descripcion,onChange:T=>j("descripcion",T.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo de Solicitud"}),a.jsxs(Ft,{value:r.tipo_solicitud||"",onChange:T=>j("tipo_solicitud",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),hB.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Canal"}),a.jsxs(Ft,{value:r.canal_id||"",onChange:T=>j("canal_id",T.target.value?Number(T.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),m==null?void 0:m.canales.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cdigo Producto"}),a.jsx(Ze,{type:"text",value:r.codigo_producto,onChange:T=>j("codigo_producto",T.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Volumen Anual"}),a.jsx(Ze,{type:"number",value:r.volumen_venta_anual||"",onChange:T=>j("volumen_venta_anual",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs(Po,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nombre Contacto"}),a.jsx(Ze,{type:"text",value:r.nombre_contacto,onChange:T=>j("nombre_contacto",T.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Email Contacto"}),a.jsx(Ze,{type:"email",value:r.email_contacto,onChange:T=>j("email_contacto",T.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Telfono Contacto"}),a.jsx(Ze,{type:"tel",value:r.telefono_contacto,onChange:T=>j("telefono_contacto",T.target.value)})]})]}),a.jsxs(Po,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 1"}),a.jsxs(Ft,{value:r.hierarchy_id||"",onChange:T=>j("hierarchy_id",T.target.value?Number(T.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),g==null?void 0:g.hierarchies.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 2"}),a.jsxs(Ft,{value:r.subhierarchy_id||"",onChange:T=>j("subhierarchy_id",T.target.value?Number(T.target.value):null),disabled:!r.hierarchy_id||x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),_.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 3"}),a.jsxs(Ft,{value:r.subsubhierarchy_id||"",onChange:T=>j("subsubhierarchy_id",T.target.value?Number(T.target.value):null),disabled:!r.subhierarchy_id||x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),b.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]})]})]})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"2. Antecedentes Desarrollo"}),a.jsxs(ri,{children:[a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(Fe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs(o_,{children:[a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:T=>j("ant_des_correo_cliente",T.target.checked)}),"Correo Cliente"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:T=>j("ant_des_plano_actual",T.target.checked)}),"Plano Actual"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:T=>j("ant_des_boceto_actual",T.target.checked)}),"Boceto Actual"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:T=>j("ant_des_spec",T.target.checked)}),"Spec"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:T=>j("ant_des_otro",T.target.checked)}),"Otro"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(Fe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(o_,{children:[a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:T=>j("ant_des_cj_referencia_de",T.target.checked)}),"CJ Referencia DE"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:T=>j("ant_des_cj_referencia_dg",T.target.checked)}),"CJ Referencia DG"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:T=>j("ant_des_envase_primario",T.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs(Po,{$columns:3,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(Ta,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>j("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>j("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Armado Automtico"}),a.jsxs(Ft,{value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:T=>j("armado_automatico",T.target.value===""?null:T.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),a.jsx(Ne,{})]})]})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"Solicita"}),a.jsxs(ri,{children:[a.jsxs(o_,{children:[a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:T=>j("analisis",T.target.checked)}),"Anlisis"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:T=>j("prueba_industrial",T.target.checked)}),"Prueba Industrial"]}),a.jsxs(Ta,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:T=>j("muestra",T.target.checked)}),"Muestra"]})]}),r.muestra&&a.jsx(Po,{$columns:4,style:{marginTop:"1rem"},children:a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nmero de Muestras"}),a.jsx(Ze,{type:"number",min:"1",value:r.numero_muestras||"",onChange:T=>j("numero_muestras",T.target.value?Number(T.target.value):null)})]})})]})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"6.- Asistente Para: Ingresos Principales"}),a.jsx(ri,{children:a.jsx(bk,{values:r.cascadeData,onChange:k,fieldErrors:{}})})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"7.- Caractersticas"}),a.jsx(ri,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem"},children:[a.jsxs("div",{children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"CAD"}),a.jsxs(Ft,{value:r.cad_id||"",onChange:T=>j("cad_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(A=g==null?void 0:g.cads)==null?void 0:A.map(T=>a.jsx("option",{value:T.id,children:T.codigo||T.nombre},String(T.id)))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo Item"}),a.jsx(Ze,{type:"text",value:r.cascadeData.productTypeId&&((P=(w=g==null?void 0:g.product_types)==null?void 0:w.find(T=>T.id===r.cascadeData.productTypeId))==null?void 0:P.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Items del Set"}),a.jsx(Ze,{type:"number",min:"0",value:r.items_set||"",onChange:T=>j("items_set",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Veces Item"}),a.jsx(Ze,{type:"number",min:"0",value:r.veces_item||"",onChange:T=>j("veces_item",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cartn"}),a.jsx(Ze,{type:"text",value:r.cascadeData.cartonId&&((F=(M=g==null?void 0:g.cartons)==null?void 0:M.find(T=>T.id===r.cascadeData.cartonId))==null?void 0:F.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cinta"}),a.jsx(Ze,{type:"text",value:r.cascadeData.cinta!==null&&r.cascadeData.cinta!==void 0?Number(r.cascadeData.cinta)===1?"Si":"No":"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"FSC"}),a.jsx(Ze,{type:"text",value:r.cascadeData.fsc?((W=(D=g==null?void 0:g.fsc)==null?void 0:D.find(T=>T.id===Number(r.cascadeData.fsc)))==null?void 0:W.nombre)||String(r.cascadeData.fsc):"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Pas/Mercado Destino"}),a.jsxs(Ft,{value:r.pais_id||"",onChange:T=>j("pais_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(B=g==null?void 0:g.pais_referencia)==null?void 0:B.map(T=>a.jsx("option",{value:T.id,children:T.nombre},String(T.id)))]})]})]}),a.jsxs("div",{children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Estilo"}),a.jsxs(Ft,{value:r.style_id||"",onChange:T=>j("style_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(G=g==null?void 0:g.styles)==null?void 0:G.map(T=>a.jsx("option",{value:T.id,children:T.nombre},String(T.id)))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largura HM"}),a.jsx(Ze,{type:"number",value:r.largura_hm||"",onChange:T=>j("largura_hm",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Anchura HM"}),a.jsx(Ze,{type:"number",value:r.anchura_hm||"",onChange:T=>j("anchura_hm",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"rea Producto (M2)"}),a.jsx(Ze,{type:"number",value:r.area_producto||"",onChange:T=>j("area_producto",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Longitud Pegado (MM)"}),a.jsx(Ze,{type:"number",value:r.longitud_pegado||"",onChange:T=>j("longitud_pegado",T.target.value?Number(T.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Golpes al Largo"}),a.jsx(Ze,{type:"number",value:r.golpes_largo||"",onChange:T=>j("golpes_largo",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Golpes al Ancho"}),a.jsx(Ze,{type:"number",value:r.golpes_ancho||"",onChange:T=>j("golpes_ancho",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Rayado C1/R1 (MM)"}),a.jsx(Ze,{type:"number",value:r.rayado_c1r1||"",onChange:T=>j("rayado_c1r1",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Rayado R1/R2 (MM)"}),a.jsx(Ze,{type:"number",value:r.rayado_r1_r2||"",onChange:T=>j("rayado_r1_r2",T.target.value?Number(T.target.value):null)})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"BCT MIN (LB)"}),a.jsx(Ze,{type:"number",value:r.bct_min_lb||"",onChange:T=>j("bct_min_lb",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"BCT MIN (KG)"}),a.jsx(Ze,{type:"number",value:r.bct_min_kg||"",onChange:T=>j("bct_min_kg",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"GRAMAJE (G/M2)"}),a.jsx(Ze,{type:"number",value:r.gramaje||"",onChange:T=>j("gramaje",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"ECT"}),a.jsx(Ze,{type:"number",value:r.ect||"",onChange:T=>j("ect",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"COBB INTERIOR (G/M2)"}),a.jsx(Ze,{type:"number",value:r.cobb_interior||"",onChange:T=>j("cobb_interior",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"COBB EXTERIOR (G/M2)"}),a.jsx(Ze,{type:"number",value:r.cobb_exterior||"",onChange:T=>j("cobb_exterior",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"ESPESOR (MM)"}),a.jsx(Ze,{type:"number",value:r.espesor||"",onChange:T=>j("espesor",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"PESO (G)"}),a.jsx(Ze,{type:"number",value:r.peso||"",onChange:T=>j("peso",T.target.value?Number(T.target.value):null)})]})]})]})]})})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"8.- Color-Cera-Barniz"}),a.jsx(ri,{children:a.jsxs(aB,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Impresin"}),a.jsx(Ze,{type:"text",value:r.cascadeData.impresion?((ae=(Y=g==null?void 0:g.impresiones)==null?void 0:Y.find(T=>String(T.id)===String(r.cascadeData.impresion)))==null?void 0:ae.nombre)||r.cascadeData.impresion:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo Diseo"}),a.jsxs(Ft,{value:r.design_type_id||"",onChange:T=>j("design_type_id",T.target.value?Number(T.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(U=g==null?void 0:g.design_types)==null?void 0:U.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nmero Colores"}),a.jsxs(Ft,{value:r.numero_colores!==null?r.numero_colores:"",onChange:T=>j("numero_colores",T.target.value!==""?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5,6,7].map(T=>a.jsx("option",{value:T,children:T},T))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Recubrimiento Interno"}),a.jsx(Ze,{type:"text",value:r.cascadeData.coverageInternalId&&((z=(q=g==null?void 0:g.coverages_internal)==null?void 0:q.find(T=>T.id===r.cascadeData.coverageInternalId))==null?void 0:z.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Recubrimiento Interno"}),a.jsx(Ze,{type:"number",min:"0",value:r.percentage_coverage_internal||"",onChange:T=>j("percentage_coverage_internal",T.target.value?Number(T.target.value):null)})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[r.numero_colores&&r.numero_colores>=1&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 1"}),a.jsxs(Ft,{value:r.color_1_id||"",onChange:T=>j("color_1_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ie=g==null?void 0:g.colors)==null?void 0:ie.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),r.numero_colores&&r.numero_colores>=2&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 2"}),a.jsxs(Ft,{value:r.color_2_id||"",onChange:T=>j("color_2_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(he=g==null?void 0:g.colors)==null?void 0:he.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),r.numero_colores&&r.numero_colores>=3&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 3"}),a.jsxs(Ft,{value:r.color_3_id||"",onChange:T=>j("color_3_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(O=g==null?void 0:g.colors)==null?void 0:O.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),r.numero_colores&&r.numero_colores>=4&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 4"}),a.jsxs(Ft,{value:r.color_4_id||"",onChange:T=>j("color_4_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(R=g==null?void 0:g.colors)==null?void 0:R.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),r.numero_colores&&r.numero_colores>=5&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 5"}),a.jsxs(Ft,{value:r.color_5_id||"",onChange:T=>j("color_5_id",T.target.value?Number(T.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(I=g==null?void 0:g.colors)==null?void 0:I.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Barniz UV"}),a.jsxs(Ft,{value:r.barniz_uv===null?"":r.barniz_uv,onChange:T=>j("barniz_uv",T.target.value===""?null:Number(T.target.value)),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),r.barniz_uv===1&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Barniz UV"}),a.jsx(Ze,{type:"number",min:"0",max:"100",value:r.porcentanje_barniz_uv||"",onChange:T=>j("porcentanje_barniz_uv",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Recubrimiento Externo"}),a.jsx(Ze,{type:"text",value:r.cascadeData.coverageExternalId&&((ne=(K=g==null?void 0:g.coverages_external)==null?void 0:K.find(T=>T.id===r.cascadeData.coverageExternalId))==null?void 0:ne.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Recubrimiento Externo"}),a.jsx(Ze,{type:"number",min:"0",value:r.percentage_coverage_external||"",onChange:T=>j("percentage_coverage_external",T.target.value?Number(T.target.value):null)})]})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Complejidad"}),a.jsx(Ze,{type:"text",value:r.complejidad,onChange:T=>j("complejidad",T.target.value)})]})})]})})]}),a.jsxs(iB,{children:[a.jsxs(s_,{children:[a.jsx(ti,{children:"9.- Medidas Interiores"}),a.jsx(ri,{children:a.jsxs(Po,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largo (mm)"}),a.jsx(Ze,{type:"number",value:r.interno_largo||"",onChange:T=>j("interno_largo",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Ancho (mm)"}),a.jsx(Ze,{type:"number",value:r.interno_ancho||"",onChange:T=>j("interno_ancho",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Alto (mm)"}),a.jsx(Ze,{type:"number",value:r.interno_alto||"",onChange:T=>j("interno_alto",T.target.value?Number(T.target.value):null)})]})]})})]}),a.jsxs(s_,{children:[a.jsx(ti,{children:"10.- Medidas Exteriores"}),a.jsx(ri,{children:a.jsxs(Po,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largo (mm)"}),a.jsx(Ze,{type:"number",value:r.externo_largo||"",onChange:T=>j("externo_largo",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Ancho (mm)"}),a.jsx(Ze,{type:"number",value:r.externo_ancho||"",onChange:T=>j("externo_ancho",T.target.value?Number(T.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Alto (mm)"}),a.jsx(Ze,{type:"number",value:r.externo_alto||"",onChange:T=>j("externo_alto",T.target.value?Number(T.target.value):null)})]})]})})]}),a.jsxs(s_,{children:[a.jsx(ti,{children:"11.- Terminaciones"}),a.jsx(ri,{children:a.jsxs(Po,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Proceso"}),a.jsxs(Ft,{value:r.process_id||"",onChange:T=>j("process_id",T.target.value?Number(T.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),m==null?void 0:m.procesos.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Armado"}),a.jsxs(Ft,{value:r.armado_id||"",onChange:T=>j("armado_id",T.target.value?Number(T.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ee=g==null?void 0:g.armados)==null?void 0:ee.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Sentido de Armado"}),a.jsxs(Ft,{value:r.sentido_armado||"",onChange:T=>j("sentido_armado",T.target.value?Number(T.target.value):null),disabled:x,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ge=g==null?void 0:g.sentidos_armado)==null?void 0:ge.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]})]})})]})]}),a.jsxs(Is,{children:[a.jsx(ti,{children:"13.- Material Asignado"}),a.jsx(ri,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",maxWidth:"100%"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"MATERIAL ASIGNADO"}),a.jsx(Ze,{type:"text",value:r.material_asignado,onChange:T=>j("material_asignado",T.target.value),placeholder:"Cdigo de material..."})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"DESCRIPCIN"}),a.jsx(Ze,{type:"text",value:r.descripcion_material,onChange:T=>j("descripcion_material",T.target.value),placeholder:"Descripcin del material..."})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"65% 35%",gap:"0.5rem",maxWidth:"100%",overflow:"hidden"},children:[a.jsxs(Is,{style:{margin:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[a.jsx(ti,{children:"13.- Datos para desarrollo"}),a.jsx(ri,{style:{overflow:"hidden",padding:"0.5rem"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.7rem",maxWidth:"100%"},children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"TIPO PRODUCTO:"}),a.jsxs(Ft,{value:r.product_type_developing_id||"",onChange:T=>j("product_type_developing_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(L=g==null?void 0:g.product_type_developing)==null?void 0:L.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"PESO CAJA (KG):"}),a.jsx(Ze,{type:"number",value:r.peso_contenido_caja||"",onChange:T=>j("peso_contenido_caja",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"TIPO ALIMENTO:"}),a.jsxs(Ft,{value:r.food_type_id||"",onChange:T=>j("food_type_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(se=g==null?void 0:g.food_types)==null?void 0:se.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"AUTOSOPORTANTE:"}),a.jsxs(Ft,{value:r.autosoportante?"1":"0",onChange:T=>j("autosoportante",T.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"USO PREVISTO:"}),a.jsxs(Ft,{value:r.expected_use_id||"",onChange:T=>j("expected_use_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ke=g==null?void 0:g.expected_uses)==null?void 0:ke.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"ENVASE PRIMARIO:"}),a.jsxs(Ft,{value:r.envase_id||"",onChange:T=>j("envase_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(V=g==null?void 0:g.envases)==null?void 0:V.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"CLASE SUSTANCIA:"}),a.jsxs(Ft,{value:r.class_substance_packed_id||"",onChange:T=>j("class_substance_packed_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ve=g==null?void 0:g.class_substance_packeds)==null?void 0:Ve.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"CANTIDAD:"}),a.jsx(Ze,{type:"number",value:r.cantidad||"",onChange:T=>j("cantidad",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"MEDIO TRANSPORTE:"}),a.jsxs(Ft,{value:r.transportation_way_id||"",onChange:T=>j("transportation_way_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ke=g==null?void 0:g.transportation_ways)==null?void 0:Ke.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"MERCADO DESTINO:"}),a.jsxs(Ft,{value:r.target_market_id||"",onChange:T=>j("target_market_id",T.target.value?Number(T.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ye=g==null?void 0:g.target_markets)==null?void 0:ye.map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]})]})})]}),a.jsxs(Is,{style:{margin:0,minWidth:0,overflow:"hidden"},children:[a.jsx(ti,{children:"14.- Observacin del trabajo a realizar"}),a.jsx(ri,{style:{padding:"0.5rem",overflow:"hidden"},children:a.jsx(sB,{value:r.observacion,onChange:T=>j("observacion",T.target.value),placeholder:"Observaciones adicionales...",style:{width:"100%",height:"200px",resize:"none",fontSize:"0.75rem",boxSizing:"border-box"}})})]})]}),a.jsxs(lB,{children:[a.jsx(i_,{type:"button",onClick:()=>t("dashboard"),children:"Cancelar"}),a.jsx(oB,{type:"submit",disabled:y.isPending,children:y.isPending?"Guardando...":"Guardar Cambios"})]})]})]}):null}const ht={Vendedor:4,JefeVenta:3,JefeDesarrollo:5,Ingeniero:6,JefeMuestras:13,TecnicoMuestras:14,SuperAdministrador:18,Admin:1},ki={Ventas:1,Desarrollo:2,SalaMuestras:6},Nr={EnProceso:1,Rechazada:2,Terminada:3,Anulada:4,Devuelta:5},iv=(e,t)=>e?e===t.sala_corte_vendedor||e===t.sala_corte_disenador||e===t.sala_corte_laboratorio||e===t.sala_corte_1||e===t.sala_corte_2||e===t.sala_corte_3||e===t.sala_corte_4||e===t.sala_corte_disenador_revision:!1,L$=e=>[ht.Ingeniero,ht.JefeVenta,ht.Vendedor,ht.TecnicoMuestras,ht.JefeMuestras,ht.JefeDesarrollo,ht.SuperAdministrador,ht.Admin].includes(e),B$=(e,t)=>e===ht.Ingeniero||e===ht.JefeDesarrollo||(e===ht.Vendedor||e===ht.JefeVenta)&&t===ki.Ventas,pB=(e,t,r,n,i)=>e===ht.Vendedor||e===ht.JefeVenta?t===ki.Ventas:e===ht.Ingeniero||e===ht.JefeDesarrollo?t===ki.Desarrollo&&r!==Nr.Rechazada&&r!==Nr.Terminada:e===ht.JefeMuestras?t===ki.SalaMuestras&&r!==Nr.Rechazada&&r!==Nr.Terminada&&r!==Nr.Anulada:e===ht.TecnicoMuestras?!(t===ki.SalaMuestras&&r!==Nr.Rechazada&&r!==Nr.Terminada&&r!==Nr.Anulada)||!i?!1:iv(n,i):!1,mB=(e,t,r,n,i)=>e===ht.TecnicoMuestras&&t===ki.SalaMuestras?!(r===Nr.EnProceso||r===Nr.Devuelta)||!i?!1:iv(n,i):!1,gB=(e,t)=>e===ht.JefeMuestras||e===ht.JefeDesarrollo?t===ki.SalaMuestras:!1,xB=(e,t,r)=>e===ht.Ingeniero||e===ht.JefeDesarrollo?t===ki.Desarrollo&&r!==Nr.Terminada&&r!==Nr.Rechazada:!1,vB=(e,t,r,n,i)=>t===ki.SalaMuestras&&r!==Nr.Rechazada&&r!==Nr.Terminada?e===ht.JefeMuestras?!0:e===ht.TecnicoMuestras&&i?iv(n,i):!1:!1,_B=(e,t,r,n,i)=>t===ki.SalaMuestras&&r!==Nr.Devuelta&&r!==Nr.Anulada&&r!==Nr.Terminada&&r!==Nr.Rechazada?e===ht.JefeMuestras?!0:e===ht.TecnicoMuestras&&i?iv(n,i):!1:!1,yB=(e,t)=>t===Nr.Terminada?[ht.TecnicoMuestras,ht.JefeMuestras,ht.JefeDesarrollo,ht.Ingeniero].includes(e):!1,bB=e=>{const t=[];return e.golpes_largo||t.push("Golpes al Largo"),e.golpes_ancho||t.push("Golpes al Ancho"),e.largura_hm||t.push("Largura HM"),e.anchura_hm||t.push("Anchura HM"),e.process_id||t.push("Proceso"),e.carton_id||t.push("Cartn"),t.length===0?(!e.carton_id||!e.process_id)&&t.push("rea HC (requiere Cartn y Proceso)"):t.push("rea HC"),t},jB=(e,t)=>{const r=bB(t);return e===ht.Vendedor&&r.length===0?{canCotizar:!0,camposFaltantes:[]}:e!==ht.Vendedor?{canCotizar:!1,camposFaltantes:["Solo el rol Vendedor puede cotizar",...r]}:{canCotizar:!1,camposFaltantes:r}},wB=e=>e.tipo_solicitud!==6,kB=(e,t)=>{const r=t.current_area_id;return e===ht.SuperAdministrador||e===ht.Admin||e===ht.JefeDesarrollo?!0:e===ht.Vendedor||e===ht.JefeVenta?r===ki.Ventas:e===ht.Ingeniero?r===ki.Desarrollo:!1},U$=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,CB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,SB=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,$B=p.div`
  display: flex;
  gap: 0.5rem;
  align-items: center;
`,EB=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,V$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.primary};
  border-radius: 50px;
  background: white;
  color: ${d.colors.primary};
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 0.35rem;

  &:hover {
    background: ${d.colors.primary};
    color: white;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,TB=p.div`
  position: relative;
  display: inline-block;
`,AB=p.div`
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 8px;
  padding: 0.5rem 0.75rem;
  background: #333;
  color: white;
  font-size: 0.75rem;
  border-radius: 4px;
  white-space: nowrap;
  max-width: 300px;
  white-space: pre-wrap;
  z-index: 1000;
  visibility: ${e=>e.$visible?"visible":"hidden"};
  opacity: ${e=>e.$visible?1:0};
  transition: opacity 0.2s, visibility 0.2s;

  &::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-bottom-color: #333;
  }
`,H$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid;
  border-radius: 50px;
  background: white;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 0.35rem;

  ${e=>{switch(e.$variant){case"primary":return`
          border-color: ${d.colors.primary};
          color: ${d.colors.primary};
          &:hover:not(:disabled) {
            background: ${d.colors.primary};
            color: white;
          }
        `;case"success":return`
          border-color: #28a745;
          color: #28a745;
          &:hover:not(:disabled) {
            background: #28a745;
            color: white;
          }
        `;default:return`
          border-color: ${d.colors.border};
          color: ${d.colors.textSecondary};
          &:hover:not(:disabled) {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,FB=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,W$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,G$=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,q$=p.div`
  padding: 1rem;
`,sm=p.span`
  display: inline-block;
  padding: 0.35rem 0.75rem;
  border-radius: 50px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-right: 0.5rem;

  ${e=>e.$type==="area"&&`
    background: ${d.colors.primary}15;
    color: ${d.colors.primary};
  `}

  ${e=>e.$type==="state"&&`
    background: #6c757d15;
    color: #6c757d;
  `}
`,DB=p.div`
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`,K$=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,om=p.div`
  margin-bottom: 1rem;
`,lm=p.label`
  display: block;
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,c_=p.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,PB=p.textarea`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,MB=p.button`
  width: 100%;
  padding: 0.75rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,OB=p.div`
  max-height: 400px;
  overflow-y: auto;
`,RB=p.div`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background: ${d.colors.bgLight};
  }
`,NB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.25rem;
`,zB=p.div`
  display: flex;
  gap: 0.5rem;
`,IB=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
`,LB=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
`,BB=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  margin-top: 0.5rem;
  padding: 0.5rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  font-style: italic;
`,X$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,UB=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,VB=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,HB=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,WB=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,d_=p.div`
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,u_=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin-bottom: 0.25rem;
`,h_=p.div`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  font-weight: 500;
`,GB=p.div`
  margin-top: 1.5rem;
`,qB=p.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
  color: white;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.95;
  }
`,KB=p.h2`
  font-size: 1rem;
  font-weight: 500;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,XB=p.span`
  font-size: 1.25rem;
  transition: transform 0.2s;
  transform: ${e=>e.$expanded?"rotate(180deg)":"rotate(0deg)"};
`,YB=p.div`
  max-height: ${e=>e.$expanded?"800px":"0"};
  overflow: hidden;
  transition: max-height 0.3s ease-in-out;
  background: white;
  border: ${e=>e.$expanded?`1px solid ${d.colors.border}`:"none"};
  border-top: none;
  border-radius: 0 0 8px 8px;
`,QB=p.div`
  padding: 1rem;
`,JB=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;

  th, td {
    padding: 0.5rem;
    text-align: left;
    border-bottom: 1px solid ${d.colors.border};
  }

  th {
    background: ${d.colors.bgLight};
    font-weight: 600;
    color: ${d.colors.textSecondary};
    font-size: 0.7rem;
    text-transform: uppercase;
  }

  tr:hover {
    background: ${d.colors.bgLight};
  }

  tr.prioritaria {
    background: #d1f3d1;
  }
`,f_=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>e.$type==="estado"&&`
    background: #6c757d15;
    color: #6c757d;
  `}

  ${e=>e.$type==="prioritaria"&&`
    background: #28a74520;
    color: #28a745;
  `}
`,ZB=p.div`
  display: flex;
  gap: 0.25rem;
`,Xl=p.button`
  padding: 0.25rem 0.5rem;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.bgLight};
  color: ${d.colors.textPrimary};

  &:hover {
    background: ${d.colors.primary};
    color: white;
  }

  &.danger:hover {
    background: #dc3545;
  }

  &.success:hover {
    background: #28a745;
  }
`,e9=p.button`
  padding: 0.5rem 1rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-bottom: 1rem;

  &:hover {
    background: #002d66;
  }
`,Y$=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,t9=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,r9=p.div`
  background: white;
  border-radius: 8px;
  max-width: 600px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
`,n9=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.25rem;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  border-radius: 8px 8px 0 0;
`,a9=p.h3`
  margin: 0;
  font-size: 1rem;
  font-weight: 500;
`,i9=p.button`
  background: none;
  border: none;
  color: white;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;

  &:hover {
    opacity: 0.8;
  }
`,s9=p.div`
  padding: 1.25rem;
`,p_=p.div`
  margin-bottom: 1.25rem;
`,m_=p.h4`
  font-size: 0.85rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.75rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
`,xr=p.div`
  margin-bottom: 0.75rem;
`,Cr=p.label`
  display: block;
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
`,hs=p.input`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Ni=p.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Aa=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
`,o9=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  padding: 1rem 1.25rem;
  border-top: 1px solid ${d.colors.border};
`,Q$=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>e.$primary?`
    background: ${d.colors.primary};
    color: white;
    border: none;

    &:hover:not(:disabled) {
      background: #002d66;
    }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border: 1px solid ${d.colors.border};

    &:hover {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Mo=1,l9=2,c9=3,Yl=12,d9={1:1,2:2,5:3,6:5,7:4,12:null,13:1,9:null,10:null,11:null,14:null,15:null,16:null,17:null,18:null,20:null,21:null,22:null},u9=[1,2,5,6,7,13];function h9({otId:e,onNavigate:t}){var T,_e,St,Hr,xn,Un,Mi,la;const[r,n]=S.useState(null),[i,s]=S.useState(null),[o,l]=S.useState(null),[c,u]=S.useState(""),[h,f]=S.useState(null),[m,v]=S.useState(null),[g,x]=S.useState(!1),[_,b]=S.useState(null),[y,j]=S.useState(!1),[k,E]=S.useState({}),[A,w]=S.useState(null),[P,M]=S.useState(!1),F=mo.getStoredUser(),D=(F==null?void 0:F.role_id)||0,W=F==null?void 0:F.sala_corte_id,B=Mr(),{data:G,isLoading:Y}=WP(e),{data:ae,isLoading:U}=B7(e),{data:q,isLoading:z}=U7(e),ie=V7(),{data:he,isLoading:O}=zt({queryKey:["muestras-ot",e],queryFn:()=>_r.listByOT(e),enabled:L$(D)&&g}),R=Ct({mutationFn:re=>_r.terminar(re),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra terminada exitosamente")},onError:re=>v(re.message)}),I=Ct({mutationFn:re=>_r.anular(re),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra anulada exitosamente")},onError:re=>v(re.message)}),K=Ct({mutationFn:re=>_r.togglePrioritaria(re),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]})},onError:re=>v(re.message)}),ne=Ct({mutationFn:re=>_r.rechazar(re),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra rechazada exitosamente")},onError:re=>v(re.message)}),ee=Ct({mutationFn:re=>_r.devolver(re),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra devuelta exitosamente")},onError:re=>v(re.message)}),ge=Ct({mutationFn:({id:re,data:De})=>_r.update(re,De),onSuccess:()=>{B.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra actualizada exitosamente"),j(!1),b(null),E({})},onError:re=>v(re.message)}),L=Ct({mutationFn:()=>Fn.createFromOT(e),onSuccess:re=>{f(`Cotizacin #${re.cotizacion_id} creada exitosamente`),t("cotizacion-form",re.cotizacion_id)},onError:re=>{v(`Error al crear cotizacin: ${re.message}`)}}),se=S.useCallback(()=>{v(null),L.mutate()},[L]),ke=S.useCallback(async re=>{try{const[De,Wr]=await Promise.all([_r.get(re),_r.getOptions()]);b(De),w(Wr),E({cad:De.cad_codigo||void 0,cad_id:De.cad_id||void 0,carton_id:De.carton_id||void 0,carton_muestra_id:void 0,pegado_id:De.pegado_id||void 0,tiempo_unitario:De.tiempo_unitario||void 0,cantidad_vendedor:De.cantidad_vendedor||0,cantidad_disenador:De.cantidad_disenador||0,cantidad_laboratorio:De.cantidad_laboratorio||0,cantidad_disenador_revision:De.cantidad_disenador_revision||0,sala_corte_vendedor:De.sala_corte_id||void 0}),j(!0)}catch{v("Error al cargar datos de la muestra")}},[]),V=S.useCallback(()=>{if(!_)return;const re={};k.cad_id!==void 0&&(re.cad_id=k.cad_id),k.carton_id!==void 0&&(re.carton_id=k.carton_id),k.carton_muestra_id!==void 0&&(re.carton_muestra_id=k.carton_muestra_id),k.pegado_id!==void 0&&(re.pegado_id=k.pegado_id),k.tiempo_unitario!==void 0&&(re.tiempo_unitario=k.tiempo_unitario),k.cantidad_vendedor!==void 0&&(re.cantidad_vendedor=k.cantidad_vendedor),k.cantidad_disenador!==void 0&&(re.cantidad_disenador=k.cantidad_disenador),k.cantidad_laboratorio!==void 0&&(re.cantidad_laboratorio=k.cantidad_laboratorio),k.cantidad_disenador_revision!==void 0&&(re.cantidad_disenador_revision=k.cantidad_disenador_revision),k.sala_corte_vendedor!==void 0&&(re.sala_corte_vendedor=k.sala_corte_vendedor),console.log("Guardando muestra:",_.id,re),ge.mutate({id:_.id,data:re})},[_,k,ge]),Ve=S.useCallback(()=>{if(!r){v("Debe seleccionar tipo de gestion");return}if(r===Mo&&!o){v("Debe seleccionar un estado");return}if(r===Mo&&o===Yl&&!i){v("Debe seleccionar el rea de destino para el rechazo");return}const re={management_type_id:r,work_space_id:i||void 0,state_id:o||void 0,observation:c||void 0};ie.mutate({id:e,data:re},{onSuccess:De=>{f(De.message),v(null),n(null),s(null),l(null),u("")},onError:De=>{v(De.message||"Error al realizar la transicion"),f(null)}})},[e,r,i,o,c,ie]),Ke=re=>re?new Date(re).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";if(U||z||Y)return a.jsx(U$,{children:a.jsxs(UB,{children:[a.jsx(VB,{}),a.jsxs("span",{children:["Cargando informacion de OT #",e,"..."]})]})});const ye=G;return a.jsxs(U$,{children:[a.jsxs(CB,{children:[a.jsxs(SB,{children:["Gestionar Orden de Trabajo",a.jsxs(HB,{children:["OT #",e]})]}),a.jsxs($B,{children:[ye&&wB(ye)&&(()=>{const{canCotizar:re,camposFaltantes:De}=jB(D,ye),Wr=De.length>0?`Para cotizar se requieren:
- ${De.join(`
- `)}`:"",Oi=L.isPending;return a.jsxs(TB,{onMouseEnter:()=>!re&&M(!0),onMouseLeave:()=>M(!1),children:[a.jsx(H$,{$variant:"primary",disabled:!re||Oi,onClick:()=>re&&se(),title:re?"Cotizar esta OT":Wr,children:Oi?"Creando...":"Cotizar OT"}),a.jsx(AB,{$visible:P&&!re,children:Wr})]})})(),ye&&kB(D,ye)&&a.jsx(H$,{$variant:"success",onClick:()=>t("editar-ot",e),title:"Ver/Editar datos de la OT",children:"Ver/Editar OT "}),a.jsx(V$,{onClick:()=>d1.downloadFichaDiseno(e),title:"Descargar Ficha de Diseo",children:"Ficha Diseo"}),a.jsx(V$,{onClick:()=>d1.downloadEstudioBench(e),title:"Descargar Solicitud Benchmarking",children:"Est. Bench"}),a.jsx(EB,{onClick:()=>t("dashboard"),children:" Volver al Dashboard"})]})]}),h&&a.jsx(X$,{$type:"success",children:h}),m&&a.jsx(X$,{$type:"error",children:m}),ye&&a.jsxs(WB,{children:[a.jsxs(d_,{children:[a.jsx(u_,{children:"Cliente"}),a.jsx(h_,{children:ye.client_name||"N/A"})]}),a.jsxs(d_,{children:[a.jsx(u_,{children:"Descripcion"}),a.jsx(h_,{children:ye.descripcion||"N/A"})]}),a.jsxs(d_,{children:[a.jsx(u_,{children:"Creador"}),a.jsx(h_,{children:ye.creador_nombre||"N/A"})]})]}),a.jsxs(FB,{children:[a.jsxs(W$,{children:[a.jsx(G$,{children:"Transicion de Estado"}),a.jsxs(q$,{children:[a.jsxs(DB,{children:[a.jsxs("div",{children:[a.jsx(K$,{children:"Area Actual"}),a.jsx("div",{children:a.jsx(sm,{$type:"area",children:(ae==null?void 0:ae.current_area)||"Sin asignar"})})]}),a.jsxs("div",{children:[a.jsx(K$,{children:"Estado Actual"}),a.jsx("div",{children:a.jsx(sm,{$type:"state",children:(ae==null?void 0:ae.current_state)||"Sin estado"})})]})]}),a.jsxs(om,{children:[a.jsx(lm,{children:"Tipo de Gestion"}),a.jsxs(c_,{value:r||"",onChange:re=>{const De=re.target.value?Number(re.target.value):null;n(De),De!==Mo&&(s(null),l(null))},children:[a.jsx("option",{value:"",children:"Seleccione tipo de gestion..."}),(T=q==null?void 0:q.management_types)==null?void 0:T.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]}),r===Mo&&a.jsxs(a.Fragment,{children:[a.jsxs(om,{children:[a.jsx(lm,{children:"Estado"}),a.jsxs(c_,{value:o||"",onChange:re=>{const De=re.target.value?Number(re.target.value):null;if(l(De),De&&u9.includes(De)){const Wr=d9[De];s(Wr)}else s(null)},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),q==null?void 0:q.states.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]}),a.jsxs(om,{children:[a.jsx(lm,{children:"Area"}),a.jsxs(c_,{value:i||"",onChange:re=>s(re.target.value?Number(re.target.value):null),disabled:o!==Yl,style:{backgroundColor:o!==Yl?"#f5f5f5":"white",cursor:o!==Yl?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),q==null?void 0:q.areas.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]}),o&&o!==Yl&&i&&a.jsx("small",{style:{color:"#666",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"},children:"rea determinada automticamente por el estado"})]})]}),a.jsxs(om,{children:[a.jsxs(lm,{children:["Observacion ",r===Mo?"(opcional)":""]}),a.jsx(PB,{value:c,onChange:re=>u(re.target.value),placeholder:"Ingrese una observacion...",maxLength:500})]}),a.jsx(MB,{onClick:Ve,disabled:!r||r===Mo&&!o||r===Mo&&o===Yl&&!i||ie.isPending,children:ie.isPending?"Procesando...":r===Mo?"Realizar Transicion":r===l9?"Registrar Consulta":r===c9?"Archivar OT":"Ejecutar"})]})]}),a.jsxs(W$,{children:[a.jsx(G$,{children:"Historial de Gestion"}),a.jsx(q$,{children:a.jsxs(OB,{children:[(ae==null?void 0:ae.history.length)===0&&a.jsx("div",{style:{textAlign:"center",padding:"2rem",color:d.colors.textSecondary},children:"No hay registros de gestion"}),ae==null?void 0:ae.history.map(re=>a.jsxs(RB,{children:[a.jsxs(NB,{children:[a.jsxs(zB,{children:[a.jsx(sm,{$type:"area",children:re.work_space}),a.jsx(sm,{$type:"state",children:re.state})]}),a.jsx(IB,{children:Ke(re.created_at)})]}),a.jsxs(LB,{children:["Por: ",re.user_name]}),re.observation&&a.jsxs(BB,{children:['"',re.observation,'"']})]},re.id))]})})]})]}),L$(D)&&a.jsxs(GB,{children:[a.jsxs(qB,{onClick:()=>x(!g),children:[a.jsxs(KB,{children:["Gestionar Muestras",he&&he.total>0&&a.jsxs(f_,{$type:"estado",children:[he.total," muestra",he.total!==1?"s":""]})]}),a.jsx(XB,{$expanded:g,children:""})]}),a.jsx(YB,{$expanded:g,children:a.jsxs(QB,{children:[B$(D,ye==null?void 0:ye.current_area_id)&&a.jsx(e9,{onClick:()=>t("muestra-nueva",e),children:"+ Crear Muestra"}),O?a.jsx(Y$,{children:"Cargando muestras..."}):he&&he.items.length>0?a.jsxs(JB,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ID"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Tipo Pegado"}),a.jsx("th",{children:"Planta Corte"}),a.jsx("th",{children:"Destinatario"}),a.jsx("th",{children:"N Muestras"}),a.jsx("th",{children:"Fecha Corte"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:he.items.map(re=>a.jsxs("tr",{className:re.prioritaria?"prioritaria":"",children:[a.jsx("td",{children:re.id}),a.jsx("td",{children:re.cad||"--"}),a.jsx("td",{children:re.carton||"--"}),a.jsx("td",{children:re.tipo_pegado||"--"}),a.jsx("td",{children:re.sala_corte||"--"}),a.jsx("td",{children:re.creador_nombre||"--"}),a.jsx("td",{children:re.cantidad_total}),a.jsx("td",{children:re.created_at||"--"}),a.jsxs("td",{children:[a.jsx(f_,{$type:"estado",children:re.estado_nombre}),re.prioritaria&&a.jsx(f_,{$type:"prioritaria",children:"Prioritaria"})]}),a.jsx("td",{children:a.jsxs(ZB,{children:[pB(D,ye==null?void 0:ye.current_area_id,re.estado,W,re)&&a.jsx(Xl,{onClick:()=>ke(re.id),title:"Editar muestra",children:""}),yB(D,re.estado)&&a.jsx(Xl,{onClick:()=>ke(re.id),title:"Ver detalle",children:""}),mB(D,ye==null?void 0:ye.current_area_id,re.estado,W,re)&&a.jsx(Xl,{className:"success",onClick:()=>R.mutate(re.id),disabled:R.isPending,title:"Terminar muestra",children:""}),gB(D,ye==null?void 0:ye.current_area_id)&&a.jsx(Xl,{onClick:()=>K.mutate(re.id),disabled:K.isPending,title:re.prioritaria?"Quitar prioridad":"Marcar prioritaria",children:""}),xB(D,ye==null?void 0:ye.current_area_id,re.estado)&&a.jsx(Xl,{className:"danger",onClick:()=>I.mutate(re.id),disabled:I.isPending,title:"Anular muestra",children:""}),vB(D,ye==null?void 0:ye.current_area_id,re.estado,W,re)&&a.jsx(Xl,{className:"danger",onClick:()=>ne.mutate(re.id),disabled:ne.isPending,title:"Rechazar muestra",children:""}),_B(D,ye==null?void 0:ye.current_area_id,re.estado,W,re)&&a.jsx(Xl,{onClick:()=>ee.mutate(re.id),disabled:ee.isPending,title:"Devolver muestra",children:""})]})})]},re.id))})]}):a.jsxs(Y$,{children:["No hay muestras registradas para esta OT.",B$(D,ye==null?void 0:ye.current_area_id)&&a.jsx("div",{style:{marginTop:"0.5rem"},children:'Haga clic en "Crear Muestra" para agregar una.'})]})]})})]}),y&&_&&a.jsx(t9,{onClick:()=>j(!1),children:a.jsxs(r9,{onClick:re=>re.stopPropagation(),children:[a.jsxs(n9,{children:[a.jsxs(a9,{children:["Editar Muestra ID ",_.id]}),a.jsx(i9,{onClick:()=>j(!1),children:""})]}),a.jsxs(s9,{children:[a.jsxs(p_,{children:[a.jsx(m_,{children:"Caractersticas de Muestra"}),a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CAD"}),a.jsxs(Ni,{value:k.cad_id||"",onChange:re=>E(De=>({...De,cad_id:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),A==null?void 0:A.cads.map(re=>a.jsx("option",{value:re.id,children:re.codigo},re.id))]})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"Cartn"}),a.jsxs(Ni,{value:k.carton_id||"",onChange:re=>E(De=>({...De,carton_id:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),A==null?void 0:A.cartones.map(re=>a.jsx("option",{value:re.id,children:re.codigo},re.id))]})]})]}),a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"Tipo de Pegado"}),a.jsxs(Ni,{value:k.pegado_id||"",onChange:re=>E(De=>({...De,pegado_id:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(_e=A==null?void 0:A.pegados)==null?void 0:_e.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"Tiempo Unitario"}),a.jsx(hs,{type:"time",value:k.tiempo_unitario||"",onChange:re=>E(De=>({...De,tiempo_unitario:re.target.value||void 0}))})]})]}),a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"Cartn Muestra"}),a.jsxs(Ni,{value:k.carton_muestra_id||"",onChange:re=>E(De=>({...De,carton_muestra_id:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),A==null?void 0:A.cartones.map(re=>a.jsx("option",{value:re.id,children:re.codigo},re.id))]})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"Planta de Corte"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})]})]}),a.jsxs(p_,{children:[a.jsx(m_,{children:"Enviar Muestras A"}),a.jsx(Aa,{children:a.jsx(xr,{style:{width:"100%"},children:a.jsxs(Ni,{value:((St=_.destinatarios_id)==null?void 0:St[0])||"",disabled:!0,style:{backgroundColor:"#f5f5f5"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Retira Ventas VB"}),a.jsx("option",{value:"2",children:"Retira Diseador VB"}),a.jsx("option",{value:"3",children:"Envo Laboratorio"}),a.jsx("option",{value:"4",children:"Envo Cliente VB"}),a.jsx("option",{value:"5",children:"Retira Diseador Revisin"})]})})})]}),a.jsxs(p_,{children:[a.jsx(m_,{children:"Datos de Muestra"}),((Hr=_.destinatarios_id)==null?void 0:Hr[0])==="1"&&a.jsxs(a.Fragment,{children:[a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CANTIDAD"}),a.jsx(hs,{type:"number",min:"0",value:k.cantidad_vendedor||0,onChange:re=>E(De=>({...De,cantidad_vendedor:Number(re.target.value)}))})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"FORMA DE ENTREGA"}),a.jsx(hs,{type:"text",value:"Retira Vendedor",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Aa,{children:a.jsxs(xr,{children:[a.jsx(Cr,{children:"PLANTA DE CORTE"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})})]}),((xn=_.destinatarios_id)==null?void 0:xn[0])==="2"&&a.jsxs(a.Fragment,{children:[a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CANTIDAD"}),a.jsx(hs,{type:"number",min:"0",value:k.cantidad_disenador||0,onChange:re=>E(De=>({...De,cantidad_disenador:Number(re.target.value)}))})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"FORMA DE ENTREGA"}),a.jsx(hs,{type:"text",value:_.comentario_disenador||"fsica",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Aa,{children:a.jsxs(xr,{children:[a.jsx(Cr,{children:"PLANTA DE CORTE"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})})]}),((Un=_.destinatarios_id)==null?void 0:Un[0])==="3"&&a.jsxs(a.Fragment,{children:[a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CANTIDAD"}),a.jsx(hs,{type:"number",min:"0",value:k.cantidad_laboratorio||0,onChange:re=>E(De=>({...De,cantidad_laboratorio:Number(re.target.value)}))})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"FORMA DE ENTREGA"}),a.jsx(hs,{type:"text",value:_.comentario_laboratorio||"",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Aa,{children:a.jsxs(xr,{children:[a.jsx(Cr,{children:"PLANTA DE CORTE"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})})]}),((Mi=_.destinatarios_id)==null?void 0:Mi[0])==="4"&&a.jsx(a.Fragment,{children:a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CANTIDAD"}),a.jsx(hs,{type:"number",min:"0",value:k.cantidad_1||0,onChange:re=>E(De=>({...De,cantidad_1:Number(re.target.value)}))})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"PLANTA DE CORTE"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})]})}),((la=_.destinatarios_id)==null?void 0:la[0])==="5"&&a.jsxs(a.Fragment,{children:[a.jsxs(Aa,{children:[a.jsxs(xr,{children:[a.jsx(Cr,{children:"CANTIDAD"}),a.jsx(hs,{type:"number",min:"0",value:k.cantidad_disenador_revision||0,onChange:re=>E(De=>({...De,cantidad_disenador_revision:Number(re.target.value)}))})]}),a.jsxs(xr,{children:[a.jsx(Cr,{children:"FORMA DE ENTREGA"}),a.jsx(hs,{type:"text",value:_.comentario_disenador_revision||"",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Aa,{children:a.jsxs(xr,{children:[a.jsx(Cr,{children:"PLANTA DE CORTE"}),a.jsxs(Ni,{value:k.sala_corte_vendedor||"",onChange:re=>E(De=>({...De,sala_corte_vendedor:re.target.value?Number(re.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),A==null?void 0:A.salas_corte.map(re=>a.jsx("option",{value:re.id,children:re.nombre},re.id))]})]})})]})]})]}),a.jsxs(o9,{children:[a.jsx(Q$,{onClick:()=>j(!1),children:"Cancelar"}),a.jsx(Q$,{$primary:!0,onClick:V,disabled:ge.isPending,children:ge.isPending?"Guardando...":"Guardar"})]})]})})]})}const g_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,x_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,v_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,__=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,f9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,p9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,ni=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,ai=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,m9=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,J$=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,g9=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  min-width: 40px;
  text-align: center;

  ${e=>e.$days>5?`
        background: ${d.colors.danger}15;
        color: ${d.colors.danger};
      `:e.$days>2?`
        background: #ffc10715;
        color: #d9a406;
      `:`
      background: ${d.colors.success}15;
      color: ${d.colors.success};
    `}
`,y_=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Z$=p.button`
  padding: 0.35rem 0.75rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.5rem;

  ${e=>e.$variant==="success"?`
    background: ${d.colors.success};
    color: white;

    &:hover {
      background: #218838;
    }
  `:`
    background: ${d.colors.primary};
    color: white;

    &:hover {
      background: #002d66;
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,x9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,v9=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
`,_9=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,y9=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,b9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,e5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,j9=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,w9=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,b_=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,k9=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  font-style: italic;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function C9({onNavigate:e}){const[t,r]=S.useState(1),[n,i]=S.useState(null),[s,o]=S.useState(null),{data:l,isLoading:c,error:u}=H7(t,20),h=W7(),f=S.useCallback(_=>{h.mutate(_,{onSuccess:()=>{i("Notificacion marcada como leida"),o(null),setTimeout(()=>i(null),3e3)},onError:b=>{o(b.message||"Error al marcar notificacion"),i(null)}})},[h]),m=S.useCallback(_=>{e("gestionar-ot",_)},[e]);if(c)return a.jsxs(g_,{children:[a.jsxs(x_,{children:[a.jsx(v_,{children:"Notificaciones"}),a.jsx(__,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsxs(_9,{children:[a.jsx(y9,{}),a.jsx("span",{children:"Cargando notificaciones..."})]})]});if(u)return a.jsxs(g_,{children:[a.jsxs(x_,{children:[a.jsx(v_,{children:"Notificaciones"}),a.jsx(__,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsx(b_,{$type:"error",children:"Error al cargar notificaciones. Intente nuevamente."})]});const v=(l==null?void 0:l.items)||[],g=(l==null?void 0:l.total_pages)||1,x=(l==null?void 0:l.total)||0;return a.jsxs(g_,{children:[a.jsxs(x_,{children:[a.jsx(v_,{children:"Notificaciones"}),a.jsx(__,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),n&&a.jsx(b_,{$type:"success",children:n}),s&&a.jsx(b_,{$type:"error",children:s}),a.jsxs(w9,{children:["Mostrando ",v.length," de ",x," notificaciones"]}),a.jsx(f9,{children:v.length===0?a.jsxs(x9,{children:[a.jsx(v9,{children:""}),a.jsx("p",{children:"No tienes notificaciones pendientes"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(p9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ni,{children:"OT"}),a.jsx(ni,{children:"Dias"}),a.jsx(ni,{children:"Cliente"}),a.jsx(ni,{children:"Descripcion"}),a.jsx(ni,{children:"Item"}),a.jsx(ni,{children:"Estado"}),a.jsx(ni,{children:"Area"}),a.jsx(ni,{children:"Generador"}),a.jsx(ni,{children:"Motivo"}),a.jsx(ni,{children:"Observacion"}),a.jsx(ni,{children:"Fecha"}),a.jsx(ni,{children:"Acciones"})]})}),a.jsx("tbody",{children:v.map(_=>a.jsxs(m9,{children:[a.jsx(ai,{children:a.jsxs("strong",{children:["#",_.work_order_id]})}),a.jsx(ai,{children:a.jsx(g9,{$days:_.dias_total||0,children:_.dias_total||0})}),a.jsx(ai,{children:a.jsx(y_,{title:_.client_name,children:_.client_name})}),a.jsx(ai,{children:a.jsx(y_,{title:_.ot_descripcion,children:_.ot_descripcion})}),a.jsx(ai,{children:_.item_tipo||"-"}),a.jsx(ai,{children:a.jsx(J$,{$type:"state",children:_.estado})}),a.jsx(ai,{children:_.area&&a.jsx(J$,{$type:"area",children:_.area})}),a.jsx(ai,{children:_.generador_nombre}),a.jsx(ai,{children:a.jsx(y_,{title:_.motivo,children:_.motivo})}),a.jsx(ai,{children:_.observacion&&a.jsx(k9,{title:_.observacion,children:_.observacion})}),a.jsx(ai,{children:_.created_at}),a.jsxs(ai,{children:[a.jsx(Z$,{$variant:"primary",onClick:()=>m(_.work_order_id),title:"Gestionar OT",children:"Gestionar"}),a.jsx(Z$,{$variant:"success",onClick:()=>f(_.id),disabled:h.isPending,title:"Marcar como leida",children:"Leido"})]})]},_.id))})]}),g>1&&a.jsxs(b9,{children:[a.jsx(e5,{disabled:t===1,onClick:()=>r(_=>_-1),children:"Anterior"}),a.jsxs(j9,{children:["Pagina ",t," de ",g]}),a.jsx(e5,{disabled:t===g,onClick:()=>r(_=>_+1),children:"Siguiente"})]})]})})]})}const j_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,w_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,k_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,C_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,t5=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,S9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Ls=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Bs=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,r5=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,n5=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,S_=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"approve":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;case"reject":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover {
            background: ${d.colors.danger};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,a5=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,i5=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,s5=p.p`
  font-size: 1rem;
  margin: 0;
`,$9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,E9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,$_=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,E_=p.span`
  display: block;
  max-width: 200px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,T9=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`;function A9({onNavigate:e}){const[t,r]=S.useState(1),n=20,i=Mr(),{data:s,isLoading:o,error:l}=zt({queryKey:["pendingApproval",t],queryFn:()=>Rn.getPendingApproval(t,n)}),c=Ct({mutationFn:b=>Rn.approve(b),onSuccess:()=>{i.invalidateQueries({queryKey:["pendingApproval"]})}}),u=Ct({mutationFn:b=>Rn.reject(b),onSuccess:()=>{i.invalidateQueries({queryKey:["pendingApproval"]})}}),h=S.useCallback(b=>{window.confirm(`Aprobar OT ${b}?`)&&c.mutate(b)},[c]),f=S.useCallback(b=>{window.confirm(`Rechazar OT ${b}?`)&&u.mutate(b)},[u]),m=S.useCallback(b=>{e("gestionar-ot",b)},[e]),v=b=>b?new Date(b).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(o)return a.jsxs(j_,{children:[a.jsxs(w_,{children:[a.jsx(k_,{children:"OTs por Aprobar"}),a.jsx(C_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx($9,{children:"Cargando..."})]});if(l)return a.jsxs(j_,{children:[a.jsxs(w_,{children:[a.jsx(k_,{children:"OTs por Aprobar"}),a.jsx(C_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(a5,{children:[a.jsx(i5,{children:"!"}),a.jsx(s5,{children:"Error al cargar las OTs pendientes"})]})]});const g=(s==null?void 0:s.items)||[],x=(s==null?void 0:s.total_pages)||1,_=(s==null?void 0:s.total)||0;return a.jsxs(j_,{children:[a.jsxs(w_,{children:[a.jsxs(k_,{children:["OTs por Aprobar (",_,")"]}),a.jsx(C_,{onClick:()=>e("dashboard"),children:"Volver"})]}),g.length===0?a.jsx(t5,{children:a.jsxs(a5,{children:[a.jsx(i5,{children:""}),a.jsx(s5,{children:"No hay OTs pendientes de aprobacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(t5,{children:a.jsxs(S9,{children:[a.jsx("thead",{children:a.jsxs(r5,{children:[a.jsx(Ls,{style:{width:"60px"},children:"OT"}),a.jsx(Ls,{style:{width:"80px"},children:"Creacion"}),a.jsx(Ls,{children:"Creador"}),a.jsx(Ls,{children:"Cliente"}),a.jsx(Ls,{children:"Descripcion"}),a.jsx(Ls,{style:{width:"80px"},children:"Canal"}),a.jsx(Ls,{style:{width:"80px"},children:"Item"}),a.jsx(Ls,{style:{width:"60px"},children:"Estado"}),a.jsx(Ls,{style:{width:"120px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:g.map(b=>a.jsxs(r5,{children:[a.jsx(Bs,{children:a.jsx(n5,{children:b.id})}),a.jsx(Bs,{children:v(b.created_at)}),a.jsx(Bs,{children:a.jsx(E_,{title:b.creador_nombre,children:b.creador_nombre})}),a.jsx(Bs,{children:a.jsx(E_,{title:b.client_name,children:b.client_name})}),a.jsx(Bs,{children:a.jsx(E_,{title:b.descripcion,children:b.descripcion})}),a.jsx(Bs,{children:b.canal||"-"}),a.jsx(Bs,{children:b.item_tipo||"-"}),a.jsx(Bs,{children:a.jsx(n5,{$type:"state",title:b.estado,children:b.estado_abrev})}),a.jsx(Bs,{children:a.jsxs(T9,{children:[a.jsx(S_,{$variant:"view",onClick:()=>m(b.id),title:"Ver OT",children:"Ver"}),a.jsx(S_,{$variant:"approve",onClick:()=>h(b.id),disabled:c.isPending,title:"Aprobar OT",children:""}),a.jsx(S_,{$variant:"reject",onClick:()=>f(b.id),disabled:u.isPending,title:"Rechazar OT",children:""})]})})]},b.id))})]})}),x>1&&a.jsxs(E9,{children:[a.jsx($_,{onClick:()=>r(b=>Math.max(1,b-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,x)},(b,y)=>{const j=Math.max(1,Math.min(t-2,x-4))+y;return j>x?null:a.jsx($_,{$active:j===t,onClick:()=>r(j),children:j},j)}),a.jsx($_,{onClick:()=>r(b=>Math.min(x,b+1)),disabled:t===x,children:"Siguiente"})]})]})]})}const T_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,A_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,F_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,D_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,F9=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 1rem;
  padding: 1rem;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,cm=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,dm=p.label`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,o5=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,l5=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,D9=p.button`
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    opacity: 0.9;
  }
`,P9=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,c5=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,M9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,zi=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ii=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,d5=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,um=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,u5=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"assign":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,h5=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,f5=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,p5=p.p`
  font-size: 1rem;
  margin: 0;
`,O9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,R9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,P_=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,hm=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,N9=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`,z9=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,I9=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  min-width: 400px;
  max-width: 500px;
`,L9=p.h3`
  margin: 0 0 1rem 0;
  font-size: 1.25rem;
  color: ${d.colors.textPrimary};
`,B9=p.p`
  margin: 0 0 1rem 0;
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`,U9=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,V9=p.div`
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
`,m5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function H9({onNavigate:e}){const[t,r]=S.useState(1),[n,i]=S.useState({page:1,page_size:20}),[s,o]=S.useState({}),[l,c]=S.useState(!1),[u,h]=S.useState(null),[f,m]=S.useState(""),v=Mr(),{data:g,isLoading:x,error:_}=zt({queryKey:["pendingAssignment",n],queryFn:()=>r_.getPendingAssignment(n)}),{data:b}=zt({queryKey:["professionals"],queryFn:()=>r_.getProfessionals(),enabled:l}),y=Ct({mutationFn:({otId:G,profesionalId:Y})=>r_.assign(G,Y),onSuccess:()=>{v.invalidateQueries({queryKey:["pendingAssignment"]}),c(!1),h(null),m("")}}),j=S.useCallback(()=>{i({...s,page:1,page_size:20}),r(1)},[s]),k=S.useCallback(()=>{o({}),i({page:1,page_size:20}),r(1)},[]),E=S.useCallback(G=>{r(G),i(Y=>({...Y,page:G}))},[]),A=S.useCallback(G=>{h(G),m(""),c(!0)},[]),w=S.useCallback(()=>{u&&f!==""&&y.mutate({otId:u.id,profesionalId:f})},[u,f,y]),P=S.useCallback(G=>{e("gestionar-ot",G)},[e]),M=G=>G?new Date(G).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",F=G=>G>=7?"danger":G>=3?"warning":"info";if(x)return a.jsxs(T_,{children:[a.jsxs(A_,{children:[a.jsx(F_,{children:"Asignacion de OTs"}),a.jsx(D_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx(O9,{children:"Cargando..."})]});if(_)return a.jsxs(T_,{children:[a.jsxs(A_,{children:[a.jsx(F_,{children:"Asignacion de OTs"}),a.jsx(D_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(h5,{children:[a.jsx(f5,{children:"!"}),a.jsx(p5,{children:"Error al cargar las OTs pendientes de asignacion"})]})]});const D=(g==null?void 0:g.items)||[],W=(g==null?void 0:g.total_pages)||1,B=(g==null?void 0:g.total)||0;return a.jsxs(T_,{children:[a.jsxs(A_,{children:[a.jsxs(F_,{children:["Asignacion de OTs (",B,")"]}),a.jsx(D_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(F9,{children:[a.jsxs(cm,{children:[a.jsx(dm,{children:"Estado Asignacion"}),a.jsxs(o5,{value:s.asignado??"",onChange:G=>o(Y=>({...Y,asignado:G.target.value===""?void 0:G.target.value})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NO",children:"Sin Asignar"}),a.jsx("option",{value:"SI",children:"Asignados"})]})]}),a.jsxs(cm,{children:[a.jsx(dm,{children:"Tipo Solicitud"}),a.jsxs(o5,{value:s.tipo_solicitud??"",onChange:G=>o(Y=>({...Y,tipo_solicitud:G.target.value||void 0})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NUEVO",children:"Nuevo"}),a.jsx("option",{value:"REPETICION",children:"Repeticion"}),a.jsx("option",{value:"MODIFICACION",children:"Modificacion"})]})]}),a.jsxs(cm,{children:[a.jsx(dm,{children:"Desde"}),a.jsx(l5,{type:"date",value:s.date_desde??"",onChange:G=>o(Y=>({...Y,date_desde:G.target.value||void 0}))})]}),a.jsxs(cm,{children:[a.jsx(dm,{children:"Hasta"}),a.jsx(l5,{type:"date",value:s.date_hasta??"",onChange:G=>o(Y=>({...Y,date_hasta:G.target.value||void 0}))})]}),a.jsx(D9,{onClick:j,children:"Filtrar"}),a.jsx(P9,{onClick:k,children:"Limpiar"})]}),D.length===0?a.jsx(c5,{children:a.jsxs(h5,{children:[a.jsx(f5,{children:""}),a.jsx(p5,{children:"No hay OTs pendientes de asignacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(c5,{children:a.jsxs(M9,{children:[a.jsx("thead",{children:a.jsxs(d5,{children:[a.jsx(zi,{style:{width:"60px"},children:"OT"}),a.jsx(zi,{style:{width:"80px"},children:"Creacion"}),a.jsx(zi,{children:"Cliente"}),a.jsx(zi,{children:"Vendedor"}),a.jsx(zi,{style:{width:"90px"},children:"Tipo"}),a.jsx(zi,{style:{width:"80px"},children:"Canal"}),a.jsx(zi,{children:"Jerarquia"}),a.jsx(zi,{style:{width:"80px"},children:"CAD"}),a.jsx(zi,{children:"Profesional"}),a.jsx(zi,{style:{width:"60px"},children:"Dias"}),a.jsx(zi,{style:{width:"100px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(G=>a.jsxs(d5,{children:[a.jsx(Ii,{children:a.jsx(um,{children:G.id})}),a.jsx(Ii,{children:M(G.created_at)}),a.jsx(Ii,{children:a.jsx(hm,{title:G.client_name,children:G.client_name})}),a.jsx(Ii,{children:a.jsx(hm,{title:G.vendedor_nombre,children:G.vendedor_nombre})}),a.jsx(Ii,{children:a.jsx(um,{$type:"info",children:G.tipo_solicitud})}),a.jsx(Ii,{children:G.canal||"-"}),a.jsx(Ii,{children:a.jsx(hm,{title:`${G.jerarquia_1||""} > ${G.jerarquia_2||""} > ${G.jerarquia_3||""}`,children:G.jerarquia_1||"-"})}),a.jsx(Ii,{children:G.cad||"-"}),a.jsx(Ii,{children:a.jsx(hm,{title:G.profesional_asignado||"Sin asignar",children:G.profesional_asignado||a.jsx(um,{$type:"warning",children:"Sin asignar"})})}),a.jsx(Ii,{children:a.jsxs(um,{$type:F(G.dias_sin_asignar),children:[G.dias_sin_asignar,"d"]})}),a.jsx(Ii,{children:a.jsxs(N9,{children:[a.jsx(u5,{$variant:"view",onClick:()=>P(G.id),title:"Ver OT",children:"Ver"}),!G.profesional_asignado&&a.jsx(u5,{$variant:"assign",onClick:()=>A(G),title:"Asignar Profesional",children:"Asignar"})]})})]},G.id))})]})}),W>1&&a.jsxs(R9,{children:[a.jsx(P_,{onClick:()=>E(Math.max(1,t-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,W)},(G,Y)=>{const ae=Math.max(1,Math.min(t-2,W-4))+Y;return ae>W?null:a.jsx(P_,{$active:ae===t,onClick:()=>E(ae),children:ae},ae)}),a.jsx(P_,{onClick:()=>E(Math.min(W,t+1)),disabled:t===W,children:"Siguiente"})]})]}),l&&u&&a.jsx(z9,{onClick:()=>c(!1),children:a.jsxs(I9,{onClick:G=>G.stopPropagation(),children:[a.jsx(L9,{children:"Asignar Profesional"}),a.jsxs(B9,{children:["OT #",u.id," - ",u.client_name]}),a.jsxs(U9,{value:f,onChange:G=>m(G.target.value?Number(G.target.value):""),children:[a.jsx("option",{value:"",children:"Seleccione un profesional..."}),b==null?void 0:b.map(G=>a.jsxs("option",{value:G.id,children:[G.nombre," (",G.rol,")"]},G.id))]}),a.jsxs(V9,{children:[a.jsx(m5,{onClick:()=>c(!1),children:"Cancelar"}),a.jsx(m5,{$primary:!0,onClick:w,disabled:!f||y.isPending,children:y.isPending?"Asignando...":"Asignar"})]})]})})]})}const M_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,O_=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,R_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,W9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,G9=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,Sh=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,$h=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Eh=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,q9=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,fm=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover:not(:disabled) { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover:not(:disabled) { background: #218838; }
        `;case"disabled":return`
          background: #ccc;
          color: #666;
          border-color: #ccc;
          cursor: not-allowed;
          opacity: 0.5;
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover:not(:disabled) {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,K9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,X9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,tl=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,g5=p(tl)`
  text-align: center;
  width: 100px;
`,rl=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,x5=p(rl)`
  text-align: center;
`,Y9=p.tr`
  ${e=>e.$highlighted&&`
    background-color: #d1f3d1;
  `}

  &:hover {
    background: ${e=>e.$highlighted?"#c1e3c1":d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,pm=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,mm=p.input`
  width: 16px;
  height: 16px;
  cursor: pointer;
`,Q9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,J9=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Z9=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,eU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,v5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,tU=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,rU=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,nU=p.span`
  color: ${d.colors.textPrimary};
  font-size: 0.875rem;
`,_5=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`;function aU({onNavigate:e}){const[t,r]=S.useState({page:1,page_size:20}),[n,i]=S.useState(""),[s,o]=S.useState(""),[l,c]=S.useState(""),[u,h]=S.useState(""),[f,m]=S.useState(""),[v,g]=S.useState({}),[x,_]=S.useState(null),{data:b,isLoading:y,error:j}=zt({queryKey:["ots-cotizables",t],queryFn:()=>Rn.list(t)}),k=S.useMemo(()=>b!=null&&b.items?b.items:[],[b==null?void 0:b.items]),E=S.useCallback(q=>{q.preventDefault();const z={...t,page:1};n&&(z.date_desde=n),s&&(z.date_hasta=s),l&&(z.id_ot=parseInt(l,10)),u&&(z.cad=u),f&&(z.descripcion=f),r(z),g({})},[t,n,s,l,u,f]),A=S.useCallback(()=>{i(""),o(""),c(""),h(""),m(""),r({page:1,page_size:20}),g({})},[]),w=S.useCallback((q,z)=>{g(ie=>{const he=ie[q]||{corrugado:!1,esquinero:!1};return{...ie,[q]:{...he,[z]:!he[z]}}})},[]),P=S.useCallback((q,z)=>{g(ie=>{const he={...ie};return k.forEach(O=>{var R,I;he[O.id]={...he[O.id],corrugado:q==="corrugado"?z:((R=he[O.id])==null?void 0:R.corrugado)||!1,esquinero:q==="esquinero"?z:((I=he[O.id])==null?void 0:I.esquinero)||!1}}),he})},[k]),M=S.useCallback(()=>{const q=Object.entries(v).filter(([z,ie])=>ie.corrugado||ie.esquinero).map(([z,ie])=>({ot_id:parseInt(z,10),tipo_corrugado:ie.corrugado,tipo_esquinero:ie.esquinero}));q.length!==0&&(console.log("Cotizar OTs:",q),_(`Se generar cotizacin para ${q.length} OT(s)`),setTimeout(()=>_(null),3e3))},[v]),F=S.useCallback(q=>{r(z=>({...z,page:q}))},[]),D=S.useMemo(()=>{let q=0,z=0;return Object.values(v).forEach(ie=>{ie.corrugado&&q++,ie.esquinero&&z++}),{corrugadoCount:q,esquineroCount:z,total:q+z}},[v]),W=D.total>0,B=k.length>0&&k.every(q=>{var z;return(z=v[q.id])==null?void 0:z.corrugado}),G=k.length>0&&k.every(q=>{var z;return(z=v[q.id])==null?void 0:z.esquinero}),Y=q=>q?new Date(q).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(y)return a.jsxs(M_,{children:[a.jsx(O_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(R_,{children:"Lista de OT para Cotizar"}),a.jsxs(J9,{children:[a.jsx(Z9,{}),a.jsx("span",{children:"Cargando OTs..."})]})]});if(j)return a.jsxs(M_,{children:[a.jsx(O_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(R_,{children:"Lista de OT para Cotizar"}),a.jsxs(_5,{$type:"error",children:["Error al cargar OTs: ",j.message]})]});const ae=(b==null?void 0:b.total_pages)||1,U=(b==null?void 0:b.page)||1;return a.jsxs(M_,{children:[a.jsx(O_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(R_,{children:"Lista de OT para Cotizar"}),x&&a.jsx(_5,{$type:"success",children:x}),a.jsx(W9,{children:a.jsxs("form",{onSubmit:E,children:[a.jsxs(G9,{children:[a.jsxs(Sh,{children:[a.jsx($h,{children:"Desde"}),a.jsx(Eh,{type:"date",value:n,onChange:q=>i(q.target.value)})]}),a.jsxs(Sh,{children:[a.jsx($h,{children:"Hasta"}),a.jsx(Eh,{type:"date",value:s,onChange:q=>o(q.target.value)})]}),a.jsxs(Sh,{children:[a.jsx($h,{children:"OT"}),a.jsx(Eh,{type:"number",placeholder:"ID...",value:l,onChange:q=>c(q.target.value)})]}),a.jsxs(Sh,{children:[a.jsx($h,{children:"CAD"}),a.jsx(Eh,{type:"text",placeholder:"CAD...",value:u,onChange:q=>h(q.target.value)})]}),a.jsxs(Sh,{children:[a.jsx($h,{children:"Descripcin"}),a.jsx(Eh,{type:"text",placeholder:"Descripcin...",value:f,onChange:q=>m(q.target.value)})]})]}),a.jsxs(q9,{children:[a.jsx(fm,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(fm,{type:"button",onClick:A,children:"Limpiar"}),a.jsx(fm,{type:"button",$variant:W?"success":"disabled",disabled:!W,onClick:M,children:"Cotizar"})]})]})}),W&&a.jsxs(rU,{children:[a.jsxs(nU,{children:["Seleccionados: ",D.corrugadoCount," Corrugado, ",D.esquineroCount," Esquinero"]}),a.jsx(fm,{onClick:()=>g({}),children:"Limpiar Seleccin"})]}),a.jsx(K9,{children:k.length===0?a.jsx(Q9,{children:a.jsx("p",{children:"No hay OTs disponibles para cotizar"})}):a.jsxs(a.Fragment,{children:[a.jsxs(X9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(tl,{children:"OT"}),a.jsx(tl,{children:"Creacin"}),a.jsx(tl,{children:"Creador"}),a.jsx(tl,{children:"Cliente"}),a.jsx(tl,{children:"Descripcin"}),a.jsx(tl,{children:"CAD"}),a.jsx(tl,{children:"Item"}),a.jsxs(g5,{children:["Tipo Corrugado",a.jsx("br",{}),a.jsx(mm,{type:"checkbox",checked:B,onChange:q=>P("corrugado",q.target.checked)})]}),a.jsxs(g5,{children:["Tipo Esquinero",a.jsx("br",{}),a.jsx(mm,{type:"checkbox",checked:G,onChange:q=>P("esquinero",q.target.checked)})]})]})}),a.jsx("tbody",{children:k.map(q=>{var z,ie;return a.jsxs(Y9,{children:[a.jsx(rl,{children:a.jsx("strong",{children:q.id})}),a.jsx(rl,{children:Y(q.created_at)}),a.jsx(rl,{children:a.jsx(pm,{title:q.creador_nombre,children:q.creador_nombre||"-"})}),a.jsx(rl,{children:a.jsx(pm,{title:q.client_name,children:q.client_name||"-"})}),a.jsx(rl,{children:a.jsx(pm,{title:q.descripcion,children:q.descripcion||"-"})}),a.jsx(rl,{children:a.jsx(pm,{title:q.cad||"-",children:q.cad||"-"})}),a.jsx(rl,{children:q.item_tipo||"-"}),a.jsx(x5,{children:a.jsx(mm,{type:"checkbox",checked:((z=v[q.id])==null?void 0:z.corrugado)||!1,onChange:()=>w(q.id,"corrugado")})}),a.jsx(x5,{children:a.jsx(mm,{type:"checkbox",checked:((ie=v[q.id])==null?void 0:ie.esquinero)||!1,onChange:()=>w(q.id,"esquinero")})})]},q.id)})})]}),ae>1&&a.jsxs(eU,{children:[a.jsx(v5,{disabled:U===1,onClick:()=>F(U-1),children:"Anterior"}),a.jsxs(tU,{children:["Pgina ",U," de ",ae]}),a.jsx(v5,{disabled:U===ae,onClick:()=>F(U+1),children:"Siguiente"})]})]})})]})}const iU=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,sU=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,oU=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,lU=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 2rem;
`,N_=p.button`
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"white"};
  border: 2px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;

  &:hover {
    border-color: ${d.colors.primary};
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
`,z_=p.div`
  font-size: 2rem;
  margin-bottom: 0.5rem;
`,I_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`,L_=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,B_=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,U_=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,V_=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,H_=p.div`
  padding: 1rem;
`,y5=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Li=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ii=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Ql=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,gm=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,cU=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,dU=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,uU=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,hU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,b5=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,fU=p.div`
  background: ${d.colors.warning}10;
  border: 1px solid ${d.colors.warning}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,pU=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,mU=[{id:"bct",label:"BCT (lbf)"},{id:"ect",label:"ECT (lb/in)"},{id:"bct_humedo",label:"BCT en Humedo (lbf)"},{id:"flat",label:"Flat Crush (lb/in)"},{id:"humedad",label:"Humedad (%)"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley"},{id:"espesor",label:"Espesor (mm)"},{id:"cera",label:"Cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley"},{id:"flexion_fondo",label:"Flexion de Fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)"},{id:"composicion_papeles",label:"Composicion Papeles"},{id:"cobb_interno",label:"Cobb Interno"},{id:"cobb_externo",label:"Cobb Externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos"},{id:"medidas",label:"Medidas"},{id:"impresion",label:"Impresion"}];function gU({onNavigate:e}){const[t,r]=S.useState(null),[n,i]=S.useState({client_id:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]}),s=S.useCallback((u,h)=>{i(f=>({...f,[u]:h}))},[]),o=S.useCallback(u=>{i(h=>({...h,ensayos_selected:h.ensayos_selected.includes(u)?h.ensayos_selected.filter(f=>f!==u):[...h.ensayos_selected,u]}))},[]),l=S.useCallback(()=>{console.log("Submit special OT:",{type:t,data:n}),alert("Funcionalidad en desarrollo. Datos en consola.")},[t,n]),c=()=>{switch(t){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return a.jsxs(iU,{children:[a.jsx(sU,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(oU,{children:"Crear OT Especial"}),a.jsx(fU,{children:a.jsx(pU,{children:"Seleccione el tipo de OT especial que desea crear. Estos tipos tienen campos especificos para el analisis de productos de la competencia (Estudio Benchmarking), especificaciones tecnicas detalladas (Ficha Tecnica) o procesos de licitacion."})}),a.jsxs(lU,{children:[a.jsxs(N_,{$active:t==="estudio-bench",onClick:()=>r("estudio-bench"),children:[a.jsx(z_,{children:""}),a.jsx(I_,{children:"Estudio Benchmarking"}),a.jsx(L_,{children:"Analisis de productos de la competencia con ensayos de laboratorio"})]}),a.jsxs(N_,{$active:t==="ficha-tecnica",onClick:()=>r("ficha-tecnica"),children:[a.jsx(z_,{children:""}),a.jsx(I_,{children:"Ficha Tecnica"}),a.jsx(L_,{children:"Especificaciones tecnicas detalladas del producto"})]}),a.jsxs(N_,{$active:t==="licitacion",onClick:()=>r("licitacion"),children:[a.jsx(z_,{children:""}),a.jsx(I_,{children:"Licitacion"}),a.jsx(L_,{children:"OTs para procesos de licitacion con requerimientos especiales"})]})]}),t&&a.jsxs(a.Fragment,{children:[a.jsxs(B_,{children:[a.jsx(U_,{children:a.jsxs(V_,{children:["Datos Comerciales - ",c()]})}),a.jsx(H_,{children:a.jsxs(y5,{children:[a.jsxs(Li,{children:[a.jsx(ii,{children:"Cliente *"}),a.jsx(gm,{value:n.client_id,onChange:u=>s("client_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Descripcion *"}),a.jsx(Ql,{type:"text",value:n.descripcion,onChange:u=>s("descripcion",u.target.value),maxLength:40})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Codigo Producto"}),a.jsx(Ql,{type:"text",value:n.codigo_producto,onChange:u=>s("codigo_producto",u.target.value)})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Tipo de Solicitud"}),a.jsxs(gm,{value:n.tipo_solicitud,onChange:u=>s("tipo_solicitud",u.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"})]})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Canal"}),a.jsx(gm,{value:n.canal_id,onChange:u=>s("canal_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Jerarquia 1"}),a.jsx(gm,{value:n.hierarchy_id,onChange:u=>s("hierarchy_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Nombre Contacto"}),a.jsx(Ql,{type:"text",value:n.nombre_contacto,onChange:u=>s("nombre_contacto",u.target.value)})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Email Contacto"}),a.jsx(Ql,{type:"email",value:n.email_contacto,onChange:u=>s("email_contacto",u.target.value)})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Telefono Contacto"}),a.jsx(Ql,{type:"text",value:n.telefono_contacto,onChange:u=>s("telefono_contacto",u.target.value)})]})]})})]}),t==="estudio-bench"&&a.jsxs(B_,{children:[a.jsx(U_,{children:a.jsx(V_,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(H_,{children:[a.jsxs(y5,{children:[a.jsxs(Li,{children:[a.jsx(ii,{children:"Cantidad de Items"}),a.jsx(Ql,{type:"number",min:"1",value:n.cantidad_estudio_bench,onChange:u=>s("cantidad_estudio_bench",u.target.value)})]}),a.jsxs(Li,{children:[a.jsx(ii,{children:"Fecha Maxima Entrega"}),a.jsx(Ql,{type:"date",value:n.fecha_maxima_entrega_estudio,onChange:u=>s("fecha_maxima_entrega_estudio",u.target.value)})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(ii,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(dU,{children:mU.map(u=>a.jsxs(uU,{children:[a.jsx("input",{type:"checkbox",checked:n.ensayos_selected.includes(u.id),onChange:()=>o(u.id)}),u.label]},u.id))})]})]})]}),a.jsxs(B_,{children:[a.jsx(U_,{children:a.jsx(V_,{children:"Observaciones"})}),a.jsx(H_,{children:a.jsx(cU,{value:n.observacion,onChange:u=>s("observacion",u.target.value),placeholder:"Ingrese observaciones adicionales..."})})]}),a.jsxs(hU,{children:[a.jsx(b5,{onClick:()=>e("dashboard"),children:"Cancelar"}),a.jsx(b5,{$variant:"success",onClick:l,children:"Guardar OT"})]})]})]})}const W_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,j5=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,xU=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`,vU=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,_U=p.span`
  background: ${d.colors.primary};
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.9rem;
  font-weight: 600;
`,yU=p.span`
  background: ${({$type:e})=>{switch(e){case"estudio-bench":return`${d.colors.info}20`;case"ficha-tecnica":return`${d.colors.success}20`;case"licitacion":return`${d.colors.warning}20`;default:return`${d.colors.textSecondary}20`}}};
  color: ${({$type:e})=>{switch(e){case"estudio-bench":return d.colors.info;case"ficha-tecnica":return d.colors.success;case"licitacion":return d.colors.warning;default:return d.colors.textSecondary}}};
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,Th=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,Ah=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,Fh=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Dh=p.div`
  padding: 1rem;
`,xm=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Fa=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,da=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,si=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,bU=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,jU=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,wU=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,kU=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,CU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,G_=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,SU=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  color: ${d.colors.textSecondary};
  font-size: 1rem;
`,w5=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}30;
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;
  color: ${d.colors.danger};
`,$U=p.div`
  background: ${d.colors.success}15;
  border: 1px solid ${d.colors.success}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
  color: ${d.colors.success};
  text-align: center;
`,q_=[{id:"bct",label:"BCT (lbf)",field:"ensayo_bct"},{id:"ect",label:"ECT (lb/in)",field:"ensayo_ect"},{id:"bct_humedo",label:"BCT en Humedo (lbf)",field:"ensayo_bct_humedo"},{id:"flat",label:"Flat Crush (lb/in)",field:"ensayo_flat"},{id:"humedad",label:"Humedad (%)",field:"ensayo_humedad"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley",field:"ensayo_porosidad_ext"},{id:"espesor",label:"Espesor (mm)",field:"ensayo_espesor"},{id:"cera",label:"Cera",field:"ensayo_cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley",field:"ensayo_porosidad_int"},{id:"flexion_fondo",label:"Flexion de Fondo",field:"ensayo_flexion_fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)",field:"ensayo_gramaje"},{id:"composicion_papeles",label:"Composicion Papeles",field:"ensayo_composicion_papeles"},{id:"cobb_interno",label:"Cobb Interno",field:"ensayo_cobb_interno"},{id:"cobb_externo",label:"Cobb Externo",field:"ensayo_cobb_externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos",field:"ensayo_flexion_4_puntos"},{id:"medidas",label:"Medidas",field:"ensayo_medidas"},{id:"impresion",label:"Impresion",field:"ensayo_impresion"}];function EU({otId:e,onNavigate:t}){const[r,n]=S.useState(!0),[i,s]=S.useState(!1),[o,l]=S.useState(null),[c,u]=S.useState(null),[h,f]=S.useState(null),[m,v]=S.useState({client_id:"",client_name:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]});S.useEffect(()=>{(async()=>{try{n(!0),l(null);const j=await Rn.get(e),k=j.tipo_solicitud;let E=null;k===7||j.is_estudio_bench?E="estudio-bench":k===8||j.is_ficha_tecnica?E="ficha-tecnica":(k===9||j.is_licitacion)&&(E="licitacion"),f(E);const A=[];q_.forEach(w=>{(j[w.field]===1||j[w.field]===!0)&&A.push(w.id)}),v({client_id:String(j.client_id||""),client_name:String(j.client_name||""),descripcion:String(j.descripcion||""),codigo_producto:String(j.codigo_producto||""),tipo_solicitud:String(j.tipo_solicitud||""),canal_id:String(j.canal_id||""),hierarchy_id:String(j.hierarchy_id||""),subhierarchy_id:String(j.subhierarchy_id||""),subsubhierarchy_id:String(j.subsubhierarchy_id||""),nombre_contacto:String(j.nombre_contacto||""),email_contacto:String(j.email_contacto||""),telefono_contacto:String(j.telefono_contacto||""),observacion:String(j.observacion||""),cantidad_estudio_bench:String(j.cantidad_estudio_bench||j.cantidad||""),fecha_maxima_entrega_estudio:String(j.fecha_maxima_entrega||""),ensayos_selected:A})}catch(j){console.error("Error loading OT:",j),l("Error al cargar los datos de la OT")}finally{n(!1)}})()},[e]);const g=S.useCallback((y,j)=>{v(k=>({...k,[y]:j})),u(null)},[]),x=S.useCallback(y=>{v(j=>({...j,ensayos_selected:j.ensayos_selected.includes(y)?j.ensayos_selected.filter(k=>k!==y):[...j.ensayos_selected,y]})),u(null)},[]),_=S.useCallback(async()=>{try{s(!0),l(null),u(null);const y={descripcion:m.descripcion,codigo_producto:m.codigo_producto||null,nombre_contacto:m.nombre_contacto||null,email_contacto:m.email_contacto||null,telefono_contacto:m.telefono_contacto||null,observacion:m.observacion||null};h==="estudio-bench"&&(y.cantidad=m.cantidad_estudio_bench?parseInt(m.cantidad_estudio_bench):null,y.fecha_maxima_entrega=m.fecha_maxima_entrega_estudio||null,q_.forEach(j=>{y[j.field]=m.ensayos_selected.includes(j.id)?1:0})),await Rn.update(e,y),u("OT actualizada correctamente"),window.scrollTo({top:0,behavior:"smooth"})}catch(y){console.error("Error updating OT:",y),l("Error al guardar los cambios")}finally{s(!1)}},[e,h,m]),b=()=>{switch(h){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return r?a.jsx(W_,{children:a.jsx(SU,{children:"Cargando datos de la OT..."})}):o&&!m.client_id?a.jsxs(W_,{children:[a.jsx(j5,{onClick:()=>t("dashboard"),children:" Volver"}),a.jsxs(w5,{children:[a.jsx("p",{children:o}),a.jsx(G_,{$variant:"primary",onClick:()=>t("dashboard"),style:{marginTop:"1rem"},children:"Volver al Dashboard"})]})]}):a.jsxs(W_,{children:[a.jsx(j5,{onClick:()=>t("work-order-detail",e),children:" Volver al Detalle"}),a.jsx(xU,{children:a.jsx("div",{children:a.jsxs(vU,{children:["Editar OT",a.jsxs(_U,{style:{marginLeft:"0.75rem"},children:["#",e]}),h&&a.jsx(yU,{$type:h,children:b()})]})})}),c&&a.jsx($U,{children:c}),o&&a.jsx(w5,{style:{marginBottom:"1rem"},children:o}),a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos Comerciales"})}),a.jsx(Dh,{children:a.jsxs(xm,{children:[a.jsxs(Fa,{children:[a.jsx(da,{children:"Cliente"}),a.jsx(si,{type:"text",value:m.client_name,disabled:!0,style:{background:d.colors.bgLight}})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Descripcion *"}),a.jsx(si,{type:"text",value:m.descripcion,onChange:y=>g("descripcion",y.target.value),maxLength:40,disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Codigo Producto"}),a.jsx(si,{type:"text",value:m.codigo_producto,onChange:y=>g("codigo_producto",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Tipo de Solicitud"}),a.jsxs(bU,{value:m.tipo_solicitud,disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"}),a.jsx("option",{value:"7",children:"Estudio Benchmarking"}),a.jsx("option",{value:"8",children:"Ficha Tecnica"}),a.jsx("option",{value:"9",children:"Licitacion"})]})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Nombre Contacto"}),a.jsx(si,{type:"text",value:m.nombre_contacto,onChange:y=>g("nombre_contacto",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Email Contacto"}),a.jsx(si,{type:"email",value:m.email_contacto,onChange:y=>g("email_contacto",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Telefono Contacto"}),a.jsx(si,{type:"text",value:m.telefono_contacto,onChange:y=>g("telefono_contacto",y.target.value),disabled:i})]})]})})]}),h==="estudio-bench"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(Dh,{children:[a.jsxs(xm,{children:[a.jsxs(Fa,{children:[a.jsx(da,{children:"Cantidad de Items"}),a.jsx(si,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:y=>g("cantidad_estudio_bench",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Fecha Maxima Entrega"}),a.jsx(si,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:y=>g("fecha_maxima_entrega_estudio",y.target.value),disabled:i})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(da,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(wU,{children:q_.map(y=>a.jsxs(kU,{children:[a.jsx("input",{type:"checkbox",checked:m.ensayos_selected.includes(y.id),onChange:()=>x(y.id),disabled:i}),y.label]},y.id))})]})]})]}),h==="ficha-tecnica"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Ficha Tecnica"})}),a.jsx(Dh,{children:a.jsxs(xm,{children:[a.jsxs(Fa,{children:[a.jsx(da,{children:"Cantidad"}),a.jsx(si,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:y=>g("cantidad_estudio_bench",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Fecha Maxima Entrega"}),a.jsx(si,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:y=>g("fecha_maxima_entrega_estudio",y.target.value),disabled:i})]})]})})]}),h==="licitacion"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Licitacion"})}),a.jsx(Dh,{children:a.jsxs(xm,{children:[a.jsxs(Fa,{children:[a.jsx(da,{children:"Cantidad"}),a.jsx(si,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:y=>g("cantidad_estudio_bench",y.target.value),disabled:i})]}),a.jsxs(Fa,{children:[a.jsx(da,{children:"Fecha Maxima Entrega"}),a.jsx(si,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:y=>g("fecha_maxima_entrega_estudio",y.target.value),disabled:i})]})]})})]}),a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Observaciones"})}),a.jsx(Dh,{children:a.jsx(jU,{value:m.observacion,onChange:y=>g("observacion",y.target.value),placeholder:"Ingrese observaciones adicionales...",disabled:i})})]}),a.jsxs(CU,{children:[a.jsx(G_,{onClick:()=>t("work-order-detail",e),disabled:i,children:"Cancelar"}),a.jsx(G_,{$variant:"success",onClick:_,disabled:i,children:i?"Guardando...":"Guardar Cambios"})]})]})}const TU=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,AU=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,FU=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,DU=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,PU=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,Ph=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Mh=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,K_=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,k5=p.select`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,MU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,X_=p.button`
  padding: 0.4rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"outline":return`
          background: transparent;
          border: 1px solid ${d.colors.primary};
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}10; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,OU=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,RU=p.table`
  width: 100%;
  border-collapse: collapse;
`,Oo=p.th`
  padding: 0.75rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`,Ro=p.td`
  padding: 0.75rem;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: top;
`,C5=p.span`
  display: inline-block;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$type:e})=>e==="old"?`${d.colors.danger}10`:`${d.colors.success}10`};
  color: ${({$type:e})=>e==="old"?d.colors.danger:d.colors.success};
`,Y_=p.span`
  color: ${d.colors.textSecondary};
  font-style: italic;
  font-size: 0.75rem;
`,NU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,zU=p.div`
  width: 24px;
  height: 24px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,IU=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,LU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,Q_=p.button`
  padding: 0.4rem 0.75rem;
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.8rem;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,BU=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${({$type:e})=>{switch(e){case"Modificacin":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"Insercion":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"Eliminacion":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary};`}}}
`,UU=[{id:1,work_order_id:1234,created_at:"2025-12-20 10:30:00",observacion:"Actualizacion de datos comerciales",operacion:"Modificacin",user_data:{nombre:"Juan",apellido:"Perez"},datos_modificados:[{texto:"Cliente",antiguo_valor:{descripcion:"Cliente Antiguo"},nuevo_valor:{descripcion:"Cliente Nuevo"}},{texto:"Descripcion",antiguo_valor:{descripcion:"Desc 1"},nuevo_valor:{descripcion:"Desc Actualizada"}}]},{id:2,work_order_id:1234,created_at:"2025-12-19 15:45:00",observacion:"Cambio de estado",operacion:"Modificacin",user_data:{nombre:"Maria",apellido:"Garcia"},datos_modificados:[{texto:"Estado",antiguo_valor:{descripcion:"En Proceso"},nuevo_valor:{descripcion:"Completado"}}]},{id:3,work_order_id:1234,created_at:"2025-12-18 09:00:00",observacion:"Creacion de OT",operacion:"Insercion",user_data:{nombre:"Pedro",apellido:"Lopez"},datos_modificados:[{texto:"OT Creada",valor:{descripcion:"Nueva OT #1234"}}]}];function VU({otId:e,onNavigate:t}){const[r,n]=S.useState(""),[i,s]=S.useState(""),[o,l]=S.useState(""),[c,u]=S.useState(""),[h,f]=S.useState(""),[m,v]=S.useState(1),{data:g,isLoading:x}=zt({queryKey:["ot-log",e,r,i,o,c,h,m],queryFn:async()=>(await new Promise(E=>setTimeout(E,500)),UU)}),_=S.useCallback(E=>{E.preventDefault(),v(1)},[]),b=S.useCallback(()=>{n(""),s(""),l(""),u(""),f(""),v(1)},[]),y=S.useCallback(()=>{console.log("Exporting log for OT:",e),alert("Exportacion en desarrollo")},[e]),j=S.useMemo(()=>g?g.flatMap(E=>E.datos_modificados.map((A,w)=>{var P,M,F;return{...E,modIndex:w,campo:A.texto,valorAntiguo:E.operacion==="Modificacin"?((P=A.antiguo_valor)==null?void 0:P.descripcion)||"":"N/A",valorNuevo:E.operacion==="Modificacin"?((M=A.nuevo_valor)==null?void 0:M.descripcion)||"":((F=A.valor)==null?void 0:F.descripcion)||""}})):[],[g]),k=E=>E?new Date(E).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return a.jsxs(TU,{children:[a.jsxs(AU,{onClick:()=>t("gestionar-ot",e),children:[" Volver a OT #",e]}),a.jsxs(FU,{children:["Historial de Cambios - OT #",e]}),a.jsx(DU,{children:a.jsxs("form",{onSubmit:_,children:[a.jsxs(PU,{children:[a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Desde"}),a.jsx(K_,{type:"date",value:r,onChange:E=>n(E.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Hasta"}),a.jsx(K_,{type:"date",value:i,onChange:E=>s(E.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"ID Cambio"}),a.jsx(K_,{type:"number",placeholder:"ID...",value:o,onChange:E=>l(E.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Campo Modificado"}),a.jsxs(k5,{value:c,onChange:E=>u(E.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"cliente",children:"Cliente"}),a.jsx("option",{value:"descripcion",children:"Descripcion"}),a.jsx("option",{value:"estado",children:"Estado"}),a.jsx("option",{value:"area",children:"Area"})]})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Usuario"}),a.jsx(k5,{value:h,onChange:E=>f(E.target.value),children:a.jsx("option",{value:"",children:"Todos"})})]})]}),a.jsxs(MU,{children:[a.jsx(X_,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(X_,{type:"button",onClick:b,children:"Limpiar"}),a.jsx(X_,{type:"button",$variant:"outline",onClick:y,children:"Exportar"})]})]})}),a.jsx(OU,{children:x?a.jsxs(NU,{children:[a.jsx(zU,{}),a.jsx("span",{children:"Cargando historial..."})]}):j.length===0?a.jsx(IU,{children:a.jsx("p",{children:"No hay registros de cambios para esta OT"})}):a.jsxs(a.Fragment,{children:[a.jsxs(RU,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Oo,{style:{width:"8%"},children:"OT"}),a.jsx(Oo,{style:{width:"8%"},children:"ID Cambio"}),a.jsx(Oo,{style:{width:"12%"},children:"Fecha"}),a.jsx(Oo,{style:{width:"15%"},children:"Descripcion"}),a.jsx(Oo,{style:{width:"12%"},children:"Campo"}),a.jsx(Oo,{style:{width:"15%"},children:"Valor Antiguo"}),a.jsx(Oo,{style:{width:"15%"},children:"Valor Nuevo"}),a.jsx(Oo,{style:{width:"15%"},children:"Usuario"})]})}),a.jsx("tbody",{children:j.map(E=>a.jsxs("tr",{children:[a.jsx(Ro,{children:E.work_order_id}),a.jsx(Ro,{children:E.id}),a.jsx(Ro,{children:k(E.created_at)}),a.jsxs(Ro,{children:[a.jsx(BU,{$type:E.operacion,children:E.operacion}),a.jsx("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem"},children:E.observacion})]}),a.jsx(Ro,{children:E.campo}),a.jsx(Ro,{children:E.valorAntiguo==="N/A"?a.jsx(Y_,{children:"N/A"}):E.valorAntiguo?a.jsx(C5,{$type:"old",children:E.valorAntiguo}):a.jsx(Y_,{children:"Campo Vacio"})}),a.jsx(Ro,{children:E.valorNuevo?a.jsx(C5,{$type:"new",children:E.valorNuevo}):a.jsx(Y_,{children:"Campo Vacio"})}),a.jsxs(Ro,{children:[E.user_data.nombre," ",E.user_data.apellido]})]},`${E.id}-${E.modIndex}`))})]}),a.jsxs(LU,{children:[a.jsx(Q_,{disabled:m===1,onClick:()=>v(E=>E-1),children:"Anterior"}),a.jsx(Q_,{$active:!0,children:m}),a.jsx(Q_,{onClick:()=>v(E=>E+1),children:"Siguiente"})]})]})})]})}function HU(e={}){return zt({queryKey:["clients",e],queryFn:()=>Hl.list(e)})}function WU(e){return zt({queryKey:["client",e],queryFn:()=>Hl.get(e),enabled:!!e})}function GU(){return zt({queryKey:["clasificaciones"],queryFn:()=>Hl.getClasificaciones(),staleTime:1e3*60*10})}function qU(){const e=Mr();return Ct({mutationFn:t=>Hl.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]})}})}function KU(){const e=Mr();return Ct({mutationFn:({id:t,data:r})=>Hl.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r.id]})}})}function XU(){const e=Mr();return Ct({mutationFn:t=>Hl.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function YU(){const e=Mr();return Ct({mutationFn:t=>Hl.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function QU(e={}){return zt({queryKey:["users",e],queryFn:()=>gd.list(e)})}function JU(){return zt({queryKey:["roles"],queryFn:()=>gd.getRoles(),staleTime:1e3*60*10})}function ZU(){return zt({queryKey:["workspaces"],queryFn:()=>gd.getWorkSpaces(),staleTime:1e3*60*10})}function eV(){const e=Mr();return Ct({mutationFn:t=>gd.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}function tV(){const e=Mr();return Ct({mutationFn:({id:t,data:r})=>gd.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r.id]})}})}function rV(){const e=Mr();return Ct({mutationFn:t=>gd.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}function nV(){const e=Mr();return Ct({mutationFn:t=>gd.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}const aV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,iV=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,sV=p.div`
  padding: 1.5rem;
`,oV=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Bi=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,Ui=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,S5=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,fs=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,lV=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,cV=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,$5=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,J_=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,dV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`,uV=p.h3`
  font-size: 0.875rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 1.5rem 0 0.75rem 0;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,hV=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
`,fV=p.div`
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  border: 1px solid ${d.colors.border};
`,pV=p.div`
  font-weight: 500;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
`,mV=p.div`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,E5=p.p`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  font-style: italic;
`;function gV(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let i=0,s=2;for(let c=n.length-1;c>=0;c--)i+=parseInt(n[c])*s,s=s<7?s+1:2;const o=11-i%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function xV(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function vV({client:e,clasificaciones:t,onSubmit:r,onCancel:n,isLoading:i}){const s=!!e,[o,l]=S.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",razon_social:(e==null?void 0:e.razon_social)||"",giro:(e==null?void 0:e.giro)||"",direccion:(e==null?void 0:e.direccion)||"",comuna:(e==null?void 0:e.comuna)||"",ciudad:(e==null?void 0:e.ciudad)||"",telefono:(e==null?void 0:e.telefono)||"",email:(e==null?void 0:e.email)||"",contacto:(e==null?void 0:e.contacto)||"",clasificacion_id:(e==null?void 0:e.clasificacion_id)||null}),[c,u]=S.useState({}),[h,f]=S.useState({}),[m,v]=S.useState([]),[g,x]=S.useState(!1);S.useEffect(()=>{e&&l({rut:e.rut||"",nombre:e.nombre||"",razon_social:e.razon_social||"",giro:e.giro||"",direccion:e.direccion||"",comuna:e.comuna||"",ciudad:e.ciudad||"",telefono:e.telefono||"",email:e.email||"",contacto:e.contacto||"",clasificacion_id:e.clasificacion_id||null})},[e]),S.useEffect(()=>{e!=null&&e.id?(x(!0),pu.getInstalacionesCliente(e.id).then(k=>v(k)).catch(k=>console.error("Error cargando instalaciones:",k)).finally(()=>x(!1))):v([])},[e==null?void 0:e.id]);const _=S.useCallback((k,E)=>{switch(k){case"rut":return E?gV(E)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return E?E.length<3?"Nombre debe tener al menos 3 caracteres":void 0:"Nombre es requerido";case"email":return E&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(E)?"Email invalido":void 0;default:return}},[]),b=S.useCallback(k=>{const{name:E,value:A}=k.target,w=E==="rut"?xV(A):A;if(l(P=>({...P,[E]:E==="clasificacion_id"?A?Number(A):null:w})),h[E]){const P=_(E,w);u(M=>({...M,[E]:P}))}},[h,_]),y=S.useCallback(k=>{const{name:E,value:A}=k.target;f(P=>({...P,[E]:!0}));const w=_(E,A);u(P=>({...P,[E]:w}))},[_]),j=S.useCallback(k=>{k.preventDefault();const E={};if(E.rut=_("rut",o.rut),E.nombre=_("nombre",o.nombre),E.email=_("email",o.email),u(E),f({rut:!0,nombre:!0,email:!0}),Object.values(E).some(w=>w))return;const A={nombre:o.nombre,razon_social:o.razon_social||void 0,giro:o.giro||void 0,direccion:o.direccion||void 0,comuna:o.comuna||void 0,ciudad:o.ciudad||void 0,telefono:o.telefono||void 0,email:o.email||void 0,contacto:o.contacto||void 0,clasificacion_id:o.clasificacion_id||void 0};s||(A.rut=o.rut),r(A)},[o,_,s,r]);return a.jsxs(aV,{children:[a.jsx(iV,{children:s?`Editando Cliente: ${e==null?void 0:e.nombre}`:"Nuevo Cliente"}),a.jsx(sV,{children:a.jsxs("form",{onSubmit:j,children:[a.jsxs(oV,{children:[a.jsxs(Bi,{children:[a.jsxs(Ui,{children:["RUT",a.jsx(S5,{children:"*"})]}),a.jsx(fs,{type:"text",name:"rut",value:o.rut,onChange:b,onBlur:y,placeholder:"12.345.678-9",disabled:s,maxLength:12}),c.rut&&h.rut&&a.jsx(J_,{children:c.rut}),a.jsx(dV,{children:"Formato: 12.345.678-9"})]}),a.jsxs(Bi,{children:[a.jsxs(Ui,{children:["Nombre",a.jsx(S5,{children:"*"})]}),a.jsx(fs,{type:"text",name:"nombre",value:o.nombre,onChange:b,onBlur:y,placeholder:"Nombre del cliente",maxLength:255}),c.nombre&&h.nombre&&a.jsx(J_,{children:c.nombre})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Razon Social"}),a.jsx(fs,{type:"text",name:"razon_social",value:o.razon_social,onChange:b,placeholder:"Razon social",maxLength:255})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Giro"}),a.jsx(fs,{type:"text",name:"giro",value:o.giro,onChange:b,placeholder:"Giro comercial",maxLength:255})]}),a.jsxs(Bi,{$fullWidth:!0,children:[a.jsx(Ui,{children:"Direccion"}),a.jsx(fs,{type:"text",name:"direccion",value:o.direccion,onChange:b,placeholder:"Direccion",maxLength:255})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Comuna"}),a.jsx(fs,{type:"text",name:"comuna",value:o.comuna,onChange:b,placeholder:"Comuna",maxLength:100})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Ciudad"}),a.jsx(fs,{type:"text",name:"ciudad",value:o.ciudad,onChange:b,placeholder:"Ciudad",maxLength:100})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Telefono"}),a.jsx(fs,{type:"text",name:"telefono",value:o.telefono,onChange:b,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Email"}),a.jsx(fs,{type:"email",name:"email",value:o.email,onChange:b,onBlur:y,placeholder:"correo@ejemplo.com",maxLength:100}),c.email&&h.email&&a.jsx(J_,{children:c.email})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Contacto"}),a.jsx(fs,{type:"text",name:"contacto",value:o.contacto,onChange:b,placeholder:"Nombre del contacto",maxLength:255})]}),a.jsxs(Bi,{children:[a.jsx(Ui,{children:"Clasificacion"}),a.jsxs(lV,{name:"clasificacion_id",value:o.clasificacion_id||"",onChange:b,children:[a.jsx("option",{value:"",children:"Sin clasificacion"}),t.map(k=>a.jsx("option",{value:k.id,children:k.descripcion},k.id))]})]})]}),s&&a.jsxs(a.Fragment,{children:[a.jsx(uV,{children:"Instalaciones del Cliente"}),g?a.jsx(E5,{children:"Cargando instalaciones..."}):m.length>0?a.jsx(hV,{children:m.map(k=>a.jsxs(fV,{children:[a.jsx(pV,{children:k.nombre}),k.direccion&&a.jsx(mV,{children:k.direccion})]},k.id))}):a.jsx(E5,{children:"Este cliente no tiene instalaciones registradas."})]}),a.jsxs(cV,{children:[a.jsx($5,{type:"button",onClick:n,disabled:i,children:"Cancelar"}),a.jsx($5,{type:"submit",$variant:"primary",disabled:i,children:i?"Guardando...":s?"Actualizar":"Crear"})]})]})})]})}function _V(e,t){const[r,n]=S.useState(e);return S.useEffect(()=>{const i=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(i)}},[e,t]),r}const Oh=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Rh=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Nh=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,zh=p.div`
  display: flex;
  gap: 0.75rem;
`,Jl=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,yV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,bV=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  align-items: end;
`,vm=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,_m=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,jV=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,T5=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,wV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,kV=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,No=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,zo=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,CV=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,A5=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Z_=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,SV=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,F5=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,D5=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,$V=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,P5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,EV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,TV=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,ey=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,M5=p.span`
  display: block;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function AV({onNavigate:e}){const[t,r]=S.useState(1),[n,i]=S.useState(""),[s,o]=S.useState(null),[l,c]=S.useState(void 0),[u,h]=S.useState(!1),[f,m]=S.useState(null),[v,g]=S.useState(null),[x,_]=S.useState(null),b=_V(n,300),y=S.useMemo(()=>({page:t,page_size:20,search:b||void 0,clasificacion_id:s||void 0,activo:l}),[t,b,s,l]);S.useEffect(()=>{r(1)},[b,s,l]);const{data:j,isLoading:k,error:E}=HU(y),{data:A}=GU(),{data:w,isLoading:P}=WU(f),M=qU(),F=KU(),D=XU(),W=YU(),B=S.useCallback(()=>{i(""),o(null),c(void 0),r(1)},[]),G=S.useCallback(()=>{m(null),h(!0)},[]),Y=S.useCallback(R=>{m(R),h(!0)},[]),ae=S.useCallback(()=>{h(!1),m(null)},[]),U=S.useCallback(async R=>{try{f&&w?(await F.mutateAsync({id:w.id,data:R}),g("Cliente actualizado correctamente")):(await M.mutateAsync(R),g("Cliente creado correctamente")),h(!1),m(null),_(null),setTimeout(()=>g(null),3e3)}catch(I){_(I.message||"Error al guardar cliente"),g(null)}},[f,w,M,F]),q=S.useCallback(async R=>{try{await D.mutateAsync(R),g("Cliente activado correctamente"),_(null),setTimeout(()=>g(null),3e3)}catch(I){_(I.message||"Error al activar cliente")}},[D]),z=S.useCallback(async R=>{if(window.confirm("Est seguro de desactivar este cliente?"))try{await W.mutateAsync(R),g("Cliente desactivado correctamente"),_(null),setTimeout(()=>g(null),3e3)}catch(I){_(I.message||"Error al desactivar cliente")}},[W]);if(k)return a.jsxs(Oh,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Mantenedor de Clientes"}),a.jsx(zh,{children:a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(F5,{children:[a.jsx(D5,{}),a.jsx("span",{children:"Cargando clientes..."})]})]});if(E)return a.jsxs(Oh,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Mantenedor de Clientes"}),a.jsx(zh,{children:a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx(ey,{$type:"error",children:"Error al cargar clientes. Intente nuevamente."})]});const ie=(j==null?void 0:j.items)||[],he=(j==null?void 0:j.total_pages)||1,O=(j==null?void 0:j.total)||0;return u?f&&P?a.jsxs(Oh,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Editar Cliente"}),a.jsx(zh,{children:a.jsx(Jl,{onClick:ae,children:" Cancelar"})})]}),a.jsxs(F5,{children:[a.jsx(D5,{}),a.jsx("span",{children:"Cargando datos del cliente..."})]})]}):a.jsxs(Oh,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:f?"Editar Cliente":"Nuevo Cliente"}),a.jsx(zh,{children:a.jsx(Jl,{onClick:ae,children:" Cancelar"})})]}),a.jsx(vV,{client:w||null,clasificaciones:A||[],onSubmit:U,onCancel:ae,isLoading:M.isPending||F.isPending})]}):a.jsxs(Oh,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Mantenedor de Clientes"}),a.jsxs(zh,{children:[a.jsx(Jl,{$variant:"primary",onClick:G,children:"+ Nuevo Cliente"}),a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),v&&a.jsx(ey,{$type:"success",children:v}),x&&a.jsx(ey,{$type:"error",children:x}),a.jsx(yV,{children:a.jsxs(bV,{children:[a.jsxs(vm,{children:[a.jsx(_m,{children:"Buscar (filtra automticamente)"}),a.jsx(jV,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:R=>i(R.target.value)})]}),a.jsxs(vm,{children:[a.jsx(_m,{children:"Clasificacion"}),a.jsxs(T5,{value:s||"",onChange:R=>o(R.target.value?Number(R.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),A==null?void 0:A.map(R=>a.jsx("option",{value:R.id,children:R.descripcion},R.id))]})]}),a.jsxs(vm,{children:[a.jsx(_m,{children:"Estado"}),a.jsxs(T5,{value:l===void 0?"":l?"true":"false",onChange:R=>c(R.target.value===""?void 0:R.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(vm,{children:[a.jsx(_m,{children:""}),a.jsx(Jl,{type:"button",onClick:B,children:"Limpiar Filtros"})]})]})}),a.jsxs(TV,{children:["Mostrando ",ie.length," de ",O," clientes"]}),a.jsx(wV,{children:ie.length===0?a.jsx(SV,{children:a.jsx("p",{children:"No se encontraron clientes"})}):a.jsxs(a.Fragment,{children:[a.jsxs(kV,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(No,{children:"ID"}),a.jsx(No,{children:"RUT"}),a.jsx(No,{children:"Nombre"}),a.jsx(No,{children:"Clasificacion"}),a.jsx(No,{children:"Email"}),a.jsx(No,{children:"Telefono"}),a.jsx(No,{children:"Estado"}),a.jsx(No,{children:"Acciones"})]})}),a.jsx("tbody",{children:ie.map(R=>a.jsxs(CV,{children:[a.jsx(zo,{children:R.id}),a.jsx(zo,{children:R.rut}),a.jsx(zo,{children:a.jsx(M5,{title:R.nombre_sap,children:R.nombre_sap})}),a.jsx(zo,{children:R.clasificacion_nombre&&a.jsx(A5,{$type:"info",children:R.clasificacion_nombre})}),a.jsx(zo,{children:a.jsx(M5,{title:R.email_contacto_1||"",children:R.email_contacto_1||"-"})}),a.jsx(zo,{children:R.phone_contacto_1||"-"}),a.jsx(zo,{children:a.jsx(A5,{$type:R.active===1?"active":"inactive",children:R.active===1?"Activo":"Inactivo"})}),a.jsxs(zo,{children:[a.jsx(Z_,{$variant:"edit",onClick:()=>Y(R.id),title:"Editar",children:"Editar"}),R.active===1?a.jsx(Z_,{$variant:"deactivate",onClick:()=>z(R.id),disabled:W.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(Z_,{$variant:"activate",onClick:()=>q(R.id),disabled:D.isPending,title:"Activar",children:"Activar"})]})]},R.id))})]}),he>1&&a.jsxs($V,{children:[a.jsx(P5,{disabled:t===1,onClick:()=>r(R=>R-1),children:"Anterior"}),a.jsxs(EV,{children:["Pagina ",t," de ",he]}),a.jsx(P5,{disabled:t===he,onClick:()=>r(R=>R+1),children:"Siguiente"})]})]})})]})}const FV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,DV=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,PV=p.div`
  padding: 1.5rem;
`,MV=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Io=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,Lo=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,ym=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,Ed=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,O5=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,OV=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,R5=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Ih=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,N5=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`;function RV(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let i=0,s=2;for(let c=n.length-1;c>=0;c--)i+=parseInt(n[c])*s,s=s<7?s+1:2;const o=11-i%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function NV(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function zV({user:e,roles:t,workSpaces:r,onSubmit:n,onCancel:i,isLoading:s}){const o=!!e,[l,c]=S.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",apellido:(e==null?void 0:e.apellido)||"",email:(e==null?void 0:e.email)||"",telefono:(e==null?void 0:e.telefono)||"",password:"",role_id:(e==null?void 0:e.role_id)||null,work_space_id:(e==null?void 0:e.work_space_id)||null}),[u,h]=S.useState({}),[f,m]=S.useState({});S.useEffect(()=>{e&&c({rut:e.rut||"",nombre:e.nombre||"",apellido:e.apellido||"",email:e.email||"",telefono:e.telefono||"",password:"",role_id:e.role_id||null,work_space_id:e.work_space_id||null})},[e]);const v=S.useCallback((b,y)=>{switch(b){case"rut":return y?RV(y)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return y?y.length<2?"Nombre debe tener al menos 2 caracteres":void 0:"Nombre es requerido";case"apellido":return y?y.length<2?"Apellido debe tener al menos 2 caracteres":void 0:"Apellido es requerido";case"email":return y&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y)?"Email invalido":void 0;case"password":return!o&&!y?"Contrasea es requerida":y&&y.length<6?"Contrasea debe tener al menos 6 caracteres":void 0;default:return}},[o]),g=S.useCallback(b=>{const{name:y,value:j}=b.target,k=y==="rut"?NV(j):j;if(c(E=>({...E,[y]:["role_id","work_space_id"].includes(y)?j?Number(j):null:k})),f[y]){const E=v(y,k);h(A=>({...A,[y]:E}))}},[f,v]),x=S.useCallback(b=>{const{name:y,value:j}=b.target;m(E=>({...E,[y]:!0}));const k=v(y,j);h(E=>({...E,[y]:k}))},[v]),_=S.useCallback(b=>{b.preventDefault();const y={};if(y.rut=v("rut",l.rut),y.nombre=v("nombre",l.nombre),y.apellido=v("apellido",l.apellido),y.email=v("email",l.email),y.password=v("password",l.password),h(y),m({rut:!0,nombre:!0,apellido:!0,email:!0,password:!0}),!Object.values(y).some(j=>j))if(o){const j={nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password||void 0,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(j)}else{const j={rut:l.rut,nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(j)}},[l,v,o,n]);return a.jsxs(FV,{children:[a.jsx(DV,{children:o?`Editando Usuario: ${e==null?void 0:e.nombre} ${e==null?void 0:e.apellido}`:"Nuevo Usuario"}),a.jsx(PV,{children:a.jsxs("form",{onSubmit:_,children:[a.jsxs(MV,{children:[a.jsxs(Io,{children:[a.jsxs(Lo,{children:["RUT",a.jsx(ym,{children:"*"})]}),a.jsx(Ed,{type:"text",name:"rut",value:l.rut,onChange:g,onBlur:x,placeholder:"12.345.678-9",disabled:o,maxLength:12}),u.rut&&f.rut&&a.jsx(Ih,{children:u.rut}),a.jsx(N5,{children:"Formato: 12.345.678-9"})]}),a.jsxs(Io,{children:[a.jsxs(Lo,{children:["Nombre",a.jsx(ym,{children:"*"})]}),a.jsx(Ed,{type:"text",name:"nombre",value:l.nombre,onChange:g,onBlur:x,placeholder:"Nombre",maxLength:100}),u.nombre&&f.nombre&&a.jsx(Ih,{children:u.nombre})]}),a.jsxs(Io,{children:[a.jsxs(Lo,{children:["Apellido",a.jsx(ym,{children:"*"})]}),a.jsx(Ed,{type:"text",name:"apellido",value:l.apellido,onChange:g,onBlur:x,placeholder:"Apellido",maxLength:100}),u.apellido&&f.apellido&&a.jsx(Ih,{children:u.apellido})]}),a.jsxs(Io,{children:[a.jsx(Lo,{children:"Email"}),a.jsx(Ed,{type:"email",name:"email",value:l.email,onChange:g,onBlur:x,placeholder:"correo@ejemplo.com",maxLength:100}),u.email&&f.email&&a.jsx(Ih,{children:u.email})]}),a.jsxs(Io,{children:[a.jsx(Lo,{children:"Telefono"}),a.jsx(Ed,{type:"text",name:"telefono",value:l.telefono,onChange:g,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(Io,{children:[a.jsxs(Lo,{children:["Contrasea",!o&&a.jsx(ym,{children:"*"})]}),a.jsx(Ed,{type:"password",name:"password",value:l.password,onChange:g,onBlur:x,placeholder:o?"Dejar vacio para no cambiar":"Minimo 6 caracteres",maxLength:100}),u.password&&f.password&&a.jsx(Ih,{children:u.password}),o&&a.jsx(N5,{children:"Dejar vacio para mantener contrasea actual"})]}),a.jsxs(Io,{children:[a.jsx(Lo,{children:"Rol"}),a.jsxs(O5,{name:"role_id",value:l.role_id||"",onChange:g,children:[a.jsx("option",{value:"",children:"Sin rol asignado"}),t.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]}),a.jsxs(Io,{children:[a.jsx(Lo,{children:"Area de Trabajo"}),a.jsxs(O5,{name:"work_space_id",value:l.work_space_id||"",onChange:g,children:[a.jsx("option",{value:"",children:"Sin area asignada"}),r.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]}),a.jsxs(OV,{children:[a.jsx(R5,{type:"button",onClick:i,disabled:s,children:"Cancelar"}),a.jsx(R5,{type:"submit",$variant:"primary",disabled:s,children:s?"Guardando...":o?"Actualizar":"Crear"})]})]})})]})}const bm=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,jm=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,wm=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,km=p.div`
  display: flex;
  gap: 0.75rem;
`,Zl=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,IV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,LV=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,Lh=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Bh=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,BV=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,ty=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,UV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,VV=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Bo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Uo=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,HV=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,ry=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"role":return`
          background: #6c757d15;
          color: #6c757d;
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,ny=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,WV=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,GV=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,qV=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,KV=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,z5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,XV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,YV=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Uh=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,I5=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function QV({onNavigate:e}){const[t,r]=S.useState(1),[n,i]=S.useState(""),[s,o]=S.useState(null),[l,c]=S.useState(null),[u,h]=S.useState(void 0),[f,m]=S.useState(!1),[v,g]=S.useState(null),[x,_]=S.useState(null),[b,y]=S.useState(null),j={page:t,page_size:20,search:n||void 0,role_id:s||void 0,work_space_id:l||void 0,activo:u},{data:k,isLoading:E,error:A}=QU(j),{data:w}=JU(),{data:P}=ZU(),M=eV(),F=tV(),D=rV(),W=nV(),B=S.useCallback(I=>{I.preventDefault(),r(1)},[]),G=S.useCallback(()=>{i(""),o(null),c(null),h(void 0),r(1)},[]),Y=S.useCallback(()=>{g(null),m(!0)},[]),ae=S.useCallback(I=>{g(I),m(!0)},[]),U=S.useCallback(()=>{m(!1),g(null)},[]),q=S.useCallback(async I=>{try{v?(await F.mutateAsync({id:v.id,data:I}),_("Usuario actualizado correctamente")):(await M.mutateAsync(I),_("Usuario creado correctamente")),m(!1),g(null),y(null),setTimeout(()=>_(null),3e3)}catch(K){y(K.message||"Error al guardar usuario"),_(null)}},[v,M,F]),z=S.useCallback(async I=>{try{await D.mutateAsync(I),_("Usuario activado correctamente"),y(null),setTimeout(()=>_(null),3e3)}catch(K){y(K.message||"Error al activar usuario")}},[D]),ie=S.useCallback(async I=>{if(window.confirm("Est seguro de desactivar este usuario?"))try{await W.mutateAsync(I),_("Usuario desactivado correctamente"),y(null),setTimeout(()=>_(null),3e3)}catch(K){y(K.message||"Error al desactivar usuario")}},[W]);if(E)return a.jsxs(bm,{children:[a.jsxs(jm,{children:[a.jsx(wm,{children:"Mantenedor de Usuarios"}),a.jsx(km,{children:a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(GV,{children:[a.jsx(qV,{}),a.jsx("span",{children:"Cargando usuarios..."})]})]});if(A)return a.jsxs(bm,{children:[a.jsxs(jm,{children:[a.jsx(wm,{children:"Mantenedor de Usuarios"}),a.jsx(km,{children:a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx(Uh,{$type:"error",children:"Error al cargar usuarios. Intente nuevamente."})]});const he=(k==null?void 0:k.items)||[],O=(k==null?void 0:k.total_pages)||1,R=(k==null?void 0:k.total)||0;return f?a.jsxs(bm,{children:[a.jsxs(jm,{children:[a.jsx(wm,{children:v?"Editar Usuario":"Nuevo Usuario"}),a.jsx(km,{children:a.jsx(Zl,{onClick:U,children:" Cancelar"})})]}),x&&a.jsx(Uh,{$type:"success",children:x}),b&&a.jsx(Uh,{$type:"error",children:b}),a.jsx(zV,{user:v,roles:w||[],workSpaces:P||[],onSubmit:q,onCancel:U,isLoading:M.isPending||F.isPending})]}):a.jsxs(bm,{children:[a.jsxs(jm,{children:[a.jsx(wm,{children:"Mantenedor de Usuarios"}),a.jsxs(km,{children:[a.jsx(Zl,{$variant:"primary",onClick:Y,children:"+ Nuevo Usuario"}),a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),x&&a.jsx(Uh,{$type:"success",children:x}),b&&a.jsx(Uh,{$type:"error",children:b}),a.jsx(IV,{children:a.jsx("form",{onSubmit:B,children:a.jsxs(LV,{children:[a.jsxs(Lh,{children:[a.jsx(Bh,{children:"Buscar"}),a.jsx(BV,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:I=>i(I.target.value)})]}),a.jsxs(Lh,{children:[a.jsx(Bh,{children:"Rol"}),a.jsxs(ty,{value:s||"",onChange:I=>o(I.target.value?Number(I.target.value):null),children:[a.jsx("option",{value:"",children:"Todos"}),w==null?void 0:w.map(I=>a.jsx("option",{value:I.id,children:I.nombre},I.id))]})]}),a.jsxs(Lh,{children:[a.jsx(Bh,{children:"Area"}),a.jsxs(ty,{value:l||"",onChange:I=>c(I.target.value?Number(I.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),P==null?void 0:P.map(I=>a.jsx("option",{value:I.id,children:I.nombre},I.id))]})]}),a.jsxs(Lh,{children:[a.jsx(Bh,{children:"Estado"}),a.jsxs(ty,{value:u===void 0?"":u?"true":"false",onChange:I=>h(I.target.value===""?void 0:I.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(Lh,{children:[a.jsx(Bh,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Zl,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(Zl,{type:"button",onClick:G,children:"Limpiar"})]})]})]})})}),a.jsxs(YV,{children:["Mostrando ",he.length," de ",R," usuarios"]}),a.jsx(UV,{children:he.length===0?a.jsx(WV,{children:a.jsx("p",{children:"No se encontraron usuarios"})}):a.jsxs(a.Fragment,{children:[a.jsxs(VV,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Bo,{children:"ID"}),a.jsx(Bo,{children:"RUT"}),a.jsx(Bo,{children:"Nombre"}),a.jsx(Bo,{children:"Email"}),a.jsx(Bo,{children:"Rol"}),a.jsx(Bo,{children:"Area"}),a.jsx(Bo,{children:"Estado"}),a.jsx(Bo,{children:"Acciones"})]})}),a.jsx("tbody",{children:he.map(I=>a.jsxs(HV,{children:[a.jsx(Uo,{children:I.id}),a.jsx(Uo,{children:I.rut}),a.jsx(Uo,{children:a.jsxs(I5,{title:`${I.nombre} ${I.apellido}`,children:[I.nombre," ",I.apellido]})}),a.jsx(Uo,{children:a.jsx(I5,{title:I.email||"",children:I.email||"-"})}),a.jsx(Uo,{children:I.role_nombre&&a.jsx(ry,{$type:"role",children:I.role_nombre})}),a.jsx(Uo,{children:I.work_space_nombre&&a.jsx(ry,{$type:"area",children:I.work_space_nombre})}),a.jsx(Uo,{children:a.jsx(ry,{$type:I.activo?"active":"inactive",children:I.activo?"Activo":"Inactivo"})}),a.jsxs(Uo,{children:[a.jsx(ny,{$variant:"edit",onClick:()=>ae(I),title:"Editar",children:"Editar"}),I.activo?a.jsx(ny,{$variant:"deactivate",onClick:()=>ie(I.id),disabled:W.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(ny,{$variant:"activate",onClick:()=>z(I.id),disabled:D.isPending,title:"Activar",children:"Activar"})]})]},I.id))})]}),O>1&&a.jsxs(KV,{children:[a.jsx(z5,{disabled:t===1,onClick:()=>r(I=>I-1),children:"Anterior"}),a.jsxs(XV,{children:["Pagina ",t," de ",O]}),a.jsx(z5,{disabled:t===O,onClick:()=>r(I=>I+1),children:"Siguiente"})]})]})})]})}const JV=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,ZV=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,eH=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,Td=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,tH=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,rH=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,nH=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,aH=p.table`
  width: 100%;
  border-collapse: collapse;
`,Vh=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Hh=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,iH=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,sH=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,oH=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,ay=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,lH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,L5=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,B5=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,cH=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,dH=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,uH=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,hH=p.div`
  margin-bottom: ${d.spacing.md};
`,fH=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,pH=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,mH=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,gH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,xH=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function Ge({tablaKey:e}){const[t,r]=S.useState([]),[n,i]=S.useState(null),[s,o]=S.useState(!0),[l,c]=S.useState(1),[u,h]=S.useState(1),[f,m]=S.useState(0),[v,g]=S.useState(""),[x,_]=S.useState(""),[b,y]=S.useState(!1),[j,k]=S.useState(null),[E,A]=S.useState({}),[w,P]=S.useState(null),[M,F]=S.useState(null),[D,W]=S.useState(!1);S.useEffect(()=>{(async()=>{try{const I=(await to.getTablas()).find(K=>K.key===e);I&&i(I)}catch(R){console.error("Error loading tabla info:",R)}})()},[e]);const B=S.useCallback(async()=>{o(!0);try{const O=await to.list(e,{page:l,page_size:20,search:v||void 0,activo:x?parseInt(x):void 0});r(O.items),h(O.total_pages),m(O.total)}catch(O){console.error("Error loading data:",O),F("Error al cargar los datos")}finally{o(!1)}},[e,l,v,x]);S.useEffect(()=>{B()},[B]);const G=()=>{c(1),B()},Y=()=>{k(null),A({}),y(!0)},ae=async O=>{try{const R=await to.get(e,O.id);k(O);const I={};Object.entries(R.data).forEach(([K,ne])=>{K!=="id"&&K!=="created_at"&&K!=="updated_at"&&(I[K]=(ne==null?void 0:ne.toString())||"")}),A(I),y(!0)}catch(R){console.error("Error loading item:",R),F("Error al cargar el item")}},U=()=>{y(!1),k(null),A({})},q=async()=>{W(!0),F(null);try{const O={};Object.entries(E).forEach(([R,I])=>{I!==""&&(O[R]=I)}),j?(await to.update(e,j.id,O),P("Item actualizado exitosamente")):(await to.create(e,O),P("Item creado exitosamente")),U(),B()}catch(O){console.error("Error saving:",O),F("Error al guardar")}finally{W(!1)}},z=async O=>{try{await to.activate(e,O),P("Item activado"),B()}catch(R){console.error("Error activating:",R),F("Error al activar")}},ie=async O=>{try{await to.deactivate(e,O),P("Item desactivado"),B()}catch(R){console.error("Error deactivating:",R),F("Error al desactivar")}};S.useEffect(()=>{if(w||M){const O=setTimeout(()=>{P(null),F(null)},3e3);return()=>clearTimeout(O)}},[w,M]);const he=()=>n?n.columns.filter(O=>O!=="id"&&O!=="active"&&O!=="created_at"&&O!=="updated_at"):[];return a.jsxs(JV,{children:[a.jsxs(ZV,{children:[a.jsx(eH,{children:(n==null?void 0:n.display_name)||e}),a.jsx(Td,{onClick:Y,children:"+ Nuevo"})]}),w&&a.jsx(B5,{$type:"success",children:w}),M&&a.jsx(B5,{$type:"error",children:M}),a.jsxs(tH,{children:[a.jsx(rH,{type:"text",placeholder:"Buscar...",value:v,onChange:O=>g(O.target.value),onKeyDown:O=>O.key==="Enter"&&G()}),(n==null?void 0:n.has_active)&&a.jsxs(nH,{value:x,onChange:O=>{_(O.target.value),c(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(Td,{onClick:G,children:"Filtrar"})]}),a.jsxs(L5,{children:["Mostrando ",t.length," de ",f," registros"]}),s?a.jsx(gH,{children:"Cargando..."}):t.length===0?a.jsx(xH,{children:"No hay registros"}):a.jsxs(aH,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Vh,{children:"ID"}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx(Vh,{children:"Cdigo"}),a.jsx(Vh,{children:"Nombre"}),(n==null?void 0:n.has_active)&&a.jsx(Vh,{children:"Estado"}),a.jsx(Vh,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(O=>a.jsxs(iH,{children:[a.jsx(Hh,{children:O.id}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx(Hh,{children:O.codigo||"-"}),a.jsx(Hh,{children:O.nombre}),(n==null?void 0:n.has_active)&&a.jsx(Hh,{children:a.jsx(sH,{$active:O.active===1,children:O.active===1?"Activo":"Inactivo"})}),a.jsx(Hh,{children:a.jsxs(oH,{children:[a.jsx(ay,{onClick:()=>ae(O),title:"Editar",children:""}),(n==null?void 0:n.has_active)&&(O.active===1?a.jsx(ay,{$color:d.colors.danger,onClick:()=>ie(O.id),title:"Desactivar",children:""}):a.jsx(ay,{$color:d.colors.success,onClick:()=>z(O.id),title:"Activar",children:""}))]})})]},O.id))})]}),u>1&&a.jsxs(lH,{children:[a.jsx(Td,{$variant:"secondary",onClick:()=>c(O=>Math.max(1,O-1)),disabled:l===1,children:"Anterior"}),a.jsxs(L5,{children:["Pgina ",l," de ",u]}),a.jsx(Td,{$variant:"secondary",onClick:()=>c(O=>Math.min(u,O+1)),disabled:l===u,children:"Siguiente"})]}),b&&a.jsx(cH,{onClick:U,children:a.jsxs(dH,{onClick:O=>O.stopPropagation(),children:[a.jsxs(uH,{children:[j?"Editar":"Crear"," ",n==null?void 0:n.display_name]}),he().map(O=>a.jsxs(hH,{children:[a.jsx(fH,{children:O.charAt(0).toUpperCase()+O.slice(1).replace(/_/g," ")}),a.jsx(pH,{type:"text",value:E[O]||"",onChange:R=>A(I=>({...I,[O]:R.target.value}))})]},O)),a.jsxs(mH,{children:[a.jsx(Td,{$variant:"secondary",onClick:U,children:"Cancelar"}),a.jsx(Td,{onClick:q,disabled:D,children:D?"Guardando...":"Guardar"})]})]})})]})}const vH=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,_H=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,yH=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,bH=p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.lg};
  border-bottom: 2px solid ${d.colors.border};
`,iy=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  border-radius: ${d.radius.md} ${d.radius.md} 0 0;
  transition: all 0.2s;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
  }
`,Ad=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,jH=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,wH=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,U5=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,kH=p.table`
  width: 100%;
  border-collapse: collapse;
`,ec=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,an=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,sy=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,oy=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,V5=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${d.colors.primary}20;
  color: ${d.colors.primary};
`,ly=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,Us=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,CH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,H5=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,W5=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,SH=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,$H=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,EH=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,cy=p.div`
  margin-bottom: ${d.spacing.md};
`,dy=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,G5=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,TH=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,AH=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,FH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,DH=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function uy({nivel:e}){const[t,r]=S.useState(e),[n,i]=S.useState(!0),[s,o]=S.useState(1),[l,c]=S.useState(1),[u,h]=S.useState(0),[f,m]=S.useState(""),[v,g]=S.useState(""),[x,_]=S.useState(""),[b,y]=S.useState(!1),[j,k]=S.useState(null),[E,A]=S.useState(null),[w,P]=S.useState(null),[M,F]=S.useState(!1),[D,W]=S.useState([]),[B,G]=S.useState([]),[Y,ae]=S.useState([]),[U,q]=S.useState([]),[z,ie]=S.useState([]),[he,O]=S.useState(""),[R,I]=S.useState(""),[K,ne]=S.useState("");S.useEffect(()=>{(async()=>{try{if(t>=2){const _e=await kr.getNivel2Parents();q(_e)}if(t===3){const _e=await kr.getNivel3Parents();ie(_e)}}catch(_e){console.error("Error loading parents:",_e)}})()},[t]);const ee=S.useCallback(async()=>{i(!0);try{const T={page:s,page_size:20,search:f||void 0,activo:v?parseInt(v):void 0,hierarchy_id:x&&t>=2?parseInt(x):void 0,subhierarchy_id:x&&t===3?parseInt(x):void 0};if(t===1){const _e=await kr.listNivel1(T);W(_e.items),c(_e.total_pages),h(_e.total)}else if(t===2){const _e=await kr.listNivel2(T);G(_e.items),c(_e.total_pages),h(_e.total)}else{const _e=await kr.listNivel3(T);ae(_e.items),c(_e.total_pages),h(_e.total)}}catch(T){console.error("Error loading data:",T),P("Error al cargar los datos")}finally{i(!1)}},[t,s,f,v,x]);S.useEffect(()=>{ee()},[ee]),S.useEffect(()=>{o(1),m(""),g(""),_("")},[t]);const ge=()=>{o(1),ee()},L=()=>{k(null),O(""),I(""),ne(""),y(!0)},se=async T=>{try{if(t===1){const _e=await kr.getNivel1(T);O(_e.descripcion)}else if(t===2){const _e=await kr.getNivel2(T);O(_e.descripcion),ne(_e.hierarchy_id.toString())}else{const _e=await kr.getNivel3(T);O(_e.descripcion),I(_e.jerarquia_sap||""),ne(_e.subhierarchy_id.toString())}k(T),y(!0)}catch(_e){console.error("Error loading item:",_e),P("Error al cargar el item")}},ke=()=>{y(!1),k(null)},V=async()=>{if(!he.trim()){P("La descripcin es requerida");return}F(!0),P(null);try{if(t===1)j?await kr.updateNivel1(j,{descripcion:he}):await kr.createNivel1({descripcion:he});else if(t===2){if(!K){P("Debe seleccionar una Jerarqua 1"),F(!1);return}j?await kr.updateNivel2(j,{descripcion:he,hierarchy_id:parseInt(K)}):await kr.createNivel2({descripcion:he,hierarchy_id:parseInt(K)})}else{if(!K){P("Debe seleccionar una Jerarqua 2"),F(!1);return}j?await kr.updateNivel3(j,{descripcion:he,jerarquia_sap:R||void 0,subhierarchy_id:parseInt(K)}):await kr.createNivel3({descripcion:he,jerarquia_sap:R||void 0,subhierarchy_id:parseInt(K)})}A(j?"Actualizado exitosamente":"Creado exitosamente"),ke(),ee()}catch(T){console.error("Error saving:",T),P("Error al guardar")}finally{F(!1)}},Ve=async T=>{try{t===1?await kr.activateNivel1(T):t===2?await kr.activateNivel2(T):await kr.activateNivel3(T),A("Activado"),ee()}catch(_e){console.error("Error activating:",_e),P("Error al activar")}},Ke=async T=>{try{t===1?await kr.deactivateNivel1(T):t===2?await kr.deactivateNivel2(T):await kr.deactivateNivel3(T),A("Desactivado"),ee()}catch(_e){console.error("Error deactivating:",_e),P("Error al desactivar")}};S.useEffect(()=>{if(E||w){const T=setTimeout(()=>{A(null),P(null)},3e3);return()=>clearTimeout(T)}},[E,w]);const ye=()=>{switch(t){case 1:return"Jerarquas Nivel 1";case 2:return"Jerarquas Nivel 2";case 3:return"Jerarquas Nivel 3"}};return a.jsxs(vH,{children:[a.jsxs(_H,{children:[a.jsx(yH,{children:ye()}),a.jsx(Ad,{onClick:L,children:"+ Nueva Jerarqua"})]}),a.jsxs(bH,{children:[a.jsx(iy,{$active:t===1,onClick:()=>r(1),children:"Nivel 1"}),a.jsx(iy,{$active:t===2,onClick:()=>r(2),children:"Nivel 2"}),a.jsx(iy,{$active:t===3,onClick:()=>r(3),children:"Nivel 3"})]}),E&&a.jsx(W5,{$type:"success",children:E}),w&&a.jsx(W5,{$type:"error",children:w}),a.jsxs(jH,{children:[a.jsx(wH,{type:"text",placeholder:"Buscar...",value:f,onChange:T=>m(T.target.value),onKeyDown:T=>T.key==="Enter"&&ge()}),t>=2&&a.jsxs(U5,{value:x,onChange:T=>{_(T.target.value),o(1)},children:[a.jsxs("option",{value:"",children:["Todas las Jerarquas ",t===2?"1":"2"]}),(t===2?U:z).map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]}),a.jsxs(U5,{value:v,onChange:T=>{g(T.target.value),o(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(Ad,{onClick:ge,children:"Filtrar"})]}),a.jsxs(H5,{children:["Mostrando ",t===1?D.length:t===2?B.length:Y.length," de ",u," registros"]}),n?a.jsx(FH,{children:"Cargando..."}):(t===1?D.length:t===2?B.length:Y.length)===0?a.jsx(DH,{children:"No hay registros"}):a.jsxs(kH,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ec,{children:"ID"}),a.jsx(ec,{children:"Descripcin"}),t===3&&a.jsx(ec,{children:"SAP"}),t>=2&&a.jsx(ec,{children:"Padre"}),t<3&&a.jsx(ec,{children:"Hijos"}),a.jsx(ec,{children:"Estado"}),a.jsx(ec,{children:"Acciones"})]})}),a.jsxs("tbody",{children:[t===1&&D.map(T=>a.jsxs(sy,{children:[a.jsx(an,{children:T.id}),a.jsx(an,{children:T.descripcion}),a.jsx(an,{children:a.jsx(V5,{children:T.count_children})}),a.jsx(an,{children:a.jsx(oy,{$active:T.active===1,children:T.active===1?"Activo":"Inactivo"})}),a.jsx(an,{children:a.jsxs(ly,{children:[a.jsx(Us,{onClick:()=>se(T.id),title:"Editar",children:""}),T.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>Ke(T.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ve(T.id),title:"Activar",children:""})]})})]},T.id)),t===2&&B.map(T=>a.jsxs(sy,{children:[a.jsx(an,{children:T.id}),a.jsx(an,{children:T.descripcion}),a.jsx(an,{children:T.hierarchy_nombre}),a.jsx(an,{children:a.jsx(V5,{children:T.count_children})}),a.jsx(an,{children:a.jsx(oy,{$active:T.active===1,children:T.active===1?"Activo":"Inactivo"})}),a.jsx(an,{children:a.jsxs(ly,{children:[a.jsx(Us,{onClick:()=>se(T.id),title:"Editar",children:""}),T.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>Ke(T.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ve(T.id),title:"Activar",children:""})]})})]},T.id)),t===3&&Y.map(T=>a.jsxs(sy,{children:[a.jsx(an,{children:T.id}),a.jsx(an,{children:T.descripcion}),a.jsx(an,{children:T.jerarquia_sap||"-"}),a.jsx(an,{children:T.subhierarchy_nombre}),a.jsx(an,{children:a.jsx(oy,{$active:T.active===1,children:T.active===1?"Activo":"Inactivo"})}),a.jsx(an,{children:a.jsxs(ly,{children:[a.jsx(Us,{onClick:()=>se(T.id),title:"Editar",children:""}),T.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>Ke(T.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ve(T.id),title:"Activar",children:""})]})})]},T.id))]})]}),l>1&&a.jsxs(CH,{children:[a.jsx(Ad,{$variant:"secondary",onClick:()=>o(T=>Math.max(1,T-1)),disabled:s===1,children:"Anterior"}),a.jsxs(H5,{children:["Pgina ",s," de ",l]}),a.jsx(Ad,{$variant:"secondary",onClick:()=>o(T=>Math.min(l,T+1)),disabled:s===l,children:"Siguiente"})]}),b&&a.jsx(SH,{onClick:ke,children:a.jsxs($H,{onClick:T=>T.stopPropagation(),children:[a.jsxs(EH,{children:[j?"Editar":"Crear"," Jerarqua Nivel ",t]}),a.jsxs(cy,{children:[a.jsx(dy,{children:"Descripcin *"}),a.jsx(G5,{type:"text",value:he,onChange:T=>O(T.target.value),placeholder:"Ingrese descripcin"})]}),t>=2&&a.jsxs(cy,{children:[a.jsxs(dy,{children:["Jerarqua ",t===2?"1":"2"," (Padre) *"]}),a.jsxs(TH,{value:K,onChange:T=>ne(T.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(t===2?U:z).map(T=>a.jsx("option",{value:T.id,children:T.nombre},T.id))]})]}),t===3&&a.jsxs(cy,{children:[a.jsx(dy,{children:"Cdigo SAP"}),a.jsx(G5,{type:"text",value:R,onChange:T=>I(T.target.value),placeholder:"Cdigo SAP (opcional)"})]}),a.jsxs(AH,{children:[a.jsx(Ad,{$variant:"secondary",onClick:ke,children:"Cancelar"}),a.jsx(Ad,{onClick:V,disabled:M,children:M?"Guardando...":"Guardar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var u1={};u1.version="0.18.5";var qP=1252,PH=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jk={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wk=function(e){PH.indexOf(e)!=-1&&(qP=jk[0]=e)};function MH(){wk(1252)}var Qi=function(e){wk(e)};function kk(){Qi(1200),MH()}function q5(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function OH(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function KP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Uf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?OH(e.slice(2)):t==254&&r==255?KP(e.slice(2)):t==65279?e.slice(1):e},Cm=function(t){return String.fromCharCode(t)},K5=function(t){return String.fromCharCode(t)},R0,vl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function N0(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=vl.charAt(s)+vl.charAt(o)+vl.charAt(l)+vl.charAt(c);return t}function Ga(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=vl.indexOf(e.charAt(u++)),o=vl.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=vl.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=vl.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var ft=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),So=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Rl(e){return ft?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function X5(e){return ft?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var La=function(t){return ft?So(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function sv(e){if(typeof ArrayBuffer>"u")return La(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Wl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function RH(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ck(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ck(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Zr=ft?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:So(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function NH(e){for(var t=[],r=0,n=e.length+250,i=Rl(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Rl(65535),n=65530)}return t.push(i.slice(0,r)),Zr(t)}var Zn=/\u0000/g,Vf=/[\u0001-\u0006]/g;function mu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ji(e,t){var r=""+e;return r.length>=t?r:hr("0",t-r.length)+r}function Sk(e,t){var r=""+e;return r.length>=t?r:hr(" ",t-r.length)+r}function h1(e,t){var r=""+e;return r.length>=t?r:r+hr(" ",t-r.length)}function zH(e,t){var r=""+Math.round(e);return r.length>=t?r:hr("0",t-r.length)+r}function IH(e,t){var r=""+e;return r.length>=t?r:hr("0",t-r.length)+r}var Y5=Math.pow(2,32);function Fd(e,t){if(e>Y5||e<-Y5)return zH(e,t);var r=Math.round(e);return IH(r,t)}function f1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Q5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hy=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LH(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},J5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},BH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function p1(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,h=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,h=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=h;if(h>t&&(u>t?(h=c,l=s):(h=u,l=o)),!r)return[0,n*l,h];var m=Math.floor(n*l/h);return[m,n*l-m*h,h]}function Fc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=qH(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var XP=new Date(1899,11,31,0,0,0),UH=XP.getTime(),VH=new Date(1900,2,1,0,0,0);function YP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=VH&&(r+=24*60*60*1e3),(r-(UH+(e.getTimezoneOffset()-XP.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $k(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function HH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WH(e){var t=e<0?12:11,r=$k(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function GH(e){var t=$k(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function z0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=WH(e):t===10?r=e.toFixed(10).substr(0,12):r=GH(e),$k(HH(r.toUpperCase()))}function sd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):z0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fi(14,YP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function qH(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function KH(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return hy[r.m-1][1];case 5:return hy[r.m-1][0];default:return hy[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Q5[r.q][0];default:return Q5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ji(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Ji(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var h=u>0?Ji(c,u):"";return h}function _l(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var QP=/%/g;function XH(e,t,r){var n=t.replace(QP,""),i=t.length-n.length;return go(e,n,r*Math.pow(10,2*i))+hr("%",i)}function YH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return go(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function JP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+JP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ZP=/# (\?+)( ?)\/( ?)(\d+)/;function QH(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?hr(" ",e[1].length+1+e[4].length):Sk(o,e[1].length)+e[2]+"/"+e[3]+Ji(l,e[4].length))}function JH(e,t,r){return r+(t===0?"":""+t)+hr(" ",e[1].length+2+e[4].length)}var e8=/^#*0*\.([0#]+)/,t8=/\).*[0#]/,r8=/\(###\) ###\\?-####/;function Yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Z5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function eE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ZH(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function eW(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function pi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(t8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pi("n",n,r):"("+pi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YH(e,t,r);if(t.indexOf("%")!==-1)return XH(e,t,r);if(t.indexOf("E")!==-1)return JP(t,r);if(t.charCodeAt(0)===36)return"$"+pi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Fd(c,t.length);if(t.match(/^[#?]+$/))return i=Fd(r,0),i==="0"&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(ZP))return QH(s,c,u);if(t.match(/^#+0+$/))return u+Fd(c,t.length-t.indexOf("0"));if(s=t.match(e8))return i=Z5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+hr("0",Yn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Z5(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+_l(Fd(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pi(e,t,-r):_l(""+(Math.floor(r)+ZH(r,s[1].length)))+"."+Ji(eE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return pi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(pi(e,t.replace(/[\\-]/g,""),r)),o=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(r8))return i=pi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=p1(c,Math.pow(10,o)-1,!1),i=""+u,h=go("n",s[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=h1(l[2],o),h.length<s[4].length&&(h=Yn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=p1(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sk(l[1],o)+s[2]+"/"+s[3]+h1(l[2],o):hr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Fd(r,0),t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,m=t.length-i.length-f;return Yn(t.substr(0,f)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=eE(r,s[1].length),r<0?"-"+pi(e,t,-r):_l(eW(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ji(0,3-g.length):"")+g})+"."+Ji(o,s[1].length);switch(t){case"###,##0.00":return pi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=_l(Fd(c,0));return v!=="0"?u+v:"";case"###,###.00":return pi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return pi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tW(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return go(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function rW(e,t,r){var n=t.replace(QP,""),i=t.length-n.length;return go(e,n,r*Math.pow(10,2*i))+hr("%",i)}function n8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+n8(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(t8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",n,r):"("+ys("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tW(e,t,r);if(t.indexOf("%")!==-1)return rW(e,t,r);if(t.indexOf("E")!==-1)return n8(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ji(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(ZP))return JH(s,c,u);if(t.match(/^#+0+$/))return u+Ji(c,t.length-t.indexOf("0"));if(s=t.match(e8))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Yn(s[1])).replace(/\.$/,"."+Yn(s[1])),i=i.replace(/\.(\d*)$/,function(g,x){return"."+x+hr("0",Yn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+_l(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):_l(""+r)+"."+hr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(ys(e,t.replace(/[\\-]/g,""),r)),o=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(r8))return i=ys(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=p1(c,Math.pow(10,o)-1,!1),i=""+u,h=go("n",s[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=h1(l[2],o),h.length<s[4].length&&(h=Yn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=p1(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sk(l[1],o)+s[2]+"/"+s[3]+h1(l[2],o):hr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Yn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,m=t.length-i.length-f;return Yn(t.substr(0,f)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):_l(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ji(0,3-g.length):"")+g})+"."+Ji(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=_l(""+c);return v!=="0"?u+v:"";default:if(t.match(/\.[0#?]*$/))return ys(e,t.slice(0,t.lastIndexOf(".")),r)+Yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function go(e,t,r){return(r|0)===r?ys(e,t,r):pi(e,t,r)}function nW(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var a8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ih(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":f1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(a8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function aW(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,h,f,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!f1(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var v=e.charAt(++o),g=v==="("||v===")"?v:"t";i[i.length]={t:g,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Fc(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Fc(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(u==null&&(u=Fc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,m="h"):(x.t="t",++o),u==null&&x.t==="T")return"";i[i.length]=x,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(a8)){if(u==null&&(u=Fc(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ih(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var _=0,b=0,y;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,c="h",_<1&&(_=1);break;case"s":(y=i[o].v.match(/\.0+$/))&&(b=Math.max(b,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[o].v.match(/[Hh]/)&&(_=1),_<2&&i[o].v.match(/[Mm]/)&&(_=2),_<3&&i[o].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var j="",k;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=KH(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(k=o+1;i[k]!=null&&((l=i[k].t)==="?"||l==="D"||(l===" "||l==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[o].v+=i[k].v,i[k]={v:"",t:";"},++k;j+=i[o].v,o=k-1;break;case"G":i[o].t="t",i[o].v=sd(t,r);break}var E="",A,w;if(j.length>0){j.charCodeAt(0)==40?(A=t<0&&j.charCodeAt(0)===45?-t:t,w=go("n",j,A)):(A=t<0&&n>1?-t:t,w=go("n",j,A),A<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),k=w.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var M=i.length;if(P===i.length&&w.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(k>=i[o].v.length-1?(k-=i[o].v.length,i[o].v=w.substr(k+1,i[o].v.length)):k<0?i[o].v="":(i[o].v=w.substr(0,k+1),k=-1),i[o].t="t",M=o);k>=0&&M<i.length&&(i[M].v=w.substr(0,k+1)+i[M].v)}else if(P!==i.length&&w.indexOf("E")===-1){for(k=w.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,E=i[o].v.substr(h+1);h>=0;--h)k>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(E=w.charAt(k--)+E);i[o].v=E,i[o].t="t",M=o}for(k>=0&&M<i.length&&(i[M].v=w.substr(0,k+1)+i[M].v),k=w.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(h=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,E=i[o].v.substr(0,h);h<i[o].v.length;++h)k<w.length&&(E+=w.charAt(k++));i[o].v=E,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(A=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=go(i[o].t,i[o].v,A),i[o].t="t");var F="";for(o=0;o!==i.length;++o)i[o]!=null&&(F+=i[o].v);return F}var tE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function iW(e,t){var r=nW(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(tE),l=r[1].match(tE);return rE(t,o)?[n,r[0]]:rE(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Fi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Xe)[e],n==null&&(n=r.table&&r.table[J5[e]]||Xe[J5[e]]),n==null&&(n=BH[e]||"General");break}if(f1(n,0))return sd(t,r);t instanceof Date&&(t=YP(t,r.date1904));var i=iW(n,t);if(f1(i[1]))return sd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return aW(i[1],t,r,i[0])}function xo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Xe[r]==null){t<0&&(t=r);continue}if(Xe[r]==e){t=r;break}}t<0&&(t=391)}return Xe[t]=e,t}function ov(e){for(var t=0;t!=392;++t)e[t]!==void 0&&xo(e[t],t)}function sh(){Xe=LH()}var sW={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},i8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function oW(e){var t=typeof e=="number"?Xe[e]:e;return t=t.replace(i8,"(\\d+)"),new RegExp("^"+t+"$")}function lW(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(i8)||[]).forEach(function(f,m){var v=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=v;break;case"d":s=v;break;case"h":o=v;break;case"s":c=v;break;case"m":o>=0?l=v:i=v;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?h:u+"T"+h}var cW=function(){var e={};e.version="1.2.0";function t(){for(var w=0,P=new Array(256),M=0;M!=256;++M)w=M,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,P[M]=w;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(w){var P=0,M=0,F=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)D[F]=w[F];for(F=0;F!=256;++F)for(M=w[F],P=256+F;P<4096;P+=256)M=D[P]=M>>>8^w[M&255];var W=[];for(F=1;F!=16;++F)W[F-1]=typeof Int32Array<"u"?D.subarray(F*256,F*256+256):D.slice(F*256,F*256+256);return W}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],h=i[5],f=i[6],m=i[7],v=i[8],g=i[9],x=i[10],_=i[11],b=i[12],y=i[13],j=i[14];function k(w,P){for(var M=P^-1,F=0,D=w.length;F<D;)M=M>>>8^r[(M^w.charCodeAt(F++))&255];return~M}function E(w,P){for(var M=P^-1,F=w.length-15,D=0;D<F;)M=j[w[D++]^M&255]^y[w[D++]^M>>8&255]^b[w[D++]^M>>16&255]^_[w[D++]^M>>>24]^x[w[D++]]^g[w[D++]]^v[w[D++]]^m[w[D++]]^f[w[D++]]^h[w[D++]]^u[w[D++]]^c[w[D++]]^l[w[D++]]^o[w[D++]]^s[w[D++]]^r[w[D++]];for(F+=15;D<F;)M=M>>>8^r[(M^w[D++])&255];return~M}function A(w,P){for(var M=P^-1,F=0,D=w.length,W=0,B=0;F<D;)W=w.charCodeAt(F++),W<128?M=M>>>8^r[(M^W)&255]:W<2048?(M=M>>>8^r[(M^(192|W>>6&31))&255],M=M>>>8^r[(M^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,B=w.charCodeAt(F++)&1023,M=M>>>8^r[(M^(240|W>>8&7))&255],M=M>>>8^r[(M^(128|W>>2&63))&255],M=M>>>8^r[(M^(128|B>>6&15|(W&3)<<4))&255],M=M>>>8^r[(M^(128|B&63))&255]):(M=M>>>8^r[(M^(224|W>>12&15))&255],M=M>>>8^r[(M^(128|W>>6&63))&255],M=M>>>8^r[(M^(128|W&63))&255]);return~M}return e.table=r,e.bstr=k,e.buf=E,e.str=A,e}(),qe=function(){var t={};t.version="1.2.1";function r(N,Q){for(var H=N.split("/"),X=Q.split("/"),J=0,Z=0,ce=Math.min(H.length,X.length);J<ce;++J){if(Z=H[J].length-X[J].length)return Z;if(H[J]!=X[J])return H[J]<X[J]?-1:1}return H.length-X.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var Q=N.lastIndexOf("/");return Q===-1?N:N.slice(0,Q+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var Q=N.lastIndexOf("/");return Q===-1?N:N.slice(Q+1)}function s(N,Q){typeof Q=="string"&&(Q=new Date(Q));var H=Q.getHours();H=H<<6|Q.getMinutes(),H=H<<5|Q.getSeconds()>>>1,N.write_shift(2,H);var X=Q.getFullYear()-1980;X=X<<4|Q.getMonth()+1,X=X<<5|Q.getDate(),N.write_shift(2,X)}function o(N){var Q=N.read_shift(2)&65535,H=N.read_shift(2)&65535,X=new Date,J=H&31;H>>>=5;var Z=H&15;H>>>=4,X.setMilliseconds(0),X.setFullYear(H+1980),X.setMonth(Z-1),X.setDate(J);var ce=Q&31;Q>>>=5;var ve=Q&63;return Q>>>=6,X.setHours(Q),X.setMinutes(ve),X.setSeconds(ce<<1),X}function l(N){un(N,0);for(var Q={},H=0;N.l<=N.length-4;){var X=N.read_shift(2),J=N.read_shift(2),Z=N.l+J,ce={};switch(X){case 21589:H=N.read_shift(1),H&1&&(ce.mtime=N.read_shift(4)),J>5&&(H&2&&(ce.atime=N.read_shift(4)),H&4&&(ce.ctime=N.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}N.l=Z,Q[X]=ce}return Q}var c;function u(){return c||(c={})}function h(N,Q){if(N[0]==80&&N[1]==75)return ph(N,Q);if((N[0]|32)==109&&(N[1]|32)==105)return xt(N,Q);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var H=3,X=512,J=0,Z=0,ce=0,ve=0,le=0,ue=[],fe=N.slice(0,512);un(fe,0);var je=f(fe);switch(H=je[0],H){case 3:X=512;break;case 4:X=4096;break;case 0:if(je[1]==0)return ph(N,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}X!==512&&(fe=N.slice(0,X),un(fe,28));var Ae=N.slice(0,X);m(fe,H);var Re=fe.read_shift(4,"i");if(H===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);fe.l+=4,ce=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ve=fe.read_shift(4,"i"),J=fe.read_shift(4,"i"),le=fe.read_shift(4,"i"),Z=fe.read_shift(4,"i");for(var Se=-1,Me=0;Me<109&&(Se=fe.read_shift(4,"i"),!(Se<0));++Me)ue[Me]=Se;var Je=v(N,X);_(le,Z,Je,X,ue);var Lt=y(Je,ce,ue,X);Lt[ce].name="!Directory",J>0&&ve!==B&&(Lt[ve].name="!MiniFAT"),Lt[ue[0]].name="!FAT",Lt.fat_addrs=ue,Lt.ssz=X;var Bt={},Or=[],To=[],Ao=[];j(ce,Lt,Je,Or,J,Bt,To,ve),g(To,Ao,Or),Or.shift();var Fo={FileIndex:To,FullPaths:Ao};return Q&&Q.raw&&(Fo.raw={header:Ae,sectors:Je}),Fo}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(G,"Header Signature: "),N.l+=16;var Q=N.read_shift(2,"u");return[N.read_shift(2,"u"),Q]}function m(N,Q){var H=9;switch(N.l+=2,H=N.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function v(N,Q){for(var H=Math.ceil(N.length/Q)-1,X=[],J=1;J<H;++J)X[J-1]=N.slice(J*Q,(J+1)*Q);return X[H-1]=N.slice(H*Q),X}function g(N,Q,H){for(var X=0,J=0,Z=0,ce=0,ve=0,le=H.length,ue=[],fe=[];X<le;++X)ue[X]=fe[X]=X,Q[X]=H[X];for(;ve<fe.length;++ve)X=fe[ve],J=N[X].L,Z=N[X].R,ce=N[X].C,ue[X]===X&&(J!==-1&&ue[J]!==J&&(ue[X]=ue[J]),Z!==-1&&ue[Z]!==Z&&(ue[X]=ue[Z])),ce!==-1&&(ue[ce]=X),J!==-1&&X!=ue[X]&&(ue[J]=ue[X],fe.lastIndexOf(J)<ve&&fe.push(J)),Z!==-1&&X!=ue[X]&&(ue[Z]=ue[X],fe.lastIndexOf(Z)<ve&&fe.push(Z));for(X=1;X<le;++X)ue[X]===X&&(Z!==-1&&ue[Z]!==Z?ue[X]=ue[Z]:J!==-1&&ue[J]!==J&&(ue[X]=ue[J]));for(X=1;X<le;++X)if(N[X].type!==0){if(ve=X,ve!=ue[ve])do ve=ue[ve],Q[X]=Q[ve]+"/"+Q[X];while(ve!==0&&ue[ve]!==-1&&ve!=ue[ve]);ue[X]=-1}for(Q[0]+="/",X=1;X<le;++X)N[X].type!==2&&(Q[X]+="/")}function x(N,Q,H){for(var X=N.start,J=N.size,Z=[],ce=X;H&&J>0&&ce>=0;)Z.push(Q.slice(ce*W,ce*W+W)),J-=W,ce=kc(H,ce*4);return Z.length===0?xe(0):Zr(Z).slice(0,N.size)}function _(N,Q,H,X,J){var Z=B;if(N===B){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ce=H[N],ve=(X>>>2)-1;if(!ce)return;for(var le=0;le<ve&&(Z=kc(ce,le*4))!==B;++le)J.push(Z);_(kc(ce,X-4),Q-1,H,X,J)}}function b(N,Q,H,X,J){var Z=[],ce=[];J||(J=[]);var ve=X-1,le=0,ue=0;for(le=Q;le>=0;){J[le]=!0,Z[Z.length]=le,ce.push(N[le]);var fe=H[Math.floor(le*4/X)];if(ue=le*4&ve,X<4+ue)throw new Error("FAT boundary crossed: "+le+" 4 "+X);if(!N[fe])break;le=kc(N[fe],ue)}return{nodes:Z,data:pE([ce])}}function y(N,Q,H,X){var J=N.length,Z=[],ce=[],ve=[],le=[],ue=X-1,fe=0,je=0,Ae=0,Re=0;for(fe=0;fe<J;++fe)if(ve=[],Ae=fe+Q,Ae>=J&&(Ae-=J),!ce[Ae]){le=[];var Se=[];for(je=Ae;je>=0;){Se[je]=!0,ce[je]=!0,ve[ve.length]=je,le.push(N[je]);var Me=H[Math.floor(je*4/X)];if(Re=je*4&ue,X<4+Re)throw new Error("FAT boundary crossed: "+je+" 4 "+X);if(!N[Me]||(je=kc(N[Me],Re),Se[je]))break}Z[Ae]={nodes:ve,data:pE([le])}}return Z}function j(N,Q,H,X,J,Z,ce,ve){for(var le=0,ue=X.length?2:0,fe=Q[N].data,je=0,Ae=0,Re;je<fe.length;je+=128){var Se=fe.slice(je,je+128);un(Se,64),Ae=Se.read_shift(2),Re=Mk(Se,0,Ae-ue),X.push(Re);var Me={name:Re,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},Je=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Je!==0&&(Me.ct=k(Se,Se.l-8));var Lt=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Lt!==0&&(Me.mt=k(Se,Se.l-8)),Me.start=Se.read_shift(4,"i"),Me.size=Se.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=B,Me.name=""),Me.type===5?(le=Me.start,J>0&&le!==B&&(Q[le].name="!StreamData")):Me.size>=4096?(Me.storage="fat",Q[Me.start]===void 0&&(Q[Me.start]=b(H,Me.start,Q.fat_addrs,Q.ssz)),Q[Me.start].name=Me.name,Me.content=Q[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:le!==B&&Me.start!==B&&Q[le]&&(Me.content=x(Me,Q[le].data,(Q[ve]||{}).data))),Me.content&&un(Me.content,0),Z[Re]=Me,ce.push(Me)}}function k(N,Q){return new Date((Ia(N,Q+4)/1e7*Math.pow(2,32)+Ia(N,Q)/1e7-11644473600)*1e3)}function E(N,Q){return u(),h(c.readFileSync(N),Q)}function A(N,Q){var H=Q&&Q.type;switch(H||ft&&Buffer.isBuffer(N)&&(H="buffer"),H||"base64"){case"file":return E(N,Q);case"base64":return h(La(Ga(N)),Q);case"binary":return h(La(N),Q)}return h(N,Q)}function w(N,Q){var H=Q||{},X=H.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=X+"/",N.FileIndex[0]={name:X,type:5}),H.CLSID&&(N.FileIndex[0].clsid=H.CLSID),P(N)}function P(N){var Q="Sh33tJ5";if(!qe.find(N,"/"+Q)){var H=xe(4);H[0]=55,H[1]=H[3]=50,H[2]=54,N.FileIndex.push({name:Q,type:2,content:H,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+Q),M(N)}}function M(N,Q){w(N);for(var H=!1,X=!1,J=N.FullPaths.length-1;J>=0;--J){var Z=N.FileIndex[J];switch(Z.type){case 0:X?H=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(Z.R*Z.L*Z.C)&&(H=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!Q)){var ce=new Date(1987,1,19),ve=0,le=Object.create?Object.create(null):{},ue=[];for(J=0;J<N.FullPaths.length;++J)le[N.FullPaths[J]]=!0,N.FileIndex[J].type!==0&&ue.push([N.FullPaths[J],N.FileIndex[J]]);for(J=0;J<ue.length;++J){var fe=n(ue[J][0]);X=le[fe],X||(ue.push([fe,{name:i(fe).replace("/",""),type:1,clsid:ae,ct:ce,mt:ce,content:null}]),le[fe]=!0)}for(ue.sort(function(Re,Se){return r(Re[0],Se[0])}),N.FullPaths=[],N.FileIndex=[],J=0;J<ue.length;++J)N.FullPaths[J]=ue[J][0],N.FileIndex[J]=ue[J][1];for(J=0;J<ue.length;++J){var je=N.FileIndex[J],Ae=N.FullPaths[J];if(je.name=i(Ae).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||ae,J===0)je.C=ue.length>1?1:-1,je.size=0,je.type=5;else if(Ae.slice(-1)=="/"){for(ve=J+1;ve<ue.length&&n(N.FullPaths[ve])!=Ae;++ve);for(je.C=ve>=ue.length?-1:ve,ve=J+1;ve<ue.length&&n(N.FullPaths[ve])!=n(Ae);++ve);je.R=ve>=ue.length?-1:ve,je.type=1}else n(N.FullPaths[J+1]||"")==n(Ae)&&(je.R=J+1),je.type=2}}}function F(N,Q){var H=Q||{};if(H.fileType=="mad")return qr(N,H);switch(M(N),H.fileType){case"zip":return Dp(N,H)}var X=function(Re){for(var Se=0,Me=0,Je=0;Je<Re.FileIndex.length;++Je){var Lt=Re.FileIndex[Je];if(Lt.content){var Bt=Lt.content.length;Bt>0&&(Bt<4096?Se+=Bt+63>>6:Me+=Bt+511>>9)}}for(var Or=Re.FullPaths.length+3>>2,To=Se+7>>3,Ao=Se+127>>7,Fo=To+Me+Or+Ao,ls=Fo+127>>7,Cd=ls<=109?0:Math.ceil((ls-109)/127);Fo+ls+Cd+127>>7>ls;)Cd=++ls<=109?0:Math.ceil((ls-109)/127);var Ja=[1,Cd,ls,Ao,Or,Me,Se,0];return Re.FileIndex[0].size=Se<<6,Ja[7]=(Re.FileIndex[0].start=Ja[0]+Ja[1]+Ja[2]+Ja[3]+Ja[4]+Ja[5])+(Ja[6]+7>>3),Ja}(N),J=xe(X[7]<<9),Z=0,ce=0;{for(Z=0;Z<8;++Z)J.write_shift(1,Y[Z]);for(Z=0;Z<8;++Z)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),Z=0;Z<3;++Z)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,X[2]),J.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:B),J.write_shift(4,X[3]),J.write_shift(-4,X[1]?X[0]-1:B),J.write_shift(4,X[1]),Z=0;Z<109;++Z)J.write_shift(-4,Z<X[2]?X[1]+Z:-1)}if(X[1])for(ce=0;ce<X[1];++ce){for(;Z<236+ce*127;++Z)J.write_shift(-4,Z<X[2]?X[1]+Z:-1);J.write_shift(-4,ce===X[1]-1?B:ce+1)}var ve=function(Re){for(ce+=Re;Z<ce-1;++Z)J.write_shift(-4,Z+1);Re&&(++Z,J.write_shift(-4,B))};for(ce=Z=0,ce+=X[1];Z<ce;++Z)J.write_shift(-4,U.DIFSECT);for(ce+=X[2];Z<ce;++Z)J.write_shift(-4,U.FATSECT);ve(X[3]),ve(X[4]);for(var le=0,ue=0,fe=N.FileIndex[0];le<N.FileIndex.length;++le)fe=N.FileIndex[le],fe.content&&(ue=fe.content.length,!(ue<4096)&&(fe.start=ce,ve(ue+511>>9)));for(ve(X[6]+7>>3);J.l&511;)J.write_shift(-4,U.ENDOFCHAIN);for(ce=Z=0,le=0;le<N.FileIndex.length;++le)fe=N.FileIndex[le],fe.content&&(ue=fe.content.length,!(!ue||ue>=4096)&&(fe.start=ce,ve(ue+63>>6)));for(;J.l&511;)J.write_shift(-4,U.ENDOFCHAIN);for(Z=0;Z<X[4]<<2;++Z){var je=N.FullPaths[Z];if(!je||je.length===0){for(le=0;le<17;++le)J.write_shift(4,0);for(le=0;le<3;++le)J.write_shift(4,-1);for(le=0;le<12;++le)J.write_shift(4,0);continue}fe=N.FileIndex[Z],Z===0&&(fe.start=fe.size?fe.start-1:B);var Ae=Z===0&&H.root||fe.name;if(ue=2*(Ae.length+1),J.write_shift(64,Ae,"utf16le"),J.write_shift(2,ue),J.write_shift(1,fe.type),J.write_shift(1,fe.color),J.write_shift(-4,fe.L),J.write_shift(-4,fe.R),J.write_shift(-4,fe.C),fe.clsid)J.write_shift(16,fe.clsid,"hex");else for(le=0;le<4;++le)J.write_shift(4,0);J.write_shift(4,fe.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,fe.start),J.write_shift(4,fe.size),J.write_shift(4,0)}for(Z=1;Z<N.FileIndex.length;++Z)if(fe=N.FileIndex[Z],fe.size>=4096)if(J.l=fe.start+1<<9,ft&&Buffer.isBuffer(fe.content))fe.content.copy(J,J.l,0,fe.size),J.l+=fe.size+511&-512;else{for(le=0;le<fe.size;++le)J.write_shift(1,fe.content[le]);for(;le&511;++le)J.write_shift(1,0)}for(Z=1;Z<N.FileIndex.length;++Z)if(fe=N.FileIndex[Z],fe.size>0&&fe.size<4096)if(ft&&Buffer.isBuffer(fe.content))fe.content.copy(J,J.l,0,fe.size),J.l+=fe.size+63&-64;else{for(le=0;le<fe.size;++le)J.write_shift(1,fe.content[le]);for(;le&63;++le)J.write_shift(1,0)}if(ft)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function D(N,Q){var H=N.FullPaths.map(function(le){return le.toUpperCase()}),X=H.map(function(le){var ue=le.split("/");return ue[ue.length-(le.slice(-1)=="/"?2:1)]}),J=!1;Q.charCodeAt(0)===47?(J=!0,Q=H[0].slice(0,-1)+Q):J=Q.indexOf("/")!==-1;var Z=Q.toUpperCase(),ce=J===!0?H.indexOf(Z):X.indexOf(Z);if(ce!==-1)return N.FileIndex[ce];var ve=!Z.match(Vf);for(Z=Z.replace(Zn,""),ve&&(Z=Z.replace(Vf,"!")),ce=0;ce<H.length;++ce)if((ve?H[ce].replace(Vf,"!"):H[ce]).replace(Zn,"")==Z||(ve?X[ce].replace(Vf,"!"):X[ce]).replace(Zn,"")==Z)return N.FileIndex[ce];return null}var W=64,B=-2,G="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",U={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(N,Q,H){u();var X=F(N,H);c.writeFileSync(Q,X)}function z(N){for(var Q=new Array(N.length),H=0;H<N.length;++H)Q[H]=String.fromCharCode(N[H]);return Q.join("")}function ie(N,Q){var H=F(N,Q);switch(Q&&Q.type||"buffer"){case"file":return u(),c.writeFileSync(Q.filename,H),H;case"binary":return typeof H=="string"?H:z(H);case"base64":return N0(typeof H=="string"?H:z(H));case"buffer":if(ft)return Buffer.isBuffer(H)?H:So(H);case"array":return typeof H=="string"?La(H):H}return H}var he;function O(N){try{var Q=N.InflateRaw,H=new Q;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)he=N;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function R(N,Q){if(!he)return hh(N,Q);var H=he.InflateRaw,X=new H,J=X._processChunk(N.slice(N.l),X._finishFlushFlag);return N.l+=X.bytesRead,J}function I(N){return he?he.deflateRawSync(N):nt(N)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(N){var Q=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var L=typeof Uint8Array<"u",se=L?new Uint8Array(256):[],ke=0;ke<256;++ke)se[ke]=ge(ke);function V(N,Q){var H=se[N&255];return Q<=8?H>>>8-Q:(H=H<<8|se[N>>8&255],Q<=16?H>>>16-Q:(H=H<<8|se[N>>16&255],H>>>24-Q))}function Ve(N,Q){var H=Q&7,X=Q>>>3;return(N[X]|(H<=6?0:N[X+1]<<8))>>>H&3}function Ke(N,Q){var H=Q&7,X=Q>>>3;return(N[X]|(H<=5?0:N[X+1]<<8))>>>H&7}function ye(N,Q){var H=Q&7,X=Q>>>3;return(N[X]|(H<=4?0:N[X+1]<<8))>>>H&15}function T(N,Q){var H=Q&7,X=Q>>>3;return(N[X]|(H<=3?0:N[X+1]<<8))>>>H&31}function _e(N,Q){var H=Q&7,X=Q>>>3;return(N[X]|(H<=1?0:N[X+1]<<8))>>>H&127}function St(N,Q,H){var X=Q&7,J=Q>>>3,Z=(1<<H)-1,ce=N[J]>>>X;return H<8-X||(ce|=N[J+1]<<8-X,H<16-X)||(ce|=N[J+2]<<16-X,H<24-X)||(ce|=N[J+3]<<24-X),ce&Z}function Hr(N,Q,H){var X=Q&7,J=Q>>>3;return X<=5?N[J]|=(H&7)<<X:(N[J]|=H<<X&255,N[J+1]=(H&7)>>8-X),Q+3}function xn(N,Q,H){var X=Q&7,J=Q>>>3;return H=(H&1)<<X,N[J]|=H,Q+1}function Un(N,Q,H){var X=Q&7,J=Q>>>3;return H<<=X,N[J]|=H&255,H>>>=8,N[J+1]=H,Q+8}function Mi(N,Q,H){var X=Q&7,J=Q>>>3;return H<<=X,N[J]|=H&255,H>>>=8,N[J+1]=H&255,N[J+2]=H>>>8,Q+16}function la(N,Q){var H=N.length,X=2*H>Q?2*H:Q+5,J=0;if(H>=Q)return N;if(ft){var Z=X5(X);if(N.copy)N.copy(Z);else for(;J<N.length;++J)Z[J]=N[J];return Z}else if(L){var ce=new Uint8Array(X);if(ce.set)ce.set(N);else for(;J<H;++J)ce[J]=N[J];return ce}return N.length=X,N}function re(N){for(var Q=new Array(N),H=0;H<N;++H)Q[H]=0;return Q}function De(N,Q,H){var X=1,J=0,Z=0,ce=0,ve=0,le=N.length,ue=L?new Uint16Array(32):re(32);for(Z=0;Z<32;++Z)ue[Z]=0;for(Z=le;Z<H;++Z)N[Z]=0;le=N.length;var fe=L?new Uint16Array(le):re(le);for(Z=0;Z<le;++Z)ue[J=N[Z]]++,X<J&&(X=J),fe[Z]=0;for(ue[0]=0,Z=1;Z<=X;++Z)ue[Z+16]=ve=ve+ue[Z-1]<<1;for(Z=0;Z<le;++Z)ve=N[Z],ve!=0&&(fe[Z]=ue[ve+16]++);var je=0;for(Z=0;Z<le;++Z)if(je=N[Z],je!=0)for(ve=V(fe[Z],X)>>X-je,ce=(1<<X+4-je)-1;ce>=0;--ce)Q[ve|ce<<je]=je&15|Z<<4;return X}var Wr=L?new Uint16Array(512):re(512),Oi=L?new Uint16Array(32):re(32);if(!L){for(var Gr=0;Gr<512;++Gr)Wr[Gr]=0;for(Gr=0;Gr<32;++Gr)Oi[Gr]=0}(function(){for(var N=[],Q=0;Q<32;Q++)N.push(5);De(N,Oi,32);var H=[];for(Q=0;Q<=143;Q++)H.push(8);for(;Q<=255;Q++)H.push(9);for(;Q<=279;Q++)H.push(7);for(;Q<=287;Q++)H.push(8);De(H,Wr,288)})();var $a=function(){for(var Q=L?new Uint8Array(32768):[],H=0,X=0;H<ee.length-1;++H)for(;X<ee[H+1];++X)Q[X]=H;for(;X<32768;++X)Q[X]=29;var J=L?new Uint8Array(259):[];for(H=0,X=0;H<ne.length-1;++H)for(;X<ne[H+1];++X)J[X]=H;function Z(ve,le){for(var ue=0;ue<ve.length;){var fe=Math.min(65535,ve.length-ue),je=ue+fe==ve.length;for(le.write_shift(1,+je),le.write_shift(2,fe),le.write_shift(2,~fe&65535);fe-- >0;)le[le.l++]=ve[ue++]}return le.l}function ce(ve,le){for(var ue=0,fe=0,je=L?new Uint16Array(32768):[];fe<ve.length;){var Ae=Math.min(65535,ve.length-fe);if(Ae<10){for(ue=Hr(le,ue,+(fe+Ae==ve.length)),ue&7&&(ue+=8-(ue&7)),le.l=ue/8|0,le.write_shift(2,Ae),le.write_shift(2,~Ae&65535);Ae-- >0;)le[le.l++]=ve[fe++];ue=le.l*8;continue}ue=Hr(le,ue,+(fe+Ae==ve.length)+2);for(var Re=0;Ae-- >0;){var Se=ve[fe];Re=(Re<<5^Se)&32767;var Me=-1,Je=0;if((Me=je[Re])&&(Me|=fe&-32768,Me>fe&&(Me-=32768),Me<fe))for(;ve[Me+Je]==ve[fe+Je]&&Je<250;)++Je;if(Je>2){Se=J[Je],Se<=22?ue=Un(le,ue,se[Se+1]>>1)-1:(Un(le,ue,3),ue+=5,Un(le,ue,se[Se-23]>>5),ue+=3);var Lt=Se<8?0:Se-4>>2;Lt>0&&(Mi(le,ue,Je-ne[Se]),ue+=Lt),Se=Q[fe-Me],ue=Un(le,ue,se[Se]>>3),ue-=3;var Bt=Se<4?0:Se-2>>1;Bt>0&&(Mi(le,ue,fe-Me-ee[Se]),ue+=Bt);for(var Or=0;Or<Je;++Or)je[Re]=fe&32767,Re=(Re<<5^ve[fe])&32767,++fe;Ae-=Je-1}else Se<=143?Se=Se+48:ue=xn(le,ue,1),ue=Un(le,ue,se[Se]),je[Re]=fe&32767,++fe}ue=Un(le,ue,0)-1}return le.l=(ue+7)/8|0,le.l}return function(le,ue){return le.length<8?Z(le,ue):ce(le,ue)}}();function nt(N){var Q=xe(50+Math.floor(N.length*1.1)),H=$a(N,Q);return Q.slice(0,H)}var Jt=L?new Uint16Array(32768):re(32768),Vn=L?new Uint16Array(32768):re(32768),lr=L?new Uint16Array(128):re(128),os=1,uh=1;function Tp(N,Q){var H=T(N,Q)+257;Q+=5;var X=T(N,Q)+1;Q+=5;var J=ye(N,Q)+4;Q+=4;for(var Z=0,ce=L?new Uint8Array(19):re(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ue=L?new Uint8Array(8):re(8),fe=L?new Uint8Array(8):re(8),je=ce.length,Ae=0;Ae<J;++Ae)ce[K[Ae]]=Z=Ke(N,Q),le<Z&&(le=Z),ue[Z]++,Q+=3;var Re=0;for(ue[0]=0,Ae=1;Ae<=le;++Ae)fe[Ae]=Re=Re+ue[Ae-1]<<1;for(Ae=0;Ae<je;++Ae)(Re=ce[Ae])!=0&&(ve[Ae]=fe[Re]++);var Se=0;for(Ae=0;Ae<je;++Ae)if(Se=ce[Ae],Se!=0){Re=se[ve[Ae]]>>8-Se;for(var Me=(1<<7-Se)-1;Me>=0;--Me)lr[Re|Me<<Se]=Se&7|Ae<<3}var Je=[];for(le=1;Je.length<H+X;)switch(Re=lr[_e(N,Q)],Q+=Re&7,Re>>>=3){case 16:for(Z=3+Ve(N,Q),Q+=2,Re=Je[Je.length-1];Z-- >0;)Je.push(Re);break;case 17:for(Z=3+Ke(N,Q),Q+=3;Z-- >0;)Je.push(0);break;case 18:for(Z=11+_e(N,Q),Q+=7;Z-- >0;)Je.push(0);break;default:Je.push(Re),le<Re&&(le=Re);break}var Lt=Je.slice(0,H),Bt=Je.slice(H);for(Ae=H;Ae<286;++Ae)Lt[Ae]=0;for(Ae=X;Ae<30;++Ae)Bt[Ae]=0;return os=De(Lt,Jt,286),uh=De(Bt,Vn,30),Q}function Ap(N,Q){if(N[0]==3&&!(N[1]&3))return[Rl(Q),2];for(var H=0,X=0,J=X5(Q||1<<18),Z=0,ce=J.length>>>0,ve=0,le=0;!(X&1);){if(X=Ke(N,H),H+=3,X>>>1)X>>1==1?(ve=9,le=5):(H=Tp(N,H),ve=os,le=uh);else{H&7&&(H+=8-(H&7));var ue=N[H>>>3]|N[(H>>>3)+1]<<8;if(H+=32,ue>0)for(!Q&&ce<Z+ue&&(J=la(J,Z+ue),ce=J.length);ue-- >0;)J[Z++]=N[H>>>3],H+=8;continue}for(;;){!Q&&ce<Z+32767&&(J=la(J,Z+32767),ce=J.length);var fe=St(N,H,ve),je=X>>>1==1?Wr[fe]:Jt[fe];if(H+=je&15,je>>>=4,!(je>>>8&255))J[Z++]=je;else{if(je==256)break;je-=257;var Ae=je<8?0:je-4>>2;Ae>5&&(Ae=0);var Re=Z+ne[je];Ae>0&&(Re+=St(N,H,Ae),H+=Ae),fe=St(N,H,le),je=X>>>1==1?Oi[fe]:Vn[fe],H+=je&15,je>>>=4;var Se=je<4?0:je-2>>1,Me=ee[je];for(Se>0&&(Me+=St(N,H,Se),H+=Se),!Q&&ce<Re&&(J=la(J,Re+100),ce=J.length);Z<Re;)J[Z]=J[Z-Me],++Z}}}return Q?[J,H+7>>>3]:[J.slice(0,Z),H+7>>>3]}function hh(N,Q){var H=N.slice(N.l||0),X=Ap(H,Q);return N.l+=X[1],X[0]}function fh(N,Q){if(N)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function ph(N,Q){var H=N;un(H,0);var X=[],J=[],Z={FileIndex:X,FullPaths:J};w(Z,{root:Q.root});for(var ce=H.length-4;(H[ce]!=80||H[ce+1]!=75||H[ce+2]!=5||H[ce+3]!=6)&&ce>=0;)--ce;H.l=ce+4,H.l+=4;var ve=H.read_shift(2);H.l+=6;var le=H.read_shift(4);for(H.l=le,ce=0;ce<ve;++ce){H.l+=20;var ue=H.read_shift(4),fe=H.read_shift(4),je=H.read_shift(2),Ae=H.read_shift(2),Re=H.read_shift(2);H.l+=8;var Se=H.read_shift(4),Me=l(H.slice(H.l+je,H.l+je+Ae));H.l+=je+Ae+Re;var Je=H.l;H.l=Se+4,Fp(H,ue,fe,Z,Me),H.l=Je}return Z}function Fp(N,Q,H,X,J){N.l+=2;var Z=N.read_shift(2),ce=N.read_shift(2),ve=o(N);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var le=N.read_shift(4),ue=N.read_shift(4),fe=N.read_shift(4),je=N.read_shift(2),Ae=N.read_shift(2),Re="",Se=0;Se<je;++Se)Re+=String.fromCharCode(N[N.l++]);if(Ae){var Me=l(N.slice(N.l,N.l+Ae));(Me[21589]||{}).mt&&(ve=Me[21589].mt),((J||{})[21589]||{}).mt&&(ve=J[21589].mt)}N.l+=Ae;var Je=N.slice(N.l,N.l+ue);switch(ce){case 8:Je=R(N,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Lt=!1;Z&8&&(le=N.read_shift(4),le==134695760&&(le=N.read_shift(4),Lt=!0),ue=N.read_shift(4),fe=N.read_shift(4)),ue!=Q&&fh(Lt,"Bad compressed size: "+Q+" != "+ue),fe!=H&&fh(Lt,"Bad uncompressed size: "+H+" != "+fe),Xa(X,Re,Je,{unsafe:!0,mt:ve})}function Dp(N,Q){var H=Q||{},X=[],J=[],Z=xe(1),ce=H.compression?8:0,ve=0,le=0,ue=0,fe=0,je=0,Ae=N.FullPaths[0],Re=Ae,Se=N.FileIndex[0],Me=[],Je=0;for(le=1;le<N.FullPaths.length;++le)if(Re=N.FullPaths[le].slice(Ae.length),Se=N.FileIndex[le],!(!Se.size||!Se.content||Re=="Sh33tJ5")){var Lt=fe,Bt=xe(Re.length);for(ue=0;ue<Re.length;++ue)Bt.write_shift(1,Re.charCodeAt(ue)&127);Bt=Bt.slice(0,Bt.l),Me[je]=cW.buf(Se.content,0);var Or=Se.content;ce==8&&(Or=I(Or)),Z=xe(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,ve),Z.write_shift(2,ce),Se.mt?s(Z,Se.mt):Z.write_shift(4,0),Z.write_shift(-4,Me[je]),Z.write_shift(4,Or.length),Z.write_shift(4,Se.content.length),Z.write_shift(2,Bt.length),Z.write_shift(2,0),fe+=Z.length,X.push(Z),fe+=Bt.length,X.push(Bt),fe+=Or.length,X.push(Or),Z=xe(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,ve),Z.write_shift(2,ce),Z.write_shift(4,0),Z.write_shift(-4,Me[je]),Z.write_shift(4,Or.length),Z.write_shift(4,Se.content.length),Z.write_shift(2,Bt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Lt),Je+=Z.l,J.push(Z),Je+=Bt.length,J.push(Bt),++je}return Z=xe(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,je),Z.write_shift(2,je),Z.write_shift(4,Je),Z.write_shift(4,fe),Z.write_shift(2,0),Zr([Zr(X),Zr(J),Z])}var Kl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pp(N,Q){if(N.ctype)return N.ctype;var H=N.name||"",X=H.match(/\.([^\.]+)$/);return X&&Kl[X[1]]||Q&&(X=(H=Q).match(/[\.\\]([^\.\\])+$/),X&&Kl[X[1]])?Kl[X[1]]:"application/octet-stream"}function Mp(N){for(var Q=N0(N),H=[],X=0;X<Q.length;X+=76)H.push(Q.slice(X,X+76));return H.join(`\r
`)+`\r
`}function Op(N){var Q=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var fe=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],X=Q.split(`\r
`),J=0;J<X.length;++J){var Z=X[J];if(Z.length==0){H.push("");continue}for(var ce=0;ce<Z.length;){var ve=76,le=Z.slice(ce,ce+ve);le.charAt(ve-1)=="="?ve--:le.charAt(ve-2)=="="?ve-=2:le.charAt(ve-3)=="="&&(ve-=3),le=Z.slice(ce,ce+ve),ce+=ve,ce<Z.length&&(le+="="),H.push(le)}}return H.join(`\r
`)}function C(N){for(var Q=[],H=0;H<N.length;++H){for(var X=N[H];H<=N.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+N[++H];Q.push(X)}for(var J=0;J<Q.length;++J)Q[J]=Q[J].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return La(Q.join(`\r
`))}function $e(N,Q,H){for(var X="",J="",Z="",ce,ve=0;ve<10;++ve){var le=Q[ve];if(!le||le.match(/^\s*$/))break;var ue=le.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":X=ue[2].trim();break;case"content-type":Z=ue[2].trim();break;case"content-transfer-encoding":J=ue[2].trim();break}}switch(++ve,J.toLowerCase()){case"base64":ce=La(Ga(Q.slice(ve).join("")));break;case"quoted-printable":ce=C(Q.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var fe=Xa(N,X.slice(H.length),ce,{unsafe:!0});Z&&(fe.ctype=Z)}function xt(N,Q){if(z(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=Q&&Q.root||"",X=(ft&&Buffer.isBuffer(N)?N.toString("binary"):z(N)).split(`\r
`),J=0,Z="";for(J=0;J<X.length;++J)if(Z=X[J],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),H||(H=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),Z.slice(0,H.length)!=H););var ce=(X[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ve="--"+(ce[1]||""),le=[],ue=[],fe={FileIndex:le,FullPaths:ue};w(fe);var je,Ae=0;for(J=0;J<X.length;++J){var Re=X[J];Re!==ve&&Re!==ve+"--"||(Ae++&&$e(fe,X.slice(je,J),H),je=J)}return fe}function qr(N,Q){var H=Q||{},X=H.boundary||"SheetJS";X="------="+X;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],Z=N.FullPaths[0],ce=Z,ve=N.FileIndex[0],le=1;le<N.FullPaths.length;++le)if(ce=N.FullPaths[le].slice(Z.length),ve=N.FileIndex[le],!(!ve.size||!ve.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var ue=ve.content,fe=ft&&Buffer.isBuffer(ue)?ue.toString("binary"):z(ue),je=0,Ae=Math.min(1024,fe.length),Re=0,Se=0;Se<=Ae;++Se)(Re=fe.charCodeAt(Se))>=32&&Re<128&&++je;var Me=je>=Ae*4/5;J.push(X),J.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+ce),J.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),J.push("Content-Type: "+Pp(ve,ce)),J.push(""),J.push(Me?Op(fe):Mp(fe))}return J.push(X+`--\r
`),J.join(`\r
`)}function Ht(N){var Q={};return w(Q,N),Q}function Xa(N,Q,H,X){var J=X&&X.unsafe;J||w(N);var Z=!J&&qe.find(N,Q);if(!Z){var ce=N.FullPaths[0];Q.slice(0,ce.length)==ce?ce=Q:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+Q).replace("//","/")),Z={name:i(Q),type:2},N.FileIndex.push(Z),N.FullPaths.push(ce),J||qe.utils.cfb_gc(N)}return Z.content=H,Z.size=H?H.length:0,X&&(X.CLSID&&(Z.clsid=X.CLSID),X.mt&&(Z.mt=X.mt),X.ct&&(Z.ct=X.ct)),Z}function Ya(N,Q){w(N);var H=qe.find(N,Q);if(H){for(var X=0;X<N.FileIndex.length;++X)if(N.FileIndex[X]==H)return N.FileIndex.splice(X,1),N.FullPaths.splice(X,1),!0}return!1}function Kr(N,Q,H){w(N);var X=qe.find(N,Q);if(X){for(var J=0;J<N.FileIndex.length;++J)if(N.FileIndex[J]==X)return N.FileIndex[J].name=i(H),N.FullPaths[J]=H,!0}return!1}function Qa(N){M(N,!0)}return t.find=D,t.read=A,t.parse=h,t.write=ie,t.writeFile=q,t.utils={cfb_new:Ht,cfb_add:Xa,cfb_del:Ya,cfb_mov:Kr,cfb_gc:Qa,ReadShift:i0,CheckField:$8,prep_blob:un,bconcat:Zr,use_zlib:O,_deflateRaw:nt,_inflateRaw:hh,consts:U},t}();function dW(e){return typeof e=="string"?sv(e):Array.isArray(e)?RH(e):e}function _p(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=sv(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Fs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([dW(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Wl(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function uW(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function mr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function nE(e,t){for(var r=[],n=mr(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function lv(e){for(var t=[],r=mr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function cv(e){for(var t=[],r=mr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function hW(e){for(var t=[],r=mr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var m1=new Date(1899,11,30,0,0,0);function Vr(e,t){var r=e.getTime(),n=m1.getTime()+(e.getTimezoneOffset()-m1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var s8=new Date,fW=m1.getTime()+(s8.getTimezoneOffset()-m1.getTimezoneOffset())*6e4,aE=s8.getTimezoneOffset();function dv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+fW),t.getTimezoneOffset()!==aE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-aE)*6e4),t}function pW(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var iE=new Date("2017-02-19T19:06:09.000Z"),o8=isNaN(iE.getFullYear())?new Date("2/19/17"):iE,mW=o8.getFullYear()==2017;function Yt(e,t){var r=new Date(e);if(mW)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(o8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function od(e,t){if(ft&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Fs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fs(KP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Fs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Qt(e[r]));return t}function hr(e,t){for(var r="";r.length<t;)r+=e;return r}function rs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var gW=["january","february","march","april","may","june","july","august","september","october","november","december"];function qu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&gW.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var xW=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function l8(e){return e?e.content&&e.type?od(e.content,!0):e.data?Uf(e.data):e.asNodeBuffer&&ft?Uf(e.asNodeBuffer().toString("binary")):e.asBinary?Uf(e.asBinary()):e._data&&e._data.getContent?Uf(od(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function c8(e){if(!e)return null;if(e.data)return q5(e.data);if(e.asNodeBuffer&&ft)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?q5(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function vW(e){return e&&e.name.slice(-4)===".bin"?c8(e):l8(e)}function xi(e,t){for(var r=e.FullPaths||mr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ek(e,t){var r=xi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Tr(e,t,r){if(!r)return vW(Ek(e,t));if(!t)return null;try{return Tr(e,t)}catch{return null}}function Ba(e,t,r){if(!r)return l8(Ek(e,t));if(!t)return null;try{return Ba(e,t)}catch{return null}}function _W(e,t,r){return c8(Ek(e,t))}function sE(e){for(var t=e.FullPaths||mr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function at(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ft?n=So(r):n=NH(r),qe.utils.cfb_add(e,t,n)}qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function Tk(){return qe.utils.cfb_new()}function d8(e,t){switch(t.type){case"base64":return qe.read(e,{type:"base64"});case"binary":return qe.read(e,{type:"binary"});case"buffer":case"array":return qe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yW=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,bW=/<[^>]*>/g,Bn=wr.match(oE)?oE:bW,jW=/<\w*:/,wW=/<(\/?)\w+:/;function Qe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(yW),l=0,c="",u=0,h="",f="",m=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(m=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+m,f.length-m),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var v=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[v]&&h.slice(l-3,l)=="ext")continue;n[v]=c,n[v.toLowerCase()]=c}}return n}function Os(e){return e.replace(wW,"<$1")}var u8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ak=lv(u8),jt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return u8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),Fk=/[&<>'"]/g,kW=/[\u0000-\u0008\u000b-\u001f]/g;function Rt(e){var t=e+"";return t.replace(Fk,function(r){return Ak[r]}).replace(kW,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lE(e){return Rt(e).replace(/ /g,"_x0020_")}var h8=/[\u0000-\u001f]/g;function Dk(e){var t=e+"";return t.replace(Fk,function(r){return Ak[r]}).replace(/\n/g,"<br/>").replace(h8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function CW(e){var t=e+"";return t.replace(Fk,function(r){return Ak[r]}).replace(h8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var cE=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function SW(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function fy(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function dE(e){var t=Rl(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function uE(e){return So(e,"binary").toString("utf8")}var Sm="foo bar baz",It=ft&&(uE(Sm)==fy(Sm)&&uE||dE(Sm)==fy(Sm)&&dE)||fy,Fs=ft?function(e){return So(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},I0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),f8=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),$W=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),EW=/<\/?(?:vt:)?variant>/g,TW=/<(?:vt:)([^>]*)>([\s\S]*)</;function hE(e,t){var r=Qe(e),n=e.match($W(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(EW,"").match(TW);o&&i.push({v:It(o[2]),t:o[1]})}),i}var p8=/(^\s|\s$|\n)/;function hn(e,t){return"<"+e+(t.match(p8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function L0(e){return mr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ee(e,t,r){return"<"+e+(r!=null?L0(r):"")+(t!=null?(t.match(p8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Rw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function AW(e,t){switch(typeof e){case"string":var r=Ee("vt:lpwstr",Rt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ee((e|0)==e?"vt:i4":"vt:r8",Rt(String(e)));case"boolean":return Ee("vt:bool",e?"true":"false")}if(e instanceof Date)return Ee("vt:filetime",Rw(e));throw new Error("Unable to serialize "+e)}function Pk(e){if(ft&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return It(Wl(Ck(e)));throw new Error("Bad input format: expected Buffer or string")}var B0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ir={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function FW(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function DW(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var fE=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},pE=ft?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:So(t)})):fE(e)}:fE,mE=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(uo(e,i)));return n.join("").replace(Zn,"")},Mk=ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zn,""):mE(e,t,r)}:mE,gE=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},m8=ft?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gE(e,t,r)}:gE,xE=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Gd(e,i)));return n.join("")},yp=ft?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xE(t,r,n)}:xE,g8=function(e,t){var r=Ia(e,t);return r>0?yp(e,t+4,t+4+r-1):""},x8=g8,v8=function(e,t){var r=Ia(e,t);return r>0?yp(e,t+4,t+4+r-1):""},_8=v8,y8=function(e,t){var r=2*Ia(e,t);return r>0?yp(e,t+4,t+4+r-1):""},b8=y8,j8=function(t,r){var n=Ia(t,r);return n>0?Mk(t,r+4,r+4+n):""},w8=j8,k8=function(e,t){var r=Ia(e,t);return r>0?yp(e,t+4,t+4+r):""},C8=k8,S8=function(e,t){return FW(e,t)},g1=S8,Ok=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ft&&(x8=function(t,r){if(!Buffer.isBuffer(t))return g8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_8=function(t,r){if(!Buffer.isBuffer(t))return v8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},b8=function(t,r){if(!Buffer.isBuffer(t))return y8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},w8=function(t,r){if(!Buffer.isBuffer(t))return j8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},C8=function(t,r){if(!Buffer.isBuffer(t))return k8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},g1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):S8(t,r)},Ok=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Gd=function(e,t){return e[t]},uo=function(e,t){return e[t+1]*256+e[t]},PW=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ia=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},kc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},MW=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function i0(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(uo(this,u)),u+=2;e*=2;break;case"utf8":r=yp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Mk(this,this.l,this.l+e);break;case"wstr":return i0.call(this,e,"dbcs");case"lpstr-ansi":r=x8(this,this.l),e=4+Ia(this,this.l);break;case"lpstr-cp":r=_8(this,this.l),e=4+Ia(this,this.l);break;case"lpwstr":r=b8(this,this.l),e=4+2*Ia(this,this.l);break;case"lpp4":e=4+Ia(this,this.l),r=w8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ia(this,this.l),r=C8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Gd(this,this.l+e++))!==0;)s.push(Cm(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=uo(this,this.l+e))!==0;)s.push(Cm(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Gd(this,u),this.l=u+1,l=i0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Cm(uo(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Gd(this,u),this.l=u+1,l=i0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Cm(Gd(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Gd(this,this.l),this.l++,n;case 2:return n=(t==="i"?PW:uo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?kc:MW)(this,this.l),this.l+=4,n):(i=Ia(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=g1(this,this.l):i=g1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=m8(this,this.l,e);break}}return this.l+=e,r}var OW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},RW=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},NW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function zW(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)NW(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,OW(this,t,this.l);break;case 8:if(n=8,r==="f"){DW(this,t,this.l);break}case 16:break;case-4:n=4,RW(this,t,this.l);break}return this.l+=n,this}function $8(e,t){var r=m8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function un(e,t){e.l=t,e.read_shift=i0,e.chk=$8,e.write_shift=zW}function In(e,t){e.l+=t}function xe(e){var t=Rl(e);return un(t,0),t}function $o(e,t,r){if(e){var n,i,s;un(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=q0[l]||q0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var h=u.f&&u.f(e,s,r);if(e.l=c,t(h,u,l))return}}}function Ca(){var e=[],t=ft?256:2048,r=function(u){var h=xe(u);return un(h,0),h},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Zr(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function be(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=q0[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Ok(r)&&e.push(r)}}function s0(e,t,r){var n=Qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vE(e,t,r){var n=Qt(e);return n.s=s0(n.s,t.s,r),n.e=s0(n.e,t.s,r),n}function o0(e,t){if(e.cRel&&e.c<0)for(e=Qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ye(e);return!e.cRel&&e.cRel!=null&&(r=BW(r)),!e.rRel&&e.rRel!=null&&(r=IW(r)),r}function py(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+nr(e.s.c)+":"+(e.e.cRel?"":"$")+nr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jr(e.s.r)+":"+(e.e.rRel?"":"$")+jr(e.e.r):o0(e.s,t.biff)+":"+o0(e.e,t.biff)}function Rk(e){return parseInt(LW(e),10)-1}function jr(e){return""+(e+1)}function IW(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LW(e){return e.replace(/\$(\d+)$/,"$1")}function Nk(e){for(var t=UW(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function nr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function BW(e){return e.replace(/^([A-Z])/,"$$$1")}function UW(e){return e.replace(/^\$([A-Z])/,"$1")}function VW(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ar(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ye(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Sa(e){var t=e.indexOf(":");return t==-1?{s:ar(e),e:ar(e)}:{s:ar(e.slice(0,t)),e:ar(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Ye(e)),typeof t!="string"&&(t=Ye(t)),e==t?e:e+":"+t)}function wt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function _E(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fi(e.z,r?Vr(t):t)}catch{}try{return e.w=Fi((e.XF||{}).numFmtId||(r?14:0),r?Vr(t):t)}catch{return""+t}}function ko(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Eo[e.v]||e.v:t==null?_E(e,e.v):_E(e,t))}function Gl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function E8(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ar(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=wt(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(u.e.r=o=h.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var v={v:t[f][m]},g=o+f,x=l+m;if(u.s.r>g&&(u.s.r=g),u.s.c>x&&(u.s.c=x),u.e.r<g&&(u.e.r=g),u.e.c<x&&(u.e.c=x),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))v=t[f][m];else if(Array.isArray(v.v)&&(v.f=t[f][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||Xe[14],n.cellDates?(v.t="d",v.w=Fi(v.z,Vr(v.v))):(v.t="n",v.v=Vr(v.v),v.w=Fi(v.z,v.v))):v.t="s";if(i)s[g]||(s[g]=[]),s[g][x]&&s[g][x].z&&(v.z=s[g][x].z),s[g][x]=v;else{var _=Ye({c:x,r:g});s[_]&&s[_].z&&(v.z=s[_].z),s[_]=v}}}return u.s.c<1e7&&(s["!ref"]=rt(u)),s}function oh(e,t){return E8(null,e,t)}function HW(e){return e.read_shift(4,"i")}function ns(e,t){return t||(t=xe(4)),t.write_shift(4,e),t}function Nn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function en(e,t){var r=!1;return t==null&&(r=!0,t=xe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function WW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function GW(e,t){return t||(t=xe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function zk(e,t){var r=e.l,n=e.read_shift(1),i=Nn(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(WW(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function qW(e,t){var r=!1;return t==null&&(r=!0,t=xe(15+4*e.t.length)),t.write_shift(1,0),en(e.t,t),r?t.slice(0,t.l):t}var KW=zk;function XW(e,t){var r=!1;return t==null&&(r=!0,t=xe(23+4*e.t.length)),t.write_shift(1,1),en(e.t,t),t.write_shift(4,1),GW({},t),r?t.slice(0,t.l):t}function Pi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vd(e,t){return t==null&&(t=xe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function _d(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function yd(e,t){return t==null&&(t=xe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var YW=Nn,T8=en;function Ik(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function x1(e,t){var r=!1;return t==null&&(r=!0,t=xe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var QW=Nn,Nw=Ik,Lk=x1;function Bk(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?g1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):kc(t,0)>>2;return r?i/100:i}function A8(e,t){t==null&&(t=xe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function F8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function JW(e,t){return t||(t=xe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bd=F8,lh=JW;function Dn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ld(e,t){return(t||xe(8)).write_shift(8,e,"f")}function ZW(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=Gc[i];u&&(t.rgb=V0(u));break;case 2:t.rgb=V0([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function v1(e,t){if(t||(t=xe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function eG(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tG(e,t){t||(t=xe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function D8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function rG(e){return D8(e,1)}function nG(e){return D8(e,2)}var Uk=2,ma=3,$m=11,yE=12,_1=19,Em=64,aG=65,iG=71,sG=4108,oG=4126,Yr=80,P8=81,lG=[Yr,P8],zw={1:{n:"CodePage",t:Uk},2:{n:"Category",t:Yr},3:{n:"PresentationFormat",t:Yr},4:{n:"ByteCount",t:ma},5:{n:"LineCount",t:ma},6:{n:"ParagraphCount",t:ma},7:{n:"SlideCount",t:ma},8:{n:"NoteCount",t:ma},9:{n:"HiddenCount",t:ma},10:{n:"MultimediaClipCount",t:ma},11:{n:"ScaleCrop",t:$m},12:{n:"HeadingPairs",t:sG},13:{n:"TitlesOfParts",t:oG},14:{n:"Manager",t:Yr},15:{n:"Company",t:Yr},16:{n:"LinksUpToDate",t:$m},17:{n:"CharacterCount",t:ma},19:{n:"SharedDoc",t:$m},22:{n:"HyperlinksChanged",t:$m},23:{n:"AppVersion",t:ma,p:"version"},24:{n:"DigSig",t:aG},26:{n:"ContentType",t:Yr},27:{n:"ContentStatus",t:Yr},28:{n:"Language",t:Yr},29:{n:"Version",t:Yr},255:{},2147483648:{n:"Locale",t:_1},2147483651:{n:"Behavior",t:_1},1919054434:{}},Iw={1:{n:"CodePage",t:Uk},2:{n:"Title",t:Yr},3:{n:"Subject",t:Yr},4:{n:"Author",t:Yr},5:{n:"Keywords",t:Yr},6:{n:"Comments",t:Yr},7:{n:"Template",t:Yr},8:{n:"LastAuthor",t:Yr},9:{n:"RevNumber",t:Yr},10:{n:"EditTime",t:Em},11:{n:"LastPrinted",t:Em},12:{n:"CreatedDate",t:Em},13:{n:"ModifiedDate",t:Em},14:{n:"PageCount",t:ma},15:{n:"WordCount",t:ma},16:{n:"CharCount",t:ma},17:{n:"Thumbnail",t:iG},18:{n:"Application",t:Yr},19:{n:"DocSecurity",t:ma},255:{},2147483648:{n:"Locale",t:_1},2147483651:{n:"Behavior",t:_1},1919054434:{}},bE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function dG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uG=dG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gc=Qt(uG),Eo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},M8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Lw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Tm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hG(e){var t=Vk();if(!e||!e.match)return t;var r={};if((e.match(Bn)||[]).forEach(function(n){var i=Qe(n);switch(i[0].replace(jW,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Lw[i.ContentType]]!==void 0&&t[Lw[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Ir.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O8(e,t){var r=hW(Lw),n=[],i;n[n.length]=wr,n[n.length]=Ee("Types",null,{xmlns:Ir.CT,"xmlns:xsd":Ir.xsd,"xmlns:xsi":Ir.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ee("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=Ee("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Tm[c][t.bookType]||Tm[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ee("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Tm[c][t.bookType]||Tm[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ee("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function U0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function l0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Bn)||[]).forEach(function(i){var s=Qe(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Hf(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function gu(e){var t=[wr,Ee("Relationships",null,{xmlns:Ir.RELS})];return mr(e["!id"]).forEach(function(r){t[t.length]=Ee("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Pt(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[pt.HLINK,pt.XPATH,pt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var fG="application/vnd.oasis.opendocument.spreadsheet";function pG(e,t){for(var r=Pk(e),n,i;n=B0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Qe(n[0],!1),i.path=="/"&&i.type!==fG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function mG(e){var t=[wr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function jE(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function gG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function xG(e){var t=[wr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(jE(e[r][0],e[r][1])),t.push(gG("",e[r][0]));return t.push(jE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function R8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+u1.version+"</meta:generator></office:meta></office:document-meta>"}var $i=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vG=function(){for(var e=new Array($i.length),t=0;t<$i.length;++t){var r=$i[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function N8(e){var t={};e=It(e);for(var r=0;r<$i.length;++r){var n=$i[r],i=e.match(vG[r]);i!=null&&i.length>0&&(t[n[1]]=jt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Yt(t[n[1]]))}return t}function my(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Rt(t),n[n.length]=r?Ee(e,t,r):hn(e,t))}function z8(e,t){var r=t||{},n=[wr,Ee("cp:coreProperties",null,{"xmlns:cp":Ir.CORE_PROPS,"xmlns:dc":Ir.dc,"xmlns:dcterms":Ir.dcterms,"xmlns:dcmitype":Ir.dcmitype,"xmlns:xsi":Ir.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&my("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&my("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=$i.length;++s){var o=$i[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&my(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],I8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L8(e,t,r,n){var i=[];if(typeof e=="string")i=hE(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(h){return{v:h}}));var o=typeof t=="string"?hE(t,n).map(function(h){return h.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function _G(e,t,r){var n={};return t||(t={}),e=It(e),qc.forEach(function(i){var s=(e.match(I0(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=jt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&L8(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B8(e){var t=[],r=Ee;return e||(e={}),e.Application="SheetJS",t[t.length]=wr,t[t.length]=Ee("Properties",null,{xmlns:Ir.EXT_PROPS,"xmlns:vt":Ir.vt}),qc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Rt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Rt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yG=/<[^>]+>[^<]*/g;function bG(e,t){var r={},n="",i=e.match(yG);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Qe(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),h=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(h);break;case"bool":r[n]=Kt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Yt(h);break;case"cy":case"error":r[n]=jt(h);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function U8(e){var t=[wr,Ee("Properties",null,{xmlns:Ir.CUST_PROPS,"xmlns:vt":Ir.vt})];if(!e)return t.join("");var r=1;return mr(e).forEach(function(i){++r,t[t.length]=Ee("property",AW(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Rt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Bw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gy;function jG(e,t,r){gy||(gy=lv(Bw)),t=gy[t]||t,e[t]=r}function wG(e,t){var r=[];return mr(Bw).map(function(n){for(var i=0;i<$i.length;++i)if($i[i][1]==n)return $i[i];for(i=0;i<qc.length;++i)if(qc[i][1]==n)return qc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(hn(Bw[n[1]]||n[1],i))}}),Ee("DocumentProperties",r.join(""),{xmlns:za.o})}function kG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&mr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<$i.length;++o)if(s==$i[o][1])return;for(o=0;o<qc.length;++o)if(s==qc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(Ee(lE(s),l,{"dt:dt":c}))}}),t&&mr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ee(lE(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+za.o+'">'+i.join("")+"</"+n+">"}function Hk(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function CG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=xe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function V8(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function H8(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function W8(e,t,r){return t===31?H8(e):V8(e,t,r)}function Uw(e,t,r){return W8(e,t,r===!1?0:4)}function SG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return W8(e,t,0)}function $G(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zn,""),e.l-i&2&&(e.l+=2)}return r}function EG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zn,"");return r}function TG(e){var t=e.l,r=y1(e,P8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=y1(e,ma);return[r,n]}function AG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(TG(e));return r}function wE(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Zn,"").replace(Vf,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function G8(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function FG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function y1(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==yE&&n!==t&&lG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yE?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return V8(e,n,4).replace(Zn,"");case 31:return H8(e);case 64:return Hk(e);case 65:return G8(e);case 71:return FG(e);case 80:return Uw(e,n,!s.raw).replace(Zn,"");case 81:return SG(e,n).replace(Zn,"");case 4108:return AG(e);case 4126:case 4127:return n==4127?$G(e):EG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function kE(e,t){var r=xe(4),n=xe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=xe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=CG(t);break;case 31:case 80:for(n=xe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Zr([r,n])}function CE(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var h=e.read_shift(4),f=e.read_shift(4);s[o]=[h,f+r]}s.sort(function(y,j){return y[1]-j[1]});var m={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var v=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(v=!1,e.l=s[o][1]),v)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[s[o][0]];if(m[g.n]=y1(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qi(l=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(s[o][0]===1){if(l=m.CodePage=y1(e,Uk),Qi(l),c!==-1){var x=e.l;e.l=s[c][1],u=wE(e,l),e.l=x}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=wE(e,l)}else{var _=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=G8(e);break;case 30:e.l+=4,b=Uw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Uw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=vr(e,4);break;case 64:e.l+=4,b=Yt(Hk(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[_]=b}}return e.l=r+n,m}var q8=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function DG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function SE(e,t,r){var n=xe(8),i=[],s=[],o=8,l=0,c=xe(8),u=xe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=xe(8),u.write_shift(4,0),i.unshift(u);var h=[xe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=xe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Zr(h),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(q8.indexOf(e[l][0])>-1||I8.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],v=0;if(t){v=+t[e[l][0]];var g=r[v];if(g.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}c=kE(g.t,m)}else{var _=DG(m);_==-1&&(_=31,m=String(m)),c=kE(_,m)}s.push(c),u=xe(8),u.write_shift(4,t?v:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Zr([n].concat(i).concat(s))}function $E(e,t,r){var n=e.content;if(!n)return{};un(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==qe.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=CE(n,t),m={SystemIdentifier:u};for(var v in f)m[v]=f[v];if(m.FMTID=s,i===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=CE(n,null)}catch{}for(v in g)m[v]=g[v];return m.FMTID=[s,o],m}function EE(e,t,r,n,i,s){var o=xe(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=SE(e,r,n);if(l.push(c),i){var u=SE(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Zr(l)}function Vo(e,t){return e.read_shift(t),null}function PG(e,t){t||(t=xe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function MG(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function vr(e,t){return e.read_shift(t)===1}function Qn(e,t){return t||(t=xe(2)),t.write_shift(2,+!!e),t}function Ar(e){return e.read_shift(2,"u")}function _i(e,t){return t||(t=xe(2)),t.write_shift(2,e),t}function K8(e,t){return MG(e,t,Ar)}function OG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function X8(e,t,r){return r||(r=xe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function bp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function RG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=h,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function NG(e){var t=e.t||"",r=xe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=xe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Zr(i)}function cd(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function jp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):cd(e,n,r)}function jd(e,t,r){if(r.biff>5)return jp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Y8(e,t,r){return r||(r=xe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function zG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function IG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zn,"");return n&&(e.l+=24),i}function LG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Zn,"");return r+o}function BG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return IG(e);case"0303000000000000c000000000000046":return LG(e);default:throw new Error("Unsupported Moniker "+r)}}function Am(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zn,""):"";return r}function TE(e,t){t||(t=xe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function UG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",h,f;i&16&&(s=Am(e,r-e.l)),i&128&&(o=Am(e,r-e.l)),(i&257)===257&&(l=Am(e,r-e.l)),(i&257)===1&&(c=BG(e,r-e.l)),i&8&&(u=Am(e,r-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(f=Hk(e)),e.l=r;var m=o||l||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var v={Target:m};return h&&(v.guid=h),f&&(v.time=f),s&&(v.Tooltip=s),v}function VG(e){var t=xe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),TE(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&TE(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Q8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function J8(e,t){var r=Q8(e);return r[3]=0,r}function Rs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function dd(e,t,r,n){return n||(n=xe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function HG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function WG(e,t,r){return t===0?"":jd(e,t,r)}function GG(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function Z8(e){var t=e.read_shift(2),r=Bk(e);return[t,r]}function qG(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=bp(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function uv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function eM(e,t){return t||(t=xe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function tM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var KG=tM;function rM(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function XG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function YG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function jn(e){e.l+=2,e.l+=e.read_shift(2)}var QG={0:jn,4:jn,5:jn,6:jn,7:YG,8:jn,9:jn,10:jn,11:jn,12:jn,13:XG,14:jn,15:jn,16:jn,17:jn,18:jn,19:jn,20:jn,21:rM};function JG(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(QG[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Fm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Wk(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=xe(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function ZG(e,t){return t===0||e.read_shift(2),1200}function eq(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=jd(e,0,r);return e.read_shift(t+n-e.l),i}function tq(e,t){var r=!t||t.biff==8,n=xe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function rq(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function nq(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=bp(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function aq(e,t){var r=!t||t.biff>=8?2:1,n=xe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function iq(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(RG(e));return s.Count=n,s.Unique=i,s}function sq(e,t){var r=xe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=NG(e[i]);var s=Zr([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function oq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function lq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function cq(e){var t=HG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function dq(e){return e.read_shift(2),e.read_shift(4)}function AE(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function uq(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function hq(){var e=xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function fq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function pq(e){var t=xe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function mq(){}function gq(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=bp(e,0,r),n}function xq(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=xe(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function vq(e){var t=Rs(e);return t.isst=e.read_shift(4),t}function _q(e,t,r,n){var i=xe(10);return dd(e,t,n,i),i.write_shift(4,r),i}function yq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Rs(e);r.biff==2&&e.l++;var s=jp(e,n-e.l,r);return i.val=s,i}function bq(e,t,r,n,i){var s=!i||i.biff==8,o=xe(8+ +s+(1+s)*r.length);return dd(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function jq(e,t,r){var n=e.read_shift(2),i=jd(e,0,r);return[n,i]}function wq(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var kq=jd;function FE(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function Cq(e,t){var r=t.biff==8||!t.biff?4:2,n=xe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Sq(e){var t=e.read_shift(2),r=e.read_shift(2),n=Z8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function $q(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(Z8(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function Eq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function Tq(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=cG[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function Aq(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Tq(e,t,n.fStyle,r),n}function DE(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Fq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Dq(e){var t=xe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function PE(e,t,r){var n=Rs(e);(r.biff==2||t==9)&&++e.l;var i=OG(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Pq(e,t,r,n,i,s){var o=xe(8);return dd(e,t,n,o),X8(r,s,o),o}function Mq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Rs(e),i=Dn(e);return n.val=i,n}function Oq(e,t,r,n){var i=xe(14);return dd(e,t,n,i),ld(r,i),i}var ME=WG;function Rq(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=cd(e,s),l=[];n>e.l;)l.push(jp(e));return[s,i,o,l]}function OE(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=qG(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var Nq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function RE(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=cd(e,o,r);i&32&&(u=Nq[u.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var f=n==e.l||l===0||!(h>0)?[]:JQ(e,h,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function nM(e,t,r){if(r.biff<8)return zq(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(GG(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function zq(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=bp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Iq(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=cd(e,n,r),o=cd(e,i,r);return[s,o]}function Lq(e,t,r){var n=tM(e);e.l++;var i=e.read_shift(1);return t-=8,[ZQ(e,t,r),i,n]}function NE(e,t,r){var n=KG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,YQ(e,t,r)]}function Bq(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Uq(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=jd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function Vq(e,t,r){return Uq(e,t,r)}function Hq(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(uv(e));return r}function Wq(e){var t=xe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)eM(e[r],t);return t}function Gq(e,t,r){if(r&&r.biff<8)return Kq(e,t,r);var n=rM(e),i=JG(e,t-22,n[1]);return{cmo:n,ft:i}}var qq={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Kq(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((qq[n]||In)(e,t,r)),{cmo:[i,n,s],ft:o}}function Xq(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=zG(e,6,r);var l=e.read_shift(2);e.read_shift(2),Ar(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var h=e[e.l],f=cd(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(h?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Yq(e,t){var r=uv(e);e.l+=16;var n=UG(e,t-24);return[r,n]}function Qq(e){var t=xe(24),r=ar(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Zr([t,VG(e[1])])}function Jq(e,t){e.read_shift(2);var r=uv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[r,n]}function Zq(e){var t=e[1].Tooltip,r=xe(10+2*(t.length+1));r.write_shift(2,2048);var n=ar(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function eK(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=bE[r]||r,r=e.read_shift(2),t[1]=bE[r]||r,t}function tK(e){return e||(e=xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function rK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(J8(e));return r}function nK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(J8(e));return r}function aK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function aM(e,t,r){if(!r.cellStyles)return In(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function iK(e,t){var r=xe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sK(e,t){var r={};return t<32||(e.l+=16,r.header=Dn(e),r.footer=Dn(e),e.l+=2),r}function oK(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function lK(e){for(var t=xe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var cK=Rs,dK=K8,uK=jp;function hK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function fK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Rs(e);++e.l;var i=jd(e,t-7,r);return n.t="str",n.val=i,n}function pK(e){var t=Rs(e);++e.l;var r=Dn(e);return t.t="n",t.val=r,t}function mK(e,t,r){var n=xe(15);return Sp(n,e,t),n.write_shift(8,r,"f"),n}function gK(e){var t=Rs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function xK(e,t,r){var n=xe(9);return Sp(n,e,t),n.write_shift(2,r),n}function vK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function _K(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function yK(e,t,r){var n=e.l+t,i=Rs(e),s=e.read_shift(2),o=cd(e,s,r);return e.l=n,i.t="str",i.val=o,i}var bK=[2,3,48,49,131,139,140,245],Vw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],h=Rl(1);switch(c.type){case"base64":h=La(Ga(l));break;case"binary":h=La(l);break;case"buffer":case"array":h=l;break}un(h,0);var f=h.read_shift(1),m=!!(f&136),v=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,_=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(_=h.read_shift(2));var b=h.read_shift(2),y=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(y=e[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var j=[],k={},E=Math.min(h.length,f==2?521:_-10-(v?264:0)),A=g?32:11;h.l<E&&h[h.l]!=13;)switch(k={},k.name=R0.utils.decode(y,h.slice(h.l,h.l+A)).replace(/[\u0000\r\n].*$/g,""),h.l+=A,k.type=String.fromCharCode(h.read_shift(1)),f!=2&&!g&&(k.offset=h.read_shift(4)),k.len=h.read_shift(1),f==2&&(k.offset=h.read_shift(2)),k.dec=h.read_shift(1),k.name.length&&j.push(k),f!=2&&(h.l+=g?13:14),k.type){case"B":(!v||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var w=0,P=0;for(u[0]=[],P=0;P!=j.length;++P)u[0][P]=j[P].name;for(;x-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,u[++w]=[],P=0,P=0;P!=j.length;++P){var M=h.slice(h.l,h.l+j[P].len);h.l+=j[P].len,un(M,0);var F=R0.utils.decode(y,M);switch(j[P].type){case"C":F.trim().length&&(u[w][P]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[w][P]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[w][P]=F;break;case"F":u[w][P]=parseFloat(F.trim());break;case"+":case"I":u[w][P]=g?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[w][P]=!0;break;case"N":case"F":u[w][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[w][P]="##MEMO##"+(g?parseInt(F.trim(),10):M.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[w][P]=+F||0);break;case"@":u[w][P]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[w][P]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[w][P]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][P]=-M.read_shift(-8,"f");break;case"B":if(v&&j[P].len==8){u[w][P]=M.read_shift(8,"f");break}case"G":case"P":M.l+=j[P].len;break;case"0":if(j[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[P].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=j,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var h=oh(r(l,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(l,c){try{return Gl(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Qi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=Ca(),f=w1(l,{header:1,raw:!0,cellDates:!0}),m=f[0],v=f.slice(1),g=l["!cols"]||[],x=0,_=0,b=0,y=1;for(x=0;x<m.length;++x){if(((g[x]||{}).DBF||{}).name){m[x]=g[x].DBF.name,++b;continue}if(m[x]!=null){if(++b,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(_=0;_<1024;++_)if(m.indexOf(m[x]+"_"+_)==-1){m[x]+="_"+_;break}}}}var j=wt(l["!ref"]),k=[],E=[],A=[];for(x=0;x<=j.e.c-j.s.c;++x){var w="",P="",M=0,F=[];for(_=0;_<v.length;++_)v[_][x]!=null&&F.push(v[_][x]);if(F.length==0||m[x]==null){k[x]="?";continue}for(_=0;_<F.length;++_){switch(typeof F[_]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=F[_]instanceof Date?"D":"C";break;default:P="C"}M=Math.max(M,String(F[_]).length),w=w&&w!=P?"C":P}M>250&&(M=250),P=((g[x]||{}).DBF||{}).type,P=="C"&&g[x].DBF.len>M&&(M=g[x].DBF.len),w=="B"&&P=="N"&&(w="N",A[x]=g[x].DBF.dec,M=g[x].DBF.len),E[x]=w=="C"||P=="N"?M:s[w]||0,y+=E[x],k[x]=w}var D=h.next(32);for(D.write_shift(4,318902576),D.write_shift(4,v.length),D.write_shift(2,296+32*b),D.write_shift(2,y),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+t[qP]||3)<<8),x=0,_=0;x<m.length;++x)if(m[x]!=null){var W=h.next(32),B=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,B,"sbcs"),W.write_shift(1,k[x]=="?"?"C":k[x],"sbcs"),W.write_shift(4,_),W.write_shift(1,E[x]||s[k[x]]||0),W.write_shift(1,A[x]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),_+=E[x]||s[k[x]]||0}var G=h.next(264);for(G.write_shift(4,13),x=0;x<65;++x)G.write_shift(4,0);for(x=0;x<v.length;++x){var Y=h.next(y);for(Y.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(k[_]){case"L":Y.write_shift(1,v[x][_]==null?63:v[x][_]?84:70);break;case"B":Y.write_shift(8,v[x][_]||0,"f");break;case"N":var ae="0";for(typeof v[x][_]=="number"&&(ae=v[x][_].toFixed(A[_]||0)),b=0;b<E[_]-ae.length;++b)Y.write_shift(1,32);Y.write_shift(1,ae,"sbcs");break;case"D":v[x][_]?(Y.write_shift(4,("0000"+v[x][_].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(v[x][_].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+v[x][_].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var U=String(v[x][_]!=null?v[x][_]:"").slice(0,E[_]);for(Y.write_shift(1,U,"sbcs"),b=0;b<E[_]-U.length;++b)Y.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),iM=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+mr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var g=e[v];return typeof g=="number"?K5(g):g},n=function(m,v,g){var x=v.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?m:K5(x)};e["|"]=254;function i(m,v){switch(v.type){case"base64":return s(Ga(m),v);case"binary":return s(m,v);case"buffer":return s(ft&&Buffer.isBuffer(m)?m.toString("binary"):Wl(m),v);case"array":return s(od(m),v)}throw new Error("Unrecognized type "+v.type)}function s(m,v){var g=m.split(/[\n\r]+/),x=-1,_=-1,b=0,y=0,j=[],k=[],E=null,A={},w=[],P=[],M=[],F=0,D;for(+v.codepage>=0&&Qi(+v.codepage);b!==g.length;++b){F=0;var W=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=W.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),G=B[0],Y;if(W.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&k.push(W.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,U=!1,q=!1,z=!1,ie=-1,he=-1;for(y=1;y<B.length;++y)switch(B[y].charAt(0)){case"A":break;case"X":_=parseInt(B[y].slice(1))-1,U=!0;break;case"Y":for(x=parseInt(B[y].slice(1))-1,U||(_=0),D=j.length;D<=x;++D)j[D]=[];break;case"K":Y=B[y].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(rs(Y))?isNaN(qu(Y).getDate())||(Y=Yt(Y)):(Y=rs(Y),E!==null&&ih(E)&&(Y=dv(Y))),ae=!0;break;case"E":z=!0;var O=xu(B[y].slice(1),{r:x,c:_});j[x][_]=[j[x][_],O];break;case"S":q=!0,j[x][_]=[j[x][_],"S5S"];break;case"G":break;case"R":ie=parseInt(B[y].slice(1))-1;break;case"C":he=parseInt(B[y].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+W)}if(ae&&(j[x][_]&&j[x][_].length==2?j[x][_][0]=Y:j[x][_]=Y,E=null),q){if(z)throw new Error("SYLK shared formula cannot have own formula");var R=ie>-1&&j[ie][he];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");j[x][_][1]=wM(R[1],{r:x-ie,c:_-he})}break;case"F":var I=0;for(y=1;y<B.length;++y)switch(B[y].charAt(0)){case"X":_=parseInt(B[y].slice(1))-1,++I;break;case"Y":for(x=parseInt(B[y].slice(1))-1,D=j.length;D<=x;++D)j[D]=[];break;case"M":F=parseInt(B[y].slice(1))/20;break;case"F":break;case"G":break;case"P":E=k[parseInt(B[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=B[y].slice(1).split(" "),D=parseInt(M[0],10);D<=parseInt(M[1],10);++D)F=parseInt(M[2],10),P[D-1]=F===0?{hidden:!0}:{wch:F},Nl(P[D-1]);break;case"C":_=parseInt(B[y].slice(1))-1,P[_]||(P[_]={});break;case"R":x=parseInt(B[y].slice(1))-1,w[x]||(w[x]={}),F>0?(w[x].hpt=F,w[x].hpx=Xu(F)):F===0&&(w[x].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+W)}I<1&&(E=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+W)}}return w.length>0&&(A["!rows"]=w),P.length>0&&(A["!cols"]=P),v&&v.sheetRows&&(j=j.slice(0,v.sheetRows)),[j,A]}function o(m,v){var g=i(m,v),x=g[0],_=g[1],b=oh(x,v);return mr(_).forEach(function(y){b[y]=_[y]}),b}function l(m,v){return Gl(o(m,v),v)}function c(m,v,g,x){var _="C;Y"+(g+1)+";X"+(x+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+Qk(m.f,{r:g,c:x}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(m,v){v.forEach(function(g,x){var _="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=H0(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=W0(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function h(m,v){v.forEach(function(g,x){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*G0(g.hpx)+";"),_.length>2&&m.push(_+"R"+(x+1))})}function f(m,v){var g=["ID;PWXL;N;E"],x=[],_=wt(m["!ref"]),b,y=Array.isArray(m),j=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&u(g,m["!cols"]),m["!rows"]&&h(g,m["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var k=_.s.r;k<=_.e.r;++k)for(var E=_.s.c;E<=_.e.c;++E){var A=Ye({r:k,c:E});b=y?(m[k]||[])[E]:m[A],!(!b||b.v==null&&(!b.f||b.F))&&x.push(c(b,m,k,E))}return g.join(j)+j+x.join(j)+j+"E"+j}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),sM=function(){function e(s,o){switch(o.type){case"base64":return t(Ga(s),o);case"binary":return t(s,o);case"buffer":return t(ft&&Buffer.isBuffer(s)?s.toString("binary"):Wl(s),o);case"array":return t(od(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,h=0,f=[];h!==l.length;++h){if(l[h].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=l[h].trim().split(","),v=m[0],g=m[1];++h;for(var x=l[h]||"";(x.match(/["]/g)||[]).length&1&&h<l.length-1;)x+=`
`+l[++h];switch(x=x.trim(),+v){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(rs(g))?isNaN(qu(g).getDate())?f[c][u]=g:f[c][u]=Yt(g):f[c][u]=rs(g),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return oh(e(s,o),o)}function n(s,o){return Gl(r(s,o),o)}var i=function(){var s=function(c,u,h,f,m){c.push(u),c.push(h+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,u,h,f){c.push(u+","+h),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],h=wt(c["!ref"]),f,m=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var v=h.s.r;v<=h.e.r;++v){o(u,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var x=Ye({r:v,c:g});if(f=m?(c[v]||[])[g]:c[x],!f){o(u,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,_,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Fi(f.z||Xe[14],Vr(Yt(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,y=u.join(b);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),oM=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var v=f.split(`
`),g=-1,x=-1,_=0,b=[];_!==v.length;++_){var y=v[_].trim().split(":");if(y[0]==="cell"){var j=ar(y[1]);if(b.length<=j.r)for(g=b.length;g<=j.r;++g)b[g]||(b[g]=[]);switch(g=j.r,x=j.c,y[2]){case"t":b[g][x]=e(y[3]);break;case"v":b[g][x]=+y[3];break;case"vtf":var k=y[y.length-1];case"vtc":switch(y[3]){case"nl":b[g][x]=!!+y[4];break;default:b[g][x]=+y[4];break}y[2]=="vtf"&&(b[g][x]=[b[g][x],k])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function n(f,m){return oh(r(f,m),m)}function i(f,m){return Gl(n(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],v=[],g,x="",_=Sa(f["!ref"]),b=Array.isArray(f),y=_.s.r;y<=_.e.r;++y)for(var j=_.s.c;j<=_.e.c;++j)if(x=Ye({r:y,c:j}),g=b?(f[y]||[])[j]:f[x],!(!g||g.v==null||g.t==="z")){switch(v=["cell",x,"t"],g.t){case"s":case"str":v.push(t(g.v));break;case"n":g.f?(v[2]="vtf",v[3]="n",v[4]=g.v,v[5]=t(g.f)):(v[2]="v",v[3]=g.v);break;case"b":v[2]="vt"+(g.f?"f":"c"),v[3]="nl",v[4]=g.v?"1":"0",v[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var k=Vr(Yt(g.v));v[2]="vtc",v[3]="nd",v[4]=""+k,v[5]=g.w||Fi(g.z||Xe[14],k);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),Ku=function(){function e(h,f,m,v,g){g.raw?f[m][v]=h:h===""||(h==="TRUE"?f[m][v]=!0:h==="FALSE"?f[m][v]=!1:isNaN(rs(h))?isNaN(qu(h).getDate())?f[m][v]=h:f[m][v]=Yt(h):f[m][v]=rs(h))}function t(h,f){var m=f||{},v=[];if(!h||h.length===0)return v;for(var g=h.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var _=10,b=0,y=0;y<=x;++y)b=g[y].indexOf(" "),b==-1?b=g[y].length:b++,_=Math.max(_,b);for(y=0;y<=x;++y){v[y]=[];var j=0;for(e(g[y].slice(0,_).trim(),v,y,j,m),j=1;j<=(g[y].length-_)/10+1;++j)e(g[y].slice(_+(j-1)*10,_+j*10).trim(),v,y,j,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},m=!1,v=0,g=0;v<h.length;++v)(g=h.charCodeAt(v))==34?m=!m:!m&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(v in f)Object.prototype.hasOwnProperty.call(f,v)&&g.push([f[v],v]);if(!g.length){f=n;for(v in f)Object.prototype.hasOwnProperty.call(f,v)&&g.push([f[v],v])}return g.sort(function(x,_){return x[0]-_[0]||n[x[1]]-n[_[1]]}),r[g.pop()[1]]||44}function s(h,f){var m=f||{},v="",g=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(v=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(v=h.charAt(4),h=h.slice(6)):v=i(h.slice(0,1024)):m&&m.FS?v=m.FS:v=i(h.slice(0,1024));var _=0,b=0,y=0,j=0,k=0,E=v.charCodeAt(0),A=!1,w=0,P=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=m.dateNF!=null?oW(m.dateNF):null;function F(){var D=h.slice(j,k),W={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)W.t="z";else if(m.raw)W.t="s",W.v=D;else if(D.trim().length===0)W.t="s",W.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(W.t="s",W.v=D.slice(2,-1).replace(/""/g,'"')):RY(D)?(W.t="n",W.f=D.slice(1)):(W.t="s",W.v=D);else if(D=="TRUE")W.t="b",W.v=!0;else if(D=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=rs(D)))W.t="n",m.cellText!==!1&&(W.w=D),W.v=y;else if(!isNaN(qu(D).getDate())||M&&D.match(M)){W.z=m.dateNF||Xe[14];var B=0;M&&D.match(M)&&(D=lW(D,m.dateNF,D.match(M)||[]),B=1),m.cellDates?(W.t="d",W.v=Yt(D,B)):(W.t="n",W.v=Vr(Yt(D,B))),m.cellText!==!1&&(W.w=Fi(W.z,W.v instanceof Date?Vr(W.v):W.v)),m.cellNF||delete W.z}else W.t="s",W.v=D;if(W.t=="z"||(m.dense?(g[_]||(g[_]=[]),g[_][b]=W):g[Ye({c:b,r:_})]=W),j=k+1,P=h.charCodeAt(j),x.e.c<b&&(x.e.c=b),x.e.r<_&&(x.e.r=_),w==E)++b;else if(b=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;k<h.length;++k)switch(w=h.charCodeAt(k)){case 34:P===34&&(A=!A);break;case E:case 10:case 13:if(!A&&F())break e;break}return k-j>0&&F(),g["!ref"]=rt(x),g}function o(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):oh(t(h,f),f)}function l(h,f){var m="",v=f.type=="string"?[0,0,0,0]:iC(h,f);switch(f.type){case"base64":m=Ga(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):f.codepage&&typeof R0<"u"||(m=ft&&Buffer.isBuffer(h)?h.toString("binary"):Wl(h));break;case"array":m=od(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=It(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=It(m):f.type=="binary"&&typeof R0<"u",m.slice(0,19)=="socialcalc:version:"?oM.to_sheet(f.type=="string"?m:It(m),f):o(m,f)}function c(h,f){return Gl(l(h,f),f)}function u(h){for(var f=[],m=wt(h["!ref"]),v,g=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var _=[],b=m.s.c;b<=m.e.c;++b){var y=Ye({r:x,c:b});if(v=g?(h[x]||[])[b]:h[y],!v||v.v==null){_.push("          ");continue}for(var j=(v.w||(ko(v),v.w)||"").slice(0,10);j.length<10;)j+=" ";_.push(j+(b===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function jK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=iM.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ku.to_workbook(e,t)}}var Kc=function(){function e(O,R,I){if(O){un(O,O.l||0);for(var K=I.Enum||ie;O.l<O.length;){var ne=O.read_shift(2),ee=K[ne]||K[65535],ge=O.read_shift(2),L=O.l+ge,se=ee.f&&ee.f(O,ge,I);if(O.l=L,R(se,ee,ne))return}}}function t(O,R){switch(R.type){case"base64":return r(La(Ga(O)),R);case"binary":return r(La(O),R);case"buffer":case"array":return r(O,R)}throw"Unsupported type "+R.type}function r(O,R){if(!O)return O;var I=R||{},K=I.dense?[]:{},ne="Sheet1",ee="",ge=0,L={},se=[],ke=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ve=I.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)I.Enum=ie,e(O,function(_e,St,Hr){switch(Hr){case 0:I.vers=_e,_e>=4096&&(I.qpro=!0);break;case 6:V=_e;break;case 204:_e&&(ee=_e);break;case 222:ee=_e;break;case 15:case 51:I.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Hr==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=I.dateNF||Xe[14],I.cellDates&&(_e[1].t="d",_e[1].v=dv(_e[1].v))),I.qpro&&_e[3]>ge&&(K["!ref"]=rt(V),L[ne]=K,se.push(ne),K=I.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ge=_e[3],ne=ee||"Sheet"+(ge+1),ee="");var xn=I.dense?(K[_e[0].r]||[])[_e[0].c]:K[Ye(_e[0])];if(xn){xn.t=_e[1].t,xn.v=_e[1].v,_e[1].z!=null&&(xn.z=_e[1].z),_e[1].f!=null&&(xn.f=_e[1].f);break}I.dense?(K[_e[0].r]||(K[_e[0].r]=[]),K[_e[0].r][_e[0].c]=_e[1]):K[Ye(_e[0])]=_e[1];break}},I);else if(O[2]==26||O[2]==14)I.Enum=he,O[2]==14&&(I.qpro=!0,O.l=0),e(O,function(_e,St,Hr){switch(Hr){case 204:ne=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>ge&&(K["!ref"]=rt(V),L[ne]=K,se.push(ne),K=I.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ge=_e[3],ne="Sheet"+(ge+1)),Ve>0&&_e[0].r>=Ve)break;I.dense?(K[_e[0].r]||(K[_e[0].r]=[]),K[_e[0].r][_e[0].c]=_e[1]):K[Ye(_e[0])]=_e[1],V.e.c<_e[0].c&&(V.e.c=_e[0].c),V.e.r<_e[0].r&&(V.e.r=_e[0].r);break;case 27:_e[14e3]&&(ke[_e[14e3][0]]=_e[14e3][1]);break;case 1537:ke[_e[0]]=_e[1],_e[0]==ge&&(ne=_e[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(K["!ref"]=rt(V),L[ee||ne]=K,se.push(ee||ne),!ke.length)return{SheetNames:se,Sheets:L};for(var Ke={},ye=[],T=0;T<ke.length;++T)L[se[T]]?(ye.push(ke[T]||se[T]),Ke[ke[T]]=L[ke[T]]||L[se[T]]):(ye.push(ke[T]),Ke[ke[T]]={"!ref":"A1"});return{SheetNames:ye,Sheets:Ke}}function n(O,R){var I=R||{};if(+I.codepage>=0&&Qi(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Ca(),ne=wt(O["!ref"]),ee=Array.isArray(O),ge=[];Te(K,0,s(1030)),Te(K,6,c(ne));for(var L=Math.min(ne.e.r,8191),se=ne.s.r;se<=L;++se)for(var ke=jr(se),V=ne.s.c;V<=ne.e.c;++V){se===ne.s.r&&(ge[V]=nr(V));var Ve=ge[V]+ke,Ke=ee?(O[se]||[])[V]:O[Ve];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Te(K,13,v(se,V,Ke.v)):Te(K,14,x(se,V,Ke.v));else{var ye=ko(Ke);Te(K,15,f(se,V,ye.slice(0,239)))}}return Te(K,1),K.end()}function i(O,R){var I=R||{};if(+I.codepage>=0&&Qi(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Ca();Te(K,0,o(O));for(var ne=0,ee=0;ne<O.SheetNames.length;++ne)(O.Sheets[O.SheetNames[ne]]||{})["!ref"]&&Te(K,27,z(O.SheetNames[ne],ee++));var ge=0;for(ne=0;ne<O.SheetNames.length;++ne){var L=O.Sheets[O.SheetNames[ne]];if(!(!L||!L["!ref"])){for(var se=wt(L["!ref"]),ke=Array.isArray(L),V=[],Ve=Math.min(se.e.r,8191),Ke=se.s.r;Ke<=Ve;++Ke)for(var ye=jr(Ke),T=se.s.c;T<=se.e.c;++T){Ke===se.s.r&&(V[T]=nr(T));var _e=V[T]+ye,St=ke?(L[Ke]||[])[T]:L[_e];if(!(!St||St.t=="z"))if(St.t=="n")Te(K,23,F(Ke,T,ge,St.v));else{var Hr=ko(St);Te(K,22,w(Ke,T,ge,Hr.slice(0,239)))}}++ge}}return Te(K,1),K.end()}function s(O){var R=xe(2);return R.write_shift(2,O),R}function o(O){var R=xe(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var I=0,K=0,ne=0,ee=0;ee<O.SheetNames.length;++ee){var ge=O.SheetNames[ee],L=O.Sheets[ge];if(!(!L||!L["!ref"])){++ne;var se=Sa(L["!ref"]);I<se.e.r&&(I=se.e.r),K<se.e.c&&(K=se.e.c)}}return I>8191&&(I=8191),R.write_shift(2,I),R.write_shift(1,ne),R.write_shift(1,K),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function l(O,R,I){var K={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&I.qpro?(K.s.c=O.read_shift(1),O.l++,K.s.r=O.read_shift(2),K.e.c=O.read_shift(1),O.l++,K.e.r=O.read_shift(2),K):(K.s.c=O.read_shift(2),K.s.r=O.read_shift(2),R==12&&I.qpro&&(O.l+=2),K.e.c=O.read_shift(2),K.e.r=O.read_shift(2),R==12&&I.qpro&&(O.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function c(O){var R=xe(8);return R.write_shift(2,O.s.c),R.write_shift(2,O.s.r),R.write_shift(2,O.e.c),R.write_shift(2,O.e.r),R}function u(O,R,I){var K=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(K[0].c=O.read_shift(1),K[3]=O.read_shift(1),K[0].r=O.read_shift(2),O.l+=2):(K[2]=O.read_shift(1),K[0].c=O.read_shift(2),K[0].r=O.read_shift(2)),K}function h(O,R,I){var K=O.l+R,ne=u(O,R,I);if(ne[1].t="s",I.vers==20768){O.l++;var ee=O.read_shift(1);return ne[1].v=O.read_shift(ee,"utf8"),ne}return I.qpro&&O.l++,ne[1].v=O.read_shift(K-O.l,"cstr"),ne}function f(O,R,I){var K=xe(7+I.length);K.write_shift(1,255),K.write_shift(2,R),K.write_shift(2,O),K.write_shift(1,39);for(var ne=0;ne<K.length;++ne){var ee=I.charCodeAt(ne);K.write_shift(1,ee>=128?95:ee)}return K.write_shift(1,0),K}function m(O,R,I){var K=u(O,R,I);return K[1].v=O.read_shift(2,"i"),K}function v(O,R,I){var K=xe(7);return K.write_shift(1,255),K.write_shift(2,R),K.write_shift(2,O),K.write_shift(2,I,"i"),K}function g(O,R,I){var K=u(O,R,I);return K[1].v=O.read_shift(8,"f"),K}function x(O,R,I){var K=xe(13);return K.write_shift(1,255),K.write_shift(2,R),K.write_shift(2,O),K.write_shift(8,I,"f"),K}function _(O,R,I){var K=O.l+R,ne=u(O,R,I);if(ne[1].v=O.read_shift(8,"f"),I.qpro)O.l=K;else{var ee=O.read_shift(2);k(O.slice(O.l,O.l+ee),ne),O.l+=ee}return ne}function b(O,R,I){var K=R&32768;return R&=-32769,R=(K?O:0)+(R>=8192?R-16384:R),(K?"":"$")+(I?nr(R):jr(R))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(O,R){un(O,0);for(var I=[],K=0,ne="",ee="",ge="",L="";O.l<O.length;){var se=O[O.l++];switch(se){case 0:I.push(O.read_shift(8,"f"));break;case 1:ee=b(R[0].c,O.read_shift(2),!0),ne=b(R[0].r,O.read_shift(2),!1),I.push(ee+ne);break;case 2:{var ke=b(R[0].c,O.read_shift(2),!0),V=b(R[0].r,O.read_shift(2),!1);ee=b(R[0].c,O.read_shift(2),!0),ne=b(R[0].r,O.read_shift(2),!1),I.push(ke+V+":"+ee+ne)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(O.read_shift(2));break;case 6:{for(var Ve="";se=O[O.l++];)Ve+=String.fromCharCode(se);I.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:L=I.pop(),ge=I.pop(),I.push(["AND","OR"][se-20]+"("+ge+","+L+")");break;default:if(se<32&&j[se])L=I.pop(),ge=I.pop(),I.push(ge+j[se]+L);else if(y[se]){if(K=y[se][1],K==69&&(K=O[O.l++]),K>I.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+I.join("|")+"|");return}var Ke=I.slice(-K);I.length-=K,I.push(y[se][0]+"("+Ke.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}I.length==1?R[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function E(O){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=O.read_shift(2),R[3]=O[O.l++],R[0].c=O[O.l++],R}function A(O,R){var I=E(O);return I[1].t="s",I[1].v=O.read_shift(R-4,"cstr"),I}function w(O,R,I,K){var ne=xe(6+K.length);ne.write_shift(2,O),ne.write_shift(1,I),ne.write_shift(1,R),ne.write_shift(1,39);for(var ee=0;ee<K.length;++ee){var ge=K.charCodeAt(ee);ne.write_shift(1,ge>=128?95:ge)}return ne.write_shift(1,0),ne}function P(O,R){var I=E(O);I[1].v=O.read_shift(2);var K=I[1].v>>1;if(I[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return I[1].v=K,I}function M(O,R){var I=E(O),K=O.read_shift(4),ne=O.read_shift(4),ee=O.read_shift(2);if(ee==65535)return K===0&&ne===3221225472?(I[1].t="e",I[1].v=15):K===0&&ne===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ge=ee&32768;return ee=(ee&32767)-16446,I[1].v=(1-ge*2)*(ne*Math.pow(2,ee+32)+K*Math.pow(2,ee)),I}function F(O,R,I,K){var ne=xe(14);if(ne.write_shift(2,O),ne.write_shift(1,I),ne.write_shift(1,R),K==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var ee=0,ge=0,L=0,se=0;return K<0&&(ee=1,K=-K),ge=Math.log2(K)|0,K/=Math.pow(2,ge-31),se=K>>>0,se&2147483648||(K/=2,++ge,se=K>>>0),K-=se,se|=2147483648,se>>>=0,K*=Math.pow(2,32),L=K>>>0,ne.write_shift(4,L),ne.write_shift(4,se),ge+=16383+(ee?32768:0),ne.write_shift(2,ge),ne}function D(O,R){var I=M(O);return O.l+=R-14,I}function W(O,R){var I=E(O),K=O.read_shift(4);return I[1].v=K>>6,I}function B(O,R){var I=E(O),K=O.read_shift(8,"f");return I[1].v=K,I}function G(O,R){var I=B(O);return O.l+=R-10,I}function Y(O,R){return O[O.l+R-1]==0?O.read_shift(R,"cstr"):""}function ae(O,R){var I=O[O.l++];I>R-1&&(I=R-1);for(var K="";K.length<I;)K+=String.fromCharCode(O[O.l++]);return K}function U(O,R,I){if(!(!I.qpro||R<21)){var K=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ne=O.read_shift(R-21,"cstr");return[K,ne]}}function q(O,R){for(var I={},K=O.l+R;O.l<K;){var ne=O.read_shift(2);if(ne==14e3){for(I[ne]=[0,""],I[ne][0]=O.read_shift(2);O[O.l];)I[ne][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return I}function z(O,R){var I=xe(5+O.length);I.write_shift(2,14e3),I.write_shift(2,R);for(var K=0;K<O.length;++K){var ne=O.charCodeAt(K);I[I.l++]=ne>127?95:ne}return I[I.l++]=0,I}var ie={0:{n:"BOF",f:Ar},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:U},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function wK(e){var t={},r=e.match(Bn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Qe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=jk[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var kK=function(){var e=I0("t"),t=I0("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:jt(o[1])},c=s.match(t);return c&&(l.s=wK(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),CK=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),SK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$K=/<(?:\w+:)?r>/,EK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Gk(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(It(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=It(e),r&&(n.h=Dk(n.t))):e.match($K)&&(n.r=It(e),n.t=jt(It((e.replace(EK,"").match(SK)||[]).join("").replace(Bn,""))),r&&(n.h=CK(kK(n.r)))),n):{t:""}}var TK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,AK=/<(?:\w+:)?(?:si|sstItem)>/g,FK=/<\/(?:\w+:)?(?:si|sstItem)>/;function DK(e,t){var r=[],n="";if(!e)return r;var i=e.match(TK);if(i){n=i[2].replace(AK,"").split(FK);for(var s=0;s!=n.length;++s){var o=Gk(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Qe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var PK=/^\s|\s$|[\t\n\r]/;function lM(e,t){if(!t.bookSST)return"";var r=[wr];r[r.length]=Ee("sst",null,{xmlns:xd[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(PK)&&(s+=' xml:space="preserve"'),s+=">"+Rt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function MK(e){return[e.read_shift(4),e.read_shift(4)]}function OK(e,t){var r=[],n=!1;return $o(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function RK(e,t){return t||(t=xe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var NK=qW;function zK(e){var t=Ca();be(t,159,RK(e));for(var r=0;r<e.length;++r)be(t,19,NK(e[r]));return be(t,160),t.end()}function cM(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function vo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function IK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=vo(e,4),t.U=vo(e,4),t.W=vo(e,4),t}function LK(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function BK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(LK(e));return t}function UK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function VK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=vo(e,4),t.U=vo(e,4),t.W=vo(e,4),t}function HK(e){var t=VK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function dM(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function uM(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function WK(e){var t=vo(e);switch(t.Minor){case 2:return[t.Minor,GK(e)];case 3:return[t.Minor,qK()];case 4:return[t.Minor,KK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function GK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=dM(e,r),i=uM(e,e.length-e.l);return{t:"Std",h:n,v:i}}function qK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Bn,function(s){var o=Qe(s);switch(Os(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function XK(e,t){var r={},n=r.EncryptionVersionInfo=vo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=dM(e,i),t-=i,r.EncryptionVerifier=uM(e,t),r}function YK(e){var t={},r=t.EncryptionVersionInfo=vo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function qk(e){var t=0,r,n=cM(e),i=n.length+1,s,o,l,c,u;for(r=Rl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var hM=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var h=o[u],f=0;f!=7;++f)h&64&&(l^=r[c]),h*=2,--c;return l};return function(o){for(var l=cM(o),c=s(l),u=l.length,h=Rl(16),f=0;f!=16;++f)h[f]=0;var m,v,g;for((u&1)===1&&(m=c>>8,h[u]=i(e[0],m),--u,m=c&255,v=l[l.length-1],h[u]=i(v,m));u>0;)--u,m=c>>8,h[u]=i(l[u],m),--u,m=c&255,h[u]=i(l[u],m);for(u=15,g=15-l.length;g>0;)m=c>>8,h[u]=i(e[g],m),--u,--g,m=c&255,h[u]=i(l[u],m),--u,--g;return h}}(),QK=function(e,t,r,n,i){i||(i=t),n||(n=hM(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},JK=function(e){var t=0,r=hM(e);return function(n){var i=QK("",n,t,r);return t=i[1],i[0]}};function ZK(e,t,r,n){var i={key:Ar(e),verificationBytes:Ar(e)};return r.password&&(i.verifier=qk(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=JK(r.password)),i}function eX(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=YK(e):n.Data=XK(e,t),n}function tX(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?eX(e,t-2,n):ZK(e,r.biff>=8?t:t-2,r,n),n}var fM=function(){function e(i,s){switch(s.type){case"base64":return t(Ga(i),s);case"binary":return t(i,s);case"buffer":return t(ft&&Buffer.isBuffer(i)?i.toString("binary"):Wl(i),s);case"array":return t(od(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,v=0,g,x=-1;g=m.exec(h);){switch(g[0]){case"\\cell":var _=h.slice(v,m.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++x,_.length){var b={v:_,t:"s"};Array.isArray(l)?l[f][x]=b:l[Ye({r:f,c:x})]=b}break}v=m.lastIndex}x>u.e.c&&(u.e.c=x)}),l["!ref"]=rt(u),l}function r(i,s){return Gl(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=wt(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var f=Ye({r:u,c:h});l=c?(i[u]||[])[h]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(ko(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function rX(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function V0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function nX(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function aX(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function b1(e,t){if(t===0)return e;var r=nX(rX(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),V0(aX(r))}var pM=6,iX=15,sX=1,Tn=pM;function H0(e){return Math.floor((e+Math.round(128/Tn)/256)*Tn)}function W0(e){return Math.floor((e-5)/Tn*100+.5)/100}function j1(e){return Math.round((e*Tn+5)/Tn*256)/256}function xy(e){return j1(W0(H0(e)))}function Kk(e){var t=Math.abs(e-xy(e)),r=Tn;if(t>.005)for(Tn=sX;Tn<iX;++Tn)Math.abs(e-xy(e))<=t&&(t=Math.abs(e-xy(e)),r=Tn);Tn=r}function Nl(e){e.width?(e.wpx=H0(e.width),e.wch=W0(e.wpx),e.MDW=Tn):e.wpx?(e.wch=W0(e.wpx),e.width=j1(e.wch),e.MDW=Tn):typeof e.wch=="number"&&(e.width=j1(e.wch),e.wpx=H0(e.width),e.MDW=Tn),e.customWidth&&delete e.customWidth}var oX=96,mM=oX;function G0(e){return e*96/mM}function Xu(e){return e*mM/96}var lX={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cX(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Bn)||[]).forEach(function(o){var l=Qe(o);switch(Os(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=Kt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=Kt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function dX(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Bn)||[]).forEach(function(o){var l=Qe(o);switch(Os(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function uX(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Bn)||[]).forEach(function(o){var l=Qe(o);switch(Os(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=It(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?Kt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?Kt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?Kt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?Kt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?Kt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?Kt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?Kt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=jk[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=Kt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=Gc[i.color.index];i.color.index==81&&(c=Gc[1]),c||(c=Gc[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=b1(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function hX(e,t,r){t.NumberFmt=[];for(var n=mr(Xe),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Xe[n[i]];var s=e[0].match(Bn);if(s)for(i=0;i<s.length;++i){var o=Qe(s[i]);switch(Os(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=jt(It(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}xo(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function fX(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ee("numFmt",null,{numFmtId:n,formatCode:Rt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ee("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Dm=["numFmtId","fillId","fontId","borderId","xfId"],Pm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pX(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Bn)||[]).forEach(function(s){var o=Qe(s),l=0;switch(Os(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Dm.length;++l)n[Dm[l]]&&(n[Dm[l]]=parseInt(n[Dm[l]],10));for(l=0;l<Pm.length;++l)n[Pm[l]]&&(n[Pm[l]]=Kt(n[Pm[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Kt(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function mX(e){var t=[];return t[t.length]=Ee("cellXfs",null),e.forEach(function(r){t[t.length]=Ee("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ee("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var gX=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&hX(f,h,u),(f=l.match(i))&&uX(f,h,c,u),(f=l.match(n))&&dX(f,h,c,u),(f=l.match(s))&&cX(f,h,c,u),(f=l.match(r))&&pX(f,h,u),h}}();function gM(e,t){var r=[wr,Ee("styleSheet",null,{xmlns:xd[0],"xmlns:vt":Ir.vt})],n;return e.SSF&&(n=fX(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=mX(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function xX(e,t){var r=e.read_shift(2),n=Nn(e);return[r,n]}function vX(e,t,r){r||(r=xe(6+4*t.length)),r.write_shift(2,e),en(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function _X(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=eG(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=ZW(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Nn(e),n}function yX(e,t){t||(t=xe(25+4*32)),t.write_shift(2,e.sz*20),tG(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),v1(e.color,t);var n=0;return n=2,t.write_shift(1,n),en(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bX=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vy,jX=In;function zE(e,t){t||(t=xe(4*3+8*7+16*1)),vy||(vy=lv(bX));var r=vy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(v1({auto:1},t),v1({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function wX(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function xM(e,t,r){r||(r=xe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Wh(e,t){return t||(t=xe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var kX=In;function CX(e,t){return t||(t=xe(51)),t.write_shift(1,0),Wh(null,t),Wh(null,t),Wh(null,t),Wh(null,t),Wh(null,t),t.length>t.l?t.slice(0,t.l):t}function SX(e,t){return t||(t=xe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),x1(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function $X(e,t,r){var n=xe(2052);return n.write_shift(4,e),x1(t,n),x1(r,n),n.length>n.l?n.slice(0,n.l):n}function EX(e,t,r){var n={};n.NumberFmt=[];for(var i in Xe)n.NumberFmt[i]=Xe[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return $o(e,function(c,u,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],xo(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=b1(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(h);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function TX(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(be(e,615,ns(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&be(e,44,vX(i,t[i]))}),be(e,616))}}function AX(e){var t=1;be(e,611,ns(t)),be(e,43,yX({sz:12,color:{theme:1},name:"Calibri",family:2})),be(e,612)}function FX(e){var t=2;be(e,603,ns(t)),be(e,45,zE({patternType:"none"})),be(e,45,zE({patternType:"gray125"})),be(e,604)}function DX(e){var t=1;be(e,613,ns(t)),be(e,46,CX()),be(e,614)}function PX(e){var t=1;be(e,626,ns(t)),be(e,47,xM({numFmtId:0},65535)),be(e,627)}function MX(e,t){be(e,617,ns(t.length)),t.forEach(function(r){be(e,47,xM(r,0))}),be(e,618)}function OX(e){var t=1;be(e,619,ns(t)),be(e,48,SX({xfId:0,name:"Normal"})),be(e,620)}function RX(e){var t=0;be(e,505,ns(t)),be(e,506)}function NX(e){var t=0;be(e,508,$X(t,"TableStyleMedium9","PivotStyleMedium4")),be(e,509)}function zX(e,t){var r=Ca();return be(r,278),TX(r,e.SSF),AX(r),FX(r),DX(r),PX(r),MX(r,t.cellXfs),OX(r),RX(r),NX(r),be(r,279),r.end()}var IX=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LX(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Bn)||[]).forEach(function(i){var s=Qe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[IX.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function BX(){}function UX(){}var VX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,HX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,WX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GX(e,t,r){t.themeElements={};var n;[["clrScheme",VX,LX],["fontScheme",HX,BX],["fmtScheme",WX,UX]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var qX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function vM(e,t){(!e||e.length===0)&&(e=Xk());var r,n={};if(!(r=e.match(qX)))throw new Error("themeElements not found in theme");return GX(r[0],n,t),n.raw=e,n}function Xk(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[wr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KX(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=d8(s,{type:"array"})}catch{return}var l=Ba(o,"theme/theme/theme1.xml",!0);if(l)return vM(l,r)}}function XX(e){return e.read_shift(4)}function YX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=QX(e,4);break;case 2:t.xclrValue=Q8(e);break;case 3:t.xclrValue=XX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function QX(e,t){return In(e,t)}function JX(e,t){return In(e,t)}function ZX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=YX(e);break;case 6:n[1]=JX(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function eY(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(ZX(e,r-e.l));return{ixfe:n,ext:s}}function tY(e,t){t.forEach(function(r){switch(r[0]){}})}function rY(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Nn(e)}}function nY(e){var t=xe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),en(e.name,t),t.slice(0,t.l)}function aY(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function iY(e){var t=xe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function sY(e,t){var r=xe(8+2*t.length);return r.write_shift(4,e),en(t,r),r.slice(0,r.l)}function oY(e){return e.l+=4,e.read_shift(4)!=0}function lY(e,t){var r=xe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function cY(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return $o(e,function(c,u,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function dY(){var e=Ca();return be(e,332),be(e,334,ns(1)),be(e,335,nY({name:"XLDAPR",version:12e4,flags:3496657072})),be(e,336),be(e,339,sY(1,"XLDAPR")),be(e,52),be(e,35,ns(514)),be(e,4096,ns(0)),be(e,4097,_i(1)),be(e,36),be(e,53),be(e,340),be(e,337,lY(1)),be(e,51,iY([[1,0]])),be(e,338),be(e,333),e.end()}function uY(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Bn,function(l){var c=Qe(l);switch(Os(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function _M(){var e=[wr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function hY(e){var t=[];if(!e)return t;var r=1;return(e.match(Bn)||[]).forEach(function(n){var i=Qe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function fY(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ye(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function pY(e,t,r){var n=[];return $o(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function mY(e,t,r,n){if(!e)return e;var i=n||{},s=!1;$o(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function gY(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var su=1024;function yM(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ee("xml",null,{"xmlns:v":za.v,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:mv":za.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];su<e*1e3;)su+=1e3;return t.forEach(function(s){var o=ar(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ee("v:fill",c,l),h={on:"t",obscured:"t"};++su,i=i.concat(["<v:shape"+L0({id:"_x0000_s"+su,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ee("v:shadow",null,h),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",hn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),hn("x:AutoFill","False"),hn("x:Row",String(o.r)),hn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function IE(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=ar(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=wt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=rt(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function xY(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Qe(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=ar(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&Gk(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function bM(e){var t=[wr,Ee("comments",null,{xmlns:xd[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Rt(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Rt(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(hn("t",Rt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(hn("t",Rt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vY(e,t){var r=[],n=!1,i={},s=0;return e.replace(Bn,function(l,c){var u=Qe(l);switch(Os(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function _Y(e,t,r){var n=[wr,Ee("ThreadedComments",null,{xmlns:Ir.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Ee("threadedComment",hn("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function yY(e,t){var r=[],n=!1;return e.replace(Bn,function(s){var o=Qe(s);switch(Os(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function bY(e){var t=[wr,Ee("personList",null,{xmlns:Ir.TCMNT,"xmlns:x":xd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ee("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function jY(e){var t={};t.iauthor=e.read_shift(4);var r=bd(e);return t.rfx=r.s,t.ref=Ye(r.s),e.l+=16,t}function wY(e,t){return t==null&&(t=xe(36)),t.write_shift(4,e[1].iauthor),lh(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var kY=Nn;function CY(e){return en(e.slice(0,54))}function SY(e,t){var r=[],n=[],i={},s=!1;return $o(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function $Y(e){var t=Ca(),r=[];return be(t,628),be(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),be(t,632,CY(i.a)))})}),be(t,631),be(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:ar(n[0]),e:ar(n[0])};be(t,635,wY([s,i])),i.t&&i.t.length>0&&be(t,637,XW(i)),be(t,636),delete i.iauthor})}),be(t,634),be(t,629),t.end()}var EY="application/vnd.ms-office.vbaProject";function TY(e){var t=qe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");qe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),qe.write(t)}function AY(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qe.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var jM=["xlsb","xlsm","xlam","biff8","xla"];function FY(){return{"!type":"dialog"}}function DY(){return{"!type":"dialog"}}function PY(){return{"!type":"macro"}}function MY(){return{"!type":"macro"}}var xu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,c?u+=t.r:--u,i+(l?"":"$")+nr(h)+(c?"":"$")+jr(u)}return function(i,s){return t=s,i.replace(e,r)}}(),Yk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Qk=function(){return function(t,r){return t.replace(Yk,function(n,i,s,o,l,c){var u=Nk(o)-(s?0:r.c),h=Rk(c)-(l?0:r.r),f=h==0?"":l?h+1:"["+h+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+m})}}();function wM(e,t){return e.replace(Yk,function(r,n,i,s,o,l){return n+(i=="$"?i+s:nr(Nk(s)+t.c))+(o=="$"?o+l:jr(Rk(l)+t.r))})}function OY(e,t,r){var n=Sa(t),i=n.s,s=ar(r),o={r:s.r-i.r,c:s.c-i.c};return wM(e,o)}function RY(e){return e.length!=1}function LE(e){return e.replace(/_xlfn\./g,"")}function Sr(e){e.l+=1}function zl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function kM(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return CM(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=zl(e),l=zl(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function CM(e){var t=zl(e),r=zl(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function NY(e,t,r){if(r.biff<8)return CM(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=zl(e),o=zl(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function SM(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return zY(e);var n=e.read_shift(r&&r.biff==12?4:2),i=zl(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function zY(e){var t=zl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function IY(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function LY(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return BY(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function BY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function UY(e,t,r){var n=(e[e.l++]&96)>>5,i=kM(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function VY(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=kM(e,s,r);return[n,i,o]}function HY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function WY(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function GY(e,t,r){var n=(e[e.l++]&96)>>5,i=NY(e,t-1,r);return[n,i]}function qY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function BE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function KY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function XY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function YY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function QY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function JY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function $M(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function ZY(e){return e.read_shift(2),$M(e)}function eQ(e){return e.read_shift(2),$M(e)}function tQ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=SM(e,0,r);return[n,i]}function rQ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=LY(e,0,r);return[n,i]}function nQ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=SM(e,0,r);return[n,i,s]}function aQ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[oJ[i],AM[i],n]}function iQ(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:sQ(e);return[i,(s[0]===0?AM:sJ)[s[1]]]}function sQ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oQ(e,t,r){e.l+=r&&r.biff==2?3:4}function lQ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function cQ(e){return e.l++,Eo[e.read_shift(1)]}function dQ(e){return e.l++,e.read_shift(2)}function uQ(e){return e.l++,e.read_shift(1)!==0}function hQ(e){return e.l++,Dn(e)}function fQ(e,t,r){return e.l++,bp(e,t-1,r)}function pQ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Eo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dn(e);break;case 2:r[1]=jd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function mQ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?bd:uv)(e));return i}function gQ(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=pQ(e,r.biff);return o}function xQ(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function vQ(e,t,r){if(r.biff==5)return _Q(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function _Q(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function yQ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function bQ(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function jQ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function wQ(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var kQ=In,CQ=In,SQ=In;function wp(e,t,r){return e.l+=2,[IY(e)]}function Jk(e){return e.l+=6,[]}var $Q=wp,EQ=Jk,TQ=Jk,AQ=wp;function EM(e){return e.l+=2,[Ar(e),e.read_shift(2)&1]}var FQ=wp,DQ=EM,PQ=Jk,MQ=wp,OQ=wp,RQ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NQ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=RQ[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function zQ(e){return e.l+=2,[e.read_shift(4)]}function IQ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function LQ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function BQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function UQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VQ(e){return e.l+=4,[0,0]}var UE={1:{n:"PtgExp",f:lQ},2:{n:"PtgTbl",f:SQ},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:fQ},26:{n:"PtgSheet",f:IQ},27:{n:"PtgEndSheet",f:LQ},28:{n:"PtgErr",f:cQ},29:{n:"PtgBool",f:uQ},30:{n:"PtgInt",f:dQ},31:{n:"PtgNum",f:hQ},32:{n:"PtgArray",f:qY},33:{n:"PtgFunc",f:aQ},34:{n:"PtgFuncVar",f:iQ},35:{n:"PtgName",f:xQ},36:{n:"PtgRef",f:tQ},37:{n:"PtgArea",f:UY},38:{n:"PtgMemArea",f:yQ},39:{n:"PtgMemErr",f:kQ},40:{n:"PtgMemNoMem",f:CQ},41:{n:"PtgMemFunc",f:bQ},42:{n:"PtgRefErr",f:jQ},43:{n:"PtgAreaErr",f:HY},44:{n:"PtgRefN",f:rQ},45:{n:"PtgAreaN",f:GY},46:{n:"PtgMemAreaN",f:BQ},47:{n:"PtgMemNoMemN",f:UQ},57:{n:"PtgNameX",f:vQ},58:{n:"PtgRef3d",f:nQ},59:{n:"PtgArea3d",f:VY},60:{n:"PtgRefErr3d",f:wQ},61:{n:"PtgAreaErr3d",f:WY},255:{}},HQ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WQ={1:{n:"PtgElfLel",f:EM},2:{n:"PtgElfRw",f:MQ},3:{n:"PtgElfCol",f:$Q},6:{n:"PtgElfRwV",f:OQ},7:{n:"PtgElfColV",f:AQ},10:{n:"PtgElfRadical",f:FQ},11:{n:"PtgElfRadicalS",f:PQ},13:{n:"PtgElfColS",f:EQ},15:{n:"PtgElfColSV",f:TQ},16:{n:"PtgElfRadicalLel",f:DQ},25:{n:"PtgList",f:NQ},29:{n:"PtgSxName",f:zQ},255:{}},GQ={0:{n:"PtgAttrNoop",f:VQ},1:{n:"PtgAttrSemi",f:JY},2:{n:"PtgAttrIf",f:YY},4:{n:"PtgAttrChoose",f:KY},8:{n:"PtgAttrGoto",f:XY},16:{n:"PtgAttrSum",f:oQ},32:{n:"PtgAttrBaxcel",f:BE},33:{n:"PtgAttrBaxcel",f:BE},64:{n:"PtgAttrSpace",f:ZY},65:{n:"PtgAttrSpaceSemi",f:eQ},128:{n:"PtgAttrIfError",f:QY},255:{}};function kp(e,t,r,n){if(n.biff<8)return In(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=gQ(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=mQ(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(In(e,t)),s}function Cp(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=UE[s]||UE[HQ[s]],(s===24||s===25)&&(i=(s===24?WQ:GQ)[e[e.l+1]]),!i||!i.f?In(e,t):o.push([i.n,i.f(e,t,r)]);return o}function qQ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var KQ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XQ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function TM(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function VE(e,t,r){var n=TM(e,t,r);return n=="#REF"?n:XQ(n,r)}function $n(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,h,f=0,m=0,v,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,_="",b=0,y=e[0].length;b<y;++b){var j=e[0][b];switch(j[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:_=hr(" ",e[0][x][1][1]);break;case 1:_=hr("\r",e[0][x][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+_,x=-1}l.push(u+KQ[j[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=s0(j[1][1],o,i),l.push(o0(h,s));break;case"PtgRefN":h=r?s0(j[1][1],r,i):j[1][1],l.push(o0(h,s));break;case"PtgRef3d":f=j[1][1],h=s0(j[1][2],o,i),g=VE(n,f,i),l.push(g+"!"+o0(h,s));break;case"PtgFunc":case"PtgFuncVar":var k=j[1][0],E=j[1][1];k||(k=0),k&=127;var A=k==0?[]:l.slice(-k);l.length-=k,E==="User"&&(E=A.shift()),l.push(E+"("+A.join(",")+")");break;case"PtgBool":l.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(j[1]);break;case"PtgNum":l.push(String(j[1]));break;case"PtgStr":l.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(j[1]);break;case"PtgAreaN":v=vE(j[1][1],r?{s:r}:o,i),l.push(py(v,i));break;case"PtgArea":v=vE(j[1][1],o,i),l.push(py(v,i));break;case"PtgArea3d":f=j[1][1],v=j[1][2],g=VE(n,f,i),l.push(g+"!"+py(v,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=j[1][2];var w=(n.names||[])[m-1]||(n[0]||[])[m],P=w?w.Name:"SH33TJSNAME"+String(m);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var M=j[1][1];m=j[1][2];var F;if(i.biff<=5)M<0&&(M=-M),n[M]&&(F=n[M][m]);else{var D="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][m]&&n[M][m].itab>0&&(D=n.SheetNames[n[M][m].itab-1]+"!"):D=n.SheetNames[m-1]+"!"),n[M]&&n[M][m])D+=n[M][m].Name;else if(n[0]&&n[0][m])D+=n[0][m].Name;else{var W=(TM(n,M,i)||"").split(";;");W[m-1]?D=W[m-1]:D+="SH33TJSERRX"}l.push(D);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var B="(",G=")";if(x>=0){switch(_="",e[0][x][1][0]){case 2:B=hr(" ",e[0][x][1][1])+B;break;case 3:B=hr("\r",e[0][x][1][1])+B;break;case 4:G=hr(" ",e[0][x][1][1])+G;break;case 5:G=hr("\r",e[0][x][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(B+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:j[1][1],r:j[1][0]};var Y={c:r.c,r:r.r};if(n.sharedf[Ye(h)]){var ae=n.sharedf[Ye(h)];l.push($n(ae,o,Y,n,i))}else{var U=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){l.push($n(u[1],o,Y,n,i)),U=!0;break}U||l.push(j[1])}break;case"PtgArray":l.push("{"+qQ(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&q.indexOf(e[0][b][0])==-1){j=e[0][x];var z=!0;switch(j[1][0]){case 4:z=!1;case 0:_=hr(" ",j[1][1]);break;case 5:z=!1;case 1:_=hr("\r",j[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}l.push((z?_:"")+l.pop()+(z?"":_)),x=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function YQ(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],In(e,t-2)];var l=Cp(e,o,r);return t!==o+i&&(s=kp(e,t-o-i,l,r)),e.l=n,[l,s]}function QQ(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],In(e,t-2)];var l=Cp(e,o,r);return t!==o+i&&(s=kp(e,t-o-i,l,r)),e.l=n,[l,s]}function JQ(e,t,r,n){var i=e.l+t,s=Cp(e,n,r),o;return i!==e.l&&(o=kp(e,i-e.l,s,r)),[s,o]}function ZQ(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=Cp(e,s,r);return s==65535?[[],In(e,t-2)]:(t!==s+2&&(i=kp(e,n-s-2,o,r)),[o,i])}function eJ(e){var t;if(uo(e,e.l+6)!==65535)return[Dn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function tJ(e){if(e==null){var t=xe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ld(e);return ld(0)}function _y(e,t,r){var n=e.l+t,i=Rs(e);r.biff==2&&++e.l;var s=eJ(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=QQ(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function rJ(e,t,r,n,i){var s=dd(t,r,i),o=tJ(e.v),l=xe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=xe(e.bf.length),h=0;h<e.bf.length;++h)u[h]=e.bf[h];var f=Zr([s,o,l,u]);return f}function hv(e,t,r){var n=e.read_shift(4),i=Cp(e,n,r),s=e.read_shift(4),o=s>0?kp(e,s,i,r):null;return[i,o]}var nJ=hv,fv=hv,aJ=hv,iJ=hv,sJ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oJ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function HE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function lJ(e){var t="of:="+e.replace(Yk,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yy(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function cJ(e){return e.replace(/\./,"!")}var c0={},vu={},d0=typeof Map<"u";function Zk(e,t,r){var n=0,i=e.length;if(r){if(d0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=d0?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(d0?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function pv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Tn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=W0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=j1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Xc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ql(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){xo(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function FM(e,t,r,n,i,s){try{n.cellNF&&(e.z=Xe[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Yt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Xe[t]==null&&xo(sW[t]||"General",t),e.t==="e")e.w=e.w||Eo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=z0(e.v);else if(e.t==="d"){var o=Vr(e.v);(o|0)===o?e.w=o.toString(10):e.w=z0(o)}else{if(e.v===void 0)return"";e.w=sd(e.v,vu)}else e.t==="d"?e.w=Fi(t,Vr(e.v),vu):e.w=Fi(t,e.v,vu)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=b1(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=b1(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function dJ(e,t,r){if(e&&e["!ref"]){var n=wt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function uJ(e,t){var r=wt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rt(r))}var hJ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fJ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pJ=/<(?:\w:)?hyperlink [^>]*>/mg,mJ=/"(\w*:\w*)"/,gJ=/<(?:\w:)?col\b[^>]*[\/]?>/g,xJ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vJ=/<(?:\w:)?pageMargins[^>]*\/>/g,DM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,_J=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yJ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bJ(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",f=e.match(fJ);f?(u=e.slice(0,f.index),h=e.slice(f.index+f[0].length)):u=h=e;var m=u.match(DM);m?eC(m[0],l,i,r):(m=u.match(_J))&&wJ(m[0],m[1]||"",l,i,r);var v=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var g=u.slice(v,v+50).match(mJ);g&&uJ(l,g[1])}var x=u.match(yJ);x&&x[1]&&RJ(x[1],i);var _=[];if(t.cellStyles){var b=u.match(gJ);b&&FJ(_,b)}f&&IJ(f[1],l,t,c,s,o);var y=h.match(xJ);y&&(l["!autofilter"]=PJ(y[0]));var j=[],k=h.match(hJ);if(k)for(v=0;v!=k.length;++v)j[v]=wt(k[v].slice(k[v].indexOf('"')+1));var E=h.match(pJ);E&&EJ(l,E,n);var A=h.match(vJ);if(A&&(l["!margins"]=TJ(Qe(A[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=rt(c)),t.sheetRows>0&&l["!ref"]){var w=wt(l["!ref"]);t.sheetRows<=+w.e.r&&(w.e.r=t.sheetRows-1,w.e.r>c.e.r&&(w.e.r=c.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>c.e.c&&(w.e.c=c.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rt(w))}return _.length>0&&(l["!cols"]=_),j.length>0&&(l["!merges"]=j),l}function jJ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function eC(e,t,r,n){var i=Qe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=jt(It(i.codeName)))}function wJ(e,t,r,n,i){eC(e.slice(0,e.indexOf(">")),r,n,i)}function kJ(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Fs(Rt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Ee("outlinePr",null,u)}!s&&!l||(i[i.length]=Ee("sheetPr",l,o))}var CJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],SJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $J(e){var t={sheet:1};return CJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),SJ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=qk(e.password).toString(16).toUpperCase()),Ee("sheetProtection",null,t)}function EJ(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Qe(It(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+jt(s.location))):(s.Target="#"+jt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=wt(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var h=Ye({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}function TJ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function AJ(e){return Xc(e),Ee("pageMargins",null,e)}function FJ(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Qe(t[n],!0);i.hidden&&(i.hidden=Kt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Kk(i.width)),Nl(i);s<=o;)e[s++]=Qt(i)}}function DJ(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ee("col",null,pv(i,n)));return r[r.length]="</cols>",r.join("")}function PJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function MJ(e,t,r,n){var i=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Sa(i);o.s.r==o.e.r&&(o.e.r=Sa(t["!ref"]).e.r,i=rt(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ee("autoFilter",null,{ref:i})}var OJ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function RJ(e,t){t.Views||(t.Views=[{}]),(e.match(OJ)||[]).forEach(function(r,n){var i=Qe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Kt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function NJ(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,i),{})}function zJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Eo[e.v];break;case"d":n&&n.cellDates?i=Yt(e.v,-1).toISOString():(e=Qt(e),e.t="n",i=""+(e.v=Vr(Yt(e.v)))),typeof e.z>"u"&&(e.z=Xe[14]);break;default:i=e.v;break}var l=hn("v",Rt(i)),c={r:t},u=ql(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=hn("v",""+Zk(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Ee("f",Rt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ee("c",l,c)}var IJ=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=I0("v"),o=I0("f");return function(c,u,h,f,m,v){for(var g=0,x="",_=[],b=[],y=0,j=0,k=0,E="",A,w,P=0,M=0,F,D,W=0,B=0,G=Array.isArray(v.CellXf),Y,ae=[],U=[],q=Array.isArray(u),z=[],ie={},he=!1,O=!!h.sheetStubs,R=c.split(t),I=0,K=R.length;I!=K;++I){x=R[I].trim();var ne=x.length;if(ne!==0){var ee=0;e:for(g=0;g<ne;++g)switch(x[g]){case">":if(x[g-1]!="/"){++g;break e}if(h&&h.cellStyles){if(w=Qe(x.slice(ee,g),!0),P=w.r!=null?parseInt(w.r,10):P+1,M=-1,h.sheetRows&&h.sheetRows<P)continue;ie={},he=!1,w.ht&&(he=!0,ie.hpt=parseFloat(w.ht),ie.hpx=Xu(ie.hpt)),w.hidden=="1"&&(he=!0,ie.hidden=!0),w.outlineLevel!=null&&(he=!0,ie.level=+w.outlineLevel),he&&(z[P-1]=ie)}break;case"<":ee=g;break}if(ee>=g)break;if(w=Qe(x.slice(ee,g),!0),P=w.r!=null?parseInt(w.r,10):P+1,M=-1,!(h.sheetRows&&h.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),h&&h.cellStyles&&(ie={},he=!1,w.ht&&(he=!0,ie.hpt=parseFloat(w.ht),ie.hpx=Xu(ie.hpt)),w.hidden=="1"&&(he=!0,ie.hidden=!0),w.outlineLevel!=null&&(he=!0,ie.level=+w.outlineLevel),he&&(z[P-1]=ie)),_=x.slice(g).split(e);for(var ge=0;ge!=_.length&&_[ge].trim().charAt(0)=="<";++ge);for(_=_.slice(ge),g=0;g!=_.length;++g)if(x=_[g].trim(),x.length!==0){if(b=x.match(r),y=g,j=0,k=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,b!=null&&b.length===2){for(y=0,E=b[1],j=0;j!=E.length&&!((k=E.charCodeAt(j)-64)<1||k>26);++j)y=26*y+k;--y,M=y}else++M;for(j=0;j!=x.length&&x.charCodeAt(j)!==62;++j);if(++j,w=Qe(x.slice(0,j),!0),w.r||(w.r=Ye({r:P-1,c:M})),E=x.slice(j),A={t:""},(b=E.match(s))!=null&&b[1]!==""&&(A.v=jt(b[1])),h.cellFormula){if((b=E.match(o))!=null&&b[1]!==""){if(A.f=jt(It(b[1])).replace(/\r\n/g,`
`),h.xlfn||(A.f=LE(A.f)),b[0].indexOf('t="array"')>-1)A.F=(E.match(i)||[])[1],A.F.indexOf(":")>-1&&ae.push([wt(A.F),A.F]);else if(b[0].indexOf('t="shared"')>-1){D=Qe(b[0]);var L=jt(It(b[1]));h.xlfn||(L=LE(L)),U[parseInt(D.si,10)]=[D,L,w.r]}}else(b=E.match(/<f[^>]*\/>/))&&(D=Qe(b[0]),U[D.si]&&(A.f=OY(U[D.si][1],U[D.si][2],w.r)));var se=ar(w.r);for(j=0;j<ae.length;++j)se.r>=ae[j][0].s.r&&se.r<=ae[j][0].e.r&&se.c>=ae[j][0].s.c&&se.c<=ae[j][0].e.c&&(A.F=ae[j][1])}if(w.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(O)A.t="z";else continue;else A.t=w.t||"n";switch(f.s.c>M&&(f.s.c=M),f.e.c<M&&(f.e.c=M),A.t){case"n":if(A.v==""||A.v==null){if(!O)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!O)continue;A.t="z"}else F=c0[parseInt(A.v,10)],A.v=F.t,A.r=F.r,h.cellHTML&&(A.h=F.h);break;case"str":A.t="s",A.v=A.v!=null?It(A.v):"",h.cellHTML&&(A.h=Dk(A.v));break;case"inlineStr":b=E.match(n),A.t="s",b!=null&&(F=Gk(b[1]))?(A.v=F.t,h.cellHTML&&(A.h=F.h)):A.v="";break;case"b":A.v=Kt(A.v);break;case"d":h.cellDates?A.v=Yt(A.v,1):(A.v=Vr(Yt(A.v,1)),A.t="n");break;case"e":(!h||h.cellText!==!1)&&(A.w=A.v),A.v=M8[A.v];break}if(W=B=0,Y=null,G&&w.s!==void 0&&(Y=v.CellXf[w.s],Y!=null&&(Y.numFmtId!=null&&(W=Y.numFmtId),h.cellStyles&&Y.fillId!=null&&(B=Y.fillId))),FM(A,W,B,h,m,v),h.cellDates&&G&&A.t=="n"&&ih(Xe[W])&&(A.t="d",A.v=dv(A.v)),w.cm&&h.xlmeta){var ke=(h.xlmeta.Cell||[])[+w.cm-1];ke&&ke.type=="XLDAPR"&&(A.D=!0)}if(q){var V=ar(w.r);u[V.r]||(u[V.r]=[]),u[V.r][V.c]=A}else u[w.r]=A}}}}z.length>0&&(u["!rows"]=z)}}();function LJ(e,t,r,n){var i=[],s=[],o=wt(e["!ref"]),l="",c,u="",h=[],f=0,m=0,v=e["!rows"],g=Array.isArray(e),x={r:u},_,b=-1;for(m=o.s.c;m<=o.e.c;++m)h[m]=nr(m);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=jr(f),m=o.s.c;m<=o.e.c;++m){c=h[m]+u;var y=g?(e[f]||[])[m]:e[c];y!==void 0&&(l=zJ(y,c,e,t))!=null&&s.push(l)}(s.length>0||v&&v[f])&&(x={r:u},v&&v[f]&&(_=v[f],_.hidden&&(x.hidden=1),b=-1,_.hpx?b=G0(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(x.ht=b,x.customHeight=1),_.level&&(x.outlineLevel=_.level)),i[i.length]=Ee("row",s.join(""),x))}if(v)for(;f<v.length;++f)v&&v[f]&&(x={r:f+1},_=v[f],_.hidden&&(x.hidden=1),b=-1,_.hpx?b=G0(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(x.ht=b,x.customHeight=1),_.level&&(x.outlineLevel=_.level),i[i.length]=Ee("row","",x));return i.join("")}function PM(e,t,r,n){var i=[wr,Ee("worksheet",null,{xmlns:xd[0],"xmlns:r":Ir.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",h=wt(u);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=rt(h)}n||(n={}),c["!comments"]=[];var f=[];kJ(c,r,e,t,i),i[i.length]=Ee("dimension",null,{ref:u}),i[i.length]=NJ(c,t,e,r),t.sheetFormat&&(i[i.length]=Ee("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=DJ(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=LJ(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=$J(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=MJ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=jJ(c["!merges"]));var m=-1,v,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(v={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=Pt(n,-1,Rt(x[1].Target).replace(/#.*$/,""),pt.HLINK),v["r:id"]="rId"+g),(m=x[1].Target.indexOf("#"))>-1&&(v.location=Rt(x[1].Target.slice(m+1))),x[1].Tooltip&&(v.tooltip=Rt(x[1].Tooltip)),i[i.length]=Ee("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=AJ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=hn("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Pt(n,-1,"../drawings/drawing"+(e+1)+".xml",pt.DRAW),i[i.length]=Ee("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Pt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",pt.VML),i[i.length]=Ee("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function BJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function UJ(e,t,r){var n=xe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=G0(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,m=-1,v=h<<10;v<h+1<<10;++v){u.c=v;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ye(u)];g&&(f<0&&(f=v),m=v)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var x=n.l;return n.l=c,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function VJ(e,t,r,n){var i=UJ(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&be(e,0,i)}var HJ=bd,WJ=lh;function GJ(){}function qJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=YW(e),r}function KJ(e,t,r){r==null&&(r=xe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return v1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),T8(e,r),r.slice(0,r.l)}function XJ(e){var t=Pi(e);return[t]}function YJ(e,t,r){return r==null&&(r=xe(8)),vd(t,r)}function QJ(e){var t=_d(e);return[t]}function JJ(e,t,r){return r==null&&(r=xe(4)),yd(t,r)}function ZJ(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"b"]}function eZ(e,t,r){return r==null&&(r=xe(9)),vd(t,r),r.write_shift(1,e.v?1:0),r}function tZ(e){var t=_d(e),r=e.read_shift(1);return[t,r,"b"]}function rZ(e,t,r){return r==null&&(r=xe(5)),yd(t,r),r.write_shift(1,e.v?1:0),r}function nZ(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"e"]}function aZ(e,t,r){return r==null&&(r=xe(9)),vd(t,r),r.write_shift(1,e.v),r}function iZ(e){var t=_d(e),r=e.read_shift(1);return[t,r,"e"]}function sZ(e,t,r){return r==null&&(r=xe(8)),yd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function oZ(e){var t=Pi(e),r=e.read_shift(4);return[t,r,"s"]}function lZ(e,t,r){return r==null&&(r=xe(12)),vd(t,r),r.write_shift(4,t.v),r}function cZ(e){var t=_d(e),r=e.read_shift(4);return[t,r,"s"]}function dZ(e,t,r){return r==null&&(r=xe(8)),yd(t,r),r.write_shift(4,t.v),r}function uZ(e){var t=Pi(e),r=Dn(e);return[t,r,"n"]}function hZ(e,t,r){return r==null&&(r=xe(16)),vd(t,r),ld(e.v,r),r}function MM(e){var t=_d(e),r=Dn(e);return[t,r,"n"]}function fZ(e,t,r){return r==null&&(r=xe(12)),yd(t,r),ld(e.v,r),r}function pZ(e){var t=Pi(e),r=Bk(e);return[t,r,"n"]}function mZ(e,t,r){return r==null&&(r=xe(12)),vd(t,r),A8(e.v,r),r}function gZ(e){var t=_d(e),r=Bk(e);return[t,r,"n"]}function xZ(e,t,r){return r==null&&(r=xe(8)),yd(t,r),A8(e.v,r),r}function vZ(e){var t=Pi(e),r=zk(e);return[t,r,"is"]}function _Z(e){var t=Pi(e),r=Nn(e);return[t,r,"str"]}function yZ(e,t,r){return r==null&&(r=xe(12+4*e.v.length)),vd(t,r),en(e.v,r),r.length>r.l?r.slice(0,r.l):r}function bZ(e){var t=_d(e),r=Nn(e);return[t,r,"str"]}function jZ(e,t,r){return r==null&&(r=xe(8+4*e.v.length)),yd(t,r),en(e.v,r),r.length>r.l?r.slice(0,r.l):r}function wZ(e,t,r){var n=e.l+t,i=Pi(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=fv(e,n-e.l,r);o[3]=$n(l,null,i,r.supbooks,r)}else e.l=n;return o}function kZ(e,t,r){var n=e.l+t,i=Pi(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=fv(e,n-e.l,r);o[3]=$n(l,null,i,r.supbooks,r)}else e.l=n;return o}function CZ(e,t,r){var n=e.l+t,i=Pi(e);i.r=r["!row"];var s=Dn(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=fv(e,n-e.l,r);o[3]=$n(l,null,i,r.supbooks,r)}else e.l=n;return o}function SZ(e,t,r){var n=e.l+t,i=Pi(e);i.r=r["!row"];var s=Nn(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=fv(e,n-e.l,r);o[3]=$n(l,null,i,r.supbooks,r)}else e.l=n;return o}var $Z=bd,EZ=lh;function TZ(e,t){return t==null&&(t=xe(4)),t.write_shift(4,e),t}function AZ(e,t){var r=e.l+t,n=bd(e),i=Ik(e),s=Nn(e),o=Nn(e),l=Nn(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function FZ(e,t){var r=xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));lh({s:ar(e[0]),e:ar(e[0])},r),Lk("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return en(i||"",r),en(e[1].Tooltip||"",r),en("",r),r.slice(0,r.l)}function DZ(){}function PZ(e,t,r){var n=e.l+t,i=F8(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=nJ(e,n-e.l,r);o[1]=l}else e.l=n;return o}function MZ(e,t,r){var n=e.l+t,i=bd(e),s=[i];if(r.cellFormula){var o=iJ(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function OZ(e,t,r){r==null&&(r=xe(18));var n=pv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var OM=["left","right","top","bottom","header","footer"];function RZ(e){var t={};return OM.forEach(function(r){t[r]=Dn(e)}),t}function NZ(e,t){return t==null&&(t=xe(6*8)),Xc(e),OM.forEach(function(r){ld(e[r],t)}),t}function zZ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function IZ(e,t,r){r==null&&(r=xe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LZ(e){var t=xe(24);return t.write_shift(4,4),t.write_shift(4,1),lh(e,t),t}function BZ(e,t){return t==null&&(t=xe(16*4+2)),t.write_shift(2,e.password?qk(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function UZ(){}function VZ(){}function HZ(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,v,g,x,_,b,y,j,k,E,A=[];l.biff=12,l["!row"]=0;var w=0,P=!1,M=[],F={},D=l.supbooks||i.supbooks||[[]];if(D.sharedf=F,D.arrayf=M,D.SheetNames=i.SheetNames||i.Sheets.map(function(q){return q.name}),!l.supbooks&&(l.supbooks=D,i.Names))for(var W=0;W<i.Names.length;++W)D[0][W+1]=i.Names[W];var B=[],G=[],Y=!1;q0[16]={n:"BrtShortReal",f:MM};var ae;if($o(e,function(z,ie,he){if(!m)switch(he){case 148:u=z;break;case 0:v=z,l.sheetRows&&l.sheetRows<=v.r&&(m=!0),k=jr(_=v.r),l["!row"]=v.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Xu(z.hpt)),G[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:z[2]},z[2]){case"n":g.v=z[1];break;case"s":j=c0[z[1]],g.v=j.t,g.r=j.r;break;case"b":g.v=!!z[1];break;case"e":g.v=z[1],l.cellText!==!1&&(g.w=Eo[g.v]);break;case"str":g.t="s",g.v=z[1];break;case"is":g.t="s",g.v=z[1].t;break}if((x=o.CellXf[z[0].iStyleRef])&&FM(g,x.numFmtId,null,l,s,o),b=z[0].c==-1?b+1:z[0].c,l.dense?(c[_]||(c[_]=[]),c[_][b]=g):c[nr(b)+k]=g,l.cellFormula){for(P=!1,w=0;w<M.length;++w){var O=M[w];v.r>=O[0].s.r&&v.r<=O[0].e.r&&b>=O[0].s.c&&b<=O[0].e.c&&(g.F=rt(O[0]),P=!0)}!P&&z.length>3&&(g.f=z[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>b&&(h.s.c=b),h.e.r<v.r&&(h.e.r=v.r),h.e.c<b&&(h.e.c=b),l.cellDates&&x&&g.t=="n"&&ih(Xe[x.numFmtId])){var R=Fc(g.v);R&&(g.t="d",g.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},b=z[0].c==-1?b+1:z[0].c,l.dense?(c[_]||(c[_]=[]),c[_][b]=g):c[nr(b)+k]=g,h.s.r>v.r&&(h.s.r=v.r),h.s.c>b&&(h.s.c=b),h.e.r<v.r&&(h.e.r=v.r),h.e.c<b&&(h.e.c=b),ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 176:A.push(z);break;case 49:ae=((l.xlmeta||{}).Cell||[])[z-1];break;case 494:var I=n["!id"][z.relId];for(I?(z.Target=I.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=I):z.relId==""&&(z.Target="#"+z.loc),_=z.rfx.s.r;_<=z.rfx.e.r;++_)for(b=z.rfx.s.c;b<=z.rfx.e.c;++b)l.dense?(c[_]||(c[_]=[]),c[_][b]||(c[_][b]={t:"z",v:void 0}),c[_][b].l=z):(y=Ye({c:b,r:_}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=z);break;case 426:if(!l.cellFormula)break;M.push(z),E=l.dense?c[_][b]:c[nr(b)+k],E.f=$n(z[1],h,{r:v.r,c:b},D,l),E.F=rt(z[0]);break;case 427:if(!l.cellFormula)break;F[Ye(z[0].s)]=z[1],E=l.dense?c[_][b]:c[nr(b)+k],E.f=$n(z[1],h,{r:v.r,c:b},D,l);break;case 60:if(!l.cellStyles)break;for(;z.e>=z.s;)B[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},Y||(Y=!0,Kk(z.w/256)),Nl(B[z.e+1]);break;case 161:c["!autofilter"]={ref:rt(z)};break;case 476:c["!margins"]=z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),z.name&&(i.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ie.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=rt(u||h)),l.sheetRows&&c["!ref"]){var U=wt(c["!ref"]);l.sheetRows<=+U.e.r&&(U.e.r=l.sheetRows-1,U.e.r>h.e.r&&(U.e.r=h.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>h.e.c&&(U.e.c=h.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),c["!fullref"]=c["!ref"],c["!ref"]=rt(U))}return A.length>0&&(c["!merges"]=A),B.length>0&&(c["!cols"]=B),G.length>0&&(c["!rows"]=G),c}function WZ(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Qt(t),t.z=t.z||Xe[14],t.v=Vr(Yt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=ql(i.cellXfs,t,i),t.l&&s["!links"].push([Ye(c),t.l]),t.c&&s["!comments"].push([Ye(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=Zk(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?be(e,18,dZ(t,c)):be(e,7,lZ(t,c))):(c.t="str",o?be(e,17,jZ(t,c)):be(e,6,yZ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?be(e,13,xZ(t,c)):be(e,2,mZ(t,c)):o?be(e,16,fZ(t,c)):be(e,5,hZ(t,c)),!0;case"b":return c.t="b",o?be(e,15,rZ(t,c)):be(e,4,eZ(t,c)),!0;case"e":return c.t="e",o?be(e,14,sZ(t,c)):be(e,3,aZ(t,c)),!0}return o?be(e,12,JJ(t,c)):be(e,1,YJ(t,c)),!0}function GZ(e,t,r,n){var i=wt(t["!ref"]||"A1"),s,o="",l=[];be(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=u;++h){o=jr(h),VJ(e,t,i,h);var f=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(l[m]=nr(m)),s=l[m]+o;var v=c?(t[h]||[])[m]:t[s];if(!v){f=!1;continue}f=WZ(e,v,h,m,n,t,f)}}be(e,146)}function qZ(e,t){!t||!t["!merges"]||(be(e,177,TZ(t["!merges"].length)),t["!merges"].forEach(function(r){be(e,176,EZ(r))}),be(e,178))}function KZ(e,t){!t||!t["!cols"]||(be(e,390),t["!cols"].forEach(function(r,n){r&&be(e,60,OZ(n,r))}),be(e,391))}function XZ(e,t){!t||!t["!ref"]||(be(e,648),be(e,649,LZ(wt(t["!ref"]))),be(e,650))}function YZ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Pt(r,-1,n[1].Target.replace(/#.*$/,""),pt.HLINK);be(e,494,FZ(n,i))}}),delete t["!links"]}function QZ(e,t,r,n){if(t["!comments"].length>0){var i=Pt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",pt.VML);be(e,551,Lk("rId"+i)),t["!legacy"]=i}}function JZ(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:rt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Sa(s);l.s.r==l.e.r&&(l.e.r=Sa(t["!ref"]).e.r,s=rt(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),be(e,161,lh(wt(s))),be(e,162)}}function ZZ(e,t,r){be(e,133),be(e,137,IZ(t,r)),be(e,138),be(e,134)}function eee(e,t){t["!protect"]&&be(e,535,BZ(t["!protect"]))}function tee(e,t,r,n){var i=Ca(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=wt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],be(i,129),(r.vbaraw||o["!outline"])&&be(i,147,KJ(l,o["!outline"])),be(i,148,WJ(c)),ZZ(i,o,r.Workbook),KZ(i,o),GZ(i,o,e,t),eee(i,o),JZ(i,o,r,e),qZ(i,o),YZ(i,o,n),o["!margins"]&&be(i,476,NZ(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&XZ(i,o),QZ(i,o,e,n),be(i,130),i.end()}function ree(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function nee(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=ree(f);h.s.r=h.s.c=0,h.e.c=l,u=nr(l),m[0].forEach(function(v,g){o[u+jr(g)]={t:"n",v,z:m[1]},c=g}),h.e.r<c&&(h.e.r=c),++l}),l>0&&(o["!ref"]=rt(h)),o}function aee(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(DM);return l&&eC(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iee(e,t){e.l+=10;var r=Nn(e);return{name:r}}function see(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return $o(e,function(c,u,h){switch(h){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var tC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oee=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],lee=[],cee=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function WE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Kt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function GE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Kt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function RM(e){GE(e.WBProps,tC),GE(e.CalcPr,cee),WE(e.WBView,oee),WE(e.Sheets,lee),vu.date1904=Kt(e.WBProps.date1904)}function dee(e){return!e.Workbook||!e.Workbook.WBProps?"false":Kt(e.Workbook.WBProps.date1904)?"true":"false"}var uee="][*?/\\".split("");function NM(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uee.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function hee(e,t,r){e.forEach(function(n,i){NM(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function fee(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];hee(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)dJ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var pee=/<\w+:workbook/;function mee(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Bn,function(c,u){var h=Qe(c);switch(Os(h[0])){case"<?xml":break;case"<workbook":c.match(pee)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":tC.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Kt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=It(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=jt(It(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=It(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Kt(h.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=jt(It(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),xd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return RM(r),r}function zM(e){var t=[wr];t[t.length]=Ee("workbook",null,{xmlns:xd[0],"xmlns:r":Ir.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(tC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ee("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Rt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ee("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ee("definedName",Rt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function gee(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Nw(e),r.name=Nn(e),r}function xee(e,t){return t||(t=xe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Lk(e.strRelID,t),en(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function vee(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Nn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function _ee(e,t){t||(t=xe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),T8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function yee(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function bee(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=QW(e),o=aJ(e,0,r),l=Ik(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function jee(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],q0[16]={n:"BrtFRTArchID$",f:yee},$o(e,function(c,u,h){switch(h){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=$n(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,c]):o[0]=[h,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),RM(r),r.Names=s,r.supbooks=o,r}function wee(e,t){be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};be(e,156,xee(i))}be(e,144)}function kee(e,t){t||(t=xe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return en("SheetJS",t),en(u1.version,t),en(u1.version,t),en("7262",t),t.length>t.l?t.slice(0,t.l):t}function Cee(e,t){t||(t=xe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function See(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(be(e,135),be(e,158,Cee(i)),be(e,136))}}function $ee(e,t){var r=Ca();return be(r,131),be(r,128,kee()),be(r,153,_ee(e.Workbook&&e.Workbook.WBProps||null)),See(r,e),wee(r,e),be(r,132),r.end()}function Eee(e,t,r){return t.slice(-4)===".bin"?jee(e,r):mee(e,r)}function Tee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?HZ(e,n,r,i,s,o,l):bJ(e,n,r,i,s,o,l)}function Aee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?see(e,n,r,i,s):aee(e,n,r,i,s)}function Fee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?PY():MY()}function Dee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?FY():DY()}function Pee(e,t,r,n){return t.slice(-4)===".bin"?EX(e,r,n):gX(e,r,n)}function Mee(e,t,r){return vM(e,r)}function Oee(e,t,r){return t.slice(-4)===".bin"?OK(e,r):DK(e,r)}function Ree(e,t,r){return t.slice(-4)===".bin"?SY(e,r):xY(e,r)}function Nee(e,t,r){return t.slice(-4)===".bin"?pY(e):hY(e)}function zee(e,t,r,n){return r.slice(-4)===".bin"?mY(e,t,r,n):void 0}function Iee(e,t,r){return t.slice(-4)===".bin"?cY(e,t,r):uY(e,t,r)}function Lee(e,t,r){return(t.slice(-4)===".bin"?$ee:zM)(e)}function Bee(e,t,r,n,i){return(t.slice(-4)===".bin"?tee:PM)(e,r,n,i)}function Uee(e,t,r){return(t.slice(-4)===".bin"?zX:gM)(e,r)}function Vee(e,t,r){return(t.slice(-4)===".bin"?zK:lM)(e,r)}function Hee(e,t,r){return(t.slice(-4)===".bin"?$Y:bM)(e)}function Wee(e){return(e.slice(-4)===".bin"?dY:_M)()}var IM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(IM),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(LM),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Gee(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(IM),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(LM),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var u0;function qee(e,t){var r=u0[e]||jt(e);return r==="General"?sd(t):Fi(r,t)}function Kee(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Kt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Yt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[jt(t)]=i}function Xee(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Eo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=z0(e.v):e.w=sd(e.v):e.w=qee(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=u0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ih(n)){var i=Fc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Yee(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=lX[n.Pattern]||n.Pattern)}e[t.ID]=t}function Qee(e,t,r,n,i,s,o,l,c,u){var h="General",f=n.StyleID,m={};u=u||{};var v=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&v.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Kt(e);break;case"String":n.t="s",n.r=cE(jt(e)),n.v=e.indexOf("<")>-1?jt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Yt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=jt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=M8[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=cE(t||e));break}if(Xee(n,h,u),u.cellFormula!==!1)if(n.Formula){var x=jt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=xu(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=xu("RC:RC",i):n.ArrayRange&&(n.F=xu(n.ArrayRange,i),c.push([wt(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(v.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Jee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function by(e,t){var r=t||{};sh();var n=Uf(Pk(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=It(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Qt(r);return o.type="string",Ku.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(St){i.indexOf("<"+St)>=0&&(s=!0)}),s)return Nte(n,r);u0={"General Number":"General","General Date":Xe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Xe[15],"Short Date":Xe[14],"Long Time":Xe[19],"Medium Time":Xe[18],"Short Time":Xe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Xe[2],Standard:Xe[4],Percent:Xe[10],Scientific:Xe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,h={},f=[],m=r.dense?[]:{},v="",g={},x={},_=Vi('<Data ss:Type="String">'),b=0,y=0,j=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},A={},w="",P=0,M=[],F={},D={},W=0,B=[],G=[],Y={},ae=[],U,q=!1,z=[],ie=[],he={},O=0,R=0,I={Sheets:[],WBProps:{date1904:!1}},K={};B0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";l=B0.exec(n);)switch(l[3]=(ne=l[3]).toLowerCase()){case"data":if(ne=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Qee(n.slice(b,l.index),w,_,c[c.length-1][0]=="comment"?Y:g,{c:y,r:j},E,ae[y],x,z,r):(w="",_=Vi(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(g.c=G),(!r.sheetRows||r.sheetRows>j)&&g.v!==void 0&&(r.dense?(m[j]||(m[j]=[]),m[j][y]=g):m[nr(y)+jr(j)]=g),g.HRef&&(g.l={Target:jt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(O=y+(parseInt(g.MergeAcross,10)|0),R=j+(parseInt(g.MergeDown,10)|0),M.push({s:{c:y,r:j},e:{c:O,r:R}})),!r.sheetStubs)g.MergeAcross?y=O+1:++y;else if(g.MergeAcross||g.MergeDown){for(var ee=y;ee<=O;++ee)for(var ge=j;ge<=R;++ge)(ee>y||ge>j)&&(r.dense?(m[ge]||(m[ge]=[]),m[ge][ee]={t:"z"}):m[nr(ee)+jr(ge)]={t:"z"});y=O+1}else++y;else g=Gee(l[0]),g.Index&&(y=+g.Index-1),y<k.s.c&&(k.s.c=y),y>k.e.c&&(k.e.c=y),l[0].slice(-2)==="/>"&&++y,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(j<k.s.r&&(k.s.r=j),j>k.e.r&&(k.e.r=j),l[0].slice(-2)==="/>"&&(x=Vi(l[0]),x.Index&&(j=+x.Index-1)),y=0,++j):(x=Vi(l[0]),x.Index&&(j=+x.Index-1),he={},(x.AutoFitHeight=="0"||x.Height)&&(he.hpx=parseInt(x.Height,10),he.hpt=G0(he.hpx),ie[j]=he),x.Hidden=="1"&&(he.hidden=!0,ie[j]=he));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(v),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(m["!ref"]=rt(k),r.sheetRows&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=rt(k))),M.length&&(m["!merges"]=M),ae.length>0&&(m["!cols"]=ae),ie.length>0&&(m["!rows"]=ie),h[v]=m}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=y=0,c.push([l[3],!1]),u=Vi(l[0]),v=jt(u.Name),m=r.dense?[]:{},M=[],z=[],ie=[],K={name:v,Hidden:0},I.Sheets.push(K);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],q=!1}break;case"style":l[1]==="/"?Yee(E,A,r):A=Vi(l[0]);break;case"numberformat":A.nf=jt(Vi(l[0]).Format||"General"),u0[A.nf]&&(A.nf=u0[A.nf]);for(var L=0;L!=392&&Xe[L]!=A.nf;++L);if(L==392){for(L=57;L!=392;++L)if(Xe[L]==null){xo(A.nf,L);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(U=Vi(l[0]),U.Hidden&&(U.hidden=!0,delete U.Hidden),U.Width&&(U.wpx=parseInt(U.Width,10)),!q&&U.wpx>10){q=!0,Tn=pM;for(var se=0;se<ae.length;++se)ae[se]&&Nl(ae[se])}q&&Nl(U),ae[U.Index-1||ae.length]=U;for(var ke=0;ke<+U.Span;++ke)ae[ae.length]=Qt(U);break;case"namedrange":if(l[1]==="/")break;I.Names||(I.Names=[]);var V=Qe(l[0]),Ve={Name:V.Name,Ref:xu(V.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ve.Sheet=I.Sheets.length-1),I.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?w+=n.slice(P,l.index):P=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;A.Interior=Vi(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?jG(F,ne,n.slice(W,l.index)):W=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Jee(Y),G.push(Y)}else c.push([l[3],!1]),u=Vi(l[0]),Y={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ke=Vi(l[0]);m["!autofilter"]={ref:xu(Ke.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return QE(n,r);var ye=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ye=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ye=!1}break;case"excelworkbook":switch(l[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ye=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ye=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(W,l.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else W=l.index+l[0].length;break;case"header":m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+Qe(l[0]).Margin)||(m["!margins"].header=+Qe(l[0]).Margin);break;case"footer":m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+Qe(l[0]).Margin)||(m["!margins"].footer=+Qe(l[0]).Margin);break;case"pagemargins":var T=Qe(l[0]);m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+T.Top)||(m["!margins"].top=+T.Top),isNaN(+T.Left)||(m["!margins"].left=+T.Left),isNaN(+T.Right)||(m["!margins"].right=+T.Right),isNaN(+T.Bottom)||(m["!margins"].bottom=+T.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ye=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ye=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ye=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ye=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ye=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ye=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ye=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ye=!1}break;case"smarttags":break;default:ye=!1;break}if(ye||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Kee(D,ne,B,n.slice(W,l.index)):(B=l,W=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=h),_e.SheetNames=f,_e.Workbook=I,_e.SSF=Qt(Xe),_e.Props=F,_e.Custprops=D,_e}function Hw(e,t){switch(nC(t=t||{}),t.type||"base64"){case"base64":return by(Ga(e),t);case"binary":case"buffer":case"file":return by(e,t);case"array":return by(Wl(e),t)}}function Zee(e,t){var r=[];return e.Props&&r.push(wG(e.Props,t)),e.Custprops&&r.push(kG(e.Props,e.Custprops)),r.join("")}function ete(){return""}function tte(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Ee("NumberFormat",null,{"ss:Format":Rt(Xe[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ee("Style",s.join(""),o))}),Ee("Styles",r.join(""))}function BM(e){return Ee("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Qk(e.Ref,{r:0,c:0})})}function rte(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(BM(i)))}return Ee("Names",r.join(""))}function nte(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(BM(l)))}return s.join("")}function ate(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ee("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ee("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ee("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ee("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(hn("ProtectContents","True")),e["!protect"].objects&&i.push(hn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(hn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(hn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(hn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ee("WorksheetOptions",i.join(""),{xmlns:za.x})}function ite(e){return e.map(function(t){var r=SW(t.t||""),n=Ee("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ee("Comment",n,{"ss:Author":t.a})}).join("")}function ste(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Rt(Qk(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=ar(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Rt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Rt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],h=0;h!=u.length;++h)u[h].s.c!=o.c||u[h].s.r!=o.r||(u[h].e.c>u[h].s.c&&(l["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(l["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=Eo[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Xe[14]);break;case"s":f="String",m=CW(e.v||"");break}var v=ql(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+v),l["ss:Index"]=o.c+1;var g=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(x+=ite(e.c)),Ee("Cell",x,l)}function ote(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function lte(e,t,r,n){if(!e["!ref"])return"";var i=wt(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(_,b){Nl(_);var y=!!_.width,j=pv(b,_),k={"ss:Index":b+1};y&&(k["ss:Width"]=H0(j.width)),_.hidden&&(k["ss:Hidden"]="1"),l.push(Ee("Column",null,k))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var h=[ote(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var m=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(m=!0);break}if(!m){var v={r:u,c:f},g=Ye(v),x=c?(e[u]||[])[f]:e[g];h.push(ste(x,g,e,t,r,n,v))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function cte(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?nte(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?lte(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(ate(s,t,e,r)),n.join("")}function dte(e,t){t||(t={}),e.SSF||(e.SSF=Qt(Xe)),e.SSF&&(sh(),ov(e.SSF),t.revssf=cv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Zee(e,t)),r.push(ete()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ee("Worksheet",cte(n,t,e),{"ss:Name":Rt(e.SheetNames[n])}));return r[2]=tte(e,t),r[3]=rte(e),wr+Ee("Workbook",r.join(""),{xmlns:za.ss,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:ss":za.ss,"xmlns:dt":za.dt,"xmlns:html":za.html})}function ute(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=rG(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=nG(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var hte=[60,1084,2066,2165,2175];function fte(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=uo(r,r.l),u=Ww[c],h=0;u!=null&&hte.indexOf(c)>-1;)s=uo(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),l=r.slice(h,r.l+4+s),o.push(l),r.l+=4+s,u=Ww[c=uo(r,r.l)];var f=Zr(o);un(f,0);var m=0;f.lens=[];for(var v=0;v<o.length;++v)f.lens.push(m),m+=o[v].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function ps(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Xe[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Eo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=z0(e.v):e.w=sd(e.v):e.w=Fi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ih(Xe[n]||String(n))){var i=Fc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Mm(e,t,r){return{v:e,ixfe:t,t:r}}function pte(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",h={},f,m="",v,g,x,_,b={},y=[],j,k,E=[],A=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},M=function(nt){return nt<8?Gc[nt]:nt<64&&A[nt-8]||Gc[nt]},F=function(nt,Jt,Vn){var lr=Jt.XF.data;if(!(!lr||!lr.patternType||!Vn||!Vn.cellStyles)){Jt.s={},Jt.s.patternType=lr.patternType;var os;(os=V0(M(lr.icvFore)))&&(Jt.s.fgColor={rgb:os}),(os=V0(M(lr.icvBack)))&&(Jt.s.bgColor={rgb:os})}},D=function(nt,Jt,Vn){if(!(he>1)&&!(Vn.sheetRows&&nt.r>=Vn.sheetRows)){if(Vn.cellStyles&&Jt.XF&&Jt.XF.data&&F(nt,Jt,Vn),delete Jt.ixfe,delete Jt.XF,f=nt,m=Ye(nt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<o.s.r&&(o.s.r=nt.r),nt.c<o.s.c&&(o.s.c=nt.c),nt.r+1>o.e.r&&(o.e.r=nt.r+1),nt.c+1>o.e.c&&(o.e.c=nt.c+1),Vn.cellFormula&&Jt.f){for(var lr=0;lr<y.length;++lr)if(!(y[lr][0].s.c>nt.c||y[lr][0].s.r>nt.r)&&!(y[lr][0].e.c<nt.c||y[lr][0].e.r<nt.r)){Jt.F=rt(y[lr][0]),(y[lr][0].s.c!=nt.c||y[lr][0].s.r!=nt.r)&&delete Jt.f,Jt.f&&(Jt.f=""+$n(y[lr][1],o,nt,z,W));break}}Vn.dense?(i[nt.r]||(i[nt.r]=[]),i[nt.r][nt.c]=Jt):i[m]=Jt}},W={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(W.password=t.password);var B,G=[],Y=[],ae=[],U=[],q=!1,z=[];z.SheetNames=W.snames,z.sharedf=W.sharedf,z.arrayf=W.arrayf,z.names=[],z.XTI=[];var ie=0,he=0,O=0,R=[],I=[],K;W.codepage=1200,Qi(1200);for(var ne=!1;e.l<e.length-1;){var ee=e.l,ge=e.read_shift(2);if(ge===0&&ie===10)break;var L=e.l===e.length?0:e.read_shift(2),se=Ww[ge];if(se&&se.f){if(t.bookSheets&&ie===133&&ge!==133)break;if(ie=ge,se.r===2||se.r==12){var ke=e.read_shift(2);if(L-=2,!W.enc&&ke!==ge&&((ke&255)<<8|ke>>8)!==ge)throw new Error("rt mismatch: "+ke+"!="+ge);se.r==12&&(e.l+=10,L-=10)}var V={};if(ge===10?V=se.f(e,L,W):V=fte(ge,se,e,L,W),he==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(ge){case 34:r.opts.Date1904=w.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=V;break;case 66:var Ve=Number(V);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}Qi(W.codepage=Ve),ne=!0;break;case 317:W.rrtabid=V;break;case 25:W.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:W.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(i["!type"]="dialog"),V.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),V.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:E.push(V);break;case 430:z.push([V]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(V);break;case 24:case 536:K={Name:V.Name,Ref:$n(V.rgce,o,null,z,W)},V.itab>0&&(K.Sheet=V.itab-1),z.names.push(K),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(I[V.itab-1]={ref:rt(V.rgce[0][0][1][2])});break;case 22:W.ExternCount=V;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(V),z.XTI=z.XTI.concat(V);break;case 2196:if(W.biff<8)break;K!=null&&(K.Comment=V[1]);break;case 18:i["!protect"]=V;break;case 19:V!==0&&W.WTF&&console.error("Password verifier: "+V);break;case 133:s[V.pos]=V,W.snames.push(V.name);break;case 10:{if(--he)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=rt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ke=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=rt(o),o.e.r=Ke}o.e.r++,o.e.c++}G.length>0&&(i["!merges"]=G),Y.length>0&&(i["!objects"]=Y),ae.length>0&&(i["!cols"]=ae),U.length>0&&(i["!rows"]=U),w.Sheets.push(P)}u===""?h=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),W.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(W.biff=5,ne=!0,Qi(W.codepage=28591)),W.biff==8&&V.BIFFVer==0&&V.dt==16&&(W.biff=2),he++)break;if(i=t.dense?[]:{},W.biff<8&&!ne&&(ne=!0,Qi(W.codepage=t.codepage||1252)),W.biff<5||V.BIFFVer==0&&V.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ye={pos:e.l-L,name:u};s[ye.pos]=ye,W.snames.push(u)}else u=(s[ee]||{name:""}).name;V.dt==32&&(i["!type"]="chart"),V.dt==64&&(i["!type"]="macro"),G=[],Y=[],W.arrayf=y=[],ae=[],U=[],q=!1,P={Hidden:(s[ee]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[V.r]||[])[V.c]:i[Ye({c:V.c,r:V.r})])&&++V.c,j={ixfe:V.ixfe,XF:E[V.ixfe]||{},v:V.val,t:"n"},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 5:case 517:j={ixfe:V.ixfe,XF:E[V.ixfe],v:V.val,t:V.t},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 638:j={ixfe:V.ixfe,XF:E[V.ixfe],v:V.rknum,t:"n"},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 189:for(var T=V.c;T<=V.C;++T){var _e=V.rkrec[T-V.c][0];j={ixfe:_e,XF:E[_e],v:V.rkrec[T-V.c][1],t:"n"},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:T,r:V.r},j,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){l=V;break}if(j=Mm(V.val,V.cell.ixfe,V.tt),j.XF=E[j.ixfe],t.cellFormula){var St=V.formula;if(St&&St[0]&&St[0][0]&&St[0][0][0]=="PtgExp"){var Hr=St[0][0][1][0],xn=St[0][0][1][1],Un=Ye({r:Hr,c:xn});b[Un]?j.f=""+$n(V.formula,o,V.cell,z,W):j.F=((t.dense?(i[Hr]||[])[xn]:i[Un])||{}).F}else j.f=""+$n(V.formula,o,V.cell,z,W)}O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D(V.cell,j,t),l=V}break;case 7:case 519:if(l)l.val=V,j=Mm(V,l.cell.ixfe,"s"),j.XF=E[j.ixfe],t.cellFormula&&(j.f=""+$n(l.formula,o,l.cell,z,W)),O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D(l.cell,j,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(V);var Mi=Ye(V[0].s);if(v=t.dense?(i[V[0].s.r]||[])[V[0].s.c]:i[Mi],t.cellFormula&&v){if(!l||!Mi||!v)break;v.f=""+$n(V[1],o,V[0],z,W),v.F=rt(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!l)break;b[Ye(l.cell)]=V[0],v=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Ye(l.cell)],(v||{}).f=""+$n(V[0],o,f,z,W)}}break;case 253:j=Mm(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(j.h=c[V.isst].h),j.XF=E[j.ixfe],O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 513:t.sheetStubs&&(j={ixfe:V.ixfe,XF:E[V.ixfe],t:"z"},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t));break;case 190:if(t.sheetStubs)for(var la=V.c;la<=V.C;++la){var re=V.ixfe[la-V.c];j={ixfe:re,XF:E[re],t:"z"},O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:la,r:V.r},j,t)}break;case 214:case 516:case 4:j=Mm(V.val,V.ixfe,"s"),j.XF=E[j.ixfe],O>0&&(j.z=R[j.ixfe>>8&63]),ps(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 0:case 512:he===1&&(o=V);break;case 252:c=V;break;case 1054:if(W.biff==4){R[O++]=V[1];for(var De=0;De<O+163&&Xe[De]!=V[1];++De);De>=163&&xo(V[1],O+163)}else xo(V[1],V[0]);break;case 30:{R[O++]=V;for(var Wr=0;Wr<O+163&&Xe[Wr]!=V;++Wr);Wr>=163&&xo(V,O+163)}break;case 229:G=G.concat(V);break;case 93:Y[V.cmo[0]]=W.lastobj=V;break;case 438:W.lastobj.TxO=V;break;case 127:W.lastobj.ImData=V;break;case 440:for(_=V[0].s.r;_<=V[0].e.r;++_)for(x=V[0].s.c;x<=V[0].e.c;++x)v=t.dense?(i[_]||[])[x]:i[Ye({c:x,r:_})],v&&(v.l=V[1]);break;case 2048:for(_=V[0].s.r;_<=V[0].e.r;++_)for(x=V[0].s.c;x<=V[0].e.c;++x)v=t.dense?(i[_]||[])[x]:i[Ye({c:x,r:_})],v&&v.l&&(v.l.Tooltip=V[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;v=t.dense?(i[V[0].r]||[])[V[0].c]:i[Ye(V[0])];var Oi=Y[V[2]];v||(t.dense?(i[V[0].r]||(i[V[0].r]=[]),v=i[V[0].r][V[0].c]={t:"z"}):v=i[Ye(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),v.c||(v.c=[]),g={a:V[1],t:Oi.TxO.t},v.c.push(g)}break;case 2173:tY(E[V.ixfe],V.ext);break;case 125:{if(!W.cellStyles)break;for(;V.e>=V.s;)ae[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},q||(q=!0,Kk(V.w/256)),Nl(ae[V.e+1])}break;case 520:{var Gr={};V.level!=null&&(U[V.r]=Gr,Gr.level=V.level),V.hidden&&(U[V.r]=Gr,Gr.hidden=!0),V.hpt&&(U[V.r]=Gr,Gr.hpt=V.hpt,Gr.hpx=Xu(V.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Xc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=V;break;case 161:i["!margins"]||Xc(i["!margins"]={}),i["!margins"].header=V.header,i["!margins"].footer=V.footer;break;case 574:V.RTL&&(w.Views[0].RTL=!0);break;case 146:A=V;break;case 2198:B=V;break;case 140:k=V;break;case 442:u?P.CodeName=V||P.name:w.WBProps.CodeName=V||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=L}return r.SheetNames=mr(s).sort(function($a,nt){return Number($a)-Number(nt)}).map(function($a){return s[$a].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&I.forEach(function($a,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=$a}),r.Strings=c,r.SSF=Qt(Xe),W.enc&&(r.Encryption=W.enc),B&&(r.Themes=B),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),z.names.length>0&&(w.Names=z.names),r.Workbook=w,r}var h0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mte(e,t,r){var n=qe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=$E(n,zw,h0.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=qe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=$E(o,Iw,h0.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(L8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function gte(e,t){var r=[],n=[],i=[],s=0,o,l=nE(zw,"n"),c=nE(Iw,"n");if(e.Props)for(o=mr(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=mr(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)q8.indexOf(i[s][0])>-1||I8.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&qe.utils.cfb_add(t,"/SummaryInformation",EE(n,h0.SI,c,Iw)),(r.length||u.length)&&qe.utils.cfb_add(t,"/DocumentSummaryInformation",EE(r,h0.DSI,l,zw,u.length?u:null,h0.UDI))}function UM(e,t){t||(t={}),nC(t),kk(),t.codepage&&wk(t.codepage);var r,n;if(e.FullPaths){if(qe.find(e,"/encryption"))throw new Error("File is password-protected");r=qe.find(e,"!CompObj"),n=qe.find(e,"/Workbook")||qe.find(e,"/Book")}else{switch(t.type){case"base64":e=La(Ga(e));break;case"binary":e=La(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}un(e,0),n={content:e}}var i,s;if(r&&ute(r),t.bookProps&&!t.bookSheets)i={};else{var o=ft?"buffer":"array";if(n&&n.content)i=pte(n.content,t);else if((s=qe.find(e,"PerfectOffice_MAIN"))&&s.content)i=Kc.to_workbook(s.content,(t.type=o,t));else if((s=qe.find(e,"NativeContent_MAIN"))&&s.content)i=Kc.to_workbook(s.content,(t.type=o,t));else throw(s=qe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&qe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=TY(e))}var l={};return e.FullPaths&&mte(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function xte(e,t){var r=t||{},n=qe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return qe.utils.cfb_add(n,i,VM(e,r)),r.biff==8&&(e.Props||e.Custprops)&&gte(e,n),r.biff==8&&e.vbaraw&&AY(n,qe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var q0={0:{f:BJ},1:{f:XJ},2:{f:pZ},3:{f:nZ},4:{f:ZJ},5:{f:uZ},6:{f:_Z},7:{f:oZ},8:{f:SZ},9:{f:CZ},10:{f:wZ},11:{f:kZ},12:{f:QJ},13:{f:gZ},14:{f:iZ},15:{f:tZ},16:{f:MM},17:{f:bZ},18:{f:cZ},19:{f:zk},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bee},40:{},42:{},43:{f:_X},44:{f:xX},45:{f:jX},46:{f:kX},47:{f:wX},48:{},49:{f:HW},50:{},51:{f:aY},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aM},62:{f:vZ},63:{f:fY},64:{f:UZ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:In,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zZ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qJ},148:{f:HJ,p:16},151:{f:DZ},152:{},153:{f:vee},154:{},155:{},156:{f:gee},157:{},158:{},159:{T:1,f:MK},160:{T:-1},161:{T:1,f:bd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$Z},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:rY},336:{T:-1},337:{f:oY,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Nw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nM},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:PZ},427:{f:MZ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:RZ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:AZ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Nw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:kY},633:{T:1},634:{T:-1},635:{T:1,f:jY},636:{T:-1},637:{f:KW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iee},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:VZ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ww={6:{f:_y},10:{f:Vo},12:{f:Ar},13:{f:Ar},14:{f:vr},15:{f:vr},16:{f:Dn},17:{f:vr},18:{f:vr},19:{f:Ar},20:{f:ME},21:{f:ME},23:{f:nM},24:{f:RE},25:{f:vr},26:{},27:{},28:{f:Vq},29:{},34:{f:vr},35:{f:OE},38:{f:Dn},39:{f:Dn},40:{f:Dn},41:{f:Dn},42:{f:vr},43:{f:vr},47:{f:tX},49:{f:gq},51:{f:Ar},60:{},61:{f:uq},64:{f:vr},65:{f:mq},66:{f:Ar},77:{},80:{},81:{},82:{},85:{f:Ar},89:{},90:{},91:{},92:{f:eq},93:{f:Gq},94:{},95:{f:vr},96:{},97:{},99:{f:vr},125:{f:aM},128:{f:Fq},129:{f:rq},130:{f:Ar},131:{f:vr},132:{f:vr},133:{f:nq},134:{},140:{f:eK},141:{f:Ar},144:{},146:{f:nK},151:{},152:{},153:{},154:{},155:{},156:{f:Ar},157:{},158:{},160:{f:dK},161:{f:sK},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$q},190:{f:Eq},193:{f:Vo},197:{},198:{},199:{},200:{},201:{},202:{f:vr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ar},220:{},221:{f:vr},222:{},224:{f:Aq},225:{f:ZG},226:{f:Vo},227:{},229:{f:Hq},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:iq},253:{f:vq},255:{f:oq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:K8},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vr},353:{f:Vo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Rq},431:{f:vr},432:{},433:{},434:{},437:{},438:{f:Xq},439:{f:vr},440:{f:Yq},441:{},442:{f:jp},443:{},444:{f:Ar},445:{},446:{},448:{f:Vo},449:{f:dq,r:2},450:{f:Vo},512:{f:FE},513:{f:cK},515:{f:Mq},516:{f:yq},517:{f:PE},519:{f:uK},520:{f:lq},523:{},545:{f:NE},549:{f:AE},566:{},574:{f:fq},638:{f:Sq},659:{},1048:{},1054:{f:jq},1084:{},1212:{f:Lq},2048:{f:Jq},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:aK,r:12},2173:{f:eY,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Iq,r:12},2197:{},2198:{f:KX,r:12},2199:{},2200:{},2201:{},2202:{f:Bq,r:12},2203:{f:Vo},2204:{},2205:{},2206:{},2207:{},2211:{f:cq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ar},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oK},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:FE},1:{},2:{f:gK},3:{f:pK},4:{f:fK},5:{f:PE},7:{f:vK},8:{},9:{f:Fm},11:{},22:{f:Ar},30:{f:kq},31:{},32:{},33:{f:NE},36:{},37:{f:AE},50:{f:_K},62:{},52:{},67:{},68:{f:Ar},69:{},86:{},126:{},127:{f:hK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yK},223:{},234:{},354:{},421:{},518:{f:_y},521:{f:Fm},536:{f:RE},547:{f:OE},561:{},579:{},1030:{f:_y},1033:{f:Fm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Te(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Ok(r)&&e.push(r)}}function vte(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Te(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(h=e.next(4),h.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Sp(e,t,r){return e||(e=xe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function _te(e,t,r,n){var i=xe(9);return Sp(i,e,t),X8(r,n||"b",i),i}function yte(e,t,r){var n=xe(8+2*r.length);return Sp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function bte(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Vr(Yt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Te(e,2,xK(r,n,i)):Te(e,3,mK(r,n,i));return;case"b":case"e":Te(e,5,_te(r,n,t.v,t.t));return;case"s":case"str":Te(e,4,yte(r,n,(t.v||"").slice(0,255)));return}Te(e,1,Sp(null,r,n))}function jte(e,t,r,n){var i=Array.isArray(t),s=wt(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=rt(s)}for(var u=s.s.r;u<=s.e.r;++u){l=jr(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(c[h]=nr(h)),o=c[h]+l;var f=i?(t[u]||[])[h]:t[o];f&&bte(e,f,u,h)}}}function wte(e,t){for(var r=t||{},n=Ca(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Te(n,r.biff==4?1033:r.biff==3?521:9,Wk(e,16,r)),jte(n,e.Sheets[e.SheetNames[i]],i,r),Te(n,10),n.end()}function kte(e,t,r){Te(e,49,xq({sz:12,name:"Arial"},r))}function Cte(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Te(e,1054,wq(i,t[i],r))})}function Ste(e,t){var r=xe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Te(e,2151,r),r=xe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),eM(wt(t["!ref"]||"A1"),r),r.write_shift(4,4),Te(e,2152,r)}function $te(e,t){for(var r=0;r<16;++r)Te(e,224,DE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Te(e,224,DE(n,0,t))})}function Ete(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Te(e,440,Qq(n)),n[1].Tooltip&&Te(e,2048,Zq(n))}delete t["!links"]}function Tte(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Te(e,125,iK(pv(i,n),i))})}}function Ate(e,t,r,n,i){var s=16+ql(i.cellXfs,t,i);if(t.v==null&&!t.bf){Te(e,513,dd(r,n,s));return}if(t.bf)Te(e,6,rJ(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Vr(Yt(t.v)):t.v;Te(e,515,Oq(r,n,o,s));break;case"b":case"e":Te(e,517,Pq(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=Zk(i.Strings,t.v,i.revStrings);Te(e,253,_q(r,n,l,s))}else Te(e,516,bq(r,n,(t.v||"").slice(0,255),s,i));break;default:Te(e,513,dd(r,n,s))}}function Fte(e,t,r){var n=Ca(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,h,f="",m=[],v=wt(s["!ref"]||"A1"),g=u?65536:16384;if(v.e.c>255||v.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,g-1)}Te(n,2057,Wk(r,16,t)),Te(n,13,_i(1)),Te(n,12,_i(100)),Te(n,15,Qn(!0)),Te(n,17,Qn(!1)),Te(n,16,ld(.001)),Te(n,95,Qn(!0)),Te(n,42,Qn(!1)),Te(n,43,Qn(!1)),Te(n,130,_i(1)),Te(n,128,Dq()),Te(n,131,Qn(!1)),Te(n,132,Qn(!1)),u&&Tte(n,s["!cols"]),Te(n,512,Cq(v,t)),u&&(s["!links"]=[]);for(var x=v.s.r;x<=v.e.r;++x){f=jr(x);for(var _=v.s.c;_<=v.e.c;++_){x===v.s.r&&(m[_]=nr(_)),h=m[_]+f;var b=c?(s[x]||[])[_]:s[h];b&&(Ate(n,b,x,_,t),u&&b.l&&s["!links"].push([h,b.l]))}}var y=l.CodeName||l.name||i;return u&&Te(n,574,pq((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Te(n,229,Wq(s["!merges"])),u&&Ete(n,s),Te(n,442,Y8(y)),u&&Ste(n,s),Te(n,10),n.end()}function Dte(e,t,r){var n=Ca(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(Te(n,2057,Wk(e,5,r)),r.bookType=="xla"&&Te(n,135),Te(n,225,l?_i(1200):null),Te(n,193,PG(2)),c&&Te(n,191),c&&Te(n,192),Te(n,226),Te(n,92,tq("SheetJS",r)),Te(n,66,_i(l?1200:1252)),l&&Te(n,353,_i(0)),l&&Te(n,448),Te(n,317,lK(e.SheetNames.length)),l&&e.vbaraw&&Te(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Te(n,442,Y8(u))}Te(n,156,_i(17)),Te(n,25,Qn(!1)),Te(n,18,Qn(!1)),Te(n,19,_i(0)),l&&Te(n,431,Qn(!1)),l&&Te(n,444,_i(0)),Te(n,61,hq()),Te(n,64,Qn(!1)),Te(n,141,_i(0)),Te(n,34,Qn(dee(e)=="true")),Te(n,14,Qn(!0)),l&&Te(n,439,Qn(!1)),Te(n,218,_i(0)),kte(n,e,r),Cte(n,e.SSF,r),$te(n,r),l&&Te(n,352,Qn(!1));var h=n.end(),f=Ca();l&&Te(f,140,tK()),l&&r.Strings&&vte(f,252,sq(r.Strings)),Te(f,10);var m=f.end(),v=Ca(),g=0,x=0;for(x=0;x<e.SheetNames.length;++x)g+=(l?12:11)+(l?2:1)*e.SheetNames[x].length;var _=h.length+g+m.length;for(x=0;x<e.SheetNames.length;++x){var b=s[x]||{};Te(v,133,aq({pos:_,hs:b.Hidden||0,dt:0,name:e.SheetNames[x]},r)),_+=t[x].length}var y=v.end();if(g!=y.length)throw new Error("BS8 "+g+" != "+y.length);var j=[];return h.length&&j.push(h),y.length&&j.push(y),m.length&&j.push(m),Zr(j)}function Pte(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Qt(Xe)),e&&e.SSF&&(sh(),ov(e.SSF),r.revssf=cv(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,aC(r),r.cellXfs=[],ql(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Fte(i,r,e);return n.unshift(Dte(e,n,r)),Zr(n)}function VM(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Sa(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Pte(e,t);case 4:case 3:case 2:return wte(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function qE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=xW(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,f=0,m=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var x=c[o].trim(),_=x.slice(0,3).toLowerCase();if(_=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var b=x.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var y=b[l].trim();if(y.match(/<t[dh]/i)){for(var j=y,k=0;j.charAt(0)=="<"&&(k=j.indexOf(">"))>-1;)j=j.slice(k+1);for(var E=0;E<g.length;++E){var A=g[E];A.s.c==h&&A.s.r<u&&u<=A.e.r&&(h=A.e.c+1,E=-1)}var w=Qe(y.slice(0,y.indexOf(">")));m=w.colspan?+w.colspan:1,((f=+w.rowspan)>1||m>1)&&g.push({s:{r:u,c:h},e:{r:u+(f||1)-1,c:h+m-1}});var P=w.t||w["data-t"]||"";if(!j.length){h+=m;continue}if(j=f8(j),v.s.r>u&&(v.s.r=u),v.e.r<u&&(v.e.r=u),v.s.c>h&&(v.s.c=h),v.e.c<h&&(v.e.c=h),!j.length){h+=m;continue}var M={t:"s",v:j};r.raw||!j.trim().length||P=="s"||(j==="TRUE"?M={t:"b",v:!0}:j==="FALSE"?M={t:"b",v:!1}:isNaN(rs(j))?isNaN(qu(j).getDate())||(M={t:"d",v:Yt(j)},r.cellDates||(M={t:"n",v:Vr(M.v)}),M.z=r.dateNF||Xe[14]):M={t:"n",v:rs(j)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=M):n[Ye({r:u,c:h})]=M,h+=m}}}}return n["!ref"]=rt(v),g.length&&(n["!merges"]=g),n}function Mte(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var h=Ye({r,c:o}),f=n.dense?(e[r]||[])[o]:e[h],m=f&&f.v!=null&&(f.h||Dk(f.w||(ko(f),f.w)||""))||"",v={};l>1&&(v.rowspan=l),c>1&&(v.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(v["data-t"]=f&&f.t||"z",f.v!=null&&(v["data-v"]=f.v),f.z!=null&&(v["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+h,s.push(Ee("td",m,v))}}var g="<tr>";return g+s.join("")+"</tr>"}var Ote='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Rte="</body></html>";function Nte(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Gl(qE(r[0],t),t);var n=oC();return r.forEach(function(i,s){lC(n,qE(i,t),"Sheet"+(s+1))}),n}function zte(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HM(e,t){var r=t||{},n=r.header!=null?r.header:Ote,i=r.footer!=null?r.footer:Rte,s=[n],o=Sa(e["!ref"]);r.dense=Array.isArray(e),s.push(zte(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(Mte(e,o,l,r));return s.push("</table>"+i),s.join("")}function WM(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?ar(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var h=Sa(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],m=0,v=e["!rows"]||(e["!rows"]=[]),g=0,x=0,_=0,b=0,y=0,j=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&x<c;++g){var k=l[g];if(KE(k)){if(n.display)continue;v[x]={hidden:!0}}var E=k.children;for(_=b=0;_<E.length;++_){var A=E[_];if(!(n.display&&KE(A))){var w=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):f8(A.innerHTML),P=A.getAttribute("data-z")||A.getAttribute("z");for(m=0;m<f.length;++m){var M=f[m];M.s.c==b+s&&M.s.r<x+i&&x+i<=M.e.r&&(b=M.e.c+1-s,m=-1)}j=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||j>1)&&f.push({s:{r:x+i,c:b+s},e:{r:x+i+(y||1)-1,c:b+s+(j||1)-1}});var F={t:"s",v:w},D=A.getAttribute("data-t")||A.getAttribute("t")||"";w!=null&&(w.length==0?F.t=D||"z":n.raw||w.trim().length==0||D=="s"||(w==="TRUE"?F={t:"b",v:!0}:w==="FALSE"?F={t:"b",v:!1}:isNaN(rs(w))?isNaN(qu(w).getDate())||(F={t:"d",v:Yt(w)},n.cellDates||(F={t:"n",v:Vr(F.v)}),F.z=n.dateNF||Xe[14]):F={t:"n",v:rs(w)})),F.z===void 0&&P!=null&&(F.z=P);var W="",B=A.getElementsByTagName("A");if(B&&B.length)for(var G=0;G<B.length&&!(B[G].hasAttribute("href")&&(W=B[G].getAttribute("href"),W.charAt(0)!="#"));++G);W&&W.charAt(0)!="#"&&(F.l={Target:W}),n.dense?(e[x+i]||(e[x+i]=[]),e[x+i][b+s]=F):e[Ye({c:b+s,r:x+i})]=F,u.e.c<b+s&&(u.e.c=b+s),b+=j}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+i),e["!ref"]=rt(u),x>=c&&(e["!fullref"]=rt((u.e.r=l.length-g+x-1+i,u))),e}function GM(e,t){var r=t||{},n=r.dense?[]:{};return WM(n,e,t)}function Ite(e,t){return Gl(GM(e,t),t)}function KE(e){var t="",r=Lte(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Lte(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Bte(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(t.replace(/<[^>]*>/g,""));return[r]}var XE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qM(e,t){var r=t||{},n=Pk(e),i=[],s,o,l={name:""},c="",u=0,h,f,m={},v=[],g=r.dense?[]:{},x,_,b={value:""},y="",j=0,k=[],E=-1,A=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,M={},F=[],D={},W=0,B=0,G=[],Y=1,ae=1,U=[],q={Names:[]},z={},ie=["",""],he=[],O={},R="",I=0,K=!1,ne=!1,ee=0;for(B0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=B0.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?g["!ref"]=rt(w):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(g["!fullref"]=g["!ref"],w.e.r=r.sheetRows-1,g["!ref"]=rt(w)),F.length&&(g["!merges"]=F),G.length&&(g["!rows"]=G),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),v.push(h.name),m[h.name]=g,ne=!1):x[0].charAt(x[0].length-2)!=="/"&&(h=Qe(x[0],!1),E=A=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,g=r.dense?[]:{},F=[],G=[],ne=!0);break;case"table-row-group":x[1]==="/"?--P:++P;break;case"table-row":case"":if(x[1]==="/"){E+=Y,Y=1;break}if(f=Qe(x[0],!1),f.?E=f.-1:E==-1&&(E=0),Y=+f["number-rows-repeated"]||1,Y<10)for(ee=0;ee<Y;++ee)P>0&&(G[E+ee]={level:P});A=-1;break;case"covered-table-cell":x[1]!=="/"&&++A,r.sheetStubs&&(r.dense?(g[E]||(g[E]=[]),g[E][A]={t:"z"}):g[Ye({r:E,c:A})]={t:"z"}),y="",k=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++A,b=Qe(x[0],!1),ae=parseInt(b["number-columns-repeated"]||"1",10),_={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(_.f=HE(jt(b.formula))),(b.||b["value-type"])=="string"&&(_.t="s",_.v=jt(b["string-value"]||""),r.dense?(g[E]||(g[E]=[]),g[E][A]=_):g[Ye({r:E,c:A})]=_),A+=ae-1;else if(x[1]!=="/"){++A,y="",j=0,k=[],ae=1;var ge=Y?E+Y-1:E;if(A>w.e.c&&(w.e.c=A),A<w.s.c&&(w.s.c=A),E<w.s.r&&(w.s.r=E),ge>w.e.r&&(w.e.r=ge),b=Qe(x[0],!1),he=[],O={},_={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=jt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(W=parseInt(b["number-matrix-rows-spanned"],10)||0,B=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:E,c:A},e:{r:E+W-1,c:A+B-1}},_.F=rt(D),U.push([D,_.F])),b.formula)_.f=HE(b.formula);else for(ee=0;ee<U.length;++ee)E>=U[ee][0].s.r&&E<=U[ee][0].e.r&&A>=U[ee][0].s.c&&A<=U[ee][0].e.c&&(_.F=U[ee][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(W=parseInt(b["number-rows-spanned"],10)||0,B=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:E,c:A},e:{r:E+W-1,c:A+B-1}},F.push(D)),b["number-columns-repeated"]&&(ae=parseInt(b["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Kt(b["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(b.value);break;case"percentage":_.t="n",_.v=parseFloat(b.value);break;case"currency":_.t="n",_.v=parseFloat(b.value);break;case"date":_.t="d",_.v=Yt(b["date-value"]),r.cellDates||(_.t="n",_.v=Vr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=pW(b["time-value"])/86400,r.cellDates&&(_.t="d",_.v=dv(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(b.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",b["string-value"]!=null&&(y=jt(b["string-value"]),k=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(K=!1,_.t==="s"&&(_.v=y||"",k.length&&(_.R=k),K=j==0),z.Target&&(_.l=z),he.length>0&&(_.c=he,he=[]),y&&r.cellText!==!1&&(_.w=y),K&&(_.t="z",delete _.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var L=0;L<Y;++L){if(ae=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(g[E+L]||(g[E+L]=[]),g[E+L][A]=L==0?_:Qt(_);--ae>0;)g[E+L][A+ae]=Qt(_);else for(g[Ye({r:E+L,c:A})]=_;--ae>0;)g[Ye({r:E+L,c:A+ae})]=Qt(_);w.e.c<=A&&(w.e.c=A)}ae=parseInt(b["number-columns-repeated"]||"1",10),A+=ae-1,ae=0,_={},y="",k=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;O.t=y,k.length&&(O.R=k),O.a=R,he.push(O)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);R="",I=0,y="",j=0,k=[];break;case"creator":x[1]==="/"?R=n.slice(I,x.index):I=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);y="",j=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(M[l.name]=c,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(c="",l=Qe(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Qe(x[0],!1),c+=XE[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Qe(x[0],!1),c+=XE[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":o=Qe(x[0],!1),ie=yy(o["cell-range-address"]);var se={Name:o.name,Ref:ie[0]+"!"+ie[1]};ne&&(se.Sheet=v.length),q.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!b||!b["string-value"])){var ke=Bte(n.slice(j,x.index));y=(y.length>0?y+`
`:"")+ke[0]}else Qe(x[0],!1),j=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ie=yy(Qe(x[0])["target-range-address"]),m[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(z=Qe(x[0],!1),!z.href)break;z.Target=jt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ie=yy(z.Target.slice(1)),z.Target="#"+ie[0]+"!"+ie[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var V={Sheets:m,SheetNames:v,Workbook:q};return r.bookSheets&&delete V.Sheets,V}function YE(e,t){t=t||{},xi(e,"META-INF/manifest.xml")&&pG(Tr(e,"META-INF/manifest.xml"),t);var r=Ba(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qM(It(r),t);return xi(e,"meta.xml")&&(n.Props=N8(Tr(e,"meta.xml"))),n}function QE(e,t){return qM(e,t)}var Ute=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+L0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return wr+t}}(),JE=function(){var e=function(s){return Rt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Rt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,h=0,f=Sa(s["!ref"]||"A1"),m=s["!merges"]||[],v=0,g=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",_=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=_[u]?' table:style-name="ro'+_[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)c.push(t);for(;h<=f.e.c;++h){var b=!1,y={},j="";for(v=0;v!=m.length;++v)if(!(m[v].s.c>h)&&!(m[v].s.r>u)&&!(m[v].e.c<h)&&!(m[v].e.r<u)){(m[v].s.c!=h||m[v].s.r!=u)&&(b=!0),y["table:number-columns-spanned"]=m[v].e.c-m[v].s.c+1,y["table:number-rows-spanned"]=m[v].e.r-m[v].s.r+1;break}if(b){c.push(r);continue}var k=Ye({r:u,c:h}),E=g?(s[u]||[])[h]:s[k];if(E&&E.f&&(y["table:formula"]=Rt(lJ(E.f)),E.F&&E.F.slice(0,k.length)==k)){var A=Sa(E.F);y["table:number-matrix-columns-spanned"]=A.e.c-A.s.c+1,y["table:number-matrix-rows-spanned"]=A.e.r-A.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":j=E.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=E.v?"true":"false";break;case"n":j=E.w||String(E.v||0),y["office:value-type"]="float",y["office:value"]=E.v||0;break;case"s":case"str":j=E.v==null?"":E.v,y["office:value-type"]="string";break;case"d":j=E.w||Yt(E.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Yt(E.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var w=e(j);if(E.l&&E.l.Target){var P=E.l.Target;P=P.charAt(0)=="#"?"#"+cJ(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),w=Ee("text:a",w,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+Ee("table:table-cell",Ee("text:p",w,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Nl(f),f.ods=l;var m=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=c;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[wr],u=L0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=L0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+h+`>
`),c.push(R8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function KM(e,t){if(t.bookType=="fods")return JE(e,t);var r=Tk(),n="",i=[],s=[];return n="mimetype",at(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",at(r,n,JE(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",at(r,n,Ute(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",at(r,n,wr+R8()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",at(r,n,xG(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",at(r,n,mG(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ud(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Gw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):It(Wl(e))}function Vte(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):La(Fs(e))}function Hte(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Il(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function ZE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Wte(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Gte(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function K0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Dt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function kt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=K0(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=K0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function cn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Dt(n*8+i.type)),i.type==2&&t.push(Dt(i.data.length)),t.push(i.data))})}),Il(t)}function rC(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function mi(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=K0(e,n),s=kt(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:fr(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=kt(l.data),u=fr(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=fr(s[3][0].data)>>>0>0),r.push(o)}return r}function Dd(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Dt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Dt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Dt(o.data.length)}],n[2].push({data:cn(o.meta),type:2})});var s=cn(n);t.push(Dt(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),Il(t)}function qte(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=K0(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Il(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var h=Il(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function gi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(qte(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Il(t)}function Pd(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Dt(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Il(t)}function Kte(e,t,r,n){var i=ud(e),s=i.getUint32(4,!0),o=(n>1?12:8)+ZE(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,h=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=ZE(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Xte(e,t,r){var n=ud(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);i&1&&(c=Wte(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function jy(e,t){var r=new Uint8Array(32),n=ud(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Gte(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function wy(e,t){var r=new Uint8Array(32),n=ud(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Yte(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Kte(e,t,r,e[0]);case 5:return Xte(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Sn(e){var t=kt(e);return K0(t[1][0].data)}function eT(e,t){var r=kt(t.data),n=fr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=kt(o.data),c=fr(l[1][0].data)>>>0;switch(n){case 1:s[c]=Gw(l[3][0].data);break;case 8:{var u=e[Sn(l[9][0].data)][0],h=kt(u.data),f=e[Sn(h[1][0].data)][0],m=fr(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var v=kt(f.data);s[c]=v[3].map(function(g){return Gw(g.data)}).join("")}break}}),s}function Qte(e,t){var r,n,i,s,o,l,c,u,h,f,m,v,g,x,_=kt(e),b=fr(_[1][0].data)>>>0,y=fr(_[2][0].data)>>>0,j=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&fr(_[8][0].data)>0||!1,k,E;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&t!=0)k=(l=(o=_[7])==null?void 0:o[0])==null?void 0:l.data,E=(u=(c=_[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(h=_[4])==null?void 0:h[0])!=null&&f.data&&t!=1)k=(v=(m=_[4])==null?void 0:m[0])==null?void 0:v.data,E=(x=(g=_[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var A=j?4:1,w=ud(k),P=[],M=0;M<k.length/2;++M){var F=w.getUint16(M*2,!0);F<65535&&P.push([M,F])}if(P.length!=y)throw"Expected ".concat(y," cells, found ").concat(P.length);var D=[];for(M=0;M<P.length-1;++M)D[P[M][0]]=E.subarray(P[M][1]*A,P[M+1][1]*A);return P.length>=1&&(D[P[P.length-1][0]]=E.subarray(P[P.length-1][1]*A)),{R:b,cells:D}}function Jte(e,t){var r,n=kt(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?fr(n[7][0].data)>>>0>0?1:0:-1,s=rC(n[5],function(o){return Qte(o,i)});return{nrows:fr(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function Zte(e,t,r){var n,i=kt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(fr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(fr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=rt(s);var o=kt(i[4][0].data),l=eT(e,e[Sn(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?eT(e,e[Sn(o[17][0].data)][0]):[],u=kt(o[3][0].data),h=0;u[1].forEach(function(f){var m=kt(f.data),v=e[Sn(m[2][0].data)][0],g=fr(v.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var x=Jte(e,v);x.data.forEach(function(_,b){_.forEach(function(y,j){var k=Ye({r:h+b,c:j}),E=Yte(y,l,c);E&&(r[k]=E)})}),h+=x.nrows})}function ere(e,t){var r=kt(t.data),n={"!ref":"A1"},i=e[Sn(r[2][0].data)],s=fr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Zte(e,i[0],n),n}function tre(e,t){var r,n=kt(t.data),i={name:(r=n[1])!=null&&r[0]?Gw(n[1][0].data):"",sheets:[]},s=rC(n[2],Sn);return s.forEach(function(o){e[o].forEach(function(l){var c=fr(l.meta[1][0].data);c==6e3&&i.sheets.push(ere(e,l))})}),i}function rre(e,t){var r=oC(),n=kt(t.data),i=rC(n[1],Sn);if(i.forEach(function(s){e[s].forEach(function(o){var l=fr(o.meta[1][0].data);if(l==2){var c=tre(e,o);c.sheets.forEach(function(u,h){lC(r,u,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ky(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=gi(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=mi(u)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&fr(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var h=fr(u.meta[1][0].data)>>>0;if(h==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return rre(s,l)}function nre(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&fr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=ud(e[7][0].data),h=0,f=[],m=ud(e[4][0].data),v=0,g=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),m.setUint16(x*2,v,!0);var _,b;switch(typeof t[x]){case"string":_=jy({t:"s",v:t[x]},r),b=wy({t:"s",v:t[x]},r);break;case"number":_=jy({t:"n",v:t[x]},r),b=wy({t:"n",v:t[x]},r);break;case"boolean":_=jy({t:"b",v:t[x]},r),b=wy({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(_),h+=_.length,g.push(b),v+=b.length,++c}for(e[2][0].data=Dt(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=Il(f),e[3][0].data=Il(g),c}function are(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Sa(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var s=w1(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(R){return R.forEach(function(I){typeof I=="string"&&o.push(I)})});var l={},c=[],u=qe.read(t.numbers,{type:"base64"});u.FileIndex.map(function(R,I){return[R,u.FullPaths[I]]}).forEach(function(R){var I=R[0],K=R[1];if(I.type==2&&I.name.match(/\.iwa/)){var ne=I.content,ee=gi(ne),ge=mi(ee);ge.forEach(function(L){c.push(L.id),l[L.id]={deps:[],location:K,type:fr(L.messages[0].meta[1][0].data)}})}}),c.sort(function(R,I){return R-I});var h=c.filter(function(R){return R>1}).map(function(R){return[R,Dt(R)]});u.FileIndex.map(function(R,I){return[R,u.FullPaths[I]]}).forEach(function(R){var I=R[0];if(R[1],!!I.name.match(/\.iwa/)){var K=mi(gi(I.content));K.forEach(function(ne){ne.messages.forEach(function(ee){h.forEach(function(ge){ne.messages.some(function(L){return fr(L.meta[1][0].data)!=11006&&Hte(L.data,ge[1])})&&l[ge[0]].deps.push(ne.id)})})})}});for(var f=qe.find(u,l[1].location),m=mi(gi(f.content)),v,g=0;g<m.length;++g){var x=m[g];x.id==1&&(v=x)}var _=Sn(kt(v.messages[0].data)[1][0].data);for(f=qe.find(u,l[_].location),m=mi(gi(f.content)),g=0;g<m.length;++g)x=m[g],x.id==_&&(v=x);for(_=Sn(kt(v.messages[0].data)[2][0].data),f=qe.find(u,l[_].location),m=mi(gi(f.content)),g=0;g<m.length;++g)x=m[g],x.id==_&&(v=x);for(_=Sn(kt(v.messages[0].data)[2][0].data),f=qe.find(u,l[_].location),m=mi(gi(f.content)),g=0;g<m.length;++g)x=m[g],x.id==_&&(v=x);var b=kt(v.messages[0].data);{b[6][0].data=Dt(n.e.r+1),b[7][0].data=Dt(n.e.c+1);var y=Sn(b[46][0].data),j=qe.find(u,l[y].location),k=mi(gi(j.content));{for(var E=0;E<k.length&&k[E].id!=y;++E);if(k[E].id!=y)throw"Bad ColumnRowUIDMapArchive";var A=kt(k[E].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var w=0;w<=n.e.c;++w){var P=[];P[1]=P[2]=[{type:0,data:Dt(w+420690)}],A[1].push({type:2,data:cn(P)}),A[2].push({type:0,data:Dt(w)}),A[3].push({type:0,data:Dt(w)})}A[4]=[],A[5]=[],A[6]=[];for(var M=0;M<=n.e.r;++M)P=[],P[1]=P[2]=[{type:0,data:Dt(M+726270)}],A[4].push({type:2,data:cn(P)}),A[5].push({type:0,data:Dt(M)}),A[6].push({type:0,data:Dt(M)});k[E].messages[0].data=cn(A)}j.content=Pd(Dd(k)),j.size=j.content.length,delete b[46];var F=kt(b[4][0].data);{F[7][0].data=Dt(n.e.r+1);var D=kt(F[1][0].data),W=Sn(D[2][0].data);j=qe.find(u,l[W].location),k=mi(gi(j.content));{if(k[0].id!=W)throw"Bad HeaderStorageBucket";var B=kt(k[0].messages[0].data);for(M=0;M<s.length;++M){var G=kt(B[2][0].data);G[1][0].data=Dt(M),G[4][0].data=Dt(s[M].length),B[2][M]={type:B[2][0].type,data:cn(G)}}k[0].messages[0].data=cn(B)}j.content=Pd(Dd(k)),j.size=j.content.length;var Y=Sn(F[2][0].data);j=qe.find(u,l[Y].location),k=mi(gi(j.content));{if(k[0].id!=Y)throw"Bad HeaderStorageBucket";for(B=kt(k[0].messages[0].data),w=0;w<=n.e.c;++w)G=kt(B[2][0].data),G[1][0].data=Dt(w),G[4][0].data=Dt(n.e.r+1),B[2][w]={type:B[2][0].type,data:cn(G)};k[0].messages[0].data=cn(B)}j.content=Pd(Dd(k)),j.size=j.content.length;var ae=Sn(F[4][0].data);(function(){for(var R=qe.find(u,l[ae].location),I=mi(gi(R.content)),K,ne=0;ne<I.length;++ne){var ee=I[ne];ee.id==ae&&(K=ee)}var ge=kt(K.messages[0].data);{ge[3]=[];var L=[];o.forEach(function(V,Ve){L[1]=[{type:0,data:Dt(Ve)}],L[2]=[{type:0,data:Dt(1)}],L[3]=[{type:2,data:Vte(V)}],ge[3].push({type:2,data:cn(L)})})}K.messages[0].data=cn(ge);var se=Dd(I),ke=Pd(se);R.content=ke,R.size=R.content.length})();var U=kt(F[3][0].data);{var q=U[1][0];delete U[2];var z=kt(q.data);{var ie=Sn(z[2][0].data);(function(){for(var R=qe.find(u,l[ie].location),I=mi(gi(R.content)),K,ne=0;ne<I.length;++ne){var ee=I[ne];ee.id==ie&&(K=ee)}var ge=kt(K.messages[0].data);{delete ge[6],delete U[7];var L=new Uint8Array(ge[5][0].data);ge[5]=[];for(var se=0,ke=0;ke<=n.e.r;++ke){var V=kt(L);se+=nre(V,s[ke],o),V[1][0].data=Dt(ke),ge[5].push({data:cn(V),type:2})}ge[1]=[{type:0,data:Dt(n.e.c+1)}],ge[2]=[{type:0,data:Dt(n.e.r+1)}],ge[3]=[{type:0,data:Dt(se)}],ge[4]=[{type:0,data:Dt(n.e.r+1)}]}K.messages[0].data=cn(ge);var Ve=Dd(I),Ke=Pd(Ve);R.content=Ke,R.size=R.content.length})()}q.data=cn(z)}F[3][0].data=cn(U)}b[4][0].data=cn(F)}v.messages[0].data=cn(b);var he=Dd(m),O=Pd(he);return f.content=O,f.size=f.content.length,u}function XM(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function nC(e){XM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function aC(e){XM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ire(e){return pt.WS.indexOf(e)>-1?"sheet":e==pt.CS?"chart":e==pt.DS?"dialog":e==pt.MS?"macro":e&&e.length?e:"sheet"}function sre(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,ire(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ore(e,t,r,n,i,s,o,l,c,u,h,f){try{s[n]=l0(Ba(e,r,!0),t);var m=Tr(e,t),v;switch(l){case"sheet":v=Tee(m,t,i,c,s[n],u,h,f);break;case"chart":if(v=Aee(m,t,i,c,s[n],u,h,f),!v||!v["!drawel"])break;var g=Hf(v["!drawel"].Target,t),x=U0(g),_=gY(Ba(e,g,!0),l0(Ba(e,x,!0),g)),b=Hf(_,g),y=U0(b);v=nee(Ba(e,b,!0),b,c,l0(Ba(e,y,!0),b),u,v);break;case"macro":v=Fee(m,t,i,c,s[n],u,h,f);break;case"dialog":v=Dee(m,t,i,c,s[n],u,h,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=v;var j=[];s&&s[n]&&mr(s[n]).forEach(function(k){var E="";if(s[n][k].Type==pt.CMNT){E=Hf(s[n][k].Target,t);var A=Ree(Tr(e,E,!0),E,c);if(!A||!A.length)return;IE(v,A,!1)}s[n][k].Type==pt.TCMNT&&(E=Hf(s[n][k].Target,t),j=j.concat(vY(Tr(e,E,!0),c)))}),j&&j.length&&IE(v,j,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function oi(e){return e.charAt(0)=="/"?e.slice(1):e}function lre(e,t){if(sh(),t=t||{},nC(t),xi(e,"META-INF/manifest.xml")||xi(e,"objectdata.xml"))return YE(e,t);if(xi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ky<"u"){if(e.FileIndex)return ky(e);var r=qe.utils.cfb_new();return sE(e).forEach(function(G){at(r,G,_W(e,G))}),ky(r)}throw new Error("Unsupported NUMBERS file")}if(!xi(e,"[Content_Types].xml"))throw xi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=sE(e),i=hG(Ba(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",Tr(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!Tr(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(c0=[],i.sst)try{c0=Oee(Tr(e,oi(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(c=Mee(Ba(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=Pee(Tr(e,oi(i.style)),i.style,c,t))}i.links.map(function(G){try{var Y=l0(Ba(e,U0(oi(G))),G);return zee(Tr(e,oi(G)),Y,G,t)}catch{}});var h=Eee(Tr(e,oi(i.workbooks[0])),i.workbooks[0],t),f={},m="";i.coreprops.length&&(m=Tr(e,oi(i.coreprops[0]),!0),m&&(f=N8(m)),i.extprops.length!==0&&(m=Tr(e,oi(i.extprops[0]),!0),m&&_G(m,f,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=Ba(e,oi(i.custprops[0]),!0),m&&(v=bG(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(Y){return Y.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=v),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var x={};t.bookDeps&&i.calcchain&&(x=Nee(Tr(e,oi(i.calcchain)),i.calcchain));var _=0,b={},y,j;{var k=h.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var E=0;E!=k.length;++E)f.SheetNames[E]=k[E].name}var A=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");xi(e,P)||(P="xl/_rels/workbook."+A+".rels");var M=l0(Ba(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Iee(Tr(e,oi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=yY(Tr(e,oi(i.people[0])),t)),M&&(M=sre(M,h.Sheets));var F=Tr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var D="sheet";if(M&&M[_]?(y="xl/"+M[_][1].replace(/[\/]?xl\//,""),xi(e,y)||(y=M[_][1]),xi(e,y)||(y=P.replace(/_rels\/.*$/,"")+M[_][1]),D=M[_][2]):(y="xl/worksheets/sheet"+(_+1-F)+"."+A,y=y.replace(/sheet0\./,"sheet.")),j=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var W=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==_&&(W=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==f.SheetNames[_].toLowerCase()&&(W=1);if(!W)continue e}}ore(e,y,j,f.SheetNames[_],_,b,o,D,t,h,c,u)}return g={Directory:i,Workbook:h,Props:f,Custprops:v,Deps:x,Sheets:o,SheetNames:f.SheetNames,Strings:c0,Styles:u,Themes:c,SSF:Qt(Xe)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(G,Y){G=G.replace(/^Root Entry[\/]/,""),g.keys.push(G),g.files[G]=e.FileIndex[Y]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=Tr(e,oi(i.vba[0]),!0):i.defaults&&i.defaults.bin===EY&&(g.vbaraw=Tr(e,"xl/vbaProject.bin",!0))),g}function cre(e,t){var r=t||{},n="Workbook",i=qe.find(e,n);try{if(n="/!DataSpaces/Version",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(IK(i.content),n="/!DataSpaces/DataSpaceMap",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=BK(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=UK(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);HK(i.content)}catch{}if(n="/EncryptionInfo",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=WK(i.content);if(n="/EncryptedPackage",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function dre(e,t){return t.bookType=="ods"?KM(e,t):t.bookType=="numbers"?are(e,t):t.bookType=="xlsb"?ure(e,t):hre(e,t)}function ure(e,t){su=1024,e&&!e.SSF&&(e.SSF=Qt(Xe)),e&&e.SSF&&(sh(),ov(e.SSF),t.revssf=cv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,d0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=jM.indexOf(t.bookType)>-1,i=Vk();aC(t=t||{});var s=Tk(),o="",l=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",at(s,o,z8(e.Props,t)),i.coreprops.push(o),Pt(t.rels,2,o,pt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,at(s,o,B8(e.Props)),i.extprops.push(o),Pt(t.rels,3,o,pt.EXT_PROPS),e.Custprops!==e.Props&&mr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",at(s,o,U8(e.Custprops)),i.custprops.push(o),Pt(t.rels,4,o,pt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,at(s,o,Bee(l-1,o,t,e,h)),i.sheets.push(o),Pt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,pt.WS[0])}if(f){var v=f["!comments"],g=!1,x="";v&&v.length>0&&(x="xl/comments"+l+"."+r,at(s,x,Hee(v,x)),i.comments.push(x),Pt(h,-1,"../comments"+l+"."+r,pt.CMNT),g=!0),f["!legacy"]&&g&&at(s,"xl/drawings/vmlDrawing"+l+".vml",yM(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&at(s,U0(o),gu(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,at(s,o,Vee(t.Strings,o,t)),i.strs.push(o),Pt(t.wbrels,-1,"sharedStrings."+r,pt.SST)),o="xl/workbook."+r,at(s,o,Lee(e,o)),i.workbooks.push(o),Pt(t.rels,1,o,pt.WB),o="xl/theme/theme1.xml",at(s,o,Xk(e.Themes,t)),i.themes.push(o),Pt(t.wbrels,-1,"theme/theme1.xml",pt.THEME),o="xl/styles."+r,at(s,o,Uee(e,o,t)),i.styles.push(o),Pt(t.wbrels,-1,"styles."+r,pt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",at(s,o,e.vbaraw),i.vba.push(o),Pt(t.wbrels,-1,"vbaProject.bin",pt.VBA)),o="xl/metadata."+r,at(s,o,Wee(o)),i.metadata.push(o),Pt(t.wbrels,-1,"metadata."+r,pt.XLMETA),at(s,"[Content_Types].xml",O8(i,t)),at(s,"_rels/.rels",gu(t.rels)),at(s,"xl/_rels/workbook."+r+".rels",gu(t.wbrels)),delete t.revssf,delete t.ssf,s}function hre(e,t){su=1024,e&&!e.SSF&&(e.SSF=Qt(Xe)),e&&e.SSF&&(sh(),ov(e.SSF),t.revssf=cv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,d0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=jM.indexOf(t.bookType)>-1,i=Vk();aC(t=t||{});var s=Tk(),o="",l=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",at(s,o,z8(e.Props,t)),i.coreprops.push(o),Pt(t.rels,2,o,pt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,at(s,o,B8(e.Props)),i.extprops.push(o),Pt(t.rels,3,o,pt.EXT_PROPS),e.Custprops!==e.Props&&mr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",at(s,o,U8(e.Custprops)),i.custprops.push(o),Pt(t.rels,4,o,pt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,at(s,o,PM(l-1,t,e,f)),i.sheets.push(o),Pt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,pt.WS[0])}if(m){var g=m["!comments"],x=!1,_="";if(g&&g.length>0){var b=!1;g.forEach(function(y){y[1].forEach(function(j){j.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+l+"."+r,at(s,_,_Y(g,h,t)),i.threadedcomments.push(_),Pt(f,-1,"../threadedComments/threadedComment"+l+"."+r,pt.TCMNT)),_="xl/comments"+l+"."+r,at(s,_,bM(g)),i.comments.push(_),Pt(f,-1,"../comments"+l+"."+r,pt.CMNT),x=!0}m["!legacy"]&&x&&at(s,"xl/drawings/vmlDrawing"+l+".vml",yM(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&at(s,U0(o),gu(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,at(s,o,lM(t.Strings,t)),i.strs.push(o),Pt(t.wbrels,-1,"sharedStrings."+r,pt.SST)),o="xl/workbook."+r,at(s,o,zM(e)),i.workbooks.push(o),Pt(t.rels,1,o,pt.WB),o="xl/theme/theme1.xml",at(s,o,Xk(e.Themes,t)),i.themes.push(o),Pt(t.wbrels,-1,"theme/theme1.xml",pt.THEME),o="xl/styles."+r,at(s,o,gM(e,t)),i.styles.push(o),Pt(t.wbrels,-1,"styles."+r,pt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",at(s,o,e.vbaraw),i.vba.push(o),Pt(t.wbrels,-1,"vbaProject.bin",pt.VBA)),o="xl/metadata."+r,at(s,o,_M()),i.metadata.push(o),Pt(t.wbrels,-1,"metadata."+r,pt.XLMETA),h.length>1&&(o="xl/persons/person.xml",at(s,o,bY(h)),i.people.push(o),Pt(t.wbrels,-1,"persons/person.xml",pt.PEOPLE)),at(s,"[Content_Types].xml",O8(i,t)),at(s,"_rels/.rels",gu(t.rels)),at(s,"xl/_rels/workbook."+r+".rels",gu(t.wbrels)),delete t.revssf,delete t.ssf,s}function iC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ga(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fre(e,t){return qe.find(e,"EncryptedPackage")?cre(e,t):UM(e,t)}function pre(e,t){var r,n=e,i=t||{};return i.type||(i.type=ft&&Buffer.isBuffer(e)?"buffer":"base64"),r=d8(n,i),lre(r,i)}function YM(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Hw(e.slice(r),t);default:break e}return Ku.to_workbook(e,t)}function mre(e,t){var r="",n=iC(e,t);switch(t.type){case"base64":r=Ga(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=od(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=It(r)),t.type="binary",YM(r,t)}function gre(e,t){var r=e;return t.type=="base64"&&(r=Ga(r)),r=R0.utils.decode(1200,r.slice(2),"str"),t.type="binary",YM(r,t)}function xre(e){return e.match(/[^\x00-\x7F]/)?Fs(e):e}function Cy(e,t,r,n){return n?(r.type="string",Ku.to_workbook(e,r)):Ku.to_workbook(t,r)}function qw(e,t){kk();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return qw(new Uint8Array(e),(r=Qt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vu={},r.dateNF&&(vu.dateNF=r.dateNF),r.type||(r.type=ft&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ft?"buffer":"binary",n=uW(e),typeof Uint8Array<"u"&&!ft&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=xre(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Qt(r),r.type="array",qw(Ck(n),r)}switch((i=iC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return fre(qe.read(n,r),r);break;case 9:if(i[1]<=8)return UM(n,r);break;case 60:return Hw(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return jK(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return sM.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?pre(n,r):Cy(e,n,r,s);case 239:return i[3]===60?Hw(n,r):Cy(e,n,r,s);case 255:if(i[1]===254)return gre(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Kc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Kc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Vw.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return fM.to_workbook(n,r);break;case 10:case 13:case 32:return mre(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bK.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Vw.to_workbook(n,r):Cy(e,n,r,s)}function QM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return _p(t.file,qe.write(e,{type:ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return qe.write(e,t)}function vre(e,t){var r=Qt(t||{}),n=dre(e,r);return _re(n,r)}function _re(e,t){var r={},n=ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?qe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(sv(i))}return t.password&&typeof encrypt_agile<"u"?QM(encrypt_agile(i,t.password),t):t.type==="file"?_p(t.file,i):t.type=="string"?It(i):i}function yre(e,t){var r=t||{},n=xte(e,r);return QM(n,r)}function bs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return N0(Fs(n));case"binary":return Fs(n);case"string":return e;case"file":return _p(t.file,n,"utf8");case"buffer":return ft?So(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):bs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bre(e,t){switch(t.type){case"base64":return N0(e);case"binary":return e;case"string":return e;case"file":return _p(t.file,e,"binary");case"buffer":return ft?So(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Om(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?N0(r):t.type=="string"?It(r):r;case"file":return _p(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function JM(e,t){kk(),fee(e);var r=Qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=JM(e,r);return r.type="array",sv(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return bs(dte(e,r),r);case"slk":case"sylk":return bs(iM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return bs(HM(e.Sheets[e.SheetNames[i]],r),r);case"txt":return bre(ZM(e.Sheets[e.SheetNames[i]],r),r);case"csv":return bs(sC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return bs(sM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Om(Vw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return bs(Ku.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return bs(fM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return bs(oM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return bs(KM(e,r),r);case"wk1":return Om(Kc.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Om(Kc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Om(VM(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yre(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vre(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function jre(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function wre(e,t,r){var n={};return n.type="file",n.file=t,jre(n),JM(e,n)}function kre(e,t,r,n,i,s,o,l){var c=jr(r),u=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var g=o?e[r][v]:e[n[v]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[v]!=null&&(m[s[v]]=u);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[v]!=null){if(x==null)if(g.t=="e"&&x===null)m[s[v]]=null;else if(u!==void 0)m[s[v]]=u;else if(h&&x===null)m[s[v]]=null;else continue;else m[s[v]]=h&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?x:ko(g,x,l);x!=null&&(f=!1)}}return{row:m,isempty:f}}function w1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":c=wt(h);break;case"number":c=wt(e["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=jr(c.s.r),m=[],v=[],g=0,x=0,_=Array.isArray(e),b=c.s.r,y=0,j={};_&&!e[b]&&(e[b]=[]);var k=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(k[y]||{}).hidden)switch(m[y]=nr(y),r=_?e[b][y]:e[m[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=m[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=ko(r,null,u),x=j[o]||0,!x)j[o]=1;else{do l=o+"_"+x++;while(j[l]);j[o]=x,j[l]=1}s[y]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(E[b]||{}).hidden){var A=kre(e,c,b,m,n,s,_,u);(A.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(v[g++]=A.row)}return v.length=g,v}var tT=/"/g;function Cre(e,t,r,n,i,s,o,l){for(var c=!0,u=[],h="",f=jr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=l.dense?(e[r]||[])[m]:e[n[m]+f];if(v==null)h="";else if(v.v!=null){c=!1,h=""+(l.rawNumbers&&v.t=="n"?v.v:ko(v,null,l));for(var g=0,x=0;g!==h.length;++g)if((x=h.charCodeAt(g))===i||x===s||x===34||l.forceQuotes){h='"'+h.replace(tT,'""')+'"';break}h=="ID"&&(h='"ID"')}else v.f!=null&&!v.F?(c=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(tT,'""')+'"')):h="";u.push(h)}return l.blankrows===!1&&c?null:u.join(o)}function sC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=wt(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(f[g]=nr(g));for(var x=0,_=i.s.r;_<=i.e.r;++_)(v[_]||{}).hidden||(h=Cre(e,i,_,f,o,c,s,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((x++?l:"")+h)));return delete n.dense,r.join("")}function ZM(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=sC(e,t);return r}function Sre(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=wt(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=nr(l);for(var h=i.s.r;h<=i.e.r;++h)for(s=jr(h),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function e6(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?ar(n.origin):n.origin;o=c.r,l=c.c}var u,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=wt(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),o==-1&&(o=f.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var m=n.header||[],v=0;t.forEach(function(x,_){mr(x).forEach(function(b){(v=m.indexOf(b))==-1&&(m[v=m.length]=b);var y=x[b],j="z",k="",E=Ye({c:l+v,r:o+_+i});u=X0(s,E),y&&typeof y=="object"&&!(y instanceof Date)?s[E]=y:(typeof y=="number"?j="n":typeof y=="boolean"?j="b":typeof y=="string"?j="s":y instanceof Date?(j="d",n.cellDates||(j="n",y=Vr(y)),k=n.dateNF||Xe[14]):y===null&&n.nullError&&(j="e",y=0),u?(u.t=j,u.v=y,delete u.w,delete u.R,k&&(u.z=k)):s[E]=u={t:j,v:y},k&&(u.z=k))})}),h.e.c=Math.max(h.e.c,l+m.length-1);var g=jr(o);if(i)for(v=0;v<m.length;++v)s[nr(v+l)+g]={t:"s",v:m[v]};return s["!ref"]=rt(h),s}function $re(e,t){return e6(null,e,t)}function X0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ar(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?X0(e,Ye(t)):X0(e,Ye({r:t,c:r||0}))}function Ere(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function oC(){return{SheetNames:[],Sheets:{}}}function lC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(NM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Tre(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Ere(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Are(e,t){return e.z=t,e}function t6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Fre(e,t,r){return t6(e,"#"+t,r)}function Dre(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Pre(e,t,r,n){for(var i=typeof t!="string"?t:wt(t),s=typeof t=="string"?t:rt(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=X0(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Rm={encode_col:nr,encode_row:jr,encode_cell:Ye,encode_range:rt,decode_col:Nk,decode_row:Rk,split_cell:VW,decode_cell:ar,decode_range:Sa,format_cell:ko,sheet_add_aoa:E8,sheet_add_json:e6,sheet_add_dom:WM,aoa_to_sheet:oh,json_to_sheet:$re,table_to_sheet:GM,table_to_book:Ite,sheet_to_csv:sC,sheet_to_txt:ZM,sheet_to_json:w1,sheet_to_html:HM,sheet_to_formulae:Sre,sheet_to_row_object_array:w1,sheet_get_cell:X0,book_new:oC,book_append_sheet:lC,book_set_sheet_visibility:Tre,cell_set_number_format:Are,cell_set_hyperlink:t6,cell_set_internal_link:Fre,cell_add_comment:Dre,sheet_set_array_formula:Pre,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Mre=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,Ore=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,Rre=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,Nre=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`,zre=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.xl};
`,Sy=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  background: ${({$active:e,$completed:t})=>e?d.colors.primary:t?`${d.colors.success}20`:d.colors.bgLight};
  color: ${({$active:e,$completed:t})=>e?"white":t?d.colors.success:d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,$y=p.span`
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: ${({$active:e})=>e?"white":"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:"inherit"};
  border: 2px solid currentColor;
`,Ey=p.div`
  margin-bottom: ${d.spacing.xl};
`,Ty=p.h3`
  font-size: ${d.typography.sizes.h4};
  color: ${d.colors.textPrimary};
  margin: 0 0 ${d.spacing.md} 0;
`,Ire=p.div`
  border: 2px dashed ${({$isDragging:e,$hasFile:t})=>e?d.colors.primary:t?d.colors.success:d.colors.border};
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  text-align: center;
  background: ${({$isDragging:e})=>e?`${d.colors.primary}05`:"transparent"};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    background: ${d.colors.primary}05;
  }
`,Lre=p.div`
  font-size: 48px;
  margin-bottom: ${d.spacing.md};
`,Bre=p.p`
  color: ${d.colors.textSecondary};
  margin: 0 0 ${d.spacing.sm} 0;
`,Ure=p.span`
  color: ${d.colors.textMuted};
  font-size: ${d.typography.sizes.small};
`,Vre=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.md};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  margin-top: ${d.spacing.md};
`,Hre=p.span`
  flex: 1;
  font-weight: ${d.typography.weights.medium};
`,Wre=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Gre=p.button`
  background: none;
  border: none;
  color: ${d.colors.danger};
  cursor: pointer;
  padding: ${d.spacing.xs};

  &:hover {
    opacity: 0.7;
  }
`,rT=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: ${d.typography.sizes.small};
`,Gh=p.th`
  text-align: left;
  padding: ${d.spacing.sm};
  background: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
`,qh=p.td`
  padding: ${d.spacing.sm};
  border: 1px solid ${d.colors.border};
  background: ${({$error:e})=>e?`${d.colors.danger}10`:"transparent"};
`,qre=p.span`
  color: ${d.colors.danger};
  font-size: ${d.typography.sizes.tiny};
  display: block;
`,nT=p.div`
  max-height: 400px;
  overflow: auto;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
`,aT=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
`,tc=p.div`
  padding: ${d.spacing.md};
  background: ${({$color:e})=>e?`${e}10`:d.colors.bgLight};
  border-radius: ${d.radius.md};
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,rc=p.div`
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  color: ${d.colors.textPrimary};
`,nc=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
`,iT=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,Nm=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,zm=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:e==="error"?`${d.colors.danger}15`:`${d.colors.primary}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:e==="error"?d.colors.danger:d.colors.primary};
`,Kre=p.div`
  width: 100%;
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  margin: ${d.spacing.md} 0;
`,Xre=p.div`
  width: ${({$percent:e})=>e}%;
  height: 100%;
  background: ${d.colors.primary};
  transition: width 0.3s ease;
`,sT=p.a`
  color: ${d.colors.primary};
  text-decoration: none;
  font-size: ${d.typography.sizes.small};
  cursor: pointer;

  &:hover {
    text-decoration: underline;
  }
`,Yre=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  min-width: 250px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Qre=p.div`
  margin-bottom: ${d.spacing.md};
`,Jre=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`;function Zre({tablaKey:e,onNavigate:t}){const[r,n]=S.useState(1),[i,s]=S.useState(e||""),[o,l]=S.useState(null),[c,u]=S.useState([]),[h,f]=S.useState(null),[m,v]=S.useState(!1),[g,x]=S.useState([]),[_,b]=S.useState(!1),[y,j]=S.useState(0),[k,E]=S.useState(null),[A,w]=S.useState(null),P=S.useRef(null);S.useEffect(()=>{(async()=>{try{const I=await to.getTablas();if(u(I),e){const K=I.find(ne=>ne.key===e);K&&l(K)}}catch(I){console.error("Error loading tablas:",I)}})()},[e]);const M=S.useCallback(async R=>{if(s(R),f(null),x([]),R){const I=c.find(K=>K.key===R);I&&l(I)}else l(null)},[c]),F=R=>{R.preventDefault(),v(!0)},D=()=>{v(!1)},W=R=>{R.preventDefault(),v(!1);const I=R.dataTransfer.files[0];I&&G(I)},B=R=>{var K;const I=(K=R.target.files)==null?void 0:K[0];I&&G(I)},G=async R=>{if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(R.type)&&!R.name.match(/\.(csv|xlsx|xls)$/i)){w("Formato de archivo no valido. Use CSV o Excel (.xlsx, .xls)");return}f(R),w(null);try{let K;if(R.name.match(/\.(xlsx|xls)$/i)){const ne=await R.arrayBuffer(),ee=qw(ne,{type:"array"}),ge=ee.SheetNames[0],L=ee.Sheets[ge];K=Rm.sheet_to_json(L,{header:1,raw:!1,defval:""})}else{const ne=await R.text();K=Y(ne)}ae(K)}catch(K){w("Error al leer el archivo. Verifique que el formato sea correcto."),console.error(K)}},Y=R=>R.trim().split(`
`).map(K=>{const ne=[];let ee="",ge=!1;for(const L of K)L==='"'?ge=!ge:(L===","||L===";")&&!ge?(ne.push(ee.trim()),ee=""):ee+=L;return ne.push(ee.trim()),ne}),ae=R=>{if(R.length<2){w("El archivo debe tener al menos una fila de encabezados y una de datos");return}const I=R[0].map(ee=>ee.toLowerCase().trim()),K=(o==null?void 0:o.columns.filter(ee=>ee!=="id"&&ee!=="active"&&ee!=="created_at"&&ee!=="updated_at"))||[],ne=R.slice(1).map((ee,ge)=>{const L={},se=[];return I.forEach((ke,V)=>{const Ve=ee[V]||"";L[ke]=Ve}),K.forEach(ke=>{!L[ke]&&ke!=="active"&&["nombre","codigo","descripcion","denominacion"].includes(ke)&&(L[ke]||se.push(`Campo "${ke}" es requerido`))}),{rowIndex:ge+2,data:L,errors:se,isValid:se.length===0}});x(ne),ne.length>0&&n(2)},U=()=>{f(null),x([]),n(1),P.current&&(P.current.value="")},q=async()=>{if(!i||g.length===0)return;b(!0),j(10),E(null);const R=g.filter(I=>I.isValid);try{j(30);const I=R.map(ee=>({data:ee.data})),K=await to.bulkUpload(i,I);j(100);const ne={success:K.insertados,failed:K.errores,errors:K.detalles_errores.map(ee=>({row:ee.fila,error:ee.error}))};E(ne)}catch(I){const K={success:0,failed:R.length,errors:[{row:0,error:I instanceof Error?I.message:"Error en carga masiva"}]};E(K)}b(!1),n(3)},z=(R="xlsx")=>{if(!o)return;const I=o.columns.filter(K=>K!=="id"&&K!=="active"&&K!=="created_at"&&K!=="updated_at");if(R==="xlsx"){const K=[I],ne=Rm.aoa_to_sheet(K);ne["!cols"]=I.map(()=>({wch:20}));const ee=Rm.book_new();Rm.book_append_sheet(ee,ne,o.display_name),wre(ee,`plantilla_${i}.xlsx`)}else{const K=I.join(",")+`
`,ne=new Blob([K],{type:"text/csv"}),ee=URL.createObjectURL(ne),ge=document.createElement("a");ge.href=ee,ge.download=`plantilla_${i}.csv`,ge.click(),URL.revokeObjectURL(ee)}},ie=g.filter(R=>R.isValid).length,he=g.filter(R=>!R.isValid).length,O=R=>R<1024?R+" B":R<1024*1024?(R/1024).toFixed(1)+" KB":(R/(1024*1024)).toFixed(1)+" MB";return a.jsxs(Mre,{children:[a.jsxs(Ore,{children:[a.jsx(Nre,{onClick:()=>t("mantenedores"),children:" Volver a Mantenedores"}),a.jsx(Rre,{children:"Carga Masiva"})]}),a.jsxs(zre,{children:[a.jsxs(Sy,{$active:r===1,$completed:r>1,children:[a.jsx($y,{$active:r===1,$completed:r>1,children:r>1?"":"1"}),"Seleccionar Archivo"]}),a.jsxs(Sy,{$active:r===2,$completed:r>2,children:[a.jsx($y,{$active:r===2,$completed:r>2,children:r>2?"":"2"}),"Validar Datos"]}),a.jsxs(Sy,{$active:r===3,$completed:!1,children:[a.jsx($y,{$active:r===3,$completed:!1,children:"3"}),"Resultados"]})]}),A&&a.jsx(zm,{$type:"error",children:A}),r===1&&a.jsxs(Ey,{children:[a.jsxs(Qre,{children:[a.jsx(Jre,{children:"Seleccione el mantenedor"}),a.jsxs(Yre,{value:i,onChange:R=>M(R.target.value),children:[a.jsx("option",{value:"",children:"-- Seleccionar --"}),c.map(R=>a.jsx("option",{value:R.key,children:R.display_name},R.key))]})]}),i&&o&&a.jsxs(a.Fragment,{children:[a.jsxs(zm,{$type:"info",children:["Columnas esperadas: ",o.columns.filter(R=>R!=="id"&&R!=="active"&&R!=="created_at"&&R!=="updated_at").join(", ")]}),a.jsxs(Ire,{$isDragging:m,$hasFile:!!h,onDragOver:F,onDragLeave:D,onDrop:W,onClick:()=>{var R;return(R=P.current)==null?void 0:R.click()},children:[a.jsx("input",{ref:P,type:"file",accept:".csv,.xlsx,.xls",onChange:B,style:{display:"none"}}),a.jsx(Lre,{children:""}),a.jsx(Bre,{children:m?"Suelte el archivo aqui":"Arrastre un archivo o haga clic para seleccionar"}),a.jsx(Ure,{children:"Formatos soportados: CSV, Excel (.xlsx, .xls)"})]}),a.jsxs("div",{style:{marginTop:d.spacing.md,display:"flex",gap:d.spacing.md},children:[a.jsx(sT,{onClick:()=>z("xlsx"),children:" Descargar plantilla Excel"}),a.jsx(sT,{onClick:()=>z("csv"),children:" Descargar plantilla CSV"})]}),h&&a.jsxs(Vre,{children:[a.jsx("span",{children:""}),a.jsx(Hre,{children:h.name}),a.jsx(Wre,{children:O(h.size)}),a.jsx(Gre,{onClick:U,children:""})]})]})]}),r===2&&a.jsxs(Ey,{children:[a.jsx(Ty,{children:"Vista Previa de Datos"}),a.jsxs(aT,{children:[a.jsxs(tc,{$color:d.colors.primary,children:[a.jsx(rc,{children:g.length}),a.jsx(nc,{children:"Total Filas"})]}),a.jsxs(tc,{$color:d.colors.success,children:[a.jsx(rc,{children:ie}),a.jsx(nc,{children:"Validos"})]}),a.jsxs(tc,{$color:d.colors.danger,children:[a.jsx(rc,{children:he}),a.jsx(nc,{children:"Con Errores"})]}),a.jsxs(tc,{$color:d.colors.warning,children:[a.jsxs(rc,{children:[Math.round(ie/g.length*100),"%"]}),a.jsx(nc,{children:"Tasa Exito"})]})]}),a.jsx(nT,{children:a.jsxs(rT,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Gh,{children:"#"}),o==null?void 0:o.columns.filter(R=>R!=="id"&&R!=="active"&&R!=="created_at"&&R!=="updated_at").map(R=>a.jsx(Gh,{children:R},R)),a.jsx(Gh,{children:"Estado"})]})}),a.jsx("tbody",{children:g.slice(0,100).map((R,I)=>a.jsxs("tr",{children:[a.jsx(qh,{children:R.rowIndex}),o==null?void 0:o.columns.filter(K=>K!=="id"&&K!=="active"&&K!=="created_at"&&K!=="updated_at").map(K=>a.jsxs(qh,{$error:R.errors.some(ne=>ne.includes(K)),children:[R.data[K]||"-",R.errors.filter(ne=>ne.includes(K)).map((ne,ee)=>a.jsx(qre,{children:ne},ee))]},K)),a.jsx(qh,{children:R.isValid?a.jsx("span",{style:{color:d.colors.success},children:" Valido"}):a.jsx("span",{style:{color:d.colors.danger},children:" Error"})})]},I))})]})}),g.length>100&&a.jsxs(zm,{$type:"info",children:["Mostrando primeras 100 filas de ",g.length]}),_&&a.jsxs(a.Fragment,{children:[a.jsx(Kre,{children:a.jsx(Xre,{$percent:y})}),a.jsxs("div",{style:{textAlign:"center",color:d.colors.textSecondary},children:["Procesando... ",y,"%"]})]}),a.jsxs(iT,{children:[a.jsx(Nm,{$variant:"secondary",onClick:()=>n(1),disabled:_,children:"Atras"}),a.jsx(Nm,{$variant:"success",onClick:q,disabled:_||ie===0,children:_?"Procesando...":`Cargar ${ie} registros`})]})]}),r===3&&k&&a.jsxs(Ey,{children:[a.jsx(Ty,{children:"Resultados de la Carga"}),a.jsxs(aT,{children:[a.jsxs(tc,{$color:d.colors.success,children:[a.jsx(rc,{children:k.success}),a.jsx(nc,{children:"Exitosos"})]}),a.jsxs(tc,{$color:d.colors.danger,children:[a.jsx(rc,{children:k.failed}),a.jsx(nc,{children:"Fallidos"})]}),a.jsxs(tc,{$color:d.colors.primary,children:[a.jsxs(rc,{children:[Math.round(k.success/(k.success+k.failed)*100),"%"]}),a.jsx(nc,{children:"Tasa Exito"})]})]}),k.success>0&&a.jsxs(zm,{$type:"success",children:["Se cargaron ",k.success," registros exitosamente."]}),k.errors.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(Ty,{children:"Errores Encontrados"}),a.jsx(nT,{style:{maxHeight:"200px"},children:a.jsxs(rT,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Gh,{children:"Fila"}),a.jsx(Gh,{children:"Error"})]})}),a.jsx("tbody",{children:k.errors.map((R,I)=>a.jsxs("tr",{children:[a.jsx(qh,{children:R.row}),a.jsx(qh,{$error:!0,children:R.error})]},I))})]})})]}),a.jsxs(iT,{children:[a.jsx(Nm,{$variant:"secondary",onClick:()=>{n(1),f(null),x([]),E(null)},children:"Nueva Carga"}),a.jsx(Nm,{onClick:()=>t("mantenedores"),children:"Volver a Mantenedores"})]})]})]})}p.div`
  padding: 1.5rem;
  max-width: 100%;
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`;p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`;p.div`
  display: flex;
  gap: 0.75rem;
`;p.button`
  padding: 0.5rem 1rem;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border: none;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"secondary":return`
          background: white;
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgLight}; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border: none;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
`;p.div`
  display: grid;
  grid-template-columns: 1fr 200px auto;
  gap: 1rem;
  align-items: end;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`;p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`;p.input`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.select`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`;p.table`
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
`;p.th`
  padding: 0.75rem 1rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`;p.td`
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
`;p.span`
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;

  ${({$variant:e})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"info":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`;p.button`
  padding: 0.25rem 0.5rem;
  border: none;
  background: ${({$color:e})=>e?`${e}15`:`${d.colors.primary}15`};
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  margin-right: 0.25rem;

  &:hover {
    background: ${({$color:e})=>e?`${e}25`:`${d.colors.primary}25`};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 1rem;
  padding: 0.75rem;
  background: white;
  border-radius: 8px;
`;p.span`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`;p.div`
  display: flex;
  gap: 0.5rem;
`;p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 1rem;
`;p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`;p.textarea`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  min-height: 80px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.div`
  padding: 0.75rem 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${({$type:e})=>e==="success"?`background: ${d.colors.success}15; color: ${d.colors.success}; border: 1px solid ${d.colors.success}30;`:`background: ${d.colors.danger}15; color: ${d.colors.danger}; border: 1px solid ${d.colors.danger}30;`}
`;p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`;p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`;const ene=p.div`
  max-width: 500px;
  margin: 0 auto;
  padding: ${d.spacing.xl};
`,tne=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.xl};
`,rne=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0 0 ${d.spacing.xs} 0;
`,nne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
`,ane=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,Ay=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,Fy=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,Dy=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }
`,Py=p.div`
  position: relative;
`,My=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,oT=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>e==="primary"?`
        background: ${d.colors.primary};
        color: white;
      `:`
        background: ${d.colors.bgLight};
        color: ${d.colors.textSecondary};
        border: 1px solid ${d.colors.border};
      `}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,lT=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`,ine=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,sne=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,Im=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,one=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`,lne=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  padding: 0;
  margin-bottom: ${d.spacing.lg};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`;function cne({onNavigate:e}){const[t,r]=S.useState(""),[n,i]=S.useState(""),[s,o]=S.useState(""),[l,c]=S.useState(!1),[u,h]=S.useState(!1),[f,m]=S.useState(!1),[v,g]=S.useState(!1),[x,_]=S.useState(!1),[b,y]=S.useState(null),j=n.length>=6,k=/[A-Z]/.test(n),E=/[a-z]/.test(n),A=/[0-9]/.test(n),w=n===s&&s!=="",P=j&&w,M=async D=>{var W,B;if(D.preventDefault(),y(null),_(!1),!t){y("Ingrese su contrasea actual");return}if(!P){y("La nueva contrasea no cumple con los requisitos");return}g(!0);try{await mo.changePassword(t,n),_(!0),r(""),i(""),o("")}catch(G){const Y=G instanceof Error?G.message:((B=(W=G==null?void 0:G.response)==null?void 0:W.data)==null?void 0:B.detail)||"Error al cambiar la contrasea";y(Y)}finally{g(!1)}},F=()=>{r(""),i(""),o(""),y(null),_(!1)};return a.jsxs(ene,{children:[a.jsx(lne,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"}),a.jsxs(tne,{children:[a.jsx(rne,{children:"Cambiar Contrasea"}),a.jsx(nne,{children:"Ingrese su contrasea actual y luego la nueva contrasea que desea usar."}),x&&a.jsx(lT,{$type:"success",children:" Su contrasea ha sido actualizada exitosamente."}),b&&a.jsxs(lT,{$type:"error",children:[" ",b]}),a.jsxs(ane,{onSubmit:M,children:[a.jsxs(Ay,{children:[a.jsx(Fy,{children:"Contrasea Actual"}),a.jsxs(Py,{children:[a.jsx(Dy,{type:l?"text":"password",value:t,onChange:D=>r(D.target.value),placeholder:"Ingrese su contrasea actual",disabled:v}),a.jsx(My,{type:"button",onClick:()=>c(!l),children:l?"":""})]})]}),a.jsxs(Ay,{children:[a.jsx(Fy,{children:"Nueva Contrasea"}),a.jsxs(Py,{children:[a.jsx(Dy,{type:u?"text":"password",value:n,onChange:D=>i(D.target.value),placeholder:"Ingrese la nueva contrasea",disabled:v}),a.jsx(My,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs(ine,{children:[a.jsx(sne,{children:"Requisitos de la contrasea:"}),a.jsxs(Im,{$valid:j,children:[j?"":""," Minimo 6 caracteres"]}),a.jsxs(Im,{$valid:k,children:[k?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs(Im,{$valid:E,children:[E?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs(Im,{$valid:A,children:[A?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(Ay,{children:[a.jsx(Fy,{children:"Confirmar Nueva Contrasea"}),a.jsxs(Py,{children:[a.jsx(Dy,{type:f?"text":"password",value:s,onChange:D=>o(D.target.value),placeholder:"Repita la nueva contrasea",disabled:v}),a.jsx(My,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),s&&!w&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contraseas no coinciden"}),w&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contraseas coinciden"})]}),a.jsxs(one,{children:[a.jsx(oT,{type:"button",$variant:"secondary",onClick:F,disabled:v,children:"Limpiar"}),a.jsx(oT,{type:"submit",disabled:v||!P,children:v?"Guardando...":"Cambiar Contrasea"})]})]})]})]})}const dne=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,une=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,hne=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,fne=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,pne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,mne=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,gne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,xne=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,vne=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,_ne=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,yne=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,cT=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,dT=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary}}};
`,bne=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,jne=p.div`
  margin-top: ${d.spacing.lg};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  border: 1px dashed ${d.colors.border};
`,wne=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${d.colors.textMuted};
  margin-bottom: ${d.spacing.xs};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,uT=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
  word-break: break-all;
  font-family: monospace;
`;function kne({onNavigate:e}){const[t,r]=S.useState(""),[n,i]=S.useState(!1),[s,o]=S.useState(!1),[l,c]=S.useState(null),[u,h]=S.useState(null),[f,m]=S.useState(null),v=_=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_),g=async _=>{var b,y;if(_.preventDefault(),c(null),o(!1),h(null),m(null),!t.trim()){c("Ingrese su correo electronico");return}if(!v(t)){c("Ingrese un correo electronico valido");return}i(!0);try{const j=await mo.forgotPassword(t);o(!0),j._dev_token&&(h(j._dev_token),m(j._dev_reset_url||null))}catch(j){const k=j instanceof Error?j.message:((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.detail)||"Error al procesar la solicitud";c(k)}finally{i(!1)}},x=()=>{u&&e("reset-password",{token:u,email:t})};return a.jsx(dne,{children:a.jsxs(une,{children:[a.jsxs(hne,{children:[a.jsx(fne,{children:"INVEB"}),a.jsx(pne,{children:"Sistema de Gestion"})]}),a.jsx(mne,{children:"Recuperar Contrasena"}),a.jsx(gne,{children:"Ingresa tu correo electronico y te enviaremos instrucciones para restablecer tu contrasena."}),s&&a.jsx(dT,{$type:"success",children:"Si el correo esta registrado, recibiras instrucciones para restablecer tu contrasena."}),l&&a.jsx(dT,{$type:"error",children:l}),!s&&a.jsxs(xne,{onSubmit:g,children:[a.jsxs(vne,{children:[a.jsx(_ne,{children:"Correo Electronico"}),a.jsx(yne,{type:"email",value:t,onChange:_=>r(_.target.value),placeholder:"ejemplo@empresa.com",disabled:n,autoComplete:"email",autoFocus:!0})]}),a.jsx(cT,{type:"submit",disabled:n||!t.trim(),children:n?"Enviando...":"Enviar Instrucciones"})]}),u&&a.jsxs(jne,{children:[a.jsx(wne,{children:"Modo Desarrollo"}),a.jsxs(uT,{children:["Token: ",u.substring(0,20),"..."]}),f&&a.jsxs(a.Fragment,{children:[a.jsxs(uT,{style:{marginTop:"8px"},children:["URL: ",f]}),a.jsx(cT,{type:"button",onClick:x,style:{marginTop:"12px",width:"100%"},children:"Ir a Restablecer Contrasena"})]})]}),a.jsx(bne,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const Lm=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,Bm=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,Um=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,Vm=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Hm=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,Oy=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,Cne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,Sne=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,hT=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,fT=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,pT=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,mT=p.div`
  position: relative;
`,gT=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,Ry=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,Ny=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`;case"warning":return`${d.colors.warning}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary;case"warning":return d.colors.warning}}};
`,$ne=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,Ene=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,Wm=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,xT=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,Tne=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function Ane({onNavigate:e,token:t,email:r}){const[n,i]=S.useState(r||""),[s,o]=S.useState(""),[l,c]=S.useState(""),[u,h]=S.useState(!1),[f,m]=S.useState(!1),[v,g]=S.useState(!1),[x,_]=S.useState(!0),[b,y]=S.useState(!1),[j,k]=S.useState(!1),[E,A]=S.useState(null),w=s.length>=6,P=/[A-Z]/.test(s),M=/[a-z]/.test(s),F=/[0-9]/.test(s),D=s===l&&l!=="",W=w&&D;S.useEffect(()=>{(async()=>{if(!t||!n){_(!1),A("Enlace invalido. Por favor solicita uno nuevo.");return}try{const Y=await mo.validateResetToken(t,n);y(Y.valid),Y.valid||A(Y.message||"El enlace es invalido o ha expirado.")}catch{A("Error al validar el enlace.")}finally{_(!1)}})()},[t,n]);const B=async G=>{var Y,ae;if(G.preventDefault(),A(null),!W){A("La contrasena no cumple con los requisitos");return}if(!t){A("Token no valido");return}g(!0);try{await mo.resetPassword(t,n,s),k(!0)}catch(U){const q=U instanceof Error?U.message:((ae=(Y=U==null?void 0:U.response)==null?void 0:Y.data)==null?void 0:ae.detail)||"Error al restablecer la contrasena";A(q)}finally{g(!1)}};return x?a.jsx(Lm,{children:a.jsxs(Bm,{children:[a.jsxs(Um,{children:[a.jsx(Vm,{children:"INVEB"}),a.jsx(Hm,{children:"Sistema de Gestion"})]}),a.jsx(Tne,{children:"Validando enlace..."})]})}):!b&&!j?a.jsx(Lm,{children:a.jsxs(Bm,{children:[a.jsxs(Um,{children:[a.jsx(Vm,{children:"INVEB"}),a.jsx(Hm,{children:"Sistema de Gestion"})]}),a.jsx(Oy,{children:"Enlace Invalido"}),a.jsx(Ny,{$type:"error",children:E||"El enlace de recuperacion es invalido o ha expirado."}),a.jsx(Ry,{type:"button",onClick:()=>e("forgot-password"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Solicitar Nuevo Enlace"}),a.jsx(xT,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})}):j?a.jsx(Lm,{children:a.jsxs(Bm,{children:[a.jsxs(Um,{children:[a.jsx(Vm,{children:"INVEB"}),a.jsx(Hm,{children:"Sistema de Gestion"})]}),a.jsx(Oy,{children:"Contrasena Restablecida"}),a.jsx(Ny,{$type:"success",children:"Tu contrasena ha sido restablecida exitosamente. Ya puedes iniciar sesion con tu nueva contrasena."}),a.jsx(Ry,{type:"button",onClick:()=>e("login"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Ir a Iniciar Sesion"})]})}):a.jsx(Lm,{children:a.jsxs(Bm,{children:[a.jsxs(Um,{children:[a.jsx(Vm,{children:"INVEB"}),a.jsx(Hm,{children:"Sistema de Gestion"})]}),a.jsx(Oy,{children:"Nueva Contrasena"}),a.jsxs(Cne,{children:["Ingresa tu nueva contrasena para la cuenta: ",a.jsx("strong",{children:n})]}),E&&a.jsx(Ny,{$type:"error",children:E}),a.jsxs(Sne,{onSubmit:B,children:[a.jsxs(hT,{children:[a.jsx(fT,{children:"Nueva Contrasena"}),a.jsxs(mT,{children:[a.jsx(pT,{type:u?"text":"password",value:s,onChange:G=>o(G.target.value),placeholder:"Ingresa tu nueva contrasena",disabled:v,autoComplete:"new-password",autoFocus:!0}),a.jsx(gT,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs($ne,{children:[a.jsx(Ene,{children:"Requisitos de la contrasena:"}),a.jsxs(Wm,{$valid:w,children:[w?"":""," Minimo 6 caracteres"]}),a.jsxs(Wm,{$valid:P,children:[P?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs(Wm,{$valid:M,children:[M?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs(Wm,{$valid:F,children:[F?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(hT,{children:[a.jsx(fT,{children:"Confirmar Contrasena"}),a.jsxs(mT,{children:[a.jsx(pT,{type:f?"text":"password",value:l,onChange:G=>c(G.target.value),placeholder:"Repite la nueva contrasena",disabled:v,autoComplete:"new-password"}),a.jsx(gT,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),l&&!D&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contrasenas no coinciden"}),D&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contrasenas coinciden"})]}),a.jsx(Ry,{type:"submit",disabled:v||!W,children:v?"Guardando...":"Restablecer Contrasena"})]}),a.jsx(xT,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const zy=p.div`
  padding: 1.5rem;
  max-width: 100%;
  background: #f5f5f5;
  min-height: calc(100vh - 60px);
`,Iy=p.div`
  display: flex;
  align-items: center;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,Ly=p.h1`
  font-size: 1.75rem;
  font-weight: 400;
  color: #333;
  margin: 0;
`,By=p.button`
  background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
  color: white;
  border: none;
  padding: 0.6rem 1.5rem;
  border-radius: 50px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);

  &:hover {
    background: linear-gradient(135deg, #138496 0%, #117a8b 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
`,Fne=p.div`
  background: white;
  padding: 1rem 1.5rem;
  margin-bottom: 1rem;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.08);
`,Dne=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: flex-end;
`,Ho=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  min-width: 120px;
`,Wo=p.label`
  font-size: 0.7rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Uy=p.input`
  padding: 0.45rem 0.6rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  width: 100%;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }

  &::placeholder {
    color: #999;
  }
`,Gm=p.select`
  padding: 0.45rem 0.6rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  min-width: 140px;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
  }
`,Pne=p.button`
  background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
  color: white;
  border: none;
  padding: 0.5rem 1.25rem;
  border-radius: 4px;
  font-size: 0.85rem;
  cursor: pointer;
  white-space: nowrap;

  &:hover {
    background: linear-gradient(135deg, #138496 0%, #117a8b 100%);
  }
`,Mne=p.div`
  background: white;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  overflow: hidden;
`,One=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,li=p.th`
  background: linear-gradient(135deg, #343a40 0%, #23272b 100%);
  color: white;
  padding: 0.75rem 0.5rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: none;
  white-space: nowrap;
  border: none;
`,ci=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid #eee;
  vertical-align: middle;
  text-align: center;
  font-size: 0.82rem;
  color: #333;
`,Rne=p.tr`
  &:hover {
    background: #f8f9fa;
  }

  &:last-child td {
    border-bottom: none;
  }
`,Nne=p.span`
  display: inline-block;
  padding: 0.3rem 0.75rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  white-space: nowrap;

  ${e=>{switch(e.$state){case"rechazada":return"background: #dc3545; color: white;";case"liberada":case"aprobada":case"vigente":return"background: #28a745; color: white;";case"por_aprobar":case"pendiente":return"background: #ffc107; color: #333;";case"borrador":return"background: #6c757d; color: white;";case"vencida":return"background: #6c757d; color: white;";default:return"background: #17a2b8; color: white;"}}}
`,zne=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-size: 0.8rem;
`,Vy=p.span`
  display: inline-flex;
  align-items: center;
  gap: 0.15rem;

  ${e=>{switch(e.$type){case"box":return"color: #333;";case"thumbsUp":return"color: #28a745;";case"thumbsDown":return"color: #dc3545;";default:return"color: #333;"}}}
`,Ine=p.div`
  display: flex;
  justify-content: center;
  gap: 0.25rem;
`,Hy=p.button`
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  transition: all 0.15s;
  background: ${e=>e.$color||"#6c757d"};
  color: white;

  &:hover {
    opacity: 0.85;
    transform: scale(1.05);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,vT=p.span`
  color: #17a2b8;
  font-weight: 500;
`,Lne=p.div`
  text-align: center;
  padding: 3rem;
  color: #666;
`,Bne=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: #666;
`,Une=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid #ddd;
  border-top-color: #17a2b8;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Wy=p.div`
  padding: 1rem;
  border-radius: 4px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Vne={1:{label:"Borrador",key:"borrador"},2:{label:"Por Aprobar",key:"por_aprobar"},3:{label:"Liberada",key:"liberada"},4:{label:"Vigente",key:"vigente"},5:{label:"Vencida",key:"vencida"},6:{label:"Rechazada",key:"rechazada"}};function Hne({onNavigate:e}){const t=Mr(),[r,n]=S.useState(()=>{const z=new Date;return z.setMonth(z.getMonth()-2),z.toISOString().split("T")[0]}),[i,s]=S.useState(()=>new Date().toISOString().split("T")[0]),[o,l]=S.useState(""),[c,u]=S.useState([]),[h,f]=S.useState([]),[m,v]=S.useState(""),[g,x]=S.useState(""),[_,b]=S.useState({page:1,page_size:50}),[y,j]=S.useState(null),[k,E]=S.useState(null),{data:A,isLoading:w,error:P}=zt({queryKey:["cotizaciones",_],queryFn:()=>Fn.list(_)}),{data:M}=zt({queryKey:["cotizacion-estados"],queryFn:()=>Fn.getEstados()}),F=Ct({mutationFn:z=>Fn.delete(z),onSuccess:()=>{t.invalidateQueries({queryKey:["cotizaciones"]}),j("Cotizacin eliminada correctamente"),setTimeout(()=>j(null),3e3)},onError:z=>{E(z.message||"Error al eliminar cotizacin"),setTimeout(()=>E(null),5e3)}}),D=S.useCallback(()=>{const z={page:1,page_size:50};r&&(z.date_desde=r),i&&(z.date_hasta=i),o&&(z.cotizacion_id=parseInt(o,10)),h.length>0&&(z.estado_id=h.map(ie=>parseInt(ie,10))),b(z)},[r,i,o,h]),W=S.useCallback(()=>{e("cotizacion-nueva")},[e]),B=S.useCallback(z=>{e("cotizacion-editar",z)},[e]),G=S.useCallback(z=>{e("cotizacion-editar",z)},[e]),Y=S.useCallback(z=>{window.confirm("Est seguro de eliminar esta cotizacin?")&&F.mutate(z)},[F]),ae=z=>{if(!z)return"-";const ie=new Date(z);return`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}-${String(ie.getDate()).padStart(2,"0")}
${String(ie.getHours()).padStart(2,"0")}:${String(ie.getMinutes()).padStart(2,"0")}:${String(ie.getSeconds()).padStart(2,"0")}`},U=z=>{const ie=Vne[z]||{label:"Desconocido",key:"default"};return a.jsx(Nne,{$state:ie.key,children:ie.label})};if(w)return a.jsxs(zy,{children:[a.jsxs(Iy,{children:[a.jsx(Ly,{children:"Cotizaciones"}),a.jsx(By,{onClick:W,children:"Crear Cotizacin"})]}),a.jsxs(Bne,{children:[a.jsx(Une,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(P)return a.jsxs(zy,{children:[a.jsxs(Iy,{children:[a.jsx(Ly,{children:"Cotizaciones"}),a.jsx(By,{onClick:W,children:"Crear Cotizacin"})]}),a.jsxs(Wy,{$type:"error",children:["Error al cargar cotizaciones: ",P.message]})]});const q=(A==null?void 0:A.items)||[];return a.jsxs(zy,{children:[a.jsxs(Iy,{children:[a.jsx(Ly,{children:"Cotizaciones"}),a.jsx(By,{onClick:W,children:"Crear Cotizacin"})]}),y&&a.jsx(Wy,{$type:"success",children:y}),k&&a.jsx(Wy,{$type:"error",children:k}),a.jsx(Fne,{children:a.jsxs(Dne,{children:[a.jsxs(Ho,{children:[a.jsx(Wo,{children:"DESDE"}),a.jsx(Uy,{type:"date",value:r,onChange:z=>n(z.target.value)})]}),a.jsxs(Ho,{children:[a.jsx(Wo,{children:"HASTA"}),a.jsx(Uy,{type:"date",value:i,onChange:z=>s(z.target.value)})]}),a.jsxs(Ho,{children:[a.jsx(Wo,{children:"N DE COTIZACION"}),a.jsx(Uy,{type:"text",value:o,onChange:z=>l(z.target.value),placeholder:""})]}),a.jsxs(Ho,{style:{minWidth:"160px"},children:[a.jsx(Wo,{children:"CLIENTE"}),a.jsx(Gm,{value:c[0]||"",onChange:z=>u(z.target.value?[z.target.value]:[]),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Ho,{style:{minWidth:"160px"},children:[a.jsx(Wo,{children:"ESTADO"}),a.jsxs(Gm,{value:h[0]||"",onChange:z=>f(z.target.value?[z.target.value]:[]),children:[a.jsx("option",{value:"",children:"Selecciona..."}),M==null?void 0:M.map(z=>a.jsx("option",{value:z.id,children:z.nombre},z.id))]})]}),a.jsxs(Ho,{children:[a.jsx(Wo,{children:"OT"}),a.jsx(Gm,{value:m,onChange:z=>v(z.target.value),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Ho,{children:[a.jsx(Wo,{children:"CAD"}),a.jsx(Gm,{value:g,onChange:z=>x(z.target.value),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Ho,{children:[a.jsx(Wo,{children:""}),a.jsx(Pne,{onClick:D,children:"Filtrar Cotizacin"})]})]})}),a.jsx(Mne,{children:q.length===0?a.jsx(Lne,{children:a.jsx("p",{children:"No se encontraron cotizaciones"})}):a.jsxs(One,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(li,{children:"Cotizacin N"}),a.jsx(li,{children:"N de Productos"}),a.jsx(li,{children:"Creador"}),a.jsx(li,{children:"Cliente"}),a.jsxs(li,{children:["Fecha Creacin",a.jsx("br",{}),"1ra Ver."]}),a.jsxs(li,{children:["Fecha Creacin",a.jsx("br",{}),"Ult. Ver."]}),a.jsx(li,{children:"Descrip."}),a.jsx(li,{children:"CAD"}),a.jsx(li,{children:"OT"}),a.jsx(li,{children:"N Versin"}),a.jsx(li,{children:"Estado"}),a.jsx(li,{children:"Acciones"})]})}),a.jsx("tbody",{children:q.map(z=>a.jsxs(Rne,{children:[a.jsx(ci,{children:a.jsx("strong",{children:z.id})}),a.jsx(ci,{children:a.jsxs(zne,{children:[a.jsxs(Vy,{$type:"box",children:[" ",z.total_detalles||0]}),a.jsx(Vy,{$type:"thumbsUp",children:" 0"}),a.jsx(Vy,{$type:"thumbsDown",children:" 0"})]})}),a.jsx(ci,{children:z.usuario_nombre||"Vendedor Ventas"}),a.jsx(ci,{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:z.cliente_nombre||"-"}),a.jsx(ci,{style:{whiteSpace:"pre-line",fontSize:"0.75rem"},children:ae(z.created_at)}),a.jsx(ci,{style:{whiteSpace:"pre-line",fontSize:"0.75rem"},children:ae(z.updated_at||z.created_at)}),a.jsx(ci,{children:z.primer_detalle_descripcion||"-"}),a.jsx(ci,{children:z.primer_detalle_cad?a.jsx(vT,{children:z.primer_detalle_cad}):"-"}),a.jsx(ci,{children:z.primer_detalle_ot?a.jsx(vT,{children:z.primer_detalle_ot}):"-"}),a.jsx(ci,{children:z.version_number||1}),a.jsx(ci,{children:U(z.estado_id)}),a.jsx(ci,{children:a.jsxs(Ine,{children:[a.jsx(Hy,{$color:"#ffc107",onClick:()=>G(z.id),title:"Editar",children:""}),a.jsx(Hy,{$color:"#17a2b8",onClick:()=>B(z.id),title:"Ver detalles",children:""}),z.estado_id===1&&a.jsx(Hy,{$color:"#dc3545",onClick:()=>Y(z.id),disabled:F.isPending,title:"Eliminar",children:""})]})})]},z.id))})]})})]})}const _T="http://localhost:8001/api/v1",Wne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
  z-index: 1100;
  overflow-y: auto;
`,Gne=p.div`
  background: white;
  border-radius: 4px;
  width: 100%;
  max-width: 900px;
  margin: 20px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
`,qne=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #dee2e6;
`,Kne=p.h1`
  margin: 0;
  font-size: 1.25rem;
  color: #333;
`,Xne=p.button`
  background: none;
  border: none;
  font-size: 28px;
  cursor: pointer;
  color: #666;
  padding: 0;
  line-height: 1;

  &:hover {
    color: #333;
  }
`,Yne=p.div`
  padding: 24px;
  background-color: #F2F4FD;
`,Qne=p.div`
  background: white;
  border-radius: 4px;
  padding: 20px;
`,Kh=p.div`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -12px;
`,ms=p.div`
  flex: 0 0 ${e=>(e.$size||12)/12*100}%;
  max-width: ${e=>(e.$size||12)/12*100}%;
  padding: 0 12px;
  ${e=>e.$offset?`margin-left: ${e.$offset/12*100}%;`:""}
  box-sizing: border-box;
`,ct=p.div`
  margin-bottom: 16px;
`,dt=p.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,er=p.label`
  font-size: 12px;
  font-weight: 600;
  color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
  text-transform: uppercase;
  white-space: nowrap;
  min-width: 100px;
`,wn=p.label`
  font-size: 12px;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
  white-space: nowrap;
  min-width: 160px;
`,gs=p.input`
  flex: 1;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};
  min-width: 0;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(23, 162, 184, 0.25)"};
  }

  &:disabled, &[readonly] {
    background: #e9ecef;
  }
`,Da=p.select`
  flex: 1;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};
  min-width: 0;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(23, 162, 184, 0.25)"};
  }
`,yT=p.button`
  background: #17a2b8;
  color: white;
  border: none;
  padding: 8px 24px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #138496;
  }

  &:disabled {
    opacity: 0.65;
    cursor: not-allowed;
  }
`,Gy=p.button`
  background: #f8f9fa;
  color: #333;
  border: 1px solid #ddd;
  padding: 8px 24px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #e2e6ea;
  }
`,bT=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  width: 100%;

  &:hover {
    background: #218838;
  }
`,jT=p.div`
  h3 {
    font-size: 14px;
    font-weight: 600;
    margin: 0 0 12px 0;
    color: #333;
  }
`,kn=p.span`
  flex: 1;
  padding: 6px 0;
  font-size: 14px;
  color: #333;
`,Jne=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 16px;
`,Zne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1200;
`,eae=p.div`
  background: white;
  border-radius: 4px;
  padding: 20px;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  text-align: center;
`,tae=p.p`
  margin: 0 0 20px 0;
  font-size: 14px;
  color: #333;
`,rae=p.div`
  display: flex;
  justify-content: center;
  gap: 12px;
`,wT={tipo_calculo:1,interno_largo:null,interno_ancho:null,interno_alto:null,style_id:null,traslape:null,areahc_product_type_id:null,prepicado_ventilacion:0,onda_id:null,process_id:null,rubro_id:null,carton_color:null,ect_min_ingresado:null,envase_id:null,contenido_caja:null,areahc_pallets_apilados:null,cajas_apiladas_por_pallet:null,filas_columnares_por_pallet:null,numero_colores:null,rmt:null},qy={externo_largo:null,externo_ancho:null,externo_alto:null,areahc:null,rmt_resultado:null,ect_min:null,codigo_carton_id:null,codigo_carton:"",ect_min_carton:null,interno_largo:null,interno_ancho:null,interno_alto:null,rubro_id:null,process_id:null,product_type_id:null,numero_colores:null},nae={styles:[],product_types:[],processes:[],rubros:[],ondas:[],envases:[],tipos_calculo:[{id:1,nombre:"Clculo HC y Cartn"},{id:2,nombre:"Clculo HC"},{id:3,nombre:"Cartn"}],colores_carton:[{id:1,nombre:"Caf"},{id:2,nombre:"Blanco"}],prepicado_ventilacion:[{id:0,nombre:"No"},{id:1,nombre:"S"}],numero_colores:[{id:0,nombre:"0"},{id:1,nombre:"1"},{id:2,nombre:"2"},{id:3,nombre:"3"},{id:4,nombre:"4"},{id:5,nombre:"5"}]};function aae({mode:e,onClose:t,onApply:r}){const[n,i]=S.useState(()=>({...wT,tipo_calculo:e==="carton"?3:e==="calculo_hc"?2:1})),[s,o]=S.useState(qy),[l,c]=S.useState({}),[u,h]=S.useState(!1),[f,m]=S.useState(nae),[v,g]=S.useState(!1),[x,_]=S.useState(!1),[b,y]=S.useState(!1);S.useEffect(()=>{(async()=>{g(!0);try{const z=await fetch(`${_T}/areahc/form-options`);if(z.ok){const ie=await z.json();m(he=>({...he,styles:ie.styles||[],product_types:ie.product_types||[],processes:ie.processes||[],rubros:ie.rubros||[],ondas:ie.ondas||[],envases:ie.envases||[],tipos_calculo:ie.tipos_calculo||he.tipos_calculo,colores_carton:ie.colores_carton||he.colores_carton,prepicado_ventilacion:ie.prepicado_ventilacion||he.prepicado_ventilacion,numero_colores:ie.numero_colores||he.numero_colores}))}}catch(z){console.error("Error fetching form options:",z)}finally{g(!1)}})()},[]);const j=n.tipo_calculo,k=j===1,E=j===2,A=j===3,w=k||E,P=k||A,M=S.useCallback(q=>{const{name:z,value:ie,type:he}=q.target;let O=ie;he==="number"?O=ie===""?null:parseFloat(ie):q.target.tagName==="SELECT"&&(O=ie===""?null:parseInt(ie)),i(R=>({...R,[z]:O})),l[z]&&c(R=>{const I={...R};return delete I[z],I}),z==="tipo_calculo"&&(o(qy),h(!1),c({}))},[l]),F=S.useCallback(()=>{const q={},z=n.tipo_calculo;return(z===1||z===2)&&((!n.interno_largo||n.interno_largo<=0)&&(q.interno_largo="Campo requerido"),(!n.interno_ancho||n.interno_ancho<=0)&&(q.interno_ancho="Campo requerido"),(!n.interno_alto||n.interno_alto<=0)&&(q.interno_alto="Campo requerido"),n.style_id||(q.style_id="Seleccione un estilo"),n.onda_id||(q.onda_id="Seleccione tipo de onda"),n.process_id||(q.process_id="Seleccione un proceso")),(z===1||z===3)&&(n.onda_id||(q.onda_id="Seleccione tipo de onda"),n.rubro_id||(q.rubro_id="Seleccione un rubro"),n.carton_color||(q.carton_color="Seleccione color de cartn")),z===3&&(!n.ect_min_ingresado||n.ect_min_ingresado<=0)&&(q.ect_min_ingresado="Ingrese ECT mnimo"),c(q),Object.keys(q).length===0},[n]),D=S.useCallback(async()=>{if(F()){_(!0);try{const q=await fetch(`${_T}/areahc/calcular`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(q.ok){const z=await q.json();z.success?(o({externo_largo:z.externo_largo,externo_ancho:z.externo_ancho,externo_alto:z.externo_alto,areahc:z.areahc,rmt_resultado:z.rmt,ect_min:z.ect_min,codigo_carton_id:z.codigo_carton_id,codigo_carton:z.codigo_carton||"",ect_min_carton:z.ect_min_carton,interno_largo:n.interno_largo,interno_ancho:n.interno_ancho,interno_alto:n.interno_alto,rubro_id:n.rubro_id,process_id:n.process_id,product_type_id:n.areahc_product_type_id,numero_colores:n.numero_colores}),h(!0)):(console.error("Calculation error:",z.error),alert(z.error||"Error en el clculo"))}else console.error("API error:",q.status),alert("Error al comunicarse con el servidor")}catch(q){console.error("Network error:",q),alert("Error de conexin")}finally{_(!1)}}},[n,F]),W=S.useCallback(()=>{i({...wT,tipo_calculo:e==="carton"?3:e==="calculo_hc"?2:1}),o(qy),c({}),h(!1)},[e]),B=S.useCallback(()=>{u&&y(!0)},[u]),G=S.useCallback(()=>{if(r&&u){const q={...s,interno_largo:n.interno_largo,interno_ancho:n.interno_ancho,interno_alto:n.interno_alto,rubro_id:n.rubro_id,process_id:n.process_id,product_type_id:n.areahc_product_type_id,numero_colores:n.numero_colores};r(q),y(!1),t()}},[r,s,u,n,t]),Y=S.useCallback(()=>{y(!1)},[]),ae=()=>a.jsxs(Kh,{children:[a.jsxs(ms,{$size:8,children:[a.jsxs(Kh,{style:{marginBottom:"16px"},children:[a.jsx(ms,{$size:6,children:a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.onda_id,children:"Tipo de Onda:"}),a.jsxs(Da,{name:"onda_id",value:n.onda_id??"",onChange:M,$hasError:!!l.onda_id,disabled:v,"data-testid":"select-onda",children:[a.jsx("option",{value:"",children:"-"}),f.ondas.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})})}),a.jsx(ms,{$size:6,children:a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.carton_color,children:"Color Cartn:"}),a.jsxs(Da,{name:"carton_color",value:n.carton_color??"",onChange:M,$hasError:!!l.carton_color,"data-testid":"select-color-carton",children:[a.jsx("option",{value:"",children:"-"}),f.colores_carton.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})})})]}),a.jsxs(Kh,{children:[a.jsx(ms,{$size:6,children:a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.rubro_id,children:"Rubro:"}),a.jsxs(Da,{name:"rubro_id",value:n.rubro_id??"",onChange:M,$hasError:!!l.rubro_id,disabled:v,"data-testid":"select-rubro",children:[a.jsx("option",{value:"",children:"-"}),f.rubros.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})})}),a.jsx(ms,{$size:6,children:a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.ect_min_ingresado,children:"ECT min (lbf):"}),a.jsx(gs,{type:"number",name:"ect_min_ingresado",value:n.ect_min_ingresado??"",onChange:M,$hasError:!!l.ect_min_ingresado,"data-testid":"input-ect-min"})]})})})]})]}),a.jsx(ms,{$size:4,children:a.jsxs(jT,{children:[a.jsx("h3",{children:"Resultados"}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Largo Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-largo",children:u?s.externo_largo??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Ancho Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-ancho",children:u?s.externo_ancho??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Alto Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-alto",children:u?s.externo_alto??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Area HC (m2):"}),a.jsx(kn,{"data-testid":"result-areahc",children:u?s.areahc??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"RMT (lb):"}),a.jsx(kn,{"data-testid":"result-rmt",children:u?s.rmt_resultado??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"ECT min (lbf):"}),a.jsx(kn,{"data-testid":"result-ect",children:u?s.ect_min??"":""})]})}),a.jsx("h3",{children:"Cartn Seleccionado"}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Cdigo Cartn:"}),a.jsx(kn,{"data-testid":"result-codigo-carton",children:u?s.codigo_carton:""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"ECT min (lbf) Cartn:"}),a.jsx(kn,{"data-testid":"result-ect-carton",children:u?s.ect_min_carton??"":""})]})}),u&&a.jsx(bT,{type:"button",onClick:B,style:{marginTop:"16px"},"data-testid":"btn-llevar-detalle",children:"Llevar a Detalle"})]})})]}),U=()=>a.jsxs(Kh,{children:[a.jsx(ms,{$size:4,children:w&&a.jsxs(a.Fragment,{children:[a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.interno_largo,children:"Largo (mm):"}),a.jsx(gs,{type:"number",name:"interno_largo",value:n.interno_largo??"",onChange:M,$hasError:!!l.interno_largo,"data-testid":"input-largo"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.interno_ancho,children:"Ancho (mm):"}),a.jsx(gs,{type:"number",name:"interno_ancho",value:n.interno_ancho??"",onChange:M,$hasError:!!l.interno_ancho,"data-testid":"input-ancho"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.interno_alto,children:"Alto (mm):"}),a.jsx(gs,{type:"number",name:"interno_alto",value:n.interno_alto??"",onChange:M,$hasError:!!l.interno_alto,"data-testid":"input-alto"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.style_id,children:"Estilo:"}),a.jsxs(Da,{name:"style_id",value:n.style_id??"",onChange:M,$hasError:!!l.style_id,disabled:v,"data-testid":"select-estilo",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.styles.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Traslape [mm]:"}),a.jsx(gs,{type:"number",name:"traslape",value:n.traslape??"",onChange:M,"data-testid":"input-traslape"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.areahc_product_type_id,children:"Tipo item:"}),a.jsxs(Da,{name:"areahc_product_type_id",value:n.areahc_product_type_id??"",onChange:M,$hasError:!!l.areahc_product_type_id,disabled:v,"data-testid":"select-tipo-item",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.product_types.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),k&&a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Prepicado:"}),a.jsx(Da,{name:"prepicado_ventilacion",value:n.prepicado_ventilacion,onChange:M,"data-testid":"select-prepicado",children:f.prepicado_ventilacion.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.onda_id,children:"Tipo de Onda:"}),a.jsxs(Da,{name:"onda_id",value:n.onda_id??"",onChange:M,$hasError:!!l.onda_id,disabled:v,"data-testid":"select-onda",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.ondas.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.process_id,children:"Proceso:"}),a.jsxs(Da,{name:"process_id",value:n.process_id??"",onChange:M,$hasError:!!l.process_id,disabled:v,"data-testid":"select-proceso",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.processes.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),P&&a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.rubro_id,children:"Rubro:"}),a.jsxs(Da,{name:"rubro_id",value:n.rubro_id??"",onChange:M,$hasError:!!l.rubro_id,disabled:v,"data-testid":"select-rubro",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.rubros.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})})]})}),a.jsx(ms,{$size:4,children:w&&k&&a.jsxs(a.Fragment,{children:[a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Envase Primario:"}),a.jsxs(Da,{name:"envase_id",value:n.envase_id??"",onChange:M,disabled:v,"data-testid":"select-envase",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.envases.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Contenido Caja (Kg):"}),a.jsx(gs,{type:"number",name:"contenido_caja",value:n.contenido_caja??"",onChange:M,"data-testid":"input-contenido-caja"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"N Palets apilados:"}),a.jsx(gs,{type:"number",name:"areahc_pallets_apilados",value:n.areahc_pallets_apilados??"",onChange:M,"data-testid":"input-pallets"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"N Cajas Apiladas:"}),a.jsx(gs,{type:"number",name:"cajas_apiladas_por_pallet",value:n.cajas_apiladas_por_pallet??"",onChange:M,"data-testid":"input-cajas-apiladas"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"N Filas Colum.:"}),a.jsx(gs,{type:"number",name:"filas_columnares_por_pallet",value:n.filas_columnares_por_pallet??"",onChange:M,"data-testid":"input-filas"})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{$hasError:!!l.carton_color,children:"Color Cartn:"}),a.jsxs(Da,{name:"carton_color",value:n.carton_color??"",onChange:M,$hasError:!!l.carton_color,"data-testid":"select-color-carton",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.colores_carton.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Nmero Colores:"}),a.jsxs(Da,{name:"numero_colores",value:n.numero_colores??"",onChange:M,"data-testid":"select-numero-colores",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.numero_colores.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))]})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"RMT (Lb):"}),a.jsx(gs,{type:"number",name:"rmt",value:n.rmt??"",onChange:M,"data-testid":"input-rmt"})]})})]})}),a.jsx(ms,{$size:4,children:a.jsxs(jT,{children:[a.jsx("h3",{children:"Resultados"}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Largo Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-largo",children:u?s.externo_largo??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Ancho Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-ancho",children:u?s.externo_ancho??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Alto Exterior (mm):"}),a.jsx(kn,{"data-testid":"result-alto",children:u?s.externo_alto??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Area HC (m2):"}),a.jsx(kn,{"data-testid":"result-areahc",children:u?s.areahc??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"RMT (lb):"}),a.jsx(kn,{"data-testid":"result-rmt",children:u?s.rmt_resultado??"":""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"ECT min (lbf):"}),a.jsx(kn,{"data-testid":"result-ect",children:u?s.ect_min??"":""})]})}),a.jsx("h3",{children:"Cartn Seleccionado"}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"Cdigo Cartn:"}),a.jsx(kn,{"data-testid":"result-codigo-carton",children:u?s.codigo_carton:""})]})}),a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(wn,{children:"ECT min (lbf) Cartn:"}),a.jsx(kn,{"data-testid":"result-ect-carton",children:u?s.ect_min_carton??"":""})]})}),u&&a.jsx(bT,{type:"button",onClick:B,style:{marginTop:"16px"},"data-testid":"btn-llevar-detalle",children:"Llevar a Detalle"})]})})]});return a.jsxs(a.Fragment,{children:[a.jsx(Wne,{"data-testid":"modal-calculo-hc",children:a.jsxs(Gne,{children:[a.jsxs(qne,{children:[a.jsx(Kne,{children:"Clculo HC y Cartn"}),a.jsx(Xne,{onClick:t,"data-testid":"btn-close",children:""})]}),a.jsxs(Yne,{children:[a.jsxs(Qne,{children:[a.jsx(Kh,{style:{marginBottom:"24px"},children:a.jsx(ms,{$size:4,$offset:4,children:a.jsx(ct,{children:a.jsxs(dt,{children:[a.jsx(er,{children:"Tipo de Clculo"}),a.jsx(Da,{name:"tipo_calculo",value:n.tipo_calculo,onChange:M,disabled:v,"data-testid":"select-tipo-calculo",children:f.tipos_calculo.map(q=>a.jsx("option",{value:q.id,children:q.nombre},q.id))})]})})})}),A?ae():U()]}),a.jsxs(Jne,{children:[a.jsx(Gy,{onClick:t,"data-testid":"btn-cancelar",children:"Cancelar"}),a.jsx(Gy,{onClick:W,"data-testid":"btn-limpiar",children:"Limpiar"}),a.jsx(yT,{onClick:D,disabled:x,"data-testid":"btn-calcular",children:x?"Calculando...":"Calcular"})]})]})]})}),b&&a.jsx(Zne,{children:a.jsxs(eae,{children:[a.jsx(tae,{children:n.carton_color?"Cartn estimado, favor validar este dato con desarrollo":"rea Hoja Corrugada estimada, favor validar este dato con desarrollo"}),a.jsxs(rae,{children:[a.jsx(Gy,{onClick:Y,children:"Cancelar"}),a.jsx(yT,{onClick:G,children:"Confirmo"})]})]})})]})}const iae="http://localhost:8001/api/v1",sae={product_types:[],processes:[],rubros:[],cartons:[],printing_machines:[],print_types:[],pegados:[],barniz_types:[],ink_types:[],pallet_heights:[],cities:[],hierarchies:[],cartons_esquinero:[],maquila_servicios:[],pallets:[{id:0,nombre:"No"},{id:1,nombre:"Madera"},{id:2,nombre:"Plstico"}],zunchos:[{id:0,nombre:"No"},{id:1,nombre:"1 zuncho"},{id:2,nombre:"2 zunchos"},{id:3,nombre:"3 zunchos"}],si_no:[{id:0,nombre:"No"},{id:1,nombre:"Si"}],numero_colores:Array.from({length:7},(e,t)=>({id:t,nombre:String(t)})),pallets_apilados:[{id:1,nombre:"1"},{id:2,nombre:"2"}],tipo_destino_esquinero:[{id:1,nombre:"Tarima Nacional"},{id:2,nombre:"Empaque Exportacin (Granel)"},{id:3,nombre:"Tarima de Exportacin"}],tipo_camion_esquinero:[{id:1,nombre:"Camin 7x2,6mts"}]},oae=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
  z-index: 1000;
  overflow-y: auto;
`,lae=p.div`
  background: white;
  border-radius: 4px;
  width: 100%;
  max-width: 1400px;
  margin: 20px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
`,cae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #dee2e6;
`,dae=p.h1`
  margin: 0;
  font-size: 1.5rem;
  color: #333;
`,uae=p.button`
  background: none;
  border: none;
  font-size: 28px;
  cursor: pointer;
  color: #666;
  padding: 0;
  line-height: 1;

  &:hover {
    color: #333;
  }
`,hae=p.div`
  padding: 16px;
  background: #F2F4FD;
  max-height: calc(100vh - 180px);
  overflow-y: auto;
`,Md=p.div`
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.125);
  border-radius: 4px;
  margin-bottom: 16px;
`,ac=p.div`
  padding: 12px 20px;
  background: #f8f9fa;
  border-bottom: 1px solid rgba(0, 0, 0, 0.125);
  font-weight: 500;
  font-size: 14px;
  color: #333;
  ${e=>e.$center&&`
    text-align: center;
    font-size: 18px;
  `}
`,Od=p.div`
  padding: 20px;
`,di=p.div`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -8px;
`,tr=p.div`
  flex: 0 0 ${e=>(e.$size||12)/12*100}%;
  max-width: ${e=>(e.$size||12)/12*100}%;
  padding: 0 8px;
  ${e=>e.$offset&&`margin-left: ${e.$offset/12*100}%;`}
`,Be=p.div`
  margin-bottom: 12px;
`,Ue=p.label`
  font-size: 12px;
  color: #333;
  margin-bottom: 4px;
  display: block;
  min-width: auto;
  white-space: nowrap;
`,cr=p.input`
  width: 100%;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#80bdff"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(0, 123, 255, 0.25)"};
  }

  &:disabled, &[readonly] {
    background: #e9ecef;
  }
`,ut=p.select`
  width: 100%;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#80bdff"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(0, 123, 255, 0.25)"};
  }
`,ua=p.div`
  color: #dc3545;
  font-size: 11px;
  margin-top: 4px;
`,Kw=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 4px;

  &:hover {
    background: #218838;
  }

  &:disabled {
    opacity: 0.65;
    cursor: not-allowed;
  }
`,fae=p.button`
  background: #f8f9fa;
  color: #333;
  border: 1px solid #ddd;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #e2e6ea;
  }
`,kT=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;

  &:hover {
    background: #218838;
  }
`,pae=p(Kw)`
  width: 100%;
`,CT=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #6c757d;
  color: white;
  font-size: 12px;
  cursor: help;
  margin-left: 4px;
`,ST=p.div`
  display: flex;
  gap: 8px;

  input, select {
    flex: 1;
  }
`,$T=p.div`
  display: flex;
  align-items: center;
  gap: 4px;

  input {
    flex: 1;
  }
`,ET={tipo_detalle_id:1,cantidad:null,product_type_id:null,numero_colores:null,planta_id:1,variable_cotizador_id:1,largo:null,ancho:null,alto:null,tipo_medida:1,area_hc:null,anchura:null,largura:null,carton_id:null,golpes_largo:1,golpes_ancho:1,printing_machine_id:null,print_type_id:null,process_id:null,ink_type_id:null,numero_colores_esquinero:null,pegado_id:null,cinta_desgarro:null,barniz:null,barniz_type_id:null,cobertura_color_percent:0,cobertura_barniz_cm2:0,cobertura_color_cm2:0,pallet:1,pallet_height_id:null,zuncho:null,funda:0,stretch_film:1,ensamblado:null,desgajado_cabezal:null,rubro_id:null,bct_min_lb:null,bct_min_kg:null,descripcion_material_detalle:"",cad_material_detalle:"",codigo_cliente:"",devolucion_pallets:1,ajuste_precios:0,codigo_material_detalle:"",hierarchy_id:null,subhierarchy_id:null,subsubhierarchy_id:null,matriz:null,clisse:0,royalty:0,maquila:0,maquila_servicio_id:null,cuchillos_gomas:null,armado_automatico:null,armado_usd_caja:null,largo_esquinero:null,carton_esquinero_id:null,funda_esquinero:null,tipo_destino_esquinero:null,tipo_camion_esquinero:null,maquila_esquinero:null,clisse_esquinero:null,cantidad_esquinero:null,ciudad_id:null,pallets_apilados:null};function mae({detalle:e,plantaId:t,onSubmit:r,onCancel:n}){const[i,s]=S.useState(e||{...ET,planta_id:t||1}),[o,l]=S.useState({}),[c,u]=S.useState(!1),[h,f]=S.useState("ambos"),[m,v]=S.useState(sae),[g,x]=S.useState(!0),_=!!(e!=null&&e.id),b=i.tipo_detalle_id===1;S.useEffect(()=>{(async()=>{x(!0);try{const D=await fetch(`${iae}/areahc/form-options-complete`);if(D.ok){const W=await D.json();v(B=>({...B,...W}))}else console.error("Error fetching form options:",D.status)}catch(D){console.error("Error fetching form options:",D)}finally{x(!1)}})()},[]),S.useEffect(()=>{if(i.bct_min_lb){const F=i.bct_min_lb*.453592;s(D=>({...D,bct_min_kg:parseFloat(F.toFixed(2))}))}},[i.bct_min_lb]),S.useEffect(()=>{t&&t!==i.planta_id&&s(F=>({...F,planta_id:t}))},[t]);const y=S.useCallback(F=>{const{name:D,value:W,type:B}=F.target;let G=W;B==="number"?G=W===""?null:parseFloat(W):F.target.tagName==="SELECT"&&(G=W===""?null:parseInt(W)),s(Y=>({...Y,[D]:G})),o[D]&&l(Y=>{const ae={...Y};return delete ae[D],ae})},[o]),j=S.useCallback(F=>{const{name:D,value:W}=F.target;s(B=>({...B,[D]:W}))},[]),k=S.useCallback(()=>{const F={};return b?(i.carton_id||(F.carton_id="Seleccione un cartn"),(!i.area_hc||i.area_hc<=0)&&(F.area_hc="El rea HC es requerida"),(!i.anchura||i.anchura<=0)&&(F.anchura="El ancho hoja madre es requerido"),(!i.largura||i.largura<=0)&&(F.largura="El largo hoja madre es requerido"),(i.numero_colores===null||i.numero_colores===void 0)&&(F.numero_colores="Seleccione nmero de colores"),i.process_id||(F.process_id="Seleccione un proceso"),(!i.cantidad||i.cantidad<=0)&&(F.cantidad="La cantidad debe ser mayor a 0"),i.product_type_id||(F.product_type_id="Seleccione un tipo de item"),(i.cinta_desgarro===null||i.cinta_desgarro===void 0)&&(F.cinta_desgarro="Seleccione cinta desgarro"),(i.zuncho===null||i.zuncho===void 0)&&(F.zuncho="Seleccione zunchos"),i.rubro_id||(F.rubro_id="Seleccione un rubro"),i.ciudad_id||(F.ciudad_id="Seleccione una ciudad")):((!i.cantidad_esquinero||i.cantidad_esquinero<=0)&&(F.cantidad_esquinero="La cantidad debe ser mayor a 0"),i.carton_esquinero_id||(F.carton_esquinero_id="Seleccione un cartn")),l(F),Object.keys(F).length===0},[i,b]),E=S.useCallback(()=>{k()&&r(i)},[i,k,r]),A=S.useCallback(()=>{s({...ET,planta_id:t||1}),l({})},[t]),w=S.useCallback(()=>{f("carton"),u(!0)},[]),P=S.useCallback(()=>{f("calculo_hc"),u(!0)},[]),M=S.useCallback(F=>{s(D=>({...D,...F.interno_largo!==void 0&&F.interno_largo!==null&&{largo:F.interno_largo},...F.interno_ancho!==void 0&&F.interno_ancho!==null&&{ancho:F.interno_ancho},...F.interno_alto!==void 0&&F.interno_alto!==null&&{alto:F.interno_alto},...F.areahc!==void 0&&F.areahc!==null&&{area_hc:F.areahc},...F.codigo_carton_id!==void 0&&F.codigo_carton_id!==null&&{carton_id:F.codigo_carton_id},...F.rubro_id!==void 0&&F.rubro_id!==null&&{rubro_id:F.rubro_id},...F.process_id!==void 0&&F.process_id!==null&&{process_id:F.process_id},...F.product_type_id!==void 0&&F.product_type_id!==null&&{product_type_id:F.product_type_id},...F.numero_colores!==void 0&&F.numero_colores!==null&&{numero_colores:F.numero_colores}})),u(!1)},[]);return a.jsxs(oae,{children:[a.jsxs(lae,{children:[a.jsxs(cae,{children:[a.jsx(dae,{children:_?"Editar Detalle":"Crear Detalle"}),a.jsx(uae,{onClick:n,children:""})]}),a.jsxs(hae,{children:[g&&a.jsx("div",{style:{textAlign:"center",padding:"10px",color:"#666"},children:"Cargando opciones..."}),a.jsxs(Md,{children:[a.jsx(ac,{children:"SELECCIONAR TIPO DE PRODUCTO"}),a.jsx(Od,{style:{padding:"4px 20px"},children:a.jsx(di,{children:a.jsx(tr,{$size:4,$offset:4,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Producto"}),a.jsxs(ut,{name:"tipo_detalle_id",value:i.tipo_detalle_id,onChange:y,children:[a.jsx("option",{value:1,children:"Corrugado"}),a.jsx("option",{value:2,children:"Esquinero"})]})]})})})})]}),a.jsxs(Md,{children:[a.jsx(ac,{$center:!0,children:b?"CORRUGADO":"ESQUINERO"}),a.jsx(ac,{children:"Caracteristicas"}),a.jsxs(Od,{children:[b&&a.jsx(di,{style:{marginBottom:"16px"},children:a.jsx(tr,{$size:4,children:a.jsx(pae,{type:"button",children:"Buscar por Material "})})}),b?a.jsxs(di,{children:[a.jsxs(tr,{$size:4,children:[a.jsx(Be,{children:a.jsxs(ST,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Cartn ",o.carton_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"carton_id",value:i.carton_id||"",onChange:y,$hasError:!!o.carton_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cartons.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.carton_id&&a.jsx(ua,{children:o.carton_id})]}),a.jsx(kT,{type:"button",style:{marginTop:"20px"},onClick:w,children:"Estimacin Cartn"})]})}),a.jsx(Be,{children:a.jsxs(ST,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Area HC (m2): ",o.area_hc&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(cr,{type:"number",name:"area_hc",value:i.area_hc??"",onChange:y,min:0,max:99,$hasError:!!o.area_hc}),o.area_hc&&a.jsx(ua,{children:o.area_hc})]}),a.jsx(kT,{type:"button",style:{marginTop:"20px"},onClick:P,children:"Clculo AHC"})]})}),a.jsx(Be,{children:a.jsxs($T,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Ancho Hoja Madre (mm): ",o.anchura&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(cr,{type:"number",name:"anchura",value:i.anchura??"",onChange:y,$hasError:!!o.anchura}),o.anchura&&a.jsx(ua,{children:o.anchura})]}),a.jsx(CT,{title:"Ver imagen de referencia",children:"?"})]})}),a.jsx(Be,{children:a.jsxs($T,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Largo Hoja Madre (mm): ",o.largura&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(cr,{type:"number",name:"largura",value:i.largura??"",onChange:y,$hasError:!!o.largura}),o.largura&&a.jsx(ua,{children:o.largura})]}),a.jsx(CT,{title:"Ver imagen de referencia",children:"?"})]})}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Tipo item ",o.product_type_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"product_type_id",value:i.product_type_id||"",onChange:y,$hasError:!!o.product_type_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.product_types.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.product_type_id&&a.jsx(ua,{children:o.product_type_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Mquina Impresora"}),a.jsxs(ut,{name:"printing_machine_id",value:i.printing_machine_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.printing_machines.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Impresin"}),a.jsxs(ut,{name:"print_type_id",value:i.print_type_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.print_types.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Nmero Colores ",o.numero_colores&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"numero_colores",value:i.numero_colores??"",onChange:y,$hasError:!!o.numero_colores,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),[0,1,2,3,4,5,6].map(F=>a.jsx("option",{value:F,children:F},F))]}),o.numero_colores&&a.jsx(ua,{children:o.numero_colores})]}),a.jsxs(di,{children:[a.jsx(tr,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Golpes largo:"}),a.jsx(cr,{type:"number",name:"golpes_largo",value:i.golpes_largo,onChange:y,min:0,max:20})]})}),a.jsx(tr,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Golpes ancho:"}),a.jsx(cr,{type:"number",name:"golpes_ancho",value:i.golpes_ancho,onChange:y,min:0,max:20})]})})]})]}),a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Proceso ",o.process_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"process_id",value:i.process_id||"",onChange:y,$hasError:!!o.process_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.processes.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.process_id&&a.jsx(ua,{children:o.process_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Pegado"}),a.jsxs(ut,{name:"pegado_id",value:i.pegado_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.pegados.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cinta Desgarro ",o.cinta_desgarro&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"cinta_desgarro",value:i.cinta_desgarro??"",onChange:y,$hasError:!!o.cinta_desgarro,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]}),o.cinta_desgarro&&a.jsx(ua,{children:o.cinta_desgarro})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Barniz"}),a.jsxs(ut,{name:"barniz",value:i.barniz??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Barniz"}),a.jsxs(ut,{name:"barniz_type_id",value:i.barniz_type_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.barniz_types.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cobertura color (%):"}),a.jsx(cr,{type:"number",name:"cobertura_color_percent",value:i.cobertura_color_percent,onChange:y,min:0})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cobertura barniz (cm2):"}),a.jsx(cr,{type:"number",name:"cobertura_barniz_cm2",value:i.cobertura_barniz_cm2,onChange:y,min:0})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse por un golpe (cm2):"}),a.jsx(cr,{type:"number",name:"cobertura_color_cm2",value:i.cobertura_color_cm2,onChange:y,min:0})]})]}),a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Pallet"}),a.jsx(ut,{name:"pallet",value:i.pallet,onChange:y,children:m.pallets.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Altura Pallet"}),a.jsxs(ut,{name:"pallet_height_id",value:i.pallet_height_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.pallet_heights.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Zunchos ",o.zuncho&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"zuncho",value:i.zuncho??"",onChange:y,$hasError:!!o.zuncho,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.zunchos.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.zuncho&&a.jsx(ua,{children:o.zuncho})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Funda"}),a.jsxs(ut,{name:"funda",value:i.funda,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Strech Film"}),a.jsxs(ut,{name:"stretch_film",value:i.stretch_film,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Ensamblado"}),a.jsxs(ut,{name:"ensamblado",value:i.ensamblado??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Desgajado Cabezal"}),a.jsxs(ut,{name:"desgajado_cabezal",value:i.desgajado_cabezal??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Rubro ",o.rubro_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"rubro_id",value:i.rubro_id||"",onChange:y,$hasError:!!o.rubro_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.rubros.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.rubro_id&&a.jsx(ua,{children:o.rubro_id})]})]})]}):a.jsx(di,{children:a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Largo o medida (m):"}),a.jsx(cr,{type:"number",name:"largo_esquinero",value:i.largo_esquinero??"",onChange:y,min:0,max:3})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cartn ",o.carton_esquinero_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"carton_esquinero_id",value:i.carton_esquinero_id||"",onChange:y,$hasError:!!o.carton_esquinero_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cartons_esquinero.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.carton_esquinero_id&&a.jsx(ua,{children:o.carton_esquinero_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Nmero Colores"}),a.jsxs(ut,{name:"numero_colores_esquinero",value:i.numero_colores_esquinero??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),[0,1,2].map(F=>a.jsx("option",{value:F,children:F},F))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Incluye funda?"}),a.jsxs(ut,{name:"funda_esquinero",value:i.funda_esquinero??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})})]})]}),b&&a.jsxs(di,{children:[a.jsx(tr,{$size:8,children:a.jsxs(Md,{style:{height:"100%"},children:[a.jsx(ac,{children:"CAMPOS OPCIONALES (DATOS PARA INCLUIR EN LA CARTA DE OFERTA)"}),a.jsx(Od,{children:a.jsxs(di,{children:[a.jsxs(tr,{$size:6,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Medidas"}),a.jsxs(ut,{name:"tipo_medida",value:i.tipo_medida,onChange:y,children:[a.jsx("option",{value:1,children:"Internas"}),a.jsx("option",{value:2,children:"Externas"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Largo (mm):"}),a.jsx(cr,{type:"number",name:"largo",value:i.largo??"",onChange:y})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Ancho (mm):"}),a.jsx(cr,{type:"number",name:"ancho",value:i.ancho??"",onChange:y})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Alto (mm):"}),a.jsx(cr,{type:"number",name:"alto",value:i.alto??"",onChange:y})]}),a.jsxs(di,{children:[a.jsx(tr,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"BCT MIN (LB):"}),a.jsx(cr,{type:"number",name:"bct_min_lb",value:i.bct_min_lb||"",onChange:y})]})}),a.jsx(tr,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"BCT MIN (KG):"}),a.jsx(cr,{type:"text",value:i.bct_min_kg||"",readOnly:!0})]})})]})]}),a.jsxs(tr,{$size:6,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Descripcin (material):"}),a.jsx(cr,{type:"text",name:"descripcion_material_detalle",value:i.descripcion_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"CAD (material):"}),a.jsx(cr,{type:"text",name:"cad_material_detalle",value:i.cad_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cod. interno cliente:"}),a.jsx(cr,{type:"text",name:"codigo_cliente",value:i.codigo_cliente,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clusula Devolucin de Pallets"}),a.jsxs(ut,{name:"devolucion_pallets",value:i.devolucion_pallets,onChange:y,children:[a.jsx("option",{value:1,children:"Si"}),a.jsx("option",{value:0,children:"No"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clusula Ajuste de Precios"}),a.jsxs(ut,{name:"ajuste_precios",value:i.ajuste_precios,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})]})})]})}),a.jsx(tr,{$size:4,children:a.jsxs(Md,{style:{height:"100%"},children:[a.jsx(ac,{children:"CAMPOS OPCIONALES (SOLO EN CASO QUE SE QUIERA CONVERTIR COTIZACIN A OT)"}),a.jsxs(Od,{children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cdigo (material):"}),a.jsx(cr,{type:"text",name:"codigo_material_detalle",value:i.codigo_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 1"}),a.jsxs(ut,{name:"hierarchy_id",value:i.hierarchy_id||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.hierarchies.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 2"}),a.jsx(ut,{name:"subhierarchy_id",value:i.subhierarchy_id||"",onChange:y,children:a.jsx("option",{value:"",children:"Seleccionar..."})})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 3"}),a.jsx(ut,{name:"subsubhierarchy_id",value:i.subsubhierarchy_id||"",onChange:y,children:a.jsx("option",{value:"",children:"Seleccionar..."})})]})]})]})})]}),a.jsxs(Md,{children:[a.jsx(ac,{children:"Servicios"}),a.jsx(Od,{children:b?a.jsxs(di,{children:[a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Matriz"}),a.jsxs(ut,{name:"matriz",value:i.matriz??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse"}),a.jsxs(ut,{name:"clisse",value:i.clisse,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Royalty"}),a.jsxs(ut,{name:"royalty",value:i.royalty,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]}),a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Maquila"}),a.jsxs(ut,{name:"maquila",value:i.maquila,onChange:y,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cuchillos y gomas (m):"}),a.jsx(cr,{type:"number",name:"cuchillos_gomas",value:i.cuchillos_gomas??"",onChange:y})]})]}),a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Armado"}),a.jsxs(ut,{name:"armado_automatico",value:i.armado_automatico??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Armado (US$/UN):"}),a.jsx(cr,{type:"number",name:"armado_usd_caja",value:i.armado_usd_caja??"",onChange:y})]})]})]}):a.jsx(di,{children:a.jsxs(tr,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo Destino (palletizado)"}),a.jsxs(ut,{name:"tipo_destino_esquinero",value:i.tipo_destino_esquinero||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.tipo_destino_esquinero.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo Camin"}),a.jsxs(ut,{name:"tipo_camion_esquinero",value:i.tipo_camion_esquinero||"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.tipo_camion_esquinero.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Maquila"}),a.jsxs(ut,{name:"maquila_esquinero",value:i.maquila_esquinero??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse"}),a.jsxs(ut,{name:"clisse_esquinero",value:i.clisse_esquinero??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})})})]}),a.jsxs(Md,{children:[a.jsx(ac,{children:"Destino"}),a.jsxs(Od,{children:[a.jsxs(di,{children:[a.jsx(tr,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Lugar de Destino ",o.ciudad_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(ut,{name:"ciudad_id",value:i.ciudad_id||"",onChange:y,$hasError:!!o.ciudad_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cities.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))]}),o.ciudad_id&&a.jsx(ua,{children:o.ciudad_id})]})}),b&&a.jsxs(a.Fragment,{children:[a.jsx(tr,{$size:3,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Pallets Apilados"}),a.jsxs(ut,{name:"pallets_apilados",value:i.pallets_apilados??"",onChange:y,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:1,children:"1"}),a.jsx("option",{value:2,children:"2"})]})]})}),a.jsx(tr,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cantidad (UN): ",o.cantidad&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(cr,{type:"number",name:"cantidad",value:i.cantidad??"",onChange:y,min:1,$hasError:!!o.cantidad}),o.cantidad&&a.jsx(ua,{children:o.cantidad})]})})]}),!b&&a.jsx(tr,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cantidad (UN): ",o.cantidad_esquinero&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(cr,{type:"number",name:"cantidad_esquinero",value:i.cantidad_esquinero??"",onChange:y,min:1,$hasError:!!o.cantidad_esquinero}),o.cantidad_esquinero&&a.jsx(ua,{children:o.cantidad_esquinero})]})})]}),a.jsx(di,{style:{marginTop:"16px"},children:a.jsx(tr,{$size:12,style:{textAlign:"center"},children:a.jsx(Kw,{type:"button",children:"Agregar Destino"})})})]})]}),a.jsxs("div",{style:{marginTop:"16px",textAlign:"right"},children:[a.jsx(fae,{onClick:A,style:{marginRight:"8px"},children:"Limpiar"}),a.jsx(Kw,{onClick:E,children:"Guardar Detalle"})]})]})]}),c&&a.jsx(aae,{mode:h,onClose:()=>u(!1),onApply:M})]})}const gae=p.div`
  padding: 1.5rem;
  max-width: 100%;
  background: #f5f5f5;
  min-height: calc(100vh - 60px);
`,xae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1.5rem;
`,vae=p.div``,_ae=p.button`
  background: none;
  border: none;
  color: #17a2b8;
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,yae=p.h1`
  font-size: 1.5rem;
  font-weight: 400;
  color: #333;
  margin: 0;
`,bae=p.div`
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 0.5rem;
`,qm=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  color: #666;
`,Km=p.span`
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: #17a2b8;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: 600;
`,Ky=p.div`
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 1.5rem;
`,TT=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid #ddd;
  background: #fafafa;
`,Xy=p.h3`
  font-size: 0.8rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  margin: 0;
  letter-spacing: 0.5px;
`,Yy=p.div`
  padding: 1rem;
`,jae=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,wae=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-top: 1rem;
`,ic=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,sc=p.label`
  font-size: 0.7rem;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Qy=p.select`
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }
`,Jy=p.input`
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }

  &:disabled {
    background: #f5f5f5;
    color: #666;
  }
`,kae=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,Cae=p.input`
  width: 16px;
  height: 16px;
  accent-color: #17a2b8;
`,Sae=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #17a2b8;
  color: white;
  font-size: 0.7rem;
  cursor: help;
`,$ae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid #ddd;
  background: #fafafa;
`,Eae=p.div`
  display: flex;
  gap: 0.5rem;
`,Xh=p.button`
  padding: 0.45rem 1rem;
  border-radius: 4px;
  font-size: 0.85rem;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;

  ${e=>{switch(e.$variant){case"primary":return`
          background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
          color: white;
          border: none;
          &:hover { background: linear-gradient(135deg, #138496 0%, #117a8b 100%); }
        `;case"success":return`
          background: linear-gradient(135deg, #28a745 0%, #218838 100%);
          color: white;
          border: none;
          &:hover { background: linear-gradient(135deg, #218838 0%, #1e7e34 100%); }
        `;case"outline":return`
          background: white;
          color: #17a2b8;
          border: 1px solid #17a2b8;
          &:hover { background: #f0f9fa; }
        `;case"danger":return`
          background: #dc3545;
          color: white;
          border: none;
          &:hover { background: #c82333; }
        `;default:return`
          background: #f0f0f0;
          color: #333;
          border: 1px solid #ddd;
          &:hover { background: #e0e0e0; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Tae=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,$r=p.th`
  background: linear-gradient(135deg, #343a40 0%, #23272b 100%);
  color: white;
  padding: 0.6rem 0.4rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.7rem;
  white-space: nowrap;
  border: none;
`,Er=p.td`
  padding: 0.5rem 0.4rem;
  border-bottom: 1px solid #eee;
  vertical-align: middle;
  text-align: center;
  font-size: 0.8rem;
  color: #333;
`,Aae=p.tr`
  &:hover {
    background: #f8f9fa;
  }
`,Fae=p.div`
  text-align: center;
  padding: 2rem;
  color: #666;
`,Dae=p.div`
  display: flex;
  align-items: center;
  gap: 2rem;
  flex-wrap: wrap;
`,Zy=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,eb=p.span`
  font-size: 0.75rem;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
`,AT=p.select`
  padding: 0.4rem 0.75rem;
  border: none;
  border-bottom: 1px solid #17a2b8;
  font-size: 0.85rem;
  background: transparent;
  color: #333;

  &:focus {
    outline: none;
    border-bottom-color: #138496;
  }
`,Pae=p.input`
  padding: 0.4rem 0.5rem;
  border: none;
  border-bottom: 1px solid #17a2b8;
  font-size: 0.85rem;
  width: 80px;
  background: transparent;

  &:focus {
    outline: none;
    border-bottom-color: #138496;
  }
`,Mae=p.span`
  font-size: 0.7rem;
  color: #666;
`,Oae=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,FT=p.div`
  border: 1px solid #ddd;
  border-radius: 4px;
`,DT=p.div`
  padding: 0.5rem 0.75rem;
  background: #fafafa;
  border-bottom: 1px solid #ddd;
  font-size: 0.75rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
`,PT=p.div`
  padding: 0;
`,MT=p.textarea`
  width: 100%;
  min-height: 80px;
  padding: 0.75rem;
  border: none;
  font-size: 0.85rem;
  resize: vertical;

  &:focus {
    outline: none;
  }
`,OT=p.div`
  color: #dc3545;
  font-size: 0.85rem;
  margin-top: 1rem;
`,RT=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,NT=p.div`
  padding: 1rem;
  border-radius: 4px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,zT=p.button`
  width: 26px;
  height: 26px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  background: ${e=>e.$color||"#6c757d"};
  color: white;
  margin: 0 2px;

  &:hover {
    opacity: 0.85;
  }
`,Rae=p.div`
  margin-top: 2rem;
  border-top: 2px solid #28a745;
  padding-top: 1rem;
`,Nae=p.h1`
  font-size: 1.3rem;
  font-weight: 500;
  color: #333;
  margin-bottom: 1.5rem;
`,Xm=p.div`
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 1rem;
`,Ym=p.div`
  padding: 0.5rem 1rem;
  background: #28a745;
  color: white;
  font-size: 0.9rem;
  font-weight: 500;
`,Qm=p.div`
  padding: 0;
`,Jm=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;

  th, td {
    border: 1px solid #dee2e6;
    padding: 0.4rem 0.5rem;
    text-align: left;
  }

  th {
    background: #f8f9fa;
    font-weight: 600;
    color: #495057;
    white-space: nowrap;
  }

  td {
    vertical-align: middle;
  }

  tbody tr:hover {
    background: #f1f3f5;
  }
`,zae=p.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 2rem;
`,Iae=p.button`
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  font-weight: 500;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;

  &:hover {
    background: #218838;
  }

  &:disabled {
    background: #6c757d;
    cursor: not-allowed;
  }
`,Lae=[{id:1,codigo:"USD",nombre:"Dolar"},{id:2,codigo:"CLP",nombre:"Peso Chileno"}];function Zm({cotizacionId:e,onNavigate:t,isExterno:r=!1}){const n=!!e,i=r?"cotizador-externo":"cotizaciones",[s,o]=S.useState({cliente_id:null,instalacion_id:null,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",clasificacion_id:null,moneda_id:1,dias_pago:0,comision:2,observacion_interna:"",observacion_cliente:"",detalles:[],detallesData:[]}),[l,c]=S.useState(!0),[u,h]=S.useState(!1),[f,m]=S.useState(null),[v,g]=S.useState(null),[x,_]=S.useState(null),[b,y]=S.useState(!1),[j]=S.useState(!1),[k]=S.useState(!1),[E,A]=S.useState(!1),[w,P]=S.useState(null),[M,F]=S.useState(!1),{data:D,isLoading:W}=zt({queryKey:["clients-for-cotizacion"],queryFn:async()=>(await Hl.list({page_size:2e3,activo:!0})).items,staleTime:5*60*1e3}),B=S.useMemo(()=>[...D||[]].sort((se,ke)=>{const V=se.codigo?parseInt(se.codigo,10):1/0,Ve=ke.codigo?parseInt(ke.codigo,10):1/0;return isNaN(V)&&isNaN(Ve)?0:isNaN(V)?1:isNaN(Ve)?-1:V-Ve}),[D]),{data:G,isLoading:Y}=zt({queryKey:["instalaciones-cotiza",s.cliente_id],queryFn:async()=>s.cliente_id?pu.getInstalacionesClienteCotiza(s.cliente_id):{instalaciones:[],clasificacion_id:null},enabled:!!s.cliente_id}),ae=(G==null?void 0:G.instalaciones)||[],{data:U,isLoading:q}=zt({queryKey:["contactos",s.cliente_id,s.instalacion_id],queryFn:async()=>s.cliente_id?pu.getContactosCliente(s.cliente_id,s.instalacion_id||void 0):[],enabled:!!s.cliente_id}),z=U||[];S.useEffect(()=>{e&&console.log("Loading cotizacion:",e)},[e]),S.useEffect(()=>{G!=null&&G.clasificacion_id&&!s.clasificacion_id&&o(L=>({...L,clasificacion_id:G.clasificacion_id||null}))},[G,s.clasificacion_id]),S.useEffect(()=>{if(!n||!e)return;(async()=>{try{const se=await Fn.get(e);console.log("Loaded cotizacion:",se);const ke=(se.detalles||[]).map((V,Ve)=>({id:V.id,numero:Ve+1,descripcion:V.descripcion_material_detalle||`Detalle ${Ve+1}`,cad_id:V.cad_material_id||null,cad_nombre:V.cad_material_detalle||"-",tipo_producto_id:V.tipo_detalle_id,tipo_producto_nombre:V.tipo_detalle_id===1?"Corrugado":"Esquinero",cantidad:V.cantidad||0,area:V.area_hc?parseFloat(String(V.area_hc)):0,carton_id:V.carton_id||null,carton_nombre:V.carton_codigo||(V.carton_id?`Carton ${V.carton_id}`:"-"),item:"-",proceso_id:V.process_id||null,proceso_nombre:V.proceso_nombre||"-",colores:V.numero_colores||0,pct_impresion:Number(V.impresion)||0,pct_cobertura:0,matriz:V.matriz?"Si":"-",clisse:V.clisse?"Si":"-",royalty:V.royalty||0,maquila:V.maquila||0,armado:V.armado_automatico?"Auto":"-",ot_id:V.work_order_id||null,muestra:!1}));o(V=>({...V,cliente_id:se.client_id,nombre_contacto:se.nombre_contacto||"",email_contacto:se.email_contacto||"",telefono_contacto:se.telefono_contacto||"",moneda_id:se.moneda_id||1,dias_pago:se.dias_pago||0,comision:se.comision||2,observacion_interna:se.observacion_interna||"",observacion_cliente:se.observacion_cliente||"",detalles:ke,detallesData:se.detalles||[]}))}catch(se){console.error("Error loading cotizacion:",se),_("Error al cargar la cotizacin")}})()},[n,e]);const ie=S.useCallback(L=>{o(se=>({...se,cliente_id:L,instalacion_id:null,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",clasificacion_id:null}))},[]),he=S.useCallback(L=>{o(se=>({...se,instalacion_id:L,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:""}))},[]),O=S.useCallback(L=>{const se=z.find(ke=>ke.id===L);o(ke=>({...ke,contacto_id:L,nombre_contacto:(se==null?void 0:se.nombre)||ke.nombre_contacto,email_contacto:(se==null?void 0:se.email)||"",telefono_contacto:(se==null?void 0:se.telefono)||""}))},[z]),R=S.useCallback((L,se)=>{o(ke=>({...ke,[L]:se}))},[]),I=S.useCallback(()=>{m(null),h(!0)},[]),K=S.useCallback(L=>{m(L),h(!0)},[]),ne=S.useCallback(L=>{window.confirm("Est seguro de eliminar este detalle?")&&o(se=>({...se,detalles:se.detalles.filter((ke,V)=>V!==L),detallesData:se.detallesData.filter((ke,V)=>V!==L)}))},[]),ee=S.useCallback(L=>{const se={numero:s.detalles.length+1,descripcion:L.descripcion||`Detalle ${s.detalles.length+1}`,cad_id:L.cad_id,cad_nombre:L.cad_id?`CAD-${L.cad_id}`:"-",tipo_producto_id:L.tipo_detalle_id,tipo_producto_nombre:L.tipo_detalle_id===1?"Corrugado":"Esquinero",cantidad:L.cantidad||0,area:L.area_hc||0,carton_id:L.carton_id,carton_nombre:L.carton_id?`Carton ${L.carton_id}`:"-",item:"-",proceso_id:L.process_id,proceso_nombre:L.process_id?`Proceso ${L.process_id}`:"-",colores:L.colores||0,pct_impresion:L.pct_impresion||0,pct_cobertura:L.pct_cobertura||0,matriz:"-",clisse:"-",royalty:0,maquila:0,armado:"-",ot_id:null,muestra:!1};o(ke=>{if(f){const V=ke.detalles.findIndex(Ve=>Ve.numero===f.numero);if(V>=0){const Ve=[...ke.detalles];Ve[V]={...se,numero:f.numero};const Ke=[...ke.detallesData];return Ke[V]=L,{...ke,detalles:Ve,detallesData:Ke}}}return{...ke,detalles:[...ke.detalles,se],detallesData:[...ke.detallesData,L]}}),h(!1),m(null)},[s.detalles.length,f]),ge=S.useCallback(async()=>{if(!s.cliente_id){_("Debe seleccionar un cliente");return}const L=mo.getStoredUser();if(!L){_("No hay usuario autenticado");return}y(!0),_(null);try{const se={client_id:s.cliente_id,nombre_contacto:s.nombre_contacto||void 0,email_contacto:s.email_contacto||void 0,telefono_contacto:s.telefono_contacto||void 0,moneda_id:s.moneda_id||void 0,dias_pago:s.dias_pago||void 0,comision:s.comision||void 0,observacion_interna:s.observacion_interna||void 0,observacion_cliente:s.observacion_cliente||void 0,user_id:L.id};console.log("Saving cotizacion:",se);let ke;if(n&&e)await Fn.update(e,se),ke=e,g("Cotizacin actualizada correctamente");else{const V=await Fn.create(se);if(ke=V.id,console.log("Cotizacion created:",V),s.detallesData.length>0){console.log(`Saving ${s.detallesData.length} detalles...`);let Ve=0;const Ke=[];for(const ye of s.detallesData)try{const T={tipo_detalle_id:ye.tipo_detalle_id||1,cantidad:ye.cantidad||1,product_type_id:ye.product_type_id||1,planta_id:ye.planta_id||1,variable_cotizador_id:ye.variable_cotizador_id||1,numero_colores:ye.numero_colores,largo:ye.largo,ancho:ye.ancho,alto:ye.alto,area_hc:ye.area_hc,anchura:ye.anchura,largura:ye.largura,carton_id:ye.carton_id,impresion:ye.impresion,golpes_largo:ye.golpes_largo,golpes_ancho:ye.golpes_ancho,process_id:ye.process_id,rubro_id:ye.rubro_id,printing_machine_id:ye.printing_machine_id,print_type_id:ye.print_type_id,ink_type_id:ye.ink_type_id,barniz_type_id:ye.barniz_type_id,pegado_id:ye.pegado_id,cinta_desgarro:ye.cinta_desgarro,matriz:ye.matriz,clisse:ye.clisse,royalty:ye.royalty,maquila:ye.maquila,maquila_servicio_id:ye.maquila_servicio_id,armado_automatico:ye.armado_automatico,armado_usd_caja:ye.armado_usd_caja,pallet:ye.pallet,pallet_height_id:ye.pallet_height_id,zuncho:ye.zuncho,funda:ye.funda,stretch_film:ye.stretch_film,ciudad_id:ye.ciudad_id,margen:ye.margen,descripcion_material_detalle:ye.descripcion_material_detalle,cad_material_id:ye.cad_material_id,largo_esquinero:ye.largo_esquinero,carton_esquinero_id:ye.carton_esquinero_id};await Fn.createDetalle(ke,T),Ve++}catch(T){console.error("Error saving detalle:",T),Ke.push(`Error en detalle ${Ve+1}`)}Ke.length>0?g(`Pre-Cotizacin generada. ${Ve}/${s.detallesData.length} detalles guardados.`):g(`Pre-Cotizacin generada con ${Ve} detalle(s)`)}else g("Pre-Cotizacin generada correctamente")}F(!0);try{const V=await Fn.getCostosResumen(ke);P(V),A(!0)}catch(V){console.error("Error fetching cost summary:",V)}finally{F(!1)}}catch(se){console.error("Error saving cotizacion:",se),_("Error al guardar la cotizacin")}finally{y(!1)}},[s,n,e,t,i]);return u?a.jsx(mae,{detalle:null,plantaId:1,onSubmit:ee,onCancel:()=>{h(!1),m(null)}}):a.jsxs(gae,{children:[a.jsxs(xae,{children:[a.jsxs(vae,{children:[a.jsx(_ae,{onClick:()=>t(i),children:"< Volver"}),a.jsx(yae,{children:n?`Editar Cotizacin #${e}`:"Ingreso Cotizacin"})]}),a.jsxs(bae,{children:[a.jsxs(qm,{children:[a.jsx("span",{children:"Seleccionar Cliente"}),a.jsx(Km,{children:"1"})]}),a.jsxs(qm,{children:[a.jsx("span",{children:"Agregar Detalles"}),a.jsx(Km,{children:"2"})]}),a.jsxs(qm,{children:[a.jsx("span",{children:"Completar Cotizacin"}),a.jsx(Km,{children:"3"})]}),a.jsxs(qm,{children:[a.jsx("span",{children:"Guardar Cotizacin"}),a.jsx(Km,{children:"4"})]})]})]}),v&&a.jsx(NT,{$type:"success",children:v}),x&&a.jsx(NT,{$type:"error",children:x}),a.jsxs(Ky,{children:[a.jsx(TT,{children:a.jsx(Xy,{children:"Datos Comerciales"})}),a.jsxs(Yy,{children:[a.jsxs(jae,{children:[a.jsxs(ic,{children:[a.jsx(sc,{children:"Cliente"}),a.jsx(Ow,{options:B,value:s.cliente_id,onChange:L=>ie(L),getOptionValue:L=>L.id,getOptionLabel:L=>`${L.nombre_sap}${L.codigo?` - ${L.codigo}`:""}`,placeholder:"Seleccionar...",disabled:W,loading:W})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Instalacin"}),a.jsxs(Qy,{value:s.instalacion_id||"",onChange:L=>he(L.target.value?Number(L.target.value):null),disabled:!s.cliente_id||Y,children:[a.jsx("option",{value:"",children:Y?"Cargando...":"-"}),ae.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))]})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Contactos"}),a.jsxs(Qy,{value:s.contacto_id||"",onChange:L=>O(L.target.value?Number(L.target.value):null),disabled:!s.cliente_id||q,children:[a.jsx("option",{value:"",children:q?"Cargando...":"-"}),z.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))]})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Nombre:"}),a.jsxs(kae,{children:[a.jsx(Cae,{type:"checkbox",checked:l,onChange:L=>c(L.target.checked)}),a.jsx(Jy,{value:s.nombre_contacto,onChange:L=>R("nombre_contacto",L.target.value),disabled:!l,placeholder:"Nombre contacto"}),a.jsx(Sae,{title:"Puede ingresar nombre personalizado",children:"?"})]})]})]}),a.jsxs(wae,{children:[a.jsxs(ic,{children:[a.jsx(sc,{children:"Email:"}),a.jsx(Jy,{value:s.email_contacto,onChange:L=>R("email_contacto",L.target.value),disabled:!0})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Telfono:"}),a.jsx(Jy,{value:s.telefono_contacto,onChange:L=>R("telefono_contacto",L.target.value),disabled:!0})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Clasificacin"}),a.jsxs(Qy,{value:s.clasificacion_id||"",onChange:L=>R("clasificacion_id",L.target.value?Number(L.target.value):null),disabled:!!s.cliente_id,children:[a.jsx("option",{value:"",children:"-"}),(G==null?void 0:G.clasificacion_id)&&a.jsx("option",{value:G.clasificacion_id,children:G.clasificacion_nombre||"Sin clasificacin"})]})]})]})]})]}),a.jsxs(Ky,{children:[a.jsxs($ae,{children:[a.jsx(Xy,{children:"Detalles"}),a.jsxs(Eae,{children:[a.jsx(Xh,{$variant:"outline",children:"Carga Masiva"}),a.jsx(Xh,{$variant:"success",onClick:I,children:"Crear Detalle +"})]})]}),a.jsx(Yy,{style:{padding:0},children:s.detalles.length===0?a.jsxs(Fae,{children:[a.jsx("p",{children:"No hay detalles agregados"}),a.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:'Haga clic en "Crear Detalle +" para agregar items'})]}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs(Tae,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx($r,{children:"N"}),a.jsx($r,{children:"Descrip."}),a.jsx($r,{children:"CAD"}),a.jsx($r,{children:"Tipo Producto"}),a.jsx($r,{children:"Cantidad"}),a.jsx($r,{children:"rea"}),a.jsx($r,{children:"Cartn"}),a.jsx($r,{children:"Item"}),a.jsx($r,{children:"Proceso"}),a.jsx($r,{children:"Colores"}),a.jsx($r,{children:"% Impr."}),a.jsx($r,{children:"%Cob."}),a.jsx($r,{children:"Matriz"}),a.jsx($r,{children:"Clisse"}),a.jsx($r,{children:"Royalty"}),a.jsx($r,{children:"Maquila"}),a.jsx($r,{children:"Armado"}),a.jsx($r,{children:"OT"}),a.jsx($r,{}),a.jsx($r,{children:"Acciones"})]})}),a.jsx("tbody",{children:s.detalles.map((L,se)=>a.jsxs(Aae,{children:[a.jsx(Er,{children:L.numero}),a.jsx(Er,{children:L.descripcion}),a.jsx(Er,{children:L.cad_nombre}),a.jsx(Er,{children:L.tipo_producto_nombre}),a.jsx(Er,{children:L.cantidad.toLocaleString()}),a.jsx(Er,{children:L.area.toFixed(2)}),a.jsx(Er,{children:L.carton_nombre}),a.jsx(Er,{children:L.item}),a.jsx(Er,{children:L.proceso_nombre}),a.jsx(Er,{children:L.colores}),a.jsxs(Er,{children:[L.pct_impresion,"%"]}),a.jsxs(Er,{children:[L.pct_cobertura,"%"]}),a.jsx(Er,{children:L.matriz}),a.jsx(Er,{children:L.clisse}),a.jsx(Er,{children:L.royalty}),a.jsx(Er,{children:L.maquila}),a.jsx(Er,{children:L.armado}),a.jsx(Er,{children:L.ot_id||"-"}),a.jsx(Er,{children:L.muestra?"":""}),a.jsxs(Er,{children:[a.jsx(zT,{$color:"#ffc107",onClick:()=>K(L),title:"Editar",children:""}),a.jsx(zT,{$color:"#dc3545",onClick:()=>ne(se),title:"Eliminar",children:""})]})]},se))})]})})})]}),a.jsxs(Ky,{children:[a.jsx(TT,{children:a.jsx(Xy,{children:"Moneda - Das Pago - % Comisin"})}),a.jsx(Yy,{children:a.jsxs(Dae,{children:[a.jsxs(Zy,{children:[a.jsx(eb,{children:"Moneda"}),a.jsx(AT,{value:s.moneda_id,onChange:L=>R("moneda_id",Number(L.target.value)),children:Lae.map(L=>a.jsx("option",{value:L.id,children:L.codigo},L.id))})]}),a.jsxs(Zy,{children:[a.jsx(eb,{children:"Das Pago"}),a.jsxs(AT,{value:s.dias_pago,onChange:L=>R("dias_pago",Number(L.target.value)),children:[a.jsx("option",{value:"0",children:"0"}),a.jsx("option",{value:"30",children:"30"}),a.jsx("option",{value:"60",children:"60"}),a.jsx("option",{value:"90",children:"90"})]})]}),a.jsxs(Zy,{children:[a.jsx(eb,{children:"Comisin %:"}),a.jsx(Pae,{type:"number",value:s.comision,onChange:L=>R("comision",Number(L.target.value))}),a.jsx(Mae,{children:"*Solo para Exportacion"})]})]})})]}),a.jsxs(Oae,{children:[a.jsxs(FT,{children:[a.jsx(DT,{children:"Observacin Interna"}),a.jsx(PT,{children:a.jsx(MT,{value:s.observacion_interna,onChange:L=>R("observacion_interna",L.target.value),placeholder:"Observaciones internas..."})})]}),a.jsxs(FT,{children:[a.jsx(DT,{children:"Observacin Cliente"}),a.jsx(PT,{children:a.jsx(MT,{value:s.observacion_cliente,onChange:L=>R("observacion_cliente",L.target.value),placeholder:"Observaciones para el cliente..."})})]})]}),(j||k)&&a.jsxs(a.Fragment,{children:[j&&a.jsx(OT,{children:"Recuerde que esta cotizacion contiene un rea Hoja Corrugada estimada, favor validar este dato con desarrollo"}),k&&a.jsx(OT,{children:"Recuerde que esta cotizacion contiene un Cartn estimado, favor validar este dato con desarrollo"})]}),!E&&a.jsxs(RT,{children:[a.jsx(Xh,{onClick:()=>t(i),children:"Cancelar"}),a.jsx(Xh,{$variant:"success",onClick:ge,disabled:b||M,children:b?"Guardando...":M?"Cargando...":"Generar Pre-Cotizacin"})]}),E&&w&&a.jsxs(Rae,{children:[a.jsx(Nae,{children:"Resumen de Costos por producto"}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:"Parametros Por Producto"}),a.jsxs(Qm,{children:[a.jsxs(Jm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Planta"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Flete"}),a.jsx("th",{children:"Margen Papeles (USD/Mm2)"}),a.jsx("th",{children:"Margen (USD/Mm2)"}),a.jsx("th",{children:"Margen MNIMO (USD/Mm2)"}),a.jsx("th",{children:"Precio (USD/Mm2)"}),a.jsx("th",{children:"Precio (USD/Ton)"}),a.jsx("th",{children:"Precio (USD/UN)"}),a.jsx("th",{children:"Precio ($/UN)"}),a.jsx("th",{children:"Cantidad"}),a.jsx("th",{children:"Precio Total (MUSD)"})]})}),a.jsx("tbody",{children:w.parametros_producto.length>0?w.parametros_producto.map(L=>a.jsxs("tr",{children:[a.jsx("td",{children:L.numero}),a.jsx("td",{children:L.descripcion}),a.jsx("td",{children:L.cad}),a.jsx("td",{children:L.planta}),a.jsx("td",{children:L.tipo_producto}),a.jsx("td",{children:L.item}),a.jsx("td",{children:L.carton}),a.jsx("td",{children:L.flete}),a.jsx("td",{children:typeof L.margen_papeles=="number"?L.margen_papeles.toFixed(2):L.margen_papeles}),a.jsx("td",{children:typeof L.margen=="number"?L.margen.toFixed(2):L.margen}),a.jsx("td",{children:typeof L.margen_minimo=="number"?L.margen_minimo.toFixed(2):L.margen_minimo}),a.jsx("td",{children:typeof L.precio_usd_mm2=="number"?L.precio_usd_mm2.toFixed(2):L.precio_usd_mm2}),a.jsx("td",{children:typeof L.precio_usd_ton=="number"?L.precio_usd_ton.toFixed(2):L.precio_usd_ton}),a.jsx("td",{children:typeof L.precio_usd_un=="number"?L.precio_usd_un.toFixed(3):L.precio_usd_un}),a.jsx("td",{children:typeof L.precio_clp_un=="number"?L.precio_clp_un.toFixed(2):L.precio_clp_un}),a.jsx("td",{children:L.cantidad}),a.jsx("td",{children:typeof L.precio_total_musd=="number"?L.precio_total_musd.toFixed(3):L.precio_total_musd})]},L.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:17,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]}),a.jsx("span",{style:{color:"#025902",fontSize:"0.75rem",marginLeft:"0.5rem"},children:"* En verde: Promedios ponderados por columna"})]})]}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:"Nuevos Detalles Cotizacion"}),a.jsx(Qm,{children:a.jsxs(Jm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"MC (USD/Mm2)"}),a.jsx("th",{children:"Margen bruto sin flete (USD/Mm2)"}),a.jsx("th",{children:"Margen de servir (USD/Mm2)"}),a.jsx("th",{children:"Mg EBITDA (%)"})]})}),a.jsx("tbody",{children:w.nuevos_detalles.length>0?w.nuevos_detalles.map(L=>a.jsxs("tr",{children:[a.jsx("td",{children:L.numero}),a.jsx("td",{children:L.descripcion}),a.jsx("td",{children:L.cad}),a.jsx("td",{children:L.tipo_producto}),a.jsx("td",{children:L.item}),a.jsx("td",{children:L.carton}),a.jsx("td",{children:typeof L.mc_usd_mm2=="number"?L.mc_usd_mm2.toFixed(2):L.mc_usd_mm2}),a.jsx("td",{children:typeof L.margen_bruto_sin_flete=="number"?L.margen_bruto_sin_flete.toFixed(2):L.margen_bruto_sin_flete}),a.jsx("td",{children:typeof L.margen_servir=="number"?L.margen_servir.toFixed(2):L.margen_servir}),a.jsx("td",{children:typeof L.mg_ebitda=="number"?L.mg_ebitda.toFixed(2):L.mg_ebitda})]},L.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:10,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:"Costos Productos (USD/MM2)"}),a.jsx(Qm,{children:a.jsxs(Jm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Costo Directo"}),a.jsx("th",{children:"Costo Indirecto"}),a.jsx("th",{children:"GVV"}),a.jsx("th",{children:"Costo Fijo"}),a.jsx("th",{children:"Costo Total"})]})}),a.jsx("tbody",{children:w.costos_productos.length>0?w.costos_productos.map(L=>a.jsxs("tr",{children:[a.jsx("td",{children:L.numero}),a.jsx("td",{children:L.descripcion}),a.jsx("td",{children:L.cad}),a.jsx("td",{children:L.tipo_producto}),a.jsx("td",{children:L.item}),a.jsx("td",{children:L.carton}),a.jsx("td",{children:typeof L.costo_directo=="number"?L.costo_directo.toFixed(2):L.costo_directo}),a.jsx("td",{children:typeof L.costo_indirecto=="number"?L.costo_indirecto.toFixed(2):L.costo_indirecto}),a.jsx("td",{children:typeof L.gvv=="number"?L.gvv.toFixed(2):L.gvv}),a.jsx("td",{children:typeof L.costo_fijo=="number"?L.costo_fijo.toFixed(2):L.costo_fijo}),a.jsx("td",{children:typeof L.costo_total=="number"?L.costo_total.toFixed(2):L.costo_total})]},L.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:11,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:"Costos Servicios (USD/MM2)"}),a.jsx(Qm,{children:a.jsxs(Jm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Maquila"}),a.jsx("th",{children:"Armado"}),a.jsx("th",{children:"Clisses"}),a.jsx("th",{children:"Matriz"}),a.jsx("th",{children:"Mano de Obra"}),a.jsx("th",{children:"Flete"})]})}),a.jsx("tbody",{children:w.costos_servicios.length>0?w.costos_servicios.map(L=>a.jsxs("tr",{children:[a.jsx("td",{children:L.numero}),a.jsx("td",{children:L.descripcion}),a.jsx("td",{children:L.cad}),a.jsx("td",{children:L.tipo_producto}),a.jsx("td",{children:L.item}),a.jsx("td",{children:L.carton}),a.jsx("td",{children:typeof L.maquila=="number"?L.maquila.toFixed(2):L.maquila}),a.jsx("td",{children:typeof L.armado=="number"?L.armado.toFixed(2):L.armado}),a.jsx("td",{children:typeof L.clisses=="number"?L.clisses.toFixed(2):L.clisses}),a.jsx("td",{children:typeof L.matriz=="number"?L.matriz.toFixed(2):L.matriz}),a.jsx("td",{children:typeof L.mano_obra=="number"?L.mano_obra.toFixed(2):L.mano_obra}),a.jsx("td",{children:typeof L.flete=="number"?L.flete.toFixed(2):L.flete})]},L.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:12,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsx(zae,{children:a.jsx(Iae,{onClick:()=>{alert("Funcionalidad de Solicitar Aprobacin prximamente")},children:"Solicitar Aprobacin"})}),a.jsx(RT,{children:a.jsx(Xh,{onClick:()=>t(i),children:"Volver al listado"})})]})]})}const IT="https://inveb-api-production.up.railway.app/api/v1",LT=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,BT=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,UT=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,VT=p.div`
  display: flex;
  gap: 0.75rem;
`,oc=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Bae=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Uae=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,eg=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,tg=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Vae=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Hae=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Wae=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Gae=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Vs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Hs=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,qae=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,HT=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: ${d.colors.warning}15;
          color: ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,tb=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"approve":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"reject":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Kae=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Xae=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Yae=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Qae=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,WT=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Jae=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Zae=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,GT=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,eie=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,tie=p.span`
  font-family: 'Consolas', monospace;
  font-weight: 500;
`,rie=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,nie=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
`,aie=p.h2`
  font-size: 1.25rem;
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,iie=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1.5rem;
`,sie=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;function oie({onNavigate:e}){const[t,r]=S.useState([]),[n,i]=S.useState(1),[s,o]=S.useState(""),[l,c]=S.useState(""),[u,h]=S.useState(null),[f,m]=S.useState(null),[v,g]=S.useState(!0),[x,_]=S.useState(1),[b,y]=S.useState(0),[j,k]=S.useState(!1),[E,A]=S.useState("aprobar"),[w,P]=S.useState(null),[M,F]=S.useState(""),[D,W]=S.useState(!1),B=S.useCallback(async()=>{g(!0);try{const R=new URLSearchParams;R.append("page",n.toString()),R.append("page_size","20"),R.append("estado_id","2"),l&&R.append("user_id",l),s&&R.append("cotizacion_id",s);const I=await fetch(`${IT}/cotizaciones/?${R.toString()}`);if(!I.ok)throw new Error("Error al cargar cotizaciones");const K=await I.json();r(K.items||[]),y(K.total||0),_(K.total_pages||1)}catch(R){console.error("Error fetching cotizaciones:",R),m("Error al cargar las cotizaciones pendientes"),r([{id:1,client_id:1,cliente_nombre:"Vina Concha y Toro S.A.",usuario_nombre:"Juan Perez",user_id:1,estado_id:2,nivel_aprobacion:1,role_can_show:3,version_number:1,total_detalles:3,monto_total_usd:12500,created_at:"2024-01-15T10:30:00",updated_at:"2024-01-15T10:30:00"},{id:2,client_id:2,cliente_nombre:"Frutas del Sur Ltda.",usuario_nombre:"Maria Garcia",user_id:2,estado_id:2,nivel_aprobacion:2,role_can_show:15,version_number:1,total_detalles:2,monto_total_usd:8750.5,created_at:"2024-01-14T14:20:00",updated_at:"2024-01-14T14:20:00"}]),y(2),_(1)}finally{g(!1)}},[n,s,l]);S.useEffect(()=>{B()},[B]);const G=S.useCallback(R=>{R.preventDefault(),i(1),B()},[B]),Y=S.useCallback(()=>{o(""),c(""),i(1)},[]),ae=S.useCallback(R=>{e("cotizacion-editar",R)},[e]),U=S.useCallback((R,I)=>{P(R),A(I),F(""),k(!0)},[]),q=S.useCallback(()=>{k(!1),P(null),F(""),W(!1)},[]),z=S.useCallback(async()=>{if(w){W(!0);try{if(!(await fetch(`${IT}/cotizaciones/${w.id}/gestionar-aprobacion`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:E,motivo:M})})).ok)throw new Error("Error al procesar la aprobacion");const I=E==="aprobar"?"aprobada":"rechazada";h(`Cotizacion #${w.id} ${I} correctamente`),q(),B(),setTimeout(()=>h(null),4e3)}catch(R){console.error("Error:",R),m("Error al procesar la aprobacion"),setTimeout(()=>m(null),4e3)}finally{W(!1)}}},[w,E,M,q,B]),ie=R=>`$${R.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,he=R=>{try{return new Date(R).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return R}},O=R=>{switch(R){case 1:return"Jefe Ventas";case 2:return"Gerente Comercial";case 3:return"Gerente General";default:return`Nivel ${R}`}};return v?a.jsxs(LT,{children:[a.jsxs(BT,{children:[a.jsx(UT,{children:"Aprobaciones"}),a.jsx(VT,{children:a.jsx(oc,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})})]}),a.jsxs(Xae,{children:[a.jsx(Yae,{}),a.jsx("span",{children:"Cargando cotizaciones pendientes..."})]})]}):a.jsxs(LT,{children:[a.jsxs(BT,{children:[a.jsx(UT,{children:"Cotizaciones por Aprobar"}),a.jsxs(VT,{children:[a.jsx(oc,{onClick:()=>B(),children:"Actualizar"}),a.jsx(oc,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})]})]}),u&&a.jsx(GT,{$type:"success",children:u}),f&&a.jsx(GT,{$type:"error",children:f}),a.jsx(Bae,{children:a.jsx("form",{onSubmit:G,children:a.jsxs(Uae,{children:[a.jsxs(eg,{children:[a.jsx(tg,{children:"N Cotizacion"}),a.jsx(Vae,{type:"text",placeholder:"ID de cotizacion...",value:s,onChange:R=>o(R.target.value)})]}),a.jsxs(eg,{children:[a.jsx(tg,{children:"Creador"}),a.jsxs(Hae,{value:l,onChange:R=>c(R.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Juan Perez"}),a.jsx("option",{value:"2",children:"Maria Garcia"})]})]}),a.jsxs(eg,{children:[a.jsx(tg,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(oc,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(oc,{type:"button",onClick:Y,children:"Limpiar"})]})]})]})})}),a.jsx(Zae,{children:b===0?"No hay cotizaciones pendientes de aprobacion":`${b} cotizacion${b!==1?"es":""} pendiente${b!==1?"s":""} de aprobacion`}),a.jsx(Wae,{children:t.length===0?a.jsxs(Kae,{children:[a.jsx("p",{children:"No hay cotizaciones pendientes de aprobacion"}),a.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"Las cotizaciones aparecen aqui cuando un vendedor solicita su aprobacion."})]}):a.jsxs(a.Fragment,{children:[a.jsxs(Gae,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Vs,{children:"Cotizacion N"}),a.jsx(Vs,{children:"Fecha Creacion"}),a.jsx(Vs,{children:"Creador"}),a.jsx(Vs,{children:"Cliente"}),a.jsx(Vs,{children:"N Productos"}),a.jsx(Vs,{children:"Monto Total (USD)"}),a.jsx(Vs,{children:"Version"}),a.jsx(Vs,{children:"Nivel"}),a.jsx(Vs,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(R=>a.jsxs(qae,{children:[a.jsx(Hs,{children:a.jsx("strong",{children:R.id})}),a.jsx(Hs,{children:he(R.created_at)}),a.jsx(Hs,{children:R.usuario_nombre||"-"}),a.jsx(Hs,{children:a.jsx(eie,{title:R.cliente_nombre,children:R.cliente_nombre||"-"})}),a.jsx(Hs,{children:a.jsx(HT,{$type:"info",children:R.total_detalles})}),a.jsx(Hs,{children:a.jsx(tie,{children:R.monto_total_usd?ie(R.monto_total_usd):"-"})}),a.jsx(Hs,{children:R.version_number||1}),a.jsx(Hs,{children:a.jsx(HT,{$type:"warning",children:O(R.nivel_aprobacion)})}),a.jsxs(Hs,{children:[a.jsx(tb,{$variant:"view",onClick:()=>ae(R.id),title:"Ver detalle",children:"Ver"}),a.jsx(tb,{$variant:"approve",onClick:()=>U(R,"aprobar"),title:"Aprobar",children:"Aprobar"}),a.jsx(tb,{$variant:"reject",onClick:()=>U(R,"rechazar"),title:"Rechazar",children:"Rechazar"})]})]},R.id))})]}),x>1&&a.jsxs(Qae,{children:[a.jsx(WT,{disabled:n===1,onClick:()=>i(R=>R-1),children:"Anterior"}),a.jsxs(Jae,{children:["Pagina ",n," de ",x]}),a.jsx(WT,{disabled:n===x,onClick:()=>i(R=>R+1),children:"Siguiente"})]})]})}),j&&w&&a.jsx(rie,{onClick:q,children:a.jsxs(nie,{onClick:R=>R.stopPropagation(),children:[a.jsxs(aie,{children:[E==="aprobar"?"Aprobar":"Rechazar"," Cotizacion #",w.id]}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",w.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Creador:"})," ",w.usuario_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Productos:"})," ",w.total_detalles]})]}),a.jsxs(eg,{children:[a.jsxs(tg,{children:["Observacion ",E==="rechazar"&&"(Requerido)"]}),a.jsx(sie,{value:M,onChange:R=>F(R.target.value),placeholder:E==="aprobar"?"Ingrese una observacion opcional...":"Ingrese el motivo del rechazo...",required:E==="rechazar"})]}),a.jsxs(iie,{children:[a.jsx(oc,{onClick:q,disabled:D,children:"Cancelar"}),a.jsx(oc,{$variant:E==="aprobar"?"success":"danger",onClick:z,disabled:D||E==="rechazar"&&!M.trim(),children:D?"Procesando...":E==="aprobar"?"Confirmar Aprobacion":"Confirmar Rechazo"})]})]})})]})}const lie=p.div`
  padding: ${d.spacing.lg};
  max-width: 1400px;
  margin: 0 auto;
`,cie=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,die=p.h1`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,uie=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
  margin-bottom: ${d.spacing.lg};
`,hie=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: ${d.spacing.md};
  align-items: end;
`,Yh=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,rg=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,rb=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,Qh=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};

  ${({$variant:e="primary"})=>{switch(e){case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"secondary":return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgMedium}; }
        `;default:return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,fie=p.table`
  width: 100%;
  border-collapse: collapse;
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  overflow: hidden;
  box-shadow: ${d.shadows.sm};
`,xs=p.th`
  background: ${d.colors.primary};
  color: white;
  padding: ${d.spacing.md};
  text-align: left;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  white-space: nowrap;
`,vs=p.td`
  padding: ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  vertical-align: middle;
`,pie=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,ng=p.span`
  display: inline-block;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};

  ${({$variant:e="info"})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`,mie=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.bold};

  ${({$dias:e})=>e<=2?`background: ${d.colors.success}; color: white;`:e<=5?`background: ${d.colors.warning}; color: white;`:`background: ${d.colors.danger}; color: white;`}
`,gie=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,ag=p.button`
  width: 32px;
  height: 32px;
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;

  ${({$variant:e="view"})=>{switch(e){case"approve":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"reject":return`
          background: ${d.colors.danger}20;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;default:return`
          background: ${d.colors.primary}20;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}
`,qT=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,xie=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,vie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,nb=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.md};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  cursor: pointer;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,_ie=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,yie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
`,KT=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg} 0;
`,XT=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.xl};
`,bie=p.textarea`
  width: 100%;
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,jie=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
  font-size: ${d.typography.sizes.small};

  th, td {
    padding: ${d.spacing.sm};
    border: 1px solid ${d.colors.border};
    text-align: left;
  }

  th {
    background: ${d.colors.bgLight};
    font-weight: ${d.typography.weights.semibold};
  }
`,YT=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`;function wie({onNavigate:e}){const[t,r]=S.useState([]),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),[u,h]=S.useState(1),[f,m]=S.useState(1),[v,g]=S.useState(0),[x,_]=S.useState({date_desde:"",date_hasta:"",cotizacion_id:""}),[b,y]=S.useState(!1),[j,k]=S.useState("aprobar"),[E,A]=S.useState(null),[w,P]=S.useState(""),[M,F]=S.useState(!1),[D,W]=S.useState([]),B=S.useCallback(async()=>{i(!0),o(null);try{const O={page:u,page_size:20};x.date_desde&&(O.date_desde=x.date_desde),x.date_hasta&&(O.date_hasta=x.date_hasta),x.cotizacion_id&&(O.cotizacion_id=parseInt(x.cotizacion_id));const R=await Fn.getPendientesAprobacionExterno(O);r(R.items||[]),g(R.total||0),m(R.total_pages||1)}catch(O){console.error("Error loading cotizaciones:",O),o("Error al cargar las cotizaciones pendientes")}finally{i(!1)}},[u,x]);S.useEffect(()=>{B()},[B]);const G=(O,R)=>{_(I=>({...I,[O]:R})),h(1)},Y=()=>{h(1),B()},ae=()=>{_({date_desde:"",date_hasta:"",cotizacion_id:""}),h(1)},U=(O,R)=>{A(O),k(R),P(""),y(!0),R==="historial"&&z(O.id)},q=()=>{y(!1),A(null),P(""),W([])},z=async O=>{try{const R=await Fn.getHistorialAprobaciones(O);W(R.historial||[])}catch(R){console.error("Error loading historial:",R)}},ie=async()=>{if(E){F(!0),o(null);try{await Fn.gestionarAprobacionExterno(E.id,{action:j==="aprobar"?"aprobar":"rechazar",motivo:w||void 0}),c(`Cotizacin #${E.id} ${j==="aprobar"?"aprobada":"rechazada"} exitosamente`),q(),B(),setTimeout(()=>c(null),5e3)}catch(O){console.error("Error gestionando aprobacin:",O),o("Error al procesar la accin")}finally{F(!1)}}},he=O=>O?new Date(O).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}):"-";return a.jsxs(lie,{children:[a.jsxs(cie,{children:[a.jsx(die,{children:"Aprobacin Externa de Cotizaciones"}),a.jsxs(ng,{$variant:"info",children:[v," pendientes"]})]}),l&&a.jsx(YT,{$type:"success",children:l}),s&&a.jsx(YT,{$type:"error",children:s}),a.jsx(uie,{children:a.jsxs(hie,{children:[a.jsxs(Yh,{children:[a.jsx(rg,{children:"Fecha Desde"}),a.jsx(rb,{type:"date",value:x.date_desde,onChange:O=>G("date_desde",O.target.value)})]}),a.jsxs(Yh,{children:[a.jsx(rg,{children:"Fecha Hasta"}),a.jsx(rb,{type:"date",value:x.date_hasta,onChange:O=>G("date_hasta",O.target.value)})]}),a.jsxs(Yh,{children:[a.jsx(rg,{children:"N Cotizacin"}),a.jsx(rb,{type:"number",placeholder:"ID",value:x.cotizacion_id,onChange:O=>G("cotizacion_id",O.target.value)})]}),a.jsxs(Yh,{style:{flexDirection:"row",alignItems:"flex-end",gap:d.spacing.sm},children:[a.jsx(Qh,{onClick:Y,children:"Filtrar"}),a.jsx(Qh,{$variant:"secondary",onClick:ae,children:"Limpiar"})]})]})}),n?a.jsx(xie,{children:"Cargando cotizaciones..."}):t.length===0?a.jsxs(qT,{children:[a.jsx("div",{style:{fontSize:"3rem",marginBottom:d.spacing.md},children:""}),a.jsx("div",{children:"No hay cotizaciones pendientes de aprobacin externa"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(fie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(xs,{children:"N"}),a.jsx(xs,{children:"Das"}),a.jsx(xs,{children:"Cliente"}),a.jsx(xs,{children:"Descripcin"}),a.jsx(xs,{children:"CAD"}),a.jsx(xs,{children:"Detalles"}),a.jsx(xs,{children:"Versin"}),a.jsx(xs,{children:"Creador"}),a.jsx(xs,{children:"Fecha"}),a.jsx(xs,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(O=>a.jsxs(pie,{children:[a.jsx(vs,{children:a.jsx("strong",{children:O.id})}),a.jsx(vs,{children:a.jsxs(mie,{$dias:O.dias_pendiente,children:[O.dias_pendiente,"d"]})}),a.jsx(vs,{children:O.cliente_nombre||"-"}),a.jsx(vs,{children:O.primer_detalle_descripcion||"-"}),a.jsx(vs,{children:O.primer_detalle_cad||"-"}),a.jsxs(vs,{children:[a.jsx("span",{children:O.total_detalles}),O.detalles_ganados>0&&a.jsxs(ng,{$variant:"success",style:{marginLeft:"4px"},children:["+",O.detalles_ganados]}),O.detalles_perdidos>0&&a.jsxs(ng,{$variant:"danger",style:{marginLeft:"4px"},children:["-",O.detalles_perdidos]})]}),a.jsxs(vs,{children:["v",O.version_number||1]}),a.jsx(vs,{children:O.creador_nombre||"-"}),a.jsx(vs,{children:he(O.created_at)}),a.jsx(vs,{children:a.jsxs(gie,{children:[a.jsx(ag,{$variant:"view",onClick:()=>e("cotizacion-editar",O.id),title:"Ver detalle",children:""}),a.jsx(ag,{$variant:"view",onClick:()=>U(O,"historial"),title:"Ver historial",children:""}),a.jsx(ag,{$variant:"approve",onClick:()=>U(O,"aprobar"),title:"Aprobar",children:""}),a.jsx(ag,{$variant:"reject",onClick:()=>U(O,"rechazar"),title:"Rechazar",children:""})]})})]},O.id))})]}),f>1&&a.jsxs(vie,{children:[a.jsx(nb,{onClick:()=>h(O=>Math.max(1,O-1)),disabled:u===1,children:""}),Array.from({length:Math.min(5,f)},(O,R)=>{const I=Math.max(1,Math.min(u-2,f-4))+R;return I>f?null:a.jsx(nb,{$active:u===I,onClick:()=>h(I),children:I},I)}),a.jsx(nb,{onClick:()=>h(O=>Math.min(f,O+1)),disabled:u===f,children:""})]})]}),b&&E&&a.jsx(_ie,{onClick:q,children:a.jsx(yie,{onClick:O=>O.stopPropagation(),children:j==="historial"?a.jsxs(a.Fragment,{children:[a.jsxs(KT,{children:["Historial de Aprobaciones - Cotizacin #",E.id]}),D.length===0?a.jsx(qT,{children:"No hay historial de aprobaciones"}):a.jsxs(jie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Fecha"}),a.jsx("th",{children:"Usuario"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Accin"}),a.jsx("th",{children:"Motivo"})]})}),a.jsx("tbody",{children:D.map(O=>a.jsxs("tr",{children:[a.jsx("td",{children:he(O.created_at)}),a.jsx("td",{children:O.usuario_nombre||"-"}),a.jsx("td",{children:O.rol_nombre}),a.jsx("td",{children:a.jsx(ng,{$variant:O.action_made.includes("Rechazo")?"danger":"success",children:O.action_made})}),a.jsx("td",{children:O.motivo||"-"})]},O.id))})]}),a.jsx(XT,{children:a.jsx(Qh,{$variant:"secondary",onClick:q,children:"Cerrar"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs(KT,{children:[j==="aprobar"?" Aprobar":" Rechazar"," Cotizacin #",E.id]}),a.jsxs("div",{style:{marginBottom:d.spacing.lg},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",E.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Descripcin:"})," ",E.primer_detalle_descripcion||"-"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Detalles:"})," ",E.total_detalles]})]}),a.jsxs(Yh,{children:[a.jsx(rg,{children:j==="aprobar"?"Observaciones (opcional)":"Motivo del rechazo"}),a.jsx(bie,{value:w,onChange:O=>P(O.target.value),placeholder:j==="aprobar"?"Ingrese observaciones adicionales...":"Indique el motivo del rechazo...",required:j==="rechazar"})]}),a.jsxs(XT,{children:[a.jsx(Qh,{$variant:"secondary",onClick:q,disabled:M,children:"Cancelar"}),a.jsx(Qh,{$variant:j==="aprobar"?"success":"danger",onClick:ie,disabled:M||j==="rechazar"&&!w.trim(),children:M?"Procesando...":j==="aprobar"?"Confirmar Aprobacin":"Confirmar Rechazo"})]})]})})})]})}const kie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.md};
  padding: ${d.spacing.xl};
`,Cie=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,Sie=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.semibold};
  margin: 0;
`,$ie=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Eie=p.div`
  background: ${d.colors.bgBlueLight};
  border-left: 4px solid ${d.colors.primary};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,Tie=p.p`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.body};
  margin: 0;
`,Aie=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
`,Ws=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.cardHeader};
  color: white;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};

  &:first-child {
    border-radius: ${d.radius.md} 0 0 0;
  }

  &:last-child {
    border-radius: 0 ${d.radius.md} 0 0;
  }
`,Gs=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textPrimary};
`,Fie=p.tr`
  &:hover {
    background-color: ${d.colors.bgLight};
  }
`,Die=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }
`,Pie=p.span`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$color:e})=>e||d.colors.primary}20;
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`,Mie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,QT=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    background-color: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Oie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,Rie=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,Nie=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
`,zie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  max-width: 500px;
  width: 90%;
  box-shadow: ${d.shadows.lg};
`,Iie=p.h3`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg};
`,Lie=p.div`
  margin-bottom: ${d.spacing.lg};
`,Bie=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textPrimary};
`,Uie=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Vie=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,Hie=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.bgLight};
  color: ${d.colors.textSecondary};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.border};
  }
`,Wie=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Gie=p.div`
  background: ${d.colors.bgLight};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,ab=p.div`
  display: flex;
  justify-content: space-between;
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};

  &:not(:last-child) {
    border-bottom: 1px solid ${d.colors.border};
  }
`,ib=p.span`
  color: ${d.colors.textSecondary};
`,sb=p.span`
  color: ${d.colors.textPrimary};
  font-weight: ${d.typography.weights.medium};
`,qie=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background-color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}15;
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  border: 1px solid ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}30;
`,Kie=[{id:1,nombre:"Desarrollo Completo"},{id:5,nombre:"Arte con Material"}];function Xie({onNavigate:e}){const[t,r]=S.useState([]),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(1),[u,h]=S.useState(1),[f,m]=S.useState(0),[v,g]=S.useState(!1),[x,_]=S.useState(null),[b,y]=S.useState(1),[j,k]=S.useState(!1),E=S.useCallback(async()=>{i(!0),o(null);try{const F=await Fn.getDetallesParaOT(void 0,l,20);r(F.items),h(F.total_pages),m(F.total)}catch(F){console.error("Error cargando detalles:",F),o("Error al cargar los detalles de cotizaciones")}finally{i(!1)}},[l]);S.useEffect(()=>{E()},[E]);const A=F=>{_(F),y(1),g(!0)},w=async()=>{if(x){k(!0);try{const F=await Fn.getDetalleParaOT(x.detalle_id,b);F.success&&(g(!1),e("crear-ot-desde-cotizacion",void 0,F.datos_ot))}catch(F){console.error("Error obteniendo datos para OT:",F),o("Error al preparar los datos para la OT")}finally{k(!1)}}},P=F=>{try{return new Date(F).toLocaleDateString("es-CL")}catch{return F}},M=(F,D,W)=>!F&&!D&&!W?"-":`${F||0} x ${D||0} x ${W||0}`;return a.jsxs(kie,{children:[a.jsxs(Cie,{children:[a.jsx(Sie,{children:"Crear OT desde Cotizacion"}),a.jsx($ie,{onClick:()=>e("cotizaciones"),children:"Volver a Cotizaciones"})]}),a.jsx(Eie,{children:a.jsx(Tie,{children:"Seleccione un detalle de cotizacion aprobada para crear una nueva Orden de Trabajo. Solo se muestran detalles de cotizaciones aprobadas que aun no tienen OT asociada."})}),s&&a.jsx(qie,{$type:"error",children:s}),n?a.jsx(Oie,{children:"Cargando detalles..."}):t.length===0?a.jsxs(Rie,{children:[a.jsx("p",{children:"No hay detalles disponibles para crear OT."}),a.jsx("p",{children:"Los detalles deben pertenecer a cotizaciones aprobadas."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Mostrando ",t.length," de ",f," detalles disponibles"]}),a.jsxs(Aie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ws,{children:"Cot. #"}),a.jsx(Ws,{children:"Cliente"}),a.jsx(Ws,{children:"Descripcion"}),a.jsx(Ws,{children:"Dimensiones"}),a.jsx(Ws,{children:"CAD"}),a.jsx(Ws,{children:"Carton"}),a.jsx(Ws,{children:"Estado"}),a.jsx(Ws,{children:"Fecha"}),a.jsx(Ws,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(F=>a.jsxs(Fie,{children:[a.jsx(Gs,{children:a.jsxs("strong",{children:["#",F.cotizacion_id]})}),a.jsx(Gs,{children:F.cliente_nombre}),a.jsx(Gs,{children:F.descripcion_material_detalle||F.descripcion||"-"}),a.jsx(Gs,{children:M(F.largura,F.anchura,F.altura)}),a.jsx(Gs,{children:F.cad_codigo||"-"}),a.jsx(Gs,{children:F.carton_codigo||"-"}),a.jsx(Gs,{children:a.jsx(Pie,{$color:d.colors.success,children:F.estado_nombre})}),a.jsx(Gs,{children:P(F.cotizacion_fecha)}),a.jsx(Gs,{children:a.jsx(Die,{onClick:()=>A(F),children:"Crear OT"})})]},F.detalle_id))})]}),u>1&&a.jsxs(Mie,{children:[a.jsx(QT,{onClick:()=>c(F=>Math.max(1,F-1)),disabled:l===1,children:"Anterior"}),a.jsxs("span",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Pagina ",l," de ",u]}),a.jsx(QT,{onClick:()=>c(F=>Math.min(u,F+1)),disabled:l===u,children:"Siguiente"})]})]}),v&&x&&a.jsx(Nie,{onClick:()=>g(!1),children:a.jsxs(zie,{onClick:F=>F.stopPropagation(),children:[a.jsx(Iie,{children:"Crear Orden de Trabajo"}),a.jsxs(Gie,{children:[a.jsxs(ab,{children:[a.jsx(ib,{children:"Cotizacion:"}),a.jsxs(sb,{children:["#",x.cotizacion_id]})]}),a.jsxs(ab,{children:[a.jsx(ib,{children:"Cliente:"}),a.jsx(sb,{children:x.cliente_nombre})]}),a.jsxs(ab,{children:[a.jsx(ib,{children:"Descripcion:"}),a.jsx(sb,{children:x.descripcion_material_detalle||x.descripcion||"-"})]})]}),a.jsxs(Lie,{children:[a.jsx(Bie,{htmlFor:"tipo_solicitud",children:"Tipo de Solicitud *"}),a.jsx(Uie,{id:"tipo_solicitud",value:b,onChange:F=>y(Number(F.target.value)),children:Kie.map(F=>a.jsx("option",{value:F.id,children:F.nombre},F.id))})]}),a.jsxs(Vie,{children:[a.jsx(Hie,{onClick:()=>g(!1),children:"Cancelar"}),a.jsx(Wie,{onClick:w,disabled:j,children:j?"Procesando...":"Continuar"})]})]})})]})}p.div`
  padding: 1.5rem;
  max-width: 1200px;
  margin: 0 auto;
`;p.div`
  margin-bottom: 2rem;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  margin-bottom: 0.5rem;

  &:hover {
    text-decoration: underline;
  }
`;p.h1`
  font-size: 1.75rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.5rem 0;
`;p.p`
  font-size: 1rem;
  color: ${d.colors.textSecondary};
  margin: 0;
`;p.div`
  display: grid;
  grid-template-columns: 250px 1fr;
  gap: 2rem;

  @media (max-width: 900px) {
    grid-template-columns: 1fr;
  }
`;p.nav`
  background: white;
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  position: sticky;
  top: 1rem;
  height: fit-content;
`;p.h3`
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin: 0 0 0.75rem 0;
  padding: 0 0.5rem;
`;p.a`
  display: block;
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  background: ${({$active:e})=>e?`${d.colors.primary}10`:"transparent"};
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  margin-bottom: 0.25rem;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
`;p.section`
  margin-bottom: 2.5rem;

  &:last-child {
    margin-bottom: 0;
  }
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary}20;
`;p.p`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin: 0 0 1rem 0;
`;p.ul`
  margin: 0 0 1rem 0;
  padding-left: 1.5rem;
`;p.li`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin-bottom: 0.5rem;
`;p.div`
  display: flex;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`;p.div`
  width: 32px;
  height: 32px;
  background: ${d.colors.primary};
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  flex-shrink: 0;
`;p.div`
  flex: 1;
`;p.h4`
  font-size: 0.9375rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`;p.p`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`;p.div`
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;

  ${({$type:e="info"})=>{switch(e){case"warning":return`
          background: ${d.colors.warning}15;
          border-left: 4px solid ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          border-left: 4px solid ${d.colors.success};
        `;default:return`
          background: ${d.colors.primary}10;
          border-left: 4px solid ${d.colors.primary};
        `}}}
`;p.div`
  font-weight: 600;
  font-size: 0.875rem;
  margin-bottom: 0.25rem;
`;p.div`
  font-size: 0.875rem;
  line-height: 1.5;
`;p.table`
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
  font-size: 0.875rem;
`;p.th`
  text-align: left;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
`;p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
`;p.code`
  background: ${d.colors.bgLight};
  padding: 0.125rem 0.375rem;
  border-radius: 4px;
  font-family: 'Consolas', monospace;
  font-size: 0.85em;
`;const ob=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,lb=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,cb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,db=p.div`
  display: flex;
  gap: 0.75rem;
`,Jh=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Yie=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Qie=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  align-items: end;
`,Rd=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Nd=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,ig=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Jie=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Zie=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,ese=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,ui=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,hi=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
  text-align: center;
`,tse=p.tr`
  ${e=>e.$inactive&&`
    color: #999;
  `}

  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,rse=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"borrador":return`
          background: #6c757d;
          color: white;
        `;case"pendiente":return`
          background: ${d.colors.warning};
          color: #333;
        `;case"aprobada":return`
          background: ${d.colors.success};
          color: white;
        `;case"rechazada":return`
          background: ${d.colors.danger};
          color: white;
        `;case"vencida":return`
          background: #6c757d;
          color: white;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,nse=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
`,ub=p.span`
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 0.75rem;

  ${e=>{switch(e.$type){case"ganados":return`color: ${d.colors.success};`;case"perdidos":return`color: ${d.colors.danger};`;default:return"color: #666;"}}}
`,JT=p.button`
  padding: 0.3rem 0.5rem;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"edit":return`
          background: ${d.colors.warning};
          color: white;
          &:hover { background: #e0a800; }
        `;case"pdf":return`
          background: #e74c3c;
          color: white;
          &:hover { background: #c0392b; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,ase=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,ise=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,sse=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,ose=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,ZT=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,lse=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,e4=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,sg=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,cse={1:{label:"Borrador",type:"borrador"},2:{label:"Pendiente",type:"pendiente"},3:{label:"Aprobada",type:"aprobada"},4:{label:"Vigente",type:"aprobada"},5:{label:"Vencida",type:"vencida"},6:{label:"Rechazada",type:"rechazada"}},og=()=>{const e=new Date;return e.setMonth(e.getMonth()-3),e.toISOString().split("T")[0]},lg=()=>new Date().toISOString().split("T")[0];function dse({onNavigate:e}){const[t,r]=S.useState({page:1,page_size:20,date_desde:og(),date_hasta:lg()}),[n,i]=S.useState(""),[s,o]=S.useState(og()),[l,c]=S.useState(lg()),[u,h]=S.useState(""),[f,m]=S.useState(""),[v,g]=S.useState(null),{data:x,isLoading:_,error:b}=zt({queryKey:["cotizaciones-externo",t],queryFn:()=>Fn.list(t)}),{data:y}=zt({queryKey:["cotizacion-estados"],queryFn:()=>Fn.getEstados()}),j=S.useCallback(Y=>{Y.preventDefault();const ae={...t,page:1,date_desde:s,date_hasta:l};n?ae.cotizacion_id=parseInt(n,10):delete ae.cotizacion_id,u?ae.estado_id=[parseInt(u,10)]:delete ae.estado_id,f?ae.cad=f:delete ae.cad,r(ae)},[t,n,u,f,s,l]),k=S.useCallback(()=>{i(""),h(""),m(""),o(og()),c(lg()),r({page:1,page_size:20,date_desde:og(),date_hasta:lg()})},[]),E=S.useCallback(()=>{e("cotizacion-externa-nueva")},[e]),A=S.useCallback(Y=>{e("cotizacion-externa-editar",Y.id)},[e]),w=S.useCallback(Y=>{const ae=`https://inveb-api-production.up.railway.app/api/v1/api/cotizaciones/${Y}/pdf`;window.open(ae,"_blank"),g("Descargando PDF..."),setTimeout(()=>g(null),2e3)},[]),P=S.useCallback(Y=>{r(ae=>({...ae,page:Y}))},[]),M=Y=>Y?new Date(Y).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",F=Y=>{const ae=cse[Y]||{label:"Desconocido",type:"info"};return a.jsx(rse,{$type:ae.type,children:ae.label})};if(_)return a.jsxs(ob,{children:[a.jsxs(lb,{children:[a.jsx(cb,{children:"Cotizaciones"}),a.jsx(db,{children:a.jsx(Jh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(ise,{children:[a.jsx(sse,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(b)return a.jsxs(ob,{children:[a.jsxs(lb,{children:[a.jsx(cb,{children:"Cotizaciones"}),a.jsx(db,{children:a.jsx(Jh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(e4,{$type:"error",children:["Error al cargar cotizaciones: ",b.message]})]});const D=(x==null?void 0:x.items)||[],W=(x==null?void 0:x.total)||0,B=(x==null?void 0:x.total_pages)||1,G=(x==null?void 0:x.page)||1;return a.jsxs(ob,{children:[a.jsxs(lb,{children:[a.jsxs(cb,{children:["Cotizaciones (",W,")"]}),a.jsx(db,{children:a.jsx(Jh,{$variant:"primary",onClick:E,children:"Crear Cotizacion"})})]}),v&&a.jsx(e4,{$type:"success",children:v}),a.jsx(Yie,{children:a.jsx("form",{onSubmit:j,children:a.jsxs(Qie,{children:[a.jsxs(Rd,{children:[a.jsx(Nd,{children:"Desde"}),a.jsx(ig,{type:"date",value:s,onChange:Y=>o(Y.target.value)})]}),a.jsxs(Rd,{children:[a.jsx(Nd,{children:"Hasta"}),a.jsx(ig,{type:"date",value:l,onChange:Y=>c(Y.target.value)})]}),a.jsxs(Rd,{children:[a.jsx(Nd,{children:"N Cotizacion"}),a.jsx(ig,{type:"number",placeholder:"ID...",value:n,onChange:Y=>i(Y.target.value)})]}),a.jsxs(Rd,{children:[a.jsx(Nd,{children:"Estado"}),a.jsxs(Jie,{value:u,onChange:Y=>h(Y.target.value),children:[a.jsx("option",{value:"",children:"Selecciona..."}),y==null?void 0:y.map(Y=>a.jsx("option",{value:Y.id,children:Y.nombre},Y.id))]})]}),a.jsxs(Rd,{children:[a.jsx(Nd,{children:"CAD"}),a.jsx(ig,{type:"text",placeholder:"CAD...",value:f,onChange:Y=>m(Y.target.value)})]}),a.jsxs(Rd,{children:[a.jsx(Nd,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Jh,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(Jh,{type:"button",onClick:k,children:"Limpiar"})]})]})]})})}),a.jsx(Zie,{children:D.length===0?a.jsx(ase,{children:a.jsx("p",{children:"No hay cotizaciones actualmente"})}):a.jsxs(a.Fragment,{children:[a.jsxs(ese,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ui,{children:"Cotizacion N"}),a.jsx(ui,{children:"N de Productos"}),a.jsx(ui,{children:"Creador"}),a.jsx(ui,{children:"Cliente"}),a.jsx(ui,{children:"Fecha 1ra Ver."}),a.jsx(ui,{children:"Fecha Ult. Ver."}),a.jsx(ui,{children:"Descrip."}),a.jsx(ui,{children:"CAD"}),a.jsx(ui,{children:"OT"}),a.jsx(ui,{children:"N Version"}),a.jsx(ui,{children:"Estado"}),a.jsx(ui,{children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(Y=>a.jsxs(tse,{$inactive:Y.active===0,children:[a.jsx(hi,{children:a.jsx("strong",{children:Y.id})}),a.jsx(hi,{children:a.jsxs(nse,{children:[a.jsx(ub,{$type:"total",title:"Total Detalles",children:Y.total_detalles||0}),a.jsxs(ub,{$type:"ganados",title:"Detalles Ganados",style:{opacity:Y.estado_id>=3?1:.15},children:["+",Y.detalles_ganados||0]}),a.jsxs(ub,{$type:"perdidos",title:"Detalles Perdidos",style:{opacity:Y.estado_id>=3?1:.15},children:["-",Y.detalles_perdidos||0]})]})}),a.jsx(hi,{children:a.jsx(sg,{title:Y.usuario_nombre||"-",children:Y.usuario_nombre||"-"})}),a.jsx(hi,{children:a.jsx(sg,{title:Y.cliente_nombre||"-",children:Y.cliente_nombre||"-"})}),a.jsx(hi,{children:M(Y.fecha_primera_version||Y.created_at)}),a.jsx(hi,{children:M(Y.created_at)}),a.jsx(hi,{children:a.jsx(sg,{title:Y.primer_detalle_descripcion||"-",children:Y.primer_detalle_descripcion||"-"})}),a.jsx(hi,{children:a.jsx(sg,{title:Y.primer_detalle_cad||"-",children:Y.primer_detalle_cad||"-"})}),a.jsx(hi,{children:Y.primer_detalle_ot||"-"}),a.jsx(hi,{children:Y.version_number||"-"}),a.jsx(hi,{children:F(Y.estado_id)}),a.jsxs(hi,{children:[a.jsx(JT,{$variant:Y.estado_id===3?"view":"edit",onClick:()=>A(Y),title:Y.estado_id===3?"Ver":"Editar",children:Y.estado_id===3?"Ver":"Editar"}),Y.estado_id===3&&a.jsx(JT,{$variant:"pdf",onClick:()=>w(Y.id),title:"Descargar PDF",children:"PDF"})]})]},Y.id))})]}),B>1&&a.jsxs(ose,{children:[a.jsx(ZT,{disabled:G===1,onClick:()=>P(G-1),children:"Anterior"}),a.jsxs(lse,{children:["Pagina ",G," de ",B]}),a.jsx(ZT,{disabled:G===B,onClick:()=>P(G+1),children:"Siguiente"})]})]})})]})}const use=p.div`
  padding: 1.5rem;
  max-width: 1400px;
  margin: 0 auto;
`,hse=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: #1a1a2e;
  margin-bottom: 1.5rem;
`,fse=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
`,pse=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  transition: transform 0.2s, box-shadow 0.2s;

  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  }
`,mse=p.a`
  display: block;
  cursor: pointer;
`,gse=p.img`
  width: 100%;
  height: 160px;
  object-fit: cover;
`,xse=p.div`
  padding: 1rem;
`,vse=p.p`
  font-size: 0.95rem;
  font-weight: 600;
  color: #333;
  margin: 0;
  line-height: 1.4;
`,_se=p.button`
  background: #f0f0f0;
  border: 1px solid #ddd;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  margin-bottom: 1rem;

  &:hover {
    background: #e0e0e0;
  }
`,yse=[{title:"Cmo pasar de un detalle de una Cotizacin a una OT?",video:"cotizacion a OT.mp4"},{title:"Cmo pasar de una OT a una Cotizacin?",video:"OT a Cotizacion.mp4"},{title:"Cmo crear una nueva Cotizacin rapidamente?",video:"crear Cotizacion.mp4"},{title:"Cmo agregar detalle corrugado?",video:"Corrugado.mp4"},{title:"Cmo agregar detalle esquinero?",video:"Esquinero.mp4"},{title:"Cmo calcular un area HC?",video:"AreaHC.mp4"},{title:"Cmo estimar un cartn?",video:"CartonHC.mp4"},{title:"Cmo versionar una cotizacin? (Editar Cotizacin activa)",video:"Versionar.mp4"},{title:"Cmo Agregar un Multidestino?",video:"Multidestino.mp4"},{title:"Cmo cargar una cotizacin masiva? (Carga de Archivo)",video:"cargaMasiva.mp4"},{title:"Cmo duplicar cotizacin? (Cotizacin independiente)",video:"Duplicar.mp4"},{title:"Cmo imprimir cotizacin? (Carta Tipo)",video:"DescargarPDF.mp4"}],bse="https://techrev.me/wp-content/uploads/2019/09/cropped-how-to-make-tutorial-videos-1600x768.jpg",jse="http://localhost:8080";function wse({onNavigate:e}){const t=r=>{window.open(`${jse}/videos/${r}`,"_blank")};return a.jsxs(use,{children:[a.jsx(_se,{onClick:()=>e("cotizaciones"),children:" Volver a Cotizaciones"}),a.jsx(hse,{children:"Seccin de Ayuda"}),a.jsx(fse,{children:yse.map((r,n)=>a.jsxs(pse,{children:[a.jsx(mse,{onClick:()=>t(r.video),children:a.jsx(gse,{src:bse,alt:r.title})}),a.jsx(xse,{children:a.jsx(vse,{children:r.title})})]},n))})]})}const hb=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,fb=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,pb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,kse=p.div`
  display: flex;
  gap: 0.75rem;
`,mb=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Cse=p.button`
  padding: 0.5rem 1.25rem;
  border: none;
  border-radius: 50px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: ${d.colors.primaryDark};
  }
`,t4=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Sse=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,qs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ks=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,r4=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,$se=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"priority":return`
          background: #ff572215;
          color: #ff5722;
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Ese=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$estado){case 0:return"background: #6c757d15; color: #6c757d;";case 1:return"background: #2196f315; color: #2196f3;";case 2:return`background: ${d.colors.danger}15; color: ${d.colors.danger};`;case 3:return`background: ${d.colors.success}15; color: ${d.colors.success};`;case 4:return"background: #9e9e9e15; color: #9e9e9e;";case 5:return"background: #ff980015; color: #ff9800;";case 6:return"background: #9c27b015; color: #9c27b0;";default:return"background: #6c757d15; color: #6c757d;"}}}
`,Hi=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;case"warning":return`
          background: #ffc10715;
          color: #ffc107;
          &:hover { background: #ffc107; color: white; }
        `;case"info":return`
          background: #2196f315;
          color: #2196f3;
          &:hover { background: #2196f3; color: white; }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,n4=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,a4=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,i4=p.p`
  font-size: 1rem;
  margin: 0;
`,Tse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Ase=p.div`
  display: flex;
  gap: 0.25rem;
  flex-wrap: wrap;
  justify-content: flex-start;
`,cg=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,Fse=p.span`
  color: #ff5722;
  font-weight: bold;
  margin-right: 0.25rem;
`,gb=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,xb=p.div`
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  max-width: 400px;
  width: 100%;
`,vb=p.h3`
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,s4=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Dse=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,_b=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
`,zd=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function Pse({otId:e,onNavigate:t,onCreateMuestra:r}){var ne;const n=Mr(),[i,s]=S.useState(!1),[o,l]=S.useState(!1),[c,u]=S.useState(!1),[h,f]=S.useState(null),[m,v]=S.useState(""),[g,x]=S.useState(null),{data:_,isLoading:b,error:y}=zt({queryKey:["muestras",e],queryFn:()=>_r.listByOT(e)}),{data:j}=zt({queryKey:["muestras-options"],queryFn:()=>_r.getOptions()}),k=Ct({mutationFn:ee=>_r.terminar(ee),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),E=Ct({mutationFn:({id:ee,obs:ge})=>_r.rechazar(ee,ge),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),s(!1),v("")}}),A=Ct({mutationFn:ee=>_r.anular(ee),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),w=Ct({mutationFn:({id:ee,obs:ge})=>_r.devolver(ee,ge),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),l(!1),v("")}}),P=Ct({mutationFn:ee=>_r.togglePrioritaria(ee),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),M=Ct({mutationFn:ee=>_r.delete(ee),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),F=Ct({mutationFn:({id:ee,salaId:ge})=>_r.asignarSalaCorte(ee,ge),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),u(!1),x(null)}}),D=Ct({mutationFn:ee=>_r.iniciarProceso(ee),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),W=S.useCallback(ee=>{window.confirm("Marcar muestra como terminada?")&&k.mutate(ee)},[k]),B=S.useCallback(ee=>{f(ee),s(!0)},[]),G=S.useCallback(ee=>{window.confirm("Anular esta muestra?")&&A.mutate(ee)},[A]),Y=S.useCallback(ee=>{f(ee),l(!0)},[]),ae=S.useCallback(ee=>{P.mutate(ee)},[P]),U=S.useCallback(ee=>{window.confirm("Eliminar esta muestra? Esta accin no se puede deshacer.")&&M.mutate(ee)},[M]),q=S.useCallback(ee=>{f(ee),u(!0)},[]),z=S.useCallback(ee=>{window.confirm("Iniciar proceso de esta muestra?")&&D.mutate(ee)},[D]),ie=()=>{h&&E.mutate({id:h,obs:m})},he=()=>{h&&w.mutate({id:h,obs:m})},O=()=>{h&&g&&F.mutate({id:h,salaId:g})},R=ee=>{const ge=[],L=ee.estado;switch(ge.push(a.jsx(Hi,{$variant:"primary",onClick:()=>t("muestra-detalle",ee.id),title:"Ver detalle",children:"Ver"},"ver")),ge.push(a.jsx(Hi,{$variant:"info",onClick:()=>d1.downloadEtiquetaMuestra(ee.id,"producto"),title:"Etiqueta Producto (10x10cm)",children:"Etq"},"etq-prod")),ge.push(a.jsx(Hi,{$variant:"info",onClick:()=>d1.downloadEtiquetaMuestra(ee.id,"cliente"),title:"Etiqueta Cliente (A4)",children:"Envo"},"etq-cli")),L!==3&&L!==4&&ge.push(a.jsx(Hi,{$variant:ee.prioritaria?"warning":"info",onClick:()=>ae(ee.id),title:ee.prioritaria?"Quitar prioridad":"Marcar prioritaria",disabled:P.isPending,children:ee.prioritaria?"":""},"priority")),L){case 0:ge.push(a.jsx(Hi,{$variant:"info",onClick:()=>q(ee.id),title:"Asignar sala de corte",children:"Sala"},"sala")),ge.push(a.jsx(Hi,{$variant:"danger",onClick:()=>U(ee.id),title:"Eliminar",disabled:M.isPending,children:""},"delete"));break;case 1:ge.push(a.jsx(Hi,{$variant:"success",onClick:()=>W(ee.id),title:"Terminar",disabled:k.isPending,children:""},"terminar")),ge.push(a.jsx(Hi,{$variant:"danger",onClick:()=>B(ee.id),title:"Rechazar",children:""},"rechazar")),ge.push(a.jsx(Hi,{$variant:"warning",onClick:()=>Y(ee.id),title:"Devolver",children:""},"devolver"));break;case 6:ge.push(a.jsx(Hi,{$variant:"info",onClick:()=>z(ee.id),title:"Iniciar proceso",disabled:D.isPending,children:""},"iniciar"));break;case 3:case 4:break;default:L!==4&&ge.push(a.jsx(Hi,{$variant:"danger",onClick:()=>G(ee.id),title:"Anular",disabled:A.isPending,children:"Anular"},"anular"))}return ge};if(b)return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsxs(pb,{children:["Muestras de OT #",e]}),a.jsx(mb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsx(Tse,{children:"Cargando..."})]});if(y)return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsxs(pb,{children:["Muestras de OT #",e]}),a.jsx(mb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsxs(n4,{children:[a.jsx(a4,{children:"!"}),a.jsx(i4,{children:"Error al cargar las muestras"})]})]});const I=(_==null?void 0:_.items)||[],K=(_==null?void 0:_.total)||0;return a.jsxs(hb,{children:[a.jsxs(fb,{children:[a.jsxs(pb,{children:["Muestras de OT #",e," (",K,")"]}),a.jsxs(kse,{children:[a.jsx(Cse,{onClick:r,children:"+ Nueva Muestra"}),a.jsx(mb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]})]}),I.length===0?a.jsx(t4,{children:a.jsxs(n4,{children:[a.jsx(a4,{children:""}),a.jsx(i4,{children:"No hay muestras para esta OT"})]})}):a.jsx(t4,{children:a.jsxs(Sse,{children:[a.jsx("thead",{children:a.jsxs(r4,{children:[a.jsx(qs,{style:{width:"60px"},children:"ID"}),a.jsx(qs,{style:{width:"90px"},children:"Estado"}),a.jsx(qs,{children:"CAD"}),a.jsx(qs,{children:"Cartn"}),a.jsx(qs,{children:"Sala Corte"}),a.jsx(qs,{style:{width:"80px"},children:"Cantidad"}),a.jsx(qs,{style:{width:"100px"},children:"Creado"}),a.jsx(qs,{children:"Creador"}),a.jsx(qs,{style:{width:"180px"},children:"Acciones"})]})}),a.jsx("tbody",{children:I.map(ee=>a.jsxs(r4,{children:[a.jsxs(Ks,{children:[ee.prioritaria&&a.jsx(Fse,{title:"Prioritaria",children:""}),a.jsx($se,{children:ee.id})]}),a.jsx(Ks,{children:a.jsx(Ese,{$estado:ee.estado,children:h7[ee.estado]||"Desconocido"})}),a.jsx(Ks,{children:a.jsx(cg,{title:ee.cad||"",children:ee.cad||"-"})}),a.jsx(Ks,{children:a.jsx(cg,{title:ee.carton||"",children:ee.carton||"-"})}),a.jsx(Ks,{children:a.jsx(cg,{title:ee.sala_corte||"",children:ee.sala_corte||"-"})}),a.jsx(Ks,{children:ee.cantidad_total}),a.jsx(Ks,{children:ee.created_at}),a.jsx(Ks,{children:a.jsx(cg,{title:ee.creador_nombre||"",children:ee.creador_nombre||"-"})}),a.jsx(Ks,{children:a.jsx(Ase,{children:R(ee)})})]},ee.id))})]})}),i&&a.jsx(gb,{onClick:()=>s(!1),children:a.jsxs(xb,{onClick:ee=>ee.stopPropagation(),children:[a.jsx(vb,{children:"Rechazar Muestra"}),a.jsx(s4,{placeholder:"Motivo del rechazo (opcional)",value:m,onChange:ee=>v(ee.target.value)}),a.jsxs(_b,{children:[a.jsx(zd,{onClick:()=>s(!1),children:"Cancelar"}),a.jsx(zd,{$primary:!0,onClick:ie,disabled:E.isPending,children:E.isPending?"Rechazando...":"Rechazar"})]})]})}),o&&a.jsx(gb,{onClick:()=>l(!1),children:a.jsxs(xb,{onClick:ee=>ee.stopPropagation(),children:[a.jsx(vb,{children:"Devolver Muestra"}),a.jsx(s4,{placeholder:"Motivo de la devolucin (opcional)",value:m,onChange:ee=>v(ee.target.value)}),a.jsxs(_b,{children:[a.jsx(zd,{onClick:()=>l(!1),children:"Cancelar"}),a.jsx(zd,{$primary:!0,onClick:he,disabled:w.isPending,children:w.isPending?"Devolviendo...":"Devolver"})]})]})}),c&&a.jsx(gb,{onClick:()=>u(!1),children:a.jsxs(xb,{onClick:ee=>ee.stopPropagation(),children:[a.jsx(vb,{children:"Asignar Sala de Corte"}),a.jsxs(Dse,{value:g||"",onChange:ee=>x(Number(ee.target.value)||null),children:[a.jsx("option",{value:"",children:"Seleccionar sala..."}),(ne=j==null?void 0:j.salas_corte)==null?void 0:ne.map(ee=>a.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),a.jsxs(_b,{children:[a.jsx(zd,{onClick:()=>u(!1),children:"Cancelar"}),a.jsx(zd,{$primary:!0,onClick:O,disabled:!g||F.isPending,children:F.isPending?"Asignando...":"Asignar"})]})]})})]})}const o4=p.div`
  padding: 1.5rem;
  max-width: 900px;
`,l4=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,c4=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,d4=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Mse=p.form`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
`,u4=p.div`
  margin-bottom: 1.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }
`,h4=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,f4=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;

  &:last-child {
    margin-bottom: 0;
  }
`,sn=p.div`
  display: flex;
  flex-direction: column;
`,on=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.375rem;
  text-transform: uppercase;
`,Pa=p.input`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,yb=p.select`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Ose=p.textarea`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Zh=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,ef=p.input`
  width: 1rem;
  height: 1rem;
  cursor: pointer;
`,tf=p.label`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;
`,rf=p.div`
  background: ${e=>e.$enabled?d.colors.primary+"08":d.colors.bgLight};
  border: 1px solid ${e=>e.$enabled?d.colors.primary+"40":d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  transition: all 0.2s;
`,nf=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
`,af=p.span`
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,sf=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 0.75rem;
`,Rse=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid ${d.colors.border};
`,p4=p.button`
  padding: 0.625rem 1.5rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Nse=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}40;
  border-radius: 4px;
  padding: 0.75rem;
  color: ${d.colors.danger};
  font-size: 0.875rem;
  margin-bottom: 1rem;
`,zse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Ise={work_order_id:0,sala_corte_id:void 0,cad_id:void 0,carton_id:void 0,observacion_muestra:"",vendedor_nombre:"",vendedor_direccion:"",vendedor_ciudad:"",vendedor_check:0,cantidad_vendedor:0,disenador_nombre:"",disenador_direccion:"",disenador_ciudad:"",disenador_check:0,cantidad_disenador:0,laboratorio_check:0,cantidad_laboratorio:0,cliente_check:0,cantidad_cliente:0,disenador_revision_nombre:"",disenador_revision_direccion:"",disenador_revision_check:0,cantidad_disenador_revision:0};function Lse({otId:e,onNavigate:t,onSuccess:r}){var x,_,b;const n=Mr(),[i,s]=S.useState({...Ise,work_order_id:e}),[o,l]=S.useState(null),{data:c,isLoading:u}=zt({queryKey:["muestras-options"],queryFn:()=>_r.getOptions()}),h=Ct({mutationFn:y=>_r.create(y),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),r?r():t("muestras-list",e)},onError:y=>{const j=y instanceof Error?y.message:"Error al crear la muestra";l(j)}}),f=S.useCallback((y,j)=>{s(k=>({...k,[y]:j}))},[]),m=S.useCallback((y,j)=>{s(k=>({...k,[y]:j?1:0}))},[]),v=S.useCallback(y=>{if(y.preventDefault(),l(null),(i.cantidad_vendedor||0)+(i.cantidad_disenador||0)+(i.cantidad_laboratorio||0)+(i.cantidad_cliente||0)+(i.cantidad_disenador_revision||0)===0){l("Debe especificar al menos una cantidad en algn destino");return}h.mutate(i)},[i,h]),g=S.useCallback(()=>{t("muestras-list",e)},[t,e]);return u?a.jsxs(o4,{children:[a.jsxs(l4,{children:[a.jsxs(c4,{children:["Nueva Muestra para OT #",e]}),a.jsx(d4,{onClick:g,children:"Cancelar"})]}),a.jsx(zse,{children:"Cargando opciones..."})]}):a.jsxs(o4,{children:[a.jsxs(l4,{children:[a.jsxs(c4,{children:["Nueva Muestra para OT #",e]}),a.jsx(d4,{onClick:g,children:"Cancelar"})]}),a.jsxs(Mse,{onSubmit:v,children:[o&&a.jsx(Nse,{children:o}),a.jsxs(u4,{children:[a.jsx(h4,{children:"Informacin General"}),a.jsxs(f4,{children:[a.jsxs(sn,{children:[a.jsx(on,{children:"Sala de Corte"}),a.jsxs(yb,{value:i.sala_corte_id||"",onChange:y=>f("sala_corte_id",y.target.value?Number(y.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(x=c==null?void 0:c.salas_corte)==null?void 0:x.map(y=>a.jsx("option",{value:y.id,children:y.nombre},y.id))]})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"CAD"}),a.jsxs(yb,{value:i.cad_id||"",onChange:y=>f("cad_id",y.target.value?Number(y.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(_=c==null?void 0:c.cads)==null?void 0:_.map(y=>a.jsx("option",{value:y.id,children:y.codigo},y.id))]})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Cartn"}),a.jsxs(yb,{value:i.carton_id||"",onChange:y=>f("carton_id",y.target.value?Number(y.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(b=c==null?void 0:c.cartones)==null?void 0:b.map(y=>a.jsx("option",{value:y.id,children:y.codigo},y.id))]})]})]}),a.jsx(f4,{children:a.jsxs(sn,{style:{gridColumn:"1 / -1"},children:[a.jsx(on,{children:"Observacin"}),a.jsx(Ose,{value:i.observacion_muestra||"",onChange:y=>f("observacion_muestra",y.target.value),placeholder:"Observaciones generales de la muestra..."})]})})]}),a.jsxs(u4,{children:[a.jsx(h4,{children:"Destinos de Muestras"}),a.jsxs(rf,{$enabled:!!i.vendedor_check,style:{marginBottom:"1rem"},children:[a.jsx(nf,{children:a.jsxs(Zh,{children:[a.jsx(ef,{type:"checkbox",id:"vendedor_check",checked:!!i.vendedor_check,onChange:y=>m("vendedor_check",y.target.checked)}),a.jsx(tf,{htmlFor:"vendedor_check",children:a.jsx(af,{children:"Vendedor"})})]})}),i.vendedor_check?a.jsxs(sf,{children:[a.jsxs(sn,{children:[a.jsx(on,{children:"Nombre"}),a.jsx(Pa,{value:i.vendedor_nombre||"",onChange:y=>f("vendedor_nombre",y.target.value),placeholder:"Nombre del vendedor"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Direccin"}),a.jsx(Pa,{value:i.vendedor_direccion||"",onChange:y=>f("vendedor_direccion",y.target.value),placeholder:"Direccin"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Ciudad"}),a.jsx(Pa,{value:i.vendedor_ciudad||"",onChange:y=>f("vendedor_ciudad",y.target.value),placeholder:"Ciudad"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Cantidad"}),a.jsx(Pa,{type:"number",min:"0",value:i.cantidad_vendedor||"",onChange:y=>f("cantidad_vendedor",y.target.value?Number(y.target.value):0)})]})]}):null]}),a.jsxs(rf,{$enabled:!!i.disenador_check,style:{marginBottom:"1rem"},children:[a.jsx(nf,{children:a.jsxs(Zh,{children:[a.jsx(ef,{type:"checkbox",id:"disenador_check",checked:!!i.disenador_check,onChange:y=>m("disenador_check",y.target.checked)}),a.jsx(tf,{htmlFor:"disenador_check",children:a.jsx(af,{children:"Diseador"})})]})}),i.disenador_check?a.jsxs(sf,{children:[a.jsxs(sn,{children:[a.jsx(on,{children:"Nombre"}),a.jsx(Pa,{value:i.disenador_nombre||"",onChange:y=>f("disenador_nombre",y.target.value),placeholder:"Nombre del diseador"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Direccin"}),a.jsx(Pa,{value:i.disenador_direccion||"",onChange:y=>f("disenador_direccion",y.target.value),placeholder:"Direccin"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Ciudad"}),a.jsx(Pa,{value:i.disenador_ciudad||"",onChange:y=>f("disenador_ciudad",y.target.value),placeholder:"Ciudad"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Cantidad"}),a.jsx(Pa,{type:"number",min:"0",value:i.cantidad_disenador||"",onChange:y=>f("cantidad_disenador",y.target.value?Number(y.target.value):0)})]})]}):null]}),a.jsxs(rf,{$enabled:!!i.laboratorio_check,style:{marginBottom:"1rem"},children:[a.jsx(nf,{children:a.jsxs(Zh,{children:[a.jsx(ef,{type:"checkbox",id:"laboratorio_check",checked:!!i.laboratorio_check,onChange:y=>m("laboratorio_check",y.target.checked)}),a.jsx(tf,{htmlFor:"laboratorio_check",children:a.jsx(af,{children:"Laboratorio"})})]})}),i.laboratorio_check?a.jsx(sf,{children:a.jsxs(sn,{children:[a.jsx(on,{children:"Cantidad"}),a.jsx(Pa,{type:"number",min:"0",value:i.cantidad_laboratorio||"",onChange:y=>f("cantidad_laboratorio",y.target.value?Number(y.target.value):0)})]})}):null]}),a.jsxs(rf,{$enabled:!!i.cliente_check,style:{marginBottom:"1rem"},children:[a.jsx(nf,{children:a.jsxs(Zh,{children:[a.jsx(ef,{type:"checkbox",id:"cliente_check",checked:!!i.cliente_check,onChange:y=>m("cliente_check",y.target.checked)}),a.jsx(tf,{htmlFor:"cliente_check",children:a.jsx(af,{children:"Cliente"})})]})}),i.cliente_check?a.jsx(sf,{children:a.jsxs(sn,{children:[a.jsx(on,{children:"Cantidad"}),a.jsx(Pa,{type:"number",min:"0",value:i.cantidad_cliente||"",onChange:y=>f("cantidad_cliente",y.target.value?Number(y.target.value):0)})]})}):null]}),a.jsxs(rf,{$enabled:!!i.disenador_revision_check,children:[a.jsx(nf,{children:a.jsxs(Zh,{children:[a.jsx(ef,{type:"checkbox",id:"disenador_revision_check",checked:!!i.disenador_revision_check,onChange:y=>m("disenador_revision_check",y.target.checked)}),a.jsx(tf,{htmlFor:"disenador_revision_check",children:a.jsx(af,{children:"Diseador Revisin"})})]})}),i.disenador_revision_check?a.jsxs(sf,{children:[a.jsxs(sn,{children:[a.jsx(on,{children:"Nombre"}),a.jsx(Pa,{value:i.disenador_revision_nombre||"",onChange:y=>f("disenador_revision_nombre",y.target.value),placeholder:"Nombre del diseador revisor"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Direccin"}),a.jsx(Pa,{value:i.disenador_revision_direccion||"",onChange:y=>f("disenador_revision_direccion",y.target.value),placeholder:"Direccin"})]}),a.jsxs(sn,{children:[a.jsx(on,{children:"Cantidad"}),a.jsx(Pa,{type:"number",min:"0",value:i.cantidad_disenador_revision||"",onChange:y=>f("cantidad_disenador_revision",y.target.value?Number(y.target.value):0)})]})]}):null]})]}),a.jsxs(Rse,{children:[a.jsx(p4,{type:"button",onClick:g,children:"Cancelar"}),a.jsx(p4,{type:"submit",$primary:!0,disabled:h.isPending,children:h.isPending?"Creando...":"Crear Muestra"})]})]})]})}const Bse=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Use=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,Vse=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Hse=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1rem;
`,Wse=p.div`
  margin-bottom: 2rem;
`,Gse=p.h2`
  font-size: 1.1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary};
`,qse=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  cursor: ${({$status:e})=>e==="available"?"pointer":"default"};
  transition: all 0.2s;
  opacity: ${({$status:e})=>e==="disabled"?.5:1};

  &:hover {
    ${({$status:e})=>e==="available"&&`
      border-color: ${d.colors.primary};
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    `}
  }
`,Kse=p.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.5rem;
`,Xse=p.h3`
  font-size: 0.95rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Yse=p.span`
  font-size: 0.65rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  text-transform: uppercase;

  ${({$status:e})=>{switch(e){case"available":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"pending":return`
          background: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `;case"disabled":return`
          background: ${d.colors.textSecondary}20;
          color: ${d.colors.textSecondary};
        `}}}
`,Qse=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,Jse=p.div`
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
`,m4=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,g4=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,bb=[{name:"OTs y Gestion",reports:[{id:"active-ots-per-area",title:"OTs Activas por Usuario",description:"Visualiza la distribucion de OTs activas por usuario y area",icon:"",status:"available",route:"reporte-ots-activas"},{id:"completed-ots",title:"OTs Completadas",description:"Resumen de OTs completadas con metricas de tiempo",icon:"",status:"available",route:"reporte-ots-completadas"},{id:"completed-ots-dates",title:"OTs Completadas Entre Fechas",description:"Filtro avanzado de OTs completadas por rango de fechas",icon:"",status:"available",route:"reporte-ots-completadas-fechas"},{id:"gestion-ot-actives",title:"Gestion OTs Activas",description:"Dashboard de gestion de OTs en proceso",icon:"",status:"available",route:"reporte-gestion-ots-activas"},{id:"gestion-load-month",title:"Carga de OTs por Mes",description:"Analisis de carga de trabajo mensual",icon:"",status:"available",route:"reporte-carga-mensual"}]},{name:"Tiempos y Rendimiento",reports:[{id:"time-by-area",title:"Tiempo por Area",description:"Tiempo promedio de OTs por area mensual",icon:"",status:"available",route:"reporte-tiempo-area"},{id:"tiempo-disenador-externo",title:"Tiempo Disenador Externo",description:"Metricas de tiempo para disenadores externos",icon:"",status:"available",route:"reporte-tiempo-disenador-externo"},{id:"tiempo-primera-muestra",title:"Tiempo Primera Muestra",description:"Tiempo hasta la primera muestra por OT",icon:"",status:"available",route:"reporte-tiempo-primera-muestra"}]},{name:"Sala de Muestras",reports:[{id:"sala-muestra",title:"Sala de Muestra",description:"Estado y gestion de la sala de muestras",icon:"",status:"available",route:"reporte-sala-muestra"},{id:"indicador-sala-muestra",title:"Indicador Sala Muestra",description:"KPIs de la sala de muestras",icon:"",status:"available",route:"reporte-indicador-sala-muestra"},{id:"diseno-estructural-sala",title:"Diseno Estructural y Sala Muestra",description:"Relacion entre diseno y sala de muestras",icon:"",status:"available",route:"reporte-diseno-estructural-sala"},{id:"muestras",title:"Muestras",description:"Listado y estado de muestras",icon:"",status:"available",route:"reporte-muestras"}]},{name:"Rechazos y Anulaciones",reports:[{id:"anulaciones",title:"Anulaciones",description:"Registro de OTs anuladas con motivos y tendencias",icon:"",status:"available",route:"reporte-anulaciones"},{id:"rechazos-mes",title:"Rechazos por Mes",description:"Tendencia de rechazos mensual",icon:"",status:"available",route:"reporte-rechazos"},{id:"reasons-rejection",title:"Motivos de Rechazo",description:"Analisis de razones de rechazo por mes",icon:"",status:"available",route:"reporte-motivos-rechazo"}]}];function Zse({onNavigate:e}){const[t,r]=S.useState(null),n=l=>{l.status==="available"&&l.route?e(l.route):l.status==="pending"&&(r(l.id),setTimeout(()=>r(null),2e3))},i=l=>{switch(l){case"available":return"Disponible";case"pending":return"En desarrollo";case"disabled":return"Deshabilitado"}},s=bb.reduce((l,c)=>l+c.reports.length,0),o=bb.reduce((l,c)=>l+c.reports.filter(u=>u.status==="available").length,0);return a.jsxs(Bse,{children:[a.jsx(Use,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsxs(Vse,{children:["Reporteria (",o,"/",s," disponibles)"]}),a.jsx(m4,{children:a.jsx(g4,{children:'Los reportes estan siendo migrados desde el sistema Laravel. Cada reporte mostrara graficos interactivos con Chart.js y permitira filtrar por fechas, areas y usuarios. Los reportes marcados como "En desarrollo" estaran disponibles proximamente.'})}),t&&a.jsx(m4,{style:{background:`${d.colors.warning}10`,borderColor:`${d.colors.warning}30`},children:a.jsx(g4,{style:{color:d.colors.warning},children:"Este reporte esta en desarrollo. Estara disponible proximamente."})}),bb.map(l=>a.jsxs(Wse,{children:[a.jsx(Gse,{children:l.name}),a.jsx(Hse,{children:l.reports.map(c=>a.jsxs(qse,{$status:c.status,onClick:()=>n(c),children:[a.jsx(Jse,{children:c.icon}),a.jsxs(Kse,{children:[a.jsx(Xse,{children:c.title}),a.jsx(Yse,{$status:c.status,children:i(c.status)})]}),a.jsx(Qse,{children:c.description})]},c.id))})]},l.name))]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function $p(e){return e+.5|0}const yl=(e,t,r)=>Math.max(Math.min(e,r),t);function Wf(e){return yl($p(e*2.55),0,255)}function Pl(e){return yl($p(e*255),0,255)}function no(e){return yl($p(e/2.55)/100,0,1)}function x4(e){return yl($p(e*100),0,100)}const fi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Xw=[..."0123456789ABCDEF"],eoe=e=>Xw[e&15],toe=e=>Xw[(e&240)>>4]+Xw[e&15],dg=e=>(e&240)>>4===(e&15),roe=e=>dg(e.r)&&dg(e.g)&&dg(e.b)&&dg(e.a);function noe(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&fi[e[1]]*17,g:255&fi[e[2]]*17,b:255&fi[e[3]]*17,a:t===5?fi[e[4]]*17:255}:(t===7||t===9)&&(r={r:fi[e[1]]<<4|fi[e[2]],g:fi[e[3]]<<4|fi[e[4]],b:fi[e[5]]<<4|fi[e[6]],a:t===9?fi[e[7]]<<4|fi[e[8]]:255})),r}const aoe=(e,t)=>e<255?t(e):"";function ioe(e){var t=roe(e)?eoe:toe;return e?"#"+t(e.r)+t(e.g)+t(e.b)+aoe(e.a,t):void 0}const soe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function r6(e,t,r){const n=t*Math.min(r,1-r),i=(s,o=(s+e/30)%12)=>r-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function ooe(e,t,r){const n=(i,s=(i+e/60)%6)=>r-r*t*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function loe(e,t,r){const n=r6(e,1,.5);let i;for(t+r>1&&(i=1/(t+r),t*=i,r*=i),i=0;i<3;i++)n[i]*=1-t-r,n[i]+=t;return n}function coe(e,t,r,n,i){return e===i?(t-r)/n+(t<r?6:0):t===i?(r-e)/n+2:(e-t)/n+4}function cC(e){const r=e.r/255,n=e.g/255,i=e.b/255,s=Math.max(r,n,i),o=Math.min(r,n,i),l=(s+o)/2;let c,u,h;return s!==o&&(h=s-o,u=l>.5?h/(2-s-o):h/(s+o),c=coe(r,n,i,h,s),c=c*60+.5),[c|0,u||0,l]}function dC(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(Pl)}function uC(e,t,r){return dC(r6,e,t,r)}function doe(e,t,r){return dC(loe,e,t,r)}function uoe(e,t,r){return dC(ooe,e,t,r)}function n6(e){return(e%360+360)%360}function hoe(e){const t=soe.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?Wf(+t[5]):Pl(+t[5]));const i=n6(+t[2]),s=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=doe(i,s,o):t[1]==="hsv"?n=uoe(i,s,o):n=uC(i,s,o),{r:n[0],g:n[1],b:n[2],a:r}}function foe(e,t){var r=cC(e);r[0]=n6(r[0]+t),r=uC(r),e.r=r[0],e.g=r[1],e.b=r[2]}function poe(e){if(!e)return;const t=cC(e),r=t[0],n=x4(t[1]),i=x4(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${i}%, ${no(e.a)})`:`hsl(${r}, ${n}%, ${i}%)`}const v4={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},_4={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function moe(){const e={},t=Object.keys(_4),r=Object.keys(v4);let n,i,s,o,l;for(n=0;n<t.length;n++){for(o=l=t[n],i=0;i<r.length;i++)s=r[i],l=l.replace(s,v4[s]);s=parseInt(_4[o],16),e[l]=[s>>16&255,s>>8&255,s&255]}return e}let ug;function goe(e){ug||(ug=moe(),ug.transparent=[0,0,0,0]);const t=ug[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const xoe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function voe(e){const t=xoe.exec(e);let r=255,n,i,s;if(t){if(t[7]!==n){const o=+t[7];r=t[8]?Wf(o):yl(o*255,0,255)}return n=+t[1],i=+t[3],s=+t[5],n=255&(t[2]?Wf(n):yl(n,0,255)),i=255&(t[4]?Wf(i):yl(i,0,255)),s=255&(t[6]?Wf(s):yl(s,0,255)),{r:n,g:i,b:s,a:r}}}function _oe(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${no(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const jb=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Id=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function yoe(e,t,r){const n=Id(no(e.r)),i=Id(no(e.g)),s=Id(no(e.b));return{r:Pl(jb(n+r*(Id(no(t.r))-n))),g:Pl(jb(i+r*(Id(no(t.g))-i))),b:Pl(jb(s+r*(Id(no(t.b))-s))),a:e.a+r*(t.a-e.a)}}function hg(e,t,r){if(e){let n=cC(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=uC(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function a6(e,t){return e&&Object.assign(t||{},e)}function y4(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Pl(e[3]))):(t=a6(e,{r:0,g:0,b:0,a:1}),t.a=Pl(t.a)),t}function boe(e){return e.charAt(0)==="r"?voe(e):hoe(e)}class Y0{constructor(t){if(t instanceof Y0)return t;const r=typeof t;let n;r==="object"?n=y4(t):r==="string"&&(n=noe(t)||goe(t)||boe(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=a6(this._rgb);return t&&(t.a=no(t.a)),t}set rgb(t){this._rgb=y4(t)}rgbString(){return this._valid?_oe(this._rgb):void 0}hexString(){return this._valid?ioe(this._rgb):void 0}hslString(){return this._valid?poe(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,i=t.rgb;let s;const o=r===s?.5:r,l=2*o-1,c=n.a-i.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;s=1-u,n.r=255&u*n.r+s*i.r+.5,n.g=255&u*n.g+s*i.g+.5,n.b=255&u*n.b+s*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=yoe(this._rgb,t._rgb,r)),this}clone(){return new Y0(this.rgb)}alpha(t){return this._rgb.a=Pl(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=$p(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return hg(this._rgb,2,t),this}darken(t){return hg(this._rgb,2,-t),this}saturate(t){return hg(this._rgb,1,t),this}desaturate(t){return hg(this._rgb,1,-t),this}rotate(t){return foe(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Xs(){}const joe=(()=>{let e=0;return()=>e++})();function Tt(e){return e==null}function Pr(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function gt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Ln(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function _s(e,t){return Ln(e)?e:t}function ot(e,t){return typeof e>"u"?t:e}const woe=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,i6=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function qt(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function Mt(e,t,r,n){let i,s,o;if(Pr(e))for(s=e.length,i=0;i<s;i++)t.call(r,e[i],i);else if(gt(e))for(o=Object.keys(e),s=o.length,i=0;i<s;i++)t.call(r,e[o[i]],o[i])}function k1(e,t){let r,n,i,s;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(i=e[r],s=t[r],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function C1(e){if(Pr(e))return e.map(C1);if(gt(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let i=0;for(;i<n;++i)t[r[i]]=C1(e[r[i]]);return t}return e}function s6(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function koe(e,t,r,n){if(!s6(e))return;const i=t[e],s=r[e];gt(i)&&gt(s)?Q0(i,s,n):t[e]=C1(s)}function Q0(e,t,r){const n=Pr(t)?t:[t],i=n.length;if(!gt(e))return e;r=r||{};const s=r.merger||koe;let o;for(let l=0;l<i;++l){if(o=n[l],!gt(o))continue;const c=Object.keys(o);for(let u=0,h=c.length;u<h;++u)s(c[u],e,o,r)}return e}function f0(e,t){return Q0(e,t,{merger:Coe})}function Coe(e,t,r){if(!s6(e))return;const n=t[e],i=r[e];gt(n)&&gt(i)?f0(n,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=C1(i))}const b4={"":e=>e,x:e=>e.x,y:e=>e.y};function Soe(e){const t=e.split("."),r=[];let n="";for(const i of t)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function $oe(e){const t=Soe(e);return r=>{for(const n of t){if(n==="")break;r=r&&r[n]}return r}}function hd(e,t){return(b4[t]||(b4[t]=$oe(t)))(e)}function hC(e){return e.charAt(0).toUpperCase()+e.slice(1)}const J0=e=>typeof e<"u",Ll=e=>typeof e=="function",j4=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function Eoe(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Ot=Math.PI,ir=2*Ot,Toe=ir+Ot,S1=Number.POSITIVE_INFINITY,Aoe=Ot/180,Br=Ot/2,lc=Ot/4,w4=Ot*2/3,o6=Math.log10,Ms=Math.sign;function p0(e,t,r){return Math.abs(e-t)<r}function k4(e){const t=Math.round(e);e=p0(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(o6(e))),n=e/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function Foe(e){const t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n===0&&(t.push(n),t.push(e/n));return r===(r|0)&&t.push(r),t.sort((i,s)=>i-s).pop(),t}function Doe(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Z0(e){return!Doe(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Poe(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}function Moe(e,t,r){let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n][r],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function ho(e){return e*(Ot/180)}function Ooe(e){return e*(180/Ot)}function C4(e){if(!Ln(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function l6(e,t){const r=t.x-e.x,n=t.y-e.y,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*Ot&&(s+=ir),{angle:s,distance:i}}function Yw(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Roe(e,t){return(e-t+Toe)%ir-Ot}function Na(e){return(e%ir+ir)%ir}function ep(e,t,r,n){const i=Na(e),s=Na(t),o=Na(r),l=Na(s-i),c=Na(o-i),u=Na(i-s),h=Na(i-o);return i===s||i===o||n&&s===o||l>c&&u<h}function Mn(e,t,r){return Math.max(t,Math.min(r,e))}function Noe(e){return Mn(e,-32768,32767)}function fo(e,t,r,n=1e-6){return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function fC(e,t,r){r=r||(o=>e[o]<t);let n=e.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,r(s)?i=s:n=s;return{lo:i,hi:n}}const Dc=(e,t,r,n)=>fC(e,r,n?i=>{const s=e[i][t];return s<r||s===r&&e[i+1][t]===r}:i=>e[i][t]<r),zoe=(e,t,r)=>fC(e,r,n=>e[n][t]>=r);function Ioe(e,t,r){let n=0,i=e.length;for(;n<i&&e[n]<t;)n++;for(;i>n&&e[i-1]>r;)i--;return n>0||i<e.length?e.slice(n,i):e}const c6=["push","pop","shift","splice","unshift"];function Loe(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),c6.forEach(r=>{const n="_onData"+hC(r),i=e[r];Object.defineProperty(e,r,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return e._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...s)}),o}})})}function S4(e,t){const r=e._chartjs;if(!r)return;const n=r.listeners,i=n.indexOf(t);i!==-1&&n.splice(i,1),!(n.length>0)&&(c6.forEach(s=>{delete e[s]}),delete e._chartjs)}function d6(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const u6=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function h6(e,t){let r=[],n=!1;return function(...i){r=i,n||(n=!0,u6.call(window,()=>{n=!1,e.apply(t,r)}))}}function Boe(e,t){let r;return function(...n){return t?(clearTimeout(r),r=setTimeout(e,t,n)):e.apply(this,n),t}}const pC=e=>e==="start"?"left":e==="end"?"right":"center",Cn=(e,t,r)=>e==="start"?t:e==="end"?r:(t+r)/2,Uoe=(e,t,r,n)=>e===(n?"left":"right")?r:e==="center"?(t+r)/2:t;function Voe(e,t,r){const n=t.length;let i=0,s=n;if(e._sorted){const{iScale:o,vScale:l,_parsed:c}=e,u=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,h=o.axis,{min:f,max:m,minDefined:v,maxDefined:g}=o.getUserBounds();if(v){if(i=Math.min(Dc(c,h,f).lo,r?n:Dc(t,h,o.getPixelForValue(f)).lo),u){const x=c.slice(0,i+1).reverse().findIndex(_=>!Tt(_[l.axis]));i-=Math.max(0,x)}i=Mn(i,0,n-1)}if(g){let x=Math.max(Dc(c,o.axis,m,!0).hi+1,r?0:Dc(t,h,o.getPixelForValue(m),!0).hi+1);if(u){const _=c.slice(x-1).findIndex(b=>!Tt(b[l.axis]));x+=Math.max(0,_)}s=Mn(x,i,n)-i}else s=n-i}return{start:i,count:s}}function Hoe(e){const{xScale:t,yScale:r,_scaleRanges:n}=e,i={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!n)return e._scaleRanges=i,!0;const s=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,i),s}const fg=e=>e===0||e===1,$4=(e,t,r)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*ir/r)),E4=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*ir/r)+1,m0={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Br)+1,easeOutSine:e=>Math.sin(e*Br),easeInOutSine:e=>-.5*(Math.cos(Ot*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>fg(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>fg(e)?e:$4(e,.075,.3),easeOutElastic:e=>fg(e)?e:E4(e,.075,.3),easeInOutElastic(e){return fg(e)?e:e<.5?.5*$4(e*2,.1125,.45):.5+.5*E4(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-m0.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?m0.easeInBounce(e*2)*.5:m0.easeOutBounce(e*2-1)*.5+.5};function mC(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function T4(e){return mC(e)?e:new Y0(e)}function wb(e){return mC(e)?e:new Y0(e).saturate(.5).darken(.1).hexString()}const Woe=["x","y","borderWidth","radius","tension"],Goe=["color","borderColor","backgroundColor"];function qoe(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:Goe},numbers:{type:"number",properties:Woe}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Koe(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const A4=new Map;function Xoe(e,t){t=t||{};const r=e+JSON.stringify(t);let n=A4.get(r);return n||(n=new Intl.NumberFormat(e,t),A4.set(r,n)),n}function gC(e,t,r){return Xoe(t,r).format(e)}const Yoe={values(e){return Pr(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let i,s=e;if(r.length>1){const u=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(u<1e-4||u>1e15)&&(i="scientific"),s=Qoe(e,r)}const o=o6(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),gC(e,n,c)}};function Qoe(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var f6={formatters:Yoe};function Joe(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:f6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const fd=Object.create(null),Qw=Object.create(null);function g0(e,t){if(!t)return e;const r=t.split(".");for(let n=0,i=r.length;n<i;++n){const s=r[n];e=e[s]||(e[s]=Object.create(null))}return e}function kb(e,t,r){return typeof t=="string"?Q0(g0(e,t),r):Q0(g0(e,""),t)}class Zoe{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>wb(i.backgroundColor),this.hoverBorderColor=(n,i)=>wb(i.borderColor),this.hoverColor=(n,i)=>wb(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return kb(this,t,r)}get(t){return g0(this,t)}describe(t,r){return kb(Qw,t,r)}override(t,r){return kb(fd,t,r)}route(t,r,n,i){const s=g0(this,t),o=g0(this,n),l="_"+r;Object.defineProperties(s,{[l]:{value:s[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],u=o[i];return gt(c)?Object.assign({},u,c):ot(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(r=>r(this))}}var br=new Zoe({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[qoe,Koe,Joe]);function ele(e){return!e||Tt(e.size)||Tt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function F4(e,t,r,n,i){let s=t[i];return s||(s=t[i]=e.measureText(i).width,r.push(i)),s>n&&(n=s),n}function cc(e,t,r){const n=e.currentDevicePixelRatio,i=r!==0?Math.max(r/2,.5):0;return Math.round((t-i)*n)/n+i}function D4(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Jw(e,t,r,n){p6(e,t,r,n,null)}function p6(e,t,r,n,i){let s,o,l,c,u,h,f,m;const v=t.pointStyle,g=t.rotation,x=t.radius;let _=(g||0)*Aoe;if(v&&typeof v=="object"&&(s=v.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(r,n),e.rotate(_),e.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),e.restore();return}if(!(isNaN(x)||x<=0)){switch(e.beginPath(),v){default:i?e.ellipse(r,n,i/2,x,0,0,ir):e.arc(r,n,x,0,ir),e.closePath();break;case"triangle":h=i?i/2:x,e.moveTo(r+Math.sin(_)*h,n-Math.cos(_)*x),_+=w4,e.lineTo(r+Math.sin(_)*h,n-Math.cos(_)*x),_+=w4,e.lineTo(r+Math.sin(_)*h,n-Math.cos(_)*x),e.closePath();break;case"rectRounded":u=x*.516,c=x-u,o=Math.cos(_+lc)*c,f=Math.cos(_+lc)*(i?i/2-u:c),l=Math.sin(_+lc)*c,m=Math.sin(_+lc)*(i?i/2-u:c),e.arc(r-f,n-l,u,_-Ot,_-Br),e.arc(r+m,n-o,u,_-Br,_),e.arc(r+f,n+l,u,_,_+Br),e.arc(r-m,n+o,u,_+Br,_+Ot),e.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*x,h=i?i/2:c,e.rect(r-h,n-c,2*h,2*c);break}_+=lc;case"rectRot":f=Math.cos(_)*(i?i/2:x),o=Math.cos(_)*x,l=Math.sin(_)*x,m=Math.sin(_)*(i?i/2:x),e.moveTo(r-f,n-l),e.lineTo(r+m,n-o),e.lineTo(r+f,n+l),e.lineTo(r-m,n+o),e.closePath();break;case"crossRot":_+=lc;case"cross":f=Math.cos(_)*(i?i/2:x),o=Math.cos(_)*x,l=Math.sin(_)*x,m=Math.sin(_)*(i?i/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"star":f=Math.cos(_)*(i?i/2:x),o=Math.cos(_)*x,l=Math.sin(_)*x,m=Math.sin(_)*(i?i/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o),_+=lc,f=Math.cos(_)*(i?i/2:x),o=Math.cos(_)*x,l=Math.sin(_)*x,m=Math.sin(_)*(i?i/2:x),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"line":o=i?i/2:Math.cos(_)*x,l=Math.sin(_)*x,e.moveTo(r-o,n-l),e.lineTo(r+o,n+l);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(_)*(i?i/2:x),n+Math.sin(_)*x);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function tp(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function mv(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function gv(e){e.restore()}function tle(e,t,r,n,i){if(!t)return e.lineTo(r.x,r.y);if(i==="middle"){const s=(t.x+r.x)/2;e.lineTo(s,t.y),e.lineTo(s,r.y)}else i==="after"!=!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function rle(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function nle(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Tt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function ale(e,t,r,n,i){if(i.strikethrough||i.underline){const s=e.measureText(n),o=t-s.actualBoundingBoxLeft,l=t+s.actualBoundingBoxRight,c=r-s.actualBoundingBoxAscent,u=r+s.actualBoundingBoxDescent,h=i.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(o,h),e.lineTo(l,h),e.stroke()}}function ile(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function rp(e,t,r,n,i,s={}){const o=Pr(t)?t:[t],l=s.strokeWidth>0&&s.strokeColor!=="";let c,u;for(e.save(),e.font=i.string,nle(e,s),c=0;c<o.length;++c)u=o[c],s.backdrop&&ile(e,s.backdrop),l&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),Tt(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(u,r,n,s.maxWidth)),e.fillText(u,r,n,s.maxWidth),ale(e,r,n,u,s),n+=Number(i.lineHeight);e.restore()}function $1(e,t){const{x:r,y:n,w:i,h:s,radius:o}=t;e.arc(r+o.topLeft,n+o.topLeft,o.topLeft,1.5*Ot,Ot,!0),e.lineTo(r,n+s-o.bottomLeft),e.arc(r+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,Ot,Br,!0),e.lineTo(r+i-o.bottomRight,n+s),e.arc(r+i-o.bottomRight,n+s-o.bottomRight,o.bottomRight,Br,0,!0),e.lineTo(r+i,n+o.topRight),e.arc(r+i-o.topRight,n+o.topRight,o.topRight,0,-Br,!0),e.lineTo(r+o.topLeft,n)}const sle=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ole=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function lle(e,t){const r=(""+e).match(sle);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const cle=e=>+e||0;function xC(e,t){const r={},n=gt(t),i=n?Object.keys(t):t,s=gt(e)?n?o=>ot(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of i)r[o]=cle(s(o));return r}function m6(e){return xC(e,{top:"y",right:"x",bottom:"y",left:"x"})}function _u(e){return xC(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Di(e){const t=m6(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function On(e,t){e=e||{},t=t||br.font;let r=ot(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=ot(e.style,t.style);n&&!(""+n).match(ole)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:ot(e.family,t.family),lineHeight:lle(ot(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:ot(e.weight,t.weight),string:""};return i.string=ele(i),i}function pg(e,t,r,n){let i,s,o;for(i=0,s=e.length;i<s;++i)if(o=e[i],o!==void 0&&o!==void 0)return o}function dle(e,t,r){const{min:n,max:i}=e,s=i6(t,(i-n)/2),o=(l,c)=>r&&l===0?0:l+c;return{min:o(n,-Math.abs(s)),max:o(i,s)}}function wd(e,t){return Object.assign(Object.create(e),t)}function vC(e,t=[""],r,n,i=()=>e[0]){const s=r||e;typeof n>"u"&&(n=_6("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:n,_getTarget:i,override:l=>vC([l,...e],t,s,n)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return x6(l,c,()=>vle(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return M4(l).includes(c)},ownKeys(l){return M4(l)},set(l,c,u){const h=l._storage||(l._storage=i());return l[c]=h[c]=u,delete l._keys,!0}})}function Yu(e,t,r,n){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:g6(e,n),setContext:s=>Yu(e,s,r,n),override:s=>Yu(e.override(s),t,r,n)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete e[o],!0},get(s,o,l){return x6(s,o,()=>hle(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(s,o,l){return e[o]=l,delete s[o],!0}})}function g6(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:r,indexable:n,isScriptable:Ll(r)?r:()=>r,isIndexable:Ll(n)?n:()=>n}}const ule=(e,t)=>e?e+hC(t):t,_C=(e,t)=>gt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function x6(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const n=r();return e[t]=n,n}function hle(e,t,r){const{_proxy:n,_context:i,_subProxy:s,_descriptors:o}=e;let l=n[t];return Ll(l)&&o.isScriptable(t)&&(l=fle(t,l,e,r)),Pr(l)&&l.length&&(l=ple(t,l,e,o.isIndexable)),_C(t,l)&&(l=Yu(l,i,s&&s[t],o)),l}function fle(e,t,r,n){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=r;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(s,o||n);return l.delete(e),_C(e,c)&&(c=yC(i._scopes,i,e,c)),c}function ple(e,t,r,n){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=r;if(typeof s.index<"u"&&n(e))return t[s.index%t.length];if(gt(t[0])){const c=t,u=i._scopes.filter(h=>h!==c);t=[];for(const h of c){const f=yC(u,i,e,h);t.push(Yu(f,s,o&&o[e],l))}}return t}function v6(e,t,r){return Ll(e)?e(t,r):e}const mle=(e,t)=>e===!0?t:typeof e=="string"?hd(t,e):void 0;function gle(e,t,r,n,i){for(const s of t){const o=mle(r,s);if(o){e.add(o);const l=v6(o._fallback,r,i);if(typeof l<"u"&&l!==r&&l!==n)return l}else if(o===!1&&typeof n<"u"&&r!==n)return null}return!1}function yC(e,t,r,n){const i=t._rootScopes,s=v6(t._fallback,r,n),o=[...e,...i],l=new Set;l.add(n);let c=P4(l,o,r,s||r,n);return c===null||typeof s<"u"&&s!==r&&(c=P4(l,o,s,c,n),c===null)?!1:vC(Array.from(l),[""],i,s,()=>xle(t,r,n))}function P4(e,t,r,n,i){for(;r;)r=gle(e,t,r,n,i);return r}function xle(e,t,r){const n=e._getTarget();t in n||(n[t]={});const i=n[t];return Pr(i)&&gt(r)?r:i||{}}function vle(e,t,r,n){let i;for(const s of t)if(i=_6(ule(s,e),r),typeof i<"u")return _C(e,i)?yC(r,n,e,i):i}function _6(e,t){for(const r of t){if(!r)continue;const n=r[e];if(typeof n<"u")return n}}function M4(e){let t=e._keys;return t||(t=e._keys=_le(e._scopes)),t}function _le(e){const t=new Set;for(const r of e)for(const n of Object.keys(r).filter(i=>!i.startsWith("_")))t.add(n);return Array.from(t)}const yle=Number.EPSILON||1e-14,Qu=(e,t)=>t<e.length&&!e[t].skip&&e[t],y6=e=>e==="x"?"y":"x";function ble(e,t,r,n){const i=e.skip?t:e,s=t,o=r.skip?t:r,l=Yw(s,i),c=Yw(o,s);let u=l/(l+c),h=c/(l+c);u=isNaN(u)?0:u,h=isNaN(h)?0:h;const f=n*u,m=n*h;return{previous:{x:s.x-f*(o.x-i.x),y:s.y-f*(o.y-i.y)},next:{x:s.x+m*(o.x-i.x),y:s.y+m*(o.y-i.y)}}}function jle(e,t,r){const n=e.length;let i,s,o,l,c,u=Qu(e,0);for(let h=0;h<n-1;++h)if(c=u,u=Qu(e,h+1),!(!c||!u)){if(p0(t[h],0,yle)){r[h]=r[h+1]=0;continue}i=r[h]/t[h],s=r[h+1]/t[h],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),r[h]=i*o*t[h],r[h+1]=s*o*t[h])}}function wle(e,t,r="x"){const n=y6(r),i=e.length;let s,o,l,c=Qu(e,0);for(let u=0;u<i;++u){if(o=l,l=c,c=Qu(e,u+1),!l)continue;const h=l[r],f=l[n];o&&(s=(h-o[r])/3,l[`cp1${r}`]=h-s,l[`cp1${n}`]=f-s*t[u]),c&&(s=(c[r]-h)/3,l[`cp2${r}`]=h+s,l[`cp2${n}`]=f+s*t[u])}}function kle(e,t="x"){const r=y6(t),n=e.length,i=Array(n).fill(0),s=Array(n);let o,l,c,u=Qu(e,0);for(o=0;o<n;++o)if(l=c,c=u,u=Qu(e,o+1),!!c){if(u){const h=u[t]-c[t];i[o]=h!==0?(u[r]-c[r])/h:0}s[o]=l?u?Ms(i[o-1])!==Ms(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}jle(e,i,s),wle(e,s,t)}function mg(e,t,r){return Math.max(Math.min(e,r),t)}function Cle(e,t){let r,n,i,s,o,l=tp(e[0],t);for(r=0,n=e.length;r<n;++r)o=s,s=l,l=r<n-1&&tp(e[r+1],t),s&&(i=e[r],o&&(i.cp1x=mg(i.cp1x,t.left,t.right),i.cp1y=mg(i.cp1y,t.top,t.bottom)),l&&(i.cp2x=mg(i.cp2x,t.left,t.right),i.cp2y=mg(i.cp2y,t.top,t.bottom)))}function Sle(e,t,r,n,i){let s,o,l,c;if(t.spanGaps&&(e=e.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")kle(e,i);else{let u=n?e[e.length-1]:e[0];for(s=0,o=e.length;s<o;++s)l=e[s],c=ble(u,l,e[Math.min(s+1,o-(n?0:1))%o],t.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}t.capBezierPoints&&Cle(e,r)}function bC(){return typeof window<"u"&&typeof document<"u"}function jC(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function E1(e,t,r){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[r])):n=e,n}const xv=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function $le(e,t){return xv(e).getPropertyValue(t)}const Ele=["top","right","bottom","left"];function Yc(e,t,r){const n={};r=r?"-"+r:"";for(let i=0;i<4;i++){const s=Ele[i];n[s]=parseFloat(e[t+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const Tle=(e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot);function Ale(e,t){const r=e.touches,n=r&&r.length?r[0]:e,{offsetX:i,offsetY:s}=n;let o=!1,l,c;if(Tle(i,s,e.target))l=i,c=s;else{const u=t.getBoundingClientRect();l=n.clientX-u.left,c=n.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function jc(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:n}=t,i=xv(r),s=i.boxSizing==="border-box",o=Yc(i,"padding"),l=Yc(i,"border","width"),{x:c,y:u,box:h}=Ale(e,r),f=o.left+(h&&l.left),m=o.top+(h&&l.top);let{width:v,height:g}=t;return s&&(v-=o.width+l.width,g-=o.height+l.height),{x:Math.round((c-f)/v*r.width/n),y:Math.round((u-m)/g*r.height/n)}}function Fle(e,t,r){let n,i;if(t===void 0||r===void 0){const s=e&&jC(e);if(!s)t=e.clientWidth,r=e.clientHeight;else{const o=s.getBoundingClientRect(),l=xv(s),c=Yc(l,"border","width"),u=Yc(l,"padding");t=o.width-u.width-c.width,r=o.height-u.height-c.height,n=E1(l.maxWidth,s,"clientWidth"),i=E1(l.maxHeight,s,"clientHeight")}}return{width:t,height:r,maxWidth:n||S1,maxHeight:i||S1}}const bl=e=>Math.round(e*10)/10;function Dle(e,t,r,n){const i=xv(e),s=Yc(i,"margin"),o=E1(i.maxWidth,e,"clientWidth")||S1,l=E1(i.maxHeight,e,"clientHeight")||S1,c=Fle(e,t,r);let{width:u,height:h}=c;if(i.boxSizing==="content-box"){const m=Yc(i,"border","width"),v=Yc(i,"padding");u-=v.width+m.width,h-=v.height+m.height}return u=Math.max(0,u-s.width),h=Math.max(0,n?u/n:h-s.height),u=bl(Math.min(u,o,c.maxWidth)),h=bl(Math.min(h,l,c.maxHeight)),u&&!h&&(h=bl(u/2)),(t!==void 0||r!==void 0)&&n&&c.height&&h>c.height&&(h=c.height,u=bl(Math.floor(h*n))),{width:u,height:h}}function O4(e,t,r){const n=t||1,i=bl(e.height*n),s=bl(e.width*n);e.height=bl(e.height),e.width=bl(e.width);const o=e.canvas;return o.style&&(r||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||o.height!==i||o.width!==s?(e.currentDevicePixelRatio=n,o.height=i,o.width=s,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Ple=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};bC()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function R4(e,t){const r=$le(e,t),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function wc(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function Mle(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:n==="middle"?r<.5?e.y:t.y:n==="after"?r<1?e.y:t.y:r>0?t.y:e.y}}function Ole(e,t,r,n){const i={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},o=wc(e,i,r),l=wc(i,s,r),c=wc(s,t,r),u=wc(o,l,r),h=wc(l,c,r);return wc(u,h,r)}const Rle=function(e,t){return{x(r){return e+e+t-r},setWidth(r){t=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},Nle=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function yu(e,t,r){return e?Rle(t,r):Nle()}function b6(e,t){let r,n;(t==="ltr"||t==="rtl")&&(r=e.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function j6(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function w6(e){return e==="angle"?{between:ep,compare:Roe,normalize:Na}:{between:fo,compare:(t,r)=>t-r,normalize:t=>t}}function N4({start:e,end:t,count:r,loop:n,style:i}){return{start:e%r,end:t%r,loop:n&&(t-e+1)%r===0,style:i}}function zle(e,t,r){const{property:n,start:i,end:s}=r,{between:o,normalize:l}=w6(n),c=t.length;let{start:u,end:h,loop:f}=e,m,v;if(f){for(u+=c,h+=c,m=0,v=c;m<v&&o(l(t[u%c][n]),i,s);++m)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:f,style:e.style}}function k6(e,t,r){if(!r)return[e];const{property:n,start:i,end:s}=r,o=t.length,{compare:l,between:c,normalize:u}=w6(n),{start:h,end:f,loop:m,style:v}=zle(e,t,r),g=[];let x=!1,_=null,b,y,j;const k=()=>c(i,j,b)&&l(i,j)!==0,E=()=>l(s,b)===0||c(s,j,b),A=()=>x||k(),w=()=>!x||E();for(let P=h,M=h;P<=f;++P)y=t[P%o],!y.skip&&(b=u(y[n]),b!==j&&(x=c(b,i,s),_===null&&A()&&(_=l(b,i)===0?P:M),_!==null&&w()&&(g.push(N4({start:_,end:P,loop:m,count:o,style:v})),_=null),M=P,j=b));return _!==null&&g.push(N4({start:_,end:f,loop:m,count:o,style:v})),g}function C6(e,t){const r=[],n=e.segments;for(let i=0;i<n.length;i++){const s=k6(n[i],e.points,t);s.length&&r.push(...s)}return r}function Ile(e,t,r,n){let i=0,s=t-1;if(r&&!n)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,r&&(s+=i);s>i&&e[s%t].skip;)s--;return s%=t,{start:i,end:s}}function Lle(e,t,r,n){const i=e.length,s=[];let o=t,l=e[t],c;for(c=t+1;c<=r;++c){const u=e[c%i];u.skip||u.stop?l.skip||(n=!1,s.push({start:t%i,end:(c-1)%i,loop:n}),t=o=u.stop?c:null):(o=c,l.skip&&(t=c)),l=u}return o!==null&&s.push({start:t%i,end:o%i,loop:n}),s}function Ble(e,t){const r=e.points,n=e.options.spanGaps,i=r.length;if(!i)return[];const s=!!e._loop,{start:o,end:l}=Ile(r,i,s,n);if(n===!0)return z4(e,[{start:o,end:l,loop:s}],r,t);const c=l<o?l+i:l,u=!!e._fullLoop&&o===0&&l===i-1;return z4(e,Lle(r,o,c,u),r,t)}function z4(e,t,r,n){return!n||!n.setContext||!r?t:Ule(e,t,r,n)}function Ule(e,t,r,n){const i=e._chart.getContext(),s=I4(e.options),{_datasetIndex:o,options:{spanGaps:l}}=e,c=r.length,u=[];let h=s,f=t[0].start,m=f;function v(g,x,_,b){const y=l?-1:1;if(g!==x){for(g+=c;r[g%c].skip;)g-=y;for(;r[x%c].skip;)x+=y;g%c!==x%c&&(u.push({start:g%c,end:x%c,loop:_,style:b}),h=b,f=x%c)}}for(const g of t){f=l?f:g.start;let x=r[f%c],_;for(m=f+1;m<=g.end;m++){const b=r[m%c];_=I4(n.setContext(wd(i,{type:"segment",p0:x,p1:b,p0DataIndex:(m-1)%c,p1DataIndex:m%c,datasetIndex:o}))),Vle(_,h)&&v(f,m-1,g.loop,h),x=b,h=_}f<m-1&&v(f,m-1,g.loop,h)}return u}function I4(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Vle(e,t){if(!t)return!1;const r=[],n=function(i,s){return mC(s)?(r.includes(s)||r.push(s),r.indexOf(s)):s};return JSON.stringify(e,n)!==JSON.stringify(t,n)}function gg(e,t,r){return e.options.clip?e[r]:t[r]}function Hle(e,t){const{xScale:r,yScale:n}=e;return r&&n?{left:gg(r,t,"left"),right:gg(r,t,"right"),top:gg(n,t,"top"),bottom:gg(n,t,"bottom")}:t}function S6(e,t){const r=t._clip;if(r.disabled)return!1;const n=Hle(t,e.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?e.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?e.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Wle{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,n,i){const s=r.listeners[i],o=r.duration;s.forEach(l=>l({chart:t,initial:r.initial,numSteps:o,currentStep:Math.min(n-r.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=u6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let r=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,l=!1,c;for(;o>=0;--o)c=s[o],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(t),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,n,t,"progress")),s.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),r+=s.length}),this._lastDate=t,r===0&&(this._running=!1)}_getAnims(t){const r=this._charts;let n=r.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(t,n)),n}listen(t,r,n){this._getAnims(t).listeners[r].push(n)}add(t,r){!r||!r.length||this._getAnims(t).items.push(...r)}has(t){return this._getAnims(t).items.length>0}start(t){const r=this._charts.get(t);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const r=this._charts.get(t);return!(!r||!r.running||!r.items.length)}stop(t){const r=this._charts.get(t);if(!r||!r.items.length)return;const n=r.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Qs=new Wle;const L4="transparent",Gle={boolean(e,t,r){return r>.5?t:e},color(e,t,r){const n=T4(e||L4),i=n.valid&&T4(t||L4);return i&&i.valid?i.mix(n,r).hexString():t},number(e,t,r){return e+(t-e)*r}};class qle{constructor(t,r,n,i){const s=r[n];i=pg([t.to,i,s,t.from]);const o=pg([t.from,s,i]);this._active=!0,this._fn=t.fn||Gle[t.type||typeof o],this._easing=m0[t.easing]||m0.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=r,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,r,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=pg([t.to,r,i,t.from]),this._from=pg([t.from,i,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const r=t-this._start,n=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let c;if(this._active=s!==l&&(o||r<n),!this._active){this._target[i]=l,this._notify(!0);return}if(r<0){this._target[i]=s;return}c=r/n%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[i]=this._fn(s,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((r,n)=>{t.push({res:r,rej:n})})}_notify(t){const r=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][r]()}}class $6{constructor(t,r){this._chart=t,this._properties=new Map,this.configure(r)}configure(t){if(!gt(t))return;const r=Object.keys(br.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!gt(s))return;const o={};for(const l of r)o[l]=s[l];(Pr(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!n.has(l))&&n.set(l,o)})})}_animateOptions(t,r){const n=r.options,i=Xle(t,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&Kle(t.options.$animations,n).then(()=>{t.options=n},()=>{}),s}_createAnimations(t,r){const n=this._properties,i=[],s=t.$animations||(t.$animations={}),o=Object.keys(r),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){i.push(...this._animateOptions(t,r));continue}const h=r[u];let f=s[u];const m=n.get(u);if(f)if(m&&f.active()){f.update(m,h,l);continue}else f.cancel();if(!m||!m.duration){t[u]=h;continue}s[u]=f=new qle(m,t,u,h),i.push(f)}return i}update(t,r){if(this._properties.size===0){Object.assign(t,r);return}const n=this._createAnimations(t,r);if(n.length)return Qs.add(this._chart,n),!0}}function Kle(e,t){const r=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const s=e[n[i]];s&&s.active()&&r.push(s.wait())}return Promise.all(r)}function Xle(e,t){if(!t)return;let r=e.options;if(!r){e.options=t;return}return r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function B4(e,t){const r=e&&e.options||{},n=r.reverse,i=r.min===void 0?t:0,s=r.max===void 0?t:0;return{start:n?s:i,end:n?i:s}}function Yle(e,t,r){if(r===!1)return!1;const n=B4(e,r),i=B4(t,r);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function Qle(e){let t,r,n,i;return gt(e)?(t=e.top,r=e.right,n=e.bottom,i=e.left):t=r=n=i=e,{top:t,right:r,bottom:n,left:i,disabled:e===!1}}function E6(e,t){const r=[],n=e._getSortedDatasetMetas(t);let i,s;for(i=0,s=n.length;i<s;++i)r.push(n[i].index);return r}function U4(e,t,r,n={}){const i=e.keys,s=n.mode==="single";let o,l,c,u;if(t===null)return;let h=!1;for(o=0,l=i.length;o<l;++o){if(c=+i[o],c===r){if(h=!0,n.all)continue;break}u=e.values[c],Ln(u)&&(s||t===0||Ms(t)===Ms(u))&&(t+=u)}return!h&&!n.all?0:t}function Jle(e,t){const{iScale:r,vScale:n}=t,i=r.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,h;for(c=0,u=o.length;c<u;++c)h=o[c],l[c]={[i]:h,[s]:e[h]};return l}function Cb(e,t){const r=e&&e.options.stacked;return r||r===void 0&&t.stack!==void 0}function Zle(e,t,r){return`${e.id}.${t.id}.${r.stack||r.type}`}function ece(e){const{min:t,max:r,minDefined:n,maxDefined:i}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}function tce(e,t,r){const n=e[t]||(e[t]={});return n[r]||(n[r]={})}function V4(e,t,r,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const s=e[i.index];if(r&&s>0||!r&&s<0)return i.index}return null}function H4(e,t){const{chart:r,_cachedMeta:n}=e,i=r._stacks||(r._stacks={}),{iScale:s,vScale:o,index:l}=n,c=s.axis,u=o.axis,h=Zle(s,o,n),f=t.length;let m;for(let v=0;v<f;++v){const g=t[v],{[c]:x,[u]:_}=g,b=g._stacks||(g._stacks={});m=b[u]=tce(i,h,x),m[l]=_,m._top=V4(m,o,!0,n.type),m._bottom=V4(m,o,!1,n.type);const y=m._visualValues||(m._visualValues={});y[l]=_}}function Sb(e,t){const r=e.scales;return Object.keys(r).filter(n=>r[n].axis===t).shift()}function rce(e,t){return wd(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function nce(e,t,r){return wd(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function of(e,t){const r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const i of t){const s=i._stacks;if(!s||s[n]===void 0||s[n][r]===void 0)return;delete s[n][r],s[n]._visualValues!==void 0&&s[n]._visualValues[r]!==void 0&&delete s[n]._visualValues[r]}}}const $b=e=>e==="reset"||e==="none",W4=(e,t)=>t?e:Object.assign({},e),ace=(e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:E6(r,!0),values:null};class Qc{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Cb(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&of(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,n=this.getDataset(),i=(f,m,v,g)=>f==="x"?m:f==="r"?g:v,s=r.xAxisID=ot(n.xAxisID,Sb(t,"x")),o=r.yAxisID=ot(n.yAxisID,Sb(t,"y")),l=r.rAxisID=ot(n.rAxisID,Sb(t,"r")),c=r.indexAxis,u=r.iAxisID=i(c,s,o,l),h=r.vAxisID=i(c,o,s,l);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(o),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&S4(this._data,this),t._stacked&&of(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),n=this._data;if(gt(r)){const i=this._cachedMeta;this._data=Jle(r,i)}else if(n!==r){if(n){S4(n,this);const i=this._cachedMeta;of(i),i._parsed=[]}r&&Object.isExtensible(r)&&Loe(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=r._stacked;r._stacked=Cb(r.vScale,r),r.stack!==n.stack&&(i=!0,of(r),r.stack=n.stack),this._resyncElements(t),(i||s!==r._stacked)&&(H4(this,r._parsed),r._stacked=Cb(r.vScale,r))}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:o}=n,l=s.axis;let c=t===0&&r===i.length?!0:n._sorted,u=t>0&&n._parsed[t-1],h,f,m;if(this._parsing===!1)n._parsed=i,n._sorted=!0,m=i;else{Pr(i[t])?m=this.parseArrayData(n,i,t,r):gt(i[t])?m=this.parseObjectData(n,i,t,r):m=this.parsePrimitiveData(n,i,t,r);const v=()=>f[l]===null||u&&f[l]<u[l];for(h=0;h<r;++h)n._parsed[h+t]=f=m[h],c&&(v()&&(c=!1),u=f);n._sorted=c}o&&H4(this,m)}parsePrimitiveData(t,r,n,i){const{iScale:s,vScale:o}=t,l=s.axis,c=o.axis,u=s.getLabels(),h=s===o,f=new Array(i);let m,v,g;for(m=0,v=i;m<v;++m)g=m+n,f[m]={[l]:h||s.parse(u[g],g),[c]:o.parse(r[g],g)};return f}parseArrayData(t,r,n,i){const{xScale:s,yScale:o}=t,l=new Array(i);let c,u,h,f;for(c=0,u=i;c<u;++c)h=c+n,f=r[h],l[c]={x:s.parse(f[0],h),y:o.parse(f[1],h)};return l}parseObjectData(t,r,n,i){const{xScale:s,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(i);let h,f,m,v;for(h=0,f=i;h<f;++h)m=h+n,v=r[m],u[h]={x:s.parse(hd(v,l),m),y:o.parse(hd(v,c),m)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,n){const i=this.chart,s=this._cachedMeta,o=r[t.axis],l={keys:E6(i,!0),values:r._stacks[t.axis]._visualValues};return U4(l,o,s.index,{mode:n})}updateRangeFromParsed(t,r,n,i){const s=n[r.axis];let o=s===null?NaN:s;const l=i&&n._stacks[r.axis];i&&l&&(i.values=l,o=U4(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,r){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&t===n.iScale,o=i.length,l=this._getOtherScale(t),c=ace(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=ece(l);let m,v;function g(){v=i[m];const x=v[l.axis];return!Ln(v[t.axis])||h>x||f<x}for(m=0;m<o&&!(!g()&&(this.updateRangeFromParsed(u,t,v,c),s));++m);if(s){for(m=o-1;m>=0;--m)if(!g()){this.updateRangeFromParsed(u,t,v,c);break}}return u}getAllParsedValues(t){const r=this._cachedMeta._parsed,n=[];let i,s,o;for(i=0,s=r.length;i<s;++i)o=r[i][t.axis],Ln(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,n=r.iScale,i=r.vScale,s=this.getParsed(t);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=Qle(ot(this.options.clip,Yle(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,r=this.chart,n=this._cachedMeta,i=n.data||[],s=r.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||i.length-l,u=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(t,s,l,c),h=l;h<l+c;++h){const f=i[h];f.hidden||(f.active&&u?o.push(f):f.draw(t,s))}for(h=0;h<o.length;++h)o[h].draw(t,s)}getStyle(t,r){const n=r?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,r,n){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];s=o.$context||(o.$context=nce(this.getContext(),t,o)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=rce(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",n){const i=r==="active",s=this._cachedDataOpts,o=t+"-"+r,l=s[o],c=this.enableOptionSharing&&J0(n);if(l)return W4(l,c);const u=this.chart.config,h=u.datasetElementScopeKeys(this._type,t),f=i?[`${t}Hover`,"hover",t,""]:[t,""],m=u.getOptionScopes(this.getDataset(),h),v=Object.keys(br.elements[t]),g=()=>this.getContext(n,i,r),x=u.resolveNamedOptions(m,v,g,f);return x.$shared&&(x.$shared=c,s[o]=Object.freeze(W4(x,c))),x}_resolveAnimations(t,r,n){const i=this.chart,s=this._cachedDataOpts,o=`animation-${r}`,l=s[o];if(l)return l;let c;if(i.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,r),m=h.getOptionScopes(this.getDataset(),f);c=h.createResolver(m,this.getContext(t,n,r))}const u=new $6(i,c&&c.animations);return c&&c._cacheable&&(s[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||$b(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const n=this.resolveDataElementOptions(t,r),i=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(r,s)||s!==i;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:o}}updateElement(t,r,n,i){$b(i)?Object.assign(t,n):this._resolveAnimations(r,i).update(t,n)}updateSharedOptions(t,r,n){t&&!$b(r)&&this._resolveAnimations(void 0,r).update(t,n)}_setStyle(t,r,n,i){t.active=i;const s=this.getStyle(r,i);this._resolveAnimations(r,n,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,r,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,r,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,n=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const i=n.length,s=r.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,r,n=!0){const i=this._cachedMeta,s=i.data,o=t+r;let l;const c=u=>{for(u.length+=r,l=u.length-1;l>=o;l--)u[l]=u[l-r]};for(c(s),l=t;l<o;++l)s[l]=new this.dataElementType;this._parsing&&c(i._parsed),this.parse(t,r),n&&this.updateElements(s,t,r,"reset")}updateElements(t,r,n,i){}_removeElements(t,r){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,r);n._stacked&&of(n,i)}n.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,n,i]=t;this[r](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Le(Qc,"defaults",{}),Le(Qc,"datasetElementType",null),Le(Qc,"dataElementType",null);function ice(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let n=[];for(let i=0,s=r.length;i<s;i++)n=n.concat(r[i].controller.getAllParsedValues(e));e._cache.$bar=d6(n.sort((i,s)=>i-s))}return e._cache.$bar}function sce(e){const t=e.iScale,r=ice(t,e.type);let n=t._length,i,s,o,l;const c=()=>{o===32767||o===-32768||(J0(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(i=0,s=r.length;i<s;++i)o=t.getPixelForValue(r[i]),c();for(l=void 0,i=0,s=t.ticks.length;i<s;++i)o=t.getPixelForTick(i),c();return n}function oce(e,t,r,n){const i=r.barThickness;let s,o;return Tt(i)?(s=t.min*r.categoryPercentage,o=r.barPercentage):(s=i*n,o=1),{chunk:s/n,ratio:o,start:t.pixels[e]-s/2}}function lce(e,t,r,n){const i=t.pixels,s=i[e];let o=e>0?i[e-1]:null,l=e<i.length-1?i[e+1]:null;const c=r.categoryPercentage;o===null&&(o=s-(l===null?t.end-t.start:l-s)),l===null&&(l=s+s-o);const u=s-(s-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/n,ratio:r.barPercentage,start:u}}function cce(e,t,r,n){const i=r.parse(e[0],n),s=r.parse(e[1],n),o=Math.min(i,s),l=Math.max(i,s);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[r.axis]=u,t._custom={barStart:c,barEnd:u,start:i,end:s,min:o,max:l}}function T6(e,t,r,n){return Pr(e)?cce(e,t,r,n):t[r.axis]=r.parse(e,n),t}function G4(e,t,r,n){const i=e.iScale,s=e.vScale,o=i.getLabels(),l=i===s,c=[];let u,h,f,m;for(u=r,h=r+n;u<h;++u)m=t[u],f={},f[i.axis]=l||i.parse(o[u],u),c.push(T6(m,f,s,u));return c}function Eb(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function dce(e,t,r){return e!==0?Ms(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}function uce(e){let t,r,n,i,s;return e.horizontal?(t=e.base>e.x,r="left",n="right"):(t=e.base<e.y,r="bottom",n="top"),t?(i="end",s="start"):(i="start",s="end"),{start:r,end:n,reverse:t,top:i,bottom:s}}function hce(e,t,r,n){let i=t.borderSkipped;const s={};if(!i){e.borderSkipped=s;return}if(i===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:h}=uce(e);i==="middle"&&r&&(e.enableBorderRadius=!0,(r._top||0)===n?i=u:(r._bottom||0)===n?i=h:(s[q4(h,o,l,c)]=!0,i=u)),s[q4(i,o,l,c)]=!0,e.borderSkipped=s}function q4(e,t,r,n){return n?(e=fce(e,t,r),e=K4(e,r,t)):e=K4(e,t,r),e}function fce(e,t,r){return e===t?r:e===r?t:e}function K4(e,t,r){return e==="start"?t:e==="end"?r:e}function pce(e,{inflateAmount:t},r){e.inflateAmount=t==="auto"?r===1?.33:0:t}class Ex extends Qc{parsePrimitiveData(t,r,n,i){return G4(t,r,n,i)}parseArrayData(t,r,n,i){return G4(t,r,n,i)}parseObjectData(t,r,n,i){const{iScale:s,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=s.axis==="x"?l:c,h=o.axis==="x"?l:c,f=[];let m,v,g,x;for(m=n,v=n+i;m<v;++m)x=r[m],g={},g[s.axis]=s.parse(hd(x,u),m),f.push(T6(hd(x,h),g,o,m));return f}updateRangeFromParsed(t,r,n,i){super.updateRangeFromParsed(t,r,n,i);const s=n._custom;s&&r===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const r=this._cachedMeta,{iScale:n,vScale:i}=r,s=this.getParsed(t),o=s._custom,l=Eb(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,t)}updateElements(t,r,n,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),h=this._getRuler(),{sharedOptions:f,includeOptions:m}=this._getSharedOptions(r,i);for(let v=r;v<r+n;v++){const g=this.getParsed(v),x=s||Tt(g[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),_=this._calculateBarIndexPixels(v,h),b=(g._stacks||{})[l.axis],y={horizontal:u,base:x.base,enableBorderRadius:!b||Eb(g._custom)||o===b._top||o===b._bottom,x:u?x.head:_.center,y:u?_.center:x.head,height:u?_.size:Math.abs(x.size),width:u?Math.abs(x.size):_.size};m&&(y.options=f||this.resolveDataElementOptions(v,t[v].active?"active":i));const j=y.options||t[v].options;hce(y,j,b,o),pce(y,j,h.ratio),this.updateElement(t[v],v,y,i)}}_getStacks(t,r){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),s=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(r),c=l&&l[n.axis],u=h=>{const f=h._parsed.find(v=>v[n.axis]===c),m=f&&f[h.vScale.axis];if(Tt(m)||isNaN(m))return!0};for(const h of i)if(!(r!==void 0&&u(h))&&((s===!1||o.indexOf(h.stack)===-1||s===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===r).shift()}_getAxis(){const t={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[ot(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(t)}_getStackIndex(t,r,n){const i=this._getStacks(t,n),s=r!==void 0?i.indexOf(r):-1;return s===-1?i.length-1:s}_getRuler(){const t=this.options,r=this._cachedMeta,n=r.iScale,i=[];let s,o;for(s=0,o=r.data.length;s<o;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const l=t.barThickness;return{min:l||sce(r),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:r,_stacked:n,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,c=this.getParsed(t),u=c._custom,h=Eb(u);let f=c[r.axis],m=0,v=n?this.applyStack(r,c,n):f,g,x;v!==f&&(m=v-f,v=f),h&&(f=u.barStart,v=u.barEnd-u.barStart,f!==0&&Ms(f)!==Ms(u.barEnd)&&(m=0),m+=f);const _=!Tt(s)&&!h?s:m;let b=r.getPixelForValue(_);if(this.chart.getDataVisibility(t)?g=r.getPixelForValue(m+v):g=b,x=g-b,Math.abs(x)<o){x=dce(x,r,l)*o,f===l&&(b-=x/2);const y=r.getPixelForDecimal(0),j=r.getPixelForDecimal(1),k=Math.min(y,j),E=Math.max(y,j);b=Math.max(Math.min(b,E),k),g=b+x,n&&!h&&(c._stacks[r.axis]._visualValues[i]=r.getValueForPixel(g)-r.getValueForPixel(b))}if(b===r.getPixelForValue(l)){const y=Ms(x)*r.getLineWidthForValue(l)/2;b+=y,x-=y}return{size:x,base:b,head:g,center:g+x/2}}_calculateBarIndexPixels(t,r){const n=r.scale,i=this.options,s=i.skipNull,o=ot(i.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(r.grouped){const h=s?this._getStackCount(t):r.stackCount,f=i.barThickness==="flex"?lce(t,r,i,h*u):oce(t,r,i,h*u),m=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(ot(m,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0)+v;l=f.start+f.chunk*g+f.chunk/2,c=Math.min(o,f.chunk*f.ratio)}else l=n.getPixelForValue(this.getParsed(t)[n.axis],t),c=Math.min(o,r.min*r.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,r=t.vScale,n=t.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[r.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}Le(Ex,"id","bar"),Le(Ex,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Le(Ex,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function mce(e,t,r){let n=1,i=1,s=0,o=0;if(t<ir){const l=e,c=l+t,u=Math.cos(l),h=Math.sin(l),f=Math.cos(c),m=Math.sin(c),v=(j,k,E)=>ep(j,l,c,!0)?1:Math.max(k,k*r,E,E*r),g=(j,k,E)=>ep(j,l,c,!0)?-1:Math.min(k,k*r,E,E*r),x=v(0,u,f),_=v(Br,h,m),b=g(Ot,u,f),y=g(Ot+Br,h,m);n=(x-b)/2,i=(_-y)/2,s=-(x+b)/2,o=-(_+y)/2}return{ratioX:n,ratioY:i,offsetX:s,offsetY:o}}class ou extends Qc{constructor(t,r){super(t,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,r){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let s=c=>+n[c];if(gt(n[t])){const{key:c="value"}=this._parsing;s=u=>+hd(n[u],c)}let o,l;for(o=t,l=t+r;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return ho(this.options.rotation-90)}_getCircumference(){return ho(this.options.circumference)}_getRotationExtents(){let t=ir,r=-ir;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),o=i._getCircumference();t=Math.min(t,s),r=Math.max(r,s+o)}return{rotation:t,circumference:r-t}}update(t){const r=this.chart,{chartArea:n}=r,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),c=Math.min(woe(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:h,rotation:f}=this._getRotationExtents(),{ratioX:m,ratioY:v,offsetX:g,offsetY:x}=mce(f,h,c),_=(n.width-o)/m,b=(n.height-o)/v,y=Math.max(Math.min(_,b)/2,0),j=i6(this.options.radius,y),k=Math.max(j*c,0),E=(j-k)/this._getVisibleDatasetWeightTotal();this.offsetX=g*j,this.offsetY=x*j,i.total=this.calculateTotal(),this.outerRadius=j-E*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-E*u,0),this.updateElements(s,0,s.length,t)}_circumference(t,r){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*s/ir)}updateElements(t,r,n,i){const s=i==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,h=(l.left+l.right)/2,f=(l.top+l.bottom)/2,m=s&&u.animateScale,v=m?0:this.innerRadius,g=m?0:this.outerRadius,{sharedOptions:x,includeOptions:_}=this._getSharedOptions(r,i);let b=this._getRotation(),y;for(y=0;y<r;++y)b+=this._circumference(y,s);for(y=r;y<r+n;++y){const j=this._circumference(y,s),k=t[y],E={x:h+this.offsetX,y:f+this.offsetY,startAngle:b,endAngle:b+j,circumference:j,outerRadius:g,innerRadius:v};_&&(E.options=x||this.resolveDataElementOptions(y,k.active?"active":i)),b+=j,this.updateElement(k,y,E,i)}}calculateTotal(){const t=this._cachedMeta,r=t.data;let n=0,i;for(i=0;i<r.length;i++){const s=t._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!r[i].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(t){const r=this._cachedMeta.total;return r>0&&!isNaN(t)?ir*(Math.abs(t)/r):0}getLabelAndValue(t){const r=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=gC(r._parsed[t],n.options.locale);return{label:i[t]||"",value:s}}getMaxBorderWidth(t){let r=0;const n=this.chart;let i,s,o,l,c;if(!t){for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),t=o.data,l=o.controller;break}}if(!t)return 0;for(i=0,s=t.length;i<s;++i)c=l.resolveDataElementOptions(i),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(t){let r=0;for(let n=0,i=t.length;n<i;++n){const s=this.resolveDataElementOptions(n);r=Math.max(r,s.offset||0,s.hoverOffset||0)}return r}_getRingWeightOffset(t){let r=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(t){return Math.max(ot(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Le(ou,"id","doughnut"),Le(ou,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Le(ou,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Le(ou,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data,{labels:{pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=t.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,u)=>{const f=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:f.backgroundColor,fontColor:s,hidden:!t.getDataVisibility(u),lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:f.borderWidth,strokeStyle:f.borderColor,textAlign:i,pointStyle:n,borderRadius:o&&(l||f.borderRadius),index:u}}):[]}},onClick(t,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}});class Tx extends Qc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const r=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=r,o=this.chart._animationsDisabled;let{start:l,count:c}=Voe(r,i,o);this._drawStart=l,this._drawCount=c,Hoe(r)&&(l=0,c=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:u},t),this.updateElements(i,l,c,t)}updateElements(t,r,n,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:f}=this._getSharedOptions(r,i),m=o.axis,v=l.axis,{spanGaps:g,segment:x}=this.options,_=Z0(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||i==="none",y=r+n,j=t.length;let k=r>0&&this.getParsed(r-1);for(let E=0;E<j;++E){const A=t[E],w=b?A:{};if(E<r||E>=y){w.skip=!0;continue}const P=this.getParsed(E),M=Tt(P[v]),F=w[m]=o.getPixelForValue(P[m],E),D=w[v]=s||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,P,c):P[v],E);w.skip=isNaN(F)||isNaN(D)||M,w.stop=E>0&&Math.abs(P[m]-k[m])>_,x&&(w.parsed=P,w.raw=u.data[E]),f&&(w.options=h||this.resolveDataElementOptions(E,A.active?"active":i)),b||this.updateElement(A,E,w,i),k=P}}getMaxOverflow(){const t=this._cachedMeta,r=t.dataset,n=r.options&&r.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Le(Tx,"id","line"),Le(Tx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Le(Tx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Zw extends ou{}Le(Zw,"id","pie"),Le(Zw,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function dc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class wC{constructor(t){Le(this,"options");this.options=t||{}}static override(t){Object.assign(wC.prototype,t)}init(){}formats(){return dc()}parse(){return dc()}format(){return dc()}add(){return dc()}diff(){return dc()}startOf(){return dc()}endOf(){return dc()}}var gce={_date:wC};function xce(e,t,r,n){const{controller:i,data:s,_sorted:o}=e,l=i._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&s.length){const u=l._reversePixels?zoe:Dc;if(n){if(i._sharedOptions){const h=s[0],f=typeof h.getRange=="function"&&h.getRange(t);if(f){const m=u(s,t,r-f),v=u(s,t,r+f);return{lo:m.lo,hi:v.hi}}}}else{const h=u(s,t,r);if(c){const{vScale:f}=i._cachedMeta,{_parsed:m}=e,v=m.slice(0,h.lo+1).reverse().findIndex(x=>!Tt(x[f.axis]));h.lo-=Math.max(0,v);const g=m.slice(h.hi).findIndex(x=>!Tt(x[f.axis]));h.hi+=Math.max(0,g)}return h}}return{lo:0,hi:s.length-1}}function vv(e,t,r,n,i){const s=e.getSortedVisibleDatasetMetas(),o=r[t];for(let l=0,c=s.length;l<c;++l){const{index:u,data:h}=s[l],{lo:f,hi:m}=xce(s[l],t,o,i);for(let v=f;v<=m;++v){const g=h[v];g.skip||n(g,u,v)}}}function vce(e){const t=e.indexOf("x")!==-1,r=e.indexOf("y")!==-1;return function(n,i){const s=t?Math.abs(n.x-i.x):0,o=r?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function Tb(e,t,r,n,i){const s=[];return!i&&!e.isPointInArea(t)||vv(e,r,t,function(l,c,u){!i&&!tp(l,e.chartArea,0)||l.inRange(t.x,t.y,n)&&s.push({element:l,datasetIndex:c,index:u})},!0),s}function _ce(e,t,r,n){let i=[];function s(o,l,c){const{startAngle:u,endAngle:h}=o.getProps(["startAngle","endAngle"],n),{angle:f}=l6(o,{x:t.x,y:t.y});ep(f,u,h)&&i.push({element:o,datasetIndex:l,index:c})}return vv(e,r,t,s),i}function yce(e,t,r,n,i,s){let o=[];const l=vce(r);let c=Number.POSITIVE_INFINITY;function u(h,f,m){const v=h.inRange(t.x,t.y,i);if(n&&!v)return;const g=h.getCenterPoint(i);if(!(!!s||e.isPointInArea(g))&&!v)return;const _=l(t,g);_<c?(o=[{element:h,datasetIndex:f,index:m}],c=_):_===c&&o.push({element:h,datasetIndex:f,index:m})}return vv(e,r,t,u),o}function Ab(e,t,r,n,i,s){return!s&&!e.isPointInArea(t)?[]:r==="r"&&!n?_ce(e,t,r,i):yce(e,t,r,n,i,s)}function X4(e,t,r,n,i){const s=[],o=r==="x"?"inXRange":"inYRange";let l=!1;return vv(e,r,t,(c,u,h)=>{c[o]&&c[o](t[r],i)&&(s.push({element:c,datasetIndex:u,index:h}),l=l||c.inRange(t.x,t.y,i))}),n&&!l?[]:s}var bce={modes:{index(e,t,r,n){const i=jc(t,e),s=r.axis||"x",o=r.includeInvisible||!1,l=r.intersect?Tb(e,i,s,n,o):Ab(e,i,s,!1,n,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const h=l[0].index,f=u.data[h];f&&!f.skip&&c.push({element:f,datasetIndex:u.index,index:h})}),c):[]},dataset(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;let l=r.intersect?Tb(e,i,s,n,o):Ab(e,i,s,!1,n,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let h=0;h<u.length;++h)l.push({element:u[h],datasetIndex:c,index:h})}return l},point(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;return Tb(e,i,s,n,o)},nearest(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;return Ab(e,i,s,r.intersect,n,o)},x(e,t,r,n){const i=jc(t,e);return X4(e,i,"x",r.intersect,n)},y(e,t,r,n){const i=jc(t,e);return X4(e,i,"y",r.intersect,n)}}};const A6=["left","top","right","bottom"];function lf(e,t){return e.filter(r=>r.pos===t)}function Y4(e,t){return e.filter(r=>A6.indexOf(r.pos)===-1&&r.box.axis===t)}function cf(e,t){return e.sort((r,n)=>{const i=t?n:r,s=t?r:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function jce(e){const t=[];let r,n,i,s,o,l;for(r=0,n=(e||[]).length;r<n;++r)i=e[r],{position:s,options:{stack:o,stackWeight:l=1}}=i,t.push({index:r,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return t}function wce(e){const t={};for(const r of e){const{stack:n,pos:i,stackWeight:s}=r;if(!n||!A6.includes(i))continue;const o=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return t}function kce(e,t){const r=wce(e),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let s,o,l;for(s=0,o=e.length;s<o;++s){l=e[s];const{fullSize:c}=l.box,u=r[l.stack],h=u&&l.stackWeight/u.weight;l.horizontal?(l.width=h?h*n:c&&t.availableWidth,l.height=i):(l.width=n,l.height=h?h*i:c&&t.availableHeight)}return r}function Cce(e){const t=jce(e),r=cf(t.filter(u=>u.box.fullSize),!0),n=cf(lf(t,"left"),!0),i=cf(lf(t,"right")),s=cf(lf(t,"top"),!0),o=cf(lf(t,"bottom")),l=Y4(t,"x"),c=Y4(t,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:i.concat(c).concat(o).concat(l),chartArea:lf(t,"chartArea"),vertical:n.concat(i).concat(c),horizontal:s.concat(o).concat(l)}}function Q4(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function F6(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Sce(e,t,r,n){const{pos:i,box:s}=r,o=e.maxPadding;if(!gt(i)){r.size&&(e[i]-=r.size);const f=n[r.stack]||{size:0,count:1};f.size=Math.max(f.size,r.horizontal?s.height:s.width),r.size=f.size/f.count,e[i]+=r.size}s.getPadding&&F6(o,s.getPadding());const l=Math.max(0,t.outerWidth-Q4(o,e,"left","right")),c=Math.max(0,t.outerHeight-Q4(o,e,"top","bottom")),u=l!==e.w,h=c!==e.h;return e.w=l,e.h=c,r.horizontal?{same:u,other:h}:{same:h,other:u}}function $ce(e){const t=e.maxPadding;function r(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}function Ece(e,t){const r=t.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(t[o],r[o])}),s}return n(e?["left","right"]:["top","bottom"])}function Gf(e,t,r,n){const i=[];let s,o,l,c,u,h;for(s=0,o=e.length,u=0;s<o;++s){l=e[s],c=l.box,c.update(l.width||t.w,l.height||t.h,Ece(l.horizontal,t));const{same:f,other:m}=Sce(t,r,l,n);u|=f&&i.length,h=h||m,c.fullSize||i.push(l)}return u&&Gf(i,t,r,n)||h}function xg(e,t,r,n,i){e.top=r,e.left=t,e.right=t+n,e.bottom=r+i,e.width=n,e.height=i}function J4(e,t,r,n){const i=r.padding;let{x:s,y:o}=t;for(const l of e){const c=l.box,u=n[l.stack]||{placed:0,weight:1},h=l.stackWeight/u.weight||1;if(l.horizontal){const f=t.w*h,m=u.size||c.height;J0(u.start)&&(o=u.start),c.fullSize?xg(c,i.left,o,r.outerWidth-i.right-i.left,m):xg(c,t.left+u.placed,o,f,m),u.start=o,u.placed+=f,o=c.bottom}else{const f=t.h*h,m=u.size||c.width;J0(u.start)&&(s=u.start),c.fullSize?xg(c,s,i.top,m,r.outerHeight-i.bottom-i.top):xg(c,s,t.top+u.placed,m,f),u.start=s,u.placed+=f,s=c.right}}t.x=s,t.y=o}var Ci={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;r!==-1&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,n){if(!e)return;const i=Di(e.options.layout.padding),s=Math.max(t-i.width,0),o=Math.max(r-i.height,0),l=Cce(e.boxes),c=l.vertical,u=l.horizontal;Mt(e.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const h=c.reduce((x,_)=>_.box.options&&_.box.options.display===!1?x:x+1,0)||1,f=Object.freeze({outerWidth:t,outerHeight:r,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/h,hBoxMaxHeight:o/2}),m=Object.assign({},i);F6(m,Di(n));const v=Object.assign({maxPadding:m,w:s,h:o,x:i.left,y:i.top},i),g=kce(c.concat(u),f);Gf(l.fullSize,v,f,g),Gf(c,v,f,g),Gf(u,v,f,g)&&Gf(c,v,f,g),$ce(v),J4(l.leftAndTop,v,f,g),v.x+=v.w,v.y+=v.h,J4(l.rightAndBottom,v,f,g),e.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},Mt(l.chartArea,x=>{const _=x.box;Object.assign(_,e.chartArea),_.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class D6{acquireContext(t,r){}releaseContext(t){return!1}addEventListener(t,r,n){}removeEventListener(t,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,r,n,i){return r=Math.max(0,r||t.width),n=n||t.height,{width:r,height:Math.max(0,i?Math.floor(r/i):n)}}isAttached(t){return!0}updateConfig(t){}}class Tce extends D6{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Ax="$chartjs",Ace={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Z4=e=>e===null||e==="";function Fce(e,t){const r=e.style,n=e.getAttribute("height"),i=e.getAttribute("width");if(e[Ax]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",Z4(i)){const s=R4(e,"width");s!==void 0&&(e.width=s)}if(Z4(n))if(e.style.height==="")e.height=e.width/(t||2);else{const s=R4(e,"height");s!==void 0&&(e.height=s)}return e}const P6=Ple?{passive:!0}:!1;function Dce(e,t,r){e&&e.addEventListener(t,r,P6)}function Pce(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,P6)}function Mce(e,t){const r=Ace[e.type]||e.type,{x:n,y:i}=jc(e,t);return{type:r,chart:t,native:e,x:n!==void 0?n:null,y:i!==void 0?i:null}}function T1(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function Oce(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||T1(l.addedNodes,n),o=o&&!T1(l.removedNodes,n);o&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function Rce(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||T1(l.removedNodes,n),o=o&&!T1(l.addedNodes,n);o&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const np=new Map;let eA=0;function M6(){const e=window.devicePixelRatio;e!==eA&&(eA=e,np.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function Nce(e,t){np.size||window.addEventListener("resize",M6),np.set(e,t)}function zce(e){np.delete(e),np.size||window.removeEventListener("resize",M6)}function Ice(e,t,r){const n=e.canvas,i=n&&jC(n);if(!i)return;const s=h6((l,c)=>{const u=i.clientWidth;r(l,c),u<i.clientWidth&&r()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,h=c.contentRect.height;u===0&&h===0||s(u,h)});return o.observe(i),Nce(e,s),o}function Fb(e,t,r){r&&r.disconnect(),t==="resize"&&zce(e)}function Lce(e,t,r){const n=e.canvas,i=h6(s=>{e.ctx!==null&&r(Mce(s,e))},e);return Dce(n,t,i),i}class Bce extends D6{acquireContext(t,r){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(Fce(t,r),n):null}releaseContext(t){const r=t.canvas;if(!r[Ax])return!1;const n=r[Ax].initial;["height","width"].forEach(s=>{const o=n[s];Tt(o)?r.removeAttribute(s):r.setAttribute(s,o)});const i=n.style||{};return Object.keys(i).forEach(s=>{r.style[s]=i[s]}),r.width=r.width,delete r[Ax],!0}addEventListener(t,r,n){this.removeEventListener(t,r);const i=t.$proxies||(t.$proxies={}),o={attach:Oce,detach:Rce,resize:Ice}[r]||Lce;i[r]=o(t,r,n)}removeEventListener(t,r){const n=t.$proxies||(t.$proxies={}),i=n[r];if(!i)return;({attach:Fb,detach:Fb,resize:Fb}[r]||Pce)(t,r,i),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,r,n,i){return Dle(t,r,n,i)}isAttached(t){const r=t&&jC(t);return!!(r&&r.isConnected)}}function Uce(e){return!bC()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?Tce:Bce}class is{constructor(){Le(this,"x");Le(this,"y");Le(this,"active",!1);Le(this,"options");Le(this,"$animations")}tooltipPosition(t){const{x:r,y:n}=this.getProps(["x","y"],t);return{x:r,y:n}}hasValue(){return Z0(this.x)&&Z0(this.y)}getProps(t,r){const n=this.$animations;if(!r||!n)return this;const i={};return t.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}}Le(is,"defaults",{}),Le(is,"defaultRoutes");function Vce(e,t){const r=e.options.ticks,n=Hce(e),i=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?Gce(t):[],o=s.length,l=s[0],c=s[o-1],u=[];if(o>i)return qce(t,u,s,o/i),u;const h=Wce(s,t,i);if(o>0){let f,m;const v=o>1?Math.round((c-l)/(o-1)):null;for(vg(t,u,h,Tt(v)?0:l-v,l),f=0,m=o-1;f<m;f++)vg(t,u,h,s[f],s[f+1]);return vg(t,u,h,c,Tt(v)?t.length:c+v),u}return vg(t,u,h),u}function Hce(e){const t=e.options.offset,r=e._tickSize(),n=e._length/r+(t?0:1),i=e._maxLength/r;return Math.floor(Math.min(n,i))}function Wce(e,t,r){const n=Kce(e),i=t.length/r;if(!n)return Math.max(i,1);const s=Foe(n);for(let o=0,l=s.length-1;o<l;o++){const c=s[o];if(c>i)return c}return Math.max(i,1)}function Gce(e){const t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}function qce(e,t,r,n){let i=0,s=r[0],o;for(n=Math.ceil(n),o=0;o<e.length;o++)o===s&&(t.push(e[o]),i++,s=r[i*n])}function vg(e,t,r,n,i){const s=ot(n,0),o=Math.min(ot(i,e.length),e.length);let l=0,c,u,h;for(r=Math.ceil(r),i&&(c=i-n,r=c/Math.floor(c/r)),h=s;h<0;)l++,h=Math.round(s+l*r);for(u=Math.max(s,0);u<o;u++)u===h&&(t.push(e[u]),l++,h=Math.round(s+l*r))}function Kce(e){const t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}const Xce=e=>e==="left"?"right":e==="right"?"left":e,tA=(e,t,r)=>t==="top"||t==="left"?e[t]+r:e[t]-r,rA=(e,t)=>Math.min(t||e,e);function nA(e,t){const r=[],n=e.length/t,i=e.length;let s=0;for(;s<i;s+=n)r.push(e[Math.floor(s)]);return r}function Yce(e,t,r){const n=e.ticks.length,i=Math.min(t,n-1),s=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(i),u;if(!(r&&(n===1?u=Math.max(c-s,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(i-1))/2,c+=i<t?u:-u,c<s-l||c>o+l)))return c}function Qce(e,t){Mt(e,r=>{const n=r.gc,i=n.length/2;let s;if(i>t){for(s=0;s<i;++s)delete r.data[n[s]];n.splice(0,i)}})}function df(e){return e.drawTicks?e.tickLength:0}function aA(e,t){if(!e.display)return 0;const r=On(e.font,t),n=Di(e.padding);return(Pr(e.text)?e.text.length:1)*r.lineHeight+n.height}function Jce(e,t){return wd(e,{scale:t,type:"scale"})}function Zce(e,t,r){return wd(e,{tick:r,index:t,type:"tick"})}function ede(e,t,r){let n=pC(e);return(r&&t!=="right"||!r&&t==="right")&&(n=Xce(n)),n}function tde(e,t,r,n){const{top:i,left:s,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:h}=c;let f=0,m,v,g;const x=o-i,_=l-s;if(e.isHorizontal()){if(v=Cn(n,s,l),gt(r)){const b=Object.keys(r)[0],y=r[b];g=h[b].getPixelForValue(y)+x-t}else r==="center"?g=(u.bottom+u.top)/2+x-t:g=tA(e,r,t);m=l-s}else{if(gt(r)){const b=Object.keys(r)[0],y=r[b];v=h[b].getPixelForValue(y)-_+t}else r==="center"?v=(u.left+u.right)/2-_+t:v=tA(e,r,t);g=Cn(n,o,i),f=r==="left"?-Br:Br}return{titleX:v,titleY:g,maxWidth:m,rotation:f}}class ch extends is{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:n,_suggestedMax:i}=this;return t=_s(t,Number.POSITIVE_INFINITY),r=_s(r,Number.NEGATIVE_INFINITY),n=_s(n,Number.POSITIVE_INFINITY),i=_s(i,Number.NEGATIVE_INFINITY),{min:_s(t,n),max:_s(r,i),minDefined:Ln(t),maxDefined:Ln(r)}}getMinMax(t){let{min:r,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:r,max:n};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),i||(r=Math.min(r,o.min)),s||(n=Math.max(n,o.max));return r=s&&r>n?n:r,n=i&&r>n?r:n,{min:_s(r,_s(n,r)),max:_s(n,_s(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qt(this.options.beforeUpdate,[this])}update(t,r,n){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=dle(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?nA(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Vce(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,t=!t),this._startPixel=r,this._endPixel=n,this._reversePixels=t,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qt(this.options.afterUpdate,[this])}beforeSetDimensions(){qt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),qt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n],s.label=qt(r.callback,[s.value,n,t],this)}afterTickToLabelConversion(){qt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,n=rA(this.ticks.length,t.ticks.maxTicksLimit),i=r.minRotation||0,s=r.maxRotation;let o=i,l,c,u;if(!this._isVisible()||!r.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),f=h.widest.width,m=h.highest.height,v=Mn(this.chart.width-f,0,this.maxWidth);l=t.offset?this.maxWidth/n:v/(n-1),f+6>l&&(l=v/(n-(t.offset?.5:1)),c=this.maxHeight-df(t.grid)-r.padding-aA(t.title,this.chart.options.font),u=Math.sqrt(f*f+m*m),o=Ooe(Math.min(Math.asin(Mn((h.highest.height+6)/l,-1,1)),Math.asin(Mn(c/u,-1,1))-Math.asin(Mn(m/u,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){qt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:n,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=aA(i,r.options.font);if(l?(t.width=this.maxWidth,t.height=df(s)+c):(t.height=this.maxHeight,t.width=df(s)+c),n.display&&this.ticks.length){const{first:u,last:h,widest:f,highest:m}=this._getLabelSizes(),v=n.padding*2,g=ho(this.labelRotation),x=Math.cos(g),_=Math.sin(g);if(l){const b=n.mirror?0:_*f.width+x*m.height;t.height=Math.min(this.maxHeight,t.height+b+v)}else{const b=n.mirror?0:x*f.width+_*m.height;t.width=Math.min(this.maxWidth,t.width+b+v)}this._calculatePadding(u,h,_,x)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,n,i){const{ticks:{align:s,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,v=0;c?u?(m=i*t.width,v=n*r.height):(m=n*t.height,v=i*r.width):s==="start"?v=r.width:s==="end"?m=t.width:s!=="inner"&&(m=t.width/2,v=r.width/2),this.paddingLeft=Math.max((m-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((v-f+o)*this.width/(this.width-f),0)}else{let h=r.height/2,f=t.height/2;s==="start"?(h=0,f=t.height):s==="end"&&(h=r.height,f=0),this.paddingTop=h+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,n;for(r=0,n=t.length;r<n;r++)Tt(t[r].label)&&(t.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=nA(n,r)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,n){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],c=Math.floor(r/rA(r,n));let u=0,h=0,f,m,v,g,x,_,b,y,j,k,E;for(f=0;f<r;f+=c){if(g=t[f].label,x=this._resolveTickFontOptions(f),i.font=_=x.string,b=s[_]=s[_]||{data:{},gc:[]},y=x.lineHeight,j=k=0,!Tt(g)&&!Pr(g))j=F4(i,b.data,b.gc,j,g),k=y;else if(Pr(g))for(m=0,v=g.length;m<v;++m)E=g[m],!Tt(E)&&!Pr(E)&&(j=F4(i,b.data,b.gc,j,E),k+=y);o.push(j),l.push(k),u=Math.max(j,u),h=Math.max(k,h)}Qce(s,r);const A=o.indexOf(u),w=l.indexOf(h),P=M=>({width:o[M]||0,height:l[M]||0});return{first:P(0),last:P(r-1),widest:P(A),highest:P(w),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return Noe(this._alignToPixels?cc(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const n=r[t];return n.$context||(n.$context=Zce(this.getContext(),t,n))}return this.$context||(this.$context=Jce(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=ho(this.labelRotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,l=s?s.widest.width+o:0,c=s?s.highest.height+o:0;return this.isHorizontal()?c*n>l*i?l/n:c/i:c*i<l*n?c/n:l/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,n=this.chart,i=this.options,{grid:s,position:o,border:l}=i,c=s.offset,u=this.isHorizontal(),f=this.ticks.length+(c?1:0),m=df(s),v=[],g=l.setContext(this.getContext()),x=g.display?g.width:0,_=x/2,b=function(ae){return cc(n,ae,x)};let y,j,k,E,A,w,P,M,F,D,W,B;if(o==="top")y=b(this.bottom),w=this.bottom-m,M=y-_,D=b(t.top)+_,B=t.bottom;else if(o==="bottom")y=b(this.top),D=t.top,B=b(t.bottom)-_,w=y+_,M=this.top+m;else if(o==="left")y=b(this.right),A=this.right-m,P=y-_,F=b(t.left)+_,W=t.right;else if(o==="right")y=b(this.left),F=t.left,W=b(t.right)-_,A=y+_,P=this.left+m;else if(r==="x"){if(o==="center")y=b((t.top+t.bottom)/2+.5);else if(gt(o)){const ae=Object.keys(o)[0],U=o[ae];y=b(this.chart.scales[ae].getPixelForValue(U))}D=t.top,B=t.bottom,w=y+_,M=w+m}else if(r==="y"){if(o==="center")y=b((t.left+t.right)/2);else if(gt(o)){const ae=Object.keys(o)[0],U=o[ae];y=b(this.chart.scales[ae].getPixelForValue(U))}A=y-_,P=A-m,F=t.left,W=t.right}const G=ot(i.ticks.maxTicksLimit,f),Y=Math.max(1,Math.ceil(f/G));for(j=0;j<f;j+=Y){const ae=this.getContext(j),U=s.setContext(ae),q=l.setContext(ae),z=U.lineWidth,ie=U.color,he=q.dash||[],O=q.dashOffset,R=U.tickWidth,I=U.tickColor,K=U.tickBorderDash||[],ne=U.tickBorderDashOffset;k=Yce(this,j,c),k!==void 0&&(E=cc(n,k,z),u?A=P=F=W=E:w=M=D=B=E,v.push({tx1:A,ty1:w,tx2:P,ty2:M,x1:F,y1:D,x2:W,y2:B,width:z,color:ie,borderDash:he,borderDashOffset:O,tickWidth:R,tickColor:I,tickBorderDash:K,tickBorderDashOffset:ne}))}return this._ticksLength=f,this._borderValue=y,v}_computeLabelItems(t){const r=this.axis,n=this.options,{position:i,ticks:s}=n,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:h,mirror:f}=s,m=df(n.grid),v=m+h,g=f?-h:v,x=-ho(this.labelRotation),_=[];let b,y,j,k,E,A,w,P,M,F,D,W,B="middle";if(i==="top")A=this.bottom-g,w=this._getXAxisLabelAlignment();else if(i==="bottom")A=this.top+g,w=this._getXAxisLabelAlignment();else if(i==="left"){const Y=this._getYAxisLabelAlignment(m);w=Y.textAlign,E=Y.x}else if(i==="right"){const Y=this._getYAxisLabelAlignment(m);w=Y.textAlign,E=Y.x}else if(r==="x"){if(i==="center")A=(t.top+t.bottom)/2+v;else if(gt(i)){const Y=Object.keys(i)[0],ae=i[Y];A=this.chart.scales[Y].getPixelForValue(ae)+v}w=this._getXAxisLabelAlignment()}else if(r==="y"){if(i==="center")E=(t.left+t.right)/2-v;else if(gt(i)){const Y=Object.keys(i)[0],ae=i[Y];E=this.chart.scales[Y].getPixelForValue(ae)}w=this._getYAxisLabelAlignment(m).textAlign}r==="y"&&(c==="start"?B="top":c==="end"&&(B="bottom"));const G=this._getLabelSizes();for(b=0,y=l.length;b<y;++b){j=l[b],k=j.label;const Y=s.setContext(this.getContext(b));P=this.getPixelForTick(b)+s.labelOffset,M=this._resolveTickFontOptions(b),F=M.lineHeight,D=Pr(k)?k.length:1;const ae=D/2,U=Y.color,q=Y.textStrokeColor,z=Y.textStrokeWidth;let ie=w;o?(E=P,w==="inner"&&(b===y-1?ie=this.options.reverse?"left":"right":b===0?ie=this.options.reverse?"right":"left":ie="center"),i==="top"?u==="near"||x!==0?W=-D*F+F/2:u==="center"?W=-G.highest.height/2-ae*F+F:W=-G.highest.height+F/2:u==="near"||x!==0?W=F/2:u==="center"?W=G.highest.height/2-ae*F:W=G.highest.height-D*F,f&&(W*=-1),x!==0&&!Y.showLabelBackdrop&&(E+=F/2*Math.sin(x))):(A=P,W=(1-D)*F/2);let he;if(Y.showLabelBackdrop){const O=Di(Y.backdropPadding),R=G.heights[b],I=G.widths[b];let K=W-O.top,ne=0-O.left;switch(B){case"middle":K-=R/2;break;case"bottom":K-=R;break}switch(w){case"center":ne-=I/2;break;case"right":ne-=I;break;case"inner":b===y-1?ne-=I:b>0&&(ne-=I/2);break}he={left:ne,top:K,width:I+O.width,height:R+O.height,color:Y.backdropColor}}_.push({label:k,font:M,textOffset:W,options:{rotation:x,color:U,strokeColor:q,strokeWidth:z,textAlign:ie,textBaseline:B,translation:[E,A],backdrop:he}})}return _}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-ho(this.labelRotation))return t==="top"?"left":"right";let i="center";return r.align==="start"?i="left":r.align==="end"?i="right":r.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=t+s,c=o.widest.width;let u,h;return r==="left"?i?(h=this.right+s,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h+=c)):(h=this.right-l,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h=this.left)):r==="right"?i?(h=this.left+s,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h-=c)):(h=this.left+l,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h=this.right)):u="right",{textAlign:u,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:n,top:i,width:s,height:o}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(n,i,s,o),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const i=this.ticks.findIndex(s=>s.value===t);return i>=0?r.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const r=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,o;const l=(c,u,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(r.display)for(s=0,o=i.length;s<o;++s){const c=i[s];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,h,f,m;this.isHorizontal()?(u=cc(t,this.left,o)-o/2,h=cc(t,this.right,l)+l/2,f=m=c):(f=cc(t,this.top,o)-o/2,m=cc(t,this.bottom,l)+l/2,u=h=c),r.save(),r.lineWidth=s.width,r.strokeStyle=s.color,r.beginPath(),r.moveTo(u,f),r.lineTo(h,m),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&mv(n,i);const s=this.getLabelItems(t);for(const o of s){const l=o.options,c=o.font,u=o.label,h=o.textOffset;rp(n,u,0,h,c,l)}i&&gv(n)}drawTitle(){const{ctx:t,options:{position:r,title:n,reverse:i}}=this;if(!n.display)return;const s=On(n.font),o=Di(n.padding),l=n.align;let c=s.lineHeight/2;r==="bottom"||r==="center"||gt(r)?(c+=o.bottom,Pr(n.text)&&(c+=s.lineHeight*(n.text.length-1))):c+=o.top;const{titleX:u,titleY:h,maxWidth:f,rotation:m}=tde(this,c,r,l);rp(t,n.text,0,0,s,{color:n.color,maxWidth:f,rotation:m,textAlign:ede(l,r,i),textBaseline:"middle",translation:[u,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,n=ot(t.grid&&t.grid.z,-1),i=ot(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==ch.prototype.draw?[{z:r,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:r,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,o;for(s=0,o=r.length;s<o;++s){const l=r[s];l[n]===this.id&&(!t||l.type===t)&&i.push(l)}return i}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return On(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class _g{constructor(t,r,n){this.type=t,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const r=Object.getPrototypeOf(t);let n;ade(r)&&(n=this.register(r));const i=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,rde(t,o,n),this.override&&br.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const r=this.items,n=t.id,i=this.scope;n in r&&delete r[n],i&&n in br[i]&&(delete br[i][n],this.override&&delete fd[n])}}function rde(e,t,r){const n=Q0(Object.create(null),[r?br.get(r):{},br.get(t),e.defaults]);br.set(t,n),e.defaultRoutes&&nde(t,e.defaultRoutes),e.descriptors&&br.describe(t,e.descriptors)}function nde(e,t){Object.keys(t).forEach(r=>{const n=r.split("."),i=n.pop(),s=[e].concat(n).join("."),o=t[r].split("."),l=o.pop(),c=o.join(".");br.route(s,i,c,l)})}function ade(e){return"id"in e&&"defaults"in e}class ide{constructor(){this.controllers=new _g(Qc,"datasets",!0),this.elements=new _g(is,"elements"),this.plugins=new _g(Object,"plugins"),this.scales=new _g(ch,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,r,n){[...r].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(t,s,i):Mt(i,o=>{const l=n||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,r,n){const i=hC(t);qt(n["before"+i],[],n),r[t](n),qt(n["after"+i],[],n)}_getRegistryForType(t){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(t))return n}return this.plugins}_get(t,r,n){const i=r.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var ks=new ide;class sde{constructor(){this._init=void 0}notify(t,r,n,i){if(r==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const s=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(s,t,r,n);return r==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,r,n,i){i=i||{};for(const s of t){const o=s.plugin,l=o[n],c=[r,i,s.options];if(qt(l,c,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Tt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),r}_createDescriptors(t,r){const n=t&&t.config,i=ot(n.options&&n.options.plugins,{}),s=ode(n);return i===!1&&!r?[]:cde(t,s,i,r)}_notifyStateChanges(t){const r=this._oldCache||[],n=this._cache,i=(s,o)=>s.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(i(r,n),t,"stop"),this._notify(i(n,r),t,"start")}}function ode(e){const t={},r=[],n=Object.keys(ks.plugins.items);for(let s=0;s<n.length;s++)r.push(ks.getPlugin(n[s]));const i=e.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];r.indexOf(o)===-1&&(r.push(o),t[o.id]=!0)}return{plugins:r,localIds:t}}function lde(e,t){return!t&&e===!1?null:e===!0?{}:e}function cde(e,{plugins:t,localIds:r},n,i){const s=[],o=e.getContext();for(const l of t){const c=l.id,u=lde(n[c],i);u!==null&&s.push({plugin:l,options:dde(e.config,{plugin:l,local:r[c]},u,o)})}return s}function dde(e,{plugin:t,local:r},n,i){const s=e.pluginScopeKeys(t),o=e.getOptionScopes(n,s);return r&&t.defaults&&o.push(t.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function e2(e,t){const r=br.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function ude(e,t){let r=e;return e==="_index_"?r=t:e==="_value_"&&(r=t==="x"?"y":"x"),r}function hde(e,t){return e===t?"_index_":"_value_"}function iA(e){if(e==="x"||e==="y"||e==="r")return e}function fde(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function t2(e,...t){if(iA(e))return e;for(const r of t){const n=r.axis||fde(r.position)||e.length>1&&iA(e[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function sA(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function pde(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(n=>n.xAxisID===e||n.yAxisID===e);if(r.length)return sA(e,"x",r[0])||sA(e,"y",r[0])}return{}}function mde(e,t){const r=fd[e.type]||{scales:{}},n=t.scales||{},i=e2(e.type,t),s=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!gt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=t2(o,l,pde(o,e),br.scales[l.type]),u=hde(c,i),h=r.scales||{};s[o]=f0(Object.create(null),[{axis:c},l,h[c],h[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||e2(l,t),h=(fd[l]||{}).scales||{};Object.keys(h).forEach(f=>{const m=ude(f,c),v=o[m+"AxisID"]||m;s[v]=s[v]||Object.create(null),f0(s[v],[{axis:m},n[v],h[f]])})}),Object.keys(s).forEach(o=>{const l=s[o];f0(l,[br.scales[l.type],br.scale])}),s}function O6(e){const t=e.options||(e.options={});t.plugins=ot(t.plugins,{}),t.scales=mde(e,t)}function R6(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function gde(e){return e=e||{},e.data=R6(e.data),O6(e),e}const oA=new Map,N6=new Set;function yg(e,t){let r=oA.get(e);return r||(r=t(),oA.set(e,r),N6.add(r)),r}const uf=(e,t,r)=>{const n=hd(t,r);n!==void 0&&e.add(n)};class xde{constructor(t){this._config=gde(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=R6(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),O6(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return yg(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,r){return yg(`${t}.transition.${r}`,()=>[[`datasets.${t}.transitions.${r}`,`transitions.${r}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,r){return yg(`${t}-${r}`,()=>[[`datasets.${t}.elements.${r}`,`datasets.${t}`,`elements.${r}`,""]])}pluginScopeKeys(t){const r=t.id,n=this.type;return yg(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,r){const n=this._scopeCache;let i=n.get(t);return(!i||r)&&(i=new Map,n.set(t,i)),i}getOptionScopes(t,r,n){const{options:i,type:s}=this,o=this._cachedScopes(t,n),l=o.get(r);if(l)return l;const c=new Set;r.forEach(h=>{t&&(c.add(t),h.forEach(f=>uf(c,t,f))),h.forEach(f=>uf(c,i,f)),h.forEach(f=>uf(c,fd[s]||{},f)),h.forEach(f=>uf(c,br,f)),h.forEach(f=>uf(c,Qw,f))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),N6.has(r)&&o.set(r,u),u}chartOptionScopes(){const{options:t,type:r}=this;return[t,fd[r]||{},br.datasets[r]||{},{type:r},br,Qw]}resolveNamedOptions(t,r,n,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=lA(this._resolverCache,t,i);let c=o;if(_de(o,r)){s.$shared=!1,n=Ll(n)?n():n;const u=this.createResolver(t,n,l);c=Yu(o,n,u)}for(const u of r)s[u]=c[u];return s}createResolver(t,r,n=[""],i){const{resolver:s}=lA(this._resolverCache,t,n);return gt(r)?Yu(s,r,void 0,i):s}}function lA(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));const i=r.join();let s=n.get(i);return s||(s={resolver:vC(t,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},n.set(i,s)),s}const vde=e=>gt(e)&&Object.getOwnPropertyNames(e).some(t=>Ll(e[t]));function _de(e,t){const{isScriptable:r,isIndexable:n}=g6(e);for(const i of t){const s=r(i),o=n(i),l=(o||s)&&e[i];if(s&&(Ll(l)||vde(l))||o&&Pr(l))return!0}return!1}var yde="4.5.1";const bde=["top","bottom","left","right","chartArea"];function cA(e,t){return e==="top"||e==="bottom"||bde.indexOf(e)===-1&&t==="x"}function dA(e,t){return function(r,n){return r[e]===n[e]?r[t]-n[t]:r[e]-n[e]}}function uA(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),qt(r&&r.onComplete,[e],t)}function jde(e){const t=e.chart,r=t.options.animation;qt(r&&r.onProgress,[e],t)}function z6(e){return bC()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Fx={},hA=e=>{const t=z6(e);return Object.values(Fx).filter(r=>r.canvas===t).pop()};function wde(e,t,r){const n=Object.keys(e);for(const i of n){const s=+i;if(s>=t){const o=e[i];delete e[i],(r>0||s>t)&&(e[s+r]=o)}}}function kde(e,t,r,n){return!r||e.type==="mouseout"?null:n?t:e}var Jo;let nn=(Jo=class{static register(...t){ks.add(...t),fA()}static unregister(...t){ks.remove(...t),fA()}constructor(t,r){const n=this.config=new xde(r),i=z6(t),s=hA(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Uce(i)),this.platform.updateConfig(n);const l=this.platform.acquireContext(i,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;if(this.id=joe(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new sde,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Boe(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],Fx[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Qs.listen(this,"complete",uA),Qs.listen(this,"progress",jde),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:n,height:i,_aspectRatio:s}=this;return Tt(t)?r&&s?s:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ks}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():O4(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return D4(this.canvas,this.ctx),this}stop(){return Qs.stop(this),this}resize(t,r){Qs.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,r,s),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,O4(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),qt(n.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Mt(r,(n,i)=>{n.id=i})}buildOrUpdateScales(){const t=this.options,r=t.scales,n=this.scales,i=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let s=[];r&&(s=s.concat(Object.keys(r).map(o=>{const l=r[o],c=t2(o,l),u=c==="r",h=c==="x";return{options:l,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),Mt(s,o=>{const l=o.options,c=l.id,u=t2(c,l),h=ot(l.type,o.dtype);(l.position===void 0||cA(l.position,u)!==cA(o.dposition))&&(l.position=o.dposition),i[c]=!0;let f=null;if(c in n&&n[c].type===h)f=n[c];else{const m=ks.getScale(h);f=new m({id:c,type:h,ctx:this.ctx,chart:this}),n[f.id]=f}f.init(l,t)}),Mt(i,(o,l)=>{o||delete n[l]}),Mt(n,o=>{Ci.configure(this,o,o.options),Ci.addBox(this,o)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,n=t.length;if(t.sort((i,s)=>i.index-s.index),n>r){for(let i=r;i<n;++i)this._destroyDatasetMeta(i);t.splice(r,n-r)}this._sortedMetasets=t.slice(0).sort(dA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((n,i)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const s=r[n];let o=this.getDatasetMeta(n);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=s.indexAxis||e2(l,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const c=ks.getController(l),{datasetElementType:u,dataElementType:h}=br.datasets[l];Object.assign(c,{dataElementType:ks.getElement(h),datasetElementType:u&&ks.getElement(u)}),o.controller=new c(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Mt(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){const{controller:f}=this.getDatasetMeta(u),m=!i&&s.indexOf(f)===-1;f.buildOrUpdateElements(m),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||Mt(s,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(dA("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Mt(this.scales,t=>{Ci.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!j4(r,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of r){const o=n==="_removeElements"?-s:s;wde(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=s=>new Set(t.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=n(0);for(let s=1;s<r;s++)if(!j4(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ci.update(this,this.width,this.height,t);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],Mt(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,Ll(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(r),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Qs.has(this)?this.attached&&!Qs.running(this)&&Qs.start(this):(this.draw(),uA({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,n=[];let i,s;for(i=0,s=r.length;i<s;++i){const o=r[i];(!t||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,n={meta:t,index:t.index,cancelable:!0},i=S6(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&mv(r,i),t.controller.draw(),i&&gv(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return tp(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,n,i){const s=bce.modes[r];return typeof s=="function"?s(this,t,n,i):[]}getDatasetMeta(t){const r=this.data.datasets[t],n=this._metasets;let i=n.filter(s=>s&&s._dataset===r).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=wd(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(t,r){const n=this.getDatasetMeta(t);n.hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,n){const i=n?"show":"hide",s=this.getDatasetMeta(t),o=s.controller._resolveAnimations(void 0,i);J0(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(s,{visible:n}),this.update(l=>l.datasetIndex===t?i:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),Qs.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),D4(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete Fx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,n=(s,o)=>{r.addEventListener(this,s,o),t[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};Mt(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,n=(c,u)=>{r.addEventListener(this,c,u),t[c]=u},i=(c,u)=>{t[c]&&(r.removeEventListener(this,c,u),delete t[c])},s=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",l)},r.isAttached(this.canvas)?l():o()}unbindEvents(){Mt(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},Mt(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,n){const i=n?"set":"remove";let s,o,l,c;for(r==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],n=t.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!k1(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(t,r,n){return this._plugins.notify(this,t,r,n)}isPluginEnabled(t){return this._plugins._cache.filter(r=>r.plugin.id===t).length===1}_updateHoverStyles(t,r,n){const i=this.options.hover,s=(c,u)=>c.filter(h=>!u.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),o=s(r,t),l=n?t:s(t,r);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(t,r){const n={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(t,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(t,r,n){const{_active:i=[],options:s}=this,o=r,l=this._getActiveElements(t,i,n,o),c=Eoe(t),u=kde(t,this._lastEvent,n,c);n&&(this._lastEvent=null,qt(s.onHover,[t,l,this],this),c&&qt(s.onClick,[t,l,this],this));const h=!k1(l,i);return(h||r)&&(this._active=l,this._updateHoverStyles(l,i,r)),this._lastEvent=u,h}_getActiveElements(t,r,n,i){if(t.type==="mouseout")return[];if(!n)return r;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}},Le(Jo,"defaults",br),Le(Jo,"instances",Fx),Le(Jo,"overrides",fd),Le(Jo,"registry",ks),Le(Jo,"version",yde),Le(Jo,"getChart",hA),Jo);function fA(){return Mt(nn.instances,e=>e._plugins.invalidate())}function Cde(e,t,r){const{startAngle:n,x:i,y:s,outerRadius:o,innerRadius:l,options:c}=t,{borderWidth:u,borderJoinStyle:h}=c,f=Math.min(u/o,Na(n-r));if(e.beginPath(),e.arc(i,s,o-u/2,n+f/2,r-f/2),l>0){const m=Math.min(u/l,Na(n-r));e.arc(i,s,l+u/2,r-m/2,n+m/2,!0)}else{const m=Math.min(u/2,o*Na(n-r));if(h==="round")e.arc(i,s,m,r-Ot/2,n+Ot/2,!0);else if(h==="bevel"){const v=2*m*m,g=-v*Math.cos(r+Ot/2)+i,x=-v*Math.sin(r+Ot/2)+s,_=v*Math.cos(n+Ot/2)+i,b=v*Math.sin(n+Ot/2)+s;e.lineTo(g,x),e.lineTo(_,b)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function Sde(e,t,r){const{startAngle:n,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:c}=t;let u=i/l;e.beginPath(),e.arc(s,o,l,n-u,r+u),c>i?(u=i/c,e.arc(s,o,c,r+u,n-u,!0)):e.arc(s,o,i,r+Br,n-Br),e.closePath(),e.clip()}function $de(e){return xC(e,["outerStart","outerEnd","innerStart","innerEnd"])}function Ede(e,t,r,n){const i=$de(e.options.borderRadius),s=(r-t)/2,o=Math.min(s,n*t/2),l=c=>{const u=(r-Math.min(s,c))*n/2;return Mn(c,0,Math.min(s,u))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Mn(i.innerStart,0,o),innerEnd:Mn(i.innerEnd,0,o)}}function Ld(e,t,r,n){return{x:r+e*Math.cos(t),y:n+e*Math.sin(t)}}function A1(e,t,r,n,i,s){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:h}=t,f=Math.max(t.outerRadius+n+r-u,0),m=h>0?h+n+r+u:0;let v=0;const g=i-c;if(n){const Y=h>0?h-n:0,ae=f>0?f-n:0,U=(Y+ae)/2,q=U!==0?g*U/(U+n):g;v=(g-q)/2}const x=Math.max(.001,g*f-r/Ot)/f,_=(g-x)/2,b=c+_+v,y=i-_-v,{outerStart:j,outerEnd:k,innerStart:E,innerEnd:A}=Ede(t,m,f,y-b),w=f-j,P=f-k,M=b+j/w,F=y-k/P,D=m+E,W=m+A,B=b+E/D,G=y-A/W;if(e.beginPath(),s){const Y=(M+F)/2;if(e.arc(o,l,f,M,Y),e.arc(o,l,f,Y,F),k>0){const z=Ld(P,F,o,l);e.arc(z.x,z.y,k,F,y+Br)}const ae=Ld(W,y,o,l);if(e.lineTo(ae.x,ae.y),A>0){const z=Ld(W,G,o,l);e.arc(z.x,z.y,A,y+Br,G+Math.PI)}const U=(y-A/m+(b+E/m))/2;if(e.arc(o,l,m,y-A/m,U,!0),e.arc(o,l,m,U,b+E/m,!0),E>0){const z=Ld(D,B,o,l);e.arc(z.x,z.y,E,B+Math.PI,b-Br)}const q=Ld(w,b,o,l);if(e.lineTo(q.x,q.y),j>0){const z=Ld(w,M,o,l);e.arc(z.x,z.y,j,b-Br,M)}}else{e.moveTo(o,l);const Y=Math.cos(M)*f+o,ae=Math.sin(M)*f+l;e.lineTo(Y,ae);const U=Math.cos(F)*f+o,q=Math.sin(F)*f+l;e.lineTo(U,q)}e.closePath()}function Tde(e,t,r,n,i){const{fullCircles:s,startAngle:o,circumference:l}=t;let c=t.endAngle;if(s){A1(e,t,r,n,c,i);for(let u=0;u<s;++u)e.fill();isNaN(l)||(c=o+(l%ir||ir))}return A1(e,t,r,n,c,i),e.fill(),c}function Ade(e,t,r,n,i){const{fullCircles:s,startAngle:o,circumference:l,options:c}=t,{borderWidth:u,borderJoinStyle:h,borderDash:f,borderDashOffset:m,borderRadius:v}=c,g=c.borderAlign==="inner";if(!u)return;e.setLineDash(f||[]),e.lineDashOffset=m,g?(e.lineWidth=u*2,e.lineJoin=h||"round"):(e.lineWidth=u,e.lineJoin=h||"bevel");let x=t.endAngle;if(s){A1(e,t,r,n,x,i);for(let _=0;_<s;++_)e.stroke();isNaN(l)||(x=o+(l%ir||ir))}g&&Sde(e,t,x),c.selfJoin&&x-o>=Ot&&v===0&&h!=="miter"&&Cde(e,t,x),s||(A1(e,t,r,n,x,i),e.stroke())}class _a extends is{constructor(r){super();Le(this,"circumference");Le(this,"endAngle");Le(this,"fullCircles");Le(this,"innerRadius");Le(this,"outerRadius");Le(this,"pixelMargin");Le(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=l6(s,{x:r,y:n}),{startAngle:c,endAngle:u,innerRadius:h,outerRadius:f,circumference:m}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),v=(this.options.spacing+this.options.borderWidth)/2,g=ot(m,u-c),x=ep(o,c,u)&&c!==u,_=g>=ir||x,b=fo(l,h+v,f+v);return _&&b}getCenterPoint(r){const{x:n,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:u,spacing:h}=this.options,f=(s+o)/2,m=(l+c+h+u)/2;return{x:n+Math.cos(f)*m,y:i+Math.sin(f)*m}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:n,circumference:i}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>ir?Math.floor(i/ir):0,i===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const c=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(c)*s,Math.sin(c)*s);const u=1-Math.sin(Math.min(Ot,i||0)),h=s*u;r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,Tde(r,this,h,o,l),Ade(r,this,h,o,l),r.restore()}}Le(_a,"id","arc"),Le(_a,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Le(_a,"defaultRoutes",{backgroundColor:"backgroundColor"}),Le(_a,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});function I6(e,t,r=t){e.lineCap=ot(r.borderCapStyle,t.borderCapStyle),e.setLineDash(ot(r.borderDash,t.borderDash)),e.lineDashOffset=ot(r.borderDashOffset,t.borderDashOffset),e.lineJoin=ot(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=ot(r.borderWidth,t.borderWidth),e.strokeStyle=ot(r.borderColor,t.borderColor)}function Fde(e,t,r){e.lineTo(r.x,r.y)}function Dde(e){return e.stepped?tle:e.tension||e.cubicInterpolationMode==="monotone"?rle:Fde}function L6(e,t,r={}){const n=e.length,{start:i=0,end:s=n-1}=r,{start:o,end:l}=t,c=Math.max(i,o),u=Math.min(s,l),h=i<o&&s<o||i>l&&s>l;return{count:n,start:c,loop:t.loop,ilen:u<c&&!h?n+u-c:u-c}}function Pde(e,t,r,n){const{points:i,options:s}=t,{count:o,start:l,loop:c,ilen:u}=L6(i,r,n),h=Dde(s);let{move:f=!0,reverse:m}=n||{},v,g,x;for(v=0;v<=u;++v)g=i[(l+(m?u-v:v))%o],!g.skip&&(f?(e.moveTo(g.x,g.y),f=!1):h(e,x,g,m,s.stepped),x=g);return c&&(g=i[(l+(m?u:0))%o],h(e,x,g,m,s.stepped)),!!c}function Mde(e,t,r,n){const i=t.points,{count:s,start:o,ilen:l}=L6(i,r,n),{move:c=!0,reverse:u}=n||{};let h=0,f=0,m,v,g,x,_,b;const y=k=>(o+(u?l-k:k))%s,j=()=>{x!==_&&(e.lineTo(h,_),e.lineTo(h,x),e.lineTo(h,b))};for(c&&(v=i[y(0)],e.moveTo(v.x,v.y)),m=0;m<=l;++m){if(v=i[y(m)],v.skip)continue;const k=v.x,E=v.y,A=k|0;A===g?(E<x?x=E:E>_&&(_=E),h=(f*h+k)/++f):(j(),e.lineTo(k,E),g=A,f=0,x=_=E),b=E}j()}function r2(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!r?Mde:Pde}function Ode(e){return e.stepped?Mle:e.tension||e.cubicInterpolationMode==="monotone"?Ole:wc}function Rde(e,t,r,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,r,n)&&i.closePath()),I6(e,t.options),e.stroke(i)}function Nde(e,t,r,n){const{segments:i,options:s}=t,o=r2(t);for(const l of i)I6(e,s,l.style),e.beginPath(),o(e,t,l,{start:r,end:r+n-1})&&e.closePath(),e.stroke()}const zde=typeof Path2D=="function";function Ide(e,t,r,n){zde&&!t.options.segment?Rde(e,t,r,n):Nde(e,t,r,n)}class Ur extends is{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;Sle(this._points,n,t,i,r),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ble(this,this.options.segment))}first(){const t=this.segments,r=this.points;return t.length&&r[t[0].start]}last(){const t=this.segments,r=this.points,n=t.length;return n&&r[t[n-1].end]}interpolate(t,r){const n=this.options,i=t[r],s=this.points,o=C6(this,{property:r,start:i,end:i});if(!o.length)return;const l=[],c=Ode(n);let u,h;for(u=0,h=o.length;u<h;++u){const{start:f,end:m}=o[u],v=s[f],g=s[m];if(v===g){l.push(v);continue}const x=Math.abs((i-v[r])/(g[r]-v[r])),_=c(v,g,x,n.stepped);_[r]=t[r],l.push(_)}return l.length===1?l[0]:l}pathSegment(t,r,n){return r2(this)(t,this,r,n)}path(t,r,n){const i=this.segments,s=r2(this);let o=this._loop;r=r||0,n=n||this.points.length-r;for(const l of i)o&=s(t,this,l,{start:r,end:r+n-1});return!!o}draw(t,r,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),Ide(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Le(Ur,"id","line"),Le(Ur,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Le(Ur,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Le(Ur,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function pA(e,t,r,n){const i=e.options,{[r]:s}=e.getProps([r],n);return Math.abs(t-s)<i.radius+i.hitRadius}class ea extends is{constructor(r){super();Le(this,"parsed");Le(this,"skip");Le(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(r-o,2)+Math.pow(n-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(r,n){return pA(this,r,"x",n)}inYRange(r,n){return pA(this,r,"y",n)}getCenterPoint(r){const{x:n,y:i}=this.getProps(["x","y"],r);return{x:n,y:i}}size(r){r=r||this.options||{};let n=r.radius||0;n=Math.max(n,n&&r.hoverRadius||0);const i=n&&r.borderWidth||0;return(n+i)*2}draw(r,n){const i=this.options;this.skip||i.radius<.1||!tp(this,n,this.size(i)/2)||(r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.fillStyle=i.backgroundColor,Jw(r,i,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}Le(ea,"id","point"),Le(ea,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Le(ea,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function B6(e,t){const{x:r,y:n,base:i,width:s,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,h,f;return e.horizontal?(f=o/2,l=Math.min(r,i),c=Math.max(r,i),u=n-f,h=n+f):(f=s/2,l=r-f,c=r+f,u=Math.min(n,i),h=Math.max(n,i)),{left:l,top:u,right:c,bottom:h}}function jl(e,t,r,n){return e?0:Mn(t,r,n)}function Lde(e,t,r){const n=e.options.borderWidth,i=e.borderSkipped,s=m6(n);return{t:jl(i.top,s.top,0,r),r:jl(i.right,s.right,0,t),b:jl(i.bottom,s.bottom,0,r),l:jl(i.left,s.left,0,t)}}function Bde(e,t,r){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,s=_u(i),o=Math.min(t,r),l=e.borderSkipped,c=n||gt(i);return{topLeft:jl(!c||l.top||l.left,s.topLeft,0,o),topRight:jl(!c||l.top||l.right,s.topRight,0,o),bottomLeft:jl(!c||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:jl(!c||l.bottom||l.right,s.bottomRight,0,o)}}function Ude(e){const t=B6(e),r=t.right-t.left,n=t.bottom-t.top,i=Lde(e,r/2,n/2),s=Bde(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n,radius:s},inner:{x:t.left+i.l,y:t.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Db(e,t,r,n){const i=t===null,s=r===null,l=e&&!(i&&s)&&B6(e,n);return l&&(i||fo(t,l.left,l.right))&&(s||fo(r,l.top,l.bottom))}function Vde(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function Hde(e,t){e.rect(t.x,t.y,t.w,t.h)}function Pb(e,t,r={}){const n=e.x!==r.x?-t:0,i=e.y!==r.y?-t:0,s=(e.x+e.w!==r.x+r.w?t:0)-n,o=(e.y+e.h!==r.y+r.h?t:0)-i;return{x:e.x+n,y:e.y+i,w:e.w+s,h:e.h+o,radius:e.radius}}class rn extends is{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:r,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:o}=Ude(this),l=Vde(o.radius)?$1:Hde;t.save(),(o.w!==s.w||o.h!==s.h)&&(t.beginPath(),l(t,Pb(o,r,s)),t.clip(),l(t,Pb(s,-r,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),l(t,Pb(s,r)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,r,n){return Db(this,t,r,n)}inXRange(t,r){return Db(this,t,null,r)}inYRange(t,r){return Db(this,null,t,r)}getCenterPoint(t){const{x:r,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(r+i)/2:r,y:s?n:(n+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Le(rn,"id","bar"),Le(rn,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Le(rn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Wde(e,t,r){const n=e.segments,i=e.points,s=t.points,o=[];for(const l of n){let{start:c,end:u}=l;u=_v(c,u,i);const h=n2(r,i[c],i[u],l.loop);if(!t.segments){o.push({source:l,target:h,start:i[c],end:i[u]});continue}const f=C6(t,h);for(const m of f){const v=n2(r,s[m.start],s[m.end],m.loop),g=k6(l,i,v);for(const x of g)o.push({source:x,target:m,start:{[r]:mA(h,v,"start",Math.max)},end:{[r]:mA(h,v,"end",Math.min)}})}}return o}function n2(e,t,r,n){if(n)return;let i=t[e],s=r[e];return e==="angle"&&(i=Na(i),s=Na(s)),{property:e,start:i,end:s}}function Gde(e,t){const{x:r=null,y:n=null}=e||{},i=t.points,s=[];return t.segments.forEach(({start:o,end:l})=>{l=_v(o,l,i);const c=i[o],u=i[l];n!==null?(s.push({x:c.x,y:n}),s.push({x:u.x,y:n})):r!==null&&(s.push({x:r,y:c.y}),s.push({x:r,y:u.y}))}),s}function _v(e,t,r){for(;t>e;t--){const n=r[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function mA(e,t,r,n){return e&&t?n(e[r],t[r]):e?e[r]:t?t[r]:0}function U6(e,t){let r=[],n=!1;return Pr(e)?(n=!0,r=e):r=Gde(e,t),r.length?new Ur({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function gA(e){return e&&e.fill!==!1}function qde(e,t,r){let i=e[t].fill;const s=[t];let o;if(!r)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!Ln(i))return i;if(o=e[i],!o)return!1;if(o.visible)return i;s.push(i),i=o.fill}return!1}function Kde(e,t,r){const n=Jde(e);if(gt(n))return isNaN(n.value)?!1:n;let i=parseFloat(n);return Ln(i)&&Math.floor(i)===i?Xde(n[0],t,i,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Xde(e,t,r,n){return(e==="-"||e==="+")&&(r=t+r),r===t||r<0||r>=n?!1:r}function Yde(e,t){let r=null;return e==="start"?r=t.bottom:e==="end"?r=t.top:gt(e)?r=t.getPixelForValue(e.value):t.getBasePixel&&(r=t.getBasePixel()),r}function Qde(e,t,r){let n;return e==="start"?n=r:e==="end"?n=t.options.reverse?t.min:t.max:gt(e)?n=e.value:n=t.getBaseValue(),n}function Jde(e){const t=e.options,r=t.fill;let n=ot(r&&r.target,r);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function Zde(e){const{scale:t,index:r,line:n}=e,i=[],s=n.segments,o=n.points,l=eue(t,r);l.push(U6({x:null,y:t.bottom},n));for(let c=0;c<s.length;c++){const u=s[c];for(let h=u.start;h<=u.end;h++)tue(i,o[h],l)}return new Ur({points:i,options:{}})}function eue(e,t){const r=[],n=e.getMatchingVisibleMetas("line");for(let i=0;i<n.length;i++){const s=n[i];if(s.index===t)break;s.hidden||r.unshift(s.dataset)}return r}function tue(e,t,r){const n=[];for(let i=0;i<r.length;i++){const s=r[i],{first:o,last:l,point:c}=rue(s,t,"x");if(!(!c||o&&l)){if(o)n.unshift(c);else if(e.push(c),!l)break}}e.push(...n)}function rue(e,t,r){const n=e.interpolate(t,r);if(!n)return{};const i=n[r],s=e.segments,o=e.points;let l=!1,c=!1;for(let u=0;u<s.length;u++){const h=s[u],f=o[h.start][r],m=o[h.end][r];if(fo(i,f,m)){l=i===f,c=i===m;break}}return{first:l,last:c,point:n}}class V6{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,r,n){const{x:i,y:s,radius:o}=this;return r=r||{start:0,end:ir},t.arc(i,s,o,r.end,r.start,!0),!n.bounds}interpolate(t){const{x:r,y:n,radius:i}=this,s=t.angle;return{x:r+Math.cos(s)*i,y:n+Math.sin(s)*i,angle:s}}}function nue(e){const{chart:t,fill:r,line:n}=e;if(Ln(r))return aue(t,r);if(r==="stack")return Zde(e);if(r==="shape")return!0;const i=iue(e);return i instanceof V6?i:U6(i,n)}function aue(e,t){const r=e.getDatasetMeta(t);return r&&e.isDatasetVisible(t)?r.dataset:null}function iue(e){return(e.scale||{}).getPointPositionForValue?oue(e):sue(e)}function sue(e){const{scale:t={},fill:r}=e,n=Yde(r,t);if(Ln(n)){const i=t.isHorizontal();return{x:i?n:null,y:i?null:n}}return null}function oue(e){const{scale:t,fill:r}=e,n=t.options,i=t.getLabels().length,s=n.reverse?t.max:t.min,o=Qde(r,t,s),l=[];if(n.grid.circular){const c=t.getPointPositionForValue(0,s);return new V6({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<i;++c)l.push(t.getPointPositionForValue(c,o));return l}function Mb(e,t,r){const n=nue(t),{chart:i,index:s,line:o,scale:l,axis:c}=t,u=o.options,h=u.fill,f=u.backgroundColor,{above:m=f,below:v=f}=h||{},g=i.getDatasetMeta(s),x=S6(i,g);n&&o.points.length&&(mv(e,r),lue(e,{line:o,target:n,above:m,below:v,area:r,scale:l,axis:c,clip:x}),gv(e))}function lue(e,t){const{line:r,target:n,above:i,below:s,area:o,scale:l,clip:c}=t,u=r._loop?"angle":t.axis;e.save();let h=s;s!==i&&(u==="x"?(xA(e,n,o.top),Ob(e,{line:r,target:n,color:i,scale:l,property:u,clip:c}),e.restore(),e.save(),xA(e,n,o.bottom)):u==="y"&&(vA(e,n,o.left),Ob(e,{line:r,target:n,color:s,scale:l,property:u,clip:c}),e.restore(),e.save(),vA(e,n,o.right),h=i)),Ob(e,{line:r,target:n,color:h,scale:l,property:u,clip:c}),e.restore()}function xA(e,t,r){const{segments:n,points:i}=t;let s=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=i[c],f=i[_v(c,u,i)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(h.x,r),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(f.x,r)}e.lineTo(t.first().x,r),e.closePath(),e.clip()}function vA(e,t,r){const{segments:n,points:i}=t;let s=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=i[c],f=i[_v(c,u,i)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(r,h.y),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(r,f.y)}e.lineTo(r,t.first().y),e.closePath(),e.clip()}function Ob(e,t){const{line:r,target:n,property:i,color:s,scale:o,clip:l}=t,c=Wde(r,n,i);for(const{source:u,target:h,start:f,end:m}of c){const{style:{backgroundColor:v=s}={}}=u,g=n!==!0;e.save(),e.fillStyle=v,cue(e,o,l,g&&n2(i,f,m)),e.beginPath();const x=!!r.pathSegment(e,u);let _;if(g){x?e.closePath():_A(e,n,m,i);const b=!!n.pathSegment(e,h,{move:x,reverse:!0});_=x&&b,_||_A(e,n,f,i)}e.closePath(),e.fill(_?"evenodd":"nonzero"),e.restore()}}function cue(e,t,r,n){const i=t.chart.chartArea,{property:s,start:o,end:l}=n||{};if(s==="x"||s==="y"){let c,u,h,f;s==="x"?(c=o,u=i.top,h=l,f=i.bottom):(c=i.left,u=o,h=i.right,f=l),e.beginPath(),r&&(c=Math.max(c,r.left),h=Math.min(h,r.right),u=Math.max(u,r.top),f=Math.min(f,r.bottom)),e.rect(c,u,h-c,f-u),e.clip()}}function _A(e,t,r,n){const i=t.interpolate(r,n);i&&e.lineTo(i.x,i.y)}var dh={id:"filler",afterDatasetsUpdate(e,t,r){const n=(e.data.datasets||[]).length,i=[];let s,o,l,c;for(o=0;o<n;++o)s=e.getDatasetMeta(o),l=s.dataset,c=null,l&&l.options&&l instanceof Ur&&(c={visible:e.isDatasetVisible(o),index:o,fill:Kde(l,o,n),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:l}),s.$filler=c,i.push(c);for(o=0;o<n;++o)c=i[o],!(!c||c.fill===!1)&&(c.fill=qde(i,o,r.propagate))},beforeDraw(e,t,r){const n=r.drawTime==="beforeDraw",i=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let o=i.length-1;o>=0;--o){const l=i[o].$filler;l&&(l.line.updateControlPoints(s,l.axis),n&&l.fill&&Mb(e.ctx,l,s))}},beforeDatasetsDraw(e,t,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=e.getSortedVisibleDatasetMetas();for(let i=n.length-1;i>=0;--i){const s=n[i].$filler;gA(s)&&Mb(e.ctx,s,e.chartArea)}},beforeDatasetDraw(e,t,r){const n=t.meta.$filler;!gA(n)||r.drawTime!=="beforeDatasetDraw"||Mb(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const yA=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}},due=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class bA extends is{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r,n){this.maxWidth=t,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let r=qt(t.generateLabels,[this.chart],this)||[];t.filter&&(r=r.filter(n=>t.filter(n,this.chart.data))),t.sort&&(r=r.sort((n,i)=>t.sort(n,i,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:t,ctx:r}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,i=On(n.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=yA(n,s);let u,h;r.font=i.string,this.isHorizontal()?(u=this.maxWidth,h=this._fitRows(o,s,l,c)+10):(h=this.maxHeight,u=this._fitCols(o,i,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,r,n,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],h=i+l;let f=t;s.textAlign="left",s.textBaseline="middle";let m=-1,v=-h;return this.legendItems.forEach((g,x)=>{const _=n+r/2+s.measureText(g.text).width;(x===0||u[u.length-1]+_+2*l>o)&&(f+=h,u[u.length-(x>0?0:1)]=0,v+=h,m++),c[x]={left:0,top:v,row:m,width:_,height:i},u[u.length-1]+=_+l}),f}_fitCols(t,r,n,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],h=o-t;let f=l,m=0,v=0,g=0,x=0;return this.legendItems.forEach((_,b)=>{const{itemWidth:y,itemHeight:j}=uue(n,r,s,_,i);b>0&&v+j+2*l>h&&(f+=m+l,u.push({width:m,height:v}),g+=m+l,x++,m=v=0),c[b]={left:g,top:v,col:x,width:y,height:j},m=Math.max(m,y),v+=j+l}),f+=m,u.push({width:m,height:v}),f}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:i},rtl:s}}=this,o=yu(s,this.left,this.width);if(this.isHorizontal()){let l=0,c=Cn(n,this.left+i,this.right-this.lineWidths[l]);for(const u of r)l!==u.row&&(l=u.row,c=Cn(n,this.left+i,this.right-this.lineWidths[l])),u.top+=this.top+t+i,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+i}else{let l=0,c=Cn(n,this.top+t+i,this.bottom-this.columnSizes[l].height);for(const u of r)u.col!==l&&(l=u.col,c=Cn(n,this.top+t+i,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+i,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;mv(t,this),this._draw(),gv(t)}}_draw(){const{options:t,columnSizes:r,lineWidths:n,ctx:i}=this,{align:s,labels:o}=t,l=br.color,c=yu(t.rtl,this.left,this.width),u=On(o.font),{padding:h}=o,f=u.size,m=f/2;let v;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=u.string;const{boxWidth:g,boxHeight:x,itemHeight:_}=yA(o,f),b=function(A,w,P){if(isNaN(g)||g<=0||isNaN(x)||x<0)return;i.save();const M=ot(P.lineWidth,1);if(i.fillStyle=ot(P.fillStyle,l),i.lineCap=ot(P.lineCap,"butt"),i.lineDashOffset=ot(P.lineDashOffset,0),i.lineJoin=ot(P.lineJoin,"miter"),i.lineWidth=M,i.strokeStyle=ot(P.strokeStyle,l),i.setLineDash(ot(P.lineDash,[])),o.usePointStyle){const F={radius:x*Math.SQRT2/2,pointStyle:P.pointStyle,rotation:P.rotation,borderWidth:M},D=c.xPlus(A,g/2),W=w+m;p6(i,F,D,W,o.pointStyleWidth&&g)}else{const F=w+Math.max((f-x)/2,0),D=c.leftForLtr(A,g),W=_u(P.borderRadius);i.beginPath(),Object.values(W).some(B=>B!==0)?$1(i,{x:D,y:F,w:g,h:x,radius:W}):i.rect(D,F,g,x),i.fill(),M!==0&&i.stroke()}i.restore()},y=function(A,w,P){rp(i,P.text,A,w+_/2,u,{strikethrough:P.hidden,textAlign:c.textAlign(P.textAlign)})},j=this.isHorizontal(),k=this._computeTitleHeight();j?v={x:Cn(s,this.left+h,this.right-n[0]),y:this.top+h+k,line:0}:v={x:this.left+h,y:Cn(s,this.top+k+h,this.bottom-r[0].height),line:0},b6(this.ctx,t.textDirection);const E=_+h;this.legendItems.forEach((A,w)=>{i.strokeStyle=A.fontColor,i.fillStyle=A.fontColor;const P=i.measureText(A.text).width,M=c.textAlign(A.textAlign||(A.textAlign=o.textAlign)),F=g+m+P;let D=v.x,W=v.y;c.setWidth(this.width),j?w>0&&D+F+h>this.right&&(W=v.y+=E,v.line++,D=v.x=Cn(s,this.left+h,this.right-n[v.line])):w>0&&W+E>this.bottom&&(D=v.x=D+r[v.line].width+h,v.line++,W=v.y=Cn(s,this.top+k+h,this.bottom-r[v.line].height));const B=c.x(D);if(b(B,W,A),D=Uoe(M,D+g+m,j?D+F:this.right,t.rtl),y(c.x(D),W,A),j)v.x+=F+h;else if(typeof A.text!="string"){const G=u.lineHeight;v.y+=H6(A,G)+h}else v.y+=E}),j6(this.ctx,t.textDirection)}drawTitle(){const t=this.options,r=t.title,n=On(r.font),i=Di(r.padding);if(!r.display)return;const s=yu(t.rtl,this.left,this.width),o=this.ctx,l=r.position,c=n.size/2,u=i.top+c;let h,f=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),h=this.top+u,f=Cn(t.align,f,this.right-m);else{const g=this.columnSizes.reduce((x,_)=>Math.max(x,_.height),0);h=u+Cn(t.align,this.top,this.bottom-g-t.labels.padding-this._computeTitleHeight())}const v=Cn(l,f,f+m);o.textAlign=s.textAlign(pC(l)),o.textBaseline="middle",o.strokeStyle=r.color,o.fillStyle=r.color,o.font=n.string,rp(o,r.text,v,h,n)}_computeTitleHeight(){const t=this.options.title,r=On(t.font),n=Di(t.padding);return t.display?r.lineHeight+n.height:0}_getLegendItemAt(t,r){let n,i,s;if(fo(t,this.left,this.right)&&fo(r,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],fo(t,i.left,i.left+i.width)&&fo(r,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(t){const r=this.options;if(!pue(t.type,r))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,s=due(i,n);i&&!s&&qt(r.onLeave,[t,i,this],this),this._hoveredItem=n,n&&!s&&qt(r.onHover,[t,n,this],this)}else n&&qt(r.onClick,[t,n,this],this)}}function uue(e,t,r,n,i){const s=hue(n,e,t,r),o=fue(i,n,t.lineHeight);return{itemWidth:s,itemHeight:o}}function hue(e,t,r,n){let i=e.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),t+r.size/2+n.measureText(i).width}function fue(e,t,r){let n=e;return typeof t.text!="string"&&(n=H6(t,r)),n}function H6(e,t){const r=e.text?e.text.length:0;return t*r}function pue(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var aa={id:"legend",_element:bA,start(e,t,r){const n=e.legend=new bA({ctx:e.ctx,options:r,chart:e});Ci.configure(e,n,r),Ci.addBox(e,n)},stop(e){Ci.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const n=e.legend;Ci.configure(e,n,r),n.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const n=t.datasetIndex,i=r.chart;i.isDatasetVisible(n)?(i.hide(n),t.hidden=!0):(i.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(r?0:void 0),h=Di(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:s,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:i||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class W6 extends is{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=r;const i=Pr(n.text)?n.text.length:1;this._padding=Di(n.padding);const s=i*On(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:r,left:n,bottom:i,right:s,options:o}=this,l=o.align;let c=0,u,h,f;return this.isHorizontal()?(h=Cn(l,n,s),f=r+t,u=s-n):(o.position==="left"?(h=n+t,f=Cn(l,i,r),c=Ot*-.5):(h=s-t,f=Cn(l,r,i),c=Ot*.5),u=i-r),{titleX:h,titleY:f,maxWidth:u,rotation:c}}draw(){const t=this.ctx,r=this.options;if(!r.display)return;const n=On(r.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(s);rp(t,r.text,0,0,n,{color:r.color,maxWidth:c,rotation:u,textAlign:pC(r.align),textBaseline:"middle",translation:[o,l]})}}function mue(e,t){const r=new W6({ctx:e.ctx,options:t,chart:e});Ci.configure(e,r,t),Ci.addBox(e,r),e.titleBlock=r}var ia={id:"title",_element:W6,start(e,t,r){mue(e,r)},stop(e){const t=e.titleBlock;Ci.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const n=e.titleBlock;Ci.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const qf={average(e){if(!e.length)return!1;let t,r,n=new Set,i=0,s=0;for(t=0,r=e.length;t<r;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();n.add(c.x),i+=c.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((l,c)=>l+c)/n.size,y:i/s}},nearest(e,t){if(!e.length)return!1;let r=t.x,n=t.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=e.length;s<o;++s){const c=e[s].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),h=Yw(t,u);h<i&&(i=h,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,n=c.y}return{x:r,y:n}}};function js(e,t){return t&&(Pr(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Js(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function gue(e,t){const{element:r,datasetIndex:n,index:i}=t,s=e.getDatasetMeta(n).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:e,label:o,parsed:s.getParsed(i),raw:e.data.datasets[n].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:r}}function jA(e,t){const r=e.chart.ctx,{body:n,footer:i,title:s}=e,{boxWidth:o,boxHeight:l}=t,c=On(t.bodyFont),u=On(t.titleFont),h=On(t.footerFont),f=s.length,m=i.length,v=n.length,g=Di(t.padding);let x=g.height,_=0,b=n.reduce((k,E)=>k+E.before.length+E.lines.length+E.after.length,0);if(b+=e.beforeBody.length+e.afterBody.length,f&&(x+=f*u.lineHeight+(f-1)*t.titleSpacing+t.titleMarginBottom),b){const k=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;x+=v*k+(b-v)*c.lineHeight+(b-1)*t.bodySpacing}m&&(x+=t.footerMarginTop+m*h.lineHeight+(m-1)*t.footerSpacing);let y=0;const j=function(k){_=Math.max(_,r.measureText(k).width+y)};return r.save(),r.font=u.string,Mt(e.title,j),r.font=c.string,Mt(e.beforeBody.concat(e.afterBody),j),y=t.displayColors?o+2+t.boxPadding:0,Mt(n,k=>{Mt(k.before,j),Mt(k.lines,j),Mt(k.after,j)}),y=0,r.font=h.string,Mt(e.footer,j),r.restore(),_+=g.width,{width:_,height:x}}function xue(e,t){const{y:r,height:n}=t;return r<n/2?"top":r>e.height-n/2?"bottom":"center"}function vue(e,t,r,n){const{x:i,width:s}=n,o=r.caretSize+r.caretPadding;if(e==="left"&&i+s+o>t.width||e==="right"&&i-s-o<0)return!0}function _ue(e,t,r,n){const{x:i,width:s}=r,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return n==="center"?u=i<=(l+c)/2?"left":"right":i<=s/2?u="left":i>=o-s/2&&(u="right"),vue(u,e,t,r)&&(u="center"),u}function wA(e,t,r){const n=r.yAlign||t.yAlign||xue(e,r);return{xAlign:r.xAlign||t.xAlign||_ue(e,t,r,n),yAlign:n}}function yue(e,t){let{x:r,width:n}=e;return t==="right"?r-=n:t==="center"&&(r-=n/2),r}function bue(e,t,r){let{y:n,height:i}=e;return t==="top"?n+=r:t==="bottom"?n-=i+r:n-=i/2,n}function kA(e,t,r,n){const{caretSize:i,caretPadding:s,cornerRadius:o}=e,{xAlign:l,yAlign:c}=r,u=i+s,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:v}=_u(o);let g=yue(t,l);const x=bue(t,c,u);return c==="center"?l==="left"?g+=u:l==="right"&&(g-=u):l==="left"?g-=Math.max(h,m)+i:l==="right"&&(g+=Math.max(f,v)+i),{x:Mn(g,0,n.width-t.width),y:Mn(x,0,n.height-t.height)}}function bg(e,t,r){const n=Di(r.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function CA(e){return js([],Js(e))}function jue(e,t,r){return wd(e,{tooltip:t,tooltipItems:r,type:"tooltip"})}function SA(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const G6={beforeTitle:Xs,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return r[t.dataIndex]}return""},afterTitle:Xs,beforeBody:Xs,beforeLabel:Xs,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return Tt(r)||(t+=r),t},labelColor(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Xs,afterBody:Xs,beforeFooter:Xs,footer:Xs,afterFooter:Xs};function ha(e,t,r,n){const i=e[t].call(r,n);return typeof i>"u"?G6[t].call(r,n):i}class a2 extends is{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&r.options.animation&&n.animations,s=new $6(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=jue(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:n}=r,i=ha(n,"beforeTitle",this,t),s=ha(n,"title",this,t),o=ha(n,"afterTitle",this,t);let l=[];return l=js(l,Js(i)),l=js(l,Js(s)),l=js(l,Js(o)),l}getBeforeBody(t,r){return CA(ha(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:n}=r,i=[];return Mt(t,s=>{const o={before:[],lines:[],after:[]},l=SA(n,s);js(o.before,Js(ha(l,"beforeLabel",this,s))),js(o.lines,ha(l,"label",this,s)),js(o.after,Js(ha(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(t,r){return CA(ha(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:n}=r,i=ha(n,"beforeFooter",this,t),s=ha(n,"footer",this,t),o=ha(n,"afterFooter",this,t);let l=[];return l=js(l,Js(i)),l=js(l,Js(s)),l=js(l,Js(o)),l}_createItems(t){const r=this._active,n=this.chart.data,i=[],s=[],o=[];let l=[],c,u;for(c=0,u=r.length;c<u;++c)l.push(gue(this.chart,r[c]));return t.filter&&(l=l.filter((h,f,m)=>t.filter(h,f,m,n))),t.itemSort&&(l=l.sort((h,f)=>t.itemSort(h,f,n))),Mt(l,h=>{const f=SA(t.callbacks,h);i.push(ha(f,"labelColor",this,h)),s.push(ha(f,"labelPointStyle",this,h)),o.push(ha(f,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(t,r){const n=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=qf[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const c=this._size=jA(this,n),u=Object.assign({},l,c),h=wA(this.chart,n,u),f=kA(n,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:f.x,y:f.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,n,i){const s=this.getCaretPosition(t,n,i);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(t,r,n){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:f}=_u(l),{x:m,y:v}=t,{width:g,height:x}=r;let _,b,y,j,k,E;return s==="center"?(k=v+x/2,i==="left"?(_=m,b=_-o,j=k+o,E=k-o):(_=m+g,b=_+o,j=k-o,E=k+o),y=_):(i==="left"?b=m+Math.max(c,h)+o:i==="right"?b=m+g-Math.max(u,f)-o:b=this.caretX,s==="top"?(j=v,k=j-o,_=b-o,y=b+o):(j=v+x,k=j+o,_=b+o,y=b-o),E=j),{x1:_,x2:b,x3:y,y1:j,y2:k,y3:E}}drawTitle(t,r,n){const i=this.title,s=i.length;let o,l,c;if(s){const u=yu(n.rtl,this.x,this.width);for(t.x=bg(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",o=On(n.titleFont),l=n.titleSpacing,r.fillStyle=n.titleColor,r.font=o.string,c=0;c<s;++c)r.fillText(i[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===s&&(t.y+=n.titleMarginBottom-l)}}_drawColorBox(t,r,n,i,s){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:c,boxWidth:u}=s,h=On(s.bodyFont),f=bg(this,"left",s),m=i.x(f),v=c<h.lineHeight?(h.lineHeight-c)/2:0,g=r.y+v;if(s.usePointStyle){const x={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},_=i.leftForLtr(m,u)+u/2,b=g+c/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,Jw(t,x,_,b),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Jw(t,x,_,b)}else{t.lineWidth=gt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(m,u),_=i.leftForLtr(i.xPlus(m,1),u-2),b=_u(o.borderRadius);Object.values(b).some(y=>y!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,$1(t,{x,y:g,w:u,h:c,radius:b}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),$1(t,{x:_,y:g+1,w:u-2,h:c-2,radius:b}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(x,g,u,c),t.strokeRect(x,g,u,c),t.fillStyle=o.backgroundColor,t.fillRect(_,g+1,u-2,c-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,r,n){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:h}=n,f=On(n.bodyFont);let m=f.lineHeight,v=0;const g=yu(n.rtl,this.x,this.width),x=function(P){r.fillText(P,g.x(t.x+v),t.y+m/2),t.y+=m+s},_=g.textAlign(o);let b,y,j,k,E,A,w;for(r.textAlign=o,r.textBaseline="middle",r.font=f.string,t.x=bg(this,_,n),r.fillStyle=n.bodyColor,Mt(this.beforeBody,x),v=l&&_!=="right"?o==="center"?u/2+h:u+2+h:0,k=0,A=i.length;k<A;++k){for(b=i[k],y=this.labelTextColors[k],r.fillStyle=y,Mt(b.before,x),j=b.lines,l&&j.length&&(this._drawColorBox(r,t,k,g,n),m=Math.max(f.lineHeight,c)),E=0,w=j.length;E<w;++E)x(j[E]),m=f.lineHeight;Mt(b.after,x)}v=0,m=f.lineHeight,Mt(this.afterBody,x),t.y-=s}drawFooter(t,r,n){const i=this.footer,s=i.length;let o,l;if(s){const c=yu(n.rtl,this.x,this.width);for(t.x=bg(this,n.footerAlign,n),t.y+=n.footerMarginTop,r.textAlign=c.textAlign(n.footerAlign),r.textBaseline="middle",o=On(n.footerFont),r.fillStyle=n.footerColor,r.font=o.string,l=0;l<s;++l)r.fillText(i[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,r,n,i){const{xAlign:s,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:h}=n,{topLeft:f,topRight:m,bottomLeft:v,bottomRight:g}=_u(i.cornerRadius);r.fillStyle=i.backgroundColor,r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.beginPath(),r.moveTo(l+f,c),o==="top"&&this.drawCaret(t,r,n,i),r.lineTo(l+u-m,c),r.quadraticCurveTo(l+u,c,l+u,c+m),o==="center"&&s==="right"&&this.drawCaret(t,r,n,i),r.lineTo(l+u,c+h-g),r.quadraticCurveTo(l+u,c+h,l+u-g,c+h),o==="bottom"&&this.drawCaret(t,r,n,i),r.lineTo(l+v,c+h),r.quadraticCurveTo(l,c+h,l,c+h-v),o==="center"&&s==="left"&&this.drawCaret(t,r,n,i),r.lineTo(l,c+f),r.quadraticCurveTo(l,c,l+f,c),r.closePath(),r.fill(),i.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const o=qf[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=jA(this,t),c=Object.assign({},o,this._size),u=wA(r,t,c),h=kA(t,c,u,r);(i._to!==h.x||s._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Di(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(t.save(),t.globalAlpha=n,this.drawBackground(s,t,i,r),b6(t,r.textDirection),s.y+=o.top,this.drawTitle(s,t,r),this.drawBody(s,t,r),this.drawFooter(s,t,r),j6(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const n=this._active,i=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),s=!k1(n,i),o=this._positionChanged(i,r);(s||o)&&(this._active=i,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(t,s,r,n),l=this._positionChanged(o,t),c=r||!k1(o,s)||l;return c&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),c}_getActiveElements(t,r,n,i){const s=this.options;if(t.type==="mouseout")return[];if(!i)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(t,r){const{caretX:n,caretY:i,options:s}=this,o=qf[s.position].call(this,t,r);return o!==!1&&(n!==o.x||i!==o.y)}}Le(a2,"positioners",qf);var sa={id:"tooltip",_element:a2,positioners:qf,afterInit(e,t,r){r&&(e.tooltip=new a2({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:G6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const wue=(e,t,r,n)=>(typeof t=="string"?(r=e.push(t)-1,n.unshift({index:r,label:t})):isNaN(t)&&(r=null),r);function kue(e,t,r,n){const i=e.indexOf(t);if(i===-1)return wue(e,t,r,n);const s=e.lastIndexOf(t);return i!==s?r:i}const Cue=(e,t)=>e===null?null:Mn(Math.round(e),0,t);function $A(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class mn extends ch{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:i,label:s}of r)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,r){if(Tt(t))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===t?r:kue(n,t,ot(r,t),this._addedLabels),Cue(r,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),r||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,r=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=t===0&&r===s.length-1?s:s.slice(t,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=r;o++)i.push({value:o});return i}getLabelForValue(t){return $A.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Le(mn,"id","category"),Le(mn,"defaults",{ticks:{callback:$A}});function Sue(e,t){const r=[],{bounds:i,step:s,min:o,max:l,precision:c,count:u,maxTicks:h,maxDigits:f,includeBounds:m}=e,v=s||1,g=h-1,{min:x,max:_}=t,b=!Tt(o),y=!Tt(l),j=!Tt(u),k=(_-x)/(f+1);let E=k4((_-x)/g/v)*v,A,w,P,M;if(E<1e-14&&!b&&!y)return[{value:x},{value:_}];M=Math.ceil(_/E)-Math.floor(x/E),M>g&&(E=k4(M*E/g/v)*v),Tt(c)||(A=Math.pow(10,c),E=Math.ceil(E*A)/A),i==="ticks"?(w=Math.floor(x/E)*E,P=Math.ceil(_/E)*E):(w=x,P=_),b&&y&&s&&Poe((l-o)/s,E/1e3)?(M=Math.round(Math.min((l-o)/E,h)),E=(l-o)/M,w=o,P=l):j?(w=b?o:w,P=y?l:P,M=u-1,E=(P-w)/M):(M=(P-w)/E,p0(M,Math.round(M),E/1e3)?M=Math.round(M):M=Math.ceil(M));const F=Math.max(C4(E),C4(w));A=Math.pow(10,Tt(c)?F:c),w=Math.round(w*A)/A,P=Math.round(P*A)/A;let D=0;for(b&&(m&&w!==o?(r.push({value:o}),w<o&&D++,p0(Math.round((w+D*E)*A)/A,o,EA(o,k,e))&&D++):w<o&&D++);D<M;++D){const W=Math.round((w+D*E)*A)/A;if(y&&W>l)break;r.push({value:W})}return y&&m&&P!==l?r.length&&p0(r[r.length-1].value,l,EA(l,k,e))?r[r.length-1].value=l:r.push({value:l}):(!y||P===l)&&r.push({value:P}),r}function EA(e,t,{horizontal:r,minRotation:n}){const i=ho(n),s=(r?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+e).length;return Math.min(t/s,o)}class $ue extends ch{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,r){return Tt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const o=c=>i=r?i:c,l=c=>s=n?s:c;if(t){const c=Ms(i),u=Ms(s);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(i===s){let c=s===0?1:Math.abs(s*.05);l(s+c),t||o(i-c)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=t,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),r=r||11),r&&(i=Math.min(r,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,r=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},s=this._range||this,o=Sue(i,s);return t.bounds==="ticks"&&Moe(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-r)/Math.max(t.length-1,1)/2;r-=i,n+=i}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(t){return gC(t,this.chart.options.locale,this.options.ticks.format)}}class gn extends $ue{determineDataLimits(){const{min:t,max:r}=this.getMinMax(!0);this.min=Ln(t)?t:0,this.max=Ln(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),r=t?this.width:this.height,n=ho(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Le(gn,"id","linear"),Le(gn,"defaults",{ticks:{callback:f6.formatters.numeric}});const yv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},xa=Object.keys(yv);function TA(e,t){return e-t}function AA(e,t){if(Tt(t))return null;const r=e._adapter,{parser:n,round:i,isoWeekday:s}=e._parseOpts;let o=t;return typeof n=="function"&&(o=n(o)),Ln(o)||(o=typeof n=="string"?r.parse(o,n):r.parse(o)),o===null?null:(i&&(o=i==="week"&&(Z0(s)||s===!0)?r.startOf(o,"isoWeek",s):r.startOf(o,i)),+o)}function FA(e,t,r,n){const i=xa.length;for(let s=xa.indexOf(e);s<i-1;++s){const o=yv[xa[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((r-t)/(l*o.size))<=n)return xa[s]}return xa[i-1]}function Eue(e,t,r,n,i){for(let s=xa.length-1;s>=xa.indexOf(r);s--){const o=xa[s];if(yv[o].common&&e._adapter.diff(i,n,o)>=t-1)return o}return xa[r?xa.indexOf(r):0]}function Tue(e){for(let t=xa.indexOf(e)+1,r=xa.length;t<r;++t)if(yv[xa[t]].common)return xa[t]}function DA(e,t,r){if(!r)e[t]=!0;else if(r.length){const{lo:n,hi:i}=fC(r,t),s=r[n]>=t?r[n]:r[i];e[s]=!0}}function Aue(e,t,r,n){const i=e._adapter,s=+i.startOf(t[0].value,n),o=t[t.length-1].value;let l,c;for(l=s;l<=o;l=+i.add(l,1,n))c=r[l],c>=0&&(t[c].major=!0);return t}function PA(e,t,r){const n=[],i={},s=t.length;let o,l;for(o=0;o<s;++o)l=t[o],i[l]=o,n.push({value:l,major:!1});return s===0||!r?n:Aue(e,n,i,r)}class F1 extends ch{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const n=t.time||(t.time={}),i=this._adapter=new gce._date(t.adapters.date);i.init(r),f0(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return t===void 0?null:AA(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,n=t.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(i=Math.min(i,u.min)),!l&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),i=Ln(i)&&!isNaN(i)?i:+r.startOf(Date.now(),n),s=Ln(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],n=t[t.length-1]),{min:r,max:n}}buildTicks(){const t=this.options,r=t.time,n=t.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=Ioe(i,s,o);return this._unit=r.unit||(n.autoSkip?FA(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):Eue(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Tue(this._unit),this.initOffsets(i),t.reverse&&l.reverse(),PA(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let r=0,n=0,i,s;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?r=1-i:r=(this.getDecimalForValue(t[1])-i)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?n=s:n=(s-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=Mn(r,0,o),n=Mn(n,0,o),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const t=this._adapter,r=this.min,n=this.max,i=this.options,s=i.time,o=s.unit||FA(s.minUnit,r,n,this._getLabelCapacity(r)),l=ot(i.ticks.stepSize,1),c=o==="week"?s.isoWeekday:!1,u=Z0(c)||c===!0,h={};let f=r,m,v;if(u&&(f=+t.startOf(f,"isoWeek",c)),f=+t.startOf(f,u?"day":o),t.diff(n,r,o)>1e5*l)throw new Error(r+" and "+n+" are too far apart with stepSize of "+l+" "+o);const g=i.ticks.source==="data"&&this.getDataTimestamps();for(m=f,v=0;m<n;m=+t.add(m,l,o),v++)DA(h,m,g);return(m===n||i.bounds==="ticks"||v===1)&&DA(h,m,g),Object.keys(h).sort(TA).map(x=>+x)}getLabelForValue(t){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(t,n.tooltipFormat):r.format(t,n.displayFormats.datetime)}format(t,r){const i=this.options.time.displayFormats,s=this._unit,o=r||i[s];return this._adapter.format(t,o)}_tickFormatFunction(t,r,n,i){const s=this.options,o=s.ticks.callback;if(o)return qt(o,[t,r,n],this);const l=s.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&l[c],f=u&&l[u],m=n[r],v=u&&f&&m&&m.major;return this._adapter.format(t,i||(v?f:h))}generateTickLabels(t){let r,n,i;for(r=0,n=t.length;r<n;++r)i=t[r],i.label=this._tickFormatFunction(i.value,r,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,n=this.ctx.measureText(t).width,i=ho(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:n*s+l*o,h:n*o+l*s}}_getLabelCapacity(t){const r=this.options.time,n=r.displayFormats,i=n[r.unit]||n.millisecond,s=this._tickFormatFunction(t,0,PA(this,[t],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],r,n;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(r=0,n=i.length;r<n;++r)t=t.concat(i[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,n;if(t.length)return t;const i=this.getLabels();for(r=0,n=i.length;r<n;++r)t.push(AA(this,i[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return d6(t.sort(TA))}}Le(F1,"id","time"),Le(F1,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function jg(e,t,r){let n=0,i=e.length-1,s,o,l,c;r?(t>=e[n].pos&&t<=e[i].pos&&({lo:n,hi:i}=Dc(e,"pos",t)),{pos:s,time:l}=e[n],{pos:o,time:c}=e[i]):(t>=e[n].time&&t<=e[i].time&&({lo:n,hi:i}=Dc(e,"time",t)),{time:s,pos:l}=e[n],{time:o,pos:c}=e[i]);const u=o-s;return u?l+(c-l)*(t-s)/u:l}class MA extends F1{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(t);this._minPos=jg(r,this.min),this._tableRange=jg(r,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:r,max:n}=this,i=[],s=[];let o,l,c,u,h;for(o=0,l=t.length;o<l;++o)u=t[o],u>=r&&u<=n&&i.push(u);if(i.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(o=0,l=i.length;o<l;++o)h=i[o+1],c=i[o-1],u=i[o],Math.round((h+c)/2)!==u&&s.push({time:u,pos:o/(l-1)});return s}_generate(){const t=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?t=this.normalize(r.concat(n)):t=r.length?r:n,t=this._cache.all=t,t}getDecimalForValue(t){return(jg(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return jg(this._table,n*this._tableRange+this._minPos,!0)}}Le(MA,"id","timeseries"),Le(MA,"defaults",F1.defaults);const q6="label";function OA(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Fue(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function K6(e,t){e.labels=t}function X6(e,t,r=q6){const n=[];e.datasets=t.map(i=>{const s=e.datasets.find(o=>o[r]===i[r]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function Due(e,t=q6){const r={labels:[],datasets:[]};return K6(r,e.labels),X6(r,e.datasets,t),r}function Pue(e,t){const{height:r=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:f,...m}=e,v=S.useRef(null),g=S.useRef(null),x=()=>{v.current&&(g.current=new nn(v.current,{type:o,data:Due(l,s),options:c&&{...c},plugins:u}),OA(t,g.current))},_=()=>{OA(t,null),g.current&&(g.current.destroy(),g.current=null)};return S.useEffect(()=>{!i&&g.current&&c&&Fue(g.current,c)},[i,c]),S.useEffect(()=>{!i&&g.current&&K6(g.current.config.data,l.labels)},[i,l.labels]),S.useEffect(()=>{!i&&g.current&&l.datasets&&X6(g.current.config.data,l.datasets,s)},[i,l.datasets]),S.useEffect(()=>{g.current&&(i?(_(),setTimeout(x)):g.current.update(f))},[i,c,l.labels,l.datasets,f]),S.useEffect(()=>{g.current&&(_(),setTimeout(x))},[o]),S.useEffect(()=>(x(),()=>_()),[]),a.jsx("canvas",{ref:v,role:"img",height:r,width:n,...m,children:h})}const Mue=S.forwardRef(Pue);function bv(e,t){return nn.register(t),S.forwardRef((r,n)=>a.jsx(Mue,{...r,ref:n,type:e}))}const kd=bv("line",Tx),oa=bv("bar",Ex),Ep=bv("doughnut",ou),kC=bv("pie",Zw);nn.register(mn,gn,rn,ia,sa,aa,_a);const Oue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Rue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,Nue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,zue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Iue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Rb=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Nb=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Lue=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,RA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Bue=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Uue=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,zb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Ib=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Vue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;

  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,wg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,kg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Cg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Hue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,uc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Go=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Wue=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;

  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$percentage:e})=>e}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,Lb=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Gue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Sg={Ventas:"#4F46E5",Desarrollo:"#059669","Diseno Grafico":"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2","Sin asignar":"#6B7280"};function que({onNavigate:e}){const[t,r]=S.useState("all"),[n,i]=S.useState(""),[s,o]=S.useState(""),[l,c]=S.useState(!0),[u,h]=S.useState(null),[f,m]=S.useState(null),v=async()=>{c(!0),h(null);try{const w=await na.getOTsPorUsuario({date_desde:n||void 0,date_hasta:s||void 0,area_id:t!=="all"?parseInt(t):void 0});m(w)}catch(w){console.error("Error fetching report data:",w),h("Error al cargar los datos del reporte. Intente nuevamente.")}finally{c(!1)}};S.useEffect(()=>{v()},[]);const g=()=>{v()},x=S.useMemo(()=>f?f.items.map(w=>({userId:w.usuario_id,userName:w.usuario_nombre,area:w.area_nombre,areaId:w.area_id,otsActivas:w.ots_activas,otsCompletadas:w.ots_completadas,totalOTs:w.total_ots,tiempoPromedioDias:w.tiempo_promedio})):[],[f]),_=S.useMemo(()=>({totalOTsActivas:x.reduce((w,P)=>w+P.otsActivas,0),totalCompletadas:x.reduce((w,P)=>w+P.otsCompletadas,0),totalOTs:(f==null?void 0:f.total_ots)||0,totalUsuarios:(f==null?void 0:f.total_usuarios)||0}),[x,f]),b=S.useMemo(()=>({labels:x.slice(0,10).map(w=>w.userName.split(" ")[0]),datasets:[{label:"OTs Activas",data:x.slice(0,10).map(w=>w.otsActivas),backgroundColor:"#60A5FA"},{label:"OTs Completadas",data:x.slice(0,10).map(w=>w.otsCompletadas),backgroundColor:"#34D399"}]}),[x]),y=S.useMemo(()=>{const w=x.reduce((M,F)=>{const D=F.area||"Sin asignar";return M[D]=(M[D]||0)+F.totalOTs,M},{}),P=Object.entries(w);return{labels:P.map(([M])=>M),datasets:[{data:P.map(([,M])=>M),backgroundColor:P.map(([M])=>Sg[M]||"#6B7280")}]}},[x]),j={responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!1},y:{stacked:!1,beginAtZero:!0}}},k={responsive:!0,plugins:{legend:{position:"right"}}},E=Math.max(...x.map(w=>w.totalOTs),1),A=(f==null?void 0:f.areas)||[];return a.jsxs(Oue,{children:[a.jsx(Rue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Nue,{children:"OTs Activas por Usuario"}),a.jsx(zue,{children:a.jsxs(Iue,{children:[a.jsxs(Rb,{children:[a.jsx(Nb,{children:"Area"}),a.jsxs(Lue,{value:t,onChange:w=>r(w.target.value),children:[a.jsx("option",{value:"all",children:"Todas las Areas"}),A.map(w=>a.jsx("option",{value:w.id.toString(),children:w.nombre},w.id))]})]}),a.jsxs(Rb,{children:[a.jsx(Nb,{children:"Fecha Desde"}),a.jsx(RA,{type:"date",value:n,onChange:w=>i(w.target.value)})]}),a.jsxs(Rb,{children:[a.jsx(Nb,{children:"Fecha Hasta"}),a.jsx(RA,{type:"date",value:s,onChange:w=>o(w.target.value)})]}),a.jsx(Bue,{$variant:"primary",onClick:g,disabled:l,children:l?"Cargando...":"Aplicar Filtros"})]})}),u&&a.jsx(Gue,{children:u}),l?a.jsx(Lb,{children:"Cargando datos del reporte..."}):a.jsxs(a.Fragment,{children:[a.jsxs(Vue,{children:[a.jsxs(wg,{$color:d.colors.primary,children:[a.jsx(kg,{children:_.totalOTs}),a.jsx(Cg,{children:"OTs Totales"})]}),a.jsxs(wg,{$color:"#60A5FA",children:[a.jsx(kg,{children:_.totalOTsActivas}),a.jsx(Cg,{children:"OTs Activas"})]}),a.jsxs(wg,{$color:d.colors.success,children:[a.jsx(kg,{children:_.totalCompletadas}),a.jsx(Cg,{children:"OTs Completadas"})]}),a.jsxs(wg,{$color:"#7C3AED",children:[a.jsx(kg,{children:_.totalUsuarios}),a.jsx(Cg,{children:"Usuarios Activos"})]})]}),a.jsxs(Uue,{children:[a.jsxs(zb,{children:[a.jsx(Ib,{children:"Top 10 Usuarios por OTs"}),x.length>0?a.jsx(oa,{data:b,options:j}):a.jsx(Lb,{children:"No hay datos para mostrar"})]}),a.jsxs(zb,{children:[a.jsx(Ib,{children:"Distribucion por Area"}),x.length>0?a.jsx(kC,{data:y,options:k}):a.jsx(Lb,{children:"No hay datos para mostrar"})]})]}),a.jsxs(zb,{children:[a.jsxs(Ib,{children:["Detalle por Usuario (",x.length," registros)"]}),a.jsxs(Hue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(uc,{children:"Usuario"}),a.jsx(uc,{children:"Area"}),a.jsx(uc,{children:"OTs Totales"}),a.jsx(uc,{children:"Activas"}),a.jsx(uc,{children:"Completadas"}),a.jsx(uc,{children:"Tiempo Prom. (dias)"}),a.jsx(uc,{style:{width:"150px"},children:"Carga"})]})}),a.jsx("tbody",{children:x.length===0?a.jsx("tr",{children:a.jsx(Go,{colSpan:7,style:{textAlign:"center"},children:"No hay datos disponibles para los filtros seleccionados"})}):x.map(w=>a.jsxs("tr",{children:[a.jsx(Go,{style:{fontWeight:500},children:w.userName}),a.jsx(Go,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${Sg[w.area]||"#6B7280"}20`,color:Sg[w.area]||"#6B7280"},children:w.area})}),a.jsx(Go,{style:{fontWeight:600},children:w.totalOTs}),a.jsx(Go,{children:w.otsActivas}),a.jsx(Go,{children:w.otsCompletadas}),a.jsx(Go,{children:w.tiempoPromedioDias.toFixed(1)}),a.jsx(Go,{children:a.jsx(Wue,{$percentage:w.totalOTs/E*100,$color:Sg[w.area]||d.colors.primary})})]},`${w.userId}-${w.areaId}`))})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,ia,sa,aa,dh);const Kue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Xue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Yue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Que=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Jue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,NA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,zA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,IA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Bb=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Zue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,$g=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Eg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Tg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,ehe=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,LA=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,BA=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,the=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,hc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,qo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,rhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,nhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,ahe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,ihe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function she({onNavigate:e}){const t=ihe(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState(1),[c,u]=S.useState(!0),[h,f]=S.useState(null),[m,v]=S.useState(null),g=async()=>{u(!0),f(null);try{const y=await na.getOTsCompletadas({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});v(y)}catch(y){console.error("Error fetching report:",y),f("Error al cargar los datos del reporte.")}finally{u(!1)}};S.useEffect(()=>{g()},[o]);const x=()=>{l(1),g()},_=S.useMemo(()=>{if(!m)return null;const y=[{label:"0-3 dias",min:0,max:3,color:d.colors.success},{label:"4-7 dias",min:4,max:7,color:"#60A5FA"},{label:"8-15 dias",min:8,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],j=y.map(k=>m.items.filter(E=>E.tiempo_total>=k.min&&E.tiempo_total<=k.max).length);return{labels:y.map(k=>k.label),datasets:[{label:"OTs por Tiempo",data:j,backgroundColor:y.map(k=>k.color)}]}},[m]),b={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(Kue,{children:[a.jsx(Xue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Yue,{children:"OTs Completadas"}),a.jsx(Que,{children:a.jsxs(Jue,{children:[a.jsxs(NA,{children:[a.jsx(zA,{children:"Desde"}),a.jsx(IA,{type:"date",value:r,onChange:y=>n(y.target.value)})]}),a.jsxs(NA,{children:[a.jsx(zA,{children:"Hasta"}),a.jsx(IA,{type:"date",value:i,onChange:y=>s(y.target.value)})]}),a.jsx(Bb,{$variant:"primary",onClick:x,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(nhe,{children:h}),c?a.jsx(rhe,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(Zue,{children:[a.jsxs($g,{$color:d.colors.success,children:[a.jsx(Eg,{children:m.resumen.total_completadas}),a.jsx(Tg,{children:"Total Completadas"})]}),a.jsxs($g,{$color:d.colors.primary,children:[a.jsxs(Eg,{children:[m.resumen.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(Tg,{children:"Tiempo Promedio"})]}),a.jsxs($g,{$color:"#60A5FA",children:[a.jsxs(Eg,{children:[m.resumen.tiempo_minimo.toFixed(1)," dias"]}),a.jsx(Tg,{children:"Tiempo Minimo"})]}),a.jsxs($g,{$color:d.colors.warning,children:[a.jsxs(Eg,{children:[m.resumen.tiempo_maximo.toFixed(1)," dias"]}),a.jsx(Tg,{children:"Tiempo Maximo"})]})]}),a.jsx(ehe,{children:_&&a.jsxs(LA,{children:[a.jsx(BA,{children:"Distribucion por Tiempo de Completado"}),a.jsx(oa,{data:_,options:b})]})}),a.jsxs(LA,{children:[a.jsxs(BA,{children:["OTs Completadas (",m.total," registros)"]}),a.jsxs(the,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(hc,{children:"OT ID"}),a.jsx(hc,{children:"Cliente"}),a.jsx(hc,{children:"Descripcion"}),a.jsx(hc,{children:"Creacion"}),a.jsx(hc,{children:"Completada"}),a.jsx(hc,{children:"Tiempo (dias)"}),a.jsx(hc,{children:"Estado"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(qo,{colSpan:7,style:{textAlign:"center"},children:"No hay OTs completadas en el periodo seleccionado"})}):m.items.map(y=>{var j;return a.jsxs("tr",{children:[a.jsxs(qo,{style:{fontWeight:600},children:["#",y.id]}),a.jsx(qo,{children:y.client_name||"Sin cliente"}),a.jsxs(qo,{children:[((j=y.descripcion)==null?void 0:j.substring(0,40))||"-","..."]}),a.jsx(qo,{children:y.created_at}),a.jsx(qo,{children:y.completed_at}),a.jsx(qo,{style:{fontWeight:600,color:y.tiempo_total<=5?d.colors.success:y.tiempo_total<=10?d.colors.warning:d.colors.danger},children:y.tiempo_total.toFixed(1)}),a.jsx(qo,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${d.colors.success}20`,color:d.colors.success},children:y.estado})})]},y.id)})})]}),m.total_pages>1&&a.jsxs(ahe,{children:[a.jsx(Bb,{onClick:()=>l(y=>Math.max(1,y-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Bb,{onClick:()=>l(y=>Math.min(m.total_pages,y+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,ia,sa,aa);const ohe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,lhe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,che=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,dhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,uhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,hhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,fhe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,phe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,mhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,ghe=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
`,xhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,vhe=p.div`
  font-size: 1.5rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,_he=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,yhe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,i2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,bhe=p(i2)`
  grid-column: 1 / -1;
`,Ub=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,jhe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ag=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,hf=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,whe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,khe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,ff={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Che({onNavigate:e}){const[t,r]=S.useState(new Date().getFullYear()),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),u=async()=>{i(!0),o(null);try{const x=await na.getTiempoPorArea(t);c(x)}catch(x){console.error("Error fetching report:",x),o("Error al cargar los datos del reporte.")}finally{i(!1)}};S.useEffect(()=>{u()},[t]);const h=S.useMemo(()=>{if(!l)return[];const x={};return l.items.forEach(_=>{x[_.area_nombre]||(x[_.area_nombre]={total_tiempo:0,total_ots:0,count:0}),x[_.area_nombre].total_tiempo+=_.tiempo_promedio*_.total_ots,x[_.area_nombre].total_ots+=_.total_ots,x[_.area_nombre].count++}),Object.entries(x).map(([_,b])=>({area:_,tiempoPromedio:b.total_ots>0?b.total_tiempo/b.total_ots:0,totalOTs:b.total_ots}))},[l]),f=S.useMemo(()=>h.length?{labels:h.map(x=>x.area),datasets:[{label:"Tiempo Promedio (dias)",data:h.map(x=>x.tiempoPromedio),backgroundColor:h.map(x=>ff[x.area]||"#6B7280")}]}:null,[h]),m=S.useMemo(()=>{if(!l)return null;const x=[...new Set(l.items.map(_=>_.area_nombre))];return{labels:l.meses,datasets:x.map(_=>({label:_,data:l.meses.map(b=>{const y=l.items.find(j=>j.mes===b&&j.area_nombre===_);return(y==null?void 0:y.tiempo_promedio)||0}),borderColor:ff[_]||"#6B7280",backgroundColor:`${ff[_]||"#6B7280"}20`,tension:.3}))}},[l]),v={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}};return a.jsxs(ohe,{children:[a.jsx(lhe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(che,{children:"Tiempo Promedio por Area"}),a.jsx(dhe,{children:a.jsxs(uhe,{children:[a.jsxs(hhe,{children:[a.jsx(fhe,{children:"Ano"}),a.jsx(phe,{value:t,onChange:x=>r(Number(x.target.value)),children:Array.from({length:6},(x,_)=>new Date().getFullYear()-_).map(x=>a.jsx("option",{value:x,children:x},x))})]}),a.jsx(mhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(khe,{children:s}),n?a.jsx(whe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsx(ghe,{children:h.map(x=>a.jsxs(xhe,{$color:ff[x.area]||"#6B7280",children:[a.jsxs(vhe,{children:[x.tiempoPromedio.toFixed(1)," dias"]}),a.jsxs(_he,{children:[x.area," (",x.totalOTs," OTs)"]})]},x.area))}),a.jsxs(yhe,{children:[f&&a.jsxs(i2,{children:[a.jsx(Ub,{children:"Tiempo Promedio por Area"}),a.jsx(oa,{data:f,options:v})]}),m&&m.datasets.length>0&&a.jsxs(i2,{children:[a.jsx(Ub,{children:"Evolucion Mensual"}),a.jsx(kd,{data:m,options:g})]})]}),a.jsxs(bhe,{children:[a.jsx(Ub,{children:"Detalle por Area y Mes"}),a.jsxs(jhe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ag,{children:"Mes"}),a.jsx(Ag,{children:"Area"}),a.jsx(Ag,{children:"Tiempo Promedio"}),a.jsx(Ag,{children:"OTs Procesadas"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(hf,{colSpan:4,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.items.map((x,_)=>a.jsxs("tr",{children:[a.jsx(hf,{style:{fontWeight:600},children:x.mes}),a.jsxs(hf,{children:[a.jsx("span",{style:{display:"inline-block",width:"10px",height:"10px",borderRadius:"50%",backgroundColor:ff[x.area_nombre]||"#6B7280",marginRight:"0.5rem"}}),x.area_nombre]}),a.jsxs(hf,{style:{fontWeight:600},children:[x.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(hf,{children:x.total_ots})]},_))})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa,dh);const She=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,$he=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Ehe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,The=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Ahe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Fhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Dhe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Phe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Mhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Ohe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Fg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Dg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Pg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,UA=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,VA=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,pf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,mf=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Rhe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Vb=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Mg=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Nhe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,zhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
`,Ihe=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,Lhe=p.span`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
`,Bhe=p.span`
  font-size: 0.875rem;
  font-weight: 600;
  color: ${d.colors.danger};
`,Uhe=p.div`
  flex: 1;
  margin: 0 1rem;
  height: 8px;
  background: white;
  border-radius: 4px;
  overflow: hidden;
`,Vhe=p.div`
  height: 100%;
  width: ${({$width:e})=>e}%;
  background: ${({$color:e})=>e};
  border-radius: 4px;
`,Hhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Whe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Hb={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Ghe({onNavigate:e}){var k,E,A,w,P;const[t,r]=S.useState(new Date().getFullYear()),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),u=async()=>{i(!0),o(null);try{const M=await na.getRechazosMes(t);c(M)}catch(M){console.error("Error fetching report:",M),o("Error al cargar los datos del reporte.")}finally{i(!1)}};S.useEffect(()=>{u()},[t]);const h=S.useMemo(()=>{if(!l)return[];const M={};return l.items.forEach(F=>{M[F.mes]||(M[F.mes]=0),M[F.mes]+=F.total_rechazos}),Object.entries(M).map(([F,D])=>({mes:F,rechazos:D}))},[l]),f=S.useMemo(()=>h.length?{labels:h.map(M=>M.mes),datasets:[{label:"Rechazos",data:h.map(M=>M.rechazos),backgroundColor:d.colors.danger}]}:null,[h]),m=S.useMemo(()=>h.length?{labels:h.map(M=>M.mes),datasets:[{label:"Rechazos por Mes",data:h.map(M=>M.rechazos),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.3}]}:null,[h]),v=S.useMemo(()=>{var M;return(M=l==null?void 0:l.por_area)!=null&&M.length?{labels:l.por_area.map(F=>F.area),datasets:[{data:l.por_area.map(F=>F.cantidad),backgroundColor:l.por_area.map(F=>Hb[F.area]||"#6B7280"),borderWidth:0}]}:null},[l]),g={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad"}}}},x={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}},_={responsive:!0,plugins:{legend:{position:"right"}}},b=(k=l==null?void 0:l.por_area)!=null&&k.length?Math.max(...l.por_area.map(M=>M.cantidad)):0,y=S.useMemo(()=>{var D,W;if(h.length<2)return"stable";const M=((D=h[h.length-1])==null?void 0:D.rechazos)||0,F=((W=h[h.length-2])==null?void 0:W.rechazos)||0;return M<F?"down":M>F?"up":"stable"},[h]),j=h.length>0?h[h.length-1].rechazos:0;return a.jsxs(She,{children:[a.jsx($he,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Ehe,{children:"Rechazos por Mes"}),a.jsx(The,{children:a.jsxs(Ahe,{children:[a.jsxs(Fhe,{children:[a.jsx(Dhe,{children:"Ano"}),a.jsx(Phe,{value:t,onChange:M=>r(Number(M.target.value)),children:Array.from({length:6},(M,F)=>new Date().getFullYear()-F).map(M=>a.jsx("option",{value:M,children:M},M))})]}),a.jsx(Mhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(Whe,{children:s}),n?a.jsx(Hhe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(Ohe,{children:[a.jsxs(Fg,{$color:d.colors.danger,children:[a.jsx(Dg,{children:l.total_rechazos}),a.jsx(Pg,{children:"Total Rechazos (Ano)"})]}),a.jsxs(Fg,{$color:d.colors.warning,children:[a.jsx(Dg,{children:l.promedio_mensual.toFixed(1)}),a.jsx(Pg,{children:"Promedio Mensual"})]}),a.jsxs(Fg,{$color:y==="down"?d.colors.success:d.colors.danger,children:[a.jsx(Dg,{children:j}),a.jsx(Pg,{children:"Rechazos Ultimo Mes"}),a.jsx(UA,{children:y==="down"?" Mejorando":y==="up"?" Aumentando":" Estable"})]}),a.jsxs(Fg,{$color:d.colors.primary,children:[a.jsx(Dg,{children:((w=(A=(E=l.por_area)==null?void 0:E[0])==null?void 0:A.area)==null?void 0:w.split(" ")[0])||"-"}),a.jsx(Pg,{children:"Area con mas Rechazos"}),a.jsx(UA,{children:(P=l.por_area)!=null&&P[0]?`${l.por_area[0].cantidad} casos`:""})]})]}),a.jsxs(VA,{children:[f&&a.jsxs(pf,{children:[a.jsx(mf,{children:"Rechazos por Mes"}),a.jsx(oa,{data:f,options:g})]}),v&&a.jsxs(pf,{children:[a.jsx(mf,{children:"Distribucion por Area"}),a.jsx(Ep,{data:v,options:_})]})]}),a.jsxs(VA,{children:[m&&a.jsxs(pf,{children:[a.jsx(mf,{children:"Tendencia de Rechazos"}),a.jsx(kd,{data:m,options:x})]}),l.por_area&&l.por_area.length>0&&a.jsxs(pf,{children:[a.jsx(mf,{children:"Rechazos por Area"}),a.jsx(zhe,{children:l.por_area.map(M=>a.jsxs(Ihe,{children:[a.jsx(Lhe,{children:M.area}),a.jsx(Uhe,{children:a.jsx(Vhe,{$width:M.cantidad/b*100,$color:Hb[M.area]||"#6B7280"})}),a.jsx(Bhe,{children:M.cantidad})]},M.area))})]})]}),a.jsxs(pf,{children:[a.jsx(mf,{children:"Detalle por Mes y Area"}),a.jsxs(Rhe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Vb,{children:"Mes"}),a.jsx(Vb,{children:"Area"}),a.jsx(Vb,{children:"Rechazos"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(Mg,{colSpan:3,style:{textAlign:"center"},children:"No hay datos de rechazos para el ano seleccionado"})}):l.items.map((M,F)=>a.jsxs("tr",{children:[a.jsx(Mg,{style:{fontWeight:600},children:M.mes}),a.jsx(Mg,{children:a.jsx(Nhe,{$color:Hb[M.area_nombre||""]||"#6B7280",children:M.area_nombre||"Sin area"})}),a.jsx(Mg,{style:{fontWeight:600,color:d.colors.danger},children:M.total_rechazos})]},F))})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,ia,sa,aa,dh);const qhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Khe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Xhe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Yhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Qhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Jhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Zhe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,efe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,tfe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,rfe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Og=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Rg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Ng=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,nfe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,s2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,afe=p(s2)`
  grid-column: 1 / -1;
`,Wb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,ife=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Bd=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,fc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,sfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,ofe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,lfe=p.span`
  font-size: 0.75rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  background: ${({$trend:e})=>e==="up"?`${d.colors.success}20`:e==="down"?`${d.colors.danger}20`:`${d.colors.textSecondary}20`};
  color: ${({$trend:e})=>e==="up"?d.colors.success:e==="down"?d.colors.danger:d.colors.textSecondary};
`;function cfe({onNavigate:e}){const[t,r]=S.useState(new Date().getFullYear()),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),u=async()=>{i(!0),o(null);try{const _=await na.getCargaMensual(t);c(_)}catch(_){console.error("Error fetching report:",_),o("Error al cargar los datos del reporte.")}finally{i(!1)}};S.useEffect(()=>{u()},[t]);const h=S.useMemo(()=>{if(!l)return[];let _=0;return l.items.map(b=>(_+=b.total_ots-b.ots_completadas,{...b,pendientesAcum:Math.max(0,_),balance:b.total_ots-b.ots_completadas}))},[l]),f=S.useMemo(()=>h.length?{labels:h.map(_=>_.mes),datasets:[{label:"OTs Nuevas",data:h.map(_=>_.ots_nuevas),backgroundColor:d.colors.primary},{label:"OTs Completadas",data:h.map(_=>_.ots_completadas),backgroundColor:d.colors.success}]}:null,[h]),m=S.useMemo(()=>h.length?{labels:h.map(_=>_.mes),datasets:[{label:"OTs Activas",data:h.map(_=>_.ots_activas),borderColor:"#7C3AED",backgroundColor:"#7C3AED20",fill:!0,tension:.3},{label:"Pendientes Acum.",data:h.map(_=>_.pendientesAcum),borderColor:d.colors.warning,backgroundColor:`${d.colors.warning}20`,fill:!0,tension:.3}]}:null,[h]),v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},x=_=>_<0?"up":_>5?"down":"stable";return a.jsxs(qhe,{children:[a.jsx(Khe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Xhe,{children:"Carga de OTs por Mes"}),a.jsx(Yhe,{children:a.jsxs(Qhe,{children:[a.jsxs(Jhe,{children:[a.jsx(Zhe,{children:"Ano"}),a.jsx(efe,{value:t,onChange:_=>r(Number(_.target.value)),children:Array.from({length:6},(_,b)=>new Date().getFullYear()-b).map(_=>a.jsx("option",{value:_,children:_},_))})]}),a.jsx(tfe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(ofe,{children:s}),n?a.jsx(sfe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(rfe,{children:[a.jsxs(Og,{$color:d.colors.primary,children:[a.jsx(Rg,{children:l.total_anual}),a.jsx(Ng,{children:"OTs Totales (Ano)"})]}),a.jsxs(Og,{$color:d.colors.success,children:[a.jsx(Rg,{children:l.items.reduce((_,b)=>_+b.ots_completadas,0)}),a.jsx(Ng,{children:"OTs Completadas (Ano)"})]}),a.jsxs(Og,{$color:"#7C3AED",children:[a.jsx(Rg,{children:l.promedio_mensual.toFixed(0)}),a.jsx(Ng,{children:"Promedio Mensual"})]}),a.jsxs(Og,{$color:d.colors.warning,children:[a.jsx(Rg,{children:h.length>0?h[h.length-1].ots_activas:0}),a.jsx(Ng,{children:"OTs Activas Actuales"})]})]}),a.jsxs(nfe,{children:[f&&a.jsxs(s2,{children:[a.jsx(Wb,{children:"OTs Creadas vs Completadas"}),a.jsx(oa,{data:f,options:v})]}),m&&a.jsxs(s2,{children:[a.jsx(Wb,{children:"Tendencia de Carga"}),a.jsx(kd,{data:m,options:g})]})]}),a.jsxs(afe,{children:[a.jsx(Wb,{children:"Detalle Mensual"}),a.jsxs(ife,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Bd,{children:"Mes"}),a.jsx(Bd,{children:"OTs Nuevas"}),a.jsx(Bd,{children:"OTs Completadas"}),a.jsx(Bd,{children:"Balance"}),a.jsx(Bd,{children:"OTs Activas"}),a.jsx(Bd,{children:"Tendencia"})]})}),a.jsx("tbody",{children:h.length===0?a.jsx("tr",{children:a.jsx(fc,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):h.map(_=>a.jsxs("tr",{children:[a.jsx(fc,{style:{fontWeight:600},children:_.mes}),a.jsx(fc,{children:_.ots_nuevas}),a.jsx(fc,{children:_.ots_completadas}),a.jsxs(fc,{style:{color:_.balance>0?d.colors.danger:d.colors.success},children:[_.balance>0?"+":"",_.balance]}),a.jsx(fc,{children:_.ots_activas}),a.jsx(fc,{children:a.jsx(lfe,{$trend:x(_.balance),children:x(_.balance)==="up"?" Eficiente":x(_.balance)==="down"?" Acumulando":" Estable"})})]},_.mes))})]})]})]})]})}nn.register(mn,gn,rn,_a,ia,sa,aa);const dfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ufe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,hfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,ffe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,pfe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,HA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,WA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,GA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Gb=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,mfe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,zg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Ig=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Lg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,gfe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,qb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Kb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,xfe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ud=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,pc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,vfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,_fe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,yfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,bfe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,qA={"Cancelacion del cliente":"#DC2626","Error en especificaciones":"#D97706",Duplicado:"#7C3AED","Cambio de prioridades":"#059669",Otros:"#6B7280"},jfe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function wfe({onNavigate:e}){var A,w;const t=jfe(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState(1),[c,u]=S.useState(!0),[h,f]=S.useState(null),[m,v]=S.useState(null),g=async()=>{u(!0),f(null);try{const P=await na.getAnulaciones({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});v(P)}catch(P){console.error("Error fetching report:",P),f("Error al cargar los datos del reporte.")}finally{u(!1)}};S.useEffect(()=>{g()},[o]);const x=()=>{l(1),g()},_=S.useMemo(()=>{if(!m)return[];const P={};return m.items.forEach(M=>{const F=M.motivo||"Otros";P[F]||(P[F]=0),P[F]++}),Object.entries(P).map(([M,F])=>({motivo:M,cantidad:F})).sort((M,F)=>F.cantidad-M.cantidad)},[m]),b=S.useMemo(()=>{var M;return(M=m==null?void 0:m.por_mes)!=null&&M.length?(m.por_mes.reduce((F,D)=>F+D.cantidad,0)/m.por_mes.length).toFixed(1):0},[m]),y=S.useMemo(()=>{var P;return(P=m==null?void 0:m.por_mes)!=null&&P.length?{labels:m.por_mes.map(M=>M.mes),datasets:[{label:"Anulaciones",data:m.por_mes.map(M=>M.cantidad),backgroundColor:d.colors.danger}]}:null},[m]),j=S.useMemo(()=>_.length?{labels:_.map(P=>P.motivo),datasets:[{data:_.map(P=>P.cantidad),backgroundColor:_.map(P=>qA[P.motivo]||"#6B7280"),borderWidth:0}]}:null,[_]),k=((A=_[0])==null?void 0:A.motivo)||"-",E=(w=m==null?void 0:m.por_mes)!=null&&w.length?m.por_mes[m.por_mes.length-1].cantidad:0;return a.jsxs(dfe,{children:[a.jsx(ufe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(hfe,{children:"Anulaciones de OTs"}),a.jsx(ffe,{children:a.jsxs(pfe,{children:[a.jsxs(HA,{children:[a.jsx(WA,{children:"Desde"}),a.jsx(GA,{type:"date",value:r,onChange:P=>n(P.target.value)})]}),a.jsxs(HA,{children:[a.jsx(WA,{children:"Hasta"}),a.jsx(GA,{type:"date",value:i,onChange:P=>s(P.target.value)})]}),a.jsx(Gb,{$variant:"primary",onClick:x,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(yfe,{children:h}),c?a.jsx(_fe,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(mfe,{children:[a.jsxs(zg,{$color:d.colors.danger,children:[a.jsx(Ig,{children:m.total}),a.jsx(Lg,{children:"Total Anulaciones"})]}),a.jsxs(zg,{$color:d.colors.warning,children:[a.jsx(Ig,{children:b}),a.jsx(Lg,{children:"Promedio Mensual"})]}),a.jsxs(zg,{$color:d.colors.primary,children:[a.jsx(Ig,{children:E}),a.jsx(Lg,{children:"Ultimo Mes"})]}),a.jsxs(zg,{$color:"#7C3AED",children:[a.jsx(Ig,{children:k.split(" ")[0]}),a.jsx(Lg,{children:"Motivo Principal"})]})]}),a.jsxs(gfe,{children:[y&&a.jsxs(qb,{children:[a.jsx(Kb,{children:"Anulaciones por Mes"}),a.jsx(oa,{data:y,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),j&&a.jsxs(qb,{children:[a.jsx(Kb,{children:"Distribucion por Motivo"}),a.jsx(Ep,{data:j,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]})]}),a.jsxs(qb,{children:[a.jsxs(Kb,{children:["Ultimas Anulaciones (",m.total," registros)"]}),a.jsxs(xfe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ud,{children:"OT ID"}),a.jsx(Ud,{children:"Cliente"}),a.jsx(Ud,{children:"Descripcion"}),a.jsx(Ud,{children:"Motivo"}),a.jsx(Ud,{children:"Fecha"}),a.jsx(Ud,{children:"Usuario"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(pc,{colSpan:6,style:{textAlign:"center"},children:"No hay anulaciones en el periodo seleccionado"})}):m.items.map(P=>{var M;return a.jsxs("tr",{children:[a.jsxs(pc,{style:{fontWeight:600},children:["#",P.id]}),a.jsx(pc,{children:P.client_name||"Sin cliente"}),a.jsxs(pc,{children:[((M=P.descripcion)==null?void 0:M.substring(0,40))||"-","..."]}),a.jsx(pc,{children:a.jsx(vfe,{$color:qA[P.motivo||"Otros"]||"#6B7280",children:P.motivo||"Sin motivo"})}),a.jsx(pc,{children:P.fecha}),a.jsx(pc,{children:P.usuario})]},P.id)})})]}),m.total_pages>1&&a.jsxs(bfe,{children:[a.jsx(Gb,{onClick:()=>l(P=>Math.max(1,P-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Gb,{onClick:()=>l(P=>Math.min(m.total_pages,P+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}nn.register(mn,gn,rn,Ur,ea,ia,sa,aa);const kfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Cfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Sfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,$fe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Efe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Bg=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ug=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Xb=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Tfe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Afe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Ffe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,gf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,xf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,vf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Dfe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,Vg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Hg=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,KA=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Wi=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Ma=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,XA=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,Pfe=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,Yb=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Mfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,YA={"Diseno Grafico":"#4F46E5","Diseno Estructural":"#059669","Pre-Prensa":"#D97706",Cotizaciones:"#7C3AED","Sala de Muestras":"#DC2626","Area de Ventas":"#0891B2",Catalogacion:"#BE185D"},Ofe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function Rfe({onNavigate:e}){const t=Ofe(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState("todas"),[c,u]=S.useState(""),[h,f]=S.useState(!0),[m,v]=S.useState(null),[g,x]=S.useState(null),_=async()=>{f(!0),v(null);try{const w=await na.getOTsCompletadas({date_desde:r,date_hasta:i,area_id:o!=="todas"?parseInt(o):void 0,page_size:100});x(w)}catch(w){console.error("Error fetching report:",w),v("Error al cargar los datos del reporte.")}finally{f(!1)}};S.useEffect(()=>{_()},[]);const b=S.useMemo(()=>{var w,P,M,F;return g?{total:((w=g.resumen)==null?void 0:w.total)||g.total||0,enPlazo:((P=g.resumen)==null?void 0:P.en_plazo)||0,fueraPlazo:((M=g.resumen)==null?void 0:M.fuera_plazo)||0,promedioDias:((F=g.resumen)==null?void 0:F.promedio_dias)||0}:{total:0,enPlazo:0,fueraPlazo:0,promedioDias:0}},[g]),y=S.useMemo(()=>{if(!(g!=null&&g.items))return[];const w={};g.items.forEach(M=>{const F=M.area_nombre||"Sin Area";w[F]=(w[F]||0)+1});const P=g.items.length||1;return Object.entries(w).map(([M,F])=>({area:M,completadas:F,porcentaje:F/P*100})).sort((M,F)=>F.completadas-M.completadas)},[g]),j=S.useMemo(()=>{if(!(g!=null&&g.items))return[];const w={};return g.items.forEach(P=>{const M=new Date(P.completed_at||P.created_at),D=`Sem ${Math.ceil(M.getDate()/7)}`;w[D]||(w[D]={completadas:0,enPlazo:0,fueraPlazo:0}),w[D].completadas++,P.en_plazo?w[D].enPlazo++:w[D].fueraPlazo++}),Object.entries(w).map(([P,M])=>({week:P,...M})).sort((P,M)=>P.week.localeCompare(M.week))},[g]),k=b.total>0?(b.enPlazo/b.total*100).toFixed(1):"0",E=S.useMemo(()=>({labels:j.map(w=>w.week),datasets:[{label:"En Plazo",data:j.map(w=>w.enPlazo),backgroundColor:d.colors.success},{label:"Fuera de Plazo",data:j.map(w=>w.fueraPlazo),backgroundColor:d.colors.danger}]}),[j]),A=S.useMemo(()=>({labels:j.map(w=>w.week),datasets:[{label:"OTs Completadas",data:j.map(w=>w.completadas),borderColor:d.colors.primary,backgroundColor:`${d.colors.primary}20`,fill:!0,tension:.4}]}),[j]);return a.jsxs(kfe,{children:[a.jsx(Cfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Sfe,{children:"OTs Completadas Entre Fechas"}),a.jsx($fe,{children:a.jsxs(Efe,{children:[a.jsxs(Bg,{children:[a.jsx(Ug,{children:"Fecha Desde"}),a.jsx(Xb,{type:"date",value:r,onChange:w=>n(w.target.value)})]}),a.jsxs(Bg,{children:[a.jsx(Ug,{children:"Fecha Hasta"}),a.jsx(Xb,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(Bg,{children:[a.jsx(Ug,{children:"Area"}),a.jsxs(Tfe,{value:o,onChange:w=>l(w.target.value),children:[a.jsx("option",{value:"todas",children:"Todas las Areas"}),a.jsx("option",{value:"1",children:"Area de Ventas"}),a.jsx("option",{value:"2",children:"Diseno Estructural"}),a.jsx("option",{value:"3",children:"Diseno Grafico"}),a.jsx("option",{value:"4",children:"Pre-Prensa"}),a.jsx("option",{value:"5",children:"Cotizaciones"}),a.jsx("option",{value:"6",children:"Sala de Muestras"})]})]}),a.jsxs(Bg,{children:[a.jsx(Ug,{children:"Cliente"}),a.jsx(Xb,{type:"text",placeholder:"Buscar cliente...",value:c,onChange:w=>u(w.target.value)})]}),a.jsx(Afe,{$variant:"primary",onClick:_,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(Mfe,{children:m}),h?a.jsx(Yb,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(Ffe,{children:[a.jsxs(gf,{$color:d.colors.primary,children:[a.jsx(xf,{children:b.total}),a.jsx(vf,{children:"Total Completadas"})]}),a.jsxs(gf,{$color:d.colors.success,children:[a.jsx(xf,{children:b.enPlazo}),a.jsx(vf,{children:"En Plazo"})]}),a.jsxs(gf,{$color:d.colors.danger,children:[a.jsx(xf,{children:b.fueraPlazo}),a.jsx(vf,{children:"Fuera de Plazo"})]}),a.jsxs(gf,{$color:d.colors.warning,children:[a.jsxs(xf,{children:[k,"%"]}),a.jsx(vf,{children:"% Cumplimiento"})]}),a.jsxs(gf,{$color:"#7C3AED",children:[a.jsx(xf,{children:b.promedioDias.toFixed(1)}),a.jsx(vf,{children:"Dias Promedio"})]})]}),a.jsxs(Dfe,{children:[a.jsxs(Vg,{children:[a.jsx(Hg,{children:"Completadas por Semana"}),j.length>0?a.jsx(oa,{data:E,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}}):a.jsx(Yb,{children:"No hay datos para mostrar"})]}),a.jsxs(Vg,{children:[a.jsx(Hg,{children:"Tendencia de Completadas"}),j.length>0?a.jsx(kd,{data:A,options:{responsive:!0,plugins:{legend:{display:!1}}}}):a.jsx(Yb,{children:"No hay datos para mostrar"})]})]}),a.jsxs(Vg,{style:{marginBottom:"1.5rem"},children:[a.jsx(Hg,{children:"Distribucion por Area"}),a.jsxs(KA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Wi,{children:"Area"}),a.jsx(Wi,{children:"Completadas"}),a.jsx(Wi,{children:"Porcentaje"}),a.jsx(Wi,{style:{width:"40%"},children:"Progreso"})]})}),a.jsx("tbody",{children:y.length===0?a.jsx("tr",{children:a.jsx(Ma,{colSpan:4,style:{textAlign:"center"},children:"No hay datos"})}):y.map(w=>a.jsxs("tr",{children:[a.jsx(Ma,{children:a.jsx(XA,{$color:YA[w.area]||"#6B7280",children:w.area})}),a.jsx(Ma,{style:{fontWeight:600},children:w.completadas}),a.jsxs(Ma,{children:[w.porcentaje.toFixed(1),"%"]}),a.jsx(Ma,{children:a.jsx(Pfe,{$value:w.porcentaje,$color:YA[w.area]||"#6B7280"})})]},w.area))})]})]}),a.jsxs(Vg,{children:[a.jsxs(Hg,{children:["Detalle de OTs Completadas (",g.items.length," registros)"]}),a.jsxs(KA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Wi,{children:"OT ID"}),a.jsx(Wi,{children:"Cliente"}),a.jsx(Wi,{children:"Descripcion"}),a.jsx(Wi,{children:"Creacion"}),a.jsx(Wi,{children:"Completada"}),a.jsx(Wi,{children:"Dias"}),a.jsx(Wi,{children:"Estado"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Ma,{colSpan:7,style:{textAlign:"center"},children:"No hay OTs completadas en el rango de fechas seleccionado"})}):g.items.slice(0,50).map(w=>{var M;const P=w.dias_proceso||Math.round((new Date(w.completed_at).getTime()-new Date(w.created_at).getTime())/864e5);return a.jsxs("tr",{children:[a.jsxs(Ma,{style:{fontWeight:600},children:["#",w.id]}),a.jsx(Ma,{children:w.client_name||"Sin cliente"}),a.jsx(Ma,{children:((M=w.descripcion)==null?void 0:M.substring(0,30))||"-"}),a.jsx(Ma,{children:new Date(w.created_at).toLocaleDateString()}),a.jsx(Ma,{children:new Date(w.completed_at).toLocaleDateString()}),a.jsx(Ma,{style:{fontWeight:600},children:P}),a.jsx(Ma,{children:a.jsx(XA,{$color:w.en_plazo?d.colors.success:d.colors.danger,children:w.en_plazo?"En Plazo":"Fuera Plazo"})})]},w.id)})})]})]})]})]})}nn.register(mn,gn,rn,_a,ia,sa,aa);const Nfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,zfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Ife=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Lfe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Bfe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Ufe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Vfe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,_f=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,yf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,bf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Hfe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,Qb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Jb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Wfe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,jf=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Vd=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Gfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,qfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  ${({$level:e})=>{switch(e){case"critical":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.success}20; color: ${d.colors.success};`}}}
`,Kfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Xfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,QA={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Yfe({onNavigate:e}){var v,g,x;const[t,r]=S.useState(!0),[n,i]=S.useState(null),[s,o]=S.useState(null),l=async()=>{r(!0),i(null);try{const _=await na.getGestionOTsActivas();o(_)}catch(_){console.error("Error fetching report:",_),i("Error al cargar los datos del reporte.")}finally{r(!1)}};S.useEffect(()=>{l()},[]);const c=S.useMemo(()=>s!=null&&s.por_area?s.por_area.reduce((_,b)=>_+b.ots_atrasadas,0):0,[s]),u=S.useMemo(()=>{var y;if(!((y=s==null?void 0:s.por_area)!=null&&y.length))return 0;const _=s.por_area.reduce((j,k)=>j+k.dias_promedio*k.total_ots,0),b=s.por_area.reduce((j,k)=>j+k.total_ots,0);return b>0?(_/b).toFixed(1):"0"},[s]),h=S.useMemo(()=>{var _;return(_=s==null?void 0:s.por_area)!=null&&_.length?{labels:s.por_area.map(b=>b.area_nombre),datasets:[{label:"Normal",data:s.por_area.map(b=>Math.max(0,b.total_ots-b.ots_atrasadas)),backgroundColor:d.colors.success},{label:"Atrasadas",data:s.por_area.map(b=>b.ots_atrasadas),backgroundColor:d.colors.danger}]}:null},[s]),f=S.useMemo(()=>{var _;return(_=s==null?void 0:s.por_area)!=null&&_.length?{labels:s.por_area.map(b=>b.area_nombre),datasets:[{data:s.por_area.map(b=>b.total_ots),backgroundColor:s.por_area.map(b=>QA[b.area_nombre]||"#6B7280"),borderWidth:0}]}:null},[s]),m=(_,b)=>{const y=b>0?_/b*100:0;return y>20?"critical":y>10?"warning":"normal"};return a.jsxs(Nfe,{children:[a.jsx(zfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Ife,{children:"Gestion de OTs Activas"}),a.jsx(Lfe,{children:a.jsx(Bfe,{children:a.jsx(Ufe,{$variant:"primary",onClick:l,disabled:t,children:t?"Cargando...":"Actualizar"})})}),n&&a.jsx(Xfe,{children:n}),t?a.jsx(Kfe,{children:"Cargando datos del reporte..."}):s&&a.jsxs(a.Fragment,{children:[a.jsxs(Vfe,{children:[a.jsxs(_f,{$color:d.colors.primary,children:[a.jsx(yf,{children:s.total_activas}),a.jsx(bf,{children:"Total OTs Activas"})]}),a.jsxs(_f,{$color:d.colors.success,children:[a.jsx(yf,{children:s.total_activas-c}),a.jsx(bf,{children:"En Tiempo"})]}),a.jsxs(_f,{$color:d.colors.danger,children:[a.jsx(yf,{children:c}),a.jsx(bf,{children:"Atrasadas"})]}),a.jsxs(_f,{$color:d.colors.warning,children:[a.jsxs(yf,{children:[u,"d"]}),a.jsx(bf,{children:"Dias Promedio"})]}),a.jsxs(_f,{$color:"#7C3AED",children:[a.jsx(yf,{children:((v=s.por_area)==null?void 0:v.length)||0}),a.jsx(bf,{children:"Areas con OTs"})]})]}),a.jsxs(Hfe,{children:[h&&a.jsxs(Qb,{children:[a.jsx(Jb,{children:"Estado de OTs por Area"}),a.jsx(oa,{data:h,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}})]}),f&&a.jsxs(Qb,{children:[a.jsx(Jb,{children:"Distribucion por Area"}),a.jsx(Ep,{data:f,options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})]})]}),a.jsxs(Qb,{children:[a.jsx(Jb,{children:"Detalle por Area"}),a.jsxs(Wfe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(jf,{children:"Area"}),a.jsx(jf,{children:"Total OTs"}),a.jsx(jf,{children:"Dias Promedio"}),a.jsx(jf,{children:"Atrasadas"}),a.jsx(jf,{children:"Estado"})]})}),a.jsx("tbody",{children:((g=s.por_area)==null?void 0:g.length)===0?a.jsx("tr",{children:a.jsx(Vd,{colSpan:5,style:{textAlign:"center"},children:"No hay OTs activas actualmente"})}):(x=s.por_area)==null?void 0:x.map(_=>a.jsxs("tr",{children:[a.jsx(Vd,{children:a.jsx(Gfe,{$color:QA[_.area_nombre]||"#6B7280",children:_.area_nombre})}),a.jsx(Vd,{style:{fontWeight:600},children:_.total_ots}),a.jsxs(Vd,{children:[_.dias_promedio.toFixed(1),"d"]}),a.jsx(Vd,{style:{fontWeight:600,color:_.ots_atrasadas>0?d.colors.danger:"inherit"},children:_.ots_atrasadas}),a.jsx(Vd,{children:a.jsx(qfe,{$level:m(_.ots_atrasadas,_.total_ots),children:m(_.ots_atrasadas,_.total_ots)==="critical"?"Critico":m(_.ots_atrasadas,_.total_ots)==="warning"?"Alerta":"Normal"})})]},_.area_id||_.area_nombre))})]})]})]})]})}nn.register(mn,gn,rn,Ur,ea,ia,sa,aa,dh);const Qfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Jfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Zfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,e0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,t0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,JA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ZA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,e3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Zb=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,r0e=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Wg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Gg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,qg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,n0e=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,t3=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,r3=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,a0e=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,mc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Ko=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,i0e=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,s0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,o0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,l0e=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,c0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function d0e({onNavigate:e}){const t=c0e(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState(1),[c,u]=S.useState(!0),[h,f]=S.useState(null),[m,v]=S.useState(null),g=async()=>{u(!0),f(null);try{const b=await na.getTiempoPrimeraMuestra({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});v(b)}catch(b){console.error("Error fetching report:",b),f("Error al cargar los datos del reporte.")}finally{u(!1)}};S.useEffect(()=>{g()},[o]);const x=()=>{l(1),g()},_=S.useMemo(()=>{var j;if(!((j=m==null?void 0:m.items)!=null&&j.length))return null;const b=[{label:"0-5 dias",min:0,max:5,color:d.colors.success},{label:"6-10 dias",min:6,max:10,color:"#60A5FA"},{label:"11-15 dias",min:11,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],y=b.map(k=>m.items.filter(E=>E.dias_hasta_muestra!==null&&E.dias_hasta_muestra>=k.min&&E.dias_hasta_muestra<=k.max).length);return{labels:b.map(k=>k.label),datasets:[{label:"OTs",data:y,backgroundColor:b.map(k=>k.color)}]}},[m]);return a.jsxs(Qfe,{children:[a.jsx(Jfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Zfe,{children:"Tiempo Primera Muestra"}),a.jsx(e0e,{children:a.jsxs(t0e,{children:[a.jsxs(JA,{children:[a.jsx(ZA,{children:"Desde"}),a.jsx(e3,{type:"date",value:r,onChange:b=>n(b.target.value)})]}),a.jsxs(JA,{children:[a.jsx(ZA,{children:"Hasta"}),a.jsx(e3,{type:"date",value:i,onChange:b=>s(b.target.value)})]}),a.jsx(Zb,{$variant:"primary",onClick:x,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(o0e,{children:h}),c?a.jsx(s0e,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(r0e,{children:[a.jsxs(Wg,{$color:d.colors.primary,children:[a.jsx(Gg,{children:m.total}),a.jsx(qg,{children:"Total OTs"})]}),a.jsxs(Wg,{$color:d.colors.warning,children:[a.jsxs(Gg,{children:[m.promedio_dias.toFixed(1),"d"]}),a.jsx(qg,{children:"Tiempo Promedio"})]}),a.jsxs(Wg,{$color:d.colors.success,children:[a.jsxs(Gg,{children:[m.minimo_dias.toFixed(1),"d"]}),a.jsx(qg,{children:"Tiempo Minimo"})]}),a.jsxs(Wg,{$color:d.colors.danger,children:[a.jsxs(Gg,{children:[m.maximo_dias.toFixed(1),"d"]}),a.jsx(qg,{children:"Tiempo Maximo"})]})]}),a.jsx(n0e,{children:_&&a.jsxs(t3,{children:[a.jsx(r3,{children:"Distribucion por Tiempo hasta Primera Muestra"}),a.jsx(oa,{data:_,options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})]})}),a.jsxs(t3,{children:[a.jsxs(r3,{children:["Detalle de OTs (",m.total," registros)"]}),a.jsxs(a0e,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(mc,{children:"OT ID"}),a.jsx(mc,{children:"Cliente"}),a.jsx(mc,{children:"Descripcion"}),a.jsx(mc,{children:"Creacion"}),a.jsx(mc,{children:"Primera Muestra"}),a.jsx(mc,{children:"Dias"}),a.jsx(mc,{children:"Estado"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(Ko,{colSpan:7,style:{textAlign:"center"},children:"No hay datos en el periodo seleccionado"})}):m.items.map(b=>{var y;return a.jsxs("tr",{children:[a.jsxs(Ko,{style:{fontWeight:600},children:["#",b.id]}),a.jsx(Ko,{children:b.client_name||"Sin cliente"}),a.jsxs(Ko,{children:[((y=b.descripcion)==null?void 0:y.substring(0,40))||"-","..."]}),a.jsx(Ko,{children:b.created_at}),a.jsx(Ko,{children:b.primera_muestra_at||"-"}),a.jsx(Ko,{style:{fontWeight:600,color:b.dias_hasta_muestra===null?d.colors.textSecondary:b.dias_hasta_muestra<=10?d.colors.success:b.dias_hasta_muestra<=15?d.colors.warning:d.colors.danger},children:b.dias_hasta_muestra!==null?`${b.dias_hasta_muestra}d`:"Pendiente"}),a.jsx(Ko,{children:a.jsx(i0e,{$color:b.dias_hasta_muestra!==null?d.colors.success:d.colors.warning,children:b.dias_hasta_muestra!==null?"Con muestra":"Sin muestra"})})]},b.id)})})]}),m.total_pages>1&&a.jsxs(l0e,{children:[a.jsx(Zb,{onClick:()=>l(b=>Math.max(1,b-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Zb,{onClick:()=>l(b=>Math.min(m.total_pages,b+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}nn.register(mn,gn,rn,_a,Ur,ea,ia,sa,aa,dh);const u0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,h0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,f0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,p0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,m0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,n3=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,a3=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,i3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,g0e=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,x0e=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Kg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Xg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Yg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,v0e=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: 1fr 1fr; }
  @media (max-width: 768px) { grid-template-columns: 1fr; }
`,wf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,kf=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,s3=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,gc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Xo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,_0e=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,y0e=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
  }
`,b0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,j0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Cf={"Error de diseno":"#DC2626","Colores incorrectos":"#D97706","Dimensiones erroneas":"#7C3AED","Materiales inadecuados":"#059669","Texto ilegible":"#4F46E5",Otros:"#6B7280"},w0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function k0e({onNavigate:e}){var j,k,E;const t=w0e(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState(!0),[c,u]=S.useState(null),[h,f]=S.useState(null),m=async()=>{l(!0),u(null);try{const A=await na.getMotivosRechazo({date_desde:r||void 0,date_hasta:i||void 0});f(A)}catch(A){console.error("Error fetching report:",A),u("Error al cargar los datos del reporte.")}finally{l(!1)}};S.useEffect(()=>{m()},[]);const v=()=>{m()},g=((j=h==null?void 0:h.items)==null?void 0:j[0])||null,x=(k=h==null?void 0:h.por_mes)!=null&&k.length?h.por_mes[h.por_mes.length-1]:null,_=S.useMemo(()=>{var A;return(A=h==null?void 0:h.items)!=null&&A.length?{labels:h.items.map(w=>w.motivo),datasets:[{data:h.items.map(w=>w.cantidad),backgroundColor:h.items.map(w=>Cf[w.motivo]||"#6B7280"),borderWidth:0}]}:null},[h]),b=S.useMemo(()=>{var A;return(A=h==null?void 0:h.items)!=null&&A.length?{labels:h.items.map(w=>w.motivo),datasets:[{label:"Rechazos",data:h.items.map(w=>w.cantidad),backgroundColor:h.items.map(w=>Cf[w.motivo]||"#6B7280")}]}:null},[h]),y=S.useMemo(()=>{var A;return(A=h==null?void 0:h.por_mes)!=null&&A.length?{labels:h.por_mes.map(w=>w.mes),datasets:[{label:"Cantidad Rechazos",data:h.por_mes.map(w=>w.cantidad),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.4}]}:null},[h]);return a.jsxs(u0e,{children:[a.jsx(h0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(f0e,{children:"Motivos de Rechazo"}),a.jsx(p0e,{children:a.jsxs(m0e,{children:[a.jsxs(n3,{children:[a.jsx(a3,{children:"Desde"}),a.jsx(i3,{type:"date",value:r,onChange:A=>n(A.target.value)})]}),a.jsxs(n3,{children:[a.jsx(a3,{children:"Hasta"}),a.jsx(i3,{type:"date",value:i,onChange:A=>s(A.target.value)})]}),a.jsx(g0e,{$variant:"primary",onClick:v,disabled:o,children:o?"Cargando...":"Filtrar"})]})}),c&&a.jsx(j0e,{children:c}),o?a.jsx(b0e,{children:"Cargando datos del reporte..."}):h&&a.jsxs(a.Fragment,{children:[a.jsxs(x0e,{children:[a.jsxs(Kg,{$color:d.colors.danger,children:[a.jsx(Xg,{children:h.total}),a.jsx(Yg,{children:"Total Rechazos"})]}),a.jsxs(Kg,{$color:g?Cf[g.motivo]||"#6B7280":d.colors.warning,children:[a.jsx(Xg,{children:(g==null?void 0:g.cantidad)||0}),a.jsxs(Yg,{children:["Motivo: ",(g==null?void 0:g.motivo)||"-"]})]}),a.jsxs(Kg,{$color:d.colors.primary,children:[a.jsx(Xg,{children:((E=h.items)==null?void 0:E.length)||0}),a.jsx(Yg,{children:"Tipos de Motivos"})]}),a.jsxs(Kg,{$color:d.colors.success,children:[a.jsx(Xg,{children:(x==null?void 0:x.cantidad)||0}),a.jsx(Yg,{children:"Ultimo Mes"})]})]}),a.jsxs(v0e,{children:[_&&a.jsxs(wf,{children:[a.jsx(kf,{children:"Distribucion por Motivo"}),a.jsx(kC,{data:_,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]}),b&&a.jsxs(wf,{children:[a.jsx(kf,{children:"Rechazos por Motivo"}),a.jsx(oa,{data:b,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),y&&a.jsxs(wf,{children:[a.jsx(kf,{children:"Tendencia Mensual"}),a.jsx(kd,{data:y,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})]})]}),a.jsxs(wf,{children:[a.jsx(kf,{children:"Ranking de Motivos"}),a.jsxs(s3,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(gc,{children:"#"}),a.jsx(gc,{children:"Motivo"}),a.jsx(gc,{children:"Cantidad"}),a.jsx(gc,{children:"Porcentaje"}),a.jsx(gc,{style:{width:"40%"},children:"Distribucion"})]})}),a.jsx("tbody",{children:h.items.length===0?a.jsx("tr",{children:a.jsx(Xo,{colSpan:5,style:{textAlign:"center"},children:"No hay datos de motivos de rechazo"})}):h.items.map((A,w)=>a.jsxs("tr",{children:[a.jsx(Xo,{style:{fontWeight:600},children:w+1}),a.jsx(Xo,{children:a.jsx(_0e,{$color:Cf[A.motivo]||"#6B7280",children:A.motivo})}),a.jsx(Xo,{style:{fontWeight:600},children:A.cantidad}),a.jsxs(Xo,{children:[A.porcentaje.toFixed(1),"%"]}),a.jsx(Xo,{children:a.jsx(y0e,{$value:A.porcentaje*3,$color:Cf[A.motivo]||"#6B7280"})})]},A.motivo))})]})]}),h.por_mes&&h.por_mes.length>0&&a.jsxs(wf,{style:{marginTop:"1.5rem"},children:[a.jsx(kf,{children:"Rechazos por Mes"}),a.jsxs(s3,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(gc,{children:"Mes"}),a.jsx(gc,{children:"Cantidad"})]})}),a.jsx("tbody",{children:h.por_mes.map(A=>a.jsxs("tr",{children:[a.jsx(Xo,{style:{fontWeight:600},children:A.mes}),a.jsx(Xo,{style:{fontWeight:600,color:d.colors.danger},children:A.cantidad})]},A.mes))})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa);const C0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,S0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,$0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,E0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,T0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,o3=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,l3=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,c3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,A0e=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,F0e=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Qg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Jg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Zg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,D0e=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,o2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,P0e=p(o2)`
  grid-column: 1 / -1;
`,ej=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,M0e=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Sf=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,$f=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,O0e=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$level:e})=>{switch(e){case"excellent":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"good":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"regular":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"poor":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`}}}
`,R0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,N0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,z0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  background: ${d.colors.bgLight};
  border-radius: 8px;
`,I0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=new Date(t,r,0).getDate(),i=`${t}-${String(r).padStart(2,"0")}-${String(n).padStart(2,"0")}`,s=new Date;s.setMonth(s.getMonth()-5);const o=s.getFullYear(),l=s.getMonth()+1;return{firstDay:`${o}-${String(l).padStart(2,"0")}-01`,lastDayStr:i}},L0e=e=>e<=3?"excellent":e<=5?"good":e<=7?"regular":"poor",B0e=e=>{switch(e){case"excellent":return"Excelente";case"good":return"Bueno";case"regular":return"Regular";case"poor":return"Bajo"}};function U0e({onNavigate:e}){const t=I0e(),[r,n]=S.useState(t.firstDay),[i,s]=S.useState(t.lastDayStr),[o,l]=S.useState(!0),[c,u]=S.useState(null),[h,f]=S.useState(null),m=async()=>{l(!0),u(null);try{const y=await na.getTiempoDisenadorExterno({date_desde:r,date_hasta:i});f(y)}catch(y){console.error("Error fetching report:",y),u("Error al cargar los datos del reporte.")}finally{l(!1)}};S.useEffect(()=>{m()},[]);const v=S.useMemo(()=>{if(!h||!h.disenadores.length)return{totalDisenadores:0,totalOTs:0,tiempoPromedio:0};const y=h.disenadores.reduce((k,E)=>k+E.total_ots,0),j=h.disenadores.reduce((k,E)=>k+E.tiempo_promedio,0)/h.disenadores.length;return{totalDisenadores:h.total_disenadores,totalOTs:y,tiempoPromedio:j.toFixed(1)}},[h]),g=S.useMemo(()=>!h||!h.disenadores.length?null:{labels:h.disenadores.map(y=>y.nombre),datasets:[{label:"Tiempo Promedio (dias)",data:h.disenadores.map(y=>y.tiempo_promedio),backgroundColor:h.disenadores.map(y=>y.tiempo_promedio<=5?d.colors.success:d.colors.warning)}]},[h]),x=S.useMemo(()=>{if(!h||!h.disenadores.length)return null;const y=[d.colors.primary,d.colors.success,"#7C3AED",d.colors.warning,"#EC4899","#06B6D4","#F59E0B","#10B981"];return{labels:h.disenadores.map(j=>j.nombre),datasets:[{data:h.disenadores.map(j=>j.total_ots),backgroundColor:h.disenadores.map((j,k)=>y[k%y.length])}]}},[h]),_={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}},b={responsive:!0,plugins:{legend:{position:"right"}}};return a.jsxs(C0e,{children:[a.jsx(S0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx($0e,{children:"Tiempo Disenador Externo"}),a.jsx(E0e,{children:a.jsxs(T0e,{children:[a.jsxs(o3,{children:[a.jsx(l3,{children:"Desde"}),a.jsx(c3,{type:"date",value:r,onChange:y=>n(y.target.value)})]}),a.jsxs(o3,{children:[a.jsx(l3,{children:"Hasta"}),a.jsx(c3,{type:"date",value:i,onChange:y=>s(y.target.value)})]}),a.jsx(A0e,{$variant:"primary",onClick:m,disabled:o,children:o?"Cargando...":"Filtrar"})]})}),c&&a.jsx(N0e,{children:c}),o?a.jsx(R0e,{children:"Cargando datos del reporte..."}):h&&h.disenadores.length>0?a.jsxs(a.Fragment,{children:[a.jsxs(F0e,{children:[a.jsxs(Qg,{$color:d.colors.primary,children:[a.jsx(Jg,{children:v.totalDisenadores}),a.jsx(Zg,{children:"Disenadores Activos"})]}),a.jsxs(Qg,{$color:d.colors.success,children:[a.jsx(Jg,{children:v.totalOTs}),a.jsx(Zg,{children:"OTs Totales"})]}),a.jsxs(Qg,{$color:d.colors.warning,children:[a.jsxs(Jg,{children:[v.tiempoPromedio,"d"]}),a.jsx(Zg,{children:"Tiempo Promedio"})]}),a.jsxs(Qg,{$color:"#7C3AED",children:[a.jsx(Jg,{children:h.disenadores.filter(y=>y.tiempo_promedio<=5).length}),a.jsx(Zg,{children:"Dentro de Meta"})]})]}),a.jsxs(D0e,{children:[g&&a.jsxs(o2,{children:[a.jsx(ej,{children:"Tiempo Promedio por Disenador"}),a.jsx(oa,{data:g,options:_})]}),x&&a.jsxs(o2,{children:[a.jsx(ej,{children:"OTs por Disenador"}),a.jsx(Ep,{data:x,options:b})]})]}),a.jsxs(P0e,{children:[a.jsx(ej,{children:"Detalle por Disenador"}),a.jsxs(M0e,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Sf,{children:"ID"}),a.jsx(Sf,{children:"Disenador"}),a.jsx(Sf,{children:"OTs Totales"}),a.jsx(Sf,{children:"Tiempo Promedio"}),a.jsx(Sf,{children:"Performance"})]})}),a.jsx("tbody",{children:h.disenadores.map(y=>{const j=L0e(y.tiempo_promedio);return a.jsxs("tr",{children:[a.jsx($f,{children:y.id}),a.jsx($f,{style:{fontWeight:600},children:y.nombre}),a.jsx($f,{children:y.total_ots}),a.jsxs($f,{style:{color:y.tiempo_promedio<=5?d.colors.success:d.colors.warning},children:[y.tiempo_promedio.toFixed(1)," dias"]}),a.jsx($f,{children:a.jsx(O0e,{$level:j,children:B0e(j)})})]},y.id)})})]})]})]}):a.jsx(z0e,{children:"No hay datos de disenadores externos para el periodo seleccionado."})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa);const V0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,H0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,W0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,G0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,q0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,tj=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,rj=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,K0e=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,d3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,nj=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,X0e=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Ef=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Tf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Af=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Y0e=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,l2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Q0e=p(l2)`
  grid-column: 1 / -1;
`,aj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,J0e=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,xc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Yo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Z0e=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,epe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,tpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,rpe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,npe={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger},ape=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function ipe({onNavigate:e}){const t=ape(),[r,n]=S.useState(""),[i,s]=S.useState(t.firstDay),[o,l]=S.useState(t.lastDayStr),[c,u]=S.useState(1),[h,f]=S.useState(!0),[m,v]=S.useState(null),[g,x]=S.useState(null),_=async()=>{f(!0),v(null);try{const w=await na.getMuestras({page:c,page_size:20,date_desde:i||void 0,date_hasta:o||void 0,estado:r||void 0});x(w)}catch(w){console.error("Error fetching report:",w),v("Error al cargar los datos del reporte.")}finally{f(!1)}};S.useEffect(()=>{_()},[c]);const b=()=>{u(1),_()},y=S.useMemo(()=>{if(!(g!=null&&g.por_estado))return{pendientes:0,en_proceso:0,completadas:0,rechazadas:0};const w={};return g.por_estado.forEach(P=>{w[P.estado]=P.cantidad}),{pendientes:w.pendiente||0,en_proceso:w.en_proceso||0,completadas:w.completada||0,rechazadas:w.rechazada||0}},[g]),j=S.useMemo(()=>{var w;return(w=g==null?void 0:g.por_estado)!=null&&w.length?{labels:g.por_estado.map(P=>P.estado),datasets:[{data:g.por_estado.map(P=>P.cantidad),backgroundColor:g.por_estado.map(P=>npe[P.estado]||"#6B7280")}]}:null},[g]),k=S.useMemo(()=>{var w;return(w=g==null?void 0:g.por_tipo)!=null&&w.length?{labels:g.por_tipo.map(P=>P.tipo),datasets:[{label:"Muestras",data:g.por_tipo.map(P=>P.cantidad),backgroundColor:d.colors.primary}]}:null},[g]),E={responsive:!0,plugins:{legend:{position:"right"}}},A={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(V0e,{children:[a.jsx(H0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(W0e,{children:"Sala de Muestra"}),a.jsx(G0e,{children:a.jsxs(q0e,{children:[a.jsxs(tj,{children:[a.jsx(rj,{children:"Desde"}),a.jsx(d3,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(tj,{children:[a.jsx(rj,{children:"Hasta"}),a.jsx(d3,{type:"date",value:o,onChange:w=>l(w.target.value)})]}),a.jsxs(tj,{children:[a.jsx(rj,{children:"Estado"}),a.jsxs(K0e,{value:r,onChange:w=>n(w.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(nj,{$variant:"primary",onClick:b,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(tpe,{children:m}),h?a.jsx(epe,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(X0e,{children:[a.jsxs(Ef,{$color:d.colors.warning,children:[a.jsx(Tf,{children:y.pendientes}),a.jsx(Af,{children:"Pendientes"})]}),a.jsxs(Ef,{$color:d.colors.primary,children:[a.jsx(Tf,{children:y.en_proceso}),a.jsx(Af,{children:"En Proceso"})]}),a.jsxs(Ef,{$color:d.colors.success,children:[a.jsx(Tf,{children:y.completadas}),a.jsx(Af,{children:"Completadas"})]}),a.jsxs(Ef,{$color:d.colors.danger,children:[a.jsx(Tf,{children:y.rechazadas}),a.jsx(Af,{children:"Rechazadas"})]}),a.jsxs(Ef,{$color:"#7C3AED",children:[a.jsx(Tf,{children:g.total}),a.jsx(Af,{children:"Total Muestras"})]})]}),a.jsxs(Y0e,{children:[k&&a.jsxs(l2,{children:[a.jsx(aj,{children:"Muestras por Tipo"}),a.jsx(oa,{data:k,options:A})]}),j&&a.jsxs(l2,{children:[a.jsx(aj,{children:"Distribucion por Estado"}),a.jsx(Ep,{data:j,options:E})]})]}),a.jsxs(Q0e,{children:[a.jsxs(aj,{children:["Cola de Muestras (",g.total," registros)"]}),a.jsxs(J0e,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(xc,{children:"ID"}),a.jsx(xc,{children:"OT"}),a.jsx(xc,{children:"Tipo"}),a.jsx(xc,{children:"Fecha Solicitud"}),a.jsx(xc,{children:"Completada"}),a.jsx(xc,{children:"Estado"}),a.jsx(xc,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Yo,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(w=>a.jsxs("tr",{children:[a.jsxs(Yo,{style:{fontWeight:600},children:["#",w.id]}),a.jsxs(Yo,{children:["OT-",w.ot_id]}),a.jsx(Yo,{children:w.tipo}),a.jsx(Yo,{children:w.created_at}),a.jsx(Yo,{children:w.completed_at||"-"}),a.jsx(Yo,{children:a.jsx(Z0e,{$status:w.estado,children:w.estado})}),a.jsx(Yo,{children:w.responsable})]},w.id))})]}),g.total_pages>1&&a.jsxs(rpe,{children:[a.jsx(nj,{onClick:()=>u(w=>Math.max(1,w-1)),disabled:c===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",c," de ",g.total_pages]}),a.jsx(nj,{onClick:()=>u(w=>Math.min(g.total_pages,w+1)),disabled:c===g.total_pages,children:"Siguiente"})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa,dh);const spe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ope=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,lpe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,cpe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,dpe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,upe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,hpe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,fpe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,ppe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,mpe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,ex=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.25rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
  position: relative;
`,tx=p.div`
  font-size: 2rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,rx=p.div`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,gpe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,ij=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,sj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,xpe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Hd=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,vc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,vpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,_pe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`;function ype({onNavigate:e}){const[t,r]=S.useState(new Date().getFullYear()),[n,i]=S.useState(!0),[s,o]=S.useState(null),[l,c]=S.useState(null),u=async()=>{i(!0),o(null);try{const x=await na.getIndicadoresSalaMuestra(t);c(x)}catch(x){console.error("Error fetching report:",x),o("Error al cargar los datos del reporte.")}finally{i(!1)}};S.useEffect(()=>{u()},[t]);const h=S.useMemo(()=>{var y;if(!((y=l==null?void 0:l.por_mes)!=null&&y.length))return{completadas:0,rechazadas:0,tasaAprobacion:0};const x=l.por_mes.reduce((j,k)=>j+k.completadas,0),_=l.por_mes.reduce((j,k)=>j+k.rechazadas,0),b=x+_;return{completadas:x,rechazadas:_,tasaAprobacion:b>0?(x/b*100).toFixed(1):"0"}},[l]),f=S.useMemo(()=>{var x;return(x=l==null?void 0:l.por_mes)!=null&&x.length?{labels:l.por_mes.map(_=>_.mes),datasets:[{label:"Tiempo Promedio (dias)",data:l.por_mes.map(_=>_.tiempo_promedio),borderColor:d.colors.primary,yAxisID:"y",tension:.3},{label:"Total Muestras",data:l.por_mes.map(_=>_.total_muestras),borderColor:d.colors.success,yAxisID:"y1",tension:.3}]}:null},[l]),m=S.useMemo(()=>{var x;return(x=l==null?void 0:l.por_mes)!=null&&x.length?{labels:l.por_mes.map(_=>_.mes),datasets:[{label:"Completadas",data:l.por_mes.map(_=>_.completadas),backgroundColor:d.colors.success},{label:"Rechazadas",data:l.por_mes.map(_=>_.rechazadas),backgroundColor:d.colors.danger}]}:null},[l]),v={responsive:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Dias"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Cantidad"},grid:{drawOnChartArea:!1}}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}};return a.jsxs(spe,{children:[a.jsx(ope,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(lpe,{children:"Indicadores Sala de Muestra"}),a.jsx(cpe,{children:a.jsxs(dpe,{children:[a.jsxs(upe,{children:[a.jsx(hpe,{children:"Ano"}),a.jsx(fpe,{value:t,onChange:x=>r(Number(x.target.value)),children:Array.from({length:6},(x,_)=>new Date().getFullYear()-_).map(x=>a.jsx("option",{value:x,children:x},x))})]}),a.jsx(ppe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(_pe,{children:s}),n?a.jsx(vpe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(mpe,{children:[a.jsxs(ex,{$color:d.colors.primary,children:[a.jsx(tx,{children:l.total_muestras}),a.jsx(rx,{children:"Total Muestras (Ano)"})]}),a.jsxs(ex,{$color:d.colors.warning,children:[a.jsxs(tx,{children:[l.tiempo_promedio.toFixed(1),"d"]}),a.jsx(rx,{children:"Tiempo Promedio"})]}),a.jsxs(ex,{$color:d.colors.success,children:[a.jsx(tx,{children:h.completadas}),a.jsx(rx,{children:"Completadas"})]}),a.jsxs(ex,{$color:d.colors.danger,children:[a.jsx(tx,{children:h.rechazadas}),a.jsx(rx,{children:"Rechazadas"})]})]}),a.jsxs(gpe,{children:[f&&a.jsxs(ij,{children:[a.jsx(sj,{children:"Tendencia de KPIs"}),a.jsx(kd,{data:f,options:v})]}),m&&a.jsxs(ij,{children:[a.jsx(sj,{children:"Completadas vs Rechazadas"}),a.jsx(oa,{data:m,options:g})]})]}),a.jsxs(ij,{children:[a.jsx(sj,{children:"Detalle por Mes"}),a.jsxs(xpe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Hd,{children:"Mes"}),a.jsx(Hd,{children:"Total Muestras"}),a.jsx(Hd,{children:"Completadas"}),a.jsx(Hd,{children:"Rechazadas"}),a.jsx(Hd,{children:"Tiempo Prom."}),a.jsx(Hd,{children:"Tasa Aprobacion"})]})}),a.jsx("tbody",{children:l.por_mes.length===0?a.jsx("tr",{children:a.jsx(vc,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.por_mes.map(x=>{const _=x.completadas+x.rechazadas,b=_>0?(x.completadas/_*100).toFixed(1):"0";return a.jsxs("tr",{children:[a.jsx(vc,{style:{fontWeight:600},children:x.mes}),a.jsx(vc,{children:x.total_muestras}),a.jsx(vc,{style:{color:d.colors.success,fontWeight:600},children:x.completadas}),a.jsx(vc,{style:{color:d.colors.danger,fontWeight:600},children:x.rechazadas}),a.jsxs(vc,{children:[x.tiempo_promedio.toFixed(1),"d"]}),a.jsxs(vc,{style:{color:Number(b)>=90?d.colors.success:d.colors.warning},children:[b,"%"]})]},x.mes)})})]})]})]})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa);const bpe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,jpe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,wpe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,kpe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Cpe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Spe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,$pe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Epe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Tpe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Ape=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,nx=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,ax=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,ix=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Fpe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,c2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Dpe=p(c2)`
  grid-column: 1 / -1;
`,oj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Ppe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ff=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Df=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Mpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Ope=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Rpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  background: ${d.colors.bgLight};
  border-radius: 8px;
`;function Npe({onNavigate:e}){const t=new Date().getFullYear(),[r,n]=S.useState(t),[i,s]=S.useState(!0),[o,l]=S.useState(null),[c,u]=S.useState(null),h=async()=>{s(!0),l(null);try{const _=await na.getDisenoEstructuralSala(r);u(_)}catch(_){console.error("Error fetching report:",_),l("Error al cargar los datos del reporte.")}finally{s(!1)}};S.useEffect(()=>{h()},[r]);const f=S.useMemo(()=>{if(!c||!c.por_mes.length)return{totalOTs:0,tiempoPromDiseno:0,tiempoPromMuestra:0,tiempoTotal:0};const _=c.por_mes.reduce((j,k)=>j+k.total_ots,0),b=c.por_mes.reduce((j,k)=>j+k.tiempo_diseno,0)/c.por_mes.length,y=c.por_mes.reduce((j,k)=>j+k.tiempo_muestra,0)/c.por_mes.length;return{totalOTs:_,tiempoPromDiseno:b.toFixed(1),tiempoPromMuestra:y.toFixed(1),tiempoTotal:(b+y).toFixed(1)}},[c]),m=S.useMemo(()=>!c||!c.por_mes.length?null:{labels:c.por_mes.map(_=>_.mes),datasets:[{label:"OTs Totales",data:c.por_mes.map(_=>_.total_ots),backgroundColor:d.colors.primary}]},[c]),v=S.useMemo(()=>!c||!c.por_mes.length?null:{labels:c.por_mes.map(_=>_.mes),datasets:[{label:"Tiempo Diseno (dias)",data:c.por_mes.map(_=>_.tiempo_diseno),borderColor:d.colors.primary,backgroundColor:d.colors.primary+"20",fill:!0,tension:.3},{label:"Tiempo Muestra (dias)",data:c.por_mes.map(_=>_.tiempo_muestra),borderColor:d.colors.warning,backgroundColor:d.colors.warning+"20",fill:!0,tension:.3}]},[c]),g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},x={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}};return a.jsxs(bpe,{children:[a.jsx(jpe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(wpe,{children:"Diseno Estructural y Sala de Muestra"}),a.jsx(kpe,{children:a.jsxs(Cpe,{children:[a.jsxs(Spe,{children:[a.jsx($pe,{children:"Ano"}),a.jsx(Epe,{value:r,onChange:_=>n(Number(_.target.value)),children:Array.from({length:6},(_,b)=>t-b).map(_=>a.jsx("option",{value:_,children:_},_))})]}),a.jsx(Tpe,{$variant:"primary",onClick:h,disabled:i,children:i?"Cargando...":"Actualizar"})]})}),o&&a.jsx(Ope,{children:o}),i?a.jsx(Mpe,{children:"Cargando datos del reporte..."}):c&&c.por_mes.length>0?a.jsxs(a.Fragment,{children:[a.jsxs(Ape,{children:[a.jsxs(nx,{$color:d.colors.primary,children:[a.jsx(ax,{children:f.totalOTs}),a.jsx(ix,{children:"OTs Totales (Ano)"})]}),a.jsxs(nx,{$color:d.colors.success,children:[a.jsxs(ax,{children:[f.tiempoPromDiseno,"d"]}),a.jsx(ix,{children:"Tiempo Prom. Diseno"})]}),a.jsxs(nx,{$color:d.colors.warning,children:[a.jsxs(ax,{children:[f.tiempoPromMuestra,"d"]}),a.jsx(ix,{children:"Tiempo Prom. Muestra"})]}),a.jsxs(nx,{$color:"#7C3AED",children:[a.jsxs(ax,{children:[f.tiempoTotal,"d"]}),a.jsx(ix,{children:"Tiempo Total Prom."})]})]}),a.jsxs(Fpe,{children:[m&&a.jsxs(c2,{children:[a.jsx(oj,{children:"OTs por Mes"}),a.jsx(oa,{data:m,options:g})]}),v&&a.jsxs(c2,{children:[a.jsx(oj,{children:"Tiempos Diseno vs Muestra"}),a.jsx(kd,{data:v,options:x})]})]}),a.jsxs(Dpe,{children:[a.jsxs(oj,{children:["Detalle Mensual - ",r]}),a.jsxs(Ppe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ff,{children:"Mes"}),a.jsx(Ff,{children:"OTs Totales"}),a.jsx(Ff,{children:"Tiempo Diseno (dias)"}),a.jsx(Ff,{children:"Tiempo Muestra (dias)"}),a.jsx(Ff,{children:"Tiempo Total (dias)"})]})}),a.jsx("tbody",{children:c.por_mes.map((_,b)=>a.jsxs("tr",{children:[a.jsx(Df,{style:{fontWeight:600},children:_.mes}),a.jsx(Df,{children:_.total_ots}),a.jsx(Df,{style:{color:_.tiempo_diseno<=5?d.colors.success:d.colors.warning},children:_.tiempo_diseno.toFixed(1)}),a.jsx(Df,{style:{color:_.tiempo_muestra<=3?d.colors.success:d.colors.warning},children:_.tiempo_muestra.toFixed(1)}),a.jsx(Df,{children:(_.tiempo_diseno+_.tiempo_muestra).toFixed(1)})]},b))})]})]})]}):a.jsx(Rpe,{children:"No hay datos de diseno y muestra para el ano seleccionado."})]})}nn.register(mn,gn,ea,Ur,rn,_a,ia,sa,aa);const zpe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Ipe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Lpe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Bpe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Upe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,lj=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,cj=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Vpe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,u3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,dj=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Hpe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Pf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Mf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Of=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Wpe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,d2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Gpe=p(d2)`
  grid-column: 1 / -1;
`,uj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,qpe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,_c=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Qo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Kpe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,Xpe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$tipo:e})=>{switch(e==null?void 0:e.toLowerCase()){case"fisica":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"digital":return"background: #7C3AED20; color: #7C3AED;";case"prototipo":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,Ype=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,Qpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Jpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Zpe={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger},eme={fisica:d.colors.primary,digital:"#7C3AED",prototipo:d.colors.warning},tme=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function rme({onNavigate:e}){const t=tme(),[r,n]=S.useState(""),[i,s]=S.useState(t.firstDay),[o,l]=S.useState(t.lastDayStr),[c,u]=S.useState(1),[h,f]=S.useState(!0),[m,v]=S.useState(null),[g,x]=S.useState(null),_=async()=>{f(!0),v(null);try{const w=await na.getMuestras({page:c,page_size:20,date_desde:i||void 0,date_hasta:o||void 0,estado:r||void 0});x(w)}catch(w){console.error("Error fetching report:",w),v("Error al cargar los datos del reporte.")}finally{f(!1)}};S.useEffect(()=>{_()},[c]);const b=()=>{u(1),_()},y=S.useMemo(()=>{if(!(g!=null&&g.por_estado))return{};const w={};return g.por_estado.forEach(P=>{w[P.estado]=P.cantidad}),w},[g]),j=S.useMemo(()=>{var w;return(w=g==null?void 0:g.por_tipo)!=null&&w.length?{labels:g.por_tipo.map(P=>P.tipo),datasets:[{data:g.por_tipo.map(P=>P.cantidad),backgroundColor:g.por_tipo.map(P=>eme[P.tipo.toLowerCase()]||"#6B7280")}]}:null},[g]),k=S.useMemo(()=>{var w;return(w=g==null?void 0:g.por_estado)!=null&&w.length?{labels:g.por_estado.map(P=>P.estado),datasets:[{label:"Cantidad",data:g.por_estado.map(P=>P.cantidad),backgroundColor:g.por_estado.map(P=>Zpe[P.estado]||"#6B7280")}]}:null},[g]),E={responsive:!0,plugins:{legend:{position:"right"}}},A={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(zpe,{children:[a.jsx(Ipe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Lpe,{children:"Muestras"}),a.jsx(Bpe,{children:a.jsxs(Upe,{children:[a.jsxs(lj,{children:[a.jsx(cj,{children:"Desde"}),a.jsx(u3,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(lj,{children:[a.jsx(cj,{children:"Hasta"}),a.jsx(u3,{type:"date",value:o,onChange:w=>l(w.target.value)})]}),a.jsxs(lj,{children:[a.jsx(cj,{children:"Estado"}),a.jsxs(Vpe,{value:r,onChange:w=>n(w.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(dj,{$variant:"primary",onClick:b,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(Jpe,{children:m}),h?a.jsx(Qpe,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(Hpe,{children:[a.jsxs(Pf,{$color:d.colors.primary,children:[a.jsx(Mf,{children:g.total}),a.jsx(Of,{children:"Total Muestras"})]}),a.jsxs(Pf,{$color:d.colors.warning,children:[a.jsx(Mf,{children:y.pendiente||0}),a.jsx(Of,{children:"Pendientes"})]}),a.jsxs(Pf,{$color:d.colors.primary,children:[a.jsx(Mf,{children:y.en_proceso||0}),a.jsx(Of,{children:"En Proceso"})]}),a.jsxs(Pf,{$color:d.colors.success,children:[a.jsx(Mf,{children:y.completada||0}),a.jsx(Of,{children:"Completadas"})]}),a.jsxs(Pf,{$color:d.colors.danger,children:[a.jsx(Mf,{children:y.rechazada||0}),a.jsx(Of,{children:"Rechazadas"})]})]}),a.jsxs(Wpe,{children:[j&&a.jsxs(d2,{children:[a.jsx(uj,{children:"Por Tipo de Muestra"}),a.jsx(kC,{data:j,options:E})]}),k&&a.jsxs(d2,{children:[a.jsx(uj,{children:"Por Estado"}),a.jsx(oa,{data:k,options:A})]})]}),a.jsxs(Gpe,{children:[a.jsxs(uj,{children:["Listado de Muestras (",g.total," registros)"]}),a.jsxs(qpe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(_c,{children:"ID"}),a.jsx(_c,{children:"OT"}),a.jsx(_c,{children:"Tipo"}),a.jsx(_c,{children:"Fecha Solicitud"}),a.jsx(_c,{children:"Completada"}),a.jsx(_c,{children:"Estado"}),a.jsx(_c,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Qo,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(w=>a.jsxs("tr",{children:[a.jsxs(Qo,{style:{fontWeight:600},children:["#",w.id]}),a.jsxs(Qo,{children:["OT-",w.ot_id]}),a.jsx(Qo,{children:a.jsx(Xpe,{$tipo:w.tipo,children:w.tipo})}),a.jsx(Qo,{children:w.created_at}),a.jsx(Qo,{children:w.completed_at||"-"}),a.jsx(Qo,{children:a.jsx(Kpe,{$status:w.estado,children:w.estado})}),a.jsx(Qo,{children:w.responsable})]},w.id))})]}),g.total_pages>1&&a.jsxs(Ype,{children:[a.jsx(dj,{onClick:()=>u(w=>Math.max(1,w-1)),disabled:c===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",c," de ",g.total_pages]}),a.jsx(dj,{onClick:()=>u(w=>Math.min(g.total_pages,w+1)),disabled:c===g.total_pages,children:"Siguiente"})]})]})]})]})}const Pe={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,SuperAdministrador:18,VendedorExterno:19},Ut={isAdmin:e=>e===Pe.Admin,isSuperAdministrador:e=>e===Pe.SuperAdministrador,isVendedor:e=>e===Pe.Vendedor,isVendedorExterno:e=>e===Pe.VendedorExterno,isJefeVenta:e=>e===Pe.JefeVenta,isJefeDesarrollo:e=>e===Pe.JefeDesarrollo,isGerenteGeneral:e=>e===Pe.Gerente,isGerenteComercial:e=>e===Pe.GerenteComercial,isJefeCatalogador:e=>e===Pe.JefeCatalogador,isCatalogador:e=>e===Pe.Catalogador,isIngeniero:e=>e===Pe.Ingeniero,isJefeDiseo:e=>e===Pe.JefeDiseo,isDiseador:e=>e===Pe.Diseador,isJefePrecatalogador:e=>e===Pe.JefePrecatalogador,isPrecatalogador:e=>e===Pe.Precatalogador,isJefeMuestras:e=>e===Pe.JefeMuestras,isTecnicoMuestras:e=>e===Pe.TecnicoMuestras,hasArea:e=>[Pe.JefeVenta,Pe.Vendedor,Pe.JefeDesarrollo,Pe.Ingeniero,Pe.JefeDiseo,Pe.Diseador,Pe.JefeCatalogador,Pe.Catalogador,Pe.JefePrecatalogador,Pe.Precatalogador,Pe.JefeMuestras,Pe.TecnicoMuestras,Pe.SuperAdministrador].includes(e),canApprove:e=>[Pe.Admin,Pe.SuperAdministrador,Pe.JefeVenta,Pe.JefeDesarrollo].includes(e),canViewReports:e=>[Pe.Admin,Pe.SuperAdministrador,Pe.JefeCatalogador,Pe.Gerente,Pe.GerenteComercial,Pe.JefeDesarrollo,Pe.JefeDiseo].includes(e),hasFullMantenedores:e=>[Pe.Admin,Pe.SuperAdministrador].includes(e),canUseCotizador:e=>[Pe.Admin,Pe.SuperAdministrador,Pe.Vendedor,Pe.Gerente,Pe.GerenteComercial,Pe.JefeVenta].includes(e),canApproveCotizaciones:e=>[Pe.Gerente,Pe.GerenteComercial,Pe.JefeVenta].includes(e),canAccessMantenedores:e=>[Pe.Admin,Pe.SuperAdministrador,Pe.Vendedor,Pe.JefeVenta,Pe.JefeCatalogador,Pe.Catalogador,Pe.Ingeniero,Pe.JefeDesarrollo,Pe.JefeDiseo,Pe.Diseador,Pe.JefePrecatalogador,Pe.Precatalogador].includes(e),canViewMuestras:e=>[Pe.Ingeniero,Pe.JefeVenta,Pe.Vendedor,Pe.TecnicoMuestras,Pe.JefeMuestras,Pe.JefeDesarrollo,Pe.SuperAdministrador,Pe.Admin].includes(e),canCreateMuestra:(e,t)=>e===Pe.Ingeniero||e===Pe.JefeDesarrollo||(e===Pe.Vendedor||e===Pe.JefeVenta)&&t===1},nme=new qN({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),ame=p.div`
  min-height: 100vh;
  background-color: ${d.colors.bgLight};
`,ime=p.header`
  background-color: white;
  border-bottom: 1px solid ${d.colors.border};
  padding: ${d.spacing.sm} ${d.spacing.xl};
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
`,sme=p.div`
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: ${d.spacing.md};
`,ome=p.div`
  display: flex;
  align-items: center;
  flex-shrink: 0;
`,lme=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,cme=p.nav`
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  flex-wrap: wrap;
  justify-content: center;
  flex: 1;
`,dme=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  flex-shrink: 0;
`,ume=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  white-space: nowrap;
`,hme=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,fme=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.danger}15;
    border-color: ${d.colors.danger};
    color: ${d.colors.danger};
  }
`,pme=p.main`
  max-width: 1400px;
  margin: 0 auto;
  padding: ${d.spacing.lg} ${d.spacing.xl};
`,Wd=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,hj=p.div`
  position: relative;
  display: inline-block;
`,fj=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,pj=p.span`
  display: inline-block;
  transition: transform 0.2s;
  transform: ${({$open:e})=>e?"rotate(180deg)":"rotate(0deg)"};
`,mj=p.div`
  position: absolute;
  top: 100%;
  left: 0;
  min-width: 220px;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  display: ${({$open:e})=>e?"block":"none"};
  max-height: 400px;
  overflow-y: auto;
`,ln=p.div`
  padding: ${d.spacing.xs} 0;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }
`,Wn=p.div`
  padding: ${d.spacing.xs} ${d.spacing.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Ie=p.button`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  border: none;
  text-align: left;
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  transition: all 0.15s;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;function mme({user:e,onLogout:t}){const[r,n]=S.useState("dashboard"),[i,s]=S.useState(null),[o,l]=S.useState(null),[c,u]=S.useState(null),[h,f]=S.useState(null),[m,v]=S.useState(null),[g,x]=S.useState(null),[_,b]=S.useState(!1),[y,j]=S.useState(!1),k=S.useRef(null),E=S.useRef(null),w=["clientes","usuarios","jerarquias-1","jerarquias-2","jerarquias-3","tipo-productos","estilos","colores","canales","tipos-cintas","almacenes","tipo-palet","organizaciones-ventas","grupo-imputacion-material","matrices","sectores","cartones","secuencias-operacionales","rechazo-conjunto","tiempo-tratamiento","grupo-materiales-1","grupo-materiales-2","materiales","grupo-plantas","adhesivos","cebes","clasificaciones-clientes","armados","procesos","pegados","envases","rayados","papeles","cardboards","carton-esquineros","plantas","tipo-ondas","factores-ondas","factores-desarrollos","factores-seguridads","areahcs","consumo-adhesivos","consumo-energias","consumo-adhesivo-pegados","merma-corrugadoras","merma-convertidoras","mercados","rubros","ciudades-fletes","fletes","maquila-servicios","tarifario","tarifario-margens","variables-cotizador","insumos-palletizados","detalle-precio-palletizados","paises","fsc","reference-types","recubrimiento-types"].includes(r);S.useEffect(()=>{const G=Y=>{k.current&&!k.current.contains(Y.target)&&b(!1),E.current&&!E.current.contains(Y.target)&&j(!1)};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[]);const[P,M]=S.useState({productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null}),F=G=>{M(G),console.log("Form data changed:",G)},D=S.useCallback((G,Y,ae)=>{n(G),b(!1),j(!1),G==="editar-ot"&&Y?(s(Y),l(null),u(null),f(null),v(null)):G==="gestionar-ot"&&Y?(l(Y),s(null),u(null),f(null),v(null)):G==="editar-ot-especial"&&Y?(s(Y),l(null),u(null),f(null),v(null)):G==="detalle-log-ot"&&Y?(u(Y),s(null),l(null),f(null),v(null)):(G==="cotizacion-editar"||G==="cotizacion-externa-editar")&&Y?(f(Y),s(null),l(null),u(null),v(null)):G==="crear-ot-desde-cotizacion"&&ae?(v(ae),s(null),l(null),u(null),f(null),x(null)):(G==="muestras-list"||G==="muestra-nueva")&&Y?(x(Y),s(null),l(null),u(null),f(null),v(null)):(s(null),l(null),u(null),f(null),v(null),x(null))},[]),W=`${e.nombre} ${e.apellido}`,B=()=>{switch(r){case"dashboard":return a.jsx(ca,{onNavigate:D});case"crear-ot":return a.jsx(N$,{onNavigate:D});case"crear-ot-especial":return a.jsx(gU,{onNavigate:D});case"editar-ot-especial":return i?a.jsx(EU,{otId:i,onNavigate:D}):null;case"editar-ot":return i?a.jsx(fB,{otId:i,onNavigate:D}):null;case"cascade-form":return a.jsx(bk,{values:P,onChange:F});case"gestionar-ot":return o?a.jsx(h9,{otId:o,onNavigate:D}):null;case"notificaciones":return a.jsx(C9,{onNavigate:D});case"aprobacion-ots":return a.jsx(A9,{onNavigate:D});case"asignaciones":return a.jsx(H9,{onNavigate:D});case"cotizar-multiples-ot":return Ut.canUseCotizador(e.role_id)?a.jsx(aU,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"reportes":return a.jsx(Zse,{onNavigate:D});case"detalle-log-ot":return c?a.jsx(VU,{otId:c,onNavigate:D}):null;case"reporte-ots-activas":return a.jsx(que,{onNavigate:D});case"reporte-ots-completadas":return a.jsx(she,{onNavigate:D});case"reporte-tiempo-area":return a.jsx(Che,{onNavigate:D});case"reporte-rechazos":return a.jsx(Ghe,{onNavigate:D});case"reporte-carga-mensual":return a.jsx(cfe,{onNavigate:D});case"reporte-anulaciones":return a.jsx(wfe,{onNavigate:D});case"reporte-ots-completadas-fechas":return a.jsx(Rfe,{onNavigate:D});case"reporte-gestion-ots-activas":return a.jsx(Yfe,{onNavigate:D});case"reporte-tiempo-primera-muestra":return a.jsx(d0e,{onNavigate:D});case"reporte-motivos-rechazo":return a.jsx(k0e,{onNavigate:D});case"reporte-tiempo-disenador-externo":return a.jsx(U0e,{onNavigate:D});case"reporte-sala-muestra":return a.jsx(ipe,{onNavigate:D});case"reporte-indicador-sala-muestra":return a.jsx(ype,{onNavigate:D});case"reporte-diseno-estructural-sala":return a.jsx(Npe,{onNavigate:D});case"reporte-muestras":return a.jsx(rme,{onNavigate:D});case"cotizaciones":return Ut.canUseCotizador(e.role_id)?a.jsx(Hne,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"cotizacion-nueva":return Ut.canUseCotizador(e.role_id)?a.jsx(Zm,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"cotizacion-editar":return Ut.canUseCotizador(e.role_id)?h?a.jsx(Zm,{cotizacionId:h,onNavigate:D}):null:a.jsx(ca,{onNavigate:D});case"aprobaciones":return Ut.canUseCotizador(e.role_id)?a.jsx(oie,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"ayuda-cotizador":return Ut.canUseCotizador(e.role_id)?a.jsx(wse,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"cotizador-externo":return Ut.canUseCotizador(e.role_id)?a.jsx(dse,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"cotizacion-externa-nueva":return Ut.canUseCotizador(e.role_id)?a.jsx(Zm,{onNavigate:D,isExterno:!0}):a.jsx(ca,{onNavigate:D});case"cotizacion-externa-editar":return Ut.canUseCotizador(e.role_id)?h?a.jsx(Zm,{cotizacionId:h,onNavigate:D,isExterno:!0}):null:a.jsx(ca,{onNavigate:D});case"aprobacion-externa-cotizaciones":return Ut.canUseCotizador(e.role_id)?a.jsx(wie,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"detalle-a-ot":return Ut.canUseCotizador(e.role_id)?a.jsx(Xie,{onNavigate:D}):a.jsx(ca,{onNavigate:D});case"crear-ot-desde-cotizacion":return Ut.canUseCotizador(e.role_id)?m?a.jsx(N$,{onNavigate:D,initialData:m}):null:a.jsx(ca,{onNavigate:D});case"muestras-list":return g?a.jsx(Pse,{otId:g,onNavigate:D,onCreateMuestra:()=>D("muestra-nueva",g)}):null;case"muestra-nueva":return g?a.jsx(Lse,{otId:g,onNavigate:D,onSuccess:()=>D("muestras-list",g)}):null;case"clientes":return a.jsx(AV,{onNavigate:D});case"usuarios":return a.jsx(QV,{onNavigate:D});case"jerarquias-1":return a.jsx(uy,{nivel:1,onNavigate:D});case"jerarquias-2":return a.jsx(uy,{nivel:2,onNavigate:D});case"jerarquias-3":return a.jsx(uy,{nivel:3,onNavigate:D});case"tipo-productos":return a.jsx(Ge,{tablaKey:"tipo_productos",onNavigate:D});case"estilos":return a.jsx(Ge,{tablaKey:"estilos",onNavigate:D});case"colores":return a.jsx(Ge,{tablaKey:"colores",onNavigate:D});case"canales":return a.jsx(Ge,{tablaKey:"canales",onNavigate:D});case"tipos-cintas":return a.jsx(Ge,{tablaKey:"tipos_cintas",onNavigate:D});case"almacenes":return a.jsx(Ge,{tablaKey:"almacenes",onNavigate:D});case"tipo-palet":return a.jsx(Ge,{tablaKey:"tipo_palet",onNavigate:D});case"organizaciones-ventas":return a.jsx(Ge,{tablaKey:"organizaciones_ventas",onNavigate:D});case"grupo-imputacion-material":return a.jsx(Ge,{tablaKey:"grupo_imputacion_material",onNavigate:D});case"matrices":return a.jsx(Ge,{tablaKey:"matrices",onNavigate:D});case"sectores":return a.jsx(Ge,{tablaKey:"sectores",onNavigate:D});case"cartones":return a.jsx(Ge,{tablaKey:"cartones",onNavigate:D});case"secuencias-operacionales":return a.jsx(Ge,{tablaKey:"secuencias_operacionales",onNavigate:D});case"rechazo-conjunto":return a.jsx(Ge,{tablaKey:"rechazo_conjunto",onNavigate:D});case"tiempo-tratamiento":return a.jsx(Ge,{tablaKey:"tiempo_tratamiento",onNavigate:D});case"grupo-materiales-1":return a.jsx(Ge,{tablaKey:"grupo_materiales_1",onNavigate:D});case"grupo-materiales-2":return a.jsx(Ge,{tablaKey:"grupo_materiales_2",onNavigate:D});case"materiales":return a.jsx(Ge,{tablaKey:"materiales",onNavigate:D});case"grupo-plantas":return a.jsx(Ge,{tablaKey:"grupo_plantas",onNavigate:D});case"adhesivos":return a.jsx(Ge,{tablaKey:"adhesivos",onNavigate:D});case"cebes":return a.jsx(Ge,{tablaKey:"cebes",onNavigate:D});case"clasificaciones-clientes":return a.jsx(Ge,{tablaKey:"clasificaciones_clientes",onNavigate:D});case"armados":return a.jsx(Ge,{tablaKey:"armados",onNavigate:D});case"procesos":return a.jsx(Ge,{tablaKey:"procesos",onNavigate:D});case"pegados":return a.jsx(Ge,{tablaKey:"pegados",onNavigate:D});case"envases":return a.jsx(Ge,{tablaKey:"envases",onNavigate:D});case"rayados":return a.jsx(Ge,{tablaKey:"rayados",onNavigate:D});case"papeles":return a.jsx(Ge,{tablaKey:"papeles",onNavigate:D});case"cardboards":return a.jsx(Ge,{tablaKey:"cardboards",onNavigate:D});case"carton-esquineros":return a.jsx(Ge,{tablaKey:"carton_esquineros",onNavigate:D});case"plantas":return a.jsx(Ge,{tablaKey:"plantas",onNavigate:D});case"tipo-ondas":return a.jsx(Ge,{tablaKey:"tipo_ondas",onNavigate:D});case"factores-ondas":return a.jsx(Ge,{tablaKey:"factores_ondas",onNavigate:D});case"factores-desarrollos":return a.jsx(Ge,{tablaKey:"factores_desarrollos",onNavigate:D});case"factores-seguridads":return a.jsx(Ge,{tablaKey:"factores_seguridads",onNavigate:D});case"areahcs":return a.jsx(Ge,{tablaKey:"areahcs",onNavigate:D});case"consumo-adhesivos":return a.jsx(Ge,{tablaKey:"consumo_adhesivos",onNavigate:D});case"consumo-energias":return a.jsx(Ge,{tablaKey:"consumo_energias",onNavigate:D});case"consumo-adhesivo-pegados":return a.jsx(Ge,{tablaKey:"consumo_adhesivo_pegados",onNavigate:D});case"merma-corrugadoras":return a.jsx(Ge,{tablaKey:"merma_corrugadoras",onNavigate:D});case"merma-convertidoras":return a.jsx(Ge,{tablaKey:"merma_convertidoras",onNavigate:D});case"mercados":return a.jsx(Ge,{tablaKey:"mercados",onNavigate:D});case"rubros":return a.jsx(Ge,{tablaKey:"rubros",onNavigate:D});case"ciudades-fletes":return a.jsx(Ge,{tablaKey:"ciudades_fletes",onNavigate:D});case"fletes":return a.jsx(Ge,{tablaKey:"fletes",onNavigate:D});case"maquila-servicios":return a.jsx(Ge,{tablaKey:"maquila_servicios",onNavigate:D});case"tarifario":return a.jsx(Ge,{tablaKey:"tarifario",onNavigate:D});case"tarifario-margens":return a.jsx(Ge,{tablaKey:"tarifario_margens",onNavigate:D});case"variables-cotizador":return a.jsx(Ge,{tablaKey:"variables_cotizador",onNavigate:D});case"insumos-palletizados":return a.jsx(Ge,{tablaKey:"insumos_palletizados",onNavigate:D});case"detalle-precio-palletizados":return a.jsx(Ge,{tablaKey:"detalle_precio_palletizados",onNavigate:D});case"paises":return a.jsx(Ge,{tablaKey:"paises",onNavigate:D});case"fsc":return a.jsx(Ge,{tablaKey:"fsc",onNavigate:D});case"reference-types":return a.jsx(Ge,{tablaKey:"reference_types",onNavigate:D});case"recubrimiento-types":return a.jsx(Ge,{tablaKey:"recubrimiento_types",onNavigate:D});case"carga-masiva":return a.jsx(Zre,{onNavigate:D});case"cambiar-contrasena":return a.jsx(cne,{onNavigate:D});default:return a.jsx(ca,{onNavigate:D})}};return a.jsxs(ame,{children:[a.jsx(ime,{children:a.jsxs(sme,{children:[a.jsx(ome,{children:a.jsx(lme,{children:"INVEB"})}),a.jsxs(cme,{children:[!Ut.isVendedorExterno(e.role_id)&&!Ut.isAdmin(e.role_id)&&a.jsx(Wd,{$active:r==="dashboard",onClick:()=>D("dashboard"),children:"Ordenes de Trabajo"}),Ut.isVendedorExterno(e.role_id)?a.jsxs(a.Fragment,{children:[a.jsx(Wd,{$active:r==="dashboard",onClick:()=>D("dashboard"),children:"Ordenes de Trabajo"}),a.jsxs(hj,{ref:k,children:[a.jsxs(fj,{$active:r==="cotizador-externo",onClick:()=>b(!_),children:["Cotizador",a.jsx(pj,{$open:_,children:""})]}),a.jsx(mj,{$open:_,children:a.jsx(ln,{children:a.jsx(Ie,{$active:r==="cotizador-externo",onClick:()=>D("cotizador-externo"),children:"Cotizaciones"})})})]})]}):a.jsxs(a.Fragment,{children:[Ut.hasArea(e.role_id)&&a.jsx(Wd,{$active:r==="notificaciones",onClick:()=>D("notificaciones"),children:"Notificaciones"}),Ut.hasArea(e.role_id)&&!Ut.isAdmin(e.role_id)&&!Ut.isVendedor(e.role_id)&&a.jsx(Wd,{$active:r==="asignaciones",onClick:()=>D("asignaciones"),children:"Asignaciones"}),Ut.canApprove(e.role_id)&&a.jsx(Wd,{$active:r==="aprobacion-ots",onClick:()=>D("aprobacion-ots"),children:"Aprobaciones"}),Ut.canViewReports(e.role_id)&&a.jsx(Wd,{$active:r==="reportes",onClick:()=>D("reportes"),children:"Reporteria"}),Ut.canAccessMantenedores(e.role_id)&&a.jsxs(hj,{ref:k,children:[a.jsxs(fj,{$active:w,onClick:()=>b(!_),children:["Mantenedores",a.jsx(pj,{$open:_,children:""})]}),a.jsxs(mj,{$open:_,children:[a.jsxs(ln,{children:[a.jsx(Wn,{children:"Principales"}),a.jsx(Ie,{$active:r==="clientes",onClick:()=>D("clientes"),children:"Clientes"}),Ut.hasFullMantenedores(e.role_id)&&a.jsx(Ie,{$active:r==="usuarios",onClick:()=>D("usuarios"),children:"Usuarios"})]}),Ut.hasFullMantenedores(e.role_id)&&a.jsxs(a.Fragment,{children:[a.jsxs(ln,{children:[a.jsx(Wn,{children:"Jerarquias"}),a.jsx(Ie,{$active:r==="jerarquias-1",onClick:()=>D("jerarquias-1"),children:"Jerarquias Nivel 1"}),a.jsx(Ie,{$active:r==="jerarquias-2",onClick:()=>D("jerarquias-2"),children:"Jerarquias Nivel 2"}),a.jsx(Ie,{$active:r==="jerarquias-3",onClick:()=>D("jerarquias-3"),children:"Jerarquias Nivel 3"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Productos"}),a.jsx(Ie,{$active:r==="tipo-productos",onClick:()=>D("tipo-productos"),children:"Tipo de Productos"}),a.jsx(Ie,{$active:r==="estilos",onClick:()=>D("estilos"),children:"Estilos"}),a.jsx(Ie,{$active:r==="colores",onClick:()=>D("colores"),children:"Colores"}),a.jsx(Ie,{$active:r==="canales",onClick:()=>D("canales"),children:"Canales"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Logistica"}),a.jsx(Ie,{$active:r==="tipos-cintas",onClick:()=>D("tipos-cintas"),children:"Tipos de Cintas"}),a.jsx(Ie,{$active:r==="almacenes",onClick:()=>D("almacenes"),children:"Almacenes"}),a.jsx(Ie,{$active:r==="tipo-palet",onClick:()=>D("tipo-palet"),children:"Tipo de Palet"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Comercial"}),a.jsx(Ie,{$active:r==="organizaciones-ventas",onClick:()=>D("organizaciones-ventas"),children:"Organizaciones de Ventas"}),a.jsx(Ie,{$active:r==="grupo-imputacion-material",onClick:()=>D("grupo-imputacion-material"),children:"Grupo Imputacion Material"}),a.jsx(Ie,{$active:r==="matrices",onClick:()=>D("matrices"),children:"Matrices"}),a.jsx(Ie,{$active:r==="clasificaciones-clientes",onClick:()=>D("clasificaciones-clientes"),children:"Clasificaciones Clientes"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Produccion"}),a.jsx(Ie,{$active:r==="sectores",onClick:()=>D("sectores"),children:"Sectores"}),a.jsx(Ie,{$active:r==="cartones",onClick:()=>D("cartones"),children:"Cartones"}),a.jsx(Ie,{$active:r==="secuencias-operacionales",onClick:()=>D("secuencias-operacionales"),children:"Secuencias Operacionales"}),a.jsx(Ie,{$active:r==="rechazo-conjunto",onClick:()=>D("rechazo-conjunto"),children:"Rechazo Conjunto"}),a.jsx(Ie,{$active:r==="tiempo-tratamiento",onClick:()=>D("tiempo-tratamiento"),children:"Tiempo de Tratamiento"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Materiales"}),a.jsx(Ie,{$active:r==="materiales",onClick:()=>D("materiales"),children:"Materiales"}),a.jsx(Ie,{$active:r==="grupo-materiales-1",onClick:()=>D("grupo-materiales-1"),children:"Grupo Materiales 1"}),a.jsx(Ie,{$active:r==="grupo-materiales-2",onClick:()=>D("grupo-materiales-2"),children:"Grupo Materiales 2"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Configuracion"}),a.jsx(Ie,{$active:r==="grupo-plantas",onClick:()=>D("grupo-plantas"),children:"Grupo de Plantas"}),a.jsx(Ie,{$active:r==="adhesivos",onClick:()=>D("adhesivos"),children:"Adhesivos"}),a.jsx(Ie,{$active:r==="cebes",onClick:()=>D("cebes"),children:"CEBES"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Procesos"}),a.jsx(Ie,{$active:r==="armados",onClick:()=>D("armados"),children:"Armados"}),a.jsx(Ie,{$active:r==="procesos",onClick:()=>D("procesos"),children:"Procesos"}),a.jsx(Ie,{$active:r==="pegados",onClick:()=>D("pegados"),children:"Pegados"}),a.jsx(Ie,{$active:r==="envases",onClick:()=>D("envases"),children:"Envases"}),a.jsx(Ie,{$active:r==="rayados",onClick:()=>D("rayados"),children:"Rayados"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Papeles"}),a.jsx(Ie,{$active:r==="papeles",onClick:()=>D("papeles"),children:"Papeles"}),a.jsx(Ie,{$active:r==="cardboards",onClick:()=>D("cardboards"),children:"Cardboards"}),a.jsx(Ie,{$active:r==="carton-esquineros",onClick:()=>D("carton-esquineros"),children:"Carton Esquineros"}),a.jsx(Ie,{$active:r==="tipo-ondas",onClick:()=>D("tipo-ondas"),children:"Tipo Ondas"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Plantas"}),a.jsx(Ie,{$active:r==="plantas",onClick:()=>D("plantas"),children:"Plantas"}),a.jsx(Ie,{$active:r==="factores-ondas",onClick:()=>D("factores-ondas"),children:"Factores Ondas"}),a.jsx(Ie,{$active:r==="factores-desarrollos",onClick:()=>D("factores-desarrollos"),children:"Factores Desarrollos"}),a.jsx(Ie,{$active:r==="factores-seguridads",onClick:()=>D("factores-seguridads"),children:"Factores Seguridad"}),a.jsx(Ie,{$active:r==="areahcs",onClick:()=>D("areahcs"),children:"Area HCs"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Consumos"}),a.jsx(Ie,{$active:r==="consumo-adhesivos",onClick:()=>D("consumo-adhesivos"),children:"Consumo Adhesivos"}),a.jsx(Ie,{$active:r==="consumo-energias",onClick:()=>D("consumo-energias"),children:"Consumo Energias"}),a.jsx(Ie,{$active:r==="consumo-adhesivo-pegados",onClick:()=>D("consumo-adhesivo-pegados"),children:"Consumo Adhesivo Pegados"}),a.jsx(Ie,{$active:r==="merma-corrugadoras",onClick:()=>D("merma-corrugadoras"),children:"Merma Corrugadoras"}),a.jsx(Ie,{$active:r==="merma-convertidoras",onClick:()=>D("merma-convertidoras"),children:"Merma Convertidoras"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Comercial"}),a.jsx(Ie,{$active:r==="mercados",onClick:()=>D("mercados"),children:"Mercados"}),a.jsx(Ie,{$active:r==="rubros",onClick:()=>D("rubros"),children:"Rubros"}),a.jsx(Ie,{$active:r==="ciudades-fletes",onClick:()=>D("ciudades-fletes"),children:"Ciudades Fletes"}),a.jsx(Ie,{$active:r==="fletes",onClick:()=>D("fletes"),children:"Fletes"}),a.jsx(Ie,{$active:r==="maquila-servicios",onClick:()=>D("maquila-servicios"),children:"Maquila Servicios"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Tarifas"}),a.jsx(Ie,{$active:r==="tarifario",onClick:()=>D("tarifario"),children:"Tarifario"}),a.jsx(Ie,{$active:r==="tarifario-margens",onClick:()=>D("tarifario-margens"),children:"Tarifario Margenes"}),a.jsx(Ie,{$active:r==="variables-cotizador",onClick:()=>D("variables-cotizador"),children:"Variables Cotizador"}),a.jsx(Ie,{$active:r==="insumos-palletizados",onClick:()=>D("insumos-palletizados"),children:"Insumos Palletizados"}),a.jsx(Ie,{$active:r==="detalle-precio-palletizados",onClick:()=>D("detalle-precio-palletizados"),children:"Precio Palletizados"})]}),a.jsxs(ln,{children:[a.jsx(Wn,{children:"Cotizador - Catalogos"}),a.jsx(Ie,{$active:r==="paises",onClick:()=>D("paises"),children:"Paises"}),a.jsx(Ie,{$active:r==="fsc",onClick:()=>D("fsc"),children:"FSC"}),a.jsx(Ie,{$active:r==="reference-types",onClick:()=>D("reference-types"),children:"Tipos Referencia"}),a.jsx(Ie,{$active:r==="recubrimiento-types",onClick:()=>D("recubrimiento-types"),children:"Tipos Recubrimiento"})]})]})]})]}),Ut.canUseCotizador(e.role_id)&&a.jsxs(hj,{ref:E,children:[a.jsxs(fj,{$active:r==="cotizaciones"||r==="aprobaciones",onClick:()=>j(!y),children:["Cotizador",a.jsx(pj,{$open:y,children:""})]}),a.jsx(mj,{$open:y,children:a.jsxs(ln,{children:[a.jsx(Ie,{$active:r==="cotizaciones",onClick:()=>D("cotizaciones"),children:"Cotizaciones"}),Ut.canApproveCotizaciones(e.role_id)&&a.jsx(Ie,{$active:r==="aprobaciones",onClick:()=>D("aprobaciones"),children:"Aprobar Cotizaciones"}),a.jsx(Ie,{$active:r==="ayuda-cotizador",onClick:()=>D("ayuda-cotizador"),children:"Seccin de Ayuda"})]})})]})]})]}),a.jsxs(dme,{children:[a.jsx(ume,{children:W}),a.jsx(hme,{onClick:()=>D("cambiar-contrasena"),children:"Clave"}),a.jsx(fme,{onClick:t,children:"Salir"})]})]})}),a.jsx(pme,{children:B()})]})}function gme(){const[e,t]=S.useState(null),[r,n]=S.useState(!0),[i,s]=S.useState("login"),[o,l]=S.useState({});S.useEffect(()=>{const f=mo.getStoredUser();f&&t(f),n(!1)},[]);const c=S.useCallback(async(f,m)=>{try{const v=await mo.login({rut:f,password:m});return t(v.user),!0}catch(v){return console.error("Login failed:",v),!1}},[]),u=S.useCallback(()=>{mo.logout(),t(null),s("login")},[]),h=S.useCallback((f,m)=>{s(f),m&&l(m)},[]);if(r)return null;if(!e)switch(i){case"forgot-password":return a.jsx(kne,{onNavigate:h});case"reset-password":return a.jsx(Ane,{onNavigate:h,token:o.token,email:o.email});default:return a.jsx(S7,{onLogin:c,onNavigate:h})}return a.jsx(mme,{user:e,onLogout:u})}function xme(){return a.jsxs(KN,{client:nme,children:[a.jsx(fI,{}),a.jsx(gme,{})]})}gj.createRoot(document.getElementById("root")).render(a.jsx(As.StrictMode,{children:a.jsx(xme,{})}));
//# sourceMappingURL=index-L3X-TOvH.js.map
