var W6=Object.defineProperty;var wS=e=>{throw TypeError(e)};var G6=(e,t,r)=>t in e?W6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Le=(e,t,r)=>G6(e,typeof t!="symbol"?t+"":t,r),_v=(e,t,r)=>t.has(e)||wS("Cannot "+r);var ee=(e,t,r)=>(_v(e,t,"read from private field"),r?r.call(e):t.get(e)),He=(e,t,r)=>t.has(e)?wS("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Oe=(e,t,r,n)=>(_v(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),nt=(e,t,r)=>(_v(e,t,"access private method"),r);var Ep=(e,t,r,n)=>({set _(i){Oe(e,t,i,r)},get _(){return ee(e,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function q6(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var v3={exports:{}},E1={},_3={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ip=Symbol.for("react.element"),K6=Symbol.for("react.portal"),X6=Symbol.for("react.fragment"),Y6=Symbol.for("react.strict_mode"),Q6=Symbol.for("react.profiler"),J6=Symbol.for("react.provider"),Z6=Symbol.for("react.context"),eO=Symbol.for("react.forward_ref"),tO=Symbol.for("react.suspense"),rO=Symbol.for("react.memo"),nO=Symbol.for("react.lazy"),kS=Symbol.iterator;function aO(e){return e===null||typeof e!="object"?null:(e=kS&&e[kS]||e["@@iterator"],typeof e=="function"?e:null)}var y3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b3=Object.assign,j3={};function Ju(e,t,r){this.props=e,this.context=t,this.refs=j3,this.updater=r||y3}Ju.prototype.isReactComponent={};Ju.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ju.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function w3(){}w3.prototype=Ju.prototype;function c2(e,t,r){this.props=e,this.context=t,this.refs=j3,this.updater=r||y3}var d2=c2.prototype=new w3;d2.constructor=c2;b3(d2,Ju.prototype);d2.isPureReactComponent=!0;var SS=Array.isArray,k3=Object.prototype.hasOwnProperty,u2={current:null},S3={key:!0,ref:!0,__self:!0,__source:!0};function C3(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)k3.call(t,n)&&!S3.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:ip,type:e,key:s,ref:o,props:i,_owner:u2.current}}function iO(e,t){return{$$typeof:ip,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function h2(e){return typeof e=="object"&&e!==null&&e.$$typeof===ip}function sO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var CS=/\/+/g;function yv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?sO(""+e.key):t.toString(36)}function tx(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ip:case K6:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+yv(o,0):n,SS(i)?(r="",e!=null&&(r=e.replace(CS,"$&/")+"/"),tx(i,t,r,"",function(u){return u})):i!=null&&(h2(i)&&(i=iO(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(CS,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",SS(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+yv(s,l);o+=tx(s,t,r,c,i)}else if(c=aO(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+yv(s,l++),o+=tx(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Tp(e,t,r){if(e==null)return e;var n=[],i=0;return tx(e,n,"","",function(s){return t.call(r,s,i++)}),n}function oO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},rx={transition:null},lO={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:rx,ReactCurrentOwner:u2};function $3(){throw Error("act(...) is not supported in production builds of React.")}ht.Children={map:Tp,forEach:function(e,t,r){Tp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Tp(e,function(){t++}),t},toArray:function(e){return Tp(e,function(t){return t})||[]},only:function(e){if(!h2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ht.Component=Ju;ht.Fragment=X6;ht.Profiler=Q6;ht.PureComponent=c2;ht.StrictMode=Y6;ht.Suspense=tO;ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lO;ht.act=$3;ht.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=b3({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=u2.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k3.call(t,c)&&!S3.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ip,type:e.type,key:i,ref:s,props:n,_owner:o}};ht.createContext=function(e){return e={$$typeof:Z6,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:J6,_context:e},e.Consumer=e};ht.createElement=C3;ht.createFactory=function(e){var t=C3.bind(null,e);return t.type=e,t};ht.createRef=function(){return{current:null}};ht.forwardRef=function(e){return{$$typeof:eO,render:e}};ht.isValidElement=h2;ht.lazy=function(e){return{$$typeof:nO,_payload:{_status:-1,_result:e},_init:oO}};ht.memo=function(e,t){return{$$typeof:rO,type:e,compare:t===void 0?null:t}};ht.startTransition=function(e){var t=rx.transition;rx.transition={};try{e()}finally{rx.transition=t}};ht.unstable_act=$3;ht.useCallback=function(e,t){return Zn.current.useCallback(e,t)};ht.useContext=function(e){return Zn.current.useContext(e)};ht.useDebugValue=function(){};ht.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};ht.useEffect=function(e,t){return Zn.current.useEffect(e,t)};ht.useId=function(){return Zn.current.useId()};ht.useImperativeHandle=function(e,t,r){return Zn.current.useImperativeHandle(e,t,r)};ht.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};ht.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};ht.useMemo=function(e,t){return Zn.current.useMemo(e,t)};ht.useReducer=function(e,t,r){return Zn.current.useReducer(e,t,r)};ht.useRef=function(e){return Zn.current.useRef(e)};ht.useState=function(e){return Zn.current.useState(e)};ht.useSyncExternalStore=function(e,t,r){return Zn.current.useSyncExternalStore(e,t,r)};ht.useTransition=function(){return Zn.current.useTransition()};ht.version="18.3.1";_3.exports=ht;var C=_3.exports;const Es=q6(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cO=C,dO=Symbol.for("react.element"),uO=Symbol.for("react.fragment"),hO=Object.prototype.hasOwnProperty,fO=cO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pO={key:!0,ref:!0,__self:!0,__source:!0};function E3(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)hO.call(t,n)&&!pO.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:dO,type:e,key:s,ref:o,props:i,_owner:fO.current}}E1.Fragment=uO;E1.jsx=E3;E1.jsxs=E3;v3.exports=E1;var a=v3.exports,pj={},T3={exports:{}},Va={},A3={exports:{}},F3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(G,z){var ie=G.length;G.push(z);e:for(;0<ie;){var ne=ie-1>>>1,O=G[ne];if(0<i(O,z))G[ne]=z,G[ie]=O,ie=ne;else break e}}function r(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var z=G[0],ie=G.pop();if(ie!==z){G[0]=ie;e:for(var ne=0,O=G.length,N=O>>>1;ne<N;){var L=2*(ne+1)-1,K=G[L],re=L+1,Z=G[re];if(0>i(K,ie))re<O&&0>i(Z,K)?(G[ne]=Z,G[re]=ie,ne=re):(G[ne]=K,G[L]=ie,ne=L);else if(re<O&&0>i(Z,ie))G[ne]=Z,G[re]=ie,ne=re;else break e}}return z}function i(G,z){var ie=G.sortIndex-z.sortIndex;return ie!==0?ie:G.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,_=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(G){for(var z=r(u);z!==null;){if(z.callback===null)n(u);else if(z.startTime<=G)n(u),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(u)}}function S(G){if(v=!1,j(G),!g)if(r(c)!==null)g=!0,ae(T);else{var z=r(u);z!==null&&le(S,z.startTime-G)}}function T(G,z){g=!1,v&&(v=!1,b(P),P=-1),_=!0;var ie=m;try{for(j(z),f=r(c);f!==null&&(!(f.expirationTime>z)||G&&!D());){var ne=f.callback;if(typeof ne=="function"){f.callback=null,m=f.priorityLevel;var O=ne(f.expirationTime<=z);z=e.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),j(z)}else n(c);f=r(c)}if(f!==null)var N=!0;else{var L=r(u);L!==null&&le(S,L.startTime-z),N=!1}return N}finally{f=null,m=ie,_=!1}}var F=!1,w=null,P=-1,M=5,A=-1;function D(){return!(e.unstable_now()-A<M)}function H(){if(w!==null){var G=e.unstable_now();A=G;var z=!0;try{z=w(!0,G)}finally{z?U():(F=!1,w=null)}}else F=!1}var U;if(typeof x=="function")U=function(){x(H)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,R=W.port2;W.port1.onmessage=H,U=function(){R.postMessage(null)}}else U=function(){y(H,0)};function ae(G){w=G,F||(F=!0,U())}function le(G,z){P=y(function(){G(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){g||_||(g=!0,ae(T))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(G){switch(m){case 1:case 2:case 3:var z=3;break;default:z=m}var ie=m;m=z;try{return G()}finally{m=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ie=m;m=G;try{return z()}finally{m=ie}},e.unstable_scheduleCallback=function(G,z,ie){var ne=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ne+ie:ne):ie=ne,G){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ie+O,G={id:h++,callback:z,priorityLevel:G,startTime:ie,expirationTime:O,sortIndex:-1},ie>ne?(G.sortIndex=ie,t(u,G),r(c)===null&&G===r(u)&&(v?(b(P),P=-1):v=!0,le(S,ie-ne))):(G.sortIndex=O,t(c,G),g||_||(g=!0,ae(T))),G},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(G){var z=m;return function(){var ie=m;m=z;try{return G.apply(this,arguments)}finally{m=ie}}}})(F3);A3.exports=F3;var mO=A3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gO=C,Ba=mO;function je(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var D3=new Set,f0={};function pd(e,t){Pu(e,t),Pu(e+"Capture",t)}function Pu(e,t){for(f0[e]=t,e=0;e<t.length;e++)D3.add(t[e])}var yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mj=Object.prototype.hasOwnProperty,xO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$S={},ES={};function vO(e){return mj.call(ES,e)?!0:mj.call($S,e)?!1:xO.test(e)?ES[e]=!0:($S[e]=!0,!1)}function _O(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yO(e,t,r,n){if(t===null||typeof t>"u"||_O(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ea(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){un[e]=new ea(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];un[t]=new ea(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){un[e]=new ea(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){un[e]=new ea(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){un[e]=new ea(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){un[e]=new ea(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){un[e]=new ea(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){un[e]=new ea(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){un[e]=new ea(e,5,!1,e.toLowerCase(),null,!1,!1)});var f2=/[\-:]([a-z])/g;function p2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(f2,p2);un[t]=new ea(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(f2,p2);un[t]=new ea(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(f2,p2);un[t]=new ea(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){un[e]=new ea(e,1,!1,e.toLowerCase(),null,!1,!1)});un.xlinkHref=new ea("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){un[e]=new ea(e,1,!1,e.toLowerCase(),null,!0,!0)});function m2(e,t,r,n){var i=un.hasOwnProperty(t)?un[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yO(t,r,i,n)&&(r=null),n||i===null?vO(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var So=gO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ap=Symbol.for("react.element"),Kd=Symbol.for("react.portal"),Xd=Symbol.for("react.fragment"),g2=Symbol.for("react.strict_mode"),gj=Symbol.for("react.profiler"),P3=Symbol.for("react.provider"),M3=Symbol.for("react.context"),x2=Symbol.for("react.forward_ref"),xj=Symbol.for("react.suspense"),vj=Symbol.for("react.suspense_list"),v2=Symbol.for("react.memo"),al=Symbol.for("react.lazy"),O3=Symbol.for("react.offscreen"),TS=Symbol.iterator;function mh(e){return e===null||typeof e!="object"?null:(e=TS&&e[TS]||e["@@iterator"],typeof e=="function"?e:null)}var ir=Object.assign,bv;function Df(e){if(bv===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);bv=t&&t[1]||""}return`
`+bv+e}var jv=!1;function wv(e,t){if(!e||jv)return"";jv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{jv=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Df(e):""}function bO(e){switch(e.tag){case 5:return Df(e.type);case 16:return Df("Lazy");case 13:return Df("Suspense");case 19:return Df("SuspenseList");case 0:case 2:case 15:return e=wv(e.type,!1),e;case 11:return e=wv(e.type.render,!1),e;case 1:return e=wv(e.type,!0),e;default:return""}}function _j(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Xd:return"Fragment";case Kd:return"Portal";case gj:return"Profiler";case g2:return"StrictMode";case xj:return"Suspense";case vj:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case M3:return(e.displayName||"Context")+".Consumer";case P3:return(e._context.displayName||"Context")+".Provider";case x2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case v2:return t=e.displayName||null,t!==null?t:_j(e.type)||"Memo";case al:t=e._payload,e=e._init;try{return _j(e(t))}catch{}}return null}function jO(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _j(t);case 8:return t===g2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ol(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function R3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wO(e){var t=R3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Fp(e){e._valueTracker||(e._valueTracker=wO(e))}function N3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=R3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function $x(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yj(e,t){var r=t.checked;return ir({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function AS(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ol(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function z3(e,t){t=t.checked,t!=null&&m2(e,"checked",t,!1)}function bj(e,t){z3(e,t);var r=Ol(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?jj(e,t.type,r):t.hasOwnProperty("defaultValue")&&jj(e,t.type,Ol(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function FS(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function jj(e,t,r){(t!=="number"||$x(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Pf=Array.isArray;function cu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ol(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function wj(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(je(91));return ir({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function DS(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(je(92));if(Pf(r)){if(1<r.length)throw Error(je(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ol(r)}}function I3(e,t){var r=Ol(t.value),n=Ol(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function PS(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function L3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kj(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?L3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Dp,B3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Dp=Dp||document.createElement("div"),Dp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Dp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function p0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kO=["Webkit","ms","Moz","O"];Object.keys(Hf).forEach(function(e){kO.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hf[t]=Hf[e]})});function U3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hf.hasOwnProperty(e)&&Hf[e]?(""+t).trim():t+"px"}function V3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=U3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var SO=ir({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sj(e,t){if(t){if(SO[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(je(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(je(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(je(61))}if(t.style!=null&&typeof t.style!="object")throw Error(je(62))}}function Cj(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $j=null;function _2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ej=null,du=null,uu=null;function MS(e){if(e=lp(e)){if(typeof Ej!="function")throw Error(je(280));var t=e.stateNode;t&&(t=P1(t),Ej(e.stateNode,e.type,t))}}function H3(e){du?uu?uu.push(e):uu=[e]:du=e}function W3(){if(du){var e=du,t=uu;if(uu=du=null,MS(e),t)for(e=0;e<t.length;e++)MS(t[e])}}function G3(e,t){return e(t)}function q3(){}var kv=!1;function K3(e,t,r){if(kv)return e(t,r);kv=!0;try{return G3(e,t,r)}finally{kv=!1,(du!==null||uu!==null)&&(q3(),W3())}}function m0(e,t){var r=e.stateNode;if(r===null)return null;var n=P1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(je(231,t,typeof r));return r}var Tj=!1;if(yo)try{var gh={};Object.defineProperty(gh,"passive",{get:function(){Tj=!0}}),window.addEventListener("test",gh,gh),window.removeEventListener("test",gh,gh)}catch{Tj=!1}function CO(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(h){this.onError(h)}}var Wf=!1,Ex=null,Tx=!1,Aj=null,$O={onError:function(e){Wf=!0,Ex=e}};function EO(e,t,r,n,i,s,o,l,c){Wf=!1,Ex=null,CO.apply($O,arguments)}function TO(e,t,r,n,i,s,o,l,c){if(EO.apply(this,arguments),Wf){if(Wf){var u=Ex;Wf=!1,Ex=null}else throw Error(je(198));Tx||(Tx=!0,Aj=u)}}function md(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function X3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function OS(e){if(md(e)!==e)throw Error(je(188))}function AO(e){var t=e.alternate;if(!t){if(t=md(e),t===null)throw Error(je(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return OS(i),e;if(s===n)return OS(i),t;s=s.sibling}throw Error(je(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(je(189))}}if(r.alternate!==n)throw Error(je(190))}if(r.tag!==3)throw Error(je(188));return r.stateNode.current===r?e:t}function Y3(e){return e=AO(e),e!==null?Q3(e):null}function Q3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Q3(e);if(t!==null)return t;e=e.sibling}return null}var J3=Ba.unstable_scheduleCallback,RS=Ba.unstable_cancelCallback,FO=Ba.unstable_shouldYield,DO=Ba.unstable_requestPaint,_r=Ba.unstable_now,PO=Ba.unstable_getCurrentPriorityLevel,y2=Ba.unstable_ImmediatePriority,Z3=Ba.unstable_UserBlockingPriority,Ax=Ba.unstable_NormalPriority,MO=Ba.unstable_LowPriority,eF=Ba.unstable_IdlePriority,T1=null,As=null;function OO(e){if(As&&typeof As.onCommitFiberRoot=="function")try{As.onCommitFiberRoot(T1,e,void 0,(e.current.flags&128)===128)}catch{}}var Yi=Math.clz32?Math.clz32:zO,RO=Math.log,NO=Math.LN2;function zO(e){return e>>>=0,e===0?32:31-(RO(e)/NO|0)|0}var Pp=64,Mp=4194304;function Mf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fx(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=Mf(l):(s&=o,s!==0&&(n=Mf(s)))}else o=r&~i,o!==0?n=Mf(o):s!==0&&(n=Mf(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Yi(t),i=1<<r,n|=e[r],t&=~i;return n}function IO(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LO(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Yi(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=IO(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Fj(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function tF(){var e=Pp;return Pp<<=1,!(Pp&4194240)&&(Pp=64),e}function Sv(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function sp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yi(t),e[t]=r}function BO(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Yi(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function b2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Yi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ot=0;function rF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var nF,j2,aF,iF,sF,Dj=!1,Op=[],kl=null,Sl=null,Cl=null,g0=new Map,x0=new Map,sl=[],UO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function NS(e,t){switch(e){case"focusin":case"focusout":kl=null;break;case"dragenter":case"dragleave":Sl=null;break;case"mouseover":case"mouseout":Cl=null;break;case"pointerover":case"pointerout":g0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":x0.delete(t.pointerId)}}function xh(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=lp(t),t!==null&&j2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function VO(e,t,r,n,i){switch(t){case"focusin":return kl=xh(kl,e,t,r,n,i),!0;case"dragenter":return Sl=xh(Sl,e,t,r,n,i),!0;case"mouseover":return Cl=xh(Cl,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return g0.set(s,xh(g0.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,x0.set(s,xh(x0.get(s)||null,e,t,r,n,i)),!0}return!1}function oF(e){var t=Sc(e.target);if(t!==null){var r=md(t);if(r!==null){if(t=r.tag,t===13){if(t=X3(r),t!==null){e.blockedOn=t,sF(e.priority,function(){aF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function nx(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Pj(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);$j=n,r.target.dispatchEvent(n),$j=null}else return t=lp(r),t!==null&&j2(t),e.blockedOn=r,!1;t.shift()}return!0}function zS(e,t,r){nx(e)&&r.delete(t)}function HO(){Dj=!1,kl!==null&&nx(kl)&&(kl=null),Sl!==null&&nx(Sl)&&(Sl=null),Cl!==null&&nx(Cl)&&(Cl=null),g0.forEach(zS),x0.forEach(zS)}function vh(e,t){e.blockedOn===t&&(e.blockedOn=null,Dj||(Dj=!0,Ba.unstable_scheduleCallback(Ba.unstable_NormalPriority,HO)))}function v0(e){function t(i){return vh(i,e)}if(0<Op.length){vh(Op[0],e);for(var r=1;r<Op.length;r++){var n=Op[r];n.blockedOn===e&&(n.blockedOn=null)}}for(kl!==null&&vh(kl,e),Sl!==null&&vh(Sl,e),Cl!==null&&vh(Cl,e),g0.forEach(t),x0.forEach(t),r=0;r<sl.length;r++)n=sl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<sl.length&&(r=sl[0],r.blockedOn===null);)oF(r),r.blockedOn===null&&sl.shift()}var hu=So.ReactCurrentBatchConfig,Dx=!0;function WO(e,t,r,n){var i=Ot,s=hu.transition;hu.transition=null;try{Ot=1,w2(e,t,r,n)}finally{Ot=i,hu.transition=s}}function GO(e,t,r,n){var i=Ot,s=hu.transition;hu.transition=null;try{Ot=4,w2(e,t,r,n)}finally{Ot=i,hu.transition=s}}function w2(e,t,r,n){if(Dx){var i=Pj(e,t,r,n);if(i===null)Ov(e,t,n,Px,r),NS(e,n);else if(VO(i,e,t,r,n))n.stopPropagation();else if(NS(e,n),t&4&&-1<UO.indexOf(e)){for(;i!==null;){var s=lp(i);if(s!==null&&nF(s),s=Pj(e,t,r,n),s===null&&Ov(e,t,n,Px,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ov(e,t,n,null,r)}}var Px=null;function Pj(e,t,r,n){if(Px=null,e=_2(n),e=Sc(e),e!==null)if(t=md(e),t===null)e=null;else if(r=t.tag,r===13){if(e=X3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Px=e,null}function lF(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PO()){case y2:return 1;case Z3:return 4;case Ax:case MO:return 16;case eF:return 536870912;default:return 16}default:return 16}}var xl=null,k2=null,ax=null;function cF(){if(ax)return ax;var e,t=k2,r=t.length,n,i="value"in xl?xl.value:xl.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return ax=i.slice(e,1<n?1-n:void 0)}function ix(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Rp(){return!0}function IS(){return!1}function Ha(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Rp:IS,this.isPropagationStopped=IS,this}return ir(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Rp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Rp)},persist:function(){},isPersistent:Rp}),t}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},S2=Ha(Zu),op=ir({},Zu,{view:0,detail:0}),qO=Ha(op),Cv,$v,_h,A1=ir({},op,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:C2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_h&&(_h&&e.type==="mousemove"?(Cv=e.screenX-_h.screenX,$v=e.screenY-_h.screenY):$v=Cv=0,_h=e),Cv)},movementY:function(e){return"movementY"in e?e.movementY:$v}}),LS=Ha(A1),KO=ir({},A1,{dataTransfer:0}),XO=Ha(KO),YO=ir({},op,{relatedTarget:0}),Ev=Ha(YO),QO=ir({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),JO=Ha(QO),ZO=ir({},Zu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),eR=Ha(ZO),tR=ir({},Zu,{data:0}),BS=Ha(tR),rR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=aR[e])?!!t[e]:!1}function C2(){return iR}var sR=ir({},op,{key:function(e){if(e.key){var t=rR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ix(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?nR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:C2,charCode:function(e){return e.type==="keypress"?ix(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ix(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),oR=Ha(sR),lR=ir({},A1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),US=Ha(lR),cR=ir({},op,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:C2}),dR=Ha(cR),uR=ir({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),hR=Ha(uR),fR=ir({},A1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),pR=Ha(fR),mR=[9,13,27,32],$2=yo&&"CompositionEvent"in window,Gf=null;yo&&"documentMode"in document&&(Gf=document.documentMode);var gR=yo&&"TextEvent"in window&&!Gf,dF=yo&&(!$2||Gf&&8<Gf&&11>=Gf),VS=" ",HS=!1;function uF(e,t){switch(e){case"keyup":return mR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Yd=!1;function xR(e,t){switch(e){case"compositionend":return hF(t);case"keypress":return t.which!==32?null:(HS=!0,VS);case"textInput":return e=t.data,e===VS&&HS?null:e;default:return null}}function vR(e,t){if(Yd)return e==="compositionend"||!$2&&uF(e,t)?(e=cF(),ax=k2=xl=null,Yd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dF&&t.locale!=="ko"?null:t.data;default:return null}}var _R={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_R[e.type]:t==="textarea"}function fF(e,t,r,n){H3(n),t=Mx(t,"onChange"),0<t.length&&(r=new S2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qf=null,_0=null;function yR(e){kF(e,0)}function F1(e){var t=Zd(e);if(N3(t))return e}function bR(e,t){if(e==="change")return t}var pF=!1;if(yo){var Tv;if(yo){var Av="oninput"in document;if(!Av){var GS=document.createElement("div");GS.setAttribute("oninput","return;"),Av=typeof GS.oninput=="function"}Tv=Av}else Tv=!1;pF=Tv&&(!document.documentMode||9<document.documentMode)}function qS(){qf&&(qf.detachEvent("onpropertychange",mF),_0=qf=null)}function mF(e){if(e.propertyName==="value"&&F1(_0)){var t=[];fF(t,_0,e,_2(e)),K3(yR,t)}}function jR(e,t,r){e==="focusin"?(qS(),qf=t,_0=r,qf.attachEvent("onpropertychange",mF)):e==="focusout"&&qS()}function wR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return F1(_0)}function kR(e,t){if(e==="click")return F1(t)}function SR(e,t){if(e==="input"||e==="change")return F1(t)}function CR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ts=typeof Object.is=="function"?Object.is:CR;function y0(e,t){if(ts(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!mj.call(t,i)||!ts(e[i],t[i]))return!1}return!0}function KS(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function XS(e,t){var r=KS(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=KS(r)}}function gF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?gF(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xF(){for(var e=window,t=$x();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=$x(e.document)}return t}function E2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $R(e){var t=xF(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&gF(r.ownerDocument.documentElement,r)){if(n!==null&&E2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=XS(r,s);var o=XS(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ER=yo&&"documentMode"in document&&11>=document.documentMode,Qd=null,Mj=null,Kf=null,Oj=!1;function YS(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Oj||Qd==null||Qd!==$x(n)||(n=Qd,"selectionStart"in n&&E2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Kf&&y0(Kf,n)||(Kf=n,n=Mx(Mj,"onSelect"),0<n.length&&(t=new S2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Qd)))}function Np(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Jd={animationend:Np("Animation","AnimationEnd"),animationiteration:Np("Animation","AnimationIteration"),animationstart:Np("Animation","AnimationStart"),transitionend:Np("Transition","TransitionEnd")},Fv={},vF={};yo&&(vF=document.createElement("div").style,"AnimationEvent"in window||(delete Jd.animationend.animation,delete Jd.animationiteration.animation,delete Jd.animationstart.animation),"TransitionEvent"in window||delete Jd.transitionend.transition);function D1(e){if(Fv[e])return Fv[e];if(!Jd[e])return e;var t=Jd[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in vF)return Fv[e]=t[r];return e}var _F=D1("animationend"),yF=D1("animationiteration"),bF=D1("animationstart"),jF=D1("transitionend"),wF=new Map,QS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ul(e,t){wF.set(e,t),pd(t,[e])}for(var Dv=0;Dv<QS.length;Dv++){var Pv=QS[Dv],TR=Pv.toLowerCase(),AR=Pv[0].toUpperCase()+Pv.slice(1);Ul(TR,"on"+AR)}Ul(_F,"onAnimationEnd");Ul(yF,"onAnimationIteration");Ul(bF,"onAnimationStart");Ul("dblclick","onDoubleClick");Ul("focusin","onFocus");Ul("focusout","onBlur");Ul(jF,"onTransitionEnd");Pu("onMouseEnter",["mouseout","mouseover"]);Pu("onMouseLeave",["mouseout","mouseover"]);Pu("onPointerEnter",["pointerout","pointerover"]);Pu("onPointerLeave",["pointerout","pointerover"]);pd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pd("onBeforeInput",["compositionend","keypress","textInput","paste"]);pd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Of="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Of));function JS(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,TO(n,t,void 0,e),e.currentTarget=null}function kF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;JS(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;JS(i,l,u),s=c}}}if(Tx)throw e=Aj,Tx=!1,Aj=null,e}function Ut(e,t){var r=t[Lj];r===void 0&&(r=t[Lj]=new Set);var n=e+"__bubble";r.has(n)||(SF(t,e,2,!1),r.add(n))}function Mv(e,t,r){var n=0;t&&(n|=4),SF(r,e,n,t)}var zp="_reactListening"+Math.random().toString(36).slice(2);function b0(e){if(!e[zp]){e[zp]=!0,D3.forEach(function(r){r!=="selectionchange"&&(FR.has(r)||Mv(r,!1,e),Mv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zp]||(t[zp]=!0,Mv("selectionchange",!1,t))}}function SF(e,t,r,n){switch(lF(t)){case 1:var i=WO;break;case 4:i=GO;break;default:i=w2}r=i.bind(null,t,r,e),i=void 0,!Tj||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Ov(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Sc(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}K3(function(){var u=s,h=_2(r),f=[];e:{var m=wF.get(e);if(m!==void 0){var _=S2,g=e;switch(e){case"keypress":if(ix(r)===0)break e;case"keydown":case"keyup":_=oR;break;case"focusin":g="focus",_=Ev;break;case"focusout":g="blur",_=Ev;break;case"beforeblur":case"afterblur":_=Ev;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=LS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=XO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=dR;break;case _F:case yF:case bF:_=JO;break;case jF:_=hR;break;case"scroll":_=qO;break;case"wheel":_=pR;break;case"copy":case"cut":case"paste":_=eR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=US}var v=(t&4)!==0,y=!v&&e==="scroll",b=v?m!==null?m+"Capture":null:m;v=[];for(var x=u,j;x!==null;){j=x;var S=j.stateNode;if(j.tag===5&&S!==null&&(j=S,b!==null&&(S=m0(x,b),S!=null&&v.push(j0(x,S,j)))),y)break;x=x.return}0<v.length&&(m=new _(m,g,null,r,h),f.push({event:m,listeners:v}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",m&&r!==$j&&(g=r.relatedTarget||r.fromElement)&&(Sc(g)||g[bo]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(g=r.relatedTarget||r.toElement,_=u,g=g?Sc(g):null,g!==null&&(y=md(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(_=null,g=u),_!==g)){if(v=LS,S="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(v=US,S="onPointerLeave",b="onPointerEnter",x="pointer"),y=_==null?m:Zd(_),j=g==null?m:Zd(g),m=new v(S,x+"leave",_,r,h),m.target=y,m.relatedTarget=j,S=null,Sc(h)===u&&(v=new v(b,x+"enter",g,r,h),v.target=j,v.relatedTarget=y,S=v),y=S,_&&g)t:{for(v=_,b=g,x=0,j=v;j;j=$d(j))x++;for(j=0,S=b;S;S=$d(S))j++;for(;0<x-j;)v=$d(v),x--;for(;0<j-x;)b=$d(b),j--;for(;x--;){if(v===b||b!==null&&v===b.alternate)break t;v=$d(v),b=$d(b)}v=null}else v=null;_!==null&&ZS(f,m,_,v,!1),g!==null&&y!==null&&ZS(f,y,g,v,!0)}}e:{if(m=u?Zd(u):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var T=bR;else if(WS(m))if(pF)T=SR;else{T=wR;var F=jR}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(T=kR);if(T&&(T=T(e,u))){fF(f,T,r,h);break e}F&&F(e,m,u),e==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&jj(m,"number",m.value)}switch(F=u?Zd(u):window,e){case"focusin":(WS(F)||F.contentEditable==="true")&&(Qd=F,Mj=u,Kf=null);break;case"focusout":Kf=Mj=Qd=null;break;case"mousedown":Oj=!0;break;case"contextmenu":case"mouseup":case"dragend":Oj=!1,YS(f,r,h);break;case"selectionchange":if(ER)break;case"keydown":case"keyup":YS(f,r,h)}var w;if($2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Yd?uF(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(dF&&r.locale!=="ko"&&(Yd||P!=="onCompositionStart"?P==="onCompositionEnd"&&Yd&&(w=cF()):(xl=h,k2="value"in xl?xl.value:xl.textContent,Yd=!0)),F=Mx(u,P),0<F.length&&(P=new BS(P,e,null,r,h),f.push({event:P,listeners:F}),w?P.data=w:(w=hF(r),w!==null&&(P.data=w)))),(w=gR?xR(e,r):vR(e,r))&&(u=Mx(u,"onBeforeInput"),0<u.length&&(h=new BS("onBeforeInput","beforeinput",null,r,h),f.push({event:h,listeners:u}),h.data=w))}kF(f,t)})}function j0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Mx(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=m0(e,r),s!=null&&n.unshift(j0(e,s,i)),s=m0(e,t),s!=null&&n.push(j0(e,s,i))),e=e.return}return n}function $d(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ZS(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=m0(r,s),c!=null&&o.unshift(j0(r,c,l))):i||(c=m0(r,s),c!=null&&o.push(j0(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var DR=/\r\n?/g,PR=/\u0000|\uFFFD/g;function eC(e){return(typeof e=="string"?e:""+e).replace(DR,`
`).replace(PR,"")}function Ip(e,t,r){if(t=eC(t),eC(e)!==t&&r)throw Error(je(425))}function Ox(){}var Rj=null,Nj=null;function zj(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ij=typeof setTimeout=="function"?setTimeout:void 0,MR=typeof clearTimeout=="function"?clearTimeout:void 0,tC=typeof Promise=="function"?Promise:void 0,OR=typeof queueMicrotask=="function"?queueMicrotask:typeof tC<"u"?function(e){return tC.resolve(null).then(e).catch(RR)}:Ij;function RR(e){setTimeout(function(){throw e})}function Rv(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),v0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);v0(t)}function $l(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function rC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var eh=Math.random().toString(36).slice(2),$s="__reactFiber$"+eh,w0="__reactProps$"+eh,bo="__reactContainer$"+eh,Lj="__reactEvents$"+eh,NR="__reactListeners$"+eh,zR="__reactHandles$"+eh;function Sc(e){var t=e[$s];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bo]||r[$s]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=rC(e);e!==null;){if(r=e[$s])return r;e=rC(e)}return t}e=r,r=e.parentNode}return null}function lp(e){return e=e[$s]||e[bo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(je(33))}function P1(e){return e[w0]||null}var Bj=[],eu=-1;function Vl(e){return{current:e}}function Gt(e){0>eu||(e.current=Bj[eu],Bj[eu]=null,eu--)}function Bt(e,t){eu++,Bj[eu]=e.current,e.current=t}var Rl={},Pn=Vl(Rl),xa=Vl(!1),Jc=Rl;function Mu(e,t){var r=e.type.contextTypes;if(!r)return Rl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function va(e){return e=e.childContextTypes,e!=null}function Rx(){Gt(xa),Gt(Pn)}function nC(e,t,r){if(Pn.current!==Rl)throw Error(je(168));Bt(Pn,t),Bt(xa,r)}function CF(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(je(108,jO(e)||"Unknown",i));return ir({},r,n)}function Nx(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rl,Jc=Pn.current,Bt(Pn,e),Bt(xa,xa.current),!0}function aC(e,t,r){var n=e.stateNode;if(!n)throw Error(je(169));r?(e=CF(e,t,Jc),n.__reactInternalMemoizedMergedChildContext=e,Gt(xa),Gt(Pn),Bt(Pn,e)):Gt(xa),Bt(xa,r)}var ro=null,M1=!1,Nv=!1;function $F(e){ro===null?ro=[e]:ro.push(e)}function IR(e){M1=!0,$F(e)}function Hl(){if(!Nv&&ro!==null){Nv=!0;var e=0,t=Ot;try{var r=ro;for(Ot=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ro=null,M1=!1}catch(i){throw ro!==null&&(ro=ro.slice(e+1)),J3(y2,Hl),i}finally{Ot=t,Nv=!1}}return null}var tu=[],ru=0,zx=null,Ix=0,vi=[],_i=0,Zc=null,lo=1,co="";function yc(e,t){tu[ru++]=Ix,tu[ru++]=zx,zx=e,Ix=t}function EF(e,t,r){vi[_i++]=lo,vi[_i++]=co,vi[_i++]=Zc,Zc=e;var n=lo;e=co;var i=32-Yi(n)-1;n&=~(1<<i),r+=1;var s=32-Yi(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,lo=1<<32-Yi(t)+i|r<<i|n,co=s+e}else lo=1<<s|r<<i|n,co=e}function T2(e){e.return!==null&&(yc(e,1),EF(e,1,0))}function A2(e){for(;e===zx;)zx=tu[--ru],tu[ru]=null,Ix=tu[--ru],tu[ru]=null;for(;e===Zc;)Zc=vi[--_i],vi[_i]=null,co=vi[--_i],vi[_i]=null,lo=vi[--_i],vi[_i]=null}var La=null,za=null,Yt=!1,qi=null;function TF(e,t){var r=yi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function iC(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,La=e,za=$l(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,La=e,za=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zc!==null?{id:lo,overflow:co}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=yi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,La=e,za=null,!0):!1;default:return!1}}function Uj(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Vj(e){if(Yt){var t=za;if(t){var r=t;if(!iC(e,t)){if(Uj(e))throw Error(je(418));t=$l(r.nextSibling);var n=La;t&&iC(e,t)?TF(n,r):(e.flags=e.flags&-4097|2,Yt=!1,La=e)}}else{if(Uj(e))throw Error(je(418));e.flags=e.flags&-4097|2,Yt=!1,La=e}}}function sC(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;La=e}function Lp(e){if(e!==La)return!1;if(!Yt)return sC(e),Yt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zj(e.type,e.memoizedProps)),t&&(t=za)){if(Uj(e))throw AF(),Error(je(418));for(;t;)TF(e,t),t=$l(t.nextSibling)}if(sC(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(je(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){za=$l(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}za=null}}else za=La?$l(e.stateNode.nextSibling):null;return!0}function AF(){for(var e=za;e;)e=$l(e.nextSibling)}function Ou(){za=La=null,Yt=!1}function F2(e){qi===null?qi=[e]:qi.push(e)}var LR=So.ReactCurrentBatchConfig;function yh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(je(309));var n=r.stateNode}if(!n)throw Error(je(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(je(284));if(!r._owner)throw Error(je(290,e))}return e}function Bp(e,t){throw e=Object.prototype.toString.call(t),Error(je(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function oC(e){var t=e._init;return t(e._payload)}function FF(e){function t(b,x){if(e){var j=b.deletions;j===null?(b.deletions=[x],b.flags|=16):j.push(x)}}function r(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function n(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=Fl(b,x),b.index=0,b.sibling=null,b}function s(b,x,j){return b.index=j,e?(j=b.alternate,j!==null?(j=j.index,j<x?(b.flags|=2,x):j):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,x,j,S){return x===null||x.tag!==6?(x=Hv(j,b.mode,S),x.return=b,x):(x=i(x,j),x.return=b,x)}function c(b,x,j,S){var T=j.type;return T===Xd?h(b,x,j.props.children,S,j.key):x!==null&&(x.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===al&&oC(T)===x.type)?(S=i(x,j.props),S.ref=yh(b,x,j),S.return=b,S):(S=hx(j.type,j.key,j.props,null,b.mode,S),S.ref=yh(b,x,j),S.return=b,S)}function u(b,x,j,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==j.containerInfo||x.stateNode.implementation!==j.implementation?(x=Wv(j,b.mode,S),x.return=b,x):(x=i(x,j.children||[]),x.return=b,x)}function h(b,x,j,S,T){return x===null||x.tag!==7?(x=Vc(j,b.mode,S,T),x.return=b,x):(x=i(x,j),x.return=b,x)}function f(b,x,j){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Hv(""+x,b.mode,j),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ap:return j=hx(x.type,x.key,x.props,null,b.mode,j),j.ref=yh(b,null,x),j.return=b,j;case Kd:return x=Wv(x,b.mode,j),x.return=b,x;case al:var S=x._init;return f(b,S(x._payload),j)}if(Pf(x)||mh(x))return x=Vc(x,b.mode,j,null),x.return=b,x;Bp(b,x)}return null}function m(b,x,j,S){var T=x!==null?x.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return T!==null?null:l(b,x,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ap:return j.key===T?c(b,x,j,S):null;case Kd:return j.key===T?u(b,x,j,S):null;case al:return T=j._init,m(b,x,T(j._payload),S)}if(Pf(j)||mh(j))return T!==null?null:h(b,x,j,S,null);Bp(b,j)}return null}function _(b,x,j,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(j)||null,l(x,b,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ap:return b=b.get(S.key===null?j:S.key)||null,c(x,b,S,T);case Kd:return b=b.get(S.key===null?j:S.key)||null,u(x,b,S,T);case al:var F=S._init;return _(b,x,j,F(S._payload),T)}if(Pf(S)||mh(S))return b=b.get(j)||null,h(x,b,S,T,null);Bp(x,S)}return null}function g(b,x,j,S){for(var T=null,F=null,w=x,P=x=0,M=null;w!==null&&P<j.length;P++){w.index>P?(M=w,w=null):M=w.sibling;var A=m(b,w,j[P],S);if(A===null){w===null&&(w=M);break}e&&w&&A.alternate===null&&t(b,w),x=s(A,x,P),F===null?T=A:F.sibling=A,F=A,w=M}if(P===j.length)return r(b,w),Yt&&yc(b,P),T;if(w===null){for(;P<j.length;P++)w=f(b,j[P],S),w!==null&&(x=s(w,x,P),F===null?T=w:F.sibling=w,F=w);return Yt&&yc(b,P),T}for(w=n(b,w);P<j.length;P++)M=_(w,b,P,j[P],S),M!==null&&(e&&M.alternate!==null&&w.delete(M.key===null?P:M.key),x=s(M,x,P),F===null?T=M:F.sibling=M,F=M);return e&&w.forEach(function(D){return t(b,D)}),Yt&&yc(b,P),T}function v(b,x,j,S){var T=mh(j);if(typeof T!="function")throw Error(je(150));if(j=T.call(j),j==null)throw Error(je(151));for(var F=T=null,w=x,P=x=0,M=null,A=j.next();w!==null&&!A.done;P++,A=j.next()){w.index>P?(M=w,w=null):M=w.sibling;var D=m(b,w,A.value,S);if(D===null){w===null&&(w=M);break}e&&w&&D.alternate===null&&t(b,w),x=s(D,x,P),F===null?T=D:F.sibling=D,F=D,w=M}if(A.done)return r(b,w),Yt&&yc(b,P),T;if(w===null){for(;!A.done;P++,A=j.next())A=f(b,A.value,S),A!==null&&(x=s(A,x,P),F===null?T=A:F.sibling=A,F=A);return Yt&&yc(b,P),T}for(w=n(b,w);!A.done;P++,A=j.next())A=_(w,b,P,A.value,S),A!==null&&(e&&A.alternate!==null&&w.delete(A.key===null?P:A.key),x=s(A,x,P),F===null?T=A:F.sibling=A,F=A);return e&&w.forEach(function(H){return t(b,H)}),Yt&&yc(b,P),T}function y(b,x,j,S){if(typeof j=="object"&&j!==null&&j.type===Xd&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case Ap:e:{for(var T=j.key,F=x;F!==null;){if(F.key===T){if(T=j.type,T===Xd){if(F.tag===7){r(b,F.sibling),x=i(F,j.props.children),x.return=b,b=x;break e}}else if(F.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===al&&oC(T)===F.type){r(b,F.sibling),x=i(F,j.props),x.ref=yh(b,F,j),x.return=b,b=x;break e}r(b,F);break}else t(b,F);F=F.sibling}j.type===Xd?(x=Vc(j.props.children,b.mode,S,j.key),x.return=b,b=x):(S=hx(j.type,j.key,j.props,null,b.mode,S),S.ref=yh(b,x,j),S.return=b,b=S)}return o(b);case Kd:e:{for(F=j.key;x!==null;){if(x.key===F)if(x.tag===4&&x.stateNode.containerInfo===j.containerInfo&&x.stateNode.implementation===j.implementation){r(b,x.sibling),x=i(x,j.children||[]),x.return=b,b=x;break e}else{r(b,x);break}else t(b,x);x=x.sibling}x=Wv(j,b.mode,S),x.return=b,b=x}return o(b);case al:return F=j._init,y(b,x,F(j._payload),S)}if(Pf(j))return g(b,x,j,S);if(mh(j))return v(b,x,j,S);Bp(b,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,x!==null&&x.tag===6?(r(b,x.sibling),x=i(x,j),x.return=b,b=x):(r(b,x),x=Hv(j,b.mode,S),x.return=b,b=x),o(b)):r(b,x)}return y}var Ru=FF(!0),DF=FF(!1),Lx=Vl(null),Bx=null,nu=null,D2=null;function P2(){D2=nu=Bx=null}function M2(e){var t=Lx.current;Gt(Lx),e._currentValue=t}function Hj(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function fu(e,t){Bx=e,D2=nu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ma=!0),e.firstContext=null)}function Si(e){var t=e._currentValue;if(D2!==e)if(e={context:e,memoizedValue:t,next:null},nu===null){if(Bx===null)throw Error(je(308));nu=e,Bx.dependencies={lanes:0,firstContext:e}}else nu=nu.next=e;return t}var Cc=null;function O2(e){Cc===null?Cc=[e]:Cc.push(e)}function PF(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,O2(t)):(r.next=i.next,i.next=r),t.interleaved=r,jo(e,n)}function jo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var il=!1;function R2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MF(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function po(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function El(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,vt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,jo(e,r)}return i=n.interleaved,i===null?(t.next=t,O2(n)):(t.next=i.next,i.next=t),n.interleaved=t,jo(e,r)}function sx(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,b2(e,r)}}function lC(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ux(e,t,r,n){var i=e.updateQueue;il=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,h=u=c=null,l=s;do{var m=l.lane,_=l.eventTime;if((n&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,v=l;switch(m=t,_=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){f=g.call(_,f,m);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,m=typeof g=="function"?g.call(_,f,m):g,m==null)break e;f=ir({},f,m);break e;case 2:il=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else _={eventTime:_,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=_,c=f):h=h.next=_,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);td|=o,e.lanes=o,e.memoizedState=f}}function cC(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(je(191,i));i.call(n)}}}var cp={},Fs=Vl(cp),k0=Vl(cp),S0=Vl(cp);function $c(e){if(e===cp)throw Error(je(174));return e}function N2(e,t){switch(Bt(S0,t),Bt(k0,e),Bt(Fs,cp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:kj(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=kj(t,e)}Gt(Fs),Bt(Fs,t)}function Nu(){Gt(Fs),Gt(k0),Gt(S0)}function OF(e){$c(S0.current);var t=$c(Fs.current),r=kj(t,e.type);t!==r&&(Bt(k0,e),Bt(Fs,r))}function z2(e){k0.current===e&&(Gt(Fs),Gt(k0))}var er=Vl(0);function Vx(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zv=[];function I2(){for(var e=0;e<zv.length;e++)zv[e]._workInProgressVersionPrimary=null;zv.length=0}var ox=So.ReactCurrentDispatcher,Iv=So.ReactCurrentBatchConfig,ed=0,ar=null,Or=null,Kr=null,Hx=!1,Xf=!1,C0=0,BR=0;function gn(){throw Error(je(321))}function L2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ts(e[r],t[r]))return!1;return!0}function B2(e,t,r,n,i,s){if(ed=s,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ox.current=e===null||e.memoizedState===null?WR:GR,e=r(n,i),Xf){s=0;do{if(Xf=!1,C0=0,25<=s)throw Error(je(301));s+=1,Kr=Or=null,t.updateQueue=null,ox.current=qR,e=r(n,i)}while(Xf)}if(ox.current=Wx,t=Or!==null&&Or.next!==null,ed=0,Kr=Or=ar=null,Hx=!1,t)throw Error(je(300));return e}function U2(){var e=C0!==0;return C0=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?ar.memoizedState=Kr=e:Kr=Kr.next=e,Kr}function Ci(){if(Or===null){var e=ar.alternate;e=e!==null?e.memoizedState:null}else e=Or.next;var t=Kr===null?ar.memoizedState:Kr.next;if(t!==null)Kr=t,Or=e;else{if(e===null)throw Error(je(310));Or=e,e={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Kr===null?ar.memoizedState=Kr=e:Kr=Kr.next=e}return Kr}function $0(e,t){return typeof t=="function"?t(e):t}function Lv(e){var t=Ci(),r=t.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=e;var n=Or,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((ed&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ar.lanes|=h,td|=h}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,ts(n,t.memoizedState)||(ma=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,ar.lanes|=s,td|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Bv(e){var t=Ci(),r=t.queue;if(r===null)throw Error(je(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);ts(s,t.memoizedState)||(ma=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function RF(){}function NF(e,t){var r=ar,n=Ci(),i=t(),s=!ts(n.memoizedState,i);if(s&&(n.memoizedState=i,ma=!0),n=n.queue,V2(LF.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Kr!==null&&Kr.memoizedState.tag&1){if(r.flags|=2048,E0(9,IF.bind(null,r,n,i,t),void 0,null),Jr===null)throw Error(je(349));ed&30||zF(r,t,i)}return i}function zF(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function IF(e,t,r,n){t.value=r,t.getSnapshot=n,BF(t)&&UF(e)}function LF(e,t,r){return r(function(){BF(t)&&UF(e)})}function BF(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ts(e,r)}catch{return!0}}function UF(e){var t=jo(e,1);t!==null&&Qi(t,e,1,-1)}function dC(e){var t=ys();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$0,lastRenderedState:e},t.queue=e,e=e.dispatch=HR.bind(null,ar,e),[t.memoizedState,e]}function E0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function VF(){return Ci().memoizedState}function lx(e,t,r,n){var i=ys();ar.flags|=e,i.memoizedState=E0(1|t,r,void 0,n===void 0?null:n)}function O1(e,t,r,n){var i=Ci();n=n===void 0?null:n;var s=void 0;if(Or!==null){var o=Or.memoizedState;if(s=o.destroy,n!==null&&L2(n,o.deps)){i.memoizedState=E0(t,r,s,n);return}}ar.flags|=e,i.memoizedState=E0(1|t,r,s,n)}function uC(e,t){return lx(8390656,8,e,t)}function V2(e,t){return O1(2048,8,e,t)}function HF(e,t){return O1(4,2,e,t)}function WF(e,t){return O1(4,4,e,t)}function GF(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qF(e,t,r){return r=r!=null?r.concat([e]):null,O1(4,4,GF.bind(null,t,e),r)}function H2(){}function KF(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function XF(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function YF(e,t,r){return ed&21?(ts(r,t)||(r=tF(),ar.lanes|=r,td|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ma=!0),e.memoizedState=r)}function UR(e,t){var r=Ot;Ot=r!==0&&4>r?r:4,e(!0);var n=Iv.transition;Iv.transition={};try{e(!1),t()}finally{Ot=r,Iv.transition=n}}function QF(){return Ci().memoizedState}function VR(e,t,r){var n=Al(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},JF(e))ZF(t,r);else if(r=PF(e,t,r,n),r!==null){var i=Yn();Qi(r,e,n,i),eD(r,t,n)}}function HR(e,t,r){var n=Al(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(JF(e))ZF(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,ts(l,o)){var c=t.interleaved;c===null?(i.next=i,O2(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=PF(e,t,i,n),r!==null&&(i=Yn(),Qi(r,e,n,i),eD(r,t,n))}}function JF(e){var t=e.alternate;return e===ar||t!==null&&t===ar}function ZF(e,t){Xf=Hx=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function eD(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,b2(e,r)}}var Wx={readContext:Si,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useInsertionEffect:gn,useLayoutEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useMutableSource:gn,useSyncExternalStore:gn,useId:gn,unstable_isNewReconciler:!1},WR={readContext:Si,useCallback:function(e,t){return ys().memoizedState=[e,t===void 0?null:t],e},useContext:Si,useEffect:uC,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,lx(4194308,4,GF.bind(null,t,e),r)},useLayoutEffect:function(e,t){return lx(4194308,4,e,t)},useInsertionEffect:function(e,t){return lx(4,2,e,t)},useMemo:function(e,t){var r=ys();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ys();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=VR.bind(null,ar,e),[n.memoizedState,e]},useRef:function(e){var t=ys();return e={current:e},t.memoizedState=e},useState:dC,useDebugValue:H2,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=dC(!1),t=e[0];return e=UR.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ar,i=ys();if(Yt){if(r===void 0)throw Error(je(407));r=r()}else{if(r=t(),Jr===null)throw Error(je(349));ed&30||zF(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,uC(LF.bind(null,n,s,e),[e]),n.flags|=2048,E0(9,IF.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ys(),t=Jr.identifierPrefix;if(Yt){var r=co,n=lo;r=(n&~(1<<32-Yi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=C0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=BR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},GR={readContext:Si,useCallback:KF,useContext:Si,useEffect:V2,useImperativeHandle:qF,useInsertionEffect:HF,useLayoutEffect:WF,useMemo:XF,useReducer:Lv,useRef:VF,useState:function(){return Lv($0)},useDebugValue:H2,useDeferredValue:function(e){var t=Ci();return YF(t,Or.memoizedState,e)},useTransition:function(){var e=Lv($0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:RF,useSyncExternalStore:NF,useId:QF,unstable_isNewReconciler:!1},qR={readContext:Si,useCallback:KF,useContext:Si,useEffect:V2,useImperativeHandle:qF,useInsertionEffect:HF,useLayoutEffect:WF,useMemo:XF,useReducer:Bv,useRef:VF,useState:function(){return Bv($0)},useDebugValue:H2,useDeferredValue:function(e){var t=Ci();return Or===null?t.memoizedState=e:YF(t,Or.memoizedState,e)},useTransition:function(){var e=Bv($0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:RF,useSyncExternalStore:NF,useId:QF,unstable_isNewReconciler:!1};function Vi(e,t){if(e&&e.defaultProps){t=ir({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Wj(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ir({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var R1={isMounted:function(e){return(e=e._reactInternals)?md(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Yn(),i=Al(e),s=po(n,i);s.payload=t,r!=null&&(s.callback=r),t=El(e,s,i),t!==null&&(Qi(t,e,i,n),sx(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Yn(),i=Al(e),s=po(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=El(e,s,i),t!==null&&(Qi(t,e,i,n),sx(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Yn(),n=Al(e),i=po(r,n);i.tag=2,t!=null&&(i.callback=t),t=El(e,i,n),t!==null&&(Qi(t,e,n,r),sx(t,e,n))}};function hC(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!y0(r,n)||!y0(i,s):!0}function tD(e,t,r){var n=!1,i=Rl,s=t.contextType;return typeof s=="object"&&s!==null?s=Si(s):(i=va(t)?Jc:Pn.current,n=t.contextTypes,s=(n=n!=null)?Mu(e,i):Rl),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=R1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function fC(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&R1.enqueueReplaceState(t,t.state,null)}function Gj(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},R2(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Si(s):(s=va(t)?Jc:Pn.current,i.context=Mu(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Wj(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&R1.enqueueReplaceState(i,i.state,null),Ux(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function zu(e,t){try{var r="",n=t;do r+=bO(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Uv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function qj(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var KR=typeof WeakMap=="function"?WeakMap:Map;function rD(e,t,r){r=po(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){qx||(qx=!0,nw=n),qj(e,t)},r}function nD(e,t,r){r=po(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){qj(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){qj(e,t),typeof n!="function"&&(Tl===null?Tl=new Set([this]):Tl.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function pC(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new KR;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=lN.bind(null,e,t,r),t.then(e,e))}function mC(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function gC(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=po(-1,1),t.tag=2,El(r,t,1))),r.lanes|=1),e)}var XR=So.ReactCurrentOwner,ma=!1;function Wn(e,t,r,n){t.child=e===null?DF(t,null,r,n):Ru(t,e.child,r,n)}function xC(e,t,r,n,i){r=r.render;var s=t.ref;return fu(t,i),n=B2(e,t,r,n,s,i),r=U2(),e!==null&&!ma?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,wo(e,t,i)):(Yt&&r&&T2(t),t.flags|=1,Wn(e,t,n,i),t.child)}function vC(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!J2(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,aD(e,t,s,n,i)):(e=hx(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:y0,r(o,n)&&e.ref===t.ref)return wo(e,t,i)}return t.flags|=1,e=Fl(s,n),e.ref=t.ref,e.return=t,t.child=e}function aD(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(y0(s,n)&&e.ref===t.ref)if(ma=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(ma=!0);else return t.lanes=e.lanes,wo(e,t,i)}return Kj(e,t,r,n,i)}function iD(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(iu,Da),Da|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Bt(iu,Da),Da|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Bt(iu,Da),Da|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Bt(iu,Da),Da|=n;return Wn(e,t,i,r),t.child}function sD(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Kj(e,t,r,n,i){var s=va(r)?Jc:Pn.current;return s=Mu(t,s),fu(t,i),r=B2(e,t,r,n,s,i),n=U2(),e!==null&&!ma?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,wo(e,t,i)):(Yt&&n&&T2(t),t.flags|=1,Wn(e,t,r,i),t.child)}function _C(e,t,r,n,i){if(va(r)){var s=!0;Nx(t)}else s=!1;if(fu(t,i),t.stateNode===null)cx(e,t),tD(t,r,n),Gj(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Si(u):(u=va(r)?Jc:Pn.current,u=Mu(t,u));var h=r.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&fC(t,o,n,u),il=!1;var m=t.memoizedState;o.state=m,Ux(t,n,o,i),c=t.memoizedState,l!==n||m!==c||xa.current||il?(typeof h=="function"&&(Wj(t,r,h,n),c=t.memoizedState),(l=il||hC(t,r,l,n,m,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,MF(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Vi(t.type,l),o.props=u,f=t.pendingProps,m=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Si(c):(c=va(r)?Jc:Pn.current,c=Mu(t,c));var _=r.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&fC(t,o,n,c),il=!1,m=t.memoizedState,o.state=m,Ux(t,n,o,i);var g=t.memoizedState;l!==f||m!==g||xa.current||il?(typeof _=="function"&&(Wj(t,r,_,n),g=t.memoizedState),(u=il||hC(t,r,u,n,m,g,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Xj(e,t,r,n,s,i)}function Xj(e,t,r,n,i,s){sD(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&aC(t,r,!1),wo(e,t,s);n=t.stateNode,XR.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Ru(t,e.child,null,s),t.child=Ru(t,null,l,s)):Wn(e,t,l,s),t.memoizedState=n.state,i&&aC(t,r,!0),t.child}function oD(e){var t=e.stateNode;t.pendingContext?nC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&nC(e,t.context,!1),N2(e,t.containerInfo)}function yC(e,t,r,n,i){return Ou(),F2(i),t.flags|=256,Wn(e,t,r,n),t.child}var Yj={dehydrated:null,treeContext:null,retryLane:0};function Qj(e){return{baseLanes:e,cachePool:null,transitions:null}}function lD(e,t,r){var n=t.pendingProps,i=er.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Bt(er,i&1),e===null)return Vj(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=I1(o,n,0,null),e=Vc(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Qj(r),t.memoizedState=Yj,e):W2(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return YR(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Fl(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Fl(l,s):(s=Vc(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?Qj(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Yj,n}return s=e.child,e=s.sibling,n=Fl(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function W2(e,t){return t=I1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Up(e,t,r,n){return n!==null&&F2(n),Ru(t,e.child,null,r),e=W2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function YR(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Uv(Error(je(422))),Up(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=I1({mode:"visible",children:n.children},i,0,null),s=Vc(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ru(t,e.child,null,o),t.child.memoizedState=Qj(o),t.memoizedState=Yj,s);if(!(t.mode&1))return Up(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(je(419)),n=Uv(s,n,void 0),Up(e,t,o,n)}if(l=(o&e.childLanes)!==0,ma||l){if(n=Jr,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jo(e,i),Qi(n,e,i,-1))}return Q2(),n=Uv(Error(je(421))),Up(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=cN.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,za=$l(i.nextSibling),La=t,Yt=!0,qi=null,e!==null&&(vi[_i++]=lo,vi[_i++]=co,vi[_i++]=Zc,lo=e.id,co=e.overflow,Zc=t),t=W2(t,n.children),t.flags|=4096,t)}function bC(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Hj(e.return,t,r)}function Vv(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function cD(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Wn(e,t,n.children,r),n=er.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bC(e,r,t);else if(e.tag===19)bC(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Bt(er,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Vx(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Vv(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Vx(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Vv(t,!0,r,null,s);break;case"together":Vv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function cx(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),td|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(je(153));if(t.child!==null){for(e=t.child,r=Fl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function QR(e,t,r){switch(t.tag){case 3:oD(t),Ou();break;case 5:OF(t);break;case 1:va(t.type)&&Nx(t);break;case 4:N2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Bt(Lx,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Bt(er,er.current&1),t.flags|=128,null):r&t.child.childLanes?lD(e,t,r):(Bt(er,er.current&1),e=wo(e,t,r),e!==null?e.sibling:null);Bt(er,er.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return cD(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bt(er,er.current),n)break;return null;case 22:case 23:return t.lanes=0,iD(e,t,r)}return wo(e,t,r)}var dD,Jj,uD,hD;dD=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Jj=function(){};uD=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,$c(Fs.current);var s=null;switch(r){case"input":i=yj(e,i),n=yj(e,n),s=[];break;case"select":i=ir({},i,{value:void 0}),n=ir({},n,{value:void 0}),s=[];break;case"textarea":i=wj(e,i),n=wj(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ox)}Sj(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(f0.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(f0.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ut("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};hD=function(e,t,r,n){r!==n&&(t.flags|=4)};function bh(e,t){if(!Yt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function JR(e,t,r){var n=t.pendingProps;switch(A2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(t),null;case 1:return va(t.type)&&Rx(),xn(t),null;case 3:return n=t.stateNode,Nu(),Gt(xa),Gt(Pn),I2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Lp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,qi!==null&&(sw(qi),qi=null))),Jj(e,t),xn(t),null;case 5:z2(t);var i=$c(S0.current);if(r=t.type,e!==null&&t.stateNode!=null)uD(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(je(166));return xn(t),null}if(e=$c(Fs.current),Lp(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[$s]=t,n[w0]=s,e=(t.mode&1)!==0,r){case"dialog":Ut("cancel",n),Ut("close",n);break;case"iframe":case"object":case"embed":Ut("load",n);break;case"video":case"audio":for(i=0;i<Of.length;i++)Ut(Of[i],n);break;case"source":Ut("error",n);break;case"img":case"image":case"link":Ut("error",n),Ut("load",n);break;case"details":Ut("toggle",n);break;case"input":AS(n,s),Ut("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ut("invalid",n);break;case"textarea":DS(n,s),Ut("invalid",n)}Sj(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Ip(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Ip(n.textContent,l,e),i=["children",""+l]):f0.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ut("scroll",n)}switch(r){case"input":Fp(n),FS(n,s,!0);break;case"textarea":Fp(n),PS(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ox)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=L3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[$s]=t,e[w0]=n,dD(e,t,!1,!1),t.stateNode=e;e:{switch(o=Cj(r,n),r){case"dialog":Ut("cancel",e),Ut("close",e),i=n;break;case"iframe":case"object":case"embed":Ut("load",e),i=n;break;case"video":case"audio":for(i=0;i<Of.length;i++)Ut(Of[i],e);i=n;break;case"source":Ut("error",e),i=n;break;case"img":case"image":case"link":Ut("error",e),Ut("load",e),i=n;break;case"details":Ut("toggle",e),i=n;break;case"input":AS(e,n),i=yj(e,n),Ut("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=ir({},n,{value:void 0}),Ut("invalid",e);break;case"textarea":DS(e,n),i=wj(e,n),Ut("invalid",e);break;default:i=n}Sj(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?V3(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&B3(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&p0(e,c):typeof c=="number"&&p0(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(f0.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ut("scroll",e):c!=null&&m2(e,s,c,o))}switch(r){case"input":Fp(e),FS(e,n,!1);break;case"textarea":Fp(e),PS(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ol(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?cu(e,!!n.multiple,s,!1):n.defaultValue!=null&&cu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ox)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xn(t),null;case 6:if(e&&t.stateNode!=null)hD(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(je(166));if(r=$c(S0.current),$c(Fs.current),Lp(t)){if(n=t.stateNode,r=t.memoizedProps,n[$s]=t,(s=n.nodeValue!==r)&&(e=La,e!==null))switch(e.tag){case 3:Ip(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ip(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$s]=t,t.stateNode=n}return xn(t),null;case 13:if(Gt(er),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Yt&&za!==null&&t.mode&1&&!(t.flags&128))AF(),Ou(),t.flags|=98560,s=!1;else if(s=Lp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(je(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(je(317));s[$s]=t}else Ou(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xn(t),s=!1}else qi!==null&&(sw(qi),qi=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||er.current&1?Ir===0&&(Ir=3):Q2())),t.updateQueue!==null&&(t.flags|=4),xn(t),null);case 4:return Nu(),Jj(e,t),e===null&&b0(t.stateNode.containerInfo),xn(t),null;case 10:return M2(t.type._context),xn(t),null;case 17:return va(t.type)&&Rx(),xn(t),null;case 19:if(Gt(er),s=t.memoizedState,s===null)return xn(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)bh(s,!1);else{if(Ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Vx(e),o!==null){for(t.flags|=128,bh(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Bt(er,er.current&1|2),t.child}e=e.sibling}s.tail!==null&&_r()>Iu&&(t.flags|=128,n=!0,bh(s,!1),t.lanes=4194304)}else{if(!n)if(e=Vx(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Yt)return xn(t),null}else 2*_r()-s.renderingStartTime>Iu&&r!==1073741824&&(t.flags|=128,n=!0,bh(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=_r(),t.sibling=null,r=er.current,Bt(er,n?r&1|2:r&1),t):(xn(t),null);case 22:case 23:return Y2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Da&1073741824&&(xn(t),t.subtreeFlags&6&&(t.flags|=8192)):xn(t),null;case 24:return null;case 25:return null}throw Error(je(156,t.tag))}function ZR(e,t){switch(A2(t),t.tag){case 1:return va(t.type)&&Rx(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Nu(),Gt(xa),Gt(Pn),I2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return z2(t),null;case 13:if(Gt(er),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(je(340));Ou()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Gt(er),null;case 4:return Nu(),null;case 10:return M2(t.type._context),null;case 22:case 23:return Y2(),null;case 24:return null;default:return null}}var Vp=!1,kn=!1,eN=typeof WeakSet=="function"?WeakSet:Set,ze=null;function au(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){dr(e,t,n)}else r.current=null}function Zj(e,t,r){try{r()}catch(n){dr(e,t,n)}}var jC=!1;function tN(e,t){if(Rj=Dx,e=xF(),E2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,m=null;t:for(;;){for(var _;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(_=f.firstChild)!==null;)m=f,f=_;for(;;){if(f===e)break t;if(m===r&&++u===i&&(l=o),m===s&&++h===n&&(c=o),(_=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=_}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nj={focusedElem:e,selectionRange:r},Dx=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?v:Vi(t.type,v),y);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var j=t.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(S){dr(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return g=jC,jC=!1,g}function Yf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Zj(t,r,s)}i=i.next}while(i!==n)}}function N1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ew(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function fD(e){var t=e.alternate;t!==null&&(e.alternate=null,fD(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$s],delete t[w0],delete t[Lj],delete t[NR],delete t[zR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pD(e){return e.tag===5||e.tag===3||e.tag===4}function wC(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pD(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ox));else if(n!==4&&(e=e.child,e!==null))for(tw(e,t,r),e=e.sibling;e!==null;)tw(e,t,r),e=e.sibling}function rw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(rw(e,t,r),e=e.sibling;e!==null;)rw(e,t,r),e=e.sibling}var on=null,Gi=!1;function Po(e,t,r){for(r=r.child;r!==null;)mD(e,t,r),r=r.sibling}function mD(e,t,r){if(As&&typeof As.onCommitFiberUnmount=="function")try{As.onCommitFiberUnmount(T1,r)}catch{}switch(r.tag){case 5:kn||au(r,t);case 6:var n=on,i=Gi;on=null,Po(e,t,r),on=n,Gi=i,on!==null&&(Gi?(e=on,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):on.removeChild(r.stateNode));break;case 18:on!==null&&(Gi?(e=on,r=r.stateNode,e.nodeType===8?Rv(e.parentNode,r):e.nodeType===1&&Rv(e,r),v0(e)):Rv(on,r.stateNode));break;case 4:n=on,i=Gi,on=r.stateNode.containerInfo,Gi=!0,Po(e,t,r),on=n,Gi=i;break;case 0:case 11:case 14:case 15:if(!kn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Zj(r,t,o),i=i.next}while(i!==n)}Po(e,t,r);break;case 1:if(!kn&&(au(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){dr(r,t,l)}Po(e,t,r);break;case 21:Po(e,t,r);break;case 22:r.mode&1?(kn=(n=kn)||r.memoizedState!==null,Po(e,t,r),kn=n):Po(e,t,r);break;default:Po(e,t,r)}}function kC(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new eN),t.forEach(function(n){var i=dN.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Di(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:on=l.stateNode,Gi=!1;break e;case 3:on=l.stateNode.containerInfo,Gi=!0;break e;case 4:on=l.stateNode.containerInfo,Gi=!0;break e}l=l.return}if(on===null)throw Error(je(160));mD(s,o,i),on=null,Gi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){dr(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)gD(t,e),t=t.sibling}function gD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Di(t,e),ss(e),n&4){try{Yf(3,e,e.return),N1(3,e)}catch(v){dr(e,e.return,v)}try{Yf(5,e,e.return)}catch(v){dr(e,e.return,v)}}break;case 1:Di(t,e),ss(e),n&512&&r!==null&&au(r,r.return);break;case 5:if(Di(t,e),ss(e),n&512&&r!==null&&au(r,r.return),e.flags&32){var i=e.stateNode;try{p0(i,"")}catch(v){dr(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&z3(i,s),Cj(l,o);var u=Cj(l,s);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?V3(i,f):h==="dangerouslySetInnerHTML"?B3(i,f):h==="children"?p0(i,f):m2(i,h,f,u)}switch(l){case"input":bj(i,s);break;case"textarea":I3(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?cu(i,!!s.multiple,_,!1):m!==!!s.multiple&&(s.defaultValue!=null?cu(i,!!s.multiple,s.defaultValue,!0):cu(i,!!s.multiple,s.multiple?[]:"",!1))}i[w0]=s}catch(v){dr(e,e.return,v)}}break;case 6:if(Di(t,e),ss(e),n&4){if(e.stateNode===null)throw Error(je(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){dr(e,e.return,v)}}break;case 3:if(Di(t,e),ss(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{v0(t.containerInfo)}catch(v){dr(e,e.return,v)}break;case 4:Di(t,e),ss(e);break;case 13:Di(t,e),ss(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(K2=_r())),n&4&&kC(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(kn=(u=kn)||h,Di(t,e),kn=u):Di(t,e),ss(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(ze=e,h=e.child;h!==null;){for(f=ze=h;ze!==null;){switch(m=ze,_=m.child,m.tag){case 0:case 11:case 14:case 15:Yf(4,m,m.return);break;case 1:au(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){dr(n,r,v)}}break;case 5:au(m,m.return);break;case 22:if(m.memoizedState!==null){CC(f);continue}}_!==null?(_.return=m,ze=_):CC(f)}h=h.sibling}e:for(h=null,f=e;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=U3("display",o))}catch(v){dr(e,e.return,v)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){dr(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Di(t,e),ss(e),n&4&&kC(e);break;case 21:break;default:Di(t,e),ss(e)}}function ss(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pD(r)){var n=r;break e}r=r.return}throw Error(je(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(p0(i,""),n.flags&=-33);var s=wC(e);rw(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=wC(e);tw(e,l,o);break;default:throw Error(je(161))}}catch(c){dr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rN(e,t,r){ze=e,xD(e)}function xD(e,t,r){for(var n=(e.mode&1)!==0;ze!==null;){var i=ze,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Vp;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||kn;l=Vp;var u=kn;if(Vp=o,(kn=c)&&!u)for(ze=i;ze!==null;)o=ze,c=o.child,o.tag===22&&o.memoizedState!==null?$C(i):c!==null?(c.return=o,ze=c):$C(i);for(;s!==null;)ze=s,xD(s),s=s.sibling;ze=i,Vp=l,kn=u}SC(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ze=s):SC(e)}}function SC(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kn||N1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!kn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Vi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&cC(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}cC(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&v0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}kn||t.flags&512&&ew(t)}catch(m){dr(t,t.return,m)}}if(t===e){ze=null;break}if(r=t.sibling,r!==null){r.return=t.return,ze=r;break}ze=t.return}}function CC(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ze=r;break}ze=t.return}}function $C(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{N1(4,t)}catch(c){dr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){dr(t,i,c)}}var s=t.return;try{ew(t)}catch(c){dr(t,s,c)}break;case 5:var o=t.return;try{ew(t)}catch(c){dr(t,o,c)}}}catch(c){dr(t,t.return,c)}if(t===e){ze=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ze=l;break}ze=t.return}}var nN=Math.ceil,Gx=So.ReactCurrentDispatcher,G2=So.ReactCurrentOwner,wi=So.ReactCurrentBatchConfig,vt=0,Jr=null,Fr=null,dn=0,Da=0,iu=Vl(0),Ir=0,T0=null,td=0,z1=0,q2=0,Qf=null,fa=null,K2=0,Iu=1/0,Zs=null,qx=!1,nw=null,Tl=null,Hp=!1,vl=null,Kx=0,Jf=0,aw=null,dx=-1,ux=0;function Yn(){return vt&6?_r():dx!==-1?dx:dx=_r()}function Al(e){return e.mode&1?vt&2&&dn!==0?dn&-dn:LR.transition!==null?(ux===0&&(ux=tF()),ux):(e=Ot,e!==0||(e=window.event,e=e===void 0?16:lF(e.type)),e):1}function Qi(e,t,r,n){if(50<Jf)throw Jf=0,aw=null,Error(je(185));sp(e,r,n),(!(vt&2)||e!==Jr)&&(e===Jr&&(!(vt&2)&&(z1|=r),Ir===4&&ol(e,dn)),_a(e,n),r===1&&vt===0&&!(t.mode&1)&&(Iu=_r()+500,M1&&Hl()))}function _a(e,t){var r=e.callbackNode;LO(e,t);var n=Fx(e,e===Jr?dn:0);if(n===0)r!==null&&RS(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&RS(r),t===1)e.tag===0?IR(EC.bind(null,e)):$F(EC.bind(null,e)),OR(function(){!(vt&6)&&Hl()}),r=null;else{switch(rF(n)){case 1:r=y2;break;case 4:r=Z3;break;case 16:r=Ax;break;case 536870912:r=eF;break;default:r=Ax}r=SD(r,vD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vD(e,t){if(dx=-1,ux=0,vt&6)throw Error(je(327));var r=e.callbackNode;if(pu()&&e.callbackNode!==r)return null;var n=Fx(e,e===Jr?dn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Xx(e,n);else{t=n;var i=vt;vt|=2;var s=yD();(Jr!==e||dn!==t)&&(Zs=null,Iu=_r()+500,Uc(e,t));do try{sN();break}catch(l){_D(e,l)}while(!0);P2(),Gx.current=s,vt=i,Fr!==null?t=0:(Jr=null,dn=0,t=Ir)}if(t!==0){if(t===2&&(i=Fj(e),i!==0&&(n=i,t=iw(e,i))),t===1)throw r=T0,Uc(e,0),ol(e,n),_a(e,_r()),r;if(t===6)ol(e,n);else{if(i=e.current.alternate,!(n&30)&&!aN(i)&&(t=Xx(e,n),t===2&&(s=Fj(e),s!==0&&(n=s,t=iw(e,s))),t===1))throw r=T0,Uc(e,0),ol(e,n),_a(e,_r()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(je(345));case 2:bc(e,fa,Zs);break;case 3:if(ol(e,n),(n&130023424)===n&&(t=K2+500-_r(),10<t)){if(Fx(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Yn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ij(bc.bind(null,e,fa,Zs),t);break}bc(e,fa,Zs);break;case 4:if(ol(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Yi(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=_r()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*nN(n/1960))-n,10<n){e.timeoutHandle=Ij(bc.bind(null,e,fa,Zs),n);break}bc(e,fa,Zs);break;case 5:bc(e,fa,Zs);break;default:throw Error(je(329))}}}return _a(e,_r()),e.callbackNode===r?vD.bind(null,e):null}function iw(e,t){var r=Qf;return e.current.memoizedState.isDehydrated&&(Uc(e,t).flags|=256),e=Xx(e,t),e!==2&&(t=fa,fa=r,t!==null&&sw(t)),e}function sw(e){fa===null?fa=e:fa.push.apply(fa,e)}function aN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ts(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ol(e,t){for(t&=~q2,t&=~z1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Yi(t),n=1<<r;e[r]=-1,t&=~n}}function EC(e){if(vt&6)throw Error(je(327));pu();var t=Fx(e,0);if(!(t&1))return _a(e,_r()),null;var r=Xx(e,t);if(e.tag!==0&&r===2){var n=Fj(e);n!==0&&(t=n,r=iw(e,n))}if(r===1)throw r=T0,Uc(e,0),ol(e,t),_a(e,_r()),r;if(r===6)throw Error(je(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,fa,Zs),_a(e,_r()),null}function X2(e,t){var r=vt;vt|=1;try{return e(t)}finally{vt=r,vt===0&&(Iu=_r()+500,M1&&Hl())}}function rd(e){vl!==null&&vl.tag===0&&!(vt&6)&&pu();var t=vt;vt|=1;var r=wi.transition,n=Ot;try{if(wi.transition=null,Ot=1,e)return e()}finally{Ot=n,wi.transition=r,vt=t,!(vt&6)&&Hl()}}function Y2(){Da=iu.current,Gt(iu)}function Uc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,MR(r)),Fr!==null)for(r=Fr.return;r!==null;){var n=r;switch(A2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Rx();break;case 3:Nu(),Gt(xa),Gt(Pn),I2();break;case 5:z2(n);break;case 4:Nu();break;case 13:Gt(er);break;case 19:Gt(er);break;case 10:M2(n.type._context);break;case 22:case 23:Y2()}r=r.return}if(Jr=e,Fr=e=Fl(e.current,null),dn=Da=t,Ir=0,T0=null,q2=z1=td=0,fa=Qf=null,Cc!==null){for(t=0;t<Cc.length;t++)if(r=Cc[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Cc=null}return e}function _D(e,t){do{var r=Fr;try{if(P2(),ox.current=Wx,Hx){for(var n=ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Hx=!1}if(ed=0,Kr=Or=ar=null,Xf=!1,C0=0,G2.current=null,r===null||r.return===null){Ir=1,T0=t,Fr=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=dn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=mC(o);if(_!==null){_.flags&=-257,gC(_,o,l,s,t),_.mode&1&&pC(s,u,t),t=_,c=u;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){pC(s,u,t),Q2();break e}c=Error(je(426))}}else if(Yt&&l.mode&1){var y=mC(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),gC(y,o,l,s,t),F2(zu(c,l));break e}}s=c=zu(c,l),Ir!==4&&(Ir=2),Qf===null?Qf=[s]:Qf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=rD(s,c,t);lC(s,b);break e;case 1:l=c;var x=s.type,j=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Tl===null||!Tl.has(j)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=nD(s,l,t);lC(s,S);break e}}s=s.return}while(s!==null)}jD(r)}catch(T){t=T,Fr===r&&r!==null&&(Fr=r=r.return);continue}break}while(!0)}function yD(){var e=Gx.current;return Gx.current=Wx,e===null?Wx:e}function Q2(){(Ir===0||Ir===3||Ir===2)&&(Ir=4),Jr===null||!(td&268435455)&&!(z1&268435455)||ol(Jr,dn)}function Xx(e,t){var r=vt;vt|=2;var n=yD();(Jr!==e||dn!==t)&&(Zs=null,Uc(e,t));do try{iN();break}catch(i){_D(e,i)}while(!0);if(P2(),vt=r,Gx.current=n,Fr!==null)throw Error(je(261));return Jr=null,dn=0,Ir}function iN(){for(;Fr!==null;)bD(Fr)}function sN(){for(;Fr!==null&&!FO();)bD(Fr)}function bD(e){var t=kD(e.alternate,e,Da);e.memoizedProps=e.pendingProps,t===null?jD(e):Fr=t,G2.current=null}function jD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=ZR(r,t),r!==null){r.flags&=32767,Fr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ir=6,Fr=null;return}}else if(r=JR(r,t,Da),r!==null){Fr=r;return}if(t=t.sibling,t!==null){Fr=t;return}Fr=t=e}while(t!==null);Ir===0&&(Ir=5)}function bc(e,t,r){var n=Ot,i=wi.transition;try{wi.transition=null,Ot=1,oN(e,t,r,n)}finally{wi.transition=i,Ot=n}return null}function oN(e,t,r,n){do pu();while(vl!==null);if(vt&6)throw Error(je(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(je(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(BO(e,s),e===Jr&&(Fr=Jr=null,dn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Hp||(Hp=!0,SD(Ax,function(){return pu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=wi.transition,wi.transition=null;var o=Ot;Ot=1;var l=vt;vt|=4,G2.current=null,tN(e,r),gD(r,e),$R(Nj),Dx=!!Rj,Nj=Rj=null,e.current=r,rN(r),DO(),vt=l,Ot=o,wi.transition=s}else e.current=r;if(Hp&&(Hp=!1,vl=e,Kx=i),s=e.pendingLanes,s===0&&(Tl=null),OO(r.stateNode),_a(e,_r()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(qx)throw qx=!1,e=nw,nw=null,e;return Kx&1&&e.tag!==0&&pu(),s=e.pendingLanes,s&1?e===aw?Jf++:(Jf=0,aw=e):Jf=0,Hl(),null}function pu(){if(vl!==null){var e=rF(Kx),t=wi.transition,r=Ot;try{if(wi.transition=null,Ot=16>e?16:e,vl===null)var n=!1;else{if(e=vl,vl=null,Kx=0,vt&6)throw Error(je(331));var i=vt;for(vt|=4,ze=e.current;ze!==null;){var s=ze,o=s.child;if(ze.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ze=u;ze!==null;){var h=ze;switch(h.tag){case 0:case 11:case 15:Yf(8,h,s)}var f=h.child;if(f!==null)f.return=h,ze=f;else for(;ze!==null;){h=ze;var m=h.sibling,_=h.return;if(fD(h),h===u){ze=null;break}if(m!==null){m.return=_,ze=m;break}ze=_}}}var g=s.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}ze=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ze=o;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Yf(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,ze=b;break e}ze=s.return}}var x=e.current;for(ze=x;ze!==null;){o=ze;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,ze=j;else e:for(o=x;ze!==null;){if(l=ze,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:N1(9,l)}}catch(T){dr(l,l.return,T)}if(l===o){ze=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,ze=S;break e}ze=l.return}}if(vt=i,Hl(),As&&typeof As.onPostCommitFiberRoot=="function")try{As.onPostCommitFiberRoot(T1,e)}catch{}n=!0}return n}finally{Ot=r,wi.transition=t}}return!1}function TC(e,t,r){t=zu(r,t),t=rD(e,t,1),e=El(e,t,1),t=Yn(),e!==null&&(sp(e,1,t),_a(e,t))}function dr(e,t,r){if(e.tag===3)TC(e,e,r);else for(;t!==null;){if(t.tag===3){TC(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Tl===null||!Tl.has(n))){e=zu(r,e),e=nD(t,e,1),t=El(t,e,1),e=Yn(),t!==null&&(sp(t,1,e),_a(t,e));break}}t=t.return}}function lN(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Yn(),e.pingedLanes|=e.suspendedLanes&r,Jr===e&&(dn&r)===r&&(Ir===4||Ir===3&&(dn&130023424)===dn&&500>_r()-K2?Uc(e,0):q2|=r),_a(e,t)}function wD(e,t){t===0&&(e.mode&1?(t=Mp,Mp<<=1,!(Mp&130023424)&&(Mp=4194304)):t=1);var r=Yn();e=jo(e,t),e!==null&&(sp(e,t,r),_a(e,r))}function cN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),wD(e,r)}function dN(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(je(314))}n!==null&&n.delete(t),wD(e,r)}var kD;kD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||xa.current)ma=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ma=!1,QR(e,t,r);ma=!!(e.flags&131072)}else ma=!1,Yt&&t.flags&1048576&&EF(t,Ix,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;cx(e,t),e=t.pendingProps;var i=Mu(t,Pn.current);fu(t,r),i=B2(null,t,n,e,i,r);var s=U2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,va(n)?(s=!0,Nx(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,R2(t),i.updater=R1,t.stateNode=i,i._reactInternals=t,Gj(t,n,e,r),t=Xj(null,t,n,!0,s,r)):(t.tag=0,Yt&&s&&T2(t),Wn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(cx(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=hN(n),e=Vi(n,e),i){case 0:t=Kj(null,t,n,e,r);break e;case 1:t=_C(null,t,n,e,r);break e;case 11:t=xC(null,t,n,e,r);break e;case 14:t=vC(null,t,n,Vi(n.type,e),r);break e}throw Error(je(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vi(n,i),Kj(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vi(n,i),_C(e,t,n,i,r);case 3:e:{if(oD(t),e===null)throw Error(je(387));n=t.pendingProps,s=t.memoizedState,i=s.element,MF(e,t),Ux(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=zu(Error(je(423)),t),t=yC(e,t,n,r,i);break e}else if(n!==i){i=zu(Error(je(424)),t),t=yC(e,t,n,r,i);break e}else for(za=$l(t.stateNode.containerInfo.firstChild),La=t,Yt=!0,qi=null,r=DF(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ou(),n===i){t=wo(e,t,r);break e}Wn(e,t,n,r)}t=t.child}return t;case 5:return OF(t),e===null&&Vj(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,zj(n,i)?o=null:s!==null&&zj(n,s)&&(t.flags|=32),sD(e,t),Wn(e,t,o,r),t.child;case 6:return e===null&&Vj(t),null;case 13:return lD(e,t,r);case 4:return N2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ru(t,null,n,r):Wn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vi(n,i),xC(e,t,n,i,r);case 7:return Wn(e,t,t.pendingProps,r),t.child;case 8:return Wn(e,t,t.pendingProps.children,r),t.child;case 12:return Wn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Bt(Lx,n._currentValue),n._currentValue=o,s!==null)if(ts(s.value,o)){if(s.children===i.children&&!xa.current){t=wo(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=po(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Hj(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(je(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Hj(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Wn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,fu(t,r),i=Si(i),n=n(i),t.flags|=1,Wn(e,t,n,r),t.child;case 14:return n=t.type,i=Vi(n,t.pendingProps),i=Vi(n.type,i),vC(e,t,n,i,r);case 15:return aD(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vi(n,i),cx(e,t),t.tag=1,va(n)?(e=!0,Nx(t)):e=!1,fu(t,r),tD(t,n,i),Gj(t,n,i,r),Xj(null,t,n,!0,e,r);case 19:return cD(e,t,r);case 22:return iD(e,t,r)}throw Error(je(156,t.tag))};function SD(e,t){return J3(e,t)}function uN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(e,t,r,n){return new uN(e,t,r,n)}function J2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hN(e){if(typeof e=="function")return J2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===x2)return 11;if(e===v2)return 14}return 2}function Fl(e,t){var r=e.alternate;return r===null?(r=yi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function hx(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")J2(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Xd:return Vc(r.children,i,s,t);case g2:o=8,i|=8;break;case gj:return e=yi(12,r,t,i|2),e.elementType=gj,e.lanes=s,e;case xj:return e=yi(13,r,t,i),e.elementType=xj,e.lanes=s,e;case vj:return e=yi(19,r,t,i),e.elementType=vj,e.lanes=s,e;case O3:return I1(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P3:o=10;break e;case M3:o=9;break e;case x2:o=11;break e;case v2:o=14;break e;case al:o=16,n=null;break e}throw Error(je(130,e==null?e:typeof e,""))}return t=yi(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Vc(e,t,r,n){return e=yi(7,e,n,t),e.lanes=r,e}function I1(e,t,r,n){return e=yi(22,e,n,t),e.elementType=O3,e.lanes=r,e.stateNode={isHidden:!1},e}function Hv(e,t,r){return e=yi(6,e,null,t),e.lanes=r,e}function Wv(e,t,r){return t=yi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function fN(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sv(0),this.expirationTimes=Sv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sv(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Z2(e,t,r,n,i,s,o,l,c){return e=new fN(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=yi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},R2(s),e}function pN(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function CD(e){if(!e)return Rl;e=e._reactInternals;e:{if(md(e)!==e||e.tag!==1)throw Error(je(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(va(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(je(171))}if(e.tag===1){var r=e.type;if(va(r))return CF(e,r,t)}return t}function $D(e,t,r,n,i,s,o,l,c){return e=Z2(r,n,!0,e,i,s,o,l,c),e.context=CD(null),r=e.current,n=Yn(),i=Al(r),s=po(n,i),s.callback=t??null,El(r,s,i),e.current.lanes=i,sp(e,i,n),_a(e,n),e}function L1(e,t,r,n){var i=t.current,s=Yn(),o=Al(i);return r=CD(r),t.context===null?t.context=r:t.pendingContext=r,t=po(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=El(i,t,o),e!==null&&(Qi(e,i,o,s),sx(e,i,o)),o}function Yx(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function AC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ek(e,t){AC(e,t),(e=e.alternate)&&AC(e,t)}function mN(){return null}var ED=typeof reportError=="function"?reportError:function(e){console.error(e)};function tk(e){this._internalRoot=e}B1.prototype.render=tk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(je(409));L1(e,t,null,null)};B1.prototype.unmount=tk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rd(function(){L1(null,e,null,null)}),t[bo]=null}};function B1(e){this._internalRoot=e}B1.prototype.unstable_scheduleHydration=function(e){if(e){var t=iF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<sl.length&&t!==0&&t<sl[r].priority;r++);sl.splice(r,0,e),r===0&&oF(e)}};function rk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function U1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function FC(){}function gN(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Yx(o);s.call(u)}}var o=$D(t,n,e,0,null,!1,!1,"",FC);return e._reactRootContainer=o,e[bo]=o.current,b0(e.nodeType===8?e.parentNode:e),rd(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=Yx(c);l.call(u)}}var c=Z2(e,0,!1,null,null,!1,!1,"",FC);return e._reactRootContainer=c,e[bo]=c.current,b0(e.nodeType===8?e.parentNode:e),rd(function(){L1(t,c,r,n)}),c}function V1(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=Yx(o);l.call(c)}}L1(t,o,e,i)}else o=gN(r,t,e,i,n);return Yx(o)}nF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Mf(t.pendingLanes);r!==0&&(b2(t,r|1),_a(t,_r()),!(vt&6)&&(Iu=_r()+500,Hl()))}break;case 13:rd(function(){var n=jo(e,1);if(n!==null){var i=Yn();Qi(n,e,1,i)}}),ek(e,1)}};j2=function(e){if(e.tag===13){var t=jo(e,134217728);if(t!==null){var r=Yn();Qi(t,e,134217728,r)}ek(e,134217728)}};aF=function(e){if(e.tag===13){var t=Al(e),r=jo(e,t);if(r!==null){var n=Yn();Qi(r,e,t,n)}ek(e,t)}};iF=function(){return Ot};sF=function(e,t){var r=Ot;try{return Ot=e,t()}finally{Ot=r}};Ej=function(e,t,r){switch(t){case"input":if(bj(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=P1(n);if(!i)throw Error(je(90));N3(n),bj(n,i)}}}break;case"textarea":I3(e,r);break;case"select":t=r.value,t!=null&&cu(e,!!r.multiple,t,!1)}};G3=X2;q3=rd;var xN={usingClientEntryPoint:!1,Events:[lp,Zd,P1,H3,W3,X2]},jh={findFiberByHostInstance:Sc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vN={bundleType:jh.bundleType,version:jh.version,rendererPackageName:jh.rendererPackageName,rendererConfig:jh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:So.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Y3(e),e===null?null:e.stateNode},findFiberByHostInstance:jh.findFiberByHostInstance||mN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{T1=Wp.inject(vN),As=Wp}catch{}}Va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xN;Va.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rk(t))throw Error(je(200));return pN(e,t,null,r)};Va.createRoot=function(e,t){if(!rk(e))throw Error(je(299));var r=!1,n="",i=ED;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Z2(e,1,!1,null,null,r,!1,n,i),e[bo]=t.current,b0(e.nodeType===8?e.parentNode:e),new tk(t)};Va.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(je(188)):(e=Object.keys(e).join(","),Error(je(268,e)));return e=Y3(t),e=e===null?null:e.stateNode,e};Va.flushSync=function(e){return rd(e)};Va.hydrate=function(e,t,r){if(!U1(t))throw Error(je(200));return V1(null,e,t,!0,r)};Va.hydrateRoot=function(e,t,r){if(!rk(e))throw Error(je(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=ED;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=$D(t,null,e,1,r??null,i,!1,s,o),e[bo]=t.current,b0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new B1(t)};Va.render=function(e,t,r){if(!U1(t))throw Error(je(200));return V1(null,e,t,!1,r)};Va.unmountComponentAtNode=function(e){if(!U1(e))throw Error(je(40));return e._reactRootContainer?(rd(function(){V1(null,null,e,!1,function(){e._reactRootContainer=null,e[bo]=null})}),!0):!1};Va.unstable_batchedUpdates=X2;Va.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!U1(r))throw Error(je(200));if(e==null||e._reactInternals===void 0)throw Error(je(38));return V1(e,t,r,!1,n)};Va.version="18.3.1-next-f1338f8080-20240426";function TD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TD)}catch(e){console.error(e)}}TD(),T3.exports=Va;var _N=T3.exports,DC=_N;pj.createRoot=DC.createRoot,pj.hydrateRoot=DC.hydrateRoot;var th=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},yN={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},ll,l2,o3,bN=(o3=class{constructor(){He(this,ll,yN);He(this,l2,!1)}setTimeoutProvider(e){Oe(this,ll,e)}setTimeout(e,t){return ee(this,ll).setTimeout(e,t)}clearTimeout(e){ee(this,ll).clearTimeout(e)}setInterval(e,t){return ee(this,ll).setInterval(e,t)}clearInterval(e){ee(this,ll).clearInterval(e)}},ll=new WeakMap,l2=new WeakMap,o3),Ec=new bN;function jN(e){setTimeout(e,0)}var nd=typeof window>"u"||"Deno"in globalThis;function Gn(){}function wN(e,t){return typeof e=="function"?e(t):e}function ow(e){return typeof e=="number"&&e>=0&&e!==1/0}function AD(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Dl(e,t){return typeof e=="function"?e(t):e}function xi(e,t){return typeof e=="function"?e(t):e}function PC(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==nk(o,t.options))return!1}else if(!A0(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||i&&i!==t.state.fetchStatus||s&&!s(t))}function MC(e,t){const{exact:r,status:n,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(ad(t.options.mutationKey)!==ad(s))return!1}else if(!A0(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function nk(e,t){return((t==null?void 0:t.queryKeyHashFn)||ad)(e)}function ad(e){return JSON.stringify(e,(t,r)=>lw(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function A0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>A0(e[r],t[r])):!1}var kN=Object.prototype.hasOwnProperty;function FD(e,t){if(e===t)return e;const r=OC(e)&&OC(t);if(!r&&!(lw(e)&&lw(t)))return t;const i=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),o=s.length,l=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const h=r?u:s[u],f=e[h],m=t[h];if(f===m){l[h]=f,(r?u<i:kN.call(e,h))&&c++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){l[h]=m;continue}const _=FD(f,m);l[h]=_,_===f&&c++}return i===o&&c===i?e:l}function Qx(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function OC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function lw(e){if(!RC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!RC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function RC(e){return Object.prototype.toString.call(e)==="[object Object]"}function SN(e){return new Promise(t=>{Ec.setTimeout(t,e)})}function cw(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?FD(e,t):t}function CN(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $N(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ak=Symbol();function DD(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ak?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function PD(e,t){return typeof e=="function"?e(...t):!!e}var Pc,cl,bu,l3,EN=(l3=class extends th{constructor(){super();He(this,Pc);He(this,cl);He(this,bu);Oe(this,bu,t=>{if(!nd&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ee(this,cl)||this.setEventListener(ee(this,bu))}onUnsubscribe(){var t;this.hasListeners()||((t=ee(this,cl))==null||t.call(this),Oe(this,cl,void 0))}setEventListener(t){var r;Oe(this,bu,t),(r=ee(this,cl))==null||r.call(this),Oe(this,cl,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){ee(this,Pc)!==t&&(Oe(this,Pc,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ee(this,Pc)=="boolean"?ee(this,Pc):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Pc=new WeakMap,cl=new WeakMap,bu=new WeakMap,l3),ik=new EN;function dw(){let e,t;const r=new Promise((i,s)=>{e=i,t=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}var TN=jN;function AN(){let e=[],t=0,r=l=>{l()},n=l=>{l()},i=TN;const s=l=>{t?e.push(l):i(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&i(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{s(()=>{l(...c)})},schedule:s,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var Nr=AN(),ju,dl,wu,c3,FN=(c3=class extends th{constructor(){super();He(this,ju,!0);He(this,dl);He(this,wu);Oe(this,wu,t=>{if(!nd&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){ee(this,dl)||this.setEventListener(ee(this,wu))}onUnsubscribe(){var t;this.hasListeners()||((t=ee(this,dl))==null||t.call(this),Oe(this,dl,void 0))}setEventListener(t){var r;Oe(this,wu,t),(r=ee(this,dl))==null||r.call(this),Oe(this,dl,t(this.setOnline.bind(this)))}setOnline(t){ee(this,ju)!==t&&(Oe(this,ju,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return ee(this,ju)}},ju=new WeakMap,dl=new WeakMap,wu=new WeakMap,c3),Jx=new FN;function DN(e){return Math.min(1e3*2**e,3e4)}function MD(e){return(e??"online")==="online"?Jx.isOnline():!0}var uw=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function OD(e){let t=!1,r=0,n;const i=dw(),s=()=>i.status!=="pending",o=v=>{var y;if(!s()){const b=new uw(v);m(b),(y=e.onCancel)==null||y.call(e,b)}},l=()=>{t=!0},c=()=>{t=!1},u=()=>ik.isFocused()&&(e.networkMode==="always"||Jx.isOnline())&&e.canRun(),h=()=>MD(e.networkMode)&&e.canRun(),f=v=>{s()||(n==null||n(),i.resolve(v))},m=v=>{s()||(n==null||n(),i.reject(v))},_=()=>new Promise(v=>{var y;n=b=>{(s()||u())&&v(b)},(y=e.onPause)==null||y.call(e)}).then(()=>{var v;n=void 0,s()||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(s())return;let v;const y=r===0?e.initialPromise:void 0;try{v=y??e.fn()}catch(b){v=Promise.reject(b)}Promise.resolve(v).then(f).catch(b=>{var F;if(s())return;const x=e.retry??(nd?0:3),j=e.retryDelay??DN,S=typeof j=="function"?j(r,b):j,T=x===!0||typeof x=="number"&&r<x||typeof x=="function"&&x(r,b);if(t||!T){m(b);return}r++,(F=e.onFail)==null||F.call(e,r,b),SN(S).then(()=>u()?void 0:_()).then(()=>{t?m(b):g()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?g():_().then(g),i)}}var Mc,d3,RD=(d3=class{constructor(){He(this,Mc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ow(this.gcTime)&&Oe(this,Mc,Ec.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(nd?1/0:5*60*1e3))}clearGcTimeout(){ee(this,Mc)&&(Ec.clearTimeout(ee(this,Mc)),Oe(this,Mc,void 0))}},Mc=new WeakMap,d3),Oc,ku,mi,Rc,Gr,ep,Nc,Hi,Ys,u3,PN=(u3=class extends RD{constructor(t){super();He(this,Hi);He(this,Oc);He(this,ku);He(this,mi);He(this,Rc);He(this,Gr);He(this,ep);He(this,Nc);Oe(this,Nc,!1),Oe(this,ep,t.defaultOptions),this.setOptions(t.options),this.observers=[],Oe(this,Rc,t.client),Oe(this,mi,ee(this,Rc).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Oe(this,Oc,zC(this.options)),this.state=t.state??ee(this,Oc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ee(this,Gr))==null?void 0:t.promise}setOptions(t){if(this.options={...ee(this,ep),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=zC(this.options);r.data!==void 0&&(this.setState(NC(r.data,r.dataUpdatedAt)),Oe(this,Oc,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ee(this,mi).remove(this)}setData(t,r){const n=cw(this.state.data,t,this.options);return nt(this,Hi,Ys).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){nt(this,Hi,Ys).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,i;const r=(n=ee(this,Gr))==null?void 0:n.promise;return(i=ee(this,Gr))==null||i.cancel(t),r?r.then(Gn).catch(Gn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ee(this,Oc))}isActive(){return this.observers.some(t=>xi(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ak||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Dl(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!AD(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ee(this,Gr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ee(this,Gr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ee(this,mi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ee(this,Gr)&&(ee(this,Nc)?ee(this,Gr).cancel({revert:!0}):ee(this,Gr).cancelRetry()),this.scheduleGc()),ee(this,mi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||nt(this,Hi,Ys).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,h,f,m,_,g,v,y,b,x,j;if(this.state.fetchStatus!=="idle"&&((c=ee(this,Gr))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ee(this,Gr))return ee(this,Gr).continueRetry(),ee(this,Gr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(T=>T.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,i=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(Oe(this,Nc,!0),n.signal)})},s=()=>{const S=DD(this.options,r),F=(()=>{const w={client:ee(this,Rc),queryKey:this.queryKey,meta:this.meta};return i(w),w})();return Oe(this,Nc,!1),this.options.persister?this.options.persister(S,F,this):S(F)},l=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ee(this,Rc),state:this.state,fetchFn:s};return i(S),S})();(u=this.options.behavior)==null||u.onFetch(l,this),Oe(this,ku,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&nt(this,Hi,Ys).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta}),Oe(this,Gr,OD({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:S=>{S instanceof uw&&S.revert&&this.setState({...ee(this,ku),fetchStatus:"idle"}),n.abort()},onFail:(S,T)=>{nt(this,Hi,Ys).call(this,{type:"failed",failureCount:S,error:T})},onPause:()=>{nt(this,Hi,Ys).call(this,{type:"pause"})},onContinue:()=>{nt(this,Hi,Ys).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const S=await ee(this,Gr).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(_=(m=ee(this,mi).config).onSuccess)==null||_.call(m,S,this),(v=(g=ee(this,mi).config).onSettled)==null||v.call(g,S,this.state.error,this),S}catch(S){if(S instanceof uw){if(S.silent)return ee(this,Gr).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw nt(this,Hi,Ys).call(this,{type:"error",error:S}),(b=(y=ee(this,mi).config).onError)==null||b.call(y,S,this),(j=(x=ee(this,mi).config).onSettled)==null||j.call(x,this.state.data,S,this),S}finally{this.scheduleGc()}}},Oc=new WeakMap,ku=new WeakMap,mi=new WeakMap,Rc=new WeakMap,Gr=new WeakMap,ep=new WeakMap,Nc=new WeakMap,Hi=new WeakSet,Ys=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ND(n.data,this.options),fetchMeta:t.meta??null};case"success":const i={...n,...NC(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Oe(this,ku,t.manual?i:void 0),i;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Nr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),ee(this,mi).notify({query:this,type:"updated",action:t})})},u3);function ND(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:MD(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function NC(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function zC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var da,mt,tp,Vn,zc,Su,ao,ul,rp,Cu,$u,Ic,Lc,hl,Eu,$t,Rf,hw,fw,pw,mw,gw,xw,vw,zD,h3,MN=(h3=class extends th{constructor(t,r){super();He(this,$t);He(this,da);He(this,mt);He(this,tp);He(this,Vn);He(this,zc);He(this,Su);He(this,ao);He(this,ul);He(this,rp);He(this,Cu);He(this,$u);He(this,Ic);He(this,Lc);He(this,hl);He(this,Eu,new Set);this.options=r,Oe(this,da,t),Oe(this,ul,null),Oe(this,ao,dw()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ee(this,mt).addObserver(this),IC(ee(this,mt),this.options)?nt(this,$t,Rf).call(this):this.updateResult(),nt(this,$t,mw).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return _w(ee(this,mt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return _w(ee(this,mt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,nt(this,$t,gw).call(this),nt(this,$t,xw).call(this),ee(this,mt).removeObserver(this)}setOptions(t){const r=this.options,n=ee(this,mt);if(this.options=ee(this,da).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xi(this.options.enabled,ee(this,mt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");nt(this,$t,vw).call(this),ee(this,mt).setOptions(this.options),r._defaulted&&!Qx(this.options,r)&&ee(this,da).getQueryCache().notify({type:"observerOptionsUpdated",query:ee(this,mt),observer:this});const i=this.hasListeners();i&&LC(ee(this,mt),n,this.options,r)&&nt(this,$t,Rf).call(this),this.updateResult(),i&&(ee(this,mt)!==n||xi(this.options.enabled,ee(this,mt))!==xi(r.enabled,ee(this,mt))||Dl(this.options.staleTime,ee(this,mt))!==Dl(r.staleTime,ee(this,mt)))&&nt(this,$t,hw).call(this);const s=nt(this,$t,fw).call(this);i&&(ee(this,mt)!==n||xi(this.options.enabled,ee(this,mt))!==xi(r.enabled,ee(this,mt))||s!==ee(this,hl))&&nt(this,$t,pw).call(this,s)}getOptimisticResult(t){const r=ee(this,da).getQueryCache().build(ee(this,da),t),n=this.createResult(r,t);return RN(this,n)&&(Oe(this,Vn,n),Oe(this,Su,this.options),Oe(this,zc,ee(this,mt).state)),n}getCurrentResult(){return ee(this,Vn)}trackResult(t,r){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),r==null||r(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&ee(this,ao).status==="pending"&&ee(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){ee(this,Eu).add(t)}getCurrentQuery(){return ee(this,mt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=ee(this,da).defaultQueryOptions(t),n=ee(this,da).getQueryCache().build(ee(this,da),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return nt(this,$t,Rf).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ee(this,Vn)))}createResult(t,r){var M;const n=ee(this,mt),i=this.options,s=ee(this,Vn),o=ee(this,zc),l=ee(this,Su),u=t!==n?t.state:ee(this,tp),{state:h}=t;let f={...h},m=!1,_;if(r._optimisticResults){const A=this.hasListeners(),D=!A&&IC(t,r),H=A&&LC(t,n,r,i);(D||H)&&(f={...f,...ND(h.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:g,errorUpdatedAt:v,status:y}=f;_=f.data;let b=!1;if(r.placeholderData!==void 0&&_===void 0&&y==="pending"){let A;s!=null&&s.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(A=s.data,b=!0):A=typeof r.placeholderData=="function"?r.placeholderData((M=ee(this,$u))==null?void 0:M.state.data,ee(this,$u)):r.placeholderData,A!==void 0&&(y="success",_=cw(s==null?void 0:s.data,A,r),m=!0)}if(r.select&&_!==void 0&&!b)if(s&&_===(o==null?void 0:o.data)&&r.select===ee(this,rp))_=ee(this,Cu);else try{Oe(this,rp,r.select),_=r.select(_),_=cw(s==null?void 0:s.data,_,r),Oe(this,Cu,_),Oe(this,ul,null)}catch(A){Oe(this,ul,A)}ee(this,ul)&&(g=ee(this,ul),_=ee(this,Cu),v=Date.now(),y="error");const x=f.fetchStatus==="fetching",j=y==="pending",S=y==="error",T=j&&x,F=_!==void 0,P={status:y,fetchStatus:f.fetchStatus,isPending:j,isSuccess:y==="success",isError:S,isInitialLoading:T,isLoading:T,data:_,dataUpdatedAt:f.dataUpdatedAt,error:g,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:x,isRefetching:x&&!j,isLoadingError:S&&!F,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:S&&F,isStale:sk(t,r),refetch:this.refetch,promise:ee(this,ao),isEnabled:xi(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const A=U=>{P.status==="error"?U.reject(P.error):P.data!==void 0&&U.resolve(P.data)},D=()=>{const U=Oe(this,ao,P.promise=dw());A(U)},H=ee(this,ao);switch(H.status){case"pending":t.queryHash===n.queryHash&&A(H);break;case"fulfilled":(P.status==="error"||P.data!==H.value)&&D();break;case"rejected":(P.status!=="error"||P.error!==H.reason)&&D();break}}return P}updateResult(){const t=ee(this,Vn),r=this.createResult(ee(this,mt),this.options);if(Oe(this,zc,ee(this,mt).state),Oe(this,Su,this.options),ee(this,zc).data!==void 0&&Oe(this,$u,ee(this,mt)),Qx(r,t))return;Oe(this,Vn,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!ee(this,Eu).size)return!0;const o=new Set(s??ee(this,Eu));return this.options.throwOnError&&o.add("error"),Object.keys(ee(this,Vn)).some(l=>{const c=l;return ee(this,Vn)[c]!==t[c]&&o.has(c)})};nt(this,$t,zD).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&nt(this,$t,mw).call(this)}},da=new WeakMap,mt=new WeakMap,tp=new WeakMap,Vn=new WeakMap,zc=new WeakMap,Su=new WeakMap,ao=new WeakMap,ul=new WeakMap,rp=new WeakMap,Cu=new WeakMap,$u=new WeakMap,Ic=new WeakMap,Lc=new WeakMap,hl=new WeakMap,Eu=new WeakMap,$t=new WeakSet,Rf=function(t){nt(this,$t,vw).call(this);let r=ee(this,mt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(Gn)),r},hw=function(){nt(this,$t,gw).call(this);const t=Dl(this.options.staleTime,ee(this,mt));if(nd||ee(this,Vn).isStale||!ow(t))return;const n=AD(ee(this,Vn).dataUpdatedAt,t)+1;Oe(this,Ic,Ec.setTimeout(()=>{ee(this,Vn).isStale||this.updateResult()},n))},fw=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ee(this,mt)):this.options.refetchInterval)??!1},pw=function(t){nt(this,$t,xw).call(this),Oe(this,hl,t),!(nd||xi(this.options.enabled,ee(this,mt))===!1||!ow(ee(this,hl))||ee(this,hl)===0)&&Oe(this,Lc,Ec.setInterval(()=>{(this.options.refetchIntervalInBackground||ik.isFocused())&&nt(this,$t,Rf).call(this)},ee(this,hl)))},mw=function(){nt(this,$t,hw).call(this),nt(this,$t,pw).call(this,nt(this,$t,fw).call(this))},gw=function(){ee(this,Ic)&&(Ec.clearTimeout(ee(this,Ic)),Oe(this,Ic,void 0))},xw=function(){ee(this,Lc)&&(Ec.clearInterval(ee(this,Lc)),Oe(this,Lc,void 0))},vw=function(){const t=ee(this,da).getQueryCache().build(ee(this,da),this.options);if(t===ee(this,mt))return;const r=ee(this,mt);Oe(this,mt,t),Oe(this,tp,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},zD=function(t){Nr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(ee(this,Vn))}),ee(this,da).getQueryCache().notify({query:ee(this,mt),type:"observerResultsUpdated"})})},h3);function ON(e,t){return xi(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function IC(e,t){return ON(e,t)||e.state.data!==void 0&&_w(e,t,t.refetchOnMount)}function _w(e,t,r){if(xi(t.enabled,e)!==!1&&Dl(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&sk(e,t)}return!1}function LC(e,t,r,n){return(e!==t||xi(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&sk(e,r)}function sk(e,t){return xi(t.enabled,e)!==!1&&e.isStaleByTime(Dl(t.staleTime,e))}function RN(e,t){return!Qx(e.getCurrentResult(),t)}function BC(e){return{onFetch:(t,r)=>{var h,f,m,_,g;const n=t.options,i=(m=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:m.direction,s=((_=t.state.data)==null?void 0:_.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const y=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},b=DD(t.options,t.fetchOptions),x=async(j,S,T)=>{if(v)return Promise.reject();if(S==null&&j.pages.length)return Promise.resolve(j);const w=(()=>{const D={client:t.client,queryKey:t.queryKey,pageParam:S,direction:T?"backward":"forward",meta:t.options.meta};return y(D),D})(),P=await b(w),{maxPages:M}=t.options,A=T?$N:CN;return{pages:A(j.pages,P,M),pageParams:A(j.pageParams,S,M)}};if(i&&s.length){const j=i==="backward",S=j?NN:UC,T={pages:s,pageParams:o},F=S(n,T);l=await x(T,F,j)}else{const j=e??s.length;do{const S=c===0?o[0]??n.initialPageParam:UC(n,l);if(c>0&&S==null)break;l=await x(l,S),c++}while(c<j)}return l};t.options.persister?t.fetchFn=()=>{var v,y;return(y=(v=t.options).persister)==null?void 0:y.call(v,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function UC(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function NN(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var np,ws,Hn,Bc,ks,el,f3,zN=(f3=class extends RD{constructor(t){super();He(this,ks);He(this,np);He(this,ws);He(this,Hn);He(this,Bc);Oe(this,np,t.client),this.mutationId=t.mutationId,Oe(this,Hn,t.mutationCache),Oe(this,ws,[]),this.state=t.state||ID(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ee(this,ws).includes(t)||(ee(this,ws).push(t),this.clearGcTimeout(),ee(this,Hn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Oe(this,ws,ee(this,ws).filter(r=>r!==t)),this.scheduleGc(),ee(this,Hn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ee(this,ws).length||(this.state.status==="pending"?this.scheduleGc():ee(this,Hn).remove(this))}continue(){var t;return((t=ee(this,Bc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,u,h,f,m,_,g,v,y,b,x,j,S,T,F,w,P,M;const r=()=>{nt(this,ks,el).call(this,{type:"continue"})},n={client:ee(this,np),meta:this.options.meta,mutationKey:this.options.mutationKey};Oe(this,Bc,OD({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(A,D)=>{nt(this,ks,el).call(this,{type:"failed",failureCount:A,error:D})},onPause:()=>{nt(this,ks,el).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ee(this,Hn).canRun(this)}));const i=this.state.status==="pending",s=!ee(this,Bc).canStart();try{if(i)r();else{nt(this,ks,el).call(this,{type:"pending",variables:t,isPaused:s}),await((l=(o=ee(this,Hn).config).onMutate)==null?void 0:l.call(o,t,this,n));const D=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,n));D!==this.state.context&&nt(this,ks,el).call(this,{type:"pending",context:D,variables:t,isPaused:s})}const A=await ee(this,Bc).start();return await((f=(h=ee(this,Hn).config).onSuccess)==null?void 0:f.call(h,A,t,this.state.context,this,n)),await((_=(m=this.options).onSuccess)==null?void 0:_.call(m,A,t,this.state.context,n)),await((v=(g=ee(this,Hn).config).onSettled)==null?void 0:v.call(g,A,null,this.state.variables,this.state.context,this,n)),await((b=(y=this.options).onSettled)==null?void 0:b.call(y,A,null,t,this.state.context,n)),nt(this,ks,el).call(this,{type:"success",data:A}),A}catch(A){try{throw await((j=(x=ee(this,Hn).config).onError)==null?void 0:j.call(x,A,t,this.state.context,this,n)),await((T=(S=this.options).onError)==null?void 0:T.call(S,A,t,this.state.context,n)),await((w=(F=ee(this,Hn).config).onSettled)==null?void 0:w.call(F,void 0,A,this.state.variables,this.state.context,this,n)),await((M=(P=this.options).onSettled)==null?void 0:M.call(P,void 0,A,t,this.state.context,n)),A}finally{nt(this,ks,el).call(this,{type:"error",error:A})}}finally{ee(this,Hn).runNext(this)}}},np=new WeakMap,ws=new WeakMap,Hn=new WeakMap,Bc=new WeakMap,ks=new WeakSet,el=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Nr.batch(()=>{ee(this,ws).forEach(n=>{n.onMutationUpdate(t)}),ee(this,Hn).notify({mutation:this,type:"updated",action:t})})},f3);function ID(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var io,Wi,ap,p3,IN=(p3=class extends th{constructor(t={}){super();He(this,io);He(this,Wi);He(this,ap);this.config=t,Oe(this,io,new Set),Oe(this,Wi,new Map),Oe(this,ap,0)}build(t,r,n){const i=new zN({client:t,mutationCache:this,mutationId:++Ep(this,ap)._,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){ee(this,io).add(t);const r=Gp(t);if(typeof r=="string"){const n=ee(this,Wi).get(r);n?n.push(t):ee(this,Wi).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ee(this,io).delete(t)){const r=Gp(t);if(typeof r=="string"){const n=ee(this,Wi).get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&ee(this,Wi).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Gp(t);if(typeof r=="string"){const n=ee(this,Wi).get(r),i=n==null?void 0:n.find(s=>s.state.status==="pending");return!i||i===t}else return!0}runNext(t){var n;const r=Gp(t);if(typeof r=="string"){const i=(n=ee(this,Wi).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Nr.batch(()=>{ee(this,io).forEach(t=>{this.notify({type:"removed",mutation:t})}),ee(this,io).clear(),ee(this,Wi).clear()})}getAll(){return Array.from(ee(this,io))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>MC(r,n))}findAll(t={}){return this.getAll().filter(r=>MC(t,r))}notify(t){Nr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Nr.batch(()=>Promise.all(t.map(r=>r.continue().catch(Gn))))}},io=new WeakMap,Wi=new WeakMap,ap=new WeakMap,p3);function Gp(e){var t;return(t=e.options.scope)==null?void 0:t.id}var so,fl,ua,oo,_o,fx,yw,m3,LN=(m3=class extends th{constructor(r,n){super();He(this,_o);He(this,so);He(this,fl);He(this,ua);He(this,oo);Oe(this,so,r),this.setOptions(n),this.bindMethods(),nt(this,_o,fx).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=ee(this,so).defaultMutationOptions(r),Qx(this.options,n)||ee(this,so).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ee(this,ua),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ad(n.mutationKey)!==ad(this.options.mutationKey)?this.reset():((i=ee(this,ua))==null?void 0:i.state.status)==="pending"&&ee(this,ua).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=ee(this,ua))==null||r.removeObserver(this)}onMutationUpdate(r){nt(this,_o,fx).call(this),nt(this,_o,yw).call(this,r)}getCurrentResult(){return ee(this,fl)}reset(){var r;(r=ee(this,ua))==null||r.removeObserver(this),Oe(this,ua,void 0),nt(this,_o,fx).call(this),nt(this,_o,yw).call(this)}mutate(r,n){var i;return Oe(this,oo,n),(i=ee(this,ua))==null||i.removeObserver(this),Oe(this,ua,ee(this,so).getMutationCache().build(ee(this,so),this.options)),ee(this,ua).addObserver(this),ee(this,ua).execute(r)}},so=new WeakMap,fl=new WeakMap,ua=new WeakMap,oo=new WeakMap,_o=new WeakSet,fx=function(){var n;const r=((n=ee(this,ua))==null?void 0:n.state)??ID();Oe(this,fl,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},yw=function(r){Nr.batch(()=>{var n,i,s,o,l,c,u,h;if(ee(this,oo)&&this.hasListeners()){const f=ee(this,fl).variables,m=ee(this,fl).context,_={client:ee(this,so),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((i=(n=ee(this,oo)).onSuccess)==null||i.call(n,r.data,f,m,_),(o=(s=ee(this,oo)).onSettled)==null||o.call(s,r.data,null,f,m,_)):(r==null?void 0:r.type)==="error"&&((c=(l=ee(this,oo)).onError)==null||c.call(l,r.error,f,m,_),(h=(u=ee(this,oo)).onSettled)==null||h.call(u,void 0,r.error,f,m,_))}this.listeners.forEach(f=>{f(ee(this,fl))})})},m3),Ss,g3,BN=(g3=class extends th{constructor(t={}){super();He(this,Ss);this.config=t,Oe(this,Ss,new Map)}build(t,r,n){const i=r.queryKey,s=r.queryHash??nk(i,r);let o=this.get(s);return o||(o=new PN({client:t,queryKey:i,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(o)),o}add(t){ee(this,Ss).has(t.queryHash)||(ee(this,Ss).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ee(this,Ss).get(t.queryHash);r&&(t.destroy(),r===t&&ee(this,Ss).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Nr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ee(this,Ss).get(t)}getAll(){return[...ee(this,Ss).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>PC(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>PC(t,n)):r}notify(t){Nr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Nr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Nr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ss=new WeakMap,g3),cr,pl,ml,Tu,Au,gl,Fu,Du,x3,UN=(x3=class{constructor(e={}){He(this,cr);He(this,pl);He(this,ml);He(this,Tu);He(this,Au);He(this,gl);He(this,Fu);He(this,Du);Oe(this,cr,e.queryCache||new BN),Oe(this,pl,e.mutationCache||new IN),Oe(this,ml,e.defaultOptions||{}),Oe(this,Tu,new Map),Oe(this,Au,new Map),Oe(this,gl,0)}mount(){Ep(this,gl)._++,ee(this,gl)===1&&(Oe(this,Fu,ik.subscribe(async e=>{e&&(await this.resumePausedMutations(),ee(this,cr).onFocus())})),Oe(this,Du,Jx.subscribe(async e=>{e&&(await this.resumePausedMutations(),ee(this,cr).onOnline())})))}unmount(){var e,t;Ep(this,gl)._--,ee(this,gl)===0&&((e=ee(this,Fu))==null||e.call(this),Oe(this,Fu,void 0),(t=ee(this,Du))==null||t.call(this),Oe(this,Du,void 0))}isFetching(e){return ee(this,cr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ee(this,pl).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ee(this,cr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ee(this,cr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Dl(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return ee(this,cr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),i=ee(this,cr).get(n.queryHash),s=i==null?void 0:i.state.data,o=wN(t,s);if(o!==void 0)return ee(this,cr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Nr.batch(()=>ee(this,cr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ee(this,cr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ee(this,cr);Nr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ee(this,cr);return Nr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Nr.batch(()=>ee(this,cr).findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(Gn).catch(Gn)}invalidateQueries(e,t={}){return Nr.batch(()=>(ee(this,cr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Nr.batch(()=>ee(this,cr).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch(Gn)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(Gn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ee(this,cr).build(this,t);return r.isStaleByTime(Dl(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Gn).catch(Gn)}fetchInfiniteQuery(e){return e.behavior=BC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Gn).catch(Gn)}ensureInfiniteQueryData(e){return e.behavior=BC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Jx.isOnline()?ee(this,pl).resumePausedMutations():Promise.resolve()}getQueryCache(){return ee(this,cr)}getMutationCache(){return ee(this,pl)}getDefaultOptions(){return ee(this,ml)}setDefaultOptions(e){Oe(this,ml,e)}setQueryDefaults(e,t){ee(this,Tu).set(ad(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ee(this,Tu).values()],r={};return t.forEach(n=>{A0(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){ee(this,Au).set(ad(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ee(this,Au).values()],r={};return t.forEach(n=>{A0(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ee(this,ml).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=nk(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ak&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ee(this,ml).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ee(this,cr).clear(),ee(this,pl).clear()}},cr=new WeakMap,pl=new WeakMap,ml=new WeakMap,Tu=new WeakMap,Au=new WeakMap,gl=new WeakMap,Fu=new WeakMap,Du=new WeakMap,x3),LD=C.createContext(void 0),Pr=e=>{const t=C.useContext(LD);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},VN=({client:e,children:t})=>(C.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(LD.Provider,{value:e,children:t})),BD=C.createContext(!1),HN=()=>C.useContext(BD);BD.Provider;function WN(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var GN=C.createContext(WN()),qN=()=>C.useContext(GN),KN=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},XN=e=>{C.useEffect(()=>{e.clearReset()},[e])},YN=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&e.data===void 0||PD(r,[e.error,n])),QN=e=>{if(e.suspense){const r=i=>i==="static"?i:Math.max(i??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...i)=>r(n(...i)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},JN=(e,t)=>e.isLoading&&e.isFetching&&!t,ZN=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,VC=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function ez(e,t,r){var f,m,_,g,v;const n=HN(),i=qN(),s=Pr(),o=s.defaultQueryOptions(e);(m=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||m.call(f,o),o._optimisticResults=n?"isRestoring":"optimistic",QN(o),KN(o,i),XN(i);const l=!s.getQueryCache().get(o.queryHash),[c]=C.useState(()=>new t(s,o)),u=c.getOptimisticResult(o),h=!n&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(y=>{const b=h?c.subscribe(Nr.batchCalls(y)):Gn;return c.updateResult(),b},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),C.useEffect(()=>{c.setOptions(o)},[o,c]),ZN(o,u))throw VC(o,c,i);if(YN({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((g=(_=s.getDefaultOptions().queries)==null?void 0:_._experimental_afterQuery)==null||g.call(_,o,u),o.experimental_prefetchInRender&&!nd&&JN(u,n)){const y=l?VC(o,c,i):(v=s.getQueryCache().get(o.queryHash))==null?void 0:v.promise;y==null||y.catch(Gn).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function Nt(e,t){return ez(e,MN)}function jt(e,t){const r=Pr(),[n]=C.useState(()=>new LN(r,e));C.useEffect(()=>{n.setOptions(e)},[n,e]);const i=C.useSyncExternalStore(C.useCallback(o=>n.subscribe(Nr.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=C.useCallback((o,l)=>{n.mutate(o,l).catch(Gn)},[n]);if(i.error&&PD(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}var En=function(){return En=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},En.apply(this,arguments)};function Lu(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Vt="-ms-",Zf="-moz-",St="-webkit-",UD="comm",H1="rule",ok="decl",tz="@import",VD="@keyframes",rz="@layer",HD=Math.abs,lk=String.fromCharCode,bw=Object.assign;function nz(e,t){return Xr(e,0)^45?(((t<<2^Xr(e,0))<<2^Xr(e,1))<<2^Xr(e,2))<<2^Xr(e,3):0}function WD(e){return e.trim()}function eo(e,t){return(e=t.exec(e))?e[0]:e}function at(e,t,r){return e.replace(t,r)}function px(e,t,r){return e.indexOf(t,r)}function Xr(e,t){return e.charCodeAt(t)|0}function Bu(e,t,r){return e.slice(t,r)}function Cs(e){return e.length}function GD(e){return e.length}function Nf(e,t){return t.push(e),e}function az(e,t){return e.map(t).join("")}function HC(e,t){return e.filter(function(r){return!eo(r,t)})}var W1=1,Uu=1,qD=0,$i=0,Ar=0,rh="";function G1(e,t,r,n,i,s,o,l){return{value:e,root:t,parent:r,type:n,props:i,children:s,line:W1,column:Uu,length:o,return:"",siblings:l}}function tl(e,t){return bw(G1("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function Ed(e){for(;e.root;)e=tl(e.root,{children:[e]});Nf(e,e.siblings)}function iz(){return Ar}function sz(){return Ar=$i>0?Xr(rh,--$i):0,Uu--,Ar===10&&(Uu=1,W1--),Ar}function Ji(){return Ar=$i<qD?Xr(rh,$i++):0,Uu++,Ar===10&&(Uu=1,W1++),Ar}function Hc(){return Xr(rh,$i)}function mx(){return $i}function q1(e,t){return Bu(rh,e,t)}function jw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function oz(e){return W1=Uu=1,qD=Cs(rh=e),$i=0,[]}function lz(e){return rh="",e}function Gv(e){return WD(q1($i-1,ww(e===91?e+2:e===40?e+1:e)))}function cz(e){for(;(Ar=Hc())&&Ar<33;)Ji();return jw(e)>2||jw(Ar)>3?"":" "}function dz(e,t){for(;--t&&Ji()&&!(Ar<48||Ar>102||Ar>57&&Ar<65||Ar>70&&Ar<97););return q1(e,mx()+(t<6&&Hc()==32&&Ji()==32))}function ww(e){for(;Ji();)switch(Ar){case e:return $i;case 34:case 39:e!==34&&e!==39&&ww(Ar);break;case 40:e===41&&ww(e);break;case 92:Ji();break}return $i}function uz(e,t){for(;Ji()&&e+Ar!==57;)if(e+Ar===84&&Hc()===47)break;return"/*"+q1(t,$i-1)+"*"+lk(e===47?e:Ji())}function hz(e){for(;!jw(Hc());)Ji();return q1(e,$i)}function fz(e){return lz(gx("",null,null,null,[""],e=oz(e),0,[0],e))}function gx(e,t,r,n,i,s,o,l,c){for(var u=0,h=0,f=o,m=0,_=0,g=0,v=1,y=1,b=1,x=0,j="",S=i,T=s,F=n,w=j;y;)switch(g=x,x=Ji()){case 40:if(g!=108&&Xr(w,f-1)==58){px(w+=at(Gv(x),"&","&\f"),"&\f",HD(u?l[u-1]:0))!=-1&&(b=-1);break}case 34:case 39:case 91:w+=Gv(x);break;case 9:case 10:case 13:case 32:w+=cz(g);break;case 92:w+=dz(mx()-1,7);continue;case 47:switch(Hc()){case 42:case 47:Nf(pz(uz(Ji(),mx()),t,r,c),c);break;default:w+="/"}break;case 123*v:l[u++]=Cs(w)*b;case 125*v:case 59:case 0:switch(x){case 0:case 125:y=0;case 59+h:b==-1&&(w=at(w,/\f/g,"")),_>0&&Cs(w)-f&&Nf(_>32?GC(w+";",n,r,f-1,c):GC(at(w," ","")+";",n,r,f-2,c),c);break;case 59:w+=";";default:if(Nf(F=WC(w,t,r,u,h,i,l,j,S=[],T=[],f,s),s),x===123)if(h===0)gx(w,t,F,F,S,s,f,l,T);else switch(m===99&&Xr(w,3)===110?100:m){case 100:case 108:case 109:case 115:gx(e,F,F,n&&Nf(WC(e,F,F,0,0,i,l,j,i,S=[],f,T),T),i,T,f,l,n?S:T);break;default:gx(w,F,F,F,[""],T,0,l,T)}}u=h=_=0,v=b=1,j=w="",f=o;break;case 58:f=1+Cs(w),_=g;default:if(v<1){if(x==123)--v;else if(x==125&&v++==0&&sz()==125)continue}switch(w+=lk(x),x*v){case 38:b=h>0?1:(w+="\f",-1);break;case 44:l[u++]=(Cs(w)-1)*b,b=1;break;case 64:Hc()===45&&(w+=Gv(Ji())),m=Hc(),h=f=Cs(j=w+=hz(mx())),x++;break;case 45:g===45&&Cs(w)==2&&(v=0)}}return s}function WC(e,t,r,n,i,s,o,l,c,u,h,f){for(var m=i-1,_=i===0?s:[""],g=GD(_),v=0,y=0,b=0;v<n;++v)for(var x=0,j=Bu(e,m+1,m=HD(y=o[v])),S=e;x<g;++x)(S=WD(y>0?_[x]+" "+j:at(j,/&\f/g,_[x])))&&(c[b++]=S);return G1(e,t,r,i===0?H1:l,c,u,h,f)}function pz(e,t,r,n){return G1(e,t,r,UD,lk(iz()),Bu(e,2,-2),0,n)}function GC(e,t,r,n,i){return G1(e,t,r,ok,Bu(e,0,n),Bu(e,n+1,-1),n,i)}function KD(e,t,r){switch(nz(e,t)){case 5103:return St+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return St+e+e;case 4789:return Zf+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return St+e+Zf+e+Vt+e+e;case 5936:switch(Xr(e,t+11)){case 114:return St+e+Vt+at(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return St+e+Vt+at(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return St+e+Vt+at(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return St+e+Vt+e+e;case 6165:return St+e+Vt+"flex-"+e+e;case 5187:return St+e+at(e,/(\w+).+(:[^]+)/,St+"box-$1$2"+Vt+"flex-$1$2")+e;case 5443:return St+e+Vt+"flex-item-"+at(e,/flex-|-self/g,"")+(eo(e,/flex-|baseline/)?"":Vt+"grid-row-"+at(e,/flex-|-self/g,""))+e;case 4675:return St+e+Vt+"flex-line-pack"+at(e,/align-content|flex-|-self/g,"")+e;case 5548:return St+e+Vt+at(e,"shrink","negative")+e;case 5292:return St+e+Vt+at(e,"basis","preferred-size")+e;case 6060:return St+"box-"+at(e,"-grow","")+St+e+Vt+at(e,"grow","positive")+e;case 4554:return St+at(e,/([^-])(transform)/g,"$1"+St+"$2")+e;case 6187:return at(at(at(e,/(zoom-|grab)/,St+"$1"),/(image-set)/,St+"$1"),e,"")+e;case 5495:case 3959:return at(e,/(image-set\([^]*)/,St+"$1$`$1");case 4968:return at(at(e,/(.+:)(flex-)?(.*)/,St+"box-pack:$3"+Vt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+St+e+e;case 4200:if(!eo(e,/flex-|baseline/))return Vt+"grid-column-align"+Bu(e,t)+e;break;case 2592:case 3360:return Vt+at(e,"template-","")+e;case 4384:case 3616:return r&&r.some(function(n,i){return t=i,eo(n.props,/grid-\w+-end/)})?~px(e+(r=r[t].value),"span",0)?e:Vt+at(e,"-start","")+e+Vt+"grid-row-span:"+(~px(r,"span",0)?eo(r,/\d+/):+eo(r,/\d+/)-+eo(e,/\d+/))+";":Vt+at(e,"-start","")+e;case 4896:case 4128:return r&&r.some(function(n){return eo(n.props,/grid-\w+-start/)})?e:Vt+at(at(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return at(e,/(.+)-inline(.+)/,St+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Cs(e)-1-t>6)switch(Xr(e,t+1)){case 109:if(Xr(e,t+4)!==45)break;case 102:return at(e,/(.+:)(.+)-([^]+)/,"$1"+St+"$2-$3$1"+Zf+(Xr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~px(e,"stretch",0)?KD(at(e,"stretch","fill-available"),t,r)+e:e}break;case 5152:case 5920:return at(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,i,s,o,l,c,u){return Vt+i+":"+s+u+(o?Vt+i+"-span:"+(l?c:+c-+s)+u:"")+e});case 4949:if(Xr(e,t+6)===121)return at(e,":",":"+St)+e;break;case 6444:switch(Xr(e,Xr(e,14)===45?18:11)){case 120:return at(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+St+(Xr(e,14)===45?"inline-":"")+"box$3$1"+St+"$2$3$1"+Vt+"$2box$3")+e;case 100:return at(e,":",":"+Vt)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return at(e,"scroll-","scroll-snap-")+e}return e}function Zx(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function mz(e,t,r,n){switch(e.type){case rz:if(e.children.length)break;case tz:case ok:return e.return=e.return||e.value;case UD:return"";case VD:return e.return=e.value+"{"+Zx(e.children,n)+"}";case H1:if(!Cs(e.value=e.props.join(",")))return""}return Cs(r=Zx(e.children,n))?e.return=e.value+"{"+r+"}":""}function gz(e){var t=GD(e);return function(r,n,i,s){for(var o="",l=0;l<t;l++)o+=e[l](r,n,i,s)||"";return o}}function xz(e){return function(t){t.root||(t=t.return)&&e(t)}}function vz(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case ok:e.return=KD(e.value,e.length,r);return;case VD:return Zx([tl(e,{value:at(e.value,"@","@"+St)})],n);case H1:if(e.length)return az(r=e.props,function(i){switch(eo(i,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Ed(tl(e,{props:[at(i,/:(read-\w+)/,":"+Zf+"$1")]})),Ed(tl(e,{props:[i]})),bw(e,{props:HC(r,n)});break;case"::placeholder":Ed(tl(e,{props:[at(i,/:(plac\w+)/,":"+St+"input-$1")]})),Ed(tl(e,{props:[at(i,/:(plac\w+)/,":"+Zf+"$1")]})),Ed(tl(e,{props:[at(i,/:(plac\w+)/,Vt+"input-$1")]})),Ed(tl(e,{props:[i]})),bw(e,{props:HC(r,n)});break}return""})}}var _z={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Fa={},Vu=typeof process<"u"&&Fa!==void 0&&(Fa.REACT_APP_SC_ATTR||Fa.SC_ATTR)||"data-styled",XD="active",YD="data-styled-version",K1="6.1.19",ck=`/*!sc*/
`,e1=typeof window<"u"&&typeof document<"u",yz=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Fa!==void 0&&Fa.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Fa.REACT_APP_SC_DISABLE_SPEEDY!==""?Fa.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Fa.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Fa!==void 0&&Fa.SC_DISABLE_SPEEDY!==void 0&&Fa.SC_DISABLE_SPEEDY!==""&&Fa.SC_DISABLE_SPEEDY!=="false"&&Fa.SC_DISABLE_SPEEDY),bz={},X1=Object.freeze([]),Hu=Object.freeze({});function QD(e,t,r){return r===void 0&&(r=Hu),e.theme!==r.theme&&e.theme||t||r.theme}var JD=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),jz=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,wz=/(^-|-$)/g;function qC(e){return e.replace(jz,"-").replace(wz,"")}var kz=/(a)(d)/gi,qp=52,KC=function(e){return String.fromCharCode(e+(e>25?39:97))};function kw(e){var t,r="";for(t=Math.abs(e);t>qp;t=t/qp|0)r=KC(t%qp)+r;return(KC(t%qp)+r).replace(kz,"$1-$2")}var qv,ZD=5381,su=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},eP=function(e){return su(ZD,e)};function dk(e){return kw(eP(e)>>>0)}function Sz(e){return e.displayName||e.name||"Component"}function Kv(e){return typeof e=="string"&&!0}var tP=typeof Symbol=="function"&&Symbol.for,rP=tP?Symbol.for("react.memo"):60115,Cz=tP?Symbol.for("react.forward_ref"):60112,$z={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ez={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},nP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Tz=((qv={})[Cz]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},qv[rP]=nP,qv);function XC(e){return("type"in(t=e)&&t.type.$$typeof)===rP?nP:"$$typeof"in e?Tz[e.$$typeof]:$z;var t}var Az=Object.defineProperty,Fz=Object.getOwnPropertyNames,YC=Object.getOwnPropertySymbols,Dz=Object.getOwnPropertyDescriptor,Pz=Object.getPrototypeOf,QC=Object.prototype;function aP(e,t,r){if(typeof t!="string"){if(QC){var n=Pz(t);n&&n!==QC&&aP(e,n,r)}var i=Fz(t);YC&&(i=i.concat(YC(t)));for(var s=XC(e),o=XC(t),l=0;l<i.length;++l){var c=i[l];if(!(c in Ez||r&&r[c]||o&&c in o||s&&c in s)){var u=Dz(t,c);try{Az(e,c,u)}catch{}}}}return e}function Wu(e){return typeof e=="function"}function uk(e){return typeof e=="object"&&"styledComponentId"in e}function Tc(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function t1(e,t){if(e.length===0)return"";for(var r=e[0],n=1;n<e.length;n++)r+=e[n];return r}function F0(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Sw(e,t,r){if(r===void 0&&(r=!1),!r&&!F0(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)e[n]=Sw(e[n],t[n]);else if(F0(t))for(var n in t)e[n]=Sw(e[n],t[n]);return e}function hk(e,t){Object.defineProperty(e,"toString",{value:t})}function dp(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Mz=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var r=0,n=0;n<t;n++)r+=this.groupSizes[n];return r},e.prototype.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var n=this.groupSizes,i=n.length,s=i;t>=s;)if((s<<=1)<0)throw dp(16,"".concat(t));this.groupSizes=new Uint32Array(s),this.groupSizes.set(n),this.length=s;for(var o=i;o<s;o++)this.groupSizes[o]=0}for(var l=this.indexOfGroup(t+1),c=(o=0,r.length);o<c;o++)this.tag.insertRule(l,r[o])&&(this.groupSizes[t]++,l++)},e.prototype.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],n=this.indexOfGroup(t),i=n+r;this.groupSizes[t]=0;for(var s=n;s<i;s++)this.tag.deleteRule(n)}},e.prototype.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var n=this.groupSizes[t],i=this.indexOfGroup(t),s=i+n,o=i;o<s;o++)r+="".concat(this.tag.getRule(o)).concat(ck);return r},e}(),xx=new Map,r1=new Map,vx=1,Kp=function(e){if(xx.has(e))return xx.get(e);for(;r1.has(vx);)vx++;var t=vx++;return xx.set(e,t),r1.set(t,e),t},Oz=function(e,t){vx=t+1,xx.set(e,t),r1.set(t,e)},Rz="style[".concat(Vu,"][").concat(YD,'="').concat(K1,'"]'),Nz=new RegExp("^".concat(Vu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),zz=function(e,t,r){for(var n,i=r.split(","),s=0,o=i.length;s<o;s++)(n=i[s])&&e.registerName(t,n)},Iz=function(e,t){for(var r,n=((r=t.textContent)!==null&&r!==void 0?r:"").split(ck),i=[],s=0,o=n.length;s<o;s++){var l=n[s].trim();if(l){var c=l.match(Nz);if(c){var u=0|parseInt(c[1],10),h=c[2];u!==0&&(Oz(h,u),zz(e,h,c[3]),e.getTag().insertRules(u,i)),i.length=0}else i.push(l)}}},JC=function(e){for(var t=document.querySelectorAll(Rz),r=0,n=t.length;r<n;r++){var i=t[r];i&&i.getAttribute(Vu)!==XD&&(Iz(e,i),i.parentNode&&i.parentNode.removeChild(i))}};function Lz(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var iP=function(e){var t=document.head,r=e||t,n=document.createElement("style"),i=function(l){var c=Array.from(l.querySelectorAll("style[".concat(Vu,"]")));return c[c.length-1]}(r),s=i!==void 0?i.nextSibling:null;n.setAttribute(Vu,XD),n.setAttribute(YD,K1);var o=Lz();return o&&n.setAttribute("nonce",o),r.insertBefore(n,s),n},Bz=function(){function e(t){this.element=iP(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var n=document.styleSheets,i=0,s=n.length;i<s;i++){var o=n[i];if(o.ownerNode===r)return o}throw dp(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var r=this.sheet.cssRules[t];return r&&r.cssText?r.cssText:""},e}(),Uz=function(){function e(t){this.element=iP(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,r){if(t<=this.length&&t>=0){var n=document.createTextNode(r);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),Vz=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),ZC=e1,Hz={isServer:!e1,useCSSOMInjection:!yz},n1=function(){function e(t,r,n){t===void 0&&(t=Hu),r===void 0&&(r={});var i=this;this.options=En(En({},Hz),t),this.gs=r,this.names=new Map(n),this.server=!!t.isServer,!this.server&&e1&&ZC&&(ZC=!1,JC(this)),hk(this,function(){return function(s){for(var o=s.getTag(),l=o.length,c="",u=function(f){var m=function(b){return r1.get(b)}(f);if(m===void 0)return"continue";var _=s.names.get(m),g=o.getGroup(f);if(_===void 0||!_.size||g.length===0)return"continue";var v="".concat(Vu,".g").concat(f,'[id="').concat(m,'"]'),y="";_!==void 0&&_.forEach(function(b){b.length>0&&(y+="".concat(b,","))}),c+="".concat(g).concat(v,'{content:"').concat(y,'"}').concat(ck)},h=0;h<l;h++)u(h);return c}(i)})}return e.registerId=function(t){return Kp(t)},e.prototype.rehydrate=function(){!this.server&&e1&&JC(this)},e.prototype.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new e(En(En({},this.options),t),this.gs,r&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(r){var n=r.useCSSOMInjection,i=r.target;return r.isServer?new Vz(i):n?new Bz(i):new Uz(i)}(this.options),new Mz(t)));var t},e.prototype.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.prototype.registerName=function(t,r){if(Kp(t),this.names.has(t))this.names.get(t).add(r);else{var n=new Set;n.add(r),this.names.set(t,n)}},e.prototype.insertRules=function(t,r,n){this.registerName(t,r),this.getTag().insertRules(Kp(t),n)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Kp(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),Wz=/&/g,Gz=/^\s*\/\/.*$/gm;function sP(e,t){return e.map(function(r){return r.type==="rule"&&(r.value="".concat(t," ").concat(r.value),r.value=r.value.replaceAll(",",",".concat(t," ")),r.props=r.props.map(function(n){return"".concat(t," ").concat(n)})),Array.isArray(r.children)&&r.type!=="@keyframes"&&(r.children=sP(r.children,t)),r})}function qz(e){var t,r,n,i=Hu,s=i.options,o=s===void 0?Hu:s,l=i.plugins,c=l===void 0?X1:l,u=function(m,_,g){return g.startsWith(r)&&g.endsWith(r)&&g.replaceAll(r,"").length>0?".".concat(t):m},h=c.slice();h.push(function(m){m.type===H1&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(Wz,r).replace(n,u))}),o.prefix&&h.push(vz),h.push(mz);var f=function(m,_,g,v){_===void 0&&(_=""),g===void 0&&(g=""),v===void 0&&(v="&"),t=v,r=_,n=new RegExp("\\".concat(r,"\\b"),"g");var y=m.replace(Gz,""),b=fz(g||_?"".concat(g," ").concat(_," { ").concat(y," }"):y);o.namespace&&(b=sP(b,o.namespace));var x=[];return Zx(b,gz(h.concat(xz(function(j){return x.push(j)})))),x};return f.hash=c.length?c.reduce(function(m,_){return _.name||dp(15),su(m,_.name)},ZD).toString():"",f}var Kz=new n1,Cw=qz(),oP=Es.createContext({shouldForwardProp:void 0,styleSheet:Kz,stylis:Cw});oP.Consumer;Es.createContext(void 0);function $w(){return C.useContext(oP)}var lP=function(){function e(t,r){var n=this;this.inject=function(i,s){s===void 0&&(s=Cw);var o=n.name+s.hash;i.hasNameForId(n.id,o)||i.insertRules(n.id,o,s(n.rules,o,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=r,hk(this,function(){throw dp(12,String(n.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=Cw),this.name+t.hash},e}(),Xz=function(e){return e>="A"&&e<="Z"};function e$(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(r===1&&n==="-"&&e[0]==="-")return e;Xz(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var cP=function(e){return e==null||e===!1||e===""},dP=function(e){var t,r,n=[];for(var i in e){var s=e[i];e.hasOwnProperty(i)&&!cP(s)&&(Array.isArray(s)&&s.isCss||Wu(s)?n.push("".concat(e$(i),":"),s,";"):F0(s)?n.push.apply(n,Lu(Lu(["".concat(i," {")],dP(s),!1),["}"],!1)):n.push("".concat(e$(i),": ").concat((t=i,(r=s)==null||typeof r=="boolean"||r===""?"":typeof r!="number"||r===0||t in _z||t.startsWith("--")?String(r).trim():"".concat(r,"px")),";")))}return n};function Pl(e,t,r,n){if(cP(e))return[];if(uk(e))return[".".concat(e.styledComponentId)];if(Wu(e)){if(!Wu(s=e)||s.prototype&&s.prototype.isReactComponent||!t)return[e];var i=e(t);return Pl(i,t,r,n)}var s;return e instanceof lP?r?(e.inject(r,n),[e.getName(n)]):[e]:F0(e)?dP(e):Array.isArray(e)?Array.prototype.concat.apply(X1,e.map(function(o){return Pl(o,t,r,n)})):[e.toString()]}function uP(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(Wu(r)&&!uk(r))return!1}return!0}var Yz=eP(K1),Qz=function(){function e(t,r,n){this.rules=t,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&uP(t),this.componentId=r,this.baseHash=su(Yz,r),this.baseStyle=n,n1.registerId(r)}return e.prototype.generateAndInjectStyles=function(t,r,n){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,r,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&r.hasNameForId(this.componentId,this.staticRulesId))i=Tc(i,this.staticRulesId);else{var s=t1(Pl(this.rules,t,r,n)),o=kw(su(this.baseHash,s)>>>0);if(!r.hasNameForId(this.componentId,o)){var l=n(s,".".concat(o),void 0,this.componentId);r.insertRules(this.componentId,o,l)}i=Tc(i,o),this.staticRulesId=o}else{for(var c=su(this.baseHash,n.hash),u="",h=0;h<this.rules.length;h++){var f=this.rules[h];if(typeof f=="string")u+=f;else if(f){var m=t1(Pl(f,t,r,n));c=su(c,m+h),u+=m}}if(u){var _=kw(c>>>0);r.hasNameForId(this.componentId,_)||r.insertRules(this.componentId,_,n(u,".".concat(_),void 0,this.componentId)),i=Tc(i,_)}}return i},e}(),fk=Es.createContext(void 0);fk.Consumer;var Xv={};function Jz(e,t,r){var n=uk(e),i=e,s=!Kv(e),o=t.attrs,l=o===void 0?X1:o,c=t.componentId,u=c===void 0?function(S,T){var F=typeof S!="string"?"sc":qC(S);Xv[F]=(Xv[F]||0)+1;var w="".concat(F,"-").concat(dk(K1+F+Xv[F]));return T?"".concat(T,"-").concat(w):w}(t.displayName,t.parentComponentId):c,h=t.displayName,f=h===void 0?function(S){return Kv(S)?"styled.".concat(S):"Styled(".concat(Sz(S),")")}(e):h,m=t.displayName&&t.componentId?"".concat(qC(t.displayName),"-").concat(t.componentId):t.componentId||u,_=n&&i.attrs?i.attrs.concat(l).filter(Boolean):l,g=t.shouldForwardProp;if(n&&i.shouldForwardProp){var v=i.shouldForwardProp;if(t.shouldForwardProp){var y=t.shouldForwardProp;g=function(S,T){return v(S,T)&&y(S,T)}}else g=v}var b=new Qz(r,m,n?i.componentStyle:void 0);function x(S,T){return function(F,w,P){var M=F.attrs,A=F.componentStyle,D=F.defaultProps,H=F.foldedComponentIds,U=F.styledComponentId,W=F.target,R=Es.useContext(fk),ae=$w(),le=F.shouldForwardProp||ae.shouldForwardProp,G=QD(w,R,D)||Hu,z=function(K,re,Z){for(var me,B=En(En({},re),{className:void 0,theme:Z}),se=0;se<K.length;se+=1){var we=Wu(me=K[se])?me(B):me;for(var V in we)B[V]=V==="className"?Tc(B[V],we[V]):V==="style"?En(En({},B[V]),we[V]):we[V]}return re.className&&(B.className=Tc(B.className,re.className)),B}(M,w,G),ie=z.as||W,ne={};for(var O in z)z[O]===void 0||O[0]==="$"||O==="as"||O==="theme"&&z.theme===G||(O==="forwardedAs"?ne.as=z.forwardedAs:le&&!le(O,ie)||(ne[O]=z[O]));var N=function(K,re){var Z=$w(),me=K.generateAndInjectStyles(re,Z.styleSheet,Z.stylis);return me}(A,z),L=Tc(H,U);return N&&(L+=" "+N),z.className&&(L+=" "+z.className),ne[Kv(ie)&&!JD.has(ie)?"class":"className"]=L,P&&(ne.ref=P),C.createElement(ie,ne)}(j,S,T)}x.displayName=f;var j=Es.forwardRef(x);return j.attrs=_,j.componentStyle=b,j.displayName=f,j.shouldForwardProp=g,j.foldedComponentIds=n?Tc(i.foldedComponentIds,i.styledComponentId):"",j.styledComponentId=m,j.target=n?i.target:e,Object.defineProperty(j,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(S){this._foldedDefaultProps=n?function(T){for(var F=[],w=1;w<arguments.length;w++)F[w-1]=arguments[w];for(var P=0,M=F;P<M.length;P++)Sw(T,M[P],!0);return T}({},i.defaultProps,S):S}}),hk(j,function(){return".".concat(j.styledComponentId)}),s&&aP(j,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),j}function t$(e,t){for(var r=[e[0]],n=0,i=t.length;n<i;n+=1)r.push(t[n],e[n+1]);return r}var r$=function(e){return Object.assign(e,{isCss:!0})};function Ia(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Wu(e)||F0(e))return r$(Pl(t$(X1,Lu([e],t,!0))));var n=e;return t.length===0&&n.length===1&&typeof n[0]=="string"?Pl(n):r$(Pl(t$(n,t)))}function Ew(e,t,r){if(r===void 0&&(r=Hu),!t)throw dp(1,t);var n=function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return e(t,r,Ia.apply(void 0,Lu([i],s,!1)))};return n.attrs=function(i){return Ew(e,t,En(En({},r),{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},n.withConfig=function(i){return Ew(e,t,En(En({},r),i))},n}var hP=function(e){return Ew(Jz,e)},p=hP;JD.forEach(function(e){p[e]=hP(e)});var Zz=function(){function e(t,r){this.rules=t,this.componentId=r,this.isStatic=uP(t),n1.registerId(this.componentId+1)}return e.prototype.createStyles=function(t,r,n,i){var s=i(t1(Pl(this.rules,r,n,i)),""),o=this.componentId+t;n.insertRules(o,o,s)},e.prototype.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.prototype.renderStyles=function(t,r,n,i){t>2&&n1.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,r,n,i)},e}();function eI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Ia.apply(void 0,Lu([e],t,!1)),i="sc-global-".concat(dk(JSON.stringify(n))),s=new Zz(n,i),o=function(c){var u=$w(),h=Es.useContext(fk),f=Es.useRef(u.styleSheet.allocateGSInstance(i)).current;return u.styleSheet.server&&l(f,c,u.styleSheet,h,u.stylis),Es.useLayoutEffect(function(){if(!u.styleSheet.server)return l(f,c,u.styleSheet,h,u.stylis),function(){return s.removeStyles(f,u.styleSheet)}},[f,c,u.styleSheet,h,u.stylis]),null};function l(c,u,h,f,m){if(s.isStatic)s.renderStyles(c,bz,h,m);else{var _=En(En({},u),{theme:QD(u,f,o.defaultProps)});s.renderStyles(c,_,h,m)}}return Es.memo(o)}function tI(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=t1(Ia.apply(void 0,Lu([e],t,!1))),i=dk(n);return new lP(i,n)}const rI={primary:"#003A81",primaryDark:"#002654",secondary:"#EC7126",accent:"#05C1CA",cardHeader:"#01214d",bgWhite:"#FFFFFF",bgLight:"#F2F2F2",bgMedium:"#E9ECEF",bgBlueLight:"#D1E3F8",success:"#28A745",warning:"#FFC107",danger:"#DC3545",error:"#DC3545",info:"#17A2B8",disabled:"#9E9E9E",textPrimary:"#212529",textSecondary:"#6C757D",textMuted:"#9E9E9E",textWhite:"#FFFFFF",link:"#003A81",linkHover:"#002654",border:"#dee2e6"},nI={fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",weights:{regular:400,medium:500,semibold:600,bold:700},sizes:{h1:"2rem",h2:"1.5rem",h3:"1.25rem",h4:"1rem",body:"0.875rem",small:"0.75rem",tiny:"0.625rem"},lineHeights:{tight:1.2,normal:1.5}},aI={xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem",xxl:"3rem"},iI={sm:"4px",md:"8px",lg:"12px",full:"50%"},sI={sm:"0 1px 3px rgba(0, 0, 0, 0.08)",md:"0 2px 8px rgba(0, 0, 0, 0.1)",lg:"0 4px 16px rgba(0, 0, 0, 0.12)"},oI={fast:"0.15s ease",normal:"0.2s ease"},d={colors:rI,typography:nI,spacing:aI,radius:iI,shadows:sI,transitions:oI},lI=eI`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
  }

  body {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
    font-weight: ${d.typography.weights.regular};
    line-height: ${d.typography.lineHeights.normal};
    color: ${d.colors.textPrimary};
    background-color: ${d.colors.bgLight};
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1, h2, h3, h4, h5, h6 {
    font-weight: ${d.typography.weights.semibold};
    line-height: ${d.typography.lineHeights.tight};
    color: ${d.colors.textPrimary};
    margin-bottom: ${d.spacing.md};
  }

  h1 { font-size: ${d.typography.sizes.h1}; }
  h2 { font-size: ${d.typography.sizes.h2}; }
  h3 { font-size: ${d.typography.sizes.h3}; }
  h4 { font-size: ${d.typography.sizes.h4}; }

  a {
    color: ${d.colors.link};
    text-decoration: none;
    transition: color ${d.transitions.fast};

    &:hover {
      color: ${d.colors.linkHover};
    }
  }

  button {
    font-family: ${d.typography.fontFamily};
    cursor: pointer;
  }

  input, select, textarea {
    font-family: ${d.typography.fontFamily};
    font-size: ${d.typography.sizes.body};
  }

  #root {
    min-height: 100vh;
  }
`,cI={primary:Ia`
    background-color: ${d.colors.primary};
    border-color: ${d.colors.primary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: ${d.colors.linkHover};
      border-color: ${d.colors.linkHover};
    }
  `,secondary:Ia`
    background-color: ${d.colors.secondary};
    border-color: ${d.colors.secondary};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #d4631f;
      border-color: #d4631f;
    }
  `,outline:Ia`
    background-color: transparent;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};

    &:hover:not(:disabled) {
      background-color: ${d.colors.primary};
      color: ${d.colors.textWhite};
    }
  `,danger:Ia`
    background-color: ${d.colors.danger};
    border-color: ${d.colors.danger};
    color: ${d.colors.textWhite};

    &:hover:not(:disabled) {
      background-color: #c82333;
      border-color: #c82333;
    }
  `},dI={sm:Ia`
    padding: 0.375rem 0.75rem;
    font-size: ${d.typography.sizes.small};
  `,md:Ia`
    padding: 0.5rem 1.25rem;
    font-size: ${d.typography.sizes.body};
  `,lg:Ia`
    padding: 0.75rem 1.5rem;
    font-size: ${d.typography.sizes.h4};
  `},uI=p.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: ${d.spacing.xs};
  font-family: ${d.typography.fontFamily};
  font-weight: ${d.typography.weights.medium};
  border: 2px solid;
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};

  ${({$variant:e="primary"})=>cI[e]}
  ${({$size:e="md"})=>dI[e]}
  ${({$fullWidth:e})=>e&&Ia`width: 100%;`}

  &:disabled {
    background-color: ${d.colors.disabled};
    border-color: ${d.colors.disabled};
    color: ${d.colors.textWhite};
    cursor: not-allowed;
    opacity: 0.7;
  }

  &:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.25);
  }
`;p.div`
  background-color: ${d.colors.bgWhite};
  border-radius: ${d.radius.md};
  box-shadow: ${d.shadows.md};
  overflow: hidden;
`;p.div`
  background-color: ${d.colors.cardHeader};
  color: ${d.colors.textWhite};
  padding: ${d.spacing.md} ${d.spacing.lg};
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`;p.div`
  padding: ${d.spacing.lg};
`;p.div`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border-top: 1px solid ${d.colors.border};
  background-color: ${d.colors.bgLight};
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
`;const hI=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};

  ${({$disabled:e})=>e&&Ia`
      opacity: 0.6;
      pointer-events: none;
    `}
`,fI=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,pI=p.select`
  width: 100%;
  padding: 0.75rem 1rem;
  font-family: ${d.typography.fontFamily};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: ${({$hasError:e})=>e?"#fff5f5":d.colors.bgWhite};
  border: 1px solid ${({$hasError:e})=>e?"#dc3545":d.colors.border};
  border-radius: ${d.radius.sm};
  cursor: pointer;
  transition: all ${d.transitions.normal};
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236C757D' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.25rem;
  padding-right: 2.5rem;

  ${({$hasValue:e,$hasError:t})=>e&&!t&&Ia`
      border-color: ${d.colors.accent};
      background-color: ${d.colors.bgBlueLight}15;
    `}

  &:hover:not(:disabled) {
    border-color: ${d.colors.accent};
  }

  &:focus {
    outline: none;
    border-color: ${d.colors.accent};
    box-shadow: 0 0 0 3px rgba(5, 193, 202, 0.15);
  }

  &:disabled {
    background-color: ${d.colors.bgLight};
    cursor: not-allowed;
    opacity: 0.7;
  }

  option {
    padding: 0.5rem;
  }
`,mI=p.span`
  font-size: ${d.typography.sizes.small};
  color: ${({$error:e})=>e?d.colors.danger:d.colors.textMuted};
`;function Ns({label:e,value:t,options:r,onChange:n,disabled:i=!1,placeholder:s="Seleccione...",helperText:o,error:l,stepNumber:c}){return a.jsxs(hI,{$disabled:i,children:[a.jsxs(fI,{style:{color:l?"#dc3545":void 0},children:[c&&a.jsx(gI,{children:c}),e]}),a.jsxs(pI,{value:t??"",onChange:u=>n(u.target.value),disabled:i,$hasValue:t!==null&&t!=="",$hasError:l,children:[a.jsx("option",{value:"",children:s}),r.map(u=>a.jsx("option",{value:u.value,children:u.label},u.value))]}),o&&a.jsx(mI,{$error:l,children:o})]})}const gI=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: ${d.spacing.xs};
  background-color: ${d.colors.primary};
  color: ${d.colors.textWhite};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.semibold};
`,xI=tI`
  to {
    transform: rotate(360deg);
  }
`,n$={sm:"1rem",md:"1.5rem",lg:"2rem"},vI=p.div`
  width: ${({$size:e="md"})=>n$[e]};
  height: ${({$size:e="md"})=>n$[e]};
  border: 2px solid ${d.colors.bgLight};
  border-top-color: ${d.colors.accent};
  border-radius: ${d.radius.full};
  animation: ${xI} 0.8s linear infinite;
`,_I=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: ${d.spacing.xl};
`;function yI({size:e="md"}){return a.jsx(_I,{children:a.jsx(vI,{$size:e})})}const bI=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: ${e=>e.$isOpen?"flex":"none"};
  justify-content: center;
  align-items: flex-start;
  padding: 2rem;
  z-index: 1000;
  overflow-y: auto;
`,jI=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  width: 100%;
  max-width: ${e=>{switch(e.$size){case"sm":return"400px";case"md":return"600px";case"lg":return"800px";case"xl":return"1140px";default:return"600px"}}};
  max-height: calc(100vh - 4rem);
  overflow: hidden;
  display: flex;
  flex-direction: column;
`,wI=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 1rem 1.25rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,kI=p.h2`
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
`,SI=p.button`
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
  opacity: 0.8;
  transition: opacity 0.2s;

  &:hover {
    opacity: 1;
  }
`,CI=p.div`
  padding: 1.25rem;
  overflow-y: auto;
  flex: 1;
  background: #f2f4fd;
`;function $I({isOpen:e,onClose:t,title:r,children:n,size:i="lg",showCloseButton:s=!0}){const o=C.useCallback(c=>{c.key==="Escape"&&t()},[t]),l=C.useCallback(c=>{c.target===c.currentTarget&&t()},[t]);return C.useEffect(()=>(e&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}),[e,o]),e?a.jsx(bI,{$isOpen:e,onClick:l,children:a.jsxs(jI,{$size:i,children:[a.jsxs(wI,{children:[a.jsx(kI,{children:r}),s&&a.jsx(SI,{onClick:t,children:""})]}),a.jsx(CI,{children:n})]})}):null}function fP(e,t){return function(){return e.apply(t,arguments)}}const{toString:EI}=Object.prototype,{getPrototypeOf:pk}=Object,{iterator:Y1,toStringTag:pP}=Symbol,Q1=(e=>t=>{const r=EI.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ns=e=>(e=e.toLowerCase(),t=>Q1(t)===e),J1=e=>t=>typeof t===e,{isArray:nh}=Array,Gu=J1("undefined");function up(e){return e!==null&&!Gu(e)&&e.constructor!==null&&!Gu(e.constructor)&&ya(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const mP=ns("ArrayBuffer");function TI(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&mP(e.buffer),t}const AI=J1("string"),ya=J1("function"),gP=J1("number"),hp=e=>e!==null&&typeof e=="object",FI=e=>e===!0||e===!1,_x=e=>{if(Q1(e)!=="object")return!1;const t=pk(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(pP in e)&&!(Y1 in e)},DI=e=>{if(!hp(e)||up(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},PI=ns("Date"),MI=ns("File"),OI=ns("Blob"),RI=ns("FileList"),NI=e=>hp(e)&&ya(e.pipe),zI=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ya(e.append)&&((t=Q1(e))==="formdata"||t==="object"&&ya(e.toString)&&e.toString()==="[object FormData]"))},II=ns("URLSearchParams"),[LI,BI,UI,VI]=["ReadableStream","Request","Response","Headers"].map(ns),HI=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),nh(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(up(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function xP(e,t){if(up(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Ac=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,vP=e=>!Gu(e)&&e!==Ac;function Tw(){const{caseless:e,skipUndefined:t}=vP(this)&&this||{},r={},n=(i,s)=>{const o=e&&xP(r,s)||s;_x(r[o])&&_x(i)?r[o]=Tw(r[o],i):_x(i)?r[o]=Tw({},i):nh(i)?r[o]=i.slice():(!t||!Gu(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&fp(arguments[i],n);return r}const WI=(e,t,r,{allOwnKeys:n}={})=>(fp(t,(i,s)=>{r&&ya(i)?e[s]=fP(i,r):e[s]=i},{allOwnKeys:n}),e),GI=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),qI=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},KI=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&pk(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},XI=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},YI=e=>{if(!e)return null;if(nh(e))return e;let t=e.length;if(!gP(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},QI=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&pk(Uint8Array)),JI=(e,t)=>{const n=(e&&e[Y1]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},ZI=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},eL=ns("HTMLFormElement"),tL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),a$=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),rL=ns("RegExp"),_P=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};fp(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},nL=e=>{_P(e,(t,r)=>{if(ya(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ya(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},aL=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return nh(e)?n(e):n(String(e).split(t)),r},iL=()=>{},sL=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function oL(e){return!!(e&&ya(e.append)&&e[pP]==="FormData"&&e[Y1])}const lL=e=>{const t=new Array(10),r=(n,i)=>{if(hp(n)){if(t.indexOf(n)>=0)return;if(up(n))return n;if(!("toJSON"in n)){t[i]=n;const s=nh(n)?[]:{};return fp(n,(o,l)=>{const c=r(o,i+1);!Gu(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},cL=ns("AsyncFunction"),dL=e=>e&&(hp(e)||ya(e))&&ya(e.then)&&ya(e.catch),yP=((e,t)=>e?setImmediate:t?((r,n)=>(Ac.addEventListener("message",({source:i,data:s})=>{i===Ac&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Ac.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ya(Ac.postMessage)),uL=typeof queueMicrotask<"u"?queueMicrotask.bind(Ac):typeof process<"u"&&process.nextTick||yP,hL=e=>e!=null&&ya(e[Y1]),fe={isArray:nh,isArrayBuffer:mP,isBuffer:up,isFormData:zI,isArrayBufferView:TI,isString:AI,isNumber:gP,isBoolean:FI,isObject:hp,isPlainObject:_x,isEmptyObject:DI,isReadableStream:LI,isRequest:BI,isResponse:UI,isHeaders:VI,isUndefined:Gu,isDate:PI,isFile:MI,isBlob:OI,isRegExp:rL,isFunction:ya,isStream:NI,isURLSearchParams:II,isTypedArray:QI,isFileList:RI,forEach:fp,merge:Tw,extend:WI,trim:HI,stripBOM:GI,inherits:qI,toFlatObject:KI,kindOf:Q1,kindOfTest:ns,endsWith:XI,toArray:YI,forEachEntry:JI,matchAll:ZI,isHTMLForm:eL,hasOwnProperty:a$,hasOwnProp:a$,reduceDescriptors:_P,freezeMethods:nL,toObjectSet:aL,toCamelCase:tL,noop:iL,toFiniteNumber:sL,findKey:xP,global:Ac,isContextDefined:vP,isSpecCompliantForm:oL,toJSONObject:lL,isAsyncFn:cL,isThenable:dL,setImmediate:yP,asap:uL,isIterable:hL};function Ze(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}fe.inherits(Ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.status}}});const bP=Ze.prototype,jP={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{jP[e]={value:e}});Object.defineProperties(Ze,jP);Object.defineProperty(bP,"isAxiosError",{value:!0});Ze.from=(e,t,r,n,i,s)=>{const o=Object.create(bP);fe.toFlatObject(e,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Ze.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const fL=null;function Aw(e){return fe.isPlainObject(e)||fe.isArray(e)}function wP(e){return fe.endsWith(e,"[]")?e.slice(0,-2):e}function i$(e,t,r){return e?e.concat(t).map(function(i,s){return i=wP(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function pL(e){return fe.isArray(e)&&!e.some(Aw)}const mL=fe.toFlatObject(fe,{},null,function(t){return/^is[A-Z]/.test(t)});function Z1(e,t,r){if(!fe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=fe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,y){return!fe.isUndefined(y[v])});const n=r.metaTokens,i=r.visitor||h,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&fe.isSpecCompliantForm(t);if(!fe.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(fe.isDate(g))return g.toISOString();if(fe.isBoolean(g))return g.toString();if(!c&&fe.isBlob(g))throw new Ze("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(g)||fe.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function h(g,v,y){let b=g;if(g&&!y&&typeof g=="object"){if(fe.endsWith(v,"{}"))v=n?v:v.slice(0,-2),g=JSON.stringify(g);else if(fe.isArray(g)&&pL(g)||(fe.isFileList(g)||fe.endsWith(v,"[]"))&&(b=fe.toArray(g)))return v=wP(v),b.forEach(function(j,S){!(fe.isUndefined(j)||j===null)&&t.append(o===!0?i$([v],S,s):o===null?v:v+"[]",u(j))}),!1}return Aw(g)?!0:(t.append(i$(y,v,s),u(g)),!1)}const f=[],m=Object.assign(mL,{defaultVisitor:h,convertValue:u,isVisitable:Aw});function _(g,v){if(!fe.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(g),fe.forEach(g,function(b,x){(!(fe.isUndefined(b)||b===null)&&i.call(t,b,fe.isString(x)?x.trim():x,v,m))===!0&&_(b,v?v.concat(x):[x])}),f.pop()}}if(!fe.isObject(e))throw new TypeError("data must be an object");return _(e),t}function s$(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function mk(e,t){this._pairs=[],e&&Z1(e,this,t)}const kP=mk.prototype;kP.append=function(t,r){this._pairs.push([t,r])};kP.toString=function(t){const r=t?function(n){return t.call(this,n,s$)}:s$;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function gL(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function SP(e,t,r){if(!t)return e;const n=r&&r.encode||gL;fe.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=fe.isURLSearchParams(t)?t.toString():new mk(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class o${constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){fe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const CP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xL=typeof URLSearchParams<"u"?URLSearchParams:mk,vL=typeof FormData<"u"?FormData:null,_L=typeof Blob<"u"?Blob:null,yL={isBrowser:!0,classes:{URLSearchParams:xL,FormData:vL,Blob:_L},protocols:["http","https","file","blob","url","data"]},gk=typeof window<"u"&&typeof document<"u",Fw=typeof navigator=="object"&&navigator||void 0,bL=gk&&(!Fw||["ReactNative","NativeScript","NS"].indexOf(Fw.product)<0),jL=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wL=gk&&window.location.href||"http://localhost",kL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:gk,hasStandardBrowserEnv:bL,hasStandardBrowserWebWorkerEnv:jL,navigator:Fw,origin:wL},Symbol.toStringTag,{value:"Module"})),Cn={...kL,...yL};function SL(e,t){return Z1(e,new Cn.classes.URLSearchParams,{visitor:function(r,n,i,s){return Cn.isNode&&fe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function CL(e){return fe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function $L(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function $P(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&fe.isArray(i)?i.length:o,c?(fe.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!fe.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&fe.isArray(i[o])&&(i[o]=$L(i[o])),!l)}if(fe.isFormData(e)&&fe.isFunction(e.entries)){const r={};return fe.forEachEntry(e,(n,i)=>{t(CL(n),i,r,0)}),r}return null}function EL(e,t,r){if(fe.isString(e))try{return(t||JSON.parse)(e),fe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const pp={transitional:CP,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=fe.isObject(t);if(s&&fe.isHTMLForm(t)&&(t=new FormData(t)),fe.isFormData(t))return i?JSON.stringify($P(t)):t;if(fe.isArrayBuffer(t)||fe.isBuffer(t)||fe.isStream(t)||fe.isFile(t)||fe.isBlob(t)||fe.isReadableStream(t))return t;if(fe.isArrayBufferView(t))return t.buffer;if(fe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return SL(t,this.formSerializer).toString();if((l=fe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Z1(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),EL(t)):t}],transformResponse:[function(t){const r=this.transitional||pp.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(fe.isResponse(t)||fe.isReadableStream(t))return t;if(t&&fe.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Ze.from(l,Ze.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Cn.classes.FormData,Blob:Cn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],e=>{pp.headers[e]={}});const TL=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),AL=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&TL[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},l$=Symbol("internals");function wh(e){return e&&String(e).trim().toLowerCase()}function yx(e){return e===!1||e==null?e:fe.isArray(e)?e.map(yx):String(e)}function FL(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const DL=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Yv(e,t,r,n,i){if(fe.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!fe.isString(t)){if(fe.isString(n))return t.indexOf(n)!==-1;if(fe.isRegExp(n))return n.test(t)}}function PL(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function ML(e,t){const r=fe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let ba=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const h=wh(c);if(!h)throw new Error("header name must be a non-empty string");const f=fe.findKey(i,h);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=yx(l))}const o=(l,c)=>fe.forEach(l,(u,h)=>s(u,h,c));if(fe.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(fe.isString(t)&&(t=t.trim())&&!DL(t))o(AL(t),r);else if(fe.isObject(t)&&fe.isIterable(t)){let l={},c,u;for(const h of t){if(!fe.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?fe.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=wh(t),t){const n=fe.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return FL(i);if(fe.isFunction(r))return r.call(this,i,n);if(fe.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=wh(t),t){const n=fe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Yv(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=wh(o),o){const l=fe.findKey(n,o);l&&(!r||Yv(n,n[l],l,r))&&(delete n[l],i=!0)}}return fe.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||Yv(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return fe.forEach(this,(i,s)=>{const o=fe.findKey(n,s);if(o){r[o]=yx(i),delete r[s];return}const l=t?PL(s):String(s).trim();l!==s&&delete r[s],r[l]=yx(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return fe.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&fe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[l$]=this[l$]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=wh(o);n[l]||(ML(i,o),n[l]=!0)}return fe.isArray(t)?t.forEach(s):s(t),this}};ba.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);fe.reduceDescriptors(ba.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});fe.freezeMethods(ba);function Qv(e,t){const r=this||pp,n=t||r,i=ba.from(n.headers);let s=n.data;return fe.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function EP(e){return!!(e&&e.__CANCEL__)}function ah(e,t,r){Ze.call(this,e??"canceled",Ze.ERR_CANCELED,t,r),this.name="CanceledError"}fe.inherits(ah,Ze,{__CANCEL__:!0});function TP(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ze("Request failed with status code "+r.status,[Ze.ERR_BAD_REQUEST,Ze.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function OL(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function RL(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),h=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,m=0;for(;f!==i;)m+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const _=h&&u-h;return _?Math.round(m*1e3/_):void 0}}function NL(e,t){let r=0,n=1e3/t,i,s;const o=(u,h=Date.now())=>{r=h,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const h=Date.now(),f=h-r;f>=n?o(u,h):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const a1=(e,t,r=3)=>{let n=0;const i=RL(50,250);return NL(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),h=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},c$=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},d$=e=>(...t)=>fe.asap(()=>e(...t)),zL=Cn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Cn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Cn.origin),Cn.navigator&&/(msie|trident)/i.test(Cn.navigator.userAgent)):()=>!0,IL=Cn.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];fe.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),fe.isString(n)&&l.push(`path=${n}`),fe.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),fe.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function LL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function BL(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function AP(e,t,r){let n=!LL(t);return e&&(n||r==!1)?BL(e,t):t}const u$=e=>e instanceof ba?{...e}:e;function id(e,t){t=t||{};const r={};function n(u,h,f,m){return fe.isPlainObject(u)&&fe.isPlainObject(h)?fe.merge.call({caseless:m},u,h):fe.isPlainObject(h)?fe.merge({},h):fe.isArray(h)?h.slice():h}function i(u,h,f,m){if(fe.isUndefined(h)){if(!fe.isUndefined(u))return n(void 0,u,f,m)}else return n(u,h,f,m)}function s(u,h){if(!fe.isUndefined(h))return n(void 0,h)}function o(u,h){if(fe.isUndefined(h)){if(!fe.isUndefined(u))return n(void 0,u)}else return n(void 0,h)}function l(u,h,f){if(f in t)return n(u,h);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,h,f)=>i(u$(u),u$(h),f,!0)};return fe.forEach(Object.keys({...e,...t}),function(h){const f=c[h]||i,m=f(e[h],t[h],h);fe.isUndefined(m)&&f!==l||(r[h]=m)}),r}const FP=e=>{const t=id({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=ba.from(o),t.url=SP(AP(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),fe.isFormData(r)){if(Cn.hasStandardBrowserEnv||Cn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(fe.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([h,f])=>{u.includes(h.toLowerCase())&&o.set(h,f)})}}if(Cn.hasStandardBrowserEnv&&(n&&fe.isFunction(n)&&(n=n(t)),n||n!==!1&&zL(t.url))){const c=i&&s&&IL.read(s);c&&o.set(i,c)}return t},UL=typeof XMLHttpRequest<"u",VL=UL&&function(e){return new Promise(function(r,n){const i=FP(e);let s=i.data;const o=ba.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,h,f,m,_,g;function v(){_&&_(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function b(){if(!y)return;const j=ba.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:j,config:e,request:y};TP(function(w){r(w),v()},function(w){n(w),v()},T),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new Ze("Request aborted",Ze.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const T=S&&S.message?S.message:"Network Error",F=new Ze(T,Ze.ERR_NETWORK,e,y);F.event=S||null,n(F),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const T=i.transitional||CP;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new Ze(S,T.clarifyTimeoutError?Ze.ETIMEDOUT:Ze.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&fe.forEach(o.toJSON(),function(S,T){y.setRequestHeader(T,S)}),fe.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),u&&([m,g]=a1(u,!0),y.addEventListener("progress",m)),c&&y.upload&&([f,_]=a1(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",_)),(i.cancelToken||i.signal)&&(h=j=>{y&&(n(!j||j.type?new ah(null,e,y):j),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const x=OL(i.url);if(x&&Cn.protocols.indexOf(x)===-1){n(new Ze("Unsupported protocol "+x+":",Ze.ERR_BAD_REQUEST,e));return}y.send(s||null)})},HL=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const h=u instanceof Error?u:this.reason;n.abort(h instanceof Ze?h:new ah(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,s(new Ze(`timeout ${t} of ms exceeded`,Ze.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>fe.asap(l),c}},WL=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},GL=async function*(e,t){for await(const r of qL(e))yield*WL(r,t)},qL=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},h$=(e,t,r,n)=>{const i=GL(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await i.next();if(u){l(),c.close();return}let f=h.byteLength;if(r){let m=s+=f;r(m)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},f$=64*1024,{isFunction:Xp}=fe,KL=(({Request:e,Response:t})=>({Request:e,Response:t}))(fe.global),{ReadableStream:p$,TextEncoder:m$}=fe.global,g$=(e,...t)=>{try{return!!e(...t)}catch{return!1}},XL=e=>{e=fe.merge.call({skipUndefined:!0},KL,e);const{fetch:t,Request:r,Response:n}=e,i=t?Xp(t):typeof fetch=="function",s=Xp(r),o=Xp(n);if(!i)return!1;const l=i&&Xp(p$),c=i&&(typeof m$=="function"?(g=>v=>g.encode(v))(new m$):async g=>new Uint8Array(await new r(g).arrayBuffer())),u=s&&l&&g$(()=>{let g=!1;const v=new r(Cn.origin,{body:new p$,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!v}),h=o&&l&&g$(()=>fe.isReadableStream(new n("").body)),f={stream:h&&(g=>g.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(v,y)=>{let b=v&&v[g];if(b)return b.call(v);throw new Ze(`Response type '${g}' is not supported`,Ze.ERR_NOT_SUPPORT,y)})});const m=async g=>{if(g==null)return 0;if(fe.isBlob(g))return g.size;if(fe.isSpecCompliantForm(g))return(await new r(Cn.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(fe.isArrayBufferView(g)||fe.isArrayBuffer(g))return g.byteLength;if(fe.isURLSearchParams(g)&&(g=g+""),fe.isString(g))return(await c(g)).byteLength},_=async(g,v)=>{const y=fe.toFiniteNumber(g.getContentLength());return y??m(v)};return async g=>{let{url:v,method:y,data:b,signal:x,cancelToken:j,timeout:S,onDownloadProgress:T,onUploadProgress:F,responseType:w,headers:P,withCredentials:M="same-origin",fetchOptions:A}=FP(g),D=t||fetch;w=w?(w+"").toLowerCase():"text";let H=HL([x,j&&j.toAbortSignal()],S),U=null;const W=H&&H.unsubscribe&&(()=>{H.unsubscribe()});let R;try{if(F&&u&&y!=="get"&&y!=="head"&&(R=await _(P,b))!==0){let ne=new r(v,{method:"POST",body:b,duplex:"half"}),O;if(fe.isFormData(b)&&(O=ne.headers.get("content-type"))&&P.setContentType(O),ne.body){const[N,L]=c$(R,a1(d$(F)));b=h$(ne.body,f$,N,L)}}fe.isString(M)||(M=M?"include":"omit");const ae=s&&"credentials"in r.prototype,le={...A,signal:H,method:y.toUpperCase(),headers:P.normalize().toJSON(),body:b,duplex:"half",credentials:ae?M:void 0};U=s&&new r(v,le);let G=await(s?D(U,A):D(v,le));const z=h&&(w==="stream"||w==="response");if(h&&(T||z&&W)){const ne={};["status","statusText","headers"].forEach(K=>{ne[K]=G[K]});const O=fe.toFiniteNumber(G.headers.get("content-length")),[N,L]=T&&c$(O,a1(d$(T),!0))||[];G=new n(h$(G.body,f$,N,()=>{L&&L(),W&&W()}),ne)}w=w||"text";let ie=await f[fe.findKey(f,w)||"text"](G,g);return!z&&W&&W(),await new Promise((ne,O)=>{TP(ne,O,{data:ie,headers:ba.from(G.headers),status:G.status,statusText:G.statusText,config:g,request:U})})}catch(ae){throw W&&W(),ae&&ae.name==="TypeError"&&/Load failed|fetch/i.test(ae.message)?Object.assign(new Ze("Network Error",Ze.ERR_NETWORK,g,U),{cause:ae.cause||ae}):Ze.from(ae,ae&&ae.code,g,U)}}},YL=new Map,DP=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,h=YL;for(;l--;)c=s[l],u=h.get(c),u===void 0&&h.set(c,u=l?new Map:XL(t)),h=u;return u};DP();const xk={http:fL,xhr:VL,fetch:{get:DP}};fe.forEach(xk,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const x$=e=>`- ${e}`,QL=e=>fe.isFunction(e)||e===null||e===!1;function JL(e,t){e=fe.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!QL(n)&&(i=xk[(l=String(n)).toLowerCase()],i===void 0))throw new Ze(`Unknown adapter '${l}'`);if(i&&(fe.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(x$).join(`
`):" "+x$(o[0]):"as no adapter specified";throw new Ze("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const PP={getAdapter:JL,adapters:xk};function Jv(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ah(null,e)}function v$(e){return Jv(e),e.headers=ba.from(e.headers),e.data=Qv.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),PP.getAdapter(e.adapter||pp.adapter,e)(e).then(function(n){return Jv(e),n.data=Qv.call(e,e.transformResponse,n),n.headers=ba.from(n.headers),n},function(n){return EP(n)||(Jv(e),n&&n.response&&(n.response.data=Qv.call(e,e.transformResponse,n.response),n.response.headers=ba.from(n.response.headers))),Promise.reject(n)})}const MP="1.13.2",ev={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ev[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _$={};ev.transitional=function(t,r,n){function i(s,o){return"[Axios v"+MP+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new Ze(i(o," has been removed"+(r?" in "+r:"")),Ze.ERR_DEPRECATED);return r&&!_$[o]&&(_$[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};ev.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function ZL(e,t,r){if(typeof e!="object")throw new Ze("options must be an object",Ze.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new Ze("option "+s+" must be "+c,Ze.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ze("Unknown option "+s,Ze.ERR_BAD_OPTION)}}const bx={assertOptions:ZL,validators:ev},os=bx.validators;let Wc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new o$,response:new o$}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=id(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&bx.assertOptions(n,{silentJSONParsing:os.transitional(os.boolean),forcedJSONParsing:os.transitional(os.boolean),clarifyTimeoutError:os.transitional(os.boolean)},!1),i!=null&&(fe.isFunction(i)?r.paramsSerializer={serialize:i}:bx.assertOptions(i,{encode:os.function,serialize:os.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),bx.assertOptions(r,{baseUrl:os.spelling("baseURL"),withXsrfToken:os.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&fe.merge(s.common,s[r.method]);s&&fe.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=ba.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(c=c&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let h,f=0,m;if(!c){const g=[v$.bind(this),void 0];for(g.unshift(...l),g.push(...u),m=g.length,h=Promise.resolve(r);f<m;)h=h.then(g[f++],g[f++]);return h}m=l.length;let _=r;for(;f<m;){const g=l[f++],v=l[f++];try{_=g(_)}catch(y){v.call(this,y);break}}try{h=v$.call(this,_)}catch(g){return Promise.reject(g)}for(f=0,m=u.length;f<m;)h=h.then(u[f++],u[f++]);return h}getUri(t){t=id(this.defaults,t);const r=AP(t.baseURL,t.url,t.allowAbsoluteUrls);return SP(r,t.params,t.paramsSerializer)}};fe.forEach(["delete","get","head","options"],function(t){Wc.prototype[t]=function(r,n){return this.request(id(n||{},{method:t,url:r,data:(n||{}).data}))}});fe.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(id(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Wc.prototype[t]=r(),Wc.prototype[t+"Form"]=r(!0)});let e7=class OP{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new ah(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new OP(function(i){t=i}),cancel:t}}};function t7(e){return function(r){return e.apply(null,r)}}function r7(e){return fe.isObject(e)&&e.isAxiosError===!0}const Dw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Dw).forEach(([e,t])=>{Dw[t]=e});function RP(e){const t=new Wc(e),r=fP(Wc.prototype.request,t);return fe.extend(r,Wc.prototype,t,{allOwnKeys:!0}),fe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return RP(id(e,i))},r}const fr=RP(pp);fr.Axios=Wc;fr.CanceledError=ah;fr.CancelToken=e7;fr.isCancel=EP;fr.VERSION=MP;fr.toFormData=Z1;fr.AxiosError=Ze;fr.Cancel=fr.CanceledError;fr.all=function(t){return Promise.all(t)};fr.spread=t7;fr.isAxiosError=r7;fr.mergeConfig=id;fr.AxiosHeaders=ba;fr.formToJSON=e=>$P(fe.isHTMLForm(e)?new FormData(e):e);fr.getAdapter=PP.getAdapter;fr.HttpStatusCode=Dw;fr.default=fr;const{Axios:cme,AxiosError:dme,CanceledError:ume,isCancel:hme,CancelToken:fme,VERSION:pme,all:mme,Cancel:gme,isAxiosError:xme,spread:vme,toFormData:_me,AxiosHeaders:yme,HttpStatusCode:bme,formToJSON:jme,getAdapter:wme,mergeConfig:kme}=fr,n7="/api/v1",a7="http://localhost:8001",e0="inveb_cascade_token",jx="inveb_cascade_user",pe=fr.create({baseURL:n7,headers:{"Content-Type":"application/json"}});fr.create({baseURL:a7,headers:{"Content-Type":"application/json"}});pe.interceptors.request.use(e=>{var r;const t=localStorage.getItem(e0);return t&&(e.headers.Authorization=`Bearer ${t}`),console.log(`[API] ${(r=e.method)==null?void 0:r.toUpperCase()} ${e.url}`),e},e=>Promise.reject(e));pe.interceptors.response.use(e=>e,e=>{var t,r;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem(e0),localStorage.removeItem(jx)),console.error("[API Error]",((r=e.response)==null?void 0:r.data)||e.message),Promise.reject(e)});const mo={login:async e=>{const t=await pe.post("/auth/login",e);return localStorage.setItem(e0,t.data.access_token),localStorage.setItem(jx,JSON.stringify(t.data.user)),t.data},logout:()=>{localStorage.removeItem(e0),localStorage.removeItem(jx)},getCurrentUser:async()=>(await pe.get("/auth/me")).data,isAuthenticated:()=>!!localStorage.getItem(e0),getStoredUser:()=>{const e=localStorage.getItem(jx);if(e)try{return JSON.parse(e)}catch{return null}return null},verifyToken:async()=>{try{return(await pe.post("/auth/verify")).data.valid}catch{return!1}},changePassword:async(e,t)=>(await pe.post("/auth/change-password",{current_password:e,new_password:t})).data,forgotPassword:async e=>(await pe.post("/auth/forgot-password",{email:e})).data,validateResetToken:async(e,t)=>(await pe.post("/auth/validate-reset-token",{token:e,email:t})).data,resetPassword:async(e,t,r)=>(await pe.post("/auth/reset-password",{token:e,email:t,new_password:r})).data},Fn={list:async(e={})=>{var n,i,s,o,l,c,u;const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.id_ot&&t.append("id_ot",e.id_ot.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.carton&&t.append("carton",e.carton),e.material&&t.append("material",e.material),e.descripcion&&t.append("descripcion",e.descripcion),(n=e.client_id)==null||n.forEach(h=>t.append("client_id",h.toString())),(i=e.estado_id)==null||i.forEach(h=>t.append("estado_id",h.toString())),(s=e.area_id)==null||s.forEach(h=>t.append("area_id",h.toString())),(o=e.canal_id)==null||o.forEach(h=>t.append("canal_id",h.toString())),(l=e.vendedor_id)==null||l.forEach(h=>t.append("vendedor_id",h.toString())),(c=e.planta_id)==null||c.forEach(h=>t.append("planta_id",h.toString())),(u=e.tipo_solicitud)==null||u.forEach(h=>t.append("tipo_solicitud",h.toString())),(await pe.get(`/work-orders/?${t.toString()}`)).data},getFilterOptions:async()=>(await pe.get("/work-orders/filter-options")).data,get:async e=>(await pe.get(`/work-orders/${e}`)).data,create:async e=>(await pe.post("/work-orders/",e)).data,update:async(e,t)=>(await pe.put(`/work-orders/${e}`,t)).data,getManagementHistory:async e=>(await pe.get(`/work-orders/${e}/management`)).data,getWorkflowOptions:async e=>(await pe.get(`/work-orders/${e}/workflow-options`)).data,transition:async(e,t)=>(await pe.post(`/work-orders/${e}/transition`,t)).data,getPendingApproval:async(e=1,t=20)=>(await pe.get(`/work-orders/pending-approval?page=${e}&page_size=${t}`)).data,approve:async e=>(await pe.put(`/work-orders/${e}/approve`)).data,reject:async e=>(await pe.put(`/work-orders/${e}/reject`)).data,getFilesByArea:async e=>[],createAnswer:async(e,t,r)=>({id:0,message:"No implementado"})},i7={downloadOTExcel:async e=>{const t=await pe.get(`/exports/ot/${e}/excel`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTSAP:async e=>{const t=await pe.get(`/exports/ot/${e}/sap`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`SAP_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadOTsListExcel:async(e={})=>{const t=new URLSearchParams;e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.area_id&&t.append("area_id",e.area_id.toString()),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.client_id&&t.append("client_id",e.client_id.toString()),e.fecha_desde&&t.append("fecha_desde",e.fecha_desde),e.fecha_hasta&&t.append("fecha_hasta",e.fecha_hasta);const r=await pe.get(`/exports/ots/excel?${t.toString()}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=n,i.setAttribute("download",`Lista_OTs_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(n)},getOTLog:async(e,t={})=>{const r=new URLSearchParams;return t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString()),t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),(await pe.get(`/exports/ot/${e}/log?${r.toString()}`)).data},downloadOTLogExcel:async(e,t={})=>{const r=new URLSearchParams;t.date_desde&&r.append("date_desde",t.date_desde),t.date_hasta&&r.append("date_hasta",t.date_hasta),t.user_id&&r.append("user_id",t.user_id.toString());const n=await pe.get(`/exports/ot/${e}/log/excel?${r.toString()}`,{responseType:"blob"}),i=window.URL.createObjectURL(new Blob([n.data])),s=document.createElement("a");s.href=i,s.setAttribute("download",`Log_OT_${e}_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(i)}},i1={downloadEtiquetaMuestra:async(e,t="producto")=>{const r=await pe.get(`/pdfs/etiqueta-muestra/${e}?tipo=${t}`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=n,i.setAttribute("download",`Etiqueta_${t==="producto"?"Producto":"Cliente"}_${e}.pdf`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(n)},downloadFichaDiseno:async e=>{const t=await pe.get(`/pdfs/ficha-diseno/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Ficha_Diseno_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadEstudioBench:async e=>{const t=await pe.get(`/pdfs/estudio-bench/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Estudio_Benchmarking_OT_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)},downloadCotizacion:async e=>{const t=await pe.get(`/pdfs/cotizacion/${e}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`Cotizacion_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)}},s1={getInstalacionesCliente:async e=>(await pe.get(`/cascades/clientes/${e}/instalaciones`)).data,getInstalacionesClienteCotiza:async e=>(await pe.get(`/cascades/clientes/${e}/instalaciones-cotiza`)).data,getContactosCliente:async(e,t)=>{const r=t?`?instalacion_id=${t}`:"";return(await pe.get(`/cascades/clientes/${e}/contactos${r}`)).data},getInformacionInstalacion:async e=>(await pe.get(`/cascades/instalaciones/${e}`)).data,getDatosContacto:async e=>(await pe.get(`/cascades/contactos/${e}`)).data,getServiciosMaquila:async e=>(await pe.get(`/cascades/productos/${e}/servicios-maquila`)).data,getRubro:async e=>(await pe.get(`/cascades/jerarquias/${e}/rubro`)).data,getJerarquia2Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await pe.get(`/cascades/jerarquias/nivel2-rubro?hierarchy_id=${e}${r}`)).data},getJerarquia3Rubro:async(e,t)=>{const r=t?`&rubro_id=${t}`:"";return(await pe.get(`/cascades/jerarquias/nivel3-rubro?subhierarchy_id=${e}${r}`)).data}},s7={getFormOptions:async()=>(await pe.get("/form-options/")).data},NP={list:async(e=1,t=20)=>(await pe.get("/notifications/",{params:{page:e,page_size:t}})).data,markAsRead:async e=>(await pe.put(`/notifications/${e}/read`)).data,create:async e=>(await pe.post("/notifications/",e)).data,getCount:async()=>(await pe.get("/notifications/count")).data},gd={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.clasificacion_id&&t.append("clasificacion_id",e.clasificacion_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await pe.get(`/mantenedores/clients/?${t.toString()}`)).data},get:async e=>(await pe.get(`/mantenedores/clients/${e}`)).data,create:async e=>(await pe.post("/mantenedores/clients/",e)).data,update:async(e,t)=>(await pe.put(`/mantenedores/clients/${e}`,t)).data,activate:async e=>(await pe.put(`/mantenedores/clients/${e}/activate`)).data,deactivate:async e=>(await pe.put(`/mantenedores/clients/${e}/deactivate`)).data,getClasificaciones:async()=>(await pe.get("/mantenedores/clients/clasificaciones")).data},xd={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.role_id&&t.append("role_id",e.role_id.toString()),e.work_space_id&&t.append("work_space_id",e.work_space_id.toString()),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await pe.get(`/mantenedores/users/?${t.toString()}`)).data},get:async e=>(await pe.get(`/mantenedores/users/${e}`)).data,create:async e=>(await pe.post("/mantenedores/users/",e)).data,update:async(e,t)=>(await pe.put(`/mantenedores/users/${e}`,t)).data,activate:async e=>(await pe.put(`/mantenedores/users/${e}/activate`)).data,deactivate:async e=>(await pe.put(`/mantenedores/users/${e}/deactivate`)).data,getRoles:async()=>(await pe.get("/mantenedores/users/roles")).data,getWorkSpaces:async()=>(await pe.get("/mantenedores/users/workspaces")).data},to={getTablas:async()=>(await pe.get("/mantenedores/generic/tablas")).data,list:async(e,t={})=>{const r=new URLSearchParams;return t.page&&r.append("page",t.page.toString()),t.page_size&&r.append("page_size",t.page_size.toString()),t.search&&r.append("search",t.search),t.activo!==void 0&&r.append("activo",t.activo.toString()),(await pe.get(`/mantenedores/generic/${e}?${r.toString()}`)).data},get:async(e,t)=>(await pe.get(`/mantenedores/generic/${e}/${t}`)).data,create:async(e,t)=>(await pe.post(`/mantenedores/generic/${e}`,{data:t})).data,update:async(e,t,r)=>(await pe.put(`/mantenedores/generic/${e}/${t}`,{data:r})).data,activate:async(e,t)=>(await pe.put(`/mantenedores/generic/${e}/${t}/activate`)).data,deactivate:async(e,t)=>(await pe.put(`/mantenedores/generic/${e}/${t}/deactivate`)).data,bulkUpload:async(e,t)=>(await pe.post(`/mantenedores/generic/${e}/bulk`,{items:t})).data},wr={listNivel1:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),(await pe.get(`/mantenedores/jerarquias/nivel1?${t.toString()}`)).data},getNivel1:async e=>(await pe.get(`/mantenedores/jerarquias/nivel1/${e}`)).data,createNivel1:async e=>(await pe.post("/mantenedores/jerarquias/nivel1",e)).data,updateNivel1:async(e,t)=>(await pe.put(`/mantenedores/jerarquias/nivel1/${e}`,t)).data,activateNivel1:async e=>(await pe.put(`/mantenedores/jerarquias/nivel1/${e}/activate`)).data,deactivateNivel1:async e=>(await pe.put(`/mantenedores/jerarquias/nivel1/${e}/deactivate`)).data,getNivel2Parents:async()=>(await pe.get("/mantenedores/jerarquias/nivel2/parents")).data,listNivel2:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),(await pe.get(`/mantenedores/jerarquias/nivel2?${t.toString()}`)).data},getNivel2:async e=>(await pe.get(`/mantenedores/jerarquias/nivel2/${e}`)).data,createNivel2:async e=>(await pe.post("/mantenedores/jerarquias/nivel2",e)).data,updateNivel2:async(e,t)=>(await pe.put(`/mantenedores/jerarquias/nivel2/${e}`,t)).data,activateNivel2:async e=>(await pe.put(`/mantenedores/jerarquias/nivel2/${e}/activate`)).data,deactivateNivel2:async e=>(await pe.put(`/mantenedores/jerarquias/nivel2/${e}/deactivate`)).data,getNivel3Parents:async e=>{const t=new URLSearchParams;return e&&t.append("hierarchy_id",e.toString()),(await pe.get(`/mantenedores/jerarquias/nivel3/parents?${t.toString()}`)).data},listNivel3:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.search&&t.append("search",e.search),e.activo!==void 0&&t.append("activo",e.activo.toString()),e.hierarchy_id&&t.append("hierarchy_id",e.hierarchy_id.toString()),e.subhierarchy_id&&t.append("subhierarchy_id",e.subhierarchy_id.toString()),(await pe.get(`/mantenedores/jerarquias/nivel3?${t.toString()}`)).data},getNivel3:async e=>(await pe.get(`/mantenedores/jerarquias/nivel3/${e}`)).data,createNivel3:async e=>(await pe.post("/mantenedores/jerarquias/nivel3",e)).data,updateNivel3:async(e,t)=>(await pe.put(`/mantenedores/jerarquias/nivel3/${e}`,t)).data,activateNivel3:async e=>(await pe.put(`/mantenedores/jerarquias/nivel3/${e}/activate`)).data,deactivateNivel3:async e=>(await pe.put(`/mantenedores/jerarquias/nivel3/${e}/deactivate`)).data},Xn={list:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.user_id&&t.append("user_id",e.user_id.toString()),e.cotizacion_id&&t.append("cotizacion_id",e.cotizacion_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.cad&&t.append("cad",e.cad),e.estado_id&&e.estado_id.forEach(n=>t.append("estado_id",n.toString())),e.client_id&&e.client_id.forEach(n=>t.append("client_id",n.toString())),(await pe.get(`/cotizaciones/?${t.toString()}`)).data},get:async e=>(await pe.get(`/cotizaciones/${e}`)).data,create:async e=>(await pe.post("/cotizaciones/",e)).data,update:async(e,t)=>(await pe.put(`/cotizaciones/${e}`,t)).data,delete:async e=>(await pe.delete(`/cotizaciones/${e}`)).data,solicitarAprobacion:async e=>(await pe.post(`/cotizaciones/${e}/solicitar-aprobacion`)).data,gestionarAprobacion:async(e,t,r)=>(await pe.post(`/cotizaciones/${e}/gestionar-aprobacion`,{action:t,motivo:r})).data,getAprobaciones:async e=>(await pe.get(`/cotizaciones/${e}/aprobaciones`)).data,duplicar:async e=>(await pe.post(`/cotizaciones/${e}/duplicar`)).data,versionar:async e=>(await pe.post(`/cotizaciones/${e}/versionar`)).data,retomar:async e=>(await pe.post(`/cotizaciones/${e}/retomar`)).data,getEstados:async()=>(await pe.get("/cotizaciones/estados/")).data,getPendientesAprobacion:async e=>{const t=new URLSearchParams;return e&&t.append("role_id",e.toString()),(await pe.get(`/cotizaciones/pendientes-aprobacion/?${t.toString()}`)).data},exportPdf:async e=>{const t=await pe.get(`/cotizaciones/${e}/export-pdf`,{responseType:"blob"}),r=new Blob([t.data],{type:t.headers["content-type"]}),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n;const s=t.headers["content-disposition"];let o=`cotizacion_${e}.pdf`;if(s){const l=s.match(/filename=(.+)/);l&&(o=l[1])}i.setAttribute("download",o),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)},getPendientesAprobacionExterno:async(e={})=>{const t=new URLSearchParams;return Object.entries(e).forEach(([n,i])=>{i!=null&&i!==""&&t.append(n,i.toString())}),(await pe.get(`/cotizaciones/pendientes-aprobacion-externo/?${t.toString()}`)).data},solicitarAprobacionExterno:async(e,t)=>(await pe.post(`/cotizaciones/${e}/solicitar-aprobacion-externo?user_id=${t}`)).data,gestionarAprobacionExterno:async(e,t)=>(await pe.post(`/cotizaciones/${e}/gestionar-aprobacion-externo`,t)).data,getHistorialAprobaciones:async e=>(await pe.get(`/cotizaciones/${e}/historial-aprobaciones`)).data,getDetalleParaOT:async(e,t)=>(await pe.get(`/cotizaciones/detalle/${e}/para-ot`,{params:{tipo_solicitud:t}})).data,getDetallesParaOT:async(e,t=1,r=20)=>{const n=new URLSearchParams;return n.append("page",t.toString()),n.append("page_size",r.toString()),e&&n.append("cotizacion_id",e.toString()),(await pe.get(`/cotizaciones/detalles-para-ot/?${n.toString()}`)).data},getCostosResumen:async e=>(await pe.get(`/cotizaciones/${e}/costos-resumen`)).data,createDetalle:async(e,t)=>(await pe.post(`/cotizaciones/${e}/detalles`,t)).data,getDetalles:async e=>(await pe.get(`/cotizaciones/${e}/detalles`)).data},Zv={getPendingAssignment:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.asignado&&t.append("asignado",e.asignado),e.tipo_solicitud&&t.append("tipo_solicitud",e.tipo_solicitud),e.canal_id&&t.append("canal_id",e.canal_id.toString()),e.vendedor_id&&t.append("vendedor_id",e.vendedor_id.toString()),e.estado_id&&t.append("estado_id",e.estado_id.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await pe.get(`/work-orders/pending-assignment?${t.toString()}`)).data},assign:async(e,t)=>(await pe.put(`/work-orders/${e}/assign`,{profesional_id:t})).data,assignWithMessage:async(e,t)=>(await pe.put(`/work-orders/${e}/assign`,t)).data,getProfessionals:async()=>(await pe.get("/work-orders/professionals")).data},ta={getOTsPorUsuario:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.area_id&&t.append("area_id",e.area_id.toString()),(await pe.get(`/reports/ots-por-usuario?${t.toString()}`)).data},getOTsCompletadas:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.client_id&&t.append("client_id",e.client_id.toString()),(await pe.get(`/reports/ots-completadas?${t.toString()}`)).data},getTiempoPorArea:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await pe.get(`/reports/tiempo-por-area?${t.toString()}`)).data},getCargaMensual:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await pe.get(`/reports/carga-mensual?${t.toString()}`)).data},getRechazosMes:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await pe.get(`/reports/rechazos-mes?${t.toString()}`)).data},getAnulaciones:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await pe.get(`/reports/anulaciones?${t.toString()}`)).data},getMotivosRechazo:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await pe.get(`/reports/motivos-rechazo?${t.toString()}`)).data},getTiempoPrimeraMuestra:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await pe.get(`/reports/tiempo-primera-muestra?${t.toString()}`)).data},getGestionOTsActivas:async e=>{const t=new URLSearchParams;return e&&t.append("area_id",e.toString()),(await pe.get(`/reports/gestion-ots-activas?${t.toString()}`)).data},getIndicadoresSalaMuestra:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await pe.get(`/reports/indicadores-sala-muestra?${t.toString()}`)).data},getDisenoEstructuralSala:async e=>{const t=new URLSearchParams;return e&&t.append("year",e.toString()),(await pe.get(`/reports/diseno-estructural-sala?${t.toString()}`)).data},getTiempoDisenadorExterno:async(e={})=>{const t=new URLSearchParams;return e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),(await pe.get(`/reports/tiempo-disenador-externo?${t.toString()}`)).data},getMuestras:async(e={})=>{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.page_size&&t.append("page_size",e.page_size.toString()),e.date_desde&&t.append("date_desde",e.date_desde),e.date_hasta&&t.append("date_hasta",e.date_hasta),e.estado&&t.append("estado",e.estado),(await pe.get(`/reports/muestras?${t.toString()}`)).data}},o7={0:"Sin Asignar",1:"En Proceso",2:"Rechazada",3:"Terminada",4:"Anulada",5:"Devuelta",6:"Sala de Corte"},vr={listByOT:async e=>(await pe.get(`/muestras/ot/${e}`)).data,getOptions:async()=>(await pe.get("/muestras/options")).data,get:async e=>(await pe.get(`/muestras/${e}`)).data,create:async e=>(await pe.post("/muestras/",e)).data,update:async(e,t)=>(await pe.put(`/muestras/${e}`,t)).data,terminar:async e=>(await pe.put(`/muestras/${e}/terminar`)).data,rechazar:async(e,t)=>(await pe.put(`/muestras/${e}/rechazar`,{observacion:t})).data,anular:async e=>(await pe.put(`/muestras/${e}/anular`)).data,devolver:async(e,t)=>(await pe.put(`/muestras/${e}/devolver`,{observacion:t})).data,togglePrioritaria:async e=>(await pe.put(`/muestras/${e}/prioritaria`)).data,delete:async e=>(await pe.delete(`/muestras/${e}`)).data,asignarSalaCorte:async(e,t)=>(await pe.put(`/muestras/${e}/sala-corte?sala_corte_id=${t}`)).data,iniciarProceso:async e=>(await pe.put(`/muestras/${e}/en-proceso`)).data},l7={...Fn,getFormOptionsComplete:async()=>(await pe.get("/work-orders/form-options-complete")).data,duplicate:async e=>(await pe.post(`/work-orders/${e}/duplicate`)).data};function c7(){return Nt({queryKey:["form-options"],queryFn:s7.getFormOptions,staleTime:10*60*1e3})}p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`;p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: ${d.spacing.lg};
`;const d7=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: ${d.spacing.md};

  @media (max-width: 992px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 576px) {
    grid-template-columns: 1fr;
  }
`;p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`;p.h3`
  font-size: ${d.typography.sizes.h4};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.primary};
  margin-bottom: ${d.spacing.sm};
  padding-bottom: ${d.spacing.xs};
  border-bottom: 2px solid ${d.colors.accent};
`;p.span`
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};

  ${({$status:e})=>{switch(e){case"valid":return`
          background-color: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"invalid":return`
          background-color: ${d.colors.danger}20;
          color: ${d.colors.danger};
        `;default:return`
          background-color: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `}}}
`;p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.md};
`;p.div`
  flex: 1;
  height: 4px;
  border-radius: 2px;
  transition: background-color ${d.transitions.normal};

  ${({$active:e,$completed:t})=>t?`background-color: ${d.colors.success};`:e?`background-color: ${d.colors.accent};`:`background-color: ${d.colors.border};`}
`;p.div`
  background-color: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`;p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};

  &:not(:last-child) {
    border-bottom: 1px dashed ${d.colors.border};
  }
`;p.code`
  background-color: ${d.colors.primary}15;
  color: ${d.colors.primary};
  padding: 2px 6px;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`;const zs=[];function vk({values:e,onChange:t,fieldErrors:r={}}){const{data:n,isLoading:i}=c7(),s=C.useMemo(()=>({productType:(n==null?void 0:n.product_types)||zs,impresion:(n==null?void 0:n.impresion_types)||zs,fsc:(n==null?void 0:n.fsc_options)||zs,cinta:(n==null?void 0:n.cinta_options)||zs,coverageInternal:(n==null?void 0:n.coverage_internal)||zs,coverageExternal:(n==null?void 0:n.coverage_external)||zs,planta:(n==null?void 0:n.plantas)||zs,cartonColor:(n==null?void 0:n.carton_colors)||zs,carton:(n==null?void 0:n.cartones)||zs}),[n]),o=C.useCallback((c,u)=>{const h={...u};return c<=2&&(h.impresion=null),c<=3&&(h.fsc=null),c<=4&&(h.cinta=null),c<=5&&(h.coverageInternalId=null),c<=6&&(h.coverageExternalId=null),c<=7&&(h.plantaId=null),c<=8&&(h.cartonColor=null),c<=9&&(h.cartonId=null),h},[]),l=C.useCallback((c,u)=>{const h={productTypeId:1,impresion:2,fsc:3,cinta:4,coverageInternalId:5,coverageExternalId:6,plantaId:7,cartonColor:8,cartonId:9};let f=u;u===""||u===null?f=null:["productTypeId","coverageInternalId","coverageExternalId","plantaId","cartonId"].includes(c)&&(f=parseInt(u,10));const m=h[c];let _={...e,[c]:f};_=o(m+1,_),t(_)},[e,t,o]);return i?a.jsx(yI,{}):a.jsxs(d7,{children:[a.jsx(Ns,{label:"Tipo Item *",value:e.productTypeId,options:s.productType,onChange:c=>l("productTypeId",c),placeholder:"Seleccionar...",error:!!r.product_type_id,helperText:r.product_type_id}),a.jsx(Ns,{label:"Cinta",value:e.cinta,options:s.cinta,onChange:c=>l("cinta",c),disabled:!e.fsc,placeholder:"Seleccionar...",error:!!r.cinta,helperText:r.cinta}),a.jsx(Ns,{label:"Planta Objetivo",value:e.plantaId,options:s.planta,onChange:c=>l("plantaId",c),disabled:!e.coverageExternalId,placeholder:"Seleccionar...",error:!!r.planta_id,helperText:r.planta_id}),a.jsx(Ns,{label:"Impresion *",value:e.impresion,options:s.impresion,onChange:c=>l("impresion",c),disabled:!e.productTypeId,placeholder:"Seleccionar...",error:!!r.impresion,helperText:r.impresion}),a.jsx(Ns,{label:"Recubrimiento Interno",value:e.coverageInternalId,options:s.coverageInternal,onChange:c=>l("coverageInternalId",c),disabled:!e.cinta,placeholder:"Seleccionar...",error:!!r.coverage_internal_id,helperText:r.coverage_internal_id}),a.jsx(Ns,{label:"Color Carton *",value:e.cartonColor,options:s.cartonColor,onChange:c=>l("cartonColor",c),disabled:!e.plantaId,placeholder:"Seleccionar...",error:!!r.carton_color,helperText:r.carton_color}),a.jsx(Ns,{label:"FSC",value:e.fsc,options:s.fsc,onChange:c=>l("fsc",c),disabled:!e.impresion,placeholder:"Seleccionar...",error:!!r.fsc,helperText:r.fsc}),a.jsx(Ns,{label:"Recubrimiento Externo",value:e.coverageExternalId,options:s.coverageExternal,onChange:c=>l("coverageExternalId",c),disabled:!e.coverageInternalId,placeholder:"Seleccionar...",error:!!r.coverage_external_id,helperText:r.coverage_external_id}),a.jsx(Ns,{label:"Carton",value:e.cartonId,options:s.carton,onChange:c=>l("cartonId",c),disabled:!e.cartonColor,placeholder:"Seleccionar...",error:!!r.carton_id,helperText:r.carton_id})]})}const u7=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.primary} 0%, ${d.colors.primaryDark} 100%);
  padding: ${d.spacing.lg};
`,h7=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 400px;
`,f7=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,p7=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h1};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,m7=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0;
`,g7=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.md};
`,y$=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,b$=p.label`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,j$=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s, box-shadow 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textSecondary};
  }
`,x7=p.div`
  background-color: ${d.colors.danger}15;
  color: ${d.colors.danger};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
`,v7=p.div`
  margin-top: ${d.spacing.lg};
  text-align: center;
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,_7=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.sm};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`;function y7({onLogin:e,onNavigate:t}){const[r,n]=C.useState(""),[i,s]=C.useState(""),[o,l]=C.useState(null),[c,u]=C.useState(!1),h=C.useCallback(_=>{let g=_.replace(/[^0-9kK]/g,"");if(g.length>9&&(g=g.slice(0,9)),g.length>1){const v=g.slice(-1);return`${g.slice(0,-1)}-${v.toUpperCase()}`}return g},[]),f=C.useCallback(_=>{const g=h(_.target.value);n(g),l(null)},[h]),m=C.useCallback(async _=>{if(_.preventDefault(),l(null),!r||!i){l("Por favor complete todos los campos");return}u(!0);try{e?await e(r,i)||l("RUT o contrasea incorrectos"):(console.log("Login attempt:",{rut:r,password:i}),l("Modo demo - autenticacion no implementada"))}catch{l("Error de conexion. Intente nuevamente.")}finally{u(!1)}},[r,i,e]);return a.jsx(u7,{children:a.jsxs(h7,{children:[a.jsxs(f7,{children:[a.jsx(p7,{children:"INVEB"}),a.jsx(m7,{children:"Sistema de Ordenes de Trabajo"})]}),a.jsxs(g7,{onSubmit:m,children:[a.jsxs(y$,{children:[a.jsx(b$,{htmlFor:"rut",children:"RUT"}),a.jsx(j$,{id:"rut",type:"text",value:r,onChange:f,placeholder:"12345678-9",autoComplete:"username",disabled:c})]}),a.jsxs(y$,{children:[a.jsx(b$,{htmlFor:"password",children:"Contrasea"}),a.jsx(j$,{id:"password",type:"password",value:i,onChange:_=>{s(_.target.value),l(null)},placeholder:"",autoComplete:"current-password",disabled:c})]}),o&&a.jsx(x7,{children:o}),a.jsx(uI,{type:"submit",$variant:"primary",disabled:c,style:{width:"100%",marginTop:d.spacing.sm},children:c?"Ingresando...":"Ingresar"}),t&&a.jsx(_7,{type:"button",onClick:()=>t("forgot-password"),children:"Olvide mi contrasena"})]}),a.jsx(v7,{children:"MS-004 CascadeService v1.0"})]})})}function sa({onNavigate:e}){const[t,r]=C.useState([]),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),[u,h]=C.useState(1),[f,m]=C.useState(1),[_,g]=C.useState(0),[v,y]=C.useState({page:1,page_size:20}),[b,x]=C.useState({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]});C.useEffect(()=>{(async()=>{try{const W=await Fn.getFilterOptions();c(W)}catch(W){console.error("Error loading filter options:",W)}})()},[]);const j=C.useCallback(async()=>{i(!0),o(null);try{const U=await Fn.list(v);r(U.items),g(U.total),m(U.total_pages),h(U.page)}catch(U){o("Error cargando ordenes de trabajo"),console.error(U)}finally{i(!1)}},[v]);C.useEffect(()=>{j()},[j]);const S=U=>{U.preventDefault();const W={page:1,page_size:20};b.id_ot&&(W.id_ot=parseInt(b.id_ot)),b.date_desde&&(W.date_desde=b.date_desde),b.date_hasta&&(W.date_hasta=b.date_hasta),b.cad&&(W.cad=b.cad),b.carton&&(W.carton=b.carton),b.material&&(W.material=b.material),b.descripcion&&(W.descripcion=b.descripcion),b.client_id.length&&(W.client_id=b.client_id),b.estado_id.length&&(W.estado_id=b.estado_id),b.area_id.length&&(W.area_id=b.area_id),b.canal_id.length&&(W.canal_id=b.canal_id),b.vendedor_id.length&&(W.vendedor_id=b.vendedor_id),b.planta_id.length&&(W.planta_id=b.planta_id),y(W)},T=U=>{y(W=>({...W,page:U}))},F=U=>{e&&e("gestionar-ot",U)},[w,P]=C.useState(!1),M=async()=>{P(!0);try{await i7.downloadOTsListExcel({estado_id:b.estado_id[0],area_id:b.area_id[0],canal_id:b.canal_id[0],client_id:b.client_id[0],fecha_desde:b.date_desde||void 0,fecha_hasta:b.date_hasta||void 0})}catch(U){console.error("Error exportando a Excel:",U),alert("Error al exportar a Excel")}finally{P(!1)}},A=(U,W)=>{switch(U){case 1:case 5:return W<=1?"badge-success":W<=2?"badge-warning":"badge-danger";case 2:return W<=1?"badge-success":W<=2?"badge-warning":"badge-danger";case 3:case 4:return W<=2?"badge-success":W<=3?"badge-warning":"badge-danger";case 6:return W<=3?"badge-success":W<=5?"badge-warning":"badge-danger";default:return W<=2?"badge-success":W<=5?"badge-warning":"badge-danger"}},D=(U,W,R=!1,ae=null,le=0)=>{if(U==null||U===0)return a.jsx("span",{className:"badge badge-secondary",children:"0"});const G=A(le,U);return R&&ae?a.jsxs("span",{className:`badge ${G}`,title:`${W}: ${U} dias (desde ${ae})`,children:[ae," ",a.jsx("strong",{children:U.toFixed(1)})]}):a.jsx("span",{className:`badge ${G}`,title:`${W}: ${U} dias`,children:U.toFixed(1)})},H=U=>{switch(U){case 6:return a.jsx("span",{className:"ot-icon",title:"Licitacion",children:""});case 7:return a.jsx("span",{className:"ot-icon",title:"Proyecto Innovacion",children:""});default:return null}};return a.jsxs("div",{className:"work-orders-dashboard",children:[a.jsxs("div",{className:"dashboard-header",children:[a.jsx("h1",{children:"Ordenes de Trabajo"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("crear-ot"),children:"Crear OT"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>e==null?void 0:e("notificaciones"),children:"Notificaciones OT"}),a.jsx("button",{className:"btn btn-secondary",onClick:M,disabled:w,title:"Exportar lista de OTs a Excel",children:w?"Exportando...":"Exportar Excel"})]})]}),a.jsxs("form",{className:"filters-form",onSubmit:S,children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Desde"}),a.jsx("input",{type:"date",value:b.date_desde,onChange:U=>x(W=>({...W,date_desde:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Hasta"}),a.jsx("input",{type:"date",value:b.date_hasta,onChange:U=>x(W=>({...W,date_hasta:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"ID OT"}),a.jsx("input",{type:"text",value:b.id_ot,onChange:U=>x(W=>({...W,id_ot:U.target.value})),placeholder:"Ej: 26590"})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Material"}),a.jsx("input",{type:"text",value:b.material,onChange:U=>x(W=>({...W,material:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Creador"}),a.jsx("select",{multiple:!0,value:b.vendedor_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,vendedor_id:W}))},children:l==null?void 0:l.vendedores.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Canal"}),a.jsx("select",{multiple:!0,value:b.canal_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,canal_id:W}))},children:l==null?void 0:l.canales.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsx("select",{multiple:!0,value:b.estado_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,estado_id:W}))},children:l==null?void 0:l.estados.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Area"}),a.jsx("select",{multiple:!0,value:b.area_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,area_id:W}))},children:l==null?void 0:l.areas.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Cliente"}),a.jsx("select",{multiple:!0,value:b.client_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,client_id:W}))},children:l==null?void 0:l.clientes.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"CAD"}),a.jsx("input",{type:"text",value:b.cad,onChange:U=>x(W=>({...W,cad:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Carton"}),a.jsx("input",{type:"text",value:b.carton,onChange:U=>x(W=>({...W,carton:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Descripcion"}),a.jsx("input",{type:"text",value:b.descripcion,onChange:U=>x(W=>({...W,descripcion:U.target.value}))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Planta"}),a.jsx("select",{multiple:!0,value:b.planta_id.map(String),onChange:U=>{const W=Array.from(U.target.selectedOptions,R=>parseInt(R.value));x(R=>({...R,planta_id:W}))},children:l==null?void 0:l.plantas.map(U=>a.jsx("option",{value:U.id,children:U.nombre},U.id))})]})]}),a.jsxs("div",{className:"filter-actions",children:[a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Filtrar"}),a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{x({id_ot:"",date_desde:"",date_hasta:"",cad:"",carton:"",material:"",descripcion:"",client_id:[],estado_id:[],area_id:[],canal_id:[],vendedor_id:[],planta_id:[]}),y({page:1,page_size:20})},children:"Limpiar"})]})]}),a.jsx("div",{className:"results-info",children:a.jsxs("span",{children:["Mostrando ",t.length," de ",_," registros"]})}),s&&a.jsxs("div",{className:"alert alert-error",children:[s,a.jsx("button",{onClick:j,children:"Reintentar"})]}),n&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{children:"Cargando..."})]}),a.jsx("div",{className:"table-container",children:a.jsxs("table",{className:"ot-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"OT"}),a.jsx("th",{children:"Creacion"}),a.jsx("th",{children:"Cliente"}),a.jsx("th",{children:"Descripcion"}),a.jsx("th",{children:"Canal"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{title:"Tiempo Total",children:"T"}),a.jsx("th",{children:"Ventas"}),a.jsx("th",{children:"Dis. Estructural"}),a.jsx("th",{children:"Muestra"}),a.jsx("th",{children:"Dis. Grafico"}),a.jsx("th",{children:"Dis. Externo"}),a.jsx("th",{children:"Calc. Paletizado"}),a.jsx("th",{children:"Catalogacion"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(U=>{var W;return a.jsxs("tr",{children:[a.jsxs("td",{children:[H(U.tipo_solicitud),a.jsx("span",{title:`Creador: ${U.creador_nombre}`,children:U.id})]}),a.jsx("td",{children:U.created_at}),a.jsx("td",{className:"truncate",title:U.client_name,children:U.client_name}),a.jsx("td",{className:"truncate",title:U.descripcion,children:U.descripcion}),a.jsx("td",{className:"center",children:(W=U.canal)==null?void 0:W.charAt(0)}),a.jsx("td",{children:U.item_tipo}),a.jsx("td",{title:U.estado,children:U.estado_abrev}),a.jsx("td",{className:"time-cell time-total",children:a.jsxs("span",{className:"badge badge-total",title:`Tiempo Total: ${U.tiempo_total} dias`,children:[" ",Math.round(U.tiempo_total||0)]})}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_venta,"Ventas",U.current_area_id===1,U.ultimo_cambio_area,1)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_desarrollo,"Desarrollo",U.current_area_id===2,U.ultimo_cambio_area,2)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_muestra,"Muestra",U.current_area_id===6,U.ultimo_cambio_area,6)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_diseno,"Diseno",U.current_area_id===3,U.ultimo_cambio_area,3)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_externo,"Externo",!1,null,0)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_precatalogacion,"Precatalogacion",U.current_area_id===5,U.ultimo_cambio_area,5)}),a.jsx("td",{className:"time-cell",children:D(U.tiempo_catalogacion,"Catalogacion",U.current_area_id===4,U.ultimo_cambio_area,4)}),a.jsx("td",{className:"actions",children:a.jsx("button",{className:"btn-icon",onClick:()=>F(U.id),title:"Ver OT",children:""})})]},U.id)})})]})}),f>1&&a.jsxs("div",{className:"pagination",children:[a.jsx("button",{disabled:u===1,onClick:()=>T(u-1),children:"Anterior"}),a.jsxs("span",{children:["Pagina ",u," de ",f]}),a.jsx("button",{disabled:u===f,onClick:()=>T(u+1),children:"Siguiente"})]})]})}const w$={cad_id:null,carton_id:null,pegado_id:null,tiempo_unitario:"",carton_muestra_id:null,destinatarios_id:[],cantidad_vendedor:null,comentario_vendedor:"Retira Vendedor",cantidad_disenador:null,comentario_disenador:"",cantidad_disenador_revision:null,comentario_disenador_revision:"",cantidad_laboratorio:null,comentario_laboratorio:"",destinatario_1:"",comuna_1:null,direccion_1:"",cantidad_1:null,comentario_1:"",destinatario_2:"",comuna_2:null,direccion_2:"",cantidad_2:null,comentario_2:"",destinatario_3:"",comuna_3:null,direccion_3:"",cantidad_3:null,comentario_3:"",destinatario_4:"",comuna_4:null,direccion_4:"",cantidad_4:null,comentario_4:""},b7=[{id:"1",nombre:"Retira Ventas VB"},{id:"2",nombre:"Retira Diseador VB"},{id:"3",nombre:"Envo Laboratorio"},{id:"4",nombre:"Envo Cliente VB"},{id:"5",nombre:"Retira Diseador Revisin"}],j7=[{id:1,nombre:"Sin Pegar"},{id:2,nombre:"Pegado Flexo Interior"},{id:3,nombre:"Pegado Flexo Exterior"},{id:4,nombre:"Pegado Diecutter"},{id:5,nombre:"Pegado Cajas Fruta"},{id:6,nombre:"Pegado con Cinta"},{id:7,nombre:"Sin Pegar con Cinta"}],Yp=[{id:"Chile Express",nombre:"Chile Express"},{id:"Auto Correo",nombre:"Auto Correo"},{id:"Camin",nombre:"Camin"}],k$=p.div`
  background: white;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
`,S$=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
`,C$=p.h3`
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,$$=p.div`
  padding: 1rem;
`,ls=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,gt=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,xt=p.label`
  font-size: 0.8rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,mr=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Ya=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,w7=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,kh=p.div`
  display: ${e=>e.$visible?"block":"none"};
  margin-top: 1rem;
  padding: 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  background: #fafafa;
`,Sh=p.h4`
  text-align: center;
  color: ${d.colors.primary};
  margin: 0 0 1rem 0;
  font-size: 0.95rem;
`,k7=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,E$=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border: none;

    &:hover {
      background: ${d.colors.primaryDark};
    }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border: 1px solid ${d.colors.border};

    &:hover {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function S7({isOpen:e,onClose:t,onSave:r,cadId:n,cartonId:i,tipoSolicitud:s,cads:o=[],cartones:l=[],cartonesMuestra:c=[],comunas:u=[]}){const[h,f]=C.useState({...w$,cad_id:n||null,carton_id:i||null}),m=C.useMemo(()=>s===1||s===4||s===7,[s]),_=C.useMemo(()=>({vendedor:h.destinatarios_id.includes("1"),disenador:h.destinatarios_id.includes("2"),laboratorio:h.destinatarios_id.includes("3"),clientes:h.destinatarios_id.includes("4"),disenadorRevision:h.destinatarios_id.includes("5")}),[h.destinatarios_id]),g=C.useCallback((x,j)=>{f(S=>({...S,[x]:j}))},[]),v=C.useCallback(x=>{const j=Array.from(x.target.selectedOptions).map(S=>S.value);f(S=>({...S,destinatarios_id:j}))},[]),y=C.useCallback(()=>{let x=0;_.vendedor&&h.cantidad_vendedor&&(x+=h.cantidad_vendedor),_.disenador&&h.cantidad_disenador&&(x+=h.cantidad_disenador),_.disenadorRevision&&h.cantidad_disenador_revision&&(x+=h.cantidad_disenador_revision),_.laboratorio&&h.cantidad_laboratorio&&(x+=h.cantidad_laboratorio),_.clientes&&(x+=(h.cantidad_1||0)+(h.cantidad_2||0)+(h.cantidad_3||0)+(h.cantidad_4||0)),r(h,x)},[h,_,r]),b=C.useCallback(()=>{f({...w$,cad_id:n||null,carton_id:i||null}),t()},[n,i,t]);return a.jsxs($I,{isOpen:e,onClose:b,title:"Crear Muestra",size:"xl",children:[a.jsxs(k$,{children:[a.jsx(S$,{children:a.jsx(C$,{children:"Caracteristicas de Muestra"})}),a.jsx($$,{children:a.jsxs(ls,{$columns:3,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"CAD"}),a.jsxs(Ya,{value:h.cad_id||"",onChange:x=>g("cad_id",x.target.value?Number(x.target.value):null),disabled:m,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),o.map(x=>a.jsx("option",{value:x.id,children:x.codigo||x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cartn"}),a.jsxs(Ya,{value:h.carton_id||"",onChange:x=>g("carton_id",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),l.map(x=>a.jsx("option",{value:x.id,children:x.codigo||x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Tipo de Pegado"}),a.jsxs(Ya,{value:h.pegado_id||"",onChange:x=>g("pegado_id",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),j7.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Tiempo Unitario"}),a.jsx(mr,{type:"time",value:h.tiempo_unitario,onChange:x=>g("tiempo_unitario",x.target.value),disabled:!0})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cartn Muestra"}),a.jsxs(Ya,{value:h.carton_muestra_id||"",onChange:x=>g("carton_muestra_id",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),c.map(x=>a.jsx("option",{value:x.id,children:x.codigo||x.nombre||x.id},String(x.id)))]})]})]})})]}),a.jsxs(k$,{children:[a.jsx(S$,{children:a.jsx(C$,{children:"Destinos"})}),a.jsxs($$,{children:[a.jsx(ls,{$columns:1,children:a.jsxs(gt,{children:[a.jsx(xt,{children:"Enviar Muestras a"}),a.jsx(w7,{multiple:!0,value:h.destinatarios_id,onChange:v,children:b7.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))})]})}),a.jsx("h4",{style:{textAlign:"center",color:"#7f7f7f",marginTop:"1.5rem"},children:"Datos de Muestra"}),a.jsxs(kh,{$visible:_.vendedor,children:[a.jsx(Sh,{children:"Retira Ventas VB"}),a.jsxs(ls,{$columns:3,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_vendedor||"",onChange:x=>g("cantidad_vendedor",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Entrega"}),a.jsx(mr,{type:"text",value:h.comentario_vendedor,onChange:x=>g("comentario_vendedor",x.target.value),disabled:!0,readOnly:!0})]})]})]}),a.jsxs(kh,{$visible:_.disenador,children:[a.jsx(Sh,{children:"Retira Diseador VB"}),a.jsxs(ls,{$columns:3,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_disenador||"",onChange:x=>g("cantidad_disenador",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Entrega"}),a.jsx(mr,{type:"text",value:h.comentario_disenador,onChange:x=>g("comentario_disenador",x.target.value)})]})]})]}),a.jsxs(kh,{$visible:_.disenadorRevision,children:[a.jsx(Sh,{children:"Retira Diseador Revisin"}),a.jsxs(ls,{$columns:3,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_disenador_revision||"",onChange:x=>g("cantidad_disenador_revision",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Entrega"}),a.jsx(mr,{type:"text",value:h.comentario_disenador_revision,onChange:x=>g("comentario_disenador_revision",x.target.value)})]})]})]}),a.jsxs(kh,{$visible:_.laboratorio,children:[a.jsx(Sh,{children:"Envo Laboratorio"}),a.jsxs(ls,{$columns:3,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_laboratorio||"",onChange:x=>g("cantidad_laboratorio",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Envo"}),a.jsx(mr,{type:"text",value:h.comentario_laboratorio,onChange:x=>g("comentario_laboratorio",x.target.value)})]})]})]}),a.jsxs(kh,{$visible:_.clientes,children:[a.jsx(Sh,{children:"Envo Cliente VB"}),a.jsxs(ls,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Destinatario 1"}),a.jsx(mr,{type:"text",value:h.destinatario_1,onChange:x=>g("destinatario_1",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Comuna"}),a.jsxs(Ya,{value:h.comuna_1||"",onChange:x=>g("comuna_1",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(x=>a.jsx("option",{value:x.id,children:x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Direccin"}),a.jsx(mr,{type:"text",value:h.direccion_1,onChange:x=>g("direccion_1",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_1||"",onChange:x=>g("cantidad_1",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Envo"}),a.jsxs(Ya,{value:h.comentario_1,onChange:x=>g("comentario_1",x.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Yp.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]})]}),a.jsxs(ls,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Destinatario 2"}),a.jsx(mr,{type:"text",value:h.destinatario_2,onChange:x=>g("destinatario_2",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Comuna"}),a.jsxs(Ya,{value:h.comuna_2||"",onChange:x=>g("comuna_2",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(x=>a.jsx("option",{value:x.id,children:x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Direccin"}),a.jsx(mr,{type:"text",value:h.direccion_2,onChange:x=>g("direccion_2",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_2||"",onChange:x=>g("cantidad_2",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Envo"}),a.jsxs(Ya,{value:h.comentario_2,onChange:x=>g("comentario_2",x.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Yp.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]})]}),a.jsxs(ls,{$columns:5,style:{marginBottom:"1rem"},children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Destinatario 3"}),a.jsx(mr,{type:"text",value:h.destinatario_3,onChange:x=>g("destinatario_3",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Comuna"}),a.jsxs(Ya,{value:h.comuna_3||"",onChange:x=>g("comuna_3",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(x=>a.jsx("option",{value:x.id,children:x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Direccin"}),a.jsx(mr,{type:"text",value:h.direccion_3,onChange:x=>g("direccion_3",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_3||"",onChange:x=>g("cantidad_3",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Envo"}),a.jsxs(Ya,{value:h.comentario_3,onChange:x=>g("comentario_3",x.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Yp.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]})]}),a.jsxs(ls,{$columns:5,children:[a.jsxs(gt,{children:[a.jsx(xt,{children:"Destinatario 4"}),a.jsx(mr,{type:"text",value:h.destinatario_4,onChange:x=>g("destinatario_4",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Comuna"}),a.jsxs(Ya,{value:h.comuna_4||"",onChange:x=>g("comuna_4",x.target.value?Number(x.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),u.map(x=>a.jsx("option",{value:x.id,children:x.nombre||x.id},String(x.id)))]})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Direccin"}),a.jsx(mr,{type:"text",value:h.direccion_4,onChange:x=>g("direccion_4",x.target.value)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Cantidad"}),a.jsx(mr,{type:"number",min:"0",value:h.cantidad_4||"",onChange:x=>g("cantidad_4",x.target.value?Number(x.target.value):null)})]}),a.jsxs(gt,{children:[a.jsx(xt,{children:"Forma de Envo"}),a.jsxs(Ya,{value:h.comentario_4,onChange:x=>g("comentario_4",x.target.value),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),Yp.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]})]})]})]})]}),a.jsxs(k7,{children:[a.jsx(E$,{type:"button",onClick:b,children:"Cancelar"}),a.jsx(E$,{type:"button",$variant:"primary",onClick:y,children:"Guardar Muestra"})]})]})}const C7=p.div`
  position: relative;
  width: 100%;
`,$7=p.div`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$isOpen?"#17a2b8":"#ddd"};
  border-radius: 4px;
  font-size: 0.85rem;
  background: ${e=>e.$disabled?"#f5f5f5":"white"};
  cursor: ${e=>e.$disabled?"not-allowed":"pointer"};
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 38px;
  color: ${e=>e.$disabled?"#666":"#333"};

  ${e=>e.$isOpen&&`
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  `}

  &:hover {
    border-color: ${e=>e.$disabled?"#ddd":"#17a2b8"};
  }
`,E7=p.span`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
  color: ${e=>e.$isPlaceholder?"#999":"inherit"};
`,T7=p.span`
  margin-left: 0.5rem;
  transition: transform 0.2s;
  transform: ${e=>e.$isOpen?"rotate(180deg)":"rotate(0)"};
  color: #666;
`,A7=p.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid #17a2b8;
  border-top: none;
  border-radius: 0 0 4px 4px;
  z-index: 1000;
  display: ${e=>e.$isOpen?"block":"none"};
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  max-height: 300px;
  overflow: hidden;
`,F7=p.input`
  width: 100%;
  padding: 0.5rem;
  border: none;
  border-bottom: 1px solid #eee;
  font-size: 0.85rem;
  outline: none;
  box-sizing: border-box;

  &:focus {
    border-bottom-color: #17a2b8;
  }
`,D7=p.div`
  max-height: 250px;
  overflow-y: auto;
`,T$=p.div`
  padding: 0.5rem 0.75rem;
  cursor: pointer;
  font-size: 0.85rem;
  background: ${e=>e.$isSelected?"#e3f2fd":e.$isHighlighted?"#f5f5f5":"white"};
  color: ${e=>e.$isSelected?"#17a2b8":"#333"};

  &:hover {
    background: ${e=>e.$isSelected?"#e3f2fd":"#f5f5f5"};
  }
`,P7=p.div`
  padding: 0.75rem;
  text-align: center;
  color: #666;
  font-size: 0.85rem;
`;function zP({options:e,value:t,onChange:r,getOptionValue:n,getOptionLabel:i,placeholder:s="Seleccionar...",disabled:o=!1,loading:l=!1}){const[c,u]=C.useState(!1),[h,f]=C.useState(""),[m,_]=C.useState(-1),g=C.useRef(null),v=C.useRef(null),y=e.find(w=>n(w)===t),b=y?i(y):s,x=e.filter(w=>i(w).toLowerCase().includes(h.toLowerCase()));C.useEffect(()=>{const w=P=>{g.current&&!g.current.contains(P.target)&&(u(!1),f(""))};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),C.useEffect(()=>{c&&v.current&&v.current.focus()},[c]),C.useEffect(()=>{_(-1)},[h]);const j=C.useCallback(()=>{!o&&!l&&(u(w=>!w),c||f(""))},[o,l,c]),S=C.useCallback(w=>{r(n(w)),u(!1),f("")},[r,n]),T=C.useCallback(w=>{w.stopPropagation(),r(null)},[r]),F=C.useCallback(w=>{if(c)switch(w.key){case"ArrowDown":w.preventDefault(),_(P=>P<x.length-1?P+1:P);break;case"ArrowUp":w.preventDefault(),_(P=>P>0?P-1:P);break;case"Enter":w.preventDefault(),m>=0&&m<x.length&&S(x[m]);break;case"Escape":u(!1),f("");break}},[c,m,x,S]);return a.jsxs(C7,{ref:g,children:[a.jsxs($7,{onClick:j,$isOpen:c,$disabled:o||l,children:[a.jsx(E7,{$isPlaceholder:!y,children:l?"Cargando...":b}),y&&!o&&a.jsx("span",{onClick:T,style:{marginRight:"0.5rem",color:"#999",cursor:"pointer"},children:""}),a.jsx(T7,{$isOpen:c,children:""})]}),a.jsxs(A7,{$isOpen:c,children:[a.jsx(F7,{ref:v,type:"text",value:h,onChange:w=>f(w.target.value),onKeyDown:F,placeholder:"Buscar..."}),a.jsxs(D7,{children:[a.jsx(T$,{$isSelected:!t,$isHighlighted:m===-1,onClick:()=>{r(null),u(!1),f("")},children:"-"}),x.length===0?a.jsx(P7,{children:"No se encontraron resultados"}):x.map((w,P)=>a.jsx(T$,{$isSelected:n(w)===t,$isHighlighted:P===m,onClick:()=>S(w),children:i(w)},n(w)))]})]})]})}function IP(){return Nt({queryKey:["workOrderFilterOptions"],queryFn:()=>Fn.getFilterOptions(),staleTime:1e3*60*10})}function LP(e){return Nt({queryKey:["workOrder",e],queryFn:()=>Fn.get(e),enabled:!!e})}function M7(e){return Nt({queryKey:["managementHistory",e],queryFn:()=>Fn.getManagementHistory(e),enabled:!!e})}function O7(e){return Nt({queryKey:["workflowOptions",e],queryFn:()=>Fn.getWorkflowOptions(e),enabled:!!e})}function R7(){const e=Pr();return jt({mutationFn:({id:t,data:r})=>Fn.transition(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["managementHistory",r.id]}),e.invalidateQueries({queryKey:["workOrders"]}),e.invalidateQueries({queryKey:["workOrder",r.id]}),e.invalidateQueries({queryKey:["filesByArea",r.id]})}})}function N7(e=1,t=20){return Nt({queryKey:["notifications",e,t],queryFn:()=>NP.list(e,t)})}function z7(){const e=Pr();return jt({mutationFn:t=>NP.markAsRead(t),onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]}),e.invalidateQueries({queryKey:["notificationsCount"]})}})}function BP(){return Nt({queryKey:["formOptionsComplete"],queryFn:()=>l7.getFormOptionsComplete(),staleTime:1e3*60*5})}const js={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,API:17,SuperAdministrador:18,VendedorExterno:19},A$=()=>{try{const e=localStorage.getItem("inveb_ot_user");if(e)return JSON.parse(e).role_id||js.Vendedor}catch{}return js.Vendedor},I7=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,L7=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,B7=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,F$=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Qa=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,In=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,Ln=p.div`
  padding: 1rem;
`,Pi=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,U7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.75rem;
  width: 100%;
  max-width: 100%;
  overflow: hidden;

  & > div {
    min-width: 0;
    overflow: hidden;
  }

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,V7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: 1fr 1fr;
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,e_=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  overflow: hidden;
`,ge=p.div`
  display: flex;
  flex-direction: column;
`,ue=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,Se=p.input`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Ve=p.select`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: ${e=>e.$hasError?"#fff5f5":"white"};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,H7=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${e=>e.$hasError?"#dc3545":d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;
  background: ${e=>e.$hasError?"#fff5f5":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":d.colors.primary};
    box-shadow: 0 0 0 2px ${e=>e.$hasError?"#dc354520":d.colors.primary+"20"};
  }
`,kt=p.span`
  font-size: 0.7rem;
  color: #dc3545;
  margin-top: 0.25rem;
  display: block;
`,t_=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,Bn=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,W7=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,G7=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,D$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,P$={client_id:null,descripcion:"",tipo_solicitud:null,canal_id:null,org_venta_id:null,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",volumen_venta_anual:null,usd_monto:"",codigo_producto:"",oc:null,hierarchy_id:null,subhierarchy_id:null,subsubhierarchy_id:null,ant_des_correo_cliente:!1,ant_des_plano_actual:!1,ant_des_boceto_actual:!1,ant_des_spec:!1,ant_des_otro:!1,ant_des_cj_referencia_de:!1,ant_des_cj_referencia_dg:!1,ant_des_envase_primario:!1,ant_des_conservar_muestra:null,armado_automatico:null,analisis:!1,prueba_industrial:!1,muestra:!1,numero_muestras:null,reference_type:null,reference_id:null,bloqueo_referencia:null,indicador_facturacion:null,ant_des_vb_muestra:!1,ant_des_vb_boceto:!1,cascadeData:{productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null},cad_id:null,cad_text:"",matriz_id:null,tipo_matriz_text:"",items_set:null,veces_item:null,style_id:null,caracteristicas_adicionales:"",largura_hm:null,anchura_hm:null,area_producto_m2:null,recorte_adicional_m2:null,longitud_pegado_mm:null,golpes_largo:null,golpes_ancho:null,separacion_golpes_largo:null,separacion_golpes_ancho:null,cuchillas_ml:null,rayado_c1_r1:null,rayado_r1_r2:null,rayado_r2_c2:null,pallet_qa_id:null,pais_id:null,restriccion_pallet:null,tamano_pallet_type_id:null,altura_pallet:null,permite_sobresalir_carga:null,bulto_zunchado_pallet:null,formato_etiqueta_pallet:null,etiquetas_por_pallet:null,termocontraible:null,bct_min_lb:null,bct_min_kg:null,bct_humedo_lb:null,ect_min_lb_pulg:null,gramaje_g_m2:null,mullen_lb_pulg2:null,fct_lb_pulg2:null,dst_bpi:null,espesor_placa_mm:null,espesor_caja_mm:null,cobb_interior_g_m2:null,cobb_exterior_g_m2:null,flexion_aleta_n:null,peso_cliente_g:null,incision_rayado_longitudinal:"",incision_rayado_transversal:"",porosidad:"",brillo:"",rigidez_4_ptos_long:"",rigidez_4_ptos_transv:"",angulo_deslizamiento_exterior:"",angulo_deslizamiento_interior:"",resistencia_frote:"",contenido_reciclado:"",interno_largo:null,interno_ancho:null,interno_alto:null,externo_largo:null,externo_ancho:null,externo_alto:null,process_id:null,armado_id:null,sentido_armado:null,numero_colores:null,color_1_id:null,color_2_id:null,color_3_id:null,color_4_id:null,color_5_id:null,color_6_id:null,trazabilidad:null,design_type_id:null,complejidad:"",percentage_coverage_internal:null,percentage_coverage_external:null,impresion_1:null,impresion_2:null,impresion_3:null,impresion_4:null,impresion_5:null,impresion_6:null,cm2_clisse_color_1:null,cm2_clisse_color_2:null,cm2_clisse_color_3:null,cm2_clisse_color_4:null,cm2_clisse_color_5:null,cm2_clisse_color_6:null,cm2_clisse_color_7:null,barniz_uv:null,porcentaje_barniz_uv:null,indicador_facturacion_diseno_grafico:"",prueba_color:null,impresion_borde:"",impresion_sobre_rayado:"",total_cm2_clisse:null,pegado_terminacion:null,maquila:null,maquila_servicio_id:null,material_asignado:"",descripcion_material:"",product_type_developing_id:null,food_type_id:null,expected_use_id:null,recycled_use_id:null,class_substance_packed_id:null,transportation_way_id:null,peso_contenido_caja:null,autosoportante:null,envase_id:null,cantidad_cajas_apiladas:null,pallet_sobre_pallet:null,cantidad:null,target_market_id:null,observacion:"",planta_id:null,so_planta_original:null,so_planta_original_select_values:"",so_planta_alt1:null,so_planta_alt1_select_values:"",so_planta_alt2:null,so_planta_alt2_select_values:"",secuencia_operacional_matrix:Array(6).fill(null).map(()=>Array(6).fill(null))},M$=[{id:1,nombre:"Desarrollo Completo"},{id:3,nombre:"Muestra con CAD"},{id:7,nombre:"OT Proyectos Innovacin"},{id:5,nombre:"Arte con Material"},{id:6,nombre:"Otras Solicitudes Desarrollo"}],q7=(e,t)=>e===js.VendedorExterno?M$.filter(r=>r.id===1||r.id===5):M$,K7=p.button`
  padding: 0.5rem 1rem;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: background 0.2s;

  &:hover {
    background: #218838;
  }
`,X7=p.div`
  display: flex;
  gap: 1rem;
  align-items: flex-end;
`;function O$({onNavigate:e,initialData:t}){var G,z,ie,ne,O,N,L,K,re,Z,me,B,se,we,V,Ce,qe,Te,E,_e,wt,Vr,pn,Nn,te,Pe,Qt,Wa,Fi,To,Hr,ka,tt,Xt,zn,sr,as,uh,Sp,Cp,hh,fh,ph,$p;const[r,n]=C.useState(P$),[i,s]=C.useState(null),[o,l]=C.useState(null),[c,u]=C.useState({}),[h,f]=C.useState([]),[m,_]=C.useState([]),[g,v]=C.useState(!1),[y,b]=C.useState(!1),[x,j]=C.useState(!1),S=Pr(),{data:T,isLoading:F}=IP(),{data:w,isLoading:P}=BP(),M=C.useMemo(()=>!(w!=null&&w.subhierarchies)||!r.hierarchy_id?[]:w.subhierarchies.filter(k=>k.hierarchy_id===r.hierarchy_id),[w==null?void 0:w.subhierarchies,r.hierarchy_id]),A=C.useMemo(()=>!(w!=null&&w.subsubhierarchies)||!r.subhierarchy_id?[]:w.subsubhierarchies.filter(k=>k.subhierarchy_id===r.subhierarchy_id),[w==null?void 0:w.subsubhierarchies,r.subhierarchy_id]),D=C.useMemo(()=>{const k=A$();return q7(k)},[]);C.useEffect(()=>{r.hierarchy_id&&n(k=>({...k,subhierarchy_id:null,subsubhierarchy_id:null}))},[r.hierarchy_id]),C.useEffect(()=>{r.tipo_solicitud===3&&(j(!0),n(k=>({...k,muestra:!0})))},[r.tipo_solicitud]),C.useEffect(()=>{r.subhierarchy_id&&n(k=>({...k,subsubhierarchy_id:null}))},[r.subhierarchy_id]),C.useEffect(()=>{if(r.canal_id&&(T!=null&&T.canales)&&(w!=null&&w.hierarchies)){const k=T.canales.find(ft=>ft.id===r.canal_id);if(k){const ft=w.hierarchies.find(Et=>{var mn,or;return((mn=Et.nombre)==null?void 0:mn.toUpperCase())===((or=k.nombre)==null?void 0:or.toUpperCase())});ft&&n(Et=>({...Et,hierarchy_id:Number(ft.id),subhierarchy_id:null,subsubhierarchy_id:null}))}}},[r.canal_id,T==null?void 0:T.canales,w==null?void 0:w.hierarchies]),C.useEffect(()=>{console.log("[DEBUG] useEffect client_id ejecutado, client_id=",r.client_id),r.client_id?(v(!0),f([]),_([]),n(k=>({...k,instalacion_cliente_id:null,contactos_cliente_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:""})),console.log("[DEBUG] Llamando cascadesApi.getInstalacionesCliente con client_id=",r.client_id),s1.getInstalacionesCliente(r.client_id).then(k=>{console.log("[DEBUG] Instalaciones recibidas:",k),f(k)}).catch(k=>console.error("[DEBUG] Error cargando instalaciones:",k)).finally(()=>v(!1))):(f([]),_([]))},[r.client_id]),C.useEffect(()=>{r.client_id&&(b(!0),_([]),s1.getContactosCliente(r.client_id,r.instalacion_cliente_id||void 0).then(k=>_(k)).catch(k=>console.error("Error cargando contactos:",k)).finally(()=>b(!1)))},[r.client_id,r.instalacion_cliente_id]),C.useEffect(()=>{if(r.contactos_cliente_id){const k=m.find(ft=>ft.id===r.contactos_cliente_id);k&&n(ft=>({...ft,nombre_contacto:k.nombre||"",email_contacto:k.email||"",telefono_contacto:k.telefono||""}))}},[r.contactos_cliente_id,m]),C.useEffect(()=>{t&&n(k=>({...k,client_id:t.client_id||null,descripcion:t.descripcion||"",tipo_solicitud:t.tipo_solicitud||null,nombre_contacto:t.nombre_contacto||"",email_contacto:t.email_contacto||"",telefono_contacto:t.telefono_contacto||"",codigo_producto:t.material_codigo||"",interno_largo:t.largo_interno||null,interno_ancho:t.ancho_interno||null,interno_alto:t.alto_interno||null,externo_largo:t.largo_externo||null,externo_ancho:t.ancho_externo||null,externo_alto:t.alto_externo||null,cantidad:t.cantidad||null}))},[t]);const H=jt({mutationFn:k=>Fn.create(k),onSuccess:k=>{s(`Orden de trabajo #${k.id} creada exitosamente`),l(null),S.invalidateQueries({queryKey:["workOrders"]}),setTimeout(()=>{e("dashboard")},2e3)},onError:k=>{l(k.message||"Error al crear la orden de trabajo"),s(null)}}),U=C.useCallback(k=>{n(ft=>({...ft,cascadeData:k}))},[]),W=C.useCallback(()=>{var I,Y,q,X,Q,J,ce,ve,oe,de,he,be,Ae,Re,ke,Me,Qe,zt,It,Mr,Fo,Do;const k={},ft=A$(),Et=r.tipo_solicitud,mn=Et===1||Et===4||Et===7,or=Et!==3,Ao=Et===3,Ga=Et===5,Wr=ft===js.Vendedor,qa=ft===js.VendedorExterno,Ka=ft===js.Ingeniero,Xa=ft===js.JefeDesarrollo,Cd=ft===js.Diseador,Os=ft===js.JefeVenta;if(r.client_id||(k.client_id="Campo obligatorio"),r.descripcion.trim()?r.descripcion.length>40&&(k.descripcion="Mximo 40 caracteres"):k.descripcion="Campo obligatorio",Et||(k.tipo_solicitud="Campo obligatorio"),r.canal_id||(k.canal_id="Campo obligatorio"),r.hierarchy_id&&!r.subhierarchy_id&&(k.subhierarchy_id="Campo obligatorio"),r.subhierarchy_id&&!r.subsubhierarchy_id&&(k.subsubhierarchy_id="Campo obligatorio"),(I=r.nombre_contacto)!=null&&I.trim()||(k.nombre_contacto="Campo obligatorio"),(Y=r.email_contacto)!=null&&Y.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email_contacto)||(k.email_contacto="Email invlido"):k.email_contacto="Campo obligatorio",(q=r.telefono_contacto)!=null&&q.trim()||(k.telefono_contacto="Campo obligatorio"),(X=r.observacion)!=null&&X.trim()?r.observacion.trim().length<10?k.observacion="Mnimo 10 caracteres":r.observacion.length>1e3&&(k.observacion="Mximo 1000 caracteres"):k.observacion="Campo obligatorio",(Q=r.cascadeData)!=null&&Q.impresion||(k.impresion="Campo obligatorio"),(J=r.cascadeData)!=null&&J.fsc||(k.fsc="Campo obligatorio"),r.sentido_armado||(k.sentido_armado="Campo obligatorio"),or&&Et&&(r.volumen_venta_anual||(k.volumen_venta_anual="Campo obligatorio"),(ce=r.usd_monto)!=null&&ce.trim()||(k.usd_monto="Campo obligatorio")),mn&&((ve=r.cascadeData)!=null&&ve.productTypeId||(k.product_type_id="Campo obligatorio"),r.peso_contenido_caja||(k.peso_contenido_caja="Campo obligatorio"),(r.autosoportante===null||r.autosoportante===void 0)&&(k.autosoportante="Campo obligatorio"),r.envase_id||(k.envase_id="Campo obligatorio"),r.cantidad_cajas_apiladas||(k.cantidad_cajas_apiladas="Campo obligatorio"),(r.pallet_sobre_pallet===null||r.pallet_sobre_pallet===void 0)&&(k.pallet_sobre_pallet="Campo obligatorio"),r.pallet_sobre_pallet===!0&&!r.cantidad&&(k.cantidad="Campo obligatorio")),(Et===1||Et===5||Et===7)&&((oe=r.cascadeData)!=null&&oe.cinta||(k.cinta="Campo obligatorio")),!((de=r.cascadeData)!=null&&de.cartonId)&&!((he=r.cascadeData)!=null&&he.cartonColor)&&mn&&(k.carton_color="Campo obligatorio"),Ga&&(r.reference_type||(k.reference_type="Campo obligatorio"),r.reference_type&&r.reference_type!==2&&(r.reference_id||(k.reference_id="Campo obligatorio"),r.bloqueo_referencia||(k.bloqueo_referencia="Campo obligatorio"))),(Wr||qa||Os)&&(Wr&&!r.org_venta_id&&(k.org_venta_id="Campo obligatorio"),(Wr||Os||qa||Cd)&&(mn||Ga)&&(r.restriccion_pallet===null||r.restriccion_pallet===void 0)&&(k.restriccion_pallet="Campo obligatorio"),Wr&&r.termocontraible===null&&(k.termocontraible="Campo obligatorio"),Wr&&r.armado_automatico===null&&(k.armado_automatico="Campo obligatorio"),(Wr||qa)&&or&&((be=r.cascadeData)!=null&&be.coverageInternalId||(k.coverage_internal_id="Campo obligatorio"),(Ae=r.cascadeData)!=null&&Ae.coverageExternalId||(k.coverage_external_id="Campo obligatorio"),(Re=r.cascadeData)!=null&&Re.coverageInternalId&&r.cascadeData.coverageInternalId!==1&&(r.percentage_coverage_internal||(k.percentage_coverage_internal="Campo obligatorio")),(ke=r.cascadeData)!=null&&ke.coverageExternalId&&r.cascadeData.coverageExternalId!==1&&(r.percentage_coverage_external||(k.percentage_coverage_external="Campo obligatorio"))),(Wr||qa||Ka)&&!((Me=r.cascadeData)!=null&&Me.plantaId)&&(k.planta_id="Campo obligatorio"),(Wr||Os||Xa||Ka)&&!r.impresion_borde&&(k.impresion_borde="Campo obligatorio"),(Wr||Os||Xa||Ka)&&!r.impresion_sobre_rayado&&(k.impresion_sobre_rayado="Campo obligatorio"),(Wr||Xa||Ka||Cd)&&!r.pegado_terminacion&&(k.pegado_terminacion="Campo obligatorio")),(Ka||Xa)&&((Qe=r.cascadeData)!=null&&Qe.plantaId||(k.planta_id="Campo obligatorio"),r.maquila||(k.maquila="Campo obligatorio"),r.impresion_borde||(k.impresion_borde="Campo obligatorio"),r.impresion_sobre_rayado||(k.impresion_sobre_rayado="Campo obligatorio"),(zt=r.caracteristicas_adicionales)!=null&&zt.trim()||(k.caracteristicas_adicionales="Campo obligatorio")),Xa&&!r.armado_id&&(k.armado_id="Campo obligatorio"),(Ao||Ga)&&(Wr||qa)&&((It=r.cascadeData)!=null&&It.cartonId||(k.carton_id="Campo obligatorio")),String((Mr=r.cascadeData)==null?void 0:Mr.fsc)==="1"&&(r.pais_id||(k.pais_id="Campo obligatorio")),r.restriccion_pallet===1&&(r.tamano_pallet_type_id||(k.tamano_pallet_type_id="Campo obligatorio"),r.altura_pallet||(k.altura_pallet="Campo obligatorio"),r.permite_sobresalir_carga===null&&(k.permite_sobresalir_carga="Campo obligatorio"),r.pallet_qa_id||(k.pallet_qa_id="Campo obligatorio"),r.bulto_zunchado_pallet===null&&(k.bulto_zunchado_pallet="Campo obligatorio"),r.formato_etiqueta_pallet||(k.formato_etiqueta_pallet="Campo obligatorio"),r.etiquetas_por_pallet||(k.etiquetas_por_pallet="Campo obligatorio")),or&&Et){const is=Number((Fo=r.cascadeData)==null?void 0:Fo.impresion);is!==5&&is!==6&&is!==7&&!r.numero_colores&&r.numero_colores!==0&&(k.numero_colores="Campo obligatorio")}return(mn||Ga)&&Number((Do=r.cascadeData)==null?void 0:Do.impresion)===2&&!r.design_type_id&&(k.design_type_id="Campo obligatorio"),ft===js.SuperAdministrador||(r.product_type_developing_id||(k.product_type_developing_id="Campo obligatorio"),r.target_market_id||(k.target_market_id="Campo obligatorio")),k},[r]),R=C.useCallback((k,ft)=>{n(Et=>({...Et,[k]:ft})),u(Et=>{if(Et[k]){const{[k]:mn,...or}=Et;return or}return Et})},[]),ae=C.useCallback(k=>{var mn,or,Ao,Ga,Wr,qa,Ka,Xa;k.preventDefault();const ft=W();if(u(ft),Object.keys(ft).length>0){const Cd=Object.keys(ft).length;l(`Por favor complete los ${Cd} campo(s) obligatorio(s) marcados en rojo`);const Os=document.querySelector('[data-has-error="true"]');Os&&Os.scrollIntoView({behavior:"smooth",block:"center"});return}l(null);const Et={client_id:r.client_id,descripcion:r.descripcion,tipo_solicitud:r.tipo_solicitud,canal_id:r.canal_id,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,oc:r.oc!==null?r.oc:void 0,subsubhierarchy_id:r.subsubhierarchy_id,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:((mn=r.cascadeData)==null?void 0:mn.productTypeId)||void 0,impresion:(or=r.cascadeData)!=null&&or.impresion?Number(r.cascadeData.impresion):void 0,fsc:((Ao=r.cascadeData)==null?void 0:Ao.fsc)||void 0,cinta:(Ga=r.cascadeData)!=null&&Ga.cinta?Number(r.cascadeData.cinta):void 0,coverage_internal_id:((Wr=r.cascadeData)==null?void 0:Wr.coverageInternalId)||void 0,coverage_external_id:((qa=r.cascadeData)==null?void 0:qa.coverageExternalId)||void 0,carton_color:(Ka=r.cascadeData)!=null&&Ka.cartonColor?Number(r.cascadeData.cartonColor):void 0,carton_id:((Xa=r.cascadeData)==null?void 0:Xa.cartonId)||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.planta_id||void 0};H.mutate(Et)},[r,H]),le=C.useCallback(()=>{n(P$),u({}),s(null),l(null)},[]);return a.jsxs(I7,{children:[a.jsxs(L7,{children:[a.jsx(B7,{children:"Crear Nueva Orden de Trabajo"}),a.jsx(F$,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]}),i&&a.jsx(D$,{$type:"success",children:i}),o&&a.jsx(D$,{$type:"error",children:o}),a.jsxs("form",{onSubmit:ae,children:[a.jsxs(Qa,{children:[a.jsx(In,{children:"1.- Seleccione el Tipo de Solicitud"}),a.jsx(Ln,{children:a.jsxs(X7,{children:[a.jsxs(ge,{style:{minWidth:"300px"},children:[a.jsx(ue,{children:"Tipo de solicitud:"}),a.jsxs(Ve,{id:"tipo_solicitud_select",value:r.tipo_solicitud||"",onChange:k=>R("tipo_solicitud",k.target.value?Number(k.target.value):null),disabled:!!r.tipo_solicitud,children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),D.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsx(K7,{type:"button",onClick:le,children:"Reiniciar Solicitud"})]})})]}),r.tipo_solicitud&&a.jsxs(a.Fragment,{children:[a.jsxs(Qa,{children:[a.jsx(In,{children:"2.- Datos comerciales"}),a.jsxs(Ln,{children:[a.jsxs(Pi,{$columns:3,children:[a.jsxs(ge,{"data-has-error":!!c.client_id,children:[a.jsx(ue,{style:{color:c.client_id?"#dc3545":void 0},children:"Cliente *"}),a.jsx(zP,{options:(T==null?void 0:T.clientes)||[],value:r.client_id,onChange:k=>R("client_id",k?Number(k):null),getOptionValue:k=>k.id,getOptionLabel:k=>`${k.nombre}${k.codigo?` - ${k.codigo}`:""}`,placeholder:"Seleccione cliente...",disabled:F,loading:F}),c.client_id&&a.jsx(kt,{children:c.client_id})]}),a.jsxs(ge,{"data-has-error":!!c.descripcion,children:[a.jsx(ue,{style:{color:c.descripcion?"#dc3545":void 0},children:"Descripcion del Producto *"}),a.jsx(Se,{$hasError:!!c.descripcion,type:"text",maxLength:40,value:r.descripcion,onChange:k=>R("descripcion",k.target.value),placeholder:"Max 40 caracteres"}),c.descripcion&&a.jsx(kt,{children:c.descripcion})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Codigo Producto"}),a.jsx(Se,{type:"text",value:r.codigo_producto,onChange:k=>R("codigo_producto",k.target.value)})]})]}),a.jsxs(Pi,{$columns:4,style:{marginTop:"1rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Tipo Solicitud *"}),a.jsxs(Ve,{value:r.tipo_solicitud||"",disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),D.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{"data-has-error":!!c.volumen_venta_anual,children:[a.jsxs(ue,{style:{color:c.volumen_venta_anual?"#dc3545":void 0},children:["Vol Vta Anual ",r.tipo_solicitud!==3?"*":""]}),a.jsx(Se,{$hasError:!!c.volumen_venta_anual,type:"number",value:r.volumen_venta_anual||"",onChange:k=>R("volumen_venta_anual",k.target.value?Number(k.target.value):null)}),c.volumen_venta_anual&&a.jsx(kt,{children:c.volumen_venta_anual})]}),a.jsxs(ge,{"data-has-error":!!c.usd_monto,children:[a.jsxs(ue,{style:{color:c.usd_monto?"#dc3545":void 0},children:["USD ",r.tipo_solicitud!==3?"*":""]}),a.jsx(Se,{$hasError:!!c.usd_monto,type:"text",value:r.usd_monto,onChange:k=>R("usd_monto",k.target.value),placeholder:"Monto USD"})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Jerarquia 1"}),a.jsxs(Ve,{value:r.hierarchy_id||"",onChange:k=>R("hierarchy_id",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),w==null?void 0:w.hierarchies.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]}),a.jsxs(Pi,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Instalacion Cliente"}),a.jsxs(Ve,{value:r.instalacion_cliente_id||"",onChange:k=>R("instalacion_cliente_id",k.target.value?Number(k.target.value):null),disabled:!r.client_id||g,children:[a.jsx("option",{value:"",children:g?"Cargando...":"Seleccione..."}),h.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{"data-has-error":!!c.org_venta_id,children:[a.jsx(ue,{style:{color:c.org_venta_id?"#dc3545":void 0},children:"Org Venta"}),a.jsxs(Ve,{$hasError:!!c.org_venta_id,value:r.org_venta_id||"",onChange:k=>R("org_venta_id",k.target.value?Number(k.target.value):null),disabled:F,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(G=T==null?void 0:T.org_ventas)==null?void 0:G.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.org_venta_id&&a.jsx(kt,{children:c.org_venta_id})]}),a.jsxs(ge,{"data-has-error":!!c.subhierarchy_id,children:[a.jsx(ue,{style:{color:c.subhierarchy_id?"#dc3545":void 0},children:"Jerarquia 2 *"}),a.jsxs(Ve,{$hasError:!!c.subhierarchy_id,value:r.subhierarchy_id||"",onChange:k=>R("subhierarchy_id",k.target.value?Number(k.target.value):null),disabled:!r.hierarchy_id||P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),M.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.subhierarchy_id&&a.jsx(kt,{children:c.subhierarchy_id})]})]}),a.jsxs(Pi,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Contactos Cliente"}),a.jsxs(Ve,{value:r.contactos_cliente_id||"",onChange:k=>R("contactos_cliente_id",k.target.value?Number(k.target.value):null),disabled:!r.client_id||y,children:[a.jsx("option",{value:"",children:y?"Cargando...":"Seleccionar Opcion"}),m.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{"data-has-error":!!c.canal_id,children:[a.jsx(ue,{style:{color:c.canal_id?"#dc3545":void 0},children:"Canal *"}),a.jsxs(Ve,{$hasError:!!c.canal_id,value:r.canal_id||"",onChange:k=>R("canal_id",k.target.value?Number(k.target.value):null),disabled:F,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),T==null?void 0:T.canales.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.canal_id&&a.jsx(kt,{children:c.canal_id})]}),a.jsxs(ge,{"data-has-error":!!c.subsubhierarchy_id,children:[a.jsx(ue,{style:{color:c.subsubhierarchy_id?"#dc3545":void 0},children:"Jerarquia 3 *"}),a.jsxs(Ve,{$hasError:!!c.subsubhierarchy_id,value:r.subsubhierarchy_id||"",onChange:k=>R("subsubhierarchy_id",k.target.value?Number(k.target.value):null),disabled:!r.subhierarchy_id||P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),A.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.subsubhierarchy_id&&a.jsx(kt,{children:c.subsubhierarchy_id})]})]}),a.jsxs(Pi,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ge,{"data-has-error":!!c.nombre_contacto,children:[a.jsx(ue,{style:{color:c.nombre_contacto?"#dc3545":void 0},children:"Nombre Contacto *"}),a.jsx(Se,{$hasError:!!c.nombre_contacto,type:"text",value:r.nombre_contacto,onChange:k=>R("nombre_contacto",k.target.value)}),c.nombre_contacto&&a.jsx(kt,{children:c.nombre_contacto})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"OC"}),a.jsxs(Ve,{value:r.oc===null?"":r.oc,onChange:k=>R("oc",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),a.jsx(ge,{})]}),a.jsxs(Pi,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ge,{"data-has-error":!!c.email_contacto,children:[a.jsx(ue,{style:{color:c.email_contacto?"#dc3545":void 0},children:"Email Contacto *"}),a.jsx(Se,{$hasError:!!c.email_contacto,type:"email",value:r.email_contacto,onChange:k=>R("email_contacto",k.target.value)}),c.email_contacto&&a.jsx(kt,{children:c.email_contacto})]}),a.jsx(ge,{}),a.jsx(ge,{})]}),a.jsxs(Pi,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(ge,{"data-has-error":!!c.telefono_contacto,children:[a.jsx(ue,{style:{color:c.telefono_contacto?"#dc3545":void 0},children:"Telefono Contacto *"}),a.jsx(Se,{$hasError:!!c.telefono_contacto,type:"tel",value:r.telefono_contacto,onChange:k=>R("telefono_contacto",k.target.value)}),c.telefono_contacto&&a.jsx(kt,{children:c.telefono_contacto})]}),a.jsx(ge,{}),a.jsx(ge,{})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5fr 2fr 5fr",gap:"1rem",marginBottom:"1rem"},children:[a.jsxs(Qa,{style:{marginBottom:0},children:[a.jsx(In,{children:"3.- Antecedentes Desarrollo"}),a.jsxs(Ln,{children:[a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(ue,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs(t_,{children:[a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:k=>R("ant_des_correo_cliente",k.target.checked)}),"Correo Cliente"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:k=>R("ant_des_plano_actual",k.target.checked)}),"Plano Actual"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:k=>R("ant_des_boceto_actual",k.target.checked)}),"Boceto Actual"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:k=>R("ant_des_spec",k.target.checked)}),"Spec"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:k=>R("ant_des_otro",k.target.checked)}),"Otro"]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"0.75rem"},children:[a.jsx(ue,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(t_,{children:[a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:k=>R("ant_des_cj_referencia_de",k.target.checked)}),"CJ Referencia DE"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:k=>R("ant_des_cj_referencia_dg",k.target.checked)}),"CJ Referencia DG"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:k=>R("ant_des_envase_primario",k.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"0.75rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[a.jsxs(ge,{style:{flex:1},children:[a.jsx(ue,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(Bn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>R("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>R("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(ge,{style:{flex:1},"data-has-error":!!c.armado_automatico,children:[a.jsx(ue,{style:{color:c.armado_automatico?"#dc3545":void 0},children:"Armado Automatico"}),a.jsxs(Ve,{$hasError:!!c.armado_automatico,value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:k=>R("armado_automatico",k.target.value===""?null:k.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.armado_automatico&&a.jsx(kt,{children:c.armado_automatico})]})]})]})]}),a.jsxs(Qa,{style:{marginBottom:0},children:[a.jsx(In,{children:"4.- Solicita"}),a.jsxs(Ln,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:k=>R("analisis",k.target.checked)}),"Analisis"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:k=>R("prueba_industrial",k.target.checked)}),"Prueba Industrial"]}),a.jsxs(Bn,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:k=>{k.target.checked?j(!0):(R("muestra",!1),R("numero_muestras",null))}}),"Muestra"]})]}),r.muestra&&a.jsxs(ge,{style:{marginTop:"1rem"},children:[a.jsx(ue,{children:"N Muestras"}),a.jsx(Se,{type:"number",min:"1",value:r.numero_muestras||"",onChange:k=>R("numero_muestras",k.target.value?Number(k.target.value):null),style:{width:"100px"},disabled:!0,readOnly:!0})]})]})]}),a.jsxs(Qa,{style:{marginBottom:0},children:[a.jsx(In,{children:"5.- Referencia Material"}),a.jsxs(Ln,{children:[a.jsxs(Pi,{$columns:2,children:[a.jsxs(ge,{"data-has-error":!!c.reference_type,children:[a.jsx(ue,{style:{color:c.reference_type?"#dc3545":void 0},children:"Tipo Referencia"}),a.jsxs(Ve,{$hasError:!!c.reference_type,value:r.reference_type===null?"":r.reference_type,onChange:k=>R("reference_type",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(z=w==null?void 0:w.reference_types)==null?void 0:z.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),c.reference_type&&a.jsx(kt,{children:c.reference_type})]}),a.jsxs(ge,{"data-has-error":!!c.reference_id,children:[a.jsx(ue,{style:{color:c.reference_id?"#dc3545":void 0},children:"Referencia"}),a.jsxs(Ve,{$hasError:!!c.reference_id,value:r.reference_id||"",onChange:k=>R("reference_id",k.target.value?Number(k.target.value):null),disabled:!r.reference_type,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ie=w==null?void 0:w.materials)==null?void 0:ie.map(k=>a.jsxs("option",{value:k.id,children:[k.codigo||k.nombre,k.descripcion?` - ${k.descripcion}`:""]},String(k.id)))]}),c.reference_id&&a.jsx(kt,{children:c.reference_id})]}),a.jsxs(ge,{"data-has-error":!!c.bloqueo_referencia,children:[a.jsx(ue,{style:{color:c.bloqueo_referencia?"#dc3545":void 0},children:"Bloqueo Referencia"}),a.jsxs(Ve,{$hasError:!!c.bloqueo_referencia,value:r.bloqueo_referencia===null?"":r.bloqueo_referencia,onChange:k=>R("bloqueo_referencia",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ne=w==null?void 0:w.bloqueo_referencia)==null?void 0:ne.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),c.bloqueo_referencia&&a.jsx(kt,{children:c.bloqueo_referencia})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Indicador Facturacion D.E."}),a.jsxs(Ve,{value:r.indicador_facturacion||"",onChange:k=>R("indicador_facturacion",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(O=w==null?void 0:w.indicador_facturacion)==null?void 0:O.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]})]})]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f8f9fa",borderRadius:"4px"},children:[a.jsx(ue,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Archivo Visto Bueno"}),a.jsxs(t_,{children:[a.jsxs(Bn,{style:{color:"#28a745",fontWeight:"bold"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_muestra,onChange:k=>R("ant_des_vb_muestra",k.target.checked)}),"VB Muestra"]}),a.jsxs(Bn,{style:{color:"#28a745",fontWeight:"bold"},children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_vb_boceto,onChange:k=>R("ant_des_vb_boceto",k.target.checked)}),"VB Boceto"]})]})]})]})]})]}),a.jsxs(Qa,{children:[a.jsx(In,{children:"6.- Asistente Para: Ingresos Principales"}),a.jsx(Ln,{children:a.jsx(vk,{values:r.cascadeData,onChange:U,fieldErrors:c})})]}),a.jsxs(Qa,{children:[a.jsx(In,{children:"7.- Caracteristicas"}),a.jsx(Ln,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem"},children:[a.jsxs("div",{children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"CAD"}),a.jsxs(Ve,{value:r.cad_id||"",onChange:k=>R("cad_id",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(N=w==null?void 0:w.cads)==null?void 0:N.map(k=>a.jsx("option",{value:k.id,children:k.codigo||k.nombre},String(k.id)))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Matriz"}),a.jsx(Ve,{value:r.matriz_id||"",onChange:k=>R("matriz_id",k.target.value?Number(k.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Tipo Matriz"}),a.jsx(Se,{type:"text",value:r.tipo_matriz_text,onChange:k=>R("tipo_matriz_text",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Tipo Item"}),a.jsx(Se,{type:"text",value:r.cascadeData.productTypeId&&((K=(L=w==null?void 0:w.product_types)==null?void 0:L.find(k=>k.id===r.cascadeData.productTypeId))==null?void 0:K.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Items del Set"}),a.jsx(Se,{type:"number",min:"0",value:r.items_set||"",onChange:k=>R("items_set",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Veces Item"}),a.jsx(Se,{type:"number",min:"0",value:r.veces_item||"",onChange:k=>R("veces_item",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color Carton"}),a.jsx(Se,{type:"text",value:r.cascadeData.cartonColor||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Carton"}),a.jsx(Se,{type:"text",value:r.cascadeData.cartonId&&((Z=(re=w==null?void 0:w.cartons)==null?void 0:re.find(k=>k.id===r.cascadeData.cartonId))==null?void 0:Z.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Cinta"}),a.jsx(Se,{type:"text",value:r.cascadeData.cinta!==null&&r.cascadeData.cinta!==void 0?Number(r.cascadeData.cinta)===1?"Si":"No":"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"FSC"}),a.jsx(Se,{type:"text",value:r.cascadeData.fsc?((B=(me=w==null?void 0:w.fsc)==null?void 0:me.find(k=>k.id===Number(r.cascadeData.fsc)))==null?void 0:B.nombre)||String(r.cascadeData.fsc):"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{"data-has-error":!!c.pallet_qa_id,children:[a.jsx(ue,{style:{color:c.pallet_qa_id?"#dc3545":void 0},children:"Certificado Calidad"}),a.jsx(Ve,{$hasError:!!c.pallet_qa_id,value:r.pallet_qa_id||"",onChange:k=>R("pallet_qa_id",k.target.value?Number(k.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})}),c.pallet_qa_id&&a.jsx(kt,{children:c.pallet_qa_id})]}),a.jsxs(ge,{"data-has-error":!!c.pais_id,children:[a.jsx(ue,{style:{color:c.pais_id?"#dc3545":void 0},children:"Pais/Mercado Destino"}),a.jsxs(Ve,{$hasError:!!c.pais_id,value:r.pais_id||"",onChange:k=>R("pais_id",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(se=w==null?void 0:w.pais_referencia)==null?void 0:se.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),c.pais_id&&a.jsx(kt,{children:c.pais_id})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Planta Objetivo"}),a.jsx(Se,{type:"text",value:r.cascadeData.plantaId&&((V=(we=w==null?void 0:w.plantas)==null?void 0:we.find(k=>k.id===r.cascadeData.plantaId))==null?void 0:V.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{"data-has-error":!!c.restriccion_pallet,children:[a.jsx(ue,{style:{color:c.restriccion_pallet?"#dc3545":void 0},children:"Restriccion Paletizado"}),a.jsxs(Ve,{$hasError:!!c.restriccion_pallet,value:r.restriccion_pallet===null?"":r.restriccion_pallet,onChange:k=>R("restriccion_pallet",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.restriccion_pallet&&a.jsx(kt,{children:c.restriccion_pallet})]}),a.jsxs(ge,{"data-has-error":!!c.tamano_pallet_type_id,children:[a.jsx(ue,{style:{color:c.tamano_pallet_type_id?"#dc3545":void 0},children:"Tamano Pallet"}),a.jsxs(Ve,{$hasError:!!c.tamano_pallet_type_id,value:r.tamano_pallet_type_id||"",onChange:k=>R("tamano_pallet_type_id",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ce=w==null?void 0:w.pallet_types)==null?void 0:Ce.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),c.tamano_pallet_type_id&&a.jsx(kt,{children:c.tamano_pallet_type_id})]}),a.jsxs(ge,{"data-has-error":!!c.altura_pallet,children:[a.jsx(ue,{style:{color:c.altura_pallet?"#dc3545":void 0},children:"Altura Pallet"}),a.jsx(Se,{$hasError:!!c.altura_pallet,type:"number",min:"0",value:r.altura_pallet||"",onChange:k=>R("altura_pallet",k.target.value?Number(k.target.value):null)}),c.altura_pallet&&a.jsx(kt,{children:c.altura_pallet})]}),a.jsxs(ge,{"data-has-error":!!c.permite_sobresalir_carga,children:[a.jsx(ue,{style:{color:c.permite_sobresalir_carga?"#dc3545":void 0},children:"Permite Sobresalir Carga"}),a.jsxs(Ve,{$hasError:!!c.permite_sobresalir_carga,value:r.permite_sobresalir_carga===null?"":r.permite_sobresalir_carga,onChange:k=>R("permite_sobresalir_carga",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.permite_sobresalir_carga&&a.jsx(kt,{children:c.permite_sobresalir_carga})]})]}),a.jsxs("div",{children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Estilo"}),a.jsxs(Ve,{value:r.style_id||"",onChange:k=>R("style_id",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(qe=w==null?void 0:w.styles)==null?void 0:qe.map(k=>a.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]})]}),a.jsxs(ge,{"data-has-error":!!c.caracteristicas_adicionales,children:[a.jsx(ue,{style:{color:c.caracteristicas_adicionales?"#dc3545":void 0},children:"Caracteristica Estilo"}),a.jsx(Se,{$hasError:!!c.caracteristicas_adicionales,type:"text",value:r.caracteristicas_adicionales,onChange:k=>R("caracteristicas_adicionales",k.target.value)}),c.caracteristicas_adicionales&&a.jsx(kt,{children:c.caracteristicas_adicionales})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Largura HM"}),a.jsx(Se,{type:"number",value:r.largura_hm||"",onChange:k=>R("largura_hm",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Anchura HM"}),a.jsx(Se,{type:"number",value:r.anchura_hm||"",onChange:k=>R("anchura_hm",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Area Producto (M2)"}),a.jsx(Se,{type:"number",value:r.area_producto_m2||"",onChange:k=>R("area_producto_m2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Recorte Adicional / Area Agujero (M2)"}),a.jsx(Se,{type:"number",value:r.recorte_adicional_m2||"",onChange:k=>R("recorte_adicional_m2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Longitud Pegado (MM)"}),a.jsx(Se,{type:"number",value:r.longitud_pegado_mm||"",onChange:k=>R("longitud_pegado_mm",k.target.value?Number(k.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Golpes al Largo"}),a.jsx(Se,{type:"number",value:r.golpes_largo||"",onChange:k=>R("golpes_largo",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Golpes al Ancho"}),a.jsx(Se,{type:"number",value:r.golpes_ancho||"",onChange:k=>R("golpes_ancho",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Separacion Golpes Largo (MM)"}),a.jsx(Se,{type:"number",value:r.separacion_golpes_largo||"",onChange:k=>R("separacion_golpes_largo",k.target.value?Number(k.target.value):null),placeholder:"0"})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Separacion Golpes Ancho (MM)"}),a.jsx(Se,{type:"number",value:r.separacion_golpes_ancho||"",onChange:k=>R("separacion_golpes_ancho",k.target.value?Number(k.target.value):null),placeholder:"0"})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Cuchillas (ML)"}),a.jsx(Se,{type:"number",value:r.cuchillas_ml||"",onChange:k=>R("cuchillas_ml",k.target.value?Number(k.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Rayado C1/R1 (MM)"}),a.jsx(Se,{type:"number",value:r.rayado_c1_r1||"",onChange:k=>R("rayado_c1_r1",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Rayado R1/R2 (MM)"}),a.jsx(Se,{type:"number",value:r.rayado_r1_r2||"",onChange:k=>R("rayado_r1_r2",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Rayado R2/C2 (MM)"}),a.jsx(Se,{type:"number",value:r.rayado_r2_c2||"",onChange:k=>R("rayado_r2_c2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{"data-has-error":!!c.bulto_zunchado_pallet,children:[a.jsx(ue,{style:{color:c.bulto_zunchado_pallet?"#dc3545":void 0},children:"Bulto Zunchado al Pallet"}),a.jsxs(Ve,{$hasError:!!c.bulto_zunchado_pallet,value:r.bulto_zunchado_pallet===null?"":r.bulto_zunchado_pallet,onChange:k=>R("bulto_zunchado_pallet",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]}),c.bulto_zunchado_pallet&&a.jsx(kt,{children:c.bulto_zunchado_pallet})]}),a.jsxs(ge,{"data-has-error":!!c.formato_etiqueta_pallet,children:[a.jsx(ue,{style:{color:c.formato_etiqueta_pallet?"#dc3545":void 0},children:"Formato Etiqueta Pallet"}),a.jsx(Ve,{$hasError:!!c.formato_etiqueta_pallet,value:r.formato_etiqueta_pallet||"",onChange:k=>R("formato_etiqueta_pallet",k.target.value?Number(k.target.value):null),children:a.jsx("option",{value:"",children:"Seleccionar..."})}),c.formato_etiqueta_pallet&&a.jsx(kt,{children:c.formato_etiqueta_pallet})]}),a.jsxs(ge,{"data-has-error":!!c.etiquetas_por_pallet,children:[a.jsx(ue,{style:{color:c.etiquetas_por_pallet?"#dc3545":void 0},children:"N Etiquetas por Pallet"}),a.jsx(Se,{$hasError:!!c.etiquetas_por_pallet,type:"number",value:r.etiquetas_por_pallet||"",onChange:k=>R("etiquetas_por_pallet",k.target.value?Number(k.target.value):null)}),c.etiquetas_por_pallet&&a.jsx(kt,{children:c.etiquetas_por_pallet})]}),a.jsxs(ge,{"data-has-error":!!c.termocontraible,children:[a.jsx(ue,{style:{color:c.termocontraible?"#dc3545":void 0},children:"Termocontraible"}),a.jsxs(Ve,{$hasError:!!c.termocontraible,value:r.termocontraible===null?"":r.termocontraible,onChange:k=>R("termocontraible",k.target.value===""?null:Number(k.target.value)),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"BCT MIN (LB)"}),a.jsx(Se,{type:"number",value:r.bct_min_lb||"",onChange:k=>R("bct_min_lb",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"BCT MIN (KG)"}),a.jsx(Se,{type:"number",value:r.bct_min_kg||"",onChange:k=>R("bct_min_kg",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"BCT HUMEDO (LB)"}),a.jsx(Se,{type:"number",value:r.bct_humedo_lb||"",onChange:k=>R("bct_humedo_lb",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"ECT MIN (LB/PULG)"}),a.jsx(Se,{type:"number",value:r.ect_min_lb_pulg||"",onChange:k=>R("ect_min_lb_pulg",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"GRAMAJE (G/M2)"}),a.jsx(Se,{type:"number",value:r.gramaje_g_m2||"",onChange:k=>R("gramaje_g_m2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"MULLEN (LB/PULG2)"}),a.jsx(Se,{type:"number",value:r.mullen_lb_pulg2||"",onChange:k=>R("mullen_lb_pulg2",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"FCT (LB/PULG2)"}),a.jsx(Se,{type:"number",value:r.fct_lb_pulg2||"",onChange:k=>R("fct_lb_pulg2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"DST (BPI)"}),a.jsx(Se,{type:"number",value:r.dst_bpi||"",onChange:k=>R("dst_bpi",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"ESPESOR PLACA (MM)"}),a.jsx(Se,{type:"number",value:r.espesor_placa_mm||"",onChange:k=>R("espesor_placa_mm",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"ESPESOR CAJA (MM)"}),a.jsx(Se,{type:"number",value:r.espesor_caja_mm||"",onChange:k=>R("espesor_caja_mm",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"COBB INTERIOR (G/M2)"}),a.jsx(Se,{type:"number",value:r.cobb_interior_g_m2||"",onChange:k=>R("cobb_interior_g_m2",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"COBB EXTERIOR (G/M2)"}),a.jsx(Se,{type:"number",value:r.cobb_exterior_g_m2||"",onChange:k=>R("cobb_exterior_g_m2",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"FLEXION DE ALETA (N)"}),a.jsx(Se,{type:"number",value:r.flexion_aleta_n||"",onChange:k=>R("flexion_aleta_n",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"PESO CLIENTE (G)"}),a.jsx(Se,{type:"number",value:r.peso_cliente_g||"",onChange:k=>R("peso_cliente_g",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Incision Rayado Longitudinal (N)"}),a.jsx(Se,{type:"text",value:r.incision_rayado_longitudinal,onChange:k=>R("incision_rayado_longitudinal",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Incision Rayado Transversal (N)"}),a.jsx(Se,{type:"text",value:r.incision_rayado_transversal,onChange:k=>R("incision_rayado_transversal",k.target.value)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Porosidad (SEG)"}),a.jsx(Se,{type:"text",value:r.porosidad,onChange:k=>R("porosidad",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Brillo (%)"}),a.jsx(Se,{type:"text",value:r.brillo,onChange:k=>R("brillo",k.target.value)})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Rigidez 4 Puntos Longitudinal (N/mm)"}),a.jsx(Se,{type:"text",value:r.rigidez_4_ptos_long,onChange:k=>R("rigidez_4_ptos_long",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Rigidez 4 Puntos Transversal (N/mm)"}),a.jsx(Se,{type:"text",value:r.rigidez_4_ptos_transv,onChange:k=>R("rigidez_4_ptos_transv",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Angulo Deslizamiento-Tapa Exterior"}),a.jsx(Se,{type:"text",value:r.angulo_deslizamiento_exterior,onChange:k=>R("angulo_deslizamiento_exterior",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Angulo Deslizamiento-Tapa Interior"}),a.jsx(Se,{type:"text",value:r.angulo_deslizamiento_interior,onChange:k=>R("angulo_deslizamiento_interior",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Resistencia al Frote"}),a.jsx(Se,{type:"text",value:r.resistencia_frote,onChange:k=>R("resistencia_frote",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Contenido Reciclado (%)"}),a.jsx(Se,{type:"text",value:r.contenido_reciclado,onChange:k=>R("contenido_reciclado",k.target.value)})]})]})]})})]}),a.jsxs(Qa,{children:[a.jsx(In,{children:"8.- Color-Cera-Barniz"}),a.jsx(Ln,{children:a.jsxs(U7,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Impresin"}),a.jsx(Se,{type:"text",value:r.cascadeData.impresion?((E=(Te=w==null?void 0:w.impresiones)==null?void 0:Te.find(k=>String(k.id)===String(r.cascadeData.impresion)))==null?void 0:E.nombre)||r.cascadeData.impresion:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Trazabilidad"}),a.jsxs(Ve,{value:r.trazabilidad||"",onChange:k=>R("trazabilidad",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(_e=w==null?void 0:w.trazabilidad)==null?void 0:_e.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{"data-has-error":!!c.design_type_id,children:[a.jsx(ue,{style:{color:c.design_type_id?"#dc3545":void 0},children:"Tipo Diseo"}),a.jsxs(Ve,{$hasError:!!c.design_type_id,value:r.design_type_id||"",onChange:k=>R("design_type_id",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(wt=w==null?void 0:w.design_types)==null?void 0:wt.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.design_type_id&&a.jsx(kt,{children:c.design_type_id})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Complejidad"}),a.jsx(Se,{type:"text",value:r.complejidad,onChange:k=>R("complejidad",k.target.value)})]}),a.jsxs(ge,{"data-has-error":!!c.numero_colores,children:[a.jsx(ue,{style:{color:c.numero_colores?"#dc3545":void 0},children:"Nmero Colores"}),a.jsxs(Ve,{$hasError:!!c.numero_colores,value:r.numero_colores!==null?r.numero_colores:"",onChange:k=>R("numero_colores",k.target.value!==""?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5,6,7].map(k=>a.jsx("option",{value:k,children:k},k))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Recubrimiento Interno"}),a.jsx(Se,{type:"text",value:r.cascadeData.coverageInternalId&&((pn=(Vr=w==null?void 0:w.coverages_internal)==null?void 0:Vr.find(k=>k.id===r.cascadeData.coverageInternalId))==null?void 0:pn.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{"data-has-error":!!c.percentage_coverage_internal,children:[a.jsx(ue,{style:{color:c.percentage_coverage_internal?"#dc3545":void 0},children:"% Recubrimiento Interno"}),a.jsx(Se,{$hasError:!!c.percentage_coverage_internal,type:"number",min:"0",value:r.percentage_coverage_internal||"",onChange:k=>R("percentage_coverage_internal",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Recubrimiento Externo"}),a.jsx(Se,{type:"text",value:r.cascadeData.coverageExternalId&&((te=(Nn=w==null?void 0:w.coverages_external)==null?void 0:Nn.find(k=>k.id===r.cascadeData.coverageExternalId))==null?void 0:te.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(ge,{"data-has-error":!!c.percentage_coverage_external,children:[a.jsx(ue,{style:{color:c.percentage_coverage_external?"#dc3545":void 0},children:"% Recubrimiento Externo"}),a.jsx(Se,{$hasError:!!c.percentage_coverage_external,type:"number",min:"0",value:r.percentage_coverage_external||"",onChange:k=>R("percentage_coverage_external",k.target.value?Number(k.target.value):null)})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 1 (Interior TyR)"}),a.jsxs(Ve,{value:r.color_1_id||"",onChange:k=>R("color_1_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Pe=w==null?void 0:w.colors)==null?void 0:Pe.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 1"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_1||"",onChange:k=>R("impresion_1",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 1"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_1||"",onChange:k=>R("cm2_clisse_color_1",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<1,style:r.numero_colores!==null&&r.numero_colores>=1?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 2"}),a.jsxs(Ve,{value:r.color_2_id||"",onChange:k=>R("color_2_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Qt=w==null?void 0:w.colors)==null?void 0:Qt.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 2"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_2||"",onChange:k=>R("impresion_2",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 2"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_2||"",onChange:k=>R("cm2_clisse_color_2",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<2,style:r.numero_colores!==null&&r.numero_colores>=2?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 3"}),a.jsxs(Ve,{value:r.color_3_id||"",onChange:k=>R("color_3_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Wa=w==null?void 0:w.colors)==null?void 0:Wa.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 3"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_3||"",onChange:k=>R("impresion_3",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 3"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_3||"",onChange:k=>R("cm2_clisse_color_3",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<3,style:r.numero_colores!==null&&r.numero_colores>=3?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 4"}),a.jsxs(Ve,{value:r.color_4_id||"",onChange:k=>R("color_4_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Fi=w==null?void 0:w.colors)==null?void 0:Fi.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 4"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_4||"",onChange:k=>R("impresion_4",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 4"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_4||"",onChange:k=>R("cm2_clisse_color_4",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<4,style:r.numero_colores!==null&&r.numero_colores>=4?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 5"}),a.jsxs(Ve,{value:r.color_5_id||"",onChange:k=>R("color_5_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(To=w==null?void 0:w.colors)==null?void 0:To.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 5"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_5||"",onChange:k=>R("impresion_5",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 5"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_5||"",onChange:k=>R("cm2_clisse_color_5",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<5,style:r.numero_colores!==null&&r.numero_colores>=5?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 6"}),a.jsxs(Ve,{value:r.color_6_id||"",onChange:k=>R("color_6_id",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Hr=w==null?void 0:w.colors)==null?void 0:Hr.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 6"}),a.jsx(Se,{type:"number",min:"0",value:r.impresion_6||"",onChange:k=>R("impresion_6",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 6"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_6||"",onChange:k=>R("cm2_clisse_color_6",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<6,style:r.numero_colores!==null&&r.numero_colores>=6?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Color 7 (Barniz UV)"}),a.jsxs(Ve,{value:r.barniz_uv||"",onChange:k=>R("barniz_uv",k.target.value?Number(k.target.value):null),disabled:P||r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ka=w==null?void 0:w.colors)==null?void 0:ka.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"% Impresin 7 UV"}),a.jsx(Se,{type:"number",min:"0",value:r.porcentaje_barniz_uv||"",onChange:k=>R("porcentaje_barniz_uv",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Clisse cm2 7"}),a.jsx(Se,{type:"number",min:"0",value:r.cm2_clisse_color_7||"",onChange:k=>R("cm2_clisse_color_7",k.target.value?Number(k.target.value):null),disabled:r.numero_colores===null||r.numero_colores<7,style:r.numero_colores!==null&&r.numero_colores>=7?{}:{backgroundColor:"#e9ecef"}})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Indicador Facturacin D.G."}),a.jsx(Se,{type:"text",value:r.indicador_facturacion_diseno_grafico,onChange:k=>R("indicador_facturacion_diseno_grafico",k.target.value)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Prueba de Color"}),a.jsxs(Ve,{value:r.prueba_color!==null?r.prueba_color:"",onChange:k=>R("prueba_color",k.target.value!==""?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]})]}),a.jsxs(ge,{"data-has-error":!!c.impresion_borde,children:[a.jsx(ue,{style:{color:c.impresion_borde?"#dc3545":void 0},children:"Impresin de Borde"}),a.jsxs(Ve,{$hasError:!!c.impresion_borde,value:r.impresion_borde,onChange:k=>R("impresion_borde",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(ge,{"data-has-error":!!c.impresion_sobre_rayado,children:[a.jsx(ue,{style:{color:c.impresion_sobre_rayado?"#dc3545":void 0},children:"Impresin Sobre Rayado"}),a.jsxs(Ve,{$hasError:!!c.impresion_sobre_rayado,value:r.impresion_sobre_rayado,onChange:k=>R("impresion_sobre_rayado",k.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"SI",children:"S"}),a.jsx("option",{value:"NO",children:"No"})]})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Total Clisse cm2"}),a.jsx(Se,{type:"number",min:"0",value:r.total_cm2_clisse||"",onChange:k=>R("total_cm2_clisse",k.target.value?Number(k.target.value):null)})]})]})]})})]}),a.jsxs(V7,{children:[a.jsxs(e_,{children:[a.jsx(In,{children:"9.- Medidas Interiores"}),a.jsx(Ln,{children:a.jsxs(Pi,{$columns:1,children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Largo (mm)"}),a.jsx(Se,{type:"number",value:r.interno_largo||"",onChange:k=>R("interno_largo",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Ancho (mm)"}),a.jsx(Se,{type:"number",value:r.interno_ancho||"",onChange:k=>R("interno_ancho",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Alto (mm)"}),a.jsx(Se,{type:"number",value:r.interno_alto||"",onChange:k=>R("interno_alto",k.target.value?Number(k.target.value):null)})]})]})})]}),a.jsxs(e_,{children:[a.jsx(In,{children:"10.- Medidas Exteriores"}),a.jsx(Ln,{children:a.jsxs(Pi,{$columns:1,children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Largo (mm)"}),a.jsx(Se,{type:"number",value:r.externo_largo||"",onChange:k=>R("externo_largo",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Ancho (mm)"}),a.jsx(Se,{type:"number",value:r.externo_ancho||"",onChange:k=>R("externo_ancho",k.target.value?Number(k.target.value):null)})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Alto (mm)"}),a.jsx(Se,{type:"number",value:r.externo_alto||"",onChange:k=>R("externo_alto",k.target.value?Number(k.target.value):null)})]})]})})]}),a.jsxs(e_,{children:[a.jsx(In,{children:"11.- Terminaciones"}),a.jsx(Ln,{children:a.jsxs(Pi,{$columns:1,children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"Proceso"}),a.jsxs(Ve,{value:r.process_id||"",onChange:k=>R("process_id",k.target.value?Number(k.target.value):null),disabled:F,children:[a.jsx("option",{value:"",children:"Seleccione..."}),T==null?void 0:T.procesos.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs(ge,{"data-has-error":!!c.pegado_terminacion,children:[a.jsx(ue,{style:{color:c.pegado_terminacion?"#dc3545":void 0},children:"Tipo Pegado"}),a.jsxs(Ve,{$hasError:!!c.pegado_terminacion,value:r.pegado_terminacion||"",onChange:k=>R("pegado_terminacion",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(tt=w==null?void 0:w.pegados)==null?void 0:tt.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.pegado_terminacion&&a.jsx(kt,{children:c.pegado_terminacion})]}),a.jsxs(ge,{"data-has-error":!!c.armado_id,children:[a.jsx(ue,{style:{color:c.armado_id?"#dc3545":void 0},children:"Armado"}),a.jsxs(Ve,{$hasError:!!c.armado_id,value:r.armado_id||"",onChange:k=>R("armado_id",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Xt=w==null?void 0:w.armados)==null?void 0:Xt.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.armado_id&&a.jsx(kt,{children:c.armado_id})]}),a.jsxs(ge,{"data-has-error":!!c.sentido_armado,children:[a.jsx(ue,{style:{color:c.sentido_armado?"#dc3545":void 0},children:"Sentido de Armado *"}),a.jsxs(Ve,{$hasError:!!c.sentido_armado,value:r.sentido_armado||"",onChange:k=>R("sentido_armado",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(zn=w==null?void 0:w.sentidos_armado)==null?void 0:zn.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),c.sentido_armado&&a.jsx(kt,{children:c.sentido_armado})]}),a.jsxs(ge,{"data-has-error":!!c.maquila,children:[a.jsx(ue,{style:{color:c.maquila?"#dc3545":void 0},children:"Maquila"}),a.jsxs(Ve,{$hasError:!!c.maquila,value:r.maquila||"",onChange:k=>R("maquila",k.target.value?Number(k.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:1,children:"S"}),a.jsx("option",{value:0,children:"No"})]}),c.maquila&&a.jsx(kt,{children:c.maquila})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"Servicios Maquila"}),a.jsxs(Ve,{value:r.maquila_servicio_id||"",onChange:k=>R("maquila_servicio_id",k.target.value?Number(k.target.value):null),disabled:P,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(sr=w==null?void 0:w.maquila_servicios)==null?void 0:sr.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]})]})})]})]}),a.jsxs(Qa,{children:[a.jsx(In,{children:"12.- Secuencia Operacional"}),a.jsxs(Ln,{children:[a.jsxs("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[a.jsx(ue,{style:{fontWeight:"600",minWidth:"60px"},children:"PLANTA:"}),a.jsxs(Ve,{value:r.so_planta_original||"",onChange:k=>R("so_planta_original",k.target.value?Number(k.target.value):null),style:{width:"200px"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),T==null?void 0:T.plantas.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ORIGINAL"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 1"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 2"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 3"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 4"}),a.jsx("th",{style:{padding:"0.4rem",textAlign:"center",fontWeight:"600",color:"#0891b2",minWidth:"130px"},children:"ALTERNATIVA 5"})]})}),a.jsx("tbody",{children:[0,1,2,3,4,5].map(k=>a.jsx("tr",{children:[0,1,2,3,4,5].map(ft=>{var Et,mn;return a.jsx("td",{style:{padding:"0.3rem",borderBottom:"1px solid #e5e7eb"},children:a.jsxs(Ve,{value:((Et=r.secuencia_operacional_matrix[k])==null?void 0:Et[ft])||"",onChange:or=>{const Ao=r.secuencia_operacional_matrix.map((Ga,Wr)=>Wr===k?Ga.map((qa,Ka)=>Ka===ft?or.target.value||null:qa):[...Ga]);R("secuencia_operacional_matrix",Ao)},style:{width:"100%",fontSize:"0.8rem",padding:"0.25rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(mn=w==null?void 0:w.secuencia_operacional)==null?void 0:mn.filter(or=>!r.so_planta_original||or.planta_id===r.so_planta_original).map(or=>a.jsx("option",{value:or.id,children:or.descripcion||or.nombre},or.id))]})},ft)})},k))})]})})]})]}),a.jsxs(Qa,{children:[a.jsx(In,{children:"13.- Material Asignado"}),a.jsx(Ln,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",maxWidth:"100%"},children:[a.jsxs(ge,{children:[a.jsx(ue,{children:"MATERIAL ASIGNADO"}),a.jsx(Se,{type:"text",value:r.material_asignado,onChange:k=>R("material_asignado",k.target.value),placeholder:"Cdigo de material..."})]}),a.jsxs(ge,{children:[a.jsx(ue,{children:"DESCRIPCIN"}),a.jsx(Se,{type:"text",value:r.descripcion_material,onChange:k=>R("descripcion_material",k.target.value),placeholder:"Descripcin del material..."})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"65% 35%",gap:"0.5rem",maxWidth:"100%",overflow:"hidden"},children:[a.jsxs(Qa,{style:{margin:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[a.jsx(In,{children:"13.- Datos para desarrollo"}),a.jsx(Ln,{style:{overflow:"hidden",padding:"0.5rem"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.7rem",maxWidth:"100%"},children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.product_type_developing_id?"#dc3545":void 0},children:"TIPO PRODUCTO:"}),a.jsxs(Ve,{$hasError:!!c.product_type_developing_id,value:r.product_type_developing_id||"",onChange:k=>R("product_type_developing_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(as=w==null?void 0:w.product_type_developing)==null?void 0:as.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.peso_contenido_caja?"#dc3545":void 0},children:"PESO CAJA (KG):"}),a.jsx(Se,{$hasError:!!c.peso_contenido_caja,type:"number",value:r.peso_contenido_caja||"",onChange:k=>R("peso_contenido_caja",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.food_type_id?"#dc3545":void 0},children:"TIPO ALIMENTO:"}),a.jsxs(Ve,{$hasError:!!c.food_type_id,value:r.food_type_id||"",onChange:k=>R("food_type_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(uh=w==null?void 0:w.food_types)==null?void 0:uh.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.autosoportante?"#dc3545":void 0},children:"AUTOSOPORTANTE:"}),a.jsxs(Ve,{$hasError:!!c.autosoportante,value:r.autosoportante===null?"":r.autosoportante?"1":"0",onChange:k=>R("autosoportante",k.target.value===""?null:k.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.expected_use_id?"#dc3545":void 0},children:"USO PREVISTO:"}),a.jsxs(Ve,{$hasError:!!c.expected_use_id,value:r.expected_use_id||"",onChange:k=>R("expected_use_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Sp=w==null?void 0:w.expected_uses)==null?void 0:Sp.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.envase_id?"#dc3545":void 0},children:"ENVASE PRIMARIO:"}),a.jsxs(Ve,{$hasError:!!c.envase_id,value:r.envase_id||"",onChange:k=>R("envase_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Cp=w==null?void 0:w.envases)==null?void 0:Cp.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.recycled_use_id?"#dc3545":void 0},children:"USO RECICLADO:"}),a.jsxs(Ve,{$hasError:!!c.recycled_use_id,value:r.recycled_use_id||"",onChange:k=>R("recycled_use_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(hh=w==null?void 0:w.recycled_uses)==null?void 0:hh.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad_cajas_apiladas?"#dc3545":void 0},children:"CAJAS APILADAS:"}),a.jsx(Se,{$hasError:!!c.cantidad_cajas_apiladas,type:"number",value:r.cantidad_cajas_apiladas||"",onChange:k=>R("cantidad_cajas_apiladas",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.class_substance_packed_id?"#dc3545":void 0},children:"CLASE SUSTANCIA:"}),a.jsxs(Ve,{$hasError:!!c.class_substance_packed_id,value:r.class_substance_packed_id||"",onChange:k=>R("class_substance_packed_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(fh=w==null?void 0:w.class_substance_packeds)==null?void 0:fh.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.pallet_sobre_pallet?"#dc3545":void 0},children:"PALLET S/ PALLET:"}),a.jsxs(Ve,{$hasError:!!c.pallet_sobre_pallet,value:r.pallet_sobre_pallet===null?"":r.pallet_sobre_pallet?"1":"0",onChange:k=>R("pallet_sobre_pallet",k.target.value===""?null:k.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.transportation_way_id?"#dc3545":void 0},children:"MEDIO TRANSPORTE:"}),a.jsxs(Ve,{$hasError:!!c.transportation_way_id,value:r.transportation_way_id||"",onChange:k=>R("transportation_way_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(ph=w==null?void 0:w.transportation_ways)==null?void 0:ph.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.cantidad?"#dc3545":void 0},children:"CANTIDAD:"}),a.jsx(Se,{$hasError:!!c.cantidad,type:"number",value:r.cantidad||"",onChange:k=>R("cantidad",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(ue,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap",color:c.target_market_id?"#dc3545":void 0},children:"MERCADO DESTINO:"}),a.jsxs(Ve,{$hasError:!!c.target_market_id,value:r.target_market_id||"",onChange:k=>R("target_market_id",k.target.value?Number(k.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),($p=w==null?void 0:w.target_markets)==null?void 0:$p.map(k=>a.jsx("option",{value:k.id,children:k.nombre},k.id))]}),a.jsx("div",{}),a.jsx("div",{})]})]})})]}),a.jsxs(Qa,{style:{margin:0,minWidth:0,overflow:"hidden"},"data-has-error":!!c.observacion,children:[a.jsx(In,{style:{background:c.observacion?"linear-gradient(135deg, #dc3545 0%, #c82333 100%)":void 0},children:"14.- Observacin del trabajo a realizar *"}),a.jsxs(Ln,{style:{padding:"0.5rem",overflow:"hidden"},children:[a.jsx(H7,{$hasError:!!c.observacion,value:r.observacion,onChange:k=>R("observacion",k.target.value),placeholder:"Observaciones adicionales (mnimo 10 caracteres)...",style:{width:"100%",height:"200px",resize:"none",fontSize:"0.75rem",boxSizing:"border-box"}}),c.observacion&&a.jsx(kt,{children:c.observacion})]})]})]}),a.jsxs(G7,{children:[a.jsx(F$,{type:"button",onClick:le,children:"Limpiar Formulario"}),a.jsx(W7,{type:"submit",disabled:H.isPending,children:H.isPending?"Creando...":"Crear Orden de Trabajo"})]})]})]}),a.jsx(S7,{isOpen:x,onClose:()=>{j(!1),r.numero_muestras||R("muestra",!1)},onSave:(k,ft)=>{R("muestra",!0),R("numero_muestras",ft),j(!1)},cadId:r.cascadeData.cartonId,cartonId:r.cascadeData.cartonId,tipoSolicitud:r.tipo_solicitud,cads:(w==null?void 0:w.cads)||[],cartones:(w==null?void 0:w.cartons)||[],cartonesMuestra:(w==null?void 0:w.cartons)||[],comunas:(w==null?void 0:w.comunas)||[]})]})}const r_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,R$=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,N$=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,n_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Is=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,Ja=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,Za=p.div`
  padding: 1rem;
`,Mo=p.div`
  display: grid;
  grid-template-columns: repeat(${e=>e.$columns||3}, 1fr);
  gap: 1rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Y7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 0.75rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Q7=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  width: 100%;

  @media (max-width: 1200px) {
    grid-template-columns: 1fr 1fr;
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,a_=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  overflow: hidden;
`,Ne=p.div`
  display: flex;
  flex-direction: column;
`,Fe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,Je=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,Tt=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: #f5f5f5;
    cursor: not-allowed;
  }
`,J7=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,i_=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
`,Sa=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;

  input {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
`,Z7=p.button`
  padding: 0.75rem 2rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,eB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,s_=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}

  ${e=>e.$type==="info"&&`
    background: #cce5ff;
    color: #004085;
    border: 1px solid #b8daff;
  `}
`,tB=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,rB=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,nB=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,aB=[{id:1,nombre:"Desarrollo Completo"},{id:3,nombre:"Muestra con CAD"},{id:5,nombre:"Arte con Material"},{id:6,nombre:"Otras Solicitudes Desarrollo"},{id:7,nombre:"OT Proyectos Innovacin"}];function iB({otId:e,onNavigate:t}){var F,w,P,M,A,D,H,U,W,R,ae,le,G,z,ie,ne,O,N,L,K,re,Z,me,B,se,we,V,Ce,qe,Te;const[r,n]=C.useState(null),[i,s]=C.useState(null),[o,l]=C.useState(null),c=Pr(),{data:u,isLoading:h,error:f}=LP(e),{data:m,isLoading:_}=IP(),{data:g,isLoading:v}=BP(),y=C.useMemo(()=>!(g!=null&&g.subhierarchies)||!(r!=null&&r.hierarchy_id)?[]:g.subhierarchies.filter(E=>E.hierarchy_id===r.hierarchy_id),[g==null?void 0:g.subhierarchies,r==null?void 0:r.hierarchy_id]),b=C.useMemo(()=>!(g!=null&&g.subsubhierarchies)||!(r!=null&&r.subhierarchy_id)?[]:g.subsubhierarchies.filter(E=>E.subhierarchy_id===r.subhierarchy_id),[g==null?void 0:g.subsubhierarchies,r==null?void 0:r.subhierarchy_id]);C.useEffect(()=>{if(u){const E=u;n({client_id:E.client_id,descripcion:E.descripcion||"",tipo_solicitud:E.tipo_solicitud,canal_id:E.canal_id,org_venta_id:E.org_venta_id,nombre_contacto:E.nombre_contacto||"",email_contacto:E.email_contacto||"",telefono_contacto:E.telefono_contacto||"",volumen_venta_anual:E.volumen_venta_anual,codigo_producto:E.codigo_producto||"",hierarchy_id:E.hierarchy_id,subhierarchy_id:E.subhierarchy_id,subsubhierarchy_id:E.subsubhierarchy_id,ant_des_correo_cliente:E.ant_des_correo_cliente===1,ant_des_plano_actual:E.ant_des_plano_actual===1,ant_des_boceto_actual:E.ant_des_boceto_actual===1,ant_des_spec:E.ant_des_spec===1,ant_des_otro:E.ant_des_otro===1,ant_des_cj_referencia_de:E.ant_des_cj_referencia_de===1,ant_des_cj_referencia_dg:E.ant_des_cj_referencia_dg===1,ant_des_envase_primario:E.ant_des_envase_primario===1,ant_des_conservar_muestra:E.ant_des_conservar_muestra===null?null:E.ant_des_conservar_muestra===1,armado_automatico:E.armado_automatico===null?null:E.armado_automatico===1,analisis:E.analisis===1,prueba_industrial:E.prueba_industrial===1,muestra:E.muestra===1,numero_muestras:E.numero_muestras,cascadeData:{productTypeId:E.product_type_id,impresion:E.impresion!=null?String(E.impresion):null,fsc:E.fsc,cinta:E.cinta!=null?String(E.cinta):null,coverageInternalId:E.coverage_internal_id,coverageExternalId:E.coverage_external_id,plantaId:E.planta_id,cartonColor:E.carton_color!=null?String(E.carton_color):null,cartonId:E.carton_id},cad_id:E.cad_id,style_id:E.style_id,items_set:E.items_set,veces_item:E.veces_item,largura_hm:E.largura_hm,anchura_hm:E.anchura_hm,area_producto:E.area_producto,recorte_adicional:E.recorte_adicional,longitud_pegado:E.longitud_pegado,golpes_largo:E.golpes_largo,golpes_ancho:E.golpes_ancho,separacion_golpes_largo:E.separacion_golpes_largo,separacion_golpes_ancho:E.separacion_golpes_ancho,rayado_c1r1:E.rayado_c1r1,rayado_r1_r2:E.rayado_r1_r2,rayado_r2_c2:E.rayado_r2_c2,pallet_qa_id:E.pallet_qa_id,pais_id:E.pais_id,restriccion_pallet:E.restriccion_pallet,tamano_pallet_type_id:E.tamano_pallet_type_id,altura_pallet:E.altura_pallet,permite_sobresalir_carga:E.permite_sobresalir_carga,bct_min_lb:E.bct_min_lb,bct_min_kg:E.bct_min_kg,bct_humedo_lb:E.bct_humedo_lb,ect:E.ect,gramaje:E.gramaje,mullen:E.mullen,fct:E.fct,espesor:E.espesor,cobb_interior:E.cobb_interior,cobb_exterior:E.cobb_exterior,flexion_aleta:E.flexion_aleta,peso:E.peso,trazabilidad:E.trazabilidad,design_type_id:E.design_type_id,complejidad:E.complejidad||"",numero_colores:E.numero_colores,color_1_id:E.color_1_id,color_2_id:E.color_2_id,color_3_id:E.color_3_id,color_4_id:E.color_4_id,color_5_id:E.color_5_id,color_6_id:E.color_6_id,impresion_1:E.impresion_1,impresion_2:E.impresion_2,impresion_3:E.impresion_3,impresion_4:E.impresion_4,impresion_5:E.impresion_5,impresion_6:E.impresion_6,barniz_uv:E.barniz_uv,porcentanje_barniz_uv:E.porcentanje_barniz_uv,cera_exterior:E.cera_exterior,porcentaje_cera_exterior:E.porcentaje_cera_exterior,cera_interior:E.cera_interior,porcentaje_cera_interior:E.porcentaje_cera_interior,barniz_interior:E.barniz_interior,porcentaje_barniz_interior:E.porcentaje_barniz_interior,percentage_coverage_internal:E.percentage_coverage_internal,percentage_coverage_external:E.percentage_coverage_external,interno_largo:E.interno_largo,interno_ancho:E.interno_ancho,interno_alto:E.interno_alto,externo_largo:E.externo_largo,externo_ancho:E.externo_ancho,externo_alto:E.externo_alto,process_id:E.process_id,armado_id:E.armado_id,sentido_armado:E.sentido_armado,pegado_terminacion:E.pegado_terminacion,maquila:E.maquila,maquila_servicio_id:E.maquila_servicio_id,product_type_developing_id:E.product_type_developing_id,food_type_id:E.food_type_id,expected_use_id:E.expected_use_id,recycled_use_id:E.recycled_use_id,class_substance_packed_id:E.class_substance_packed_id,transportation_way_id:E.transportation_way_id,peso_contenido_caja:E.peso_contenido_caja,envase_id:E.envase_id,autosoportante:E.autosoportante===1,cajas_altura:E.cajas_altura,pallet_sobre_pallet:E.pallet_sobre_pallet===null?null:E.pallet_sobre_pallet===1,cantidad:E.cantidad,target_market_id:E.target_market_id,material_asignado:E.material_asignado||"",descripcion_material:E.descripcion_material||"",observacion:E.observacion||"",planta_id:E.planta_id})}},[u]);const x=jt({mutationFn:E=>Fn.update(e,E),onSuccess:E=>{s(E.message),l(null),c.invalidateQueries({queryKey:["workOrders"]}),c.invalidateQueries({queryKey:["workOrder",e]})},onError:E=>{l(E.message||"Error al actualizar la orden de trabajo"),s(null)}}),j=C.useCallback((E,_e)=>{n(wt=>wt?{...wt,[E]:_e}:null)},[]),S=C.useCallback(E=>{n(_e=>_e?{..._e,cascadeData:E}:null)},[]),T=C.useCallback(E=>{if(E.preventDefault(),!r)return;const _e={client_id:r.client_id||void 0,descripcion:r.descripcion||void 0,tipo_solicitud:r.tipo_solicitud||void 0,canal_id:r.canal_id||void 0,org_venta_id:r.org_venta_id||void 0,nombre_contacto:r.nombre_contacto||void 0,email_contacto:r.email_contacto||void 0,telefono_contacto:r.telefono_contacto||void 0,volumen_venta_anual:r.volumen_venta_anual||void 0,codigo_producto:r.codigo_producto||void 0,subsubhierarchy_id:r.subsubhierarchy_id||void 0,ant_des_correo_cliente:r.ant_des_correo_cliente?1:0,ant_des_plano_actual:r.ant_des_plano_actual?1:0,ant_des_boceto_actual:r.ant_des_boceto_actual?1:0,ant_des_spec:r.ant_des_spec?1:0,ant_des_otro:r.ant_des_otro?1:0,ant_des_cj_referencia_de:r.ant_des_cj_referencia_de?1:0,ant_des_cj_referencia_dg:r.ant_des_cj_referencia_dg?1:0,ant_des_envase_primario:r.ant_des_envase_primario?1:0,ant_des_conservar_muestra:r.ant_des_conservar_muestra===null?void 0:r.ant_des_conservar_muestra?1:0,armado_automatico:r.armado_automatico===null?void 0:r.armado_automatico?1:0,analisis:r.analisis?1:0,prueba_industrial:r.prueba_industrial?1:0,muestra:r.muestra?1:0,numero_muestras:r.numero_muestras||void 0,product_type_id:r.cascadeData.productTypeId||void 0,impresion:r.cascadeData.impresion?Number(r.cascadeData.impresion):void 0,fsc:r.cascadeData.fsc||void 0,cinta:r.cascadeData.cinta?Number(r.cascadeData.cinta):void 0,coverage_internal_id:r.cascadeData.coverageInternalId||void 0,coverage_external_id:r.cascadeData.coverageExternalId||void 0,carton_color:r.cascadeData.cartonColor?Number(r.cascadeData.cartonColor):void 0,carton_id:r.cascadeData.cartonId||void 0,cad_id:r.cad_id||void 0,style_id:r.style_id||void 0,items_set:r.items_set||void 0,veces_item:r.veces_item||void 0,largura_hm:r.largura_hm||void 0,anchura_hm:r.anchura_hm||void 0,area_producto:r.area_producto||void 0,recorte_adicional:r.recorte_adicional||void 0,longitud_pegado:r.longitud_pegado||void 0,golpes_largo:r.golpes_largo||void 0,golpes_ancho:r.golpes_ancho||void 0,pais_id:r.pais_id||void 0,design_type_id:r.design_type_id||void 0,numero_colores:r.numero_colores||void 0,color_1_id:r.color_1_id||void 0,color_2_id:r.color_2_id||void 0,color_3_id:r.color_3_id||void 0,color_4_id:r.color_4_id||void 0,color_5_id:r.color_5_id||void 0,barniz_uv:r.barniz_uv||void 0,porcentanje_barniz_uv:r.porcentanje_barniz_uv||void 0,interno_largo:r.interno_largo||void 0,interno_ancho:r.interno_ancho||void 0,interno_alto:r.interno_alto||void 0,externo_largo:r.externo_largo||void 0,externo_ancho:r.externo_ancho||void 0,externo_alto:r.externo_alto||void 0,process_id:r.process_id||void 0,armado_id:r.armado_id||void 0,sentido_armado:r.sentido_armado||void 0,peso_contenido_caja:r.peso_contenido_caja||void 0,envase_id:r.envase_id||void 0,autosoportante:r.autosoportante?1:0,cantidad:r.cantidad||void 0,observacion:r.observacion||void 0,planta_id:r.cascadeData.plantaId||r.planta_id||void 0};x.mutate(_e)},[r,x]);return h?a.jsx(r_,{children:a.jsxs(tB,{children:[a.jsx(rB,{}),a.jsxs("span",{children:["Cargando OT #",e,"..."]})]})}):f?a.jsxs(r_,{children:[a.jsxs(R$,{children:[a.jsx(N$,{children:"Error"}),a.jsx(n_,{onClick:()=>t("dashboard"),children:"Volver al Dashboard"})]}),a.jsxs(s_,{$type:"error",children:["No se pudo cargar la OT #",e,". ",f.message]})]}):r?a.jsxs(r_,{children:[a.jsxs(R$,{children:[a.jsxs(N$,{children:["Editar Orden de Trabajo",a.jsxs(nB,{children:["OT #",e]})]}),a.jsx(n_,{onClick:()=>t("dashboard"),children:"Volver al Dashboard"})]}),i&&a.jsx(s_,{$type:"success",children:i}),o&&a.jsx(s_,{$type:"error",children:o}),a.jsxs("form",{onSubmit:T,children:[a.jsxs(Is,{children:[a.jsx(Ja,{children:"1. Datos Comerciales"}),a.jsxs(Za,{children:[a.jsxs(Mo,{$columns:3,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cliente"}),a.jsxs(Tt,{value:r.client_id||"",onChange:E=>j("client_id",E.target.value?Number(E.target.value):null),disabled:_,children:[a.jsx("option",{value:"",children:"Seleccione cliente..."}),m==null?void 0:m.clientes.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Descripcin del Producto"}),a.jsx(Je,{type:"text",maxLength:40,value:r.descripcion,onChange:E=>j("descripcion",E.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo de Solicitud"}),a.jsxs(Tt,{value:r.tipo_solicitud||"",onChange:E=>j("tipo_solicitud",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione tipo..."}),aB.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Canal"}),a.jsxs(Tt,{value:r.canal_id||"",onChange:E=>j("canal_id",E.target.value?Number(E.target.value):null),disabled:_,children:[a.jsx("option",{value:"",children:"Seleccione canal..."}),m==null?void 0:m.canales.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cdigo Producto"}),a.jsx(Je,{type:"text",value:r.codigo_producto,onChange:E=>j("codigo_producto",E.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Volumen Anual"}),a.jsx(Je,{type:"number",value:r.volumen_venta_anual||"",onChange:E=>j("volumen_venta_anual",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs(Mo,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nombre Contacto"}),a.jsx(Je,{type:"text",value:r.nombre_contacto,onChange:E=>j("nombre_contacto",E.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Email Contacto"}),a.jsx(Je,{type:"email",value:r.email_contacto,onChange:E=>j("email_contacto",E.target.value)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Telfono Contacto"}),a.jsx(Je,{type:"tel",value:r.telefono_contacto,onChange:E=>j("telefono_contacto",E.target.value)})]})]}),a.jsxs(Mo,{$columns:3,style:{marginTop:"1rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 1"}),a.jsxs(Tt,{value:r.hierarchy_id||"",onChange:E=>j("hierarchy_id",E.target.value?Number(E.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),g==null?void 0:g.hierarchies.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 2"}),a.jsxs(Tt,{value:r.subhierarchy_id||"",onChange:E=>j("subhierarchy_id",E.target.value?Number(E.target.value):null),disabled:!r.hierarchy_id||v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),y.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Jerarqua 3"}),a.jsxs(Tt,{value:r.subsubhierarchy_id||"",onChange:E=>j("subsubhierarchy_id",E.target.value?Number(E.target.value):null),disabled:!r.subhierarchy_id||v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),b.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]})]})]})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"2. Antecedentes Desarrollo"}),a.jsxs(Za,{children:[a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(Fe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Documentos:"}),a.jsxs(i_,{children:[a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_correo_cliente,onChange:E=>j("ant_des_correo_cliente",E.target.checked)}),"Correo Cliente"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_plano_actual,onChange:E=>j("ant_des_plano_actual",E.target.checked)}),"Plano Actual"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_boceto_actual,onChange:E=>j("ant_des_boceto_actual",E.target.checked)}),"Boceto Actual"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_spec,onChange:E=>j("ant_des_spec",E.target.checked)}),"Spec"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_otro,onChange:E=>j("ant_des_otro",E.target.checked)}),"Otro"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx(Fe,{style:{fontWeight:"bold",marginBottom:"0.5rem",display:"block"},children:"Muestra Competencia:"}),a.jsxs(i_,{children:[a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_de,onChange:E=>j("ant_des_cj_referencia_de",E.target.checked)}),"CJ Referencia DE"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_cj_referencia_dg,onChange:E=>j("ant_des_cj_referencia_dg",E.target.checked)}),"CJ Referencia DG"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.ant_des_envase_primario,onChange:E=>j("ant_des_envase_primario",E.target.checked)}),"Envase Primario"]})]})]}),a.jsx("hr",{style:{margin:"1rem 0",borderTop:"1px solid #ddd"}}),a.jsxs(Mo,{$columns:3,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Conservar Muestra:"}),a.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.25rem"},children:[a.jsxs(Sa,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!0,onChange:()=>j("ant_des_conservar_muestra",!0)}),"SI"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"radio",name:"conservar_muestra",checked:r.ant_des_conservar_muestra===!1,onChange:()=>j("ant_des_conservar_muestra",!1)}),"NO"]})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Armado Automtico"}),a.jsxs(Tt,{value:r.armado_automatico===null?"":r.armado_automatico?"1":"0",onChange:E=>j("armado_automatico",E.target.value===""?null:E.target.value==="1"),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),a.jsx(Ne,{})]})]})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"Solicita"}),a.jsxs(Za,{children:[a.jsxs(i_,{children:[a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.analisis,onChange:E=>j("analisis",E.target.checked)}),"Anlisis"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.prueba_industrial,onChange:E=>j("prueba_industrial",E.target.checked)}),"Prueba Industrial"]}),a.jsxs(Sa,{children:[a.jsx("input",{type:"checkbox",checked:r.muestra,onChange:E=>j("muestra",E.target.checked)}),"Muestra"]})]}),r.muestra&&a.jsx(Mo,{$columns:4,style:{marginTop:"1rem"},children:a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nmero de Muestras"}),a.jsx(Je,{type:"number",min:"1",value:r.numero_muestras||"",onChange:E=>j("numero_muestras",E.target.value?Number(E.target.value):null)})]})})]})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"6.- Asistente Para: Ingresos Principales"}),a.jsx(Za,{children:a.jsx(vk,{values:r.cascadeData,onChange:S,fieldErrors:{}})})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"7.- Caractersticas"}),a.jsx(Za,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem"},children:[a.jsxs("div",{children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"CAD"}),a.jsxs(Tt,{value:r.cad_id||"",onChange:E=>j("cad_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(F=g==null?void 0:g.cads)==null?void 0:F.map(E=>a.jsx("option",{value:E.id,children:E.codigo||E.nombre},String(E.id)))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo Item"}),a.jsx(Je,{type:"text",value:r.cascadeData.productTypeId&&((P=(w=g==null?void 0:g.product_types)==null?void 0:w.find(E=>E.id===r.cascadeData.productTypeId))==null?void 0:P.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Items del Set"}),a.jsx(Je,{type:"number",min:"0",value:r.items_set||"",onChange:E=>j("items_set",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Veces Item"}),a.jsx(Je,{type:"number",min:"0",value:r.veces_item||"",onChange:E=>j("veces_item",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cartn"}),a.jsx(Je,{type:"text",value:r.cascadeData.cartonId&&((A=(M=g==null?void 0:g.cartons)==null?void 0:M.find(E=>E.id===r.cascadeData.cartonId))==null?void 0:A.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Cinta"}),a.jsx(Je,{type:"text",value:r.cascadeData.cinta!==null&&r.cascadeData.cinta!==void 0?Number(r.cascadeData.cinta)===1?"Si":"No":"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"FSC"}),a.jsx(Je,{type:"text",value:r.cascadeData.fsc?((H=(D=g==null?void 0:g.fsc)==null?void 0:D.find(E=>E.id===Number(r.cascadeData.fsc)))==null?void 0:H.nombre)||String(r.cascadeData.fsc):"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Pas/Mercado Destino"}),a.jsxs(Tt,{value:r.pais_id||"",onChange:E=>j("pais_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(U=g==null?void 0:g.pais_referencia)==null?void 0:U.map(E=>a.jsx("option",{value:E.id,children:E.nombre},String(E.id)))]})]})]}),a.jsxs("div",{children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Estilo"}),a.jsxs(Tt,{value:r.style_id||"",onChange:E=>j("style_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(W=g==null?void 0:g.styles)==null?void 0:W.map(E=>a.jsx("option",{value:E.id,children:E.nombre},String(E.id)))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largura HM"}),a.jsx(Je,{type:"number",value:r.largura_hm||"",onChange:E=>j("largura_hm",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Anchura HM"}),a.jsx(Je,{type:"number",value:r.anchura_hm||"",onChange:E=>j("anchura_hm",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"rea Producto (M2)"}),a.jsx(Je,{type:"number",value:r.area_producto||"",onChange:E=>j("area_producto",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Longitud Pegado (MM)"}),a.jsx(Je,{type:"number",value:r.longitud_pegado||"",onChange:E=>j("longitud_pegado",E.target.value?Number(E.target.value):null)})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Golpes al Largo"}),a.jsx(Je,{type:"number",value:r.golpes_largo||"",onChange:E=>j("golpes_largo",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Golpes al Ancho"}),a.jsx(Je,{type:"number",value:r.golpes_ancho||"",onChange:E=>j("golpes_ancho",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Rayado C1/R1 (MM)"}),a.jsx(Je,{type:"number",value:r.rayado_c1r1||"",onChange:E=>j("rayado_c1r1",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Rayado R1/R2 (MM)"}),a.jsx(Je,{type:"number",value:r.rayado_r1_r2||"",onChange:E=>j("rayado_r1_r2",E.target.value?Number(E.target.value):null)})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"BCT MIN (LB)"}),a.jsx(Je,{type:"number",value:r.bct_min_lb||"",onChange:E=>j("bct_min_lb",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"BCT MIN (KG)"}),a.jsx(Je,{type:"number",value:r.bct_min_kg||"",onChange:E=>j("bct_min_kg",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"GRAMAJE (G/M2)"}),a.jsx(Je,{type:"number",value:r.gramaje||"",onChange:E=>j("gramaje",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"ECT"}),a.jsx(Je,{type:"number",value:r.ect||"",onChange:E=>j("ect",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"COBB INTERIOR (G/M2)"}),a.jsx(Je,{type:"number",value:r.cobb_interior||"",onChange:E=>j("cobb_interior",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"COBB EXTERIOR (G/M2)"}),a.jsx(Je,{type:"number",value:r.cobb_exterior||"",onChange:E=>j("cobb_exterior",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"ESPESOR (MM)"}),a.jsx(Je,{type:"number",value:r.espesor||"",onChange:E=>j("espesor",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"PESO (G)"}),a.jsx(Je,{type:"number",value:r.peso||"",onChange:E=>j("peso",E.target.value?Number(E.target.value):null)})]})]})]})]})})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"8.- Color-Cera-Barniz"}),a.jsx(Za,{children:a.jsxs(Y7,{children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Impresin"}),a.jsx(Je,{type:"text",value:r.cascadeData.impresion?((ae=(R=g==null?void 0:g.impresiones)==null?void 0:R.find(E=>String(E.id)===String(r.cascadeData.impresion)))==null?void 0:ae.nombre)||r.cascadeData.impresion:"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Tipo Diseo"}),a.jsxs(Tt,{value:r.design_type_id||"",onChange:E=>j("design_type_id",E.target.value?Number(E.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(le=g==null?void 0:g.design_types)==null?void 0:le.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Nmero Colores"}),a.jsxs(Tt,{value:r.numero_colores!==null?r.numero_colores:"",onChange:E=>j("numero_colores",E.target.value!==""?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),[0,1,2,3,4,5,6,7].map(E=>a.jsx("option",{value:E,children:E},E))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Recubrimiento Interno"}),a.jsx(Je,{type:"text",value:r.cascadeData.coverageInternalId&&((z=(G=g==null?void 0:g.coverages_internal)==null?void 0:G.find(E=>E.id===r.cascadeData.coverageInternalId))==null?void 0:z.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Recubrimiento Interno"}),a.jsx(Je,{type:"number",min:"0",value:r.percentage_coverage_internal||"",onChange:E=>j("percentage_coverage_internal",E.target.value?Number(E.target.value):null)})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[r.numero_colores&&r.numero_colores>=1&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 1"}),a.jsxs(Tt,{value:r.color_1_id||"",onChange:E=>j("color_1_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ie=g==null?void 0:g.colors)==null?void 0:ie.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),r.numero_colores&&r.numero_colores>=2&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 2"}),a.jsxs(Tt,{value:r.color_2_id||"",onChange:E=>j("color_2_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(ne=g==null?void 0:g.colors)==null?void 0:ne.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),r.numero_colores&&r.numero_colores>=3&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 3"}),a.jsxs(Tt,{value:r.color_3_id||"",onChange:E=>j("color_3_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(O=g==null?void 0:g.colors)==null?void 0:O.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),r.numero_colores&&r.numero_colores>=4&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 4"}),a.jsxs(Tt,{value:r.color_4_id||"",onChange:E=>j("color_4_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(N=g==null?void 0:g.colors)==null?void 0:N.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),r.numero_colores&&r.numero_colores>=5&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Color 5"}),a.jsxs(Tt,{value:r.color_5_id||"",onChange:E=>j("color_5_id",E.target.value?Number(E.target.value):null),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(L=g==null?void 0:g.colors)==null?void 0:L.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Barniz UV"}),a.jsxs(Tt,{value:r.barniz_uv===null?"":r.barniz_uv,onChange:E=>j("barniz_uv",E.target.value===""?null:Number(E.target.value)),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Si"}),a.jsx("option",{value:"0",children:"No"})]})]}),r.barniz_uv===1&&a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Barniz UV"}),a.jsx(Je,{type:"number",min:"0",max:"100",value:r.porcentanje_barniz_uv||"",onChange:E=>j("porcentanje_barniz_uv",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Recubrimiento Externo"}),a.jsx(Je,{type:"text",value:r.cascadeData.coverageExternalId&&((re=(K=g==null?void 0:g.coverages_external)==null?void 0:K.find(E=>E.id===r.cascadeData.coverageExternalId))==null?void 0:re.nombre)||"",readOnly:!0,style:{backgroundColor:"#f5f5f5"}})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"% Recubrimiento Externo"}),a.jsx(Je,{type:"number",min:"0",value:r.percentage_coverage_external||"",onChange:E=>j("percentage_coverage_external",E.target.value?Number(E.target.value):null)})]})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Complejidad"}),a.jsx(Je,{type:"text",value:r.complejidad,onChange:E=>j("complejidad",E.target.value)})]})})]})})]}),a.jsxs(Q7,{children:[a.jsxs(a_,{children:[a.jsx(Ja,{children:"9.- Medidas Interiores"}),a.jsx(Za,{children:a.jsxs(Mo,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largo (mm)"}),a.jsx(Je,{type:"number",value:r.interno_largo||"",onChange:E=>j("interno_largo",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Ancho (mm)"}),a.jsx(Je,{type:"number",value:r.interno_ancho||"",onChange:E=>j("interno_ancho",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Alto (mm)"}),a.jsx(Je,{type:"number",value:r.interno_alto||"",onChange:E=>j("interno_alto",E.target.value?Number(E.target.value):null)})]})]})})]}),a.jsxs(a_,{children:[a.jsx(Ja,{children:"10.- Medidas Exteriores"}),a.jsx(Za,{children:a.jsxs(Mo,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Largo (mm)"}),a.jsx(Je,{type:"number",value:r.externo_largo||"",onChange:E=>j("externo_largo",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Ancho (mm)"}),a.jsx(Je,{type:"number",value:r.externo_ancho||"",onChange:E=>j("externo_ancho",E.target.value?Number(E.target.value):null)})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Alto (mm)"}),a.jsx(Je,{type:"number",value:r.externo_alto||"",onChange:E=>j("externo_alto",E.target.value?Number(E.target.value):null)})]})]})})]}),a.jsxs(a_,{children:[a.jsx(Ja,{children:"11.- Terminaciones"}),a.jsx(Za,{children:a.jsxs(Mo,{$columns:1,children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Proceso"}),a.jsxs(Tt,{value:r.process_id||"",onChange:E=>j("process_id",E.target.value?Number(E.target.value):null),disabled:_,children:[a.jsx("option",{value:"",children:"Seleccione..."}),m==null?void 0:m.procesos.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Armado"}),a.jsxs(Tt,{value:r.armado_id||"",onChange:E=>j("armado_id",E.target.value?Number(E.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(Z=g==null?void 0:g.armados)==null?void 0:Z.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"Sentido de Armado"}),a.jsxs(Tt,{value:r.sentido_armado||"",onChange:E=>j("sentido_armado",E.target.value?Number(E.target.value):null),disabled:v,children:[a.jsx("option",{value:"",children:"Seleccione..."}),(me=g==null?void 0:g.sentidos_armado)==null?void 0:me.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]})]})})]})]}),a.jsxs(Is,{children:[a.jsx(Ja,{children:"13.- Material Asignado"}),a.jsx(Za,{children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",maxWidth:"100%"},children:[a.jsxs(Ne,{children:[a.jsx(Fe,{children:"MATERIAL ASIGNADO"}),a.jsx(Je,{type:"text",value:r.material_asignado,onChange:E=>j("material_asignado",E.target.value),placeholder:"Cdigo de material..."})]}),a.jsxs(Ne,{children:[a.jsx(Fe,{children:"DESCRIPCIN"}),a.jsx(Je,{type:"text",value:r.descripcion_material,onChange:E=>j("descripcion_material",E.target.value),placeholder:"Descripcin del material..."})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"65% 35%",gap:"0.5rem",maxWidth:"100%",overflow:"hidden"},children:[a.jsxs(Is,{style:{margin:0,minWidth:0,overflow:"hidden",maxWidth:"100%"},children:[a.jsx(Ja,{children:"13.- Datos para desarrollo"}),a.jsx(Za,{style:{overflow:"hidden",padding:"0.5rem"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.7rem",maxWidth:"100%"},children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"TIPO PRODUCTO:"}),a.jsxs(Tt,{value:r.product_type_developing_id||"",onChange:E=>j("product_type_developing_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(B=g==null?void 0:g.product_type_developing)==null?void 0:B.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"PESO CAJA (KG):"}),a.jsx(Je,{type:"number",value:r.peso_contenido_caja||"",onChange:E=>j("peso_contenido_caja",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"TIPO ALIMENTO:"}),a.jsxs(Tt,{value:r.food_type_id||"",onChange:E=>j("food_type_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(se=g==null?void 0:g.food_types)==null?void 0:se.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"AUTOSOPORTANTE:"}),a.jsxs(Tt,{value:r.autosoportante?"1":"0",onChange:E=>j("autosoportante",E.target.value==="1"),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"0",children:"No"}),a.jsx("option",{value:"1",children:"Si"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"USO PREVISTO:"}),a.jsxs(Tt,{value:r.expected_use_id||"",onChange:E=>j("expected_use_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(we=g==null?void 0:g.expected_uses)==null?void 0:we.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"ENVASE PRIMARIO:"}),a.jsxs(Tt,{value:r.envase_id||"",onChange:E=>j("envase_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(V=g==null?void 0:g.envases)==null?void 0:V.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"CLASE SUSTANCIA:"}),a.jsxs(Tt,{value:r.class_substance_packed_id||"",onChange:E=>j("class_substance_packed_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Ce=g==null?void 0:g.class_substance_packeds)==null?void 0:Ce.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"CANTIDAD:"}),a.jsx(Je,{type:"number",value:r.cantidad||"",onChange:E=>j("cantidad",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr 140px 1fr",gap:"0.25rem",alignItems:"center"},children:[a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"MEDIO TRANSPORTE:"}),a.jsxs(Tt,{value:r.transportation_way_id||"",onChange:E=>j("transportation_way_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(qe=g==null?void 0:g.transportation_ways)==null?void 0:qe.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsx(Fe,{style:{margin:0,fontWeight:"600",fontSize:"0.65rem",whiteSpace:"nowrap"},children:"MERCADO DESTINO:"}),a.jsxs(Tt,{value:r.target_market_id||"",onChange:E=>j("target_market_id",E.target.value?Number(E.target.value):null),style:{width:"100%",fontSize:"0.7rem",padding:"0.15rem"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Te=g==null?void 0:g.target_markets)==null?void 0:Te.map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]})]})})]}),a.jsxs(Is,{style:{margin:0,minWidth:0,overflow:"hidden"},children:[a.jsx(Ja,{children:"14.- Observacin del trabajo a realizar"}),a.jsx(Za,{style:{padding:"0.5rem",overflow:"hidden"},children:a.jsx(J7,{value:r.observacion,onChange:E=>j("observacion",E.target.value),placeholder:"Observaciones adicionales...",style:{width:"100%",height:"200px",resize:"none",fontSize:"0.75rem",boxSizing:"border-box"}})})]})]}),a.jsxs(eB,{children:[a.jsx(n_,{type:"button",onClick:()=>t("dashboard"),children:"Cancelar"}),a.jsx(Z7,{type:"submit",disabled:x.isPending,children:x.isPending?"Guardando...":"Guardar Cambios"})]})]})]}):null}const ct={Vendedor:4,JefeVenta:3,JefeDesarrollo:5,Ingeniero:6,JefeMuestras:13,TecnicoMuestras:14,SuperAdministrador:18,Admin:1},bi={Ventas:1,Desarrollo:2,SalaMuestras:6},Rr={EnProceso:1,Rechazada:2,Terminada:3,Anulada:4,Devuelta:5},tv=(e,t)=>e?e===t.sala_corte_vendedor||e===t.sala_corte_disenador||e===t.sala_corte_laboratorio||e===t.sala_corte_1||e===t.sala_corte_2||e===t.sala_corte_3||e===t.sala_corte_4||e===t.sala_corte_disenador_revision:!1,z$=e=>[ct.Ingeniero,ct.JefeVenta,ct.Vendedor,ct.TecnicoMuestras,ct.JefeMuestras,ct.JefeDesarrollo,ct.SuperAdministrador,ct.Admin].includes(e),I$=(e,t)=>e===ct.Ingeniero||e===ct.JefeDesarrollo||(e===ct.Vendedor||e===ct.JefeVenta)&&t===bi.Ventas,sB=(e,t,r,n,i)=>e===ct.Vendedor||e===ct.JefeVenta?t===bi.Ventas:e===ct.Ingeniero||e===ct.JefeDesarrollo?t===bi.Desarrollo&&r!==Rr.Rechazada&&r!==Rr.Terminada:e===ct.JefeMuestras?t===bi.SalaMuestras&&r!==Rr.Rechazada&&r!==Rr.Terminada&&r!==Rr.Anulada:e===ct.TecnicoMuestras?!(t===bi.SalaMuestras&&r!==Rr.Rechazada&&r!==Rr.Terminada&&r!==Rr.Anulada)||!i?!1:tv(n,i):!1,oB=(e,t,r,n,i)=>e===ct.TecnicoMuestras&&t===bi.SalaMuestras?!(r===Rr.EnProceso||r===Rr.Devuelta)||!i?!1:tv(n,i):!1,lB=(e,t)=>e===ct.JefeMuestras||e===ct.JefeDesarrollo?t===bi.SalaMuestras:!1,cB=(e,t,r)=>e===ct.Ingeniero||e===ct.JefeDesarrollo?t===bi.Desarrollo&&r!==Rr.Terminada&&r!==Rr.Rechazada:!1,dB=(e,t,r,n,i)=>t===bi.SalaMuestras&&r!==Rr.Rechazada&&r!==Rr.Terminada?e===ct.JefeMuestras?!0:e===ct.TecnicoMuestras&&i?tv(n,i):!1:!1,uB=(e,t,r,n,i)=>t===bi.SalaMuestras&&r!==Rr.Devuelta&&r!==Rr.Anulada&&r!==Rr.Terminada&&r!==Rr.Rechazada?e===ct.JefeMuestras?!0:e===ct.TecnicoMuestras&&i?tv(n,i):!1:!1,hB=(e,t)=>t===Rr.Terminada?[ct.TecnicoMuestras,ct.JefeMuestras,ct.JefeDesarrollo,ct.Ingeniero].includes(e):!1,fB=e=>{const t=[];return e.golpes_largo||t.push("Golpes al Largo"),e.golpes_ancho||t.push("Golpes al Ancho"),e.largura_hm||t.push("Largura HM"),e.anchura_hm||t.push("Anchura HM"),e.process_id||t.push("Proceso"),e.carton_id||t.push("Cartn"),t.length===0?(!e.carton_id||!e.process_id)&&t.push("rea HC (requiere Cartn y Proceso)"):t.push("rea HC"),t},pB=(e,t)=>{const r=fB(t);return e===ct.Vendedor&&r.length===0?{canCotizar:!0,camposFaltantes:[]}:e!==ct.Vendedor?{canCotizar:!1,camposFaltantes:["Solo el rol Vendedor puede cotizar",...r]}:{canCotizar:!1,camposFaltantes:r}},mB=e=>e.tipo_solicitud!==6,gB=(e,t)=>{const r=t.current_area_id;return e===ct.SuperAdministrador||e===ct.Admin||e===ct.JefeDesarrollo?!0:e===ct.Vendedor||e===ct.JefeVenta?r===bi.Ventas:e===ct.Ingeniero?r===bi.Desarrollo:!1},L$=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,xB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,vB=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,_B=p.div`
  display: flex;
  gap: 0.5rem;
  align-items: center;
`,yB=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,B$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.primary};
  border-radius: 50px;
  background: white;
  color: ${d.colors.primary};
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 0.35rem;

  &:hover {
    background: ${d.colors.primary};
    color: white;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,bB=p.div`
  position: relative;
  display: inline-block;
`,jB=p.div`
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 8px;
  padding: 0.5rem 0.75rem;
  background: #333;
  color: white;
  font-size: 0.75rem;
  border-radius: 4px;
  white-space: nowrap;
  max-width: 300px;
  white-space: pre-wrap;
  z-index: 1000;
  visibility: ${e=>e.$visible?"visible":"hidden"};
  opacity: ${e=>e.$visible?1:0};
  transition: opacity 0.2s, visibility 0.2s;

  &::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-bottom-color: #333;
  }
`,U$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid;
  border-radius: 50px;
  background: white;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 0.35rem;

  ${e=>{switch(e.$variant){case"primary":return`
          border-color: ${d.colors.primary};
          color: ${d.colors.primary};
          &:hover:not(:disabled) {
            background: ${d.colors.primary};
            color: white;
          }
        `;case"success":return`
          border-color: #28a745;
          color: #28a745;
          &:hover:not(:disabled) {
            background: #28a745;
            color: white;
          }
        `;default:return`
          border-color: ${d.colors.border};
          color: ${d.colors.textSecondary};
          &:hover:not(:disabled) {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,wB=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,V$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,H$=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
  border-radius: 8px 8px 0 0;
`,W$=p.div`
  padding: 1rem;
`,Qp=p.span`
  display: inline-block;
  padding: 0.35rem 0.75rem;
  border-radius: 50px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-right: 0.5rem;

  ${e=>e.$type==="area"&&`
    background: ${d.colors.primary}15;
    color: ${d.colors.primary};
  `}

  ${e=>e.$type==="state"&&`
    background: #6c757d15;
    color: #6c757d;
  `}
`,kB=p.div`
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`,G$=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Jp=p.div`
  margin-bottom: 1rem;
`,Zp=p.label`
  display: block;
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
  text-transform: uppercase;
`,o_=p.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,SB=p.textarea`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,CB=p.button`
  width: 100%;
  padding: 0.75rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;

  &:hover:not(:disabled) {
    background: #002d66;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,$B=p.div`
  max-height: 400px;
  overflow-y: auto;
`,EB=p.div`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background: ${d.colors.bgLight};
  }
`,TB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.25rem;
`,AB=p.div`
  display: flex;
  gap: 0.5rem;
`,FB=p.span`
  font-size: 0.75rem;
  color: ${d.colors.textSecondary};
`,DB=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
`,PB=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  margin-top: 0.5rem;
  padding: 0.5rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  font-style: italic;
`,q$=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,MB=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,OB=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,RB=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  background: ${d.colors.primary}15;
  color: ${d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,NB=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,l_=p.div`
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,c_=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin-bottom: 0.25rem;
`,d_=p.div`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  font-weight: 500;
`,zB=p.div`
  margin-top: 1.5rem;
`,IB=p.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
  color: white;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.95;
  }
`,LB=p.h2`
  font-size: 1rem;
  font-weight: 500;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,BB=p.span`
  font-size: 1.25rem;
  transition: transform 0.2s;
  transform: ${e=>e.$expanded?"rotate(180deg)":"rotate(0deg)"};
`,UB=p.div`
  max-height: ${e=>e.$expanded?"800px":"0"};
  overflow: hidden;
  transition: max-height 0.3s ease-in-out;
  background: white;
  border: ${e=>e.$expanded?`1px solid ${d.colors.border}`:"none"};
  border-top: none;
  border-radius: 0 0 8px 8px;
`,VB=p.div`
  padding: 1rem;
`,HB=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;

  th, td {
    padding: 0.5rem;
    text-align: left;
    border-bottom: 1px solid ${d.colors.border};
  }

  th {
    background: ${d.colors.bgLight};
    font-weight: 600;
    color: ${d.colors.textSecondary};
    font-size: 0.7rem;
    text-transform: uppercase;
  }

  tr:hover {
    background: ${d.colors.bgLight};
  }

  tr.prioritaria {
    background: #d1f3d1;
  }
`,u_=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>e.$type==="estado"&&`
    background: #6c757d15;
    color: #6c757d;
  `}

  ${e=>e.$type==="prioritaria"&&`
    background: #28a74520;
    color: #28a745;
  `}
`,WB=p.div`
  display: flex;
  gap: 0.25rem;
`,Xl=p.button`
  padding: 0.25rem 0.5rem;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.bgLight};
  color: ${d.colors.textPrimary};

  &:hover {
    background: ${d.colors.primary};
    color: white;
  }

  &.danger:hover {
    background: #dc3545;
  }

  &.success:hover {
    background: #28a745;
  }
`,GB=p.button`
  padding: 0.5rem 1rem;
  background: ${d.colors.primary};
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-bottom: 1rem;

  &:hover {
    background: #002d66;
  }
`,K$=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,qB=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,KB=p.div`
  background: white;
  border-radius: 8px;
  max-width: 600px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
`,XB=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.25rem;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  border-radius: 8px 8px 0 0;
`,YB=p.h3`
  margin: 0;
  font-size: 1rem;
  font-weight: 500;
`,QB=p.button`
  background: none;
  border: none;
  color: white;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;

  &:hover {
    opacity: 0.8;
  }
`,JB=p.div`
  padding: 1.25rem;
`,h_=p.div`
  margin-bottom: 1.25rem;
`,f_=p.h4`
  font-size: 0.85rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.75rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
`,gr=p.div`
  margin-bottom: 0.75rem;
`,kr=p.label`
  display: block;
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.25rem;
`,cs=p.input`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Mi=p.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Ca=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
`,ZB=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  padding: 1rem 1.25rem;
  border-top: 1px solid ${d.colors.border};
`,X$=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${e=>e.$primary?`
    background: ${d.colors.primary};
    color: white;
    border: none;

    &:hover:not(:disabled) {
      background: #002d66;
    }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border: 1px solid ${d.colors.border};

    &:hover {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Oo=1,e9=2,t9=3,Yl=12,r9={1:1,2:2,5:3,6:5,7:4,12:null,13:1,9:null,10:null,11:null,14:null,15:null,16:null,17:null,18:null,20:null,21:null,22:null},n9=[1,2,5,6,7,13];function a9({otId:e,onNavigate:t}){var qe,Te,E,_e,wt,Vr,pn,Nn;const[r,n]=C.useState(null),[i,s]=C.useState(null),[o,l]=C.useState(null),[c,u]=C.useState(""),[h,f]=C.useState(null),[m,_]=C.useState(null),[g,v]=C.useState(!1),[y,b]=C.useState(null),[x,j]=C.useState(!1),[S,T]=C.useState({}),[F,w]=C.useState(null),[P,M]=C.useState(!1),A=mo.getStoredUser(),D=(A==null?void 0:A.role_id)||0,H=A==null?void 0:A.sala_corte_id,U=Pr(),{data:W,isLoading:R}=LP(e),{data:ae,isLoading:le}=M7(e),{data:G,isLoading:z}=O7(e),ie=R7(),{data:ne,isLoading:O}=Nt({queryKey:["muestras-ot",e],queryFn:()=>vr.listByOT(e),enabled:z$(D)&&g}),N=jt({mutationFn:te=>vr.terminar(te),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra terminada exitosamente")},onError:te=>_(te.message)}),L=jt({mutationFn:te=>vr.anular(te),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra anulada exitosamente")},onError:te=>_(te.message)}),K=jt({mutationFn:te=>vr.togglePrioritaria(te),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]})},onError:te=>_(te.message)}),re=jt({mutationFn:te=>vr.rechazar(te),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra rechazada exitosamente")},onError:te=>_(te.message)}),Z=jt({mutationFn:te=>vr.devolver(te),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra devuelta exitosamente")},onError:te=>_(te.message)}),me=jt({mutationFn:({id:te,data:Pe})=>vr.update(te,Pe),onSuccess:()=>{U.invalidateQueries({queryKey:["muestras-ot",e]}),f("Muestra actualizada exitosamente"),j(!1),b(null),T({})},onError:te=>_(te.message)}),B=C.useCallback(async te=>{try{const[Pe,Qt]=await Promise.all([vr.get(te),vr.getOptions()]);b(Pe),w(Qt),T({cad:Pe.cad_codigo||void 0,cad_id:Pe.cad_id||void 0,carton_id:Pe.carton_id||void 0,carton_muestra_id:void 0,pegado_id:Pe.pegado_id||void 0,tiempo_unitario:Pe.tiempo_unitario||void 0,cantidad_vendedor:Pe.cantidad_vendedor||0,cantidad_disenador:Pe.cantidad_disenador||0,cantidad_laboratorio:Pe.cantidad_laboratorio||0,cantidad_disenador_revision:Pe.cantidad_disenador_revision||0,sala_corte_vendedor:Pe.sala_corte_id||void 0}),j(!0)}catch{_("Error al cargar datos de la muestra")}},[]),se=C.useCallback(()=>{if(!y)return;const te={};S.cad_id!==void 0&&(te.cad_id=S.cad_id),S.carton_id!==void 0&&(te.carton_id=S.carton_id),S.carton_muestra_id!==void 0&&(te.carton_muestra_id=S.carton_muestra_id),S.pegado_id!==void 0&&(te.pegado_id=S.pegado_id),S.tiempo_unitario!==void 0&&(te.tiempo_unitario=S.tiempo_unitario),S.cantidad_vendedor!==void 0&&(te.cantidad_vendedor=S.cantidad_vendedor),S.cantidad_disenador!==void 0&&(te.cantidad_disenador=S.cantidad_disenador),S.cantidad_laboratorio!==void 0&&(te.cantidad_laboratorio=S.cantidad_laboratorio),S.cantidad_disenador_revision!==void 0&&(te.cantidad_disenador_revision=S.cantidad_disenador_revision),S.sala_corte_vendedor!==void 0&&(te.sala_corte_vendedor=S.sala_corte_vendedor),console.log("Guardando muestra:",y.id,te),me.mutate({id:y.id,data:te})},[y,S,me]),we=C.useCallback(()=>{if(!r){_("Debe seleccionar tipo de gestion");return}if(r===Oo&&!o){_("Debe seleccionar un estado");return}if(r===Oo&&o===Yl&&!i){_("Debe seleccionar el rea de destino para el rechazo");return}const te={management_type_id:r,work_space_id:i||void 0,state_id:o||void 0,observation:c||void 0};ie.mutate({id:e,data:te},{onSuccess:Pe=>{f(Pe.message),_(null),n(null),s(null),l(null),u("")},onError:Pe=>{_(Pe.message||"Error al realizar la transicion"),f(null)}})},[e,r,i,o,c,ie]),V=te=>te?new Date(te).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";if(le||z||R)return a.jsx(L$,{children:a.jsxs(MB,{children:[a.jsx(OB,{}),a.jsxs("span",{children:["Cargando informacion de OT #",e,"..."]})]})});const Ce=W;return a.jsxs(L$,{children:[a.jsxs(xB,{children:[a.jsxs(vB,{children:["Gestionar Orden de Trabajo",a.jsxs(RB,{children:["OT #",e]})]}),a.jsxs(_B,{children:[Ce&&mB(Ce)&&(()=>{const{canCotizar:te,camposFaltantes:Pe}=pB(D,Ce),Qt=Pe.length>0?`Para cotizar se requieren:
- ${Pe.join(`
- `)}`:"";return a.jsxs(bB,{onMouseEnter:()=>!te&&M(!0),onMouseLeave:()=>M(!1),children:[a.jsx(U$,{$variant:"primary",disabled:!te,onClick:()=>te&&t("cotizar-multiples-ot"),title:te?"Cotizar esta OT":Qt,children:"Cotizar OT"}),a.jsx(jB,{$visible:P&&!te,children:Qt})]})})(),Ce&&gB(D,Ce)&&a.jsx(U$,{$variant:"success",onClick:()=>t("editar-ot",e),title:"Ver/Editar datos de la OT",children:"Ver/Editar OT "}),a.jsx(B$,{onClick:()=>i1.downloadFichaDiseno(e),title:"Descargar Ficha de Diseo",children:"Ficha Diseo"}),a.jsx(B$,{onClick:()=>i1.downloadEstudioBench(e),title:"Descargar Solicitud Benchmarking",children:"Est. Bench"}),a.jsx(yB,{onClick:()=>t("dashboard"),children:" Volver al Dashboard"})]})]}),h&&a.jsx(q$,{$type:"success",children:h}),m&&a.jsx(q$,{$type:"error",children:m}),Ce&&a.jsxs(NB,{children:[a.jsxs(l_,{children:[a.jsx(c_,{children:"Cliente"}),a.jsx(d_,{children:Ce.client_name||"N/A"})]}),a.jsxs(l_,{children:[a.jsx(c_,{children:"Descripcion"}),a.jsx(d_,{children:Ce.descripcion||"N/A"})]}),a.jsxs(l_,{children:[a.jsx(c_,{children:"Creador"}),a.jsx(d_,{children:Ce.creador_nombre||"N/A"})]})]}),a.jsxs(wB,{children:[a.jsxs(V$,{children:[a.jsx(H$,{children:"Transicion de Estado"}),a.jsxs(W$,{children:[a.jsxs(kB,{children:[a.jsxs("div",{children:[a.jsx(G$,{children:"Area Actual"}),a.jsx("div",{children:a.jsx(Qp,{$type:"area",children:(ae==null?void 0:ae.current_area)||"Sin asignar"})})]}),a.jsxs("div",{children:[a.jsx(G$,{children:"Estado Actual"}),a.jsx("div",{children:a.jsx(Qp,{$type:"state",children:(ae==null?void 0:ae.current_state)||"Sin estado"})})]})]}),a.jsxs(Jp,{children:[a.jsx(Zp,{children:"Tipo de Gestion"}),a.jsxs(o_,{value:r||"",onChange:te=>{const Pe=te.target.value?Number(te.target.value):null;n(Pe),Pe!==Oo&&(s(null),l(null))},children:[a.jsx("option",{value:"",children:"Seleccione tipo de gestion..."}),(qe=G==null?void 0:G.management_types)==null?void 0:qe.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]}),r===Oo&&a.jsxs(a.Fragment,{children:[a.jsxs(Jp,{children:[a.jsx(Zp,{children:"Estado"}),a.jsxs(o_,{value:o||"",onChange:te=>{const Pe=te.target.value?Number(te.target.value):null;if(l(Pe),Pe&&n9.includes(Pe)){const Qt=r9[Pe];s(Qt)}else s(null)},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),G==null?void 0:G.states.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]}),a.jsxs(Jp,{children:[a.jsx(Zp,{children:"Area"}),a.jsxs(o_,{value:i||"",onChange:te=>s(te.target.value?Number(te.target.value):null),disabled:o!==Yl,style:{backgroundColor:o!==Yl?"#f5f5f5":"white",cursor:o!==Yl?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),G==null?void 0:G.areas.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]}),o&&o!==Yl&&i&&a.jsx("small",{style:{color:"#666",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"},children:"rea determinada automticamente por el estado"})]})]}),a.jsxs(Jp,{children:[a.jsxs(Zp,{children:["Observacion ",r===Oo?"(opcional)":""]}),a.jsx(SB,{value:c,onChange:te=>u(te.target.value),placeholder:"Ingrese una observacion...",maxLength:500})]}),a.jsx(CB,{onClick:we,disabled:!r||r===Oo&&!o||r===Oo&&o===Yl&&!i||ie.isPending,children:ie.isPending?"Procesando...":r===Oo?"Realizar Transicion":r===e9?"Registrar Consulta":r===t9?"Archivar OT":"Ejecutar"})]})]}),a.jsxs(V$,{children:[a.jsx(H$,{children:"Historial de Gestion"}),a.jsx(W$,{children:a.jsxs($B,{children:[(ae==null?void 0:ae.history.length)===0&&a.jsx("div",{style:{textAlign:"center",padding:"2rem",color:d.colors.textSecondary},children:"No hay registros de gestion"}),ae==null?void 0:ae.history.map(te=>a.jsxs(EB,{children:[a.jsxs(TB,{children:[a.jsxs(AB,{children:[a.jsx(Qp,{$type:"area",children:te.work_space}),a.jsx(Qp,{$type:"state",children:te.state})]}),a.jsx(FB,{children:V(te.created_at)})]}),a.jsxs(DB,{children:["Por: ",te.user_name]}),te.observation&&a.jsxs(PB,{children:['"',te.observation,'"']})]},te.id))]})})]})]}),z$(D)&&a.jsxs(zB,{children:[a.jsxs(IB,{onClick:()=>v(!g),children:[a.jsxs(LB,{children:["Gestionar Muestras",ne&&ne.total>0&&a.jsxs(u_,{$type:"estado",children:[ne.total," muestra",ne.total!==1?"s":""]})]}),a.jsx(BB,{$expanded:g,children:""})]}),a.jsx(UB,{$expanded:g,children:a.jsxs(VB,{children:[I$(D,Ce==null?void 0:Ce.current_area_id)&&a.jsx(GB,{onClick:()=>t("muestra-nueva",e),children:"+ Crear Muestra"}),O?a.jsx(K$,{children:"Cargando muestras..."}):ne&&ne.items.length>0?a.jsxs(HB,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ID"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Tipo Pegado"}),a.jsx("th",{children:"Planta Corte"}),a.jsx("th",{children:"Destinatario"}),a.jsx("th",{children:"N Muestras"}),a.jsx("th",{children:"Fecha Corte"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:ne.items.map(te=>a.jsxs("tr",{className:te.prioritaria?"prioritaria":"",children:[a.jsx("td",{children:te.id}),a.jsx("td",{children:te.cad||"--"}),a.jsx("td",{children:te.carton||"--"}),a.jsx("td",{children:te.tipo_pegado||"--"}),a.jsx("td",{children:te.sala_corte||"--"}),a.jsx("td",{children:te.creador_nombre||"--"}),a.jsx("td",{children:te.cantidad_total}),a.jsx("td",{children:te.created_at||"--"}),a.jsxs("td",{children:[a.jsx(u_,{$type:"estado",children:te.estado_nombre}),te.prioritaria&&a.jsx(u_,{$type:"prioritaria",children:"Prioritaria"})]}),a.jsx("td",{children:a.jsxs(WB,{children:[sB(D,Ce==null?void 0:Ce.current_area_id,te.estado,H,te)&&a.jsx(Xl,{onClick:()=>B(te.id),title:"Editar muestra",children:""}),hB(D,te.estado)&&a.jsx(Xl,{onClick:()=>B(te.id),title:"Ver detalle",children:""}),oB(D,Ce==null?void 0:Ce.current_area_id,te.estado,H,te)&&a.jsx(Xl,{className:"success",onClick:()=>N.mutate(te.id),disabled:N.isPending,title:"Terminar muestra",children:""}),lB(D,Ce==null?void 0:Ce.current_area_id)&&a.jsx(Xl,{onClick:()=>K.mutate(te.id),disabled:K.isPending,title:te.prioritaria?"Quitar prioridad":"Marcar prioritaria",children:""}),cB(D,Ce==null?void 0:Ce.current_area_id,te.estado)&&a.jsx(Xl,{className:"danger",onClick:()=>L.mutate(te.id),disabled:L.isPending,title:"Anular muestra",children:""}),dB(D,Ce==null?void 0:Ce.current_area_id,te.estado,H,te)&&a.jsx(Xl,{className:"danger",onClick:()=>re.mutate(te.id),disabled:re.isPending,title:"Rechazar muestra",children:""}),uB(D,Ce==null?void 0:Ce.current_area_id,te.estado,H,te)&&a.jsx(Xl,{onClick:()=>Z.mutate(te.id),disabled:Z.isPending,title:"Devolver muestra",children:""})]})})]},te.id))})]}):a.jsxs(K$,{children:["No hay muestras registradas para esta OT.",I$(D,Ce==null?void 0:Ce.current_area_id)&&a.jsx("div",{style:{marginTop:"0.5rem"},children:'Haga clic en "Crear Muestra" para agregar una.'})]})]})})]}),x&&y&&a.jsx(qB,{onClick:()=>j(!1),children:a.jsxs(KB,{onClick:te=>te.stopPropagation(),children:[a.jsxs(XB,{children:[a.jsxs(YB,{children:["Editar Muestra ID ",y.id]}),a.jsx(QB,{onClick:()=>j(!1),children:""})]}),a.jsxs(JB,{children:[a.jsxs(h_,{children:[a.jsx(f_,{children:"Caractersticas de Muestra"}),a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CAD"}),a.jsxs(Mi,{value:S.cad_id||"",onChange:te=>T(Pe=>({...Pe,cad_id:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),F==null?void 0:F.cads.map(te=>a.jsx("option",{value:te.id,children:te.codigo},te.id))]})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"Cartn"}),a.jsxs(Mi,{value:S.carton_id||"",onChange:te=>T(Pe=>({...Pe,carton_id:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),F==null?void 0:F.cartones.map(te=>a.jsx("option",{value:te.id,children:te.codigo},te.id))]})]})]}),a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"Tipo de Pegado"}),a.jsxs(Mi,{value:S.pegado_id||"",onChange:te=>T(Pe=>({...Pe,pegado_id:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(Te=F==null?void 0:F.pegados)==null?void 0:Te.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"Tiempo Unitario"}),a.jsx(cs,{type:"time",value:S.tiempo_unitario||"",onChange:te=>T(Pe=>({...Pe,tiempo_unitario:te.target.value||void 0}))})]})]}),a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"Cartn Muestra"}),a.jsxs(Mi,{value:S.carton_muestra_id||"",onChange:te=>T(Pe=>({...Pe,carton_muestra_id:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),F==null?void 0:F.cartones.map(te=>a.jsx("option",{value:te.id,children:te.codigo},te.id))]})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"Planta de Corte"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})]})]}),a.jsxs(h_,{children:[a.jsx(f_,{children:"Enviar Muestras A"}),a.jsx(Ca,{children:a.jsx(gr,{style:{width:"100%"},children:a.jsxs(Mi,{value:((E=y.destinatarios_id)==null?void 0:E[0])||"",disabled:!0,style:{backgroundColor:"#f5f5f5"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:"1",children:"Retira Ventas VB"}),a.jsx("option",{value:"2",children:"Retira Diseador VB"}),a.jsx("option",{value:"3",children:"Envo Laboratorio"}),a.jsx("option",{value:"4",children:"Envo Cliente VB"}),a.jsx("option",{value:"5",children:"Retira Diseador Revisin"})]})})})]}),a.jsxs(h_,{children:[a.jsx(f_,{children:"Datos de Muestra"}),((_e=y.destinatarios_id)==null?void 0:_e[0])==="1"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CANTIDAD"}),a.jsx(cs,{type:"number",min:"0",value:S.cantidad_vendedor||0,onChange:te=>T(Pe=>({...Pe,cantidad_vendedor:Number(te.target.value)}))})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"FORMA DE ENTREGA"}),a.jsx(cs,{type:"text",value:"Retira Vendedor",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Ca,{children:a.jsxs(gr,{children:[a.jsx(kr,{children:"PLANTA DE CORTE"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})})]}),((wt=y.destinatarios_id)==null?void 0:wt[0])==="2"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CANTIDAD"}),a.jsx(cs,{type:"number",min:"0",value:S.cantidad_disenador||0,onChange:te=>T(Pe=>({...Pe,cantidad_disenador:Number(te.target.value)}))})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"FORMA DE ENTREGA"}),a.jsx(cs,{type:"text",value:y.comentario_disenador||"fsica",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Ca,{children:a.jsxs(gr,{children:[a.jsx(kr,{children:"PLANTA DE CORTE"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})})]}),((Vr=y.destinatarios_id)==null?void 0:Vr[0])==="3"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CANTIDAD"}),a.jsx(cs,{type:"number",min:"0",value:S.cantidad_laboratorio||0,onChange:te=>T(Pe=>({...Pe,cantidad_laboratorio:Number(te.target.value)}))})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"FORMA DE ENTREGA"}),a.jsx(cs,{type:"text",value:y.comentario_laboratorio||"",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Ca,{children:a.jsxs(gr,{children:[a.jsx(kr,{children:"PLANTA DE CORTE"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})})]}),((pn=y.destinatarios_id)==null?void 0:pn[0])==="4"&&a.jsx(a.Fragment,{children:a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CANTIDAD"}),a.jsx(cs,{type:"number",min:"0",value:S.cantidad_1||0,onChange:te=>T(Pe=>({...Pe,cantidad_1:Number(te.target.value)}))})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"PLANTA DE CORTE"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})]})}),((Nn=y.destinatarios_id)==null?void 0:Nn[0])==="5"&&a.jsxs(a.Fragment,{children:[a.jsxs(Ca,{children:[a.jsxs(gr,{children:[a.jsx(kr,{children:"CANTIDAD"}),a.jsx(cs,{type:"number",min:"0",value:S.cantidad_disenador_revision||0,onChange:te=>T(Pe=>({...Pe,cantidad_disenador_revision:Number(te.target.value)}))})]}),a.jsxs(gr,{children:[a.jsx(kr,{children:"FORMA DE ENTREGA"}),a.jsx(cs,{type:"text",value:y.comentario_disenador_revision||"",disabled:!0,style:{backgroundColor:"#f5f5f5"}})]})]}),a.jsx(Ca,{children:a.jsxs(gr,{children:[a.jsx(kr,{children:"PLANTA DE CORTE"}),a.jsxs(Mi,{value:S.sala_corte_vendedor||"",onChange:te=>T(Pe=>({...Pe,sala_corte_vendedor:te.target.value?Number(te.target.value):void 0})),children:[a.jsx("option",{value:"",children:"Seleccionar"}),F==null?void 0:F.salas_corte.map(te=>a.jsx("option",{value:te.id,children:te.nombre},te.id))]})]})})]})]})]}),a.jsxs(ZB,{children:[a.jsx(X$,{onClick:()=>j(!1),children:"Cancelar"}),a.jsx(X$,{$primary:!0,onClick:se,disabled:me.isPending,children:me.isPending?"Guardando...":"Guardar"})]})]})})]})}const p_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,m_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,g_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,x_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,i9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,s9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,ei=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,ti=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,o9=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,Y$=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,l9=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  min-width: 40px;
  text-align: center;

  ${e=>e.$days>5?`
        background: ${d.colors.danger}15;
        color: ${d.colors.danger};
      `:e.$days>2?`
        background: #ffc10715;
        color: #d9a406;
      `:`
      background: ${d.colors.success}15;
      color: ${d.colors.success};
    `}
`,v_=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Q$=p.button`
  padding: 0.35rem 0.75rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.5rem;

  ${e=>e.$variant==="success"?`
    background: ${d.colors.success};
    color: white;

    &:hover {
      background: #218838;
    }
  `:`
    background: ${d.colors.primary};
    color: white;

    &:hover {
      background: #002d66;
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,c9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,d9=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
`,u9=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,h9=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,f9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,J$=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,p9=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,m9=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,__=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,g9=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  font-style: italic;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function x9({onNavigate:e}){const[t,r]=C.useState(1),[n,i]=C.useState(null),[s,o]=C.useState(null),{data:l,isLoading:c,error:u}=N7(t,20),h=z7(),f=C.useCallback(y=>{h.mutate(y,{onSuccess:()=>{i("Notificacion marcada como leida"),o(null),setTimeout(()=>i(null),3e3)},onError:b=>{o(b.message||"Error al marcar notificacion"),i(null)}})},[h]),m=C.useCallback(y=>{e("gestionar-ot",y)},[e]);if(c)return a.jsxs(p_,{children:[a.jsxs(m_,{children:[a.jsx(g_,{children:"Notificaciones"}),a.jsx(x_,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsxs(u9,{children:[a.jsx(h9,{}),a.jsx("span",{children:"Cargando notificaciones..."})]})]});if(u)return a.jsxs(p_,{children:[a.jsxs(m_,{children:[a.jsx(g_,{children:"Notificaciones"}),a.jsx(x_,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),a.jsx(__,{$type:"error",children:"Error al cargar notificaciones. Intente nuevamente."})]});const _=(l==null?void 0:l.items)||[],g=(l==null?void 0:l.total_pages)||1,v=(l==null?void 0:l.total)||0;return a.jsxs(p_,{children:[a.jsxs(m_,{children:[a.jsx(g_,{children:"Notificaciones"}),a.jsx(x_,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})]}),n&&a.jsx(__,{$type:"success",children:n}),s&&a.jsx(__,{$type:"error",children:s}),a.jsxs(m9,{children:["Mostrando ",_.length," de ",v," notificaciones"]}),a.jsx(i9,{children:_.length===0?a.jsxs(c9,{children:[a.jsx(d9,{children:""}),a.jsx("p",{children:"No tienes notificaciones pendientes"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(s9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ei,{children:"OT"}),a.jsx(ei,{children:"Dias"}),a.jsx(ei,{children:"Cliente"}),a.jsx(ei,{children:"Descripcion"}),a.jsx(ei,{children:"Item"}),a.jsx(ei,{children:"Estado"}),a.jsx(ei,{children:"Area"}),a.jsx(ei,{children:"Generador"}),a.jsx(ei,{children:"Motivo"}),a.jsx(ei,{children:"Observacion"}),a.jsx(ei,{children:"Fecha"}),a.jsx(ei,{children:"Acciones"})]})}),a.jsx("tbody",{children:_.map(y=>a.jsxs(o9,{children:[a.jsx(ti,{children:a.jsxs("strong",{children:["#",y.work_order_id]})}),a.jsx(ti,{children:a.jsx(l9,{$days:y.dias_total||0,children:y.dias_total||0})}),a.jsx(ti,{children:a.jsx(v_,{title:y.client_name,children:y.client_name})}),a.jsx(ti,{children:a.jsx(v_,{title:y.ot_descripcion,children:y.ot_descripcion})}),a.jsx(ti,{children:y.item_tipo||"-"}),a.jsx(ti,{children:a.jsx(Y$,{$type:"state",children:y.estado})}),a.jsx(ti,{children:y.area&&a.jsx(Y$,{$type:"area",children:y.area})}),a.jsx(ti,{children:y.generador_nombre}),a.jsx(ti,{children:a.jsx(v_,{title:y.motivo,children:y.motivo})}),a.jsx(ti,{children:y.observacion&&a.jsx(g9,{title:y.observacion,children:y.observacion})}),a.jsx(ti,{children:y.created_at}),a.jsxs(ti,{children:[a.jsx(Q$,{$variant:"primary",onClick:()=>m(y.work_order_id),title:"Gestionar OT",children:"Gestionar"}),a.jsx(Q$,{$variant:"success",onClick:()=>f(y.id),disabled:h.isPending,title:"Marcar como leida",children:"Leido"})]})]},y.id))})]}),g>1&&a.jsxs(f9,{children:[a.jsx(J$,{disabled:t===1,onClick:()=>r(y=>y-1),children:"Anterior"}),a.jsxs(p9,{children:["Pagina ",t," de ",g]}),a.jsx(J$,{disabled:t===g,onClick:()=>r(y=>y+1),children:"Siguiente"})]})]})})]})}const y_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,b_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,j_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,w_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,Z$=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,v9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Ls=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Bs=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,eE=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,tE=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,k_=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"approve":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;case"reject":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover {
            background: ${d.colors.danger};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,rE=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,nE=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,aE=p.p`
  font-size: 1rem;
  margin: 0;
`,_9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,y9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,S_=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,C_=p.span`
  display: block;
  max-width: 200px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,b9=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`;function j9({onNavigate:e}){const[t,r]=C.useState(1),n=20,i=Pr(),{data:s,isLoading:o,error:l}=Nt({queryKey:["pendingApproval",t],queryFn:()=>Fn.getPendingApproval(t,n)}),c=jt({mutationFn:b=>Fn.approve(b),onSuccess:()=>{i.invalidateQueries({queryKey:["pendingApproval"]})}}),u=jt({mutationFn:b=>Fn.reject(b),onSuccess:()=>{i.invalidateQueries({queryKey:["pendingApproval"]})}}),h=C.useCallback(b=>{window.confirm(`Aprobar OT ${b}?`)&&c.mutate(b)},[c]),f=C.useCallback(b=>{window.confirm(`Rechazar OT ${b}?`)&&u.mutate(b)},[u]),m=C.useCallback(b=>{e("gestionar-ot",b)},[e]),_=b=>b?new Date(b).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(o)return a.jsxs(y_,{children:[a.jsxs(b_,{children:[a.jsx(j_,{children:"OTs por Aprobar"}),a.jsx(w_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx(_9,{children:"Cargando..."})]});if(l)return a.jsxs(y_,{children:[a.jsxs(b_,{children:[a.jsx(j_,{children:"OTs por Aprobar"}),a.jsx(w_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(rE,{children:[a.jsx(nE,{children:"!"}),a.jsx(aE,{children:"Error al cargar las OTs pendientes"})]})]});const g=(s==null?void 0:s.items)||[],v=(s==null?void 0:s.total_pages)||1,y=(s==null?void 0:s.total)||0;return a.jsxs(y_,{children:[a.jsxs(b_,{children:[a.jsxs(j_,{children:["OTs por Aprobar (",y,")"]}),a.jsx(w_,{onClick:()=>e("dashboard"),children:"Volver"})]}),g.length===0?a.jsx(Z$,{children:a.jsxs(rE,{children:[a.jsx(nE,{children:""}),a.jsx(aE,{children:"No hay OTs pendientes de aprobacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(Z$,{children:a.jsxs(v9,{children:[a.jsx("thead",{children:a.jsxs(eE,{children:[a.jsx(Ls,{style:{width:"60px"},children:"OT"}),a.jsx(Ls,{style:{width:"80px"},children:"Creacion"}),a.jsx(Ls,{children:"Creador"}),a.jsx(Ls,{children:"Cliente"}),a.jsx(Ls,{children:"Descripcion"}),a.jsx(Ls,{style:{width:"80px"},children:"Canal"}),a.jsx(Ls,{style:{width:"80px"},children:"Item"}),a.jsx(Ls,{style:{width:"60px"},children:"Estado"}),a.jsx(Ls,{style:{width:"120px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:g.map(b=>a.jsxs(eE,{children:[a.jsx(Bs,{children:a.jsx(tE,{children:b.id})}),a.jsx(Bs,{children:_(b.created_at)}),a.jsx(Bs,{children:a.jsx(C_,{title:b.creador_nombre,children:b.creador_nombre})}),a.jsx(Bs,{children:a.jsx(C_,{title:b.client_name,children:b.client_name})}),a.jsx(Bs,{children:a.jsx(C_,{title:b.descripcion,children:b.descripcion})}),a.jsx(Bs,{children:b.canal||"-"}),a.jsx(Bs,{children:b.item_tipo||"-"}),a.jsx(Bs,{children:a.jsx(tE,{$type:"state",title:b.estado,children:b.estado_abrev})}),a.jsx(Bs,{children:a.jsxs(b9,{children:[a.jsx(k_,{$variant:"view",onClick:()=>m(b.id),title:"Ver OT",children:"Ver"}),a.jsx(k_,{$variant:"approve",onClick:()=>h(b.id),disabled:c.isPending,title:"Aprobar OT",children:""}),a.jsx(k_,{$variant:"reject",onClick:()=>f(b.id),disabled:u.isPending,title:"Rechazar OT",children:""})]})})]},b.id))})]})}),v>1&&a.jsxs(y9,{children:[a.jsx(S_,{onClick:()=>r(b=>Math.max(1,b-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,v)},(b,x)=>{const j=Math.max(1,Math.min(t-2,v-4))+x;return j>v?null:a.jsx(S_,{$active:j===t,onClick:()=>r(j),children:j},j)}),a.jsx(S_,{onClick:()=>r(b=>Math.min(v,b+1)),disabled:t===v,children:"Siguiente"})]})]})]})}const $_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,E_=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,T_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,A_=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,w9=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 1rem;
  padding: 1rem;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
`,em=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,tm=p.label`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,iE=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,sE=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,k9=p.button`
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    opacity: 0.9;
  }
`,S9=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  align-self: flex-end;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,oE=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,C9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Oi=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ri=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,lE=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,rm=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,cE=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"assign":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover {
            background: ${d.colors.success};
            color: white;
          }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover {
            background: ${d.colors.primary};
            color: white;
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,dE=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,uE=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,hE=p.p`
  font-size: 1rem;
  margin: 0;
`,$9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,E9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
`,F_=p.button`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${e=>e.$active?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$active?d.colors.primary:"white"};
  color: ${e=>e.$active?"white":d.colors.textPrimary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${e=>e.$active?"white":d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,nm=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,T9=p.div`
  display: flex;
  gap: 0.25rem;
  justify-content: center;
`,A9=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,F9=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  min-width: 400px;
  max-width: 500px;
`,D9=p.h3`
  margin: 0 0 1rem 0;
  font-size: 1.25rem;
  color: ${d.colors.textPrimary};
`,P9=p.p`
  margin: 0 0 1rem 0;
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`,M9=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,O9=p.div`
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
`,fE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function R9({onNavigate:e}){const[t,r]=C.useState(1),[n,i]=C.useState({page:1,page_size:20}),[s,o]=C.useState({}),[l,c]=C.useState(!1),[u,h]=C.useState(null),[f,m]=C.useState(""),_=Pr(),{data:g,isLoading:v,error:y}=Nt({queryKey:["pendingAssignment",n],queryFn:()=>Zv.getPendingAssignment(n)}),{data:b}=Nt({queryKey:["professionals"],queryFn:()=>Zv.getProfessionals(),enabled:l}),x=jt({mutationFn:({otId:W,profesionalId:R})=>Zv.assign(W,R),onSuccess:()=>{_.invalidateQueries({queryKey:["pendingAssignment"]}),c(!1),h(null),m("")}}),j=C.useCallback(()=>{i({...s,page:1,page_size:20}),r(1)},[s]),S=C.useCallback(()=>{o({}),i({page:1,page_size:20}),r(1)},[]),T=C.useCallback(W=>{r(W),i(R=>({...R,page:W}))},[]),F=C.useCallback(W=>{h(W),m(""),c(!0)},[]),w=C.useCallback(()=>{u&&f!==""&&x.mutate({otId:u.id,profesionalId:f})},[u,f,x]),P=C.useCallback(W=>{e("gestionar-ot",W)},[e]),M=W=>W?new Date(W).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",A=W=>W>=7?"danger":W>=3?"warning":"info";if(v)return a.jsxs($_,{children:[a.jsxs(E_,{children:[a.jsx(T_,{children:"Asignacion de OTs"}),a.jsx(A_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsx($9,{children:"Cargando..."})]});if(y)return a.jsxs($_,{children:[a.jsxs(E_,{children:[a.jsx(T_,{children:"Asignacion de OTs"}),a.jsx(A_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(dE,{children:[a.jsx(uE,{children:"!"}),a.jsx(hE,{children:"Error al cargar las OTs pendientes de asignacion"})]})]});const D=(g==null?void 0:g.items)||[],H=(g==null?void 0:g.total_pages)||1,U=(g==null?void 0:g.total)||0;return a.jsxs($_,{children:[a.jsxs(E_,{children:[a.jsxs(T_,{children:["Asignacion de OTs (",U,")"]}),a.jsx(A_,{onClick:()=>e("dashboard"),children:"Volver"})]}),a.jsxs(w9,{children:[a.jsxs(em,{children:[a.jsx(tm,{children:"Estado Asignacion"}),a.jsxs(iE,{value:s.asignado??"",onChange:W=>o(R=>({...R,asignado:W.target.value===""?void 0:W.target.value})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NO",children:"Sin Asignar"}),a.jsx("option",{value:"SI",children:"Asignados"})]})]}),a.jsxs(em,{children:[a.jsx(tm,{children:"Tipo Solicitud"}),a.jsxs(iE,{value:s.tipo_solicitud??"",onChange:W=>o(R=>({...R,tipo_solicitud:W.target.value||void 0})),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"NUEVO",children:"Nuevo"}),a.jsx("option",{value:"REPETICION",children:"Repeticion"}),a.jsx("option",{value:"MODIFICACION",children:"Modificacion"})]})]}),a.jsxs(em,{children:[a.jsx(tm,{children:"Desde"}),a.jsx(sE,{type:"date",value:s.date_desde??"",onChange:W=>o(R=>({...R,date_desde:W.target.value||void 0}))})]}),a.jsxs(em,{children:[a.jsx(tm,{children:"Hasta"}),a.jsx(sE,{type:"date",value:s.date_hasta??"",onChange:W=>o(R=>({...R,date_hasta:W.target.value||void 0}))})]}),a.jsx(k9,{onClick:j,children:"Filtrar"}),a.jsx(S9,{onClick:S,children:"Limpiar"})]}),D.length===0?a.jsx(oE,{children:a.jsxs(dE,{children:[a.jsx(uE,{children:""}),a.jsx(hE,{children:"No hay OTs pendientes de asignacion"})]})}):a.jsxs(a.Fragment,{children:[a.jsx(oE,{children:a.jsxs(C9,{children:[a.jsx("thead",{children:a.jsxs(lE,{children:[a.jsx(Oi,{style:{width:"60px"},children:"OT"}),a.jsx(Oi,{style:{width:"80px"},children:"Creacion"}),a.jsx(Oi,{children:"Cliente"}),a.jsx(Oi,{children:"Vendedor"}),a.jsx(Oi,{style:{width:"90px"},children:"Tipo"}),a.jsx(Oi,{style:{width:"80px"},children:"Canal"}),a.jsx(Oi,{children:"Jerarquia"}),a.jsx(Oi,{style:{width:"80px"},children:"CAD"}),a.jsx(Oi,{children:"Profesional"}),a.jsx(Oi,{style:{width:"60px"},children:"Dias"}),a.jsx(Oi,{style:{width:"100px",textAlign:"center"},children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(W=>a.jsxs(lE,{children:[a.jsx(Ri,{children:a.jsx(rm,{children:W.id})}),a.jsx(Ri,{children:M(W.created_at)}),a.jsx(Ri,{children:a.jsx(nm,{title:W.client_name,children:W.client_name})}),a.jsx(Ri,{children:a.jsx(nm,{title:W.vendedor_nombre,children:W.vendedor_nombre})}),a.jsx(Ri,{children:a.jsx(rm,{$type:"info",children:W.tipo_solicitud})}),a.jsx(Ri,{children:W.canal||"-"}),a.jsx(Ri,{children:a.jsx(nm,{title:`${W.jerarquia_1||""} > ${W.jerarquia_2||""} > ${W.jerarquia_3||""}`,children:W.jerarquia_1||"-"})}),a.jsx(Ri,{children:W.cad||"-"}),a.jsx(Ri,{children:a.jsx(nm,{title:W.profesional_asignado||"Sin asignar",children:W.profesional_asignado||a.jsx(rm,{$type:"warning",children:"Sin asignar"})})}),a.jsx(Ri,{children:a.jsxs(rm,{$type:A(W.dias_sin_asignar),children:[W.dias_sin_asignar,"d"]})}),a.jsx(Ri,{children:a.jsxs(T9,{children:[a.jsx(cE,{$variant:"view",onClick:()=>P(W.id),title:"Ver OT",children:"Ver"}),!W.profesional_asignado&&a.jsx(cE,{$variant:"assign",onClick:()=>F(W),title:"Asignar Profesional",children:"Asignar"})]})})]},W.id))})]})}),H>1&&a.jsxs(E9,{children:[a.jsx(F_,{onClick:()=>T(Math.max(1,t-1)),disabled:t===1,children:"Anterior"}),Array.from({length:Math.min(5,H)},(W,R)=>{const ae=Math.max(1,Math.min(t-2,H-4))+R;return ae>H?null:a.jsx(F_,{$active:ae===t,onClick:()=>T(ae),children:ae},ae)}),a.jsx(F_,{onClick:()=>T(Math.min(H,t+1)),disabled:t===H,children:"Siguiente"})]})]}),l&&u&&a.jsx(A9,{onClick:()=>c(!1),children:a.jsxs(F9,{onClick:W=>W.stopPropagation(),children:[a.jsx(D9,{children:"Asignar Profesional"}),a.jsxs(P9,{children:["OT #",u.id," - ",u.client_name]}),a.jsxs(M9,{value:f,onChange:W=>m(W.target.value?Number(W.target.value):""),children:[a.jsx("option",{value:"",children:"Seleccione un profesional..."}),b==null?void 0:b.map(W=>a.jsxs("option",{value:W.id,children:[W.nombre," (",W.rol,")"]},W.id))]}),a.jsxs(O9,{children:[a.jsx(fE,{onClick:()=>c(!1),children:"Cancelar"}),a.jsx(fE,{$primary:!0,onClick:w,disabled:!f||x.isPending,children:x.isPending?"Asignando...":"Asignar"})]})]})})]})}const D_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,P_=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,M_=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,N9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,z9=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,Ch=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,$h=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Eh=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,I9=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,am=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover:not(:disabled) { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover:not(:disabled) { background: #218838; }
        `;case"disabled":return`
          background: #ccc;
          color: #666;
          border-color: #ccc;
          cursor: not-allowed;
          opacity: 0.5;
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover:not(:disabled) {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,L9=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,B9=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,rl=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,pE=p(rl)`
  text-align: center;
  width: 100px;
`,nl=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,mE=p(nl)`
  text-align: center;
`,U9=p.tr`
  ${e=>e.$highlighted&&`
    background-color: #d1f3d1;
  `}

  &:hover {
    background: ${e=>e.$highlighted?"#c1e3c1":d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,im=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,sm=p.input`
  width: 16px;
  height: 16px;
  cursor: pointer;
`,V9=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,H9=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,W9=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,G9=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,gE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,q9=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,K9=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,X9=p.span`
  color: ${d.colors.textPrimary};
  font-size: 0.875rem;
`,xE=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`;function Y9({onNavigate:e}){const[t,r]=C.useState({page:1,page_size:20}),[n,i]=C.useState(""),[s,o]=C.useState(""),[l,c]=C.useState(""),[u,h]=C.useState(""),[f,m]=C.useState(""),[_,g]=C.useState({}),[v,y]=C.useState(null),{data:b,isLoading:x,error:j}=Nt({queryKey:["ots-cotizables",t],queryFn:()=>Fn.list(t)}),S=C.useMemo(()=>b!=null&&b.items?b.items:[],[b==null?void 0:b.items]),T=C.useCallback(G=>{G.preventDefault();const z={...t,page:1};n&&(z.date_desde=n),s&&(z.date_hasta=s),l&&(z.id_ot=parseInt(l,10)),u&&(z.cad=u),f&&(z.descripcion=f),r(z),g({})},[t,n,s,l,u,f]),F=C.useCallback(()=>{i(""),o(""),c(""),h(""),m(""),r({page:1,page_size:20}),g({})},[]),w=C.useCallback((G,z)=>{g(ie=>{const ne=ie[G]||{corrugado:!1,esquinero:!1};return{...ie,[G]:{...ne,[z]:!ne[z]}}})},[]),P=C.useCallback((G,z)=>{g(ie=>{const ne={...ie};return S.forEach(O=>{var N,L;ne[O.id]={...ne[O.id],corrugado:G==="corrugado"?z:((N=ne[O.id])==null?void 0:N.corrugado)||!1,esquinero:G==="esquinero"?z:((L=ne[O.id])==null?void 0:L.esquinero)||!1}}),ne})},[S]),M=C.useCallback(()=>{const G=Object.entries(_).filter(([z,ie])=>ie.corrugado||ie.esquinero).map(([z,ie])=>({ot_id:parseInt(z,10),tipo_corrugado:ie.corrugado,tipo_esquinero:ie.esquinero}));G.length!==0&&(console.log("Cotizar OTs:",G),y(`Se generar cotizacin para ${G.length} OT(s)`),setTimeout(()=>y(null),3e3))},[_]),A=C.useCallback(G=>{r(z=>({...z,page:G}))},[]),D=C.useMemo(()=>{let G=0,z=0;return Object.values(_).forEach(ie=>{ie.corrugado&&G++,ie.esquinero&&z++}),{corrugadoCount:G,esquineroCount:z,total:G+z}},[_]),H=D.total>0,U=S.length>0&&S.every(G=>{var z;return(z=_[G.id])==null?void 0:z.corrugado}),W=S.length>0&&S.every(G=>{var z;return(z=_[G.id])==null?void 0:z.esquinero}),R=G=>G?new Date(G).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-";if(x)return a.jsxs(D_,{children:[a.jsx(P_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(M_,{children:"Lista de OT para Cotizar"}),a.jsxs(H9,{children:[a.jsx(W9,{}),a.jsx("span",{children:"Cargando OTs..."})]})]});if(j)return a.jsxs(D_,{children:[a.jsx(P_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(M_,{children:"Lista de OT para Cotizar"}),a.jsxs(xE,{$type:"error",children:["Error al cargar OTs: ",j.message]})]});const ae=(b==null?void 0:b.total_pages)||1,le=(b==null?void 0:b.page)||1;return a.jsxs(D_,{children:[a.jsx(P_,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(M_,{children:"Lista de OT para Cotizar"}),v&&a.jsx(xE,{$type:"success",children:v}),a.jsx(N9,{children:a.jsxs("form",{onSubmit:T,children:[a.jsxs(z9,{children:[a.jsxs(Ch,{children:[a.jsx($h,{children:"Desde"}),a.jsx(Eh,{type:"date",value:n,onChange:G=>i(G.target.value)})]}),a.jsxs(Ch,{children:[a.jsx($h,{children:"Hasta"}),a.jsx(Eh,{type:"date",value:s,onChange:G=>o(G.target.value)})]}),a.jsxs(Ch,{children:[a.jsx($h,{children:"OT"}),a.jsx(Eh,{type:"number",placeholder:"ID...",value:l,onChange:G=>c(G.target.value)})]}),a.jsxs(Ch,{children:[a.jsx($h,{children:"CAD"}),a.jsx(Eh,{type:"text",placeholder:"CAD...",value:u,onChange:G=>h(G.target.value)})]}),a.jsxs(Ch,{children:[a.jsx($h,{children:"Descripcin"}),a.jsx(Eh,{type:"text",placeholder:"Descripcin...",value:f,onChange:G=>m(G.target.value)})]})]}),a.jsxs(I9,{children:[a.jsx(am,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(am,{type:"button",onClick:F,children:"Limpiar"}),a.jsx(am,{type:"button",$variant:H?"success":"disabled",disabled:!H,onClick:M,children:"Cotizar"})]})]})}),H&&a.jsxs(K9,{children:[a.jsxs(X9,{children:["Seleccionados: ",D.corrugadoCount," Corrugado, ",D.esquineroCount," Esquinero"]}),a.jsx(am,{onClick:()=>g({}),children:"Limpiar Seleccin"})]}),a.jsx(L9,{children:S.length===0?a.jsx(V9,{children:a.jsx("p",{children:"No hay OTs disponibles para cotizar"})}):a.jsxs(a.Fragment,{children:[a.jsxs(B9,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(rl,{children:"OT"}),a.jsx(rl,{children:"Creacin"}),a.jsx(rl,{children:"Creador"}),a.jsx(rl,{children:"Cliente"}),a.jsx(rl,{children:"Descripcin"}),a.jsx(rl,{children:"CAD"}),a.jsx(rl,{children:"Item"}),a.jsxs(pE,{children:["Tipo Corrugado",a.jsx("br",{}),a.jsx(sm,{type:"checkbox",checked:U,onChange:G=>P("corrugado",G.target.checked)})]}),a.jsxs(pE,{children:["Tipo Esquinero",a.jsx("br",{}),a.jsx(sm,{type:"checkbox",checked:W,onChange:G=>P("esquinero",G.target.checked)})]})]})}),a.jsx("tbody",{children:S.map(G=>{var z,ie;return a.jsxs(U9,{children:[a.jsx(nl,{children:a.jsx("strong",{children:G.id})}),a.jsx(nl,{children:R(G.created_at)}),a.jsx(nl,{children:a.jsx(im,{title:G.creador_nombre,children:G.creador_nombre||"-"})}),a.jsx(nl,{children:a.jsx(im,{title:G.client_name,children:G.client_name||"-"})}),a.jsx(nl,{children:a.jsx(im,{title:G.descripcion,children:G.descripcion||"-"})}),a.jsx(nl,{children:a.jsx(im,{title:G.cad||"-",children:G.cad||"-"})}),a.jsx(nl,{children:G.item_tipo||"-"}),a.jsx(mE,{children:a.jsx(sm,{type:"checkbox",checked:((z=_[G.id])==null?void 0:z.corrugado)||!1,onChange:()=>w(G.id,"corrugado")})}),a.jsx(mE,{children:a.jsx(sm,{type:"checkbox",checked:((ie=_[G.id])==null?void 0:ie.esquinero)||!1,onChange:()=>w(G.id,"esquinero")})})]},G.id)})})]}),ae>1&&a.jsxs(G9,{children:[a.jsx(gE,{disabled:le===1,onClick:()=>A(le-1),children:"Anterior"}),a.jsxs(q9,{children:["Pgina ",le," de ",ae]}),a.jsx(gE,{disabled:le===ae,onClick:()=>A(le+1),children:"Siguiente"})]})]})})]})}const Q9=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,J9=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,Z9=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,eU=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 2rem;
`,O_=p.button`
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"white"};
  border: 2px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.2s;
  text-align: left;

  &:hover {
    border-color: ${d.colors.primary};
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
`,R_=p.div`
  font-size: 2rem;
  margin-bottom: 0.5rem;
`,N_=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`,z_=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,I_=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,L_=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,B_=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,U_=p.div`
  padding: 1rem;
`,vE=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Ni=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ri=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Ql=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,om=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,tU=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,rU=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,nU=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,aU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,_E=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,iU=p.div`
  background: ${d.colors.warning}10;
  border: 1px solid ${d.colors.warning}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,sU=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,oU=[{id:"bct",label:"BCT (lbf)"},{id:"ect",label:"ECT (lb/in)"},{id:"bct_humedo",label:"BCT en Humedo (lbf)"},{id:"flat",label:"Flat Crush (lb/in)"},{id:"humedad",label:"Humedad (%)"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley"},{id:"espesor",label:"Espesor (mm)"},{id:"cera",label:"Cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley"},{id:"flexion_fondo",label:"Flexion de Fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)"},{id:"composicion_papeles",label:"Composicion Papeles"},{id:"cobb_interno",label:"Cobb Interno"},{id:"cobb_externo",label:"Cobb Externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos"},{id:"medidas",label:"Medidas"},{id:"impresion",label:"Impresion"}];function lU({onNavigate:e}){const[t,r]=C.useState(null),[n,i]=C.useState({client_id:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]}),s=C.useCallback((u,h)=>{i(f=>({...f,[u]:h}))},[]),o=C.useCallback(u=>{i(h=>({...h,ensayos_selected:h.ensayos_selected.includes(u)?h.ensayos_selected.filter(f=>f!==u):[...h.ensayos_selected,u]}))},[]),l=C.useCallback(()=>{console.log("Submit special OT:",{type:t,data:n}),alert("Funcionalidad en desarrollo. Datos en consola.")},[t,n]),c=()=>{switch(t){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return a.jsxs(Q9,{children:[a.jsx(J9,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsx(Z9,{children:"Crear OT Especial"}),a.jsx(iU,{children:a.jsx(sU,{children:"Seleccione el tipo de OT especial que desea crear. Estos tipos tienen campos especificos para el analisis de productos de la competencia (Estudio Benchmarking), especificaciones tecnicas detalladas (Ficha Tecnica) o procesos de licitacion."})}),a.jsxs(eU,{children:[a.jsxs(O_,{$active:t==="estudio-bench",onClick:()=>r("estudio-bench"),children:[a.jsx(R_,{children:""}),a.jsx(N_,{children:"Estudio Benchmarking"}),a.jsx(z_,{children:"Analisis de productos de la competencia con ensayos de laboratorio"})]}),a.jsxs(O_,{$active:t==="ficha-tecnica",onClick:()=>r("ficha-tecnica"),children:[a.jsx(R_,{children:""}),a.jsx(N_,{children:"Ficha Tecnica"}),a.jsx(z_,{children:"Especificaciones tecnicas detalladas del producto"})]}),a.jsxs(O_,{$active:t==="licitacion",onClick:()=>r("licitacion"),children:[a.jsx(R_,{children:""}),a.jsx(N_,{children:"Licitacion"}),a.jsx(z_,{children:"OTs para procesos de licitacion con requerimientos especiales"})]})]}),t&&a.jsxs(a.Fragment,{children:[a.jsxs(I_,{children:[a.jsx(L_,{children:a.jsxs(B_,{children:["Datos Comerciales - ",c()]})}),a.jsx(U_,{children:a.jsxs(vE,{children:[a.jsxs(Ni,{children:[a.jsx(ri,{children:"Cliente *"}),a.jsx(om,{value:n.client_id,onChange:u=>s("client_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Descripcion *"}),a.jsx(Ql,{type:"text",value:n.descripcion,onChange:u=>s("descripcion",u.target.value),maxLength:40})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Codigo Producto"}),a.jsx(Ql,{type:"text",value:n.codigo_producto,onChange:u=>s("codigo_producto",u.target.value)})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Tipo de Solicitud"}),a.jsxs(om,{value:n.tipo_solicitud,onChange:u=>s("tipo_solicitud",u.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"})]})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Canal"}),a.jsx(om,{value:n.canal_id,onChange:u=>s("canal_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Jerarquia 1"}),a.jsx(om,{value:n.hierarchy_id,onChange:u=>s("hierarchy_id",u.target.value),children:a.jsx("option",{value:"",children:"Seleccione..."})})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Nombre Contacto"}),a.jsx(Ql,{type:"text",value:n.nombre_contacto,onChange:u=>s("nombre_contacto",u.target.value)})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Email Contacto"}),a.jsx(Ql,{type:"email",value:n.email_contacto,onChange:u=>s("email_contacto",u.target.value)})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Telefono Contacto"}),a.jsx(Ql,{type:"text",value:n.telefono_contacto,onChange:u=>s("telefono_contacto",u.target.value)})]})]})})]}),t==="estudio-bench"&&a.jsxs(I_,{children:[a.jsx(L_,{children:a.jsx(B_,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(U_,{children:[a.jsxs(vE,{children:[a.jsxs(Ni,{children:[a.jsx(ri,{children:"Cantidad de Items"}),a.jsx(Ql,{type:"number",min:"1",value:n.cantidad_estudio_bench,onChange:u=>s("cantidad_estudio_bench",u.target.value)})]}),a.jsxs(Ni,{children:[a.jsx(ri,{children:"Fecha Maxima Entrega"}),a.jsx(Ql,{type:"date",value:n.fecha_maxima_entrega_estudio,onChange:u=>s("fecha_maxima_entrega_estudio",u.target.value)})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(ri,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(rU,{children:oU.map(u=>a.jsxs(nU,{children:[a.jsx("input",{type:"checkbox",checked:n.ensayos_selected.includes(u.id),onChange:()=>o(u.id)}),u.label]},u.id))})]})]})]}),a.jsxs(I_,{children:[a.jsx(L_,{children:a.jsx(B_,{children:"Observaciones"})}),a.jsx(U_,{children:a.jsx(tU,{value:n.observacion,onChange:u=>s("observacion",u.target.value),placeholder:"Ingrese observaciones adicionales..."})})]}),a.jsxs(aU,{children:[a.jsx(_E,{onClick:()=>e("dashboard"),children:"Cancelar"}),a.jsx(_E,{$variant:"success",onClick:l,children:"Guardar OT"})]})]})]})}const V_=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,yE=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,cU=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`,dU=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,uU=p.span`
  background: ${d.colors.primary};
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.9rem;
  font-weight: 600;
`,hU=p.span`
  background: ${({$type:e})=>{switch(e){case"estudio-bench":return`${d.colors.info}20`;case"ficha-tecnica":return`${d.colors.success}20`;case"licitacion":return`${d.colors.warning}20`;default:return`${d.colors.textSecondary}20`}}};
  color: ${({$type:e})=>{switch(e){case"estudio-bench":return d.colors.info;case"ficha-tecnica":return d.colors.success;case"licitacion":return d.colors.warning;default:return d.colors.textSecondary}}};
  padding: 0.25rem 0.75rem;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  margin-left: 0.5rem;
`,Th=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  margin-bottom: 1rem;
`,Ah=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid ${d.colors.border};
  background: ${d.colors.bgLight};
  border-radius: 8px 8px 0 0;
`,Fh=p.h2`
  font-size: 0.9rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Dh=p.div`
  padding: 1rem;
`,lm=p.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,$a=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,oa=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,ni=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,fU=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,pU=p.textarea`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.85rem;
  min-height: 100px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,mU=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;

  @media (max-width: 1024px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,gU=p.label`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};

  input {
    width: 16px;
    height: 16px;
    accent-color: ${d.colors.primary};
  }
`,xU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,H_=p.button`
  padding: 0.6rem 1.25rem;
  border: none;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,vU=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  color: ${d.colors.textSecondary};
  font-size: 1rem;
`,bE=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}30;
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;
  color: ${d.colors.danger};
`,_U=p.div`
  background: ${d.colors.success}15;
  border: 1px solid ${d.colors.success}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
  color: ${d.colors.success};
  text-align: center;
`,W_=[{id:"bct",label:"BCT (lbf)",field:"ensayo_bct"},{id:"ect",label:"ECT (lb/in)",field:"ensayo_ect"},{id:"bct_humedo",label:"BCT en Humedo (lbf)",field:"ensayo_bct_humedo"},{id:"flat",label:"Flat Crush (lb/in)",field:"ensayo_flat"},{id:"humedad",label:"Humedad (%)",field:"ensayo_humedad"},{id:"porosidad_ext",label:"Porosidad Exterior Gurley",field:"ensayo_porosidad_ext"},{id:"espesor",label:"Espesor (mm)",field:"ensayo_espesor"},{id:"cera",label:"Cera",field:"ensayo_cera"},{id:"porosidad_int",label:"Porosidad Interior Gurley",field:"ensayo_porosidad_int"},{id:"flexion_fondo",label:"Flexion de Fondo",field:"ensayo_flexion_fondo"},{id:"gramaje",label:"Gramaje (gr/mt2)",field:"ensayo_gramaje"},{id:"composicion_papeles",label:"Composicion Papeles",field:"ensayo_composicion_papeles"},{id:"cobb_interno",label:"Cobb Interno",field:"ensayo_cobb_interno"},{id:"cobb_externo",label:"Cobb Externo",field:"ensayo_cobb_externo"},{id:"flexion_4_puntos",label:"Flexion 4 Puntos",field:"ensayo_flexion_4_puntos"},{id:"medidas",label:"Medidas",field:"ensayo_medidas"},{id:"impresion",label:"Impresion",field:"ensayo_impresion"}];function yU({otId:e,onNavigate:t}){const[r,n]=C.useState(!0),[i,s]=C.useState(!1),[o,l]=C.useState(null),[c,u]=C.useState(null),[h,f]=C.useState(null),[m,_]=C.useState({client_id:"",client_name:"",descripcion:"",codigo_producto:"",tipo_solicitud:"",canal_id:"",hierarchy_id:"",subhierarchy_id:"",subsubhierarchy_id:"",nombre_contacto:"",email_contacto:"",telefono_contacto:"",observacion:"",cantidad_estudio_bench:"",fecha_maxima_entrega_estudio:"",ensayos_selected:[]});C.useEffect(()=>{(async()=>{try{n(!0),l(null);const j=await Fn.get(e),S=j.tipo_solicitud;let T=null;S===7||j.is_estudio_bench?T="estudio-bench":S===8||j.is_ficha_tecnica?T="ficha-tecnica":(S===9||j.is_licitacion)&&(T="licitacion"),f(T);const F=[];W_.forEach(w=>{(j[w.field]===1||j[w.field]===!0)&&F.push(w.id)}),_({client_id:String(j.client_id||""),client_name:String(j.client_name||""),descripcion:String(j.descripcion||""),codigo_producto:String(j.codigo_producto||""),tipo_solicitud:String(j.tipo_solicitud||""),canal_id:String(j.canal_id||""),hierarchy_id:String(j.hierarchy_id||""),subhierarchy_id:String(j.subhierarchy_id||""),subsubhierarchy_id:String(j.subsubhierarchy_id||""),nombre_contacto:String(j.nombre_contacto||""),email_contacto:String(j.email_contacto||""),telefono_contacto:String(j.telefono_contacto||""),observacion:String(j.observacion||""),cantidad_estudio_bench:String(j.cantidad_estudio_bench||j.cantidad||""),fecha_maxima_entrega_estudio:String(j.fecha_maxima_entrega||""),ensayos_selected:F})}catch(j){console.error("Error loading OT:",j),l("Error al cargar los datos de la OT")}finally{n(!1)}})()},[e]);const g=C.useCallback((x,j)=>{_(S=>({...S,[x]:j})),u(null)},[]),v=C.useCallback(x=>{_(j=>({...j,ensayos_selected:j.ensayos_selected.includes(x)?j.ensayos_selected.filter(S=>S!==x):[...j.ensayos_selected,x]})),u(null)},[]),y=C.useCallback(async()=>{try{s(!0),l(null),u(null);const x={descripcion:m.descripcion,codigo_producto:m.codigo_producto||null,nombre_contacto:m.nombre_contacto||null,email_contacto:m.email_contacto||null,telefono_contacto:m.telefono_contacto||null,observacion:m.observacion||null};h==="estudio-bench"&&(x.cantidad=m.cantidad_estudio_bench?parseInt(m.cantidad_estudio_bench):null,x.fecha_maxima_entrega=m.fecha_maxima_entrega_estudio||null,W_.forEach(j=>{x[j.field]=m.ensayos_selected.includes(j.id)?1:0})),await Fn.update(e,x),u("OT actualizada correctamente"),window.scrollTo({top:0,behavior:"smooth"})}catch(x){console.error("Error updating OT:",x),l("Error al guardar los cambios")}finally{s(!1)}},[e,h,m]),b=()=>{switch(h){case"estudio-bench":return"Estudio Benchmarking";case"ficha-tecnica":return"Ficha Tecnica";case"licitacion":return"Licitacion";default:return"OT Especial"}};return r?a.jsx(V_,{children:a.jsx(vU,{children:"Cargando datos de la OT..."})}):o&&!m.client_id?a.jsxs(V_,{children:[a.jsx(yE,{onClick:()=>t("dashboard"),children:" Volver"}),a.jsxs(bE,{children:[a.jsx("p",{children:o}),a.jsx(H_,{$variant:"primary",onClick:()=>t("dashboard"),style:{marginTop:"1rem"},children:"Volver al Dashboard"})]})]}):a.jsxs(V_,{children:[a.jsx(yE,{onClick:()=>t("work-order-detail",e),children:" Volver al Detalle"}),a.jsx(cU,{children:a.jsx("div",{children:a.jsxs(dU,{children:["Editar OT",a.jsxs(uU,{style:{marginLeft:"0.75rem"},children:["#",e]}),h&&a.jsx(hU,{$type:h,children:b()})]})})}),c&&a.jsx(_U,{children:c}),o&&a.jsx(bE,{style:{marginBottom:"1rem"},children:o}),a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos Comerciales"})}),a.jsx(Dh,{children:a.jsxs(lm,{children:[a.jsxs($a,{children:[a.jsx(oa,{children:"Cliente"}),a.jsx(ni,{type:"text",value:m.client_name,disabled:!0,style:{background:d.colors.bgLight}})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Descripcion *"}),a.jsx(ni,{type:"text",value:m.descripcion,onChange:x=>g("descripcion",x.target.value),maxLength:40,disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Codigo Producto"}),a.jsx(ni,{type:"text",value:m.codigo_producto,onChange:x=>g("codigo_producto",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Tipo de Solicitud"}),a.jsxs(fU,{value:m.tipo_solicitud,disabled:!0,children:[a.jsx("option",{value:"",children:"Seleccione..."}),a.jsx("option",{value:"1",children:"Desarrollo Completo"}),a.jsx("option",{value:"4",children:"Cotiza sin CAD"}),a.jsx("option",{value:"2",children:"Cotiza con CAD"}),a.jsx("option",{value:"3",children:"Muestra con CAD"}),a.jsx("option",{value:"5",children:"Arte con Material"}),a.jsx("option",{value:"6",children:"Otras Solicitudes Desarrollo"}),a.jsx("option",{value:"7",children:"Estudio Benchmarking"}),a.jsx("option",{value:"8",children:"Ficha Tecnica"}),a.jsx("option",{value:"9",children:"Licitacion"})]})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Nombre Contacto"}),a.jsx(ni,{type:"text",value:m.nombre_contacto,onChange:x=>g("nombre_contacto",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Email Contacto"}),a.jsx(ni,{type:"email",value:m.email_contacto,onChange:x=>g("email_contacto",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Telefono Contacto"}),a.jsx(ni,{type:"text",value:m.telefono_contacto,onChange:x=>g("telefono_contacto",x.target.value),disabled:i})]})]})})]}),h==="estudio-bench"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Estudio Benchmarking"})}),a.jsxs(Dh,{children:[a.jsxs(lm,{children:[a.jsxs($a,{children:[a.jsx(oa,{children:"Cantidad de Items"}),a.jsx(ni,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:x=>g("cantidad_estudio_bench",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Fecha Maxima Entrega"}),a.jsx(ni,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:x=>g("fecha_maxima_entrega_estudio",x.target.value),disabled:i})]})]}),a.jsxs("div",{style:{marginTop:"1.5rem"},children:[a.jsx(oa,{style:{marginBottom:"0.75rem",display:"block"},children:"Ensayos Caja"}),a.jsx(mU,{children:W_.map(x=>a.jsxs(gU,{children:[a.jsx("input",{type:"checkbox",checked:m.ensayos_selected.includes(x.id),onChange:()=>v(x.id),disabled:i}),x.label]},x.id))})]})]})]}),h==="ficha-tecnica"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Ficha Tecnica"})}),a.jsx(Dh,{children:a.jsxs(lm,{children:[a.jsxs($a,{children:[a.jsx(oa,{children:"Cantidad"}),a.jsx(ni,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:x=>g("cantidad_estudio_bench",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Fecha Maxima Entrega"}),a.jsx(ni,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:x=>g("fecha_maxima_entrega_estudio",x.target.value),disabled:i})]})]})})]}),h==="licitacion"&&a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Datos de Licitacion"})}),a.jsx(Dh,{children:a.jsxs(lm,{children:[a.jsxs($a,{children:[a.jsx(oa,{children:"Cantidad"}),a.jsx(ni,{type:"number",min:"1",value:m.cantidad_estudio_bench,onChange:x=>g("cantidad_estudio_bench",x.target.value),disabled:i})]}),a.jsxs($a,{children:[a.jsx(oa,{children:"Fecha Maxima Entrega"}),a.jsx(ni,{type:"date",value:m.fecha_maxima_entrega_estudio,onChange:x=>g("fecha_maxima_entrega_estudio",x.target.value),disabled:i})]})]})})]}),a.jsxs(Th,{children:[a.jsx(Ah,{children:a.jsx(Fh,{children:"Observaciones"})}),a.jsx(Dh,{children:a.jsx(pU,{value:m.observacion,onChange:x=>g("observacion",x.target.value),placeholder:"Ingrese observaciones adicionales...",disabled:i})})]}),a.jsxs(xU,{children:[a.jsx(H_,{onClick:()=>t("work-order-detail",e),disabled:i,children:"Cancelar"}),a.jsx(H_,{$variant:"success",onClick:y,disabled:i,children:i?"Guardando...":"Guardar Cambios"})]})]})}const bU=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,jU=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,wU=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,kU=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,SU=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  align-items: end;
`,Ph=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Mh=p.label`
  font-size: 0.7rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,G_=p.input`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,jE=p.select`
  padding: 0.4rem 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.8rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,CU=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1rem;
`,q_=p.button`
  padding: 0.4rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"outline":return`
          background: transparent;
          border: 1px solid ${d.colors.primary};
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}10; }
        `;default:return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textSecondary};
          border: 1px solid ${d.colors.border};
          &:hover { background: white; }
        `}}}
`,$U=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,EU=p.table`
  width: 100%;
  border-collapse: collapse;
`,Ro=p.th`
  padding: 0.75rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`,No=p.td`
  padding: 0.75rem;
  font-size: 0.8rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: top;
`,wE=p.span`
  display: inline-block;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$type:e})=>e==="old"?`${d.colors.danger}10`:`${d.colors.success}10`};
  color: ${({$type:e})=>e==="old"?d.colors.danger:d.colors.success};
`,K_=p.span`
  color: ${d.colors.textSecondary};
  font-style: italic;
  font-size: 0.75rem;
`,TU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,AU=p.div`
  width: 24px;
  height: 24px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,FU=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,DU=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,X_=p.button`
  padding: 0.4rem 0.75rem;
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.8rem;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,PU=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${({$type:e})=>{switch(e){case"Modificacin":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"Insercion":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"Eliminacion":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary};`}}}
`,MU=[{id:1,work_order_id:1234,created_at:"2025-12-20 10:30:00",observacion:"Actualizacion de datos comerciales",operacion:"Modificacin",user_data:{nombre:"Juan",apellido:"Perez"},datos_modificados:[{texto:"Cliente",antiguo_valor:{descripcion:"Cliente Antiguo"},nuevo_valor:{descripcion:"Cliente Nuevo"}},{texto:"Descripcion",antiguo_valor:{descripcion:"Desc 1"},nuevo_valor:{descripcion:"Desc Actualizada"}}]},{id:2,work_order_id:1234,created_at:"2025-12-19 15:45:00",observacion:"Cambio de estado",operacion:"Modificacin",user_data:{nombre:"Maria",apellido:"Garcia"},datos_modificados:[{texto:"Estado",antiguo_valor:{descripcion:"En Proceso"},nuevo_valor:{descripcion:"Completado"}}]},{id:3,work_order_id:1234,created_at:"2025-12-18 09:00:00",observacion:"Creacion de OT",operacion:"Insercion",user_data:{nombre:"Pedro",apellido:"Lopez"},datos_modificados:[{texto:"OT Creada",valor:{descripcion:"Nueva OT #1234"}}]}];function OU({otId:e,onNavigate:t}){const[r,n]=C.useState(""),[i,s]=C.useState(""),[o,l]=C.useState(""),[c,u]=C.useState(""),[h,f]=C.useState(""),[m,_]=C.useState(1),{data:g,isLoading:v}=Nt({queryKey:["ot-log",e,r,i,o,c,h,m],queryFn:async()=>(await new Promise(T=>setTimeout(T,500)),MU)}),y=C.useCallback(T=>{T.preventDefault(),_(1)},[]),b=C.useCallback(()=>{n(""),s(""),l(""),u(""),f(""),_(1)},[]),x=C.useCallback(()=>{console.log("Exporting log for OT:",e),alert("Exportacion en desarrollo")},[e]),j=C.useMemo(()=>g?g.flatMap(T=>T.datos_modificados.map((F,w)=>{var P,M,A;return{...T,modIndex:w,campo:F.texto,valorAntiguo:T.operacion==="Modificacin"?((P=F.antiguo_valor)==null?void 0:P.descripcion)||"":"N/A",valorNuevo:T.operacion==="Modificacin"?((M=F.nuevo_valor)==null?void 0:M.descripcion)||"":((A=F.valor)==null?void 0:A.descripcion)||""}})):[],[g]),S=T=>T?new Date(T).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return a.jsxs(bU,{children:[a.jsxs(jU,{onClick:()=>t("gestionar-ot",e),children:[" Volver a OT #",e]}),a.jsxs(wU,{children:["Historial de Cambios - OT #",e]}),a.jsx(kU,{children:a.jsxs("form",{onSubmit:y,children:[a.jsxs(SU,{children:[a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Desde"}),a.jsx(G_,{type:"date",value:r,onChange:T=>n(T.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Hasta"}),a.jsx(G_,{type:"date",value:i,onChange:T=>s(T.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"ID Cambio"}),a.jsx(G_,{type:"number",placeholder:"ID...",value:o,onChange:T=>l(T.target.value)})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Campo Modificado"}),a.jsxs(jE,{value:c,onChange:T=>u(T.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"cliente",children:"Cliente"}),a.jsx("option",{value:"descripcion",children:"Descripcion"}),a.jsx("option",{value:"estado",children:"Estado"}),a.jsx("option",{value:"area",children:"Area"})]})]}),a.jsxs(Ph,{children:[a.jsx(Mh,{children:"Usuario"}),a.jsx(jE,{value:h,onChange:T=>f(T.target.value),children:a.jsx("option",{value:"",children:"Todos"})})]})]}),a.jsxs(CU,{children:[a.jsx(q_,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(q_,{type:"button",onClick:b,children:"Limpiar"}),a.jsx(q_,{type:"button",$variant:"outline",onClick:x,children:"Exportar"})]})]})}),a.jsx($U,{children:v?a.jsxs(TU,{children:[a.jsx(AU,{}),a.jsx("span",{children:"Cargando historial..."})]}):j.length===0?a.jsx(FU,{children:a.jsx("p",{children:"No hay registros de cambios para esta OT"})}):a.jsxs(a.Fragment,{children:[a.jsxs(EU,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ro,{style:{width:"8%"},children:"OT"}),a.jsx(Ro,{style:{width:"8%"},children:"ID Cambio"}),a.jsx(Ro,{style:{width:"12%"},children:"Fecha"}),a.jsx(Ro,{style:{width:"15%"},children:"Descripcion"}),a.jsx(Ro,{style:{width:"12%"},children:"Campo"}),a.jsx(Ro,{style:{width:"15%"},children:"Valor Antiguo"}),a.jsx(Ro,{style:{width:"15%"},children:"Valor Nuevo"}),a.jsx(Ro,{style:{width:"15%"},children:"Usuario"})]})}),a.jsx("tbody",{children:j.map(T=>a.jsxs("tr",{children:[a.jsx(No,{children:T.work_order_id}),a.jsx(No,{children:T.id}),a.jsx(No,{children:S(T.created_at)}),a.jsxs(No,{children:[a.jsx(PU,{$type:T.operacion,children:T.operacion}),a.jsx("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem"},children:T.observacion})]}),a.jsx(No,{children:T.campo}),a.jsx(No,{children:T.valorAntiguo==="N/A"?a.jsx(K_,{children:"N/A"}):T.valorAntiguo?a.jsx(wE,{$type:"old",children:T.valorAntiguo}):a.jsx(K_,{children:"Campo Vacio"})}),a.jsx(No,{children:T.valorNuevo?a.jsx(wE,{$type:"new",children:T.valorNuevo}):a.jsx(K_,{children:"Campo Vacio"})}),a.jsxs(No,{children:[T.user_data.nombre," ",T.user_data.apellido]})]},`${T.id}-${T.modIndex}`))})]}),a.jsxs(DU,{children:[a.jsx(X_,{disabled:m===1,onClick:()=>_(T=>T-1),children:"Anterior"}),a.jsx(X_,{$active:!0,children:m}),a.jsx(X_,{onClick:()=>_(T=>T+1),children:"Siguiente"})]})]})})]})}function RU(e={}){return Nt({queryKey:["clients",e],queryFn:()=>gd.list(e)})}function NU(){return Nt({queryKey:["clasificaciones"],queryFn:()=>gd.getClasificaciones(),staleTime:1e3*60*10})}function zU(){const e=Pr();return jt({mutationFn:t=>gd.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]})}})}function IU(){const e=Pr();return jt({mutationFn:({id:t,data:r})=>gd.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r.id]})}})}function LU(){const e=Pr();return jt({mutationFn:t=>gd.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function BU(){const e=Pr();return jt({mutationFn:t=>gd.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["client",r]})}})}function UU(e={}){return Nt({queryKey:["users",e],queryFn:()=>xd.list(e)})}function VU(){return Nt({queryKey:["roles"],queryFn:()=>xd.getRoles(),staleTime:1e3*60*10})}function HU(){return Nt({queryKey:["workspaces"],queryFn:()=>xd.getWorkSpaces(),staleTime:1e3*60*10})}function WU(){const e=Pr();return jt({mutationFn:t=>xd.create(t),onSuccess:()=>{e.invalidateQueries({queryKey:["users"]})}})}function GU(){const e=Pr();return jt({mutationFn:({id:t,data:r})=>xd.update(t,r),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r.id]})}})}function qU(){const e=Pr();return jt({mutationFn:t=>xd.activate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}function KU(){const e=Pr();return jt({mutationFn:t=>xd.deactivate(t),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["users"]}),e.invalidateQueries({queryKey:["user",r]})}})}const XU=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,YU=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,QU=p.div`
  padding: 1.5rem;
`,JU=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,zi=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,Ii=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,kE=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,ds=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,ZU=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,eV=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,SE=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Y_=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,tV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`;function rV(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let i=0,s=2;for(let c=n.length-1;c>=0;c--)i+=parseInt(n[c])*s,s=s<7?s+1:2;const o=11-i%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function nV(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function aV({client:e,clasificaciones:t,onSubmit:r,onCancel:n,isLoading:i}){const s=!!e,[o,l]=C.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",razon_social:(e==null?void 0:e.razon_social)||"",giro:(e==null?void 0:e.giro)||"",direccion:(e==null?void 0:e.direccion)||"",comuna:(e==null?void 0:e.comuna)||"",ciudad:(e==null?void 0:e.ciudad)||"",telefono:(e==null?void 0:e.telefono)||"",email:(e==null?void 0:e.email)||"",contacto:(e==null?void 0:e.contacto)||"",clasificacion_id:(e==null?void 0:e.clasificacion_id)||null}),[c,u]=C.useState({}),[h,f]=C.useState({});C.useEffect(()=>{e&&l({rut:e.rut||"",nombre:e.nombre||"",razon_social:e.razon_social||"",giro:e.giro||"",direccion:e.direccion||"",comuna:e.comuna||"",ciudad:e.ciudad||"",telefono:e.telefono||"",email:e.email||"",contacto:e.contacto||"",clasificacion_id:e.clasificacion_id||null})},[e]);const m=C.useCallback((y,b)=>{switch(y){case"rut":return b?rV(b)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return b?b.length<3?"Nombre debe tener al menos 3 caracteres":void 0:"Nombre es requerido";case"email":return b&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b)?"Email invalido":void 0;default:return}},[]),_=C.useCallback(y=>{const{name:b,value:x}=y.target,j=b==="rut"?nV(x):x;if(l(S=>({...S,[b]:b==="clasificacion_id"?x?Number(x):null:j})),h[b]){const S=m(b,j);u(T=>({...T,[b]:S}))}},[h,m]),g=C.useCallback(y=>{const{name:b,value:x}=y.target;f(S=>({...S,[b]:!0}));const j=m(b,x);u(S=>({...S,[b]:j}))},[m]),v=C.useCallback(y=>{y.preventDefault();const b={};if(b.rut=m("rut",o.rut),b.nombre=m("nombre",o.nombre),b.email=m("email",o.email),u(b),f({rut:!0,nombre:!0,email:!0}),Object.values(b).some(j=>j))return;const x={nombre:o.nombre,razon_social:o.razon_social||void 0,giro:o.giro||void 0,direccion:o.direccion||void 0,comuna:o.comuna||void 0,ciudad:o.ciudad||void 0,telefono:o.telefono||void 0,email:o.email||void 0,contacto:o.contacto||void 0,clasificacion_id:o.clasificacion_id||void 0};s||(x.rut=o.rut),r(x)},[o,m,s,r]);return a.jsxs(XU,{children:[a.jsx(YU,{children:s?`Editando Cliente: ${e==null?void 0:e.nombre}`:"Nuevo Cliente"}),a.jsx(QU,{children:a.jsxs("form",{onSubmit:v,children:[a.jsxs(JU,{children:[a.jsxs(zi,{children:[a.jsxs(Ii,{children:["RUT",a.jsx(kE,{children:"*"})]}),a.jsx(ds,{type:"text",name:"rut",value:o.rut,onChange:_,onBlur:g,placeholder:"12.345.678-9",disabled:s,maxLength:12}),c.rut&&h.rut&&a.jsx(Y_,{children:c.rut}),a.jsx(tV,{children:"Formato: 12.345.678-9"})]}),a.jsxs(zi,{children:[a.jsxs(Ii,{children:["Nombre",a.jsx(kE,{children:"*"})]}),a.jsx(ds,{type:"text",name:"nombre",value:o.nombre,onChange:_,onBlur:g,placeholder:"Nombre del cliente",maxLength:255}),c.nombre&&h.nombre&&a.jsx(Y_,{children:c.nombre})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Razon Social"}),a.jsx(ds,{type:"text",name:"razon_social",value:o.razon_social,onChange:_,placeholder:"Razon social",maxLength:255})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Giro"}),a.jsx(ds,{type:"text",name:"giro",value:o.giro,onChange:_,placeholder:"Giro comercial",maxLength:255})]}),a.jsxs(zi,{$fullWidth:!0,children:[a.jsx(Ii,{children:"Direccion"}),a.jsx(ds,{type:"text",name:"direccion",value:o.direccion,onChange:_,placeholder:"Direccion",maxLength:255})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Comuna"}),a.jsx(ds,{type:"text",name:"comuna",value:o.comuna,onChange:_,placeholder:"Comuna",maxLength:100})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Ciudad"}),a.jsx(ds,{type:"text",name:"ciudad",value:o.ciudad,onChange:_,placeholder:"Ciudad",maxLength:100})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Telefono"}),a.jsx(ds,{type:"text",name:"telefono",value:o.telefono,onChange:_,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Email"}),a.jsx(ds,{type:"email",name:"email",value:o.email,onChange:_,onBlur:g,placeholder:"correo@ejemplo.com",maxLength:100}),c.email&&h.email&&a.jsx(Y_,{children:c.email})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Contacto"}),a.jsx(ds,{type:"text",name:"contacto",value:o.contacto,onChange:_,placeholder:"Nombre del contacto",maxLength:255})]}),a.jsxs(zi,{children:[a.jsx(Ii,{children:"Clasificacion"}),a.jsxs(ZU,{name:"clasificacion_id",value:o.clasificacion_id||"",onChange:_,children:[a.jsx("option",{value:"",children:"Sin clasificacion"}),t.map(y=>a.jsx("option",{value:y.id,children:y.descripcion},y.id))]})]})]}),a.jsxs(eV,{children:[a.jsx(SE,{type:"button",onClick:n,disabled:i,children:"Cancelar"}),a.jsx(SE,{type:"submit",$variant:"primary",disabled:i,children:i?"Guardando...":s?"Actualizar":"Crear"})]})]})})]})}const cm=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,dm=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,um=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,hm=p.div`
  display: flex;
  gap: 0.75rem;
`,Jl=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,iV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,sV=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  align-items: end;
`,fm=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,pm=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,oV=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,CE=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,lV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,cV=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,zo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Io=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,dV=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,$E=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Q_=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,uV=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,hV=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,fV=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,pV=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,EE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,mV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,gV=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,J_=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,TE=p.span`
  display: block;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function xV({onNavigate:e}){const[t,r]=C.useState(1),[n,i]=C.useState(""),[s,o]=C.useState(null),[l,c]=C.useState(void 0),[u,h]=C.useState(!1),[f,m]=C.useState(null),[_,g]=C.useState(null),[v,y]=C.useState(null),b={page:t,page_size:20,search:n||void 0,clasificacion_id:s||void 0,activo:l},{data:x,isLoading:j,error:S}=RU(b),{data:T}=NU(),F=zU(),w=IU(),P=LU(),M=BU(),A=C.useCallback(ne=>{ne.preventDefault(),r(1)},[]),D=C.useCallback(()=>{i(""),o(null),c(void 0),r(1)},[]),H=C.useCallback(()=>{m(null),h(!0)},[]),U=C.useCallback(ne=>{m(ne),h(!0)},[]),W=C.useCallback(()=>{h(!1),m(null)},[]),R=C.useCallback(async ne=>{try{f?(await w.mutateAsync({id:f.id,data:ne}),g("Cliente actualizado correctamente")):(await F.mutateAsync(ne),g("Cliente creado correctamente")),h(!1),m(null),y(null),setTimeout(()=>g(null),3e3)}catch(O){y(O.message||"Error al guardar cliente"),g(null)}},[f,F,w]),ae=C.useCallback(async ne=>{try{await P.mutateAsync(ne),g("Cliente activado correctamente"),y(null),setTimeout(()=>g(null),3e3)}catch(O){y(O.message||"Error al activar cliente")}},[P]),le=C.useCallback(async ne=>{if(window.confirm("Est seguro de desactivar este cliente?"))try{await M.mutateAsync(ne),g("Cliente desactivado correctamente"),y(null),setTimeout(()=>g(null),3e3)}catch(O){y(O.message||"Error al desactivar cliente")}},[M]);if(j)return a.jsxs(cm,{children:[a.jsxs(dm,{children:[a.jsx(um,{children:"Mantenedor de Clientes"}),a.jsx(hm,{children:a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(hV,{children:[a.jsx(fV,{}),a.jsx("span",{children:"Cargando clientes..."})]})]});if(S)return a.jsxs(cm,{children:[a.jsxs(dm,{children:[a.jsx(um,{children:"Mantenedor de Clientes"}),a.jsx(hm,{children:a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx(J_,{$type:"error",children:"Error al cargar clientes. Intente nuevamente."})]});const G=(x==null?void 0:x.items)||[],z=(x==null?void 0:x.total_pages)||1,ie=(x==null?void 0:x.total)||0;return u?a.jsxs(cm,{children:[a.jsxs(dm,{children:[a.jsx(um,{children:f?"Editar Cliente":"Nuevo Cliente"}),a.jsx(hm,{children:a.jsx(Jl,{onClick:W,children:" Cancelar"})})]}),a.jsx(aV,{client:f,clasificaciones:T||[],onSubmit:R,onCancel:W,isLoading:F.isPending||w.isPending})]}):a.jsxs(cm,{children:[a.jsxs(dm,{children:[a.jsx(um,{children:"Mantenedor de Clientes"}),a.jsxs(hm,{children:[a.jsx(Jl,{$variant:"primary",onClick:H,children:"+ Nuevo Cliente"}),a.jsx(Jl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),_&&a.jsx(J_,{$type:"success",children:_}),v&&a.jsx(J_,{$type:"error",children:v}),a.jsx(iV,{children:a.jsx("form",{onSubmit:A,children:a.jsxs(sV,{children:[a.jsxs(fm,{children:[a.jsx(pm,{children:"Buscar"}),a.jsx(oV,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:ne=>i(ne.target.value)})]}),a.jsxs(fm,{children:[a.jsx(pm,{children:"Clasificacion"}),a.jsxs(CE,{value:s||"",onChange:ne=>o(ne.target.value?Number(ne.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),T==null?void 0:T.map(ne=>a.jsx("option",{value:ne.id,children:ne.descripcion},ne.id))]})]}),a.jsxs(fm,{children:[a.jsx(pm,{children:"Estado"}),a.jsxs(CE,{value:l===void 0?"":l?"true":"false",onChange:ne=>c(ne.target.value===""?void 0:ne.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(fm,{children:[a.jsx(pm,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Jl,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(Jl,{type:"button",onClick:D,children:"Limpiar"})]})]})]})})}),a.jsxs(gV,{children:["Mostrando ",G.length," de ",ie," clientes"]}),a.jsx(lV,{children:G.length===0?a.jsx(uV,{children:a.jsx("p",{children:"No se encontraron clientes"})}):a.jsxs(a.Fragment,{children:[a.jsxs(cV,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(zo,{children:"ID"}),a.jsx(zo,{children:"RUT"}),a.jsx(zo,{children:"Nombre"}),a.jsx(zo,{children:"Clasificacion"}),a.jsx(zo,{children:"Email"}),a.jsx(zo,{children:"Telefono"}),a.jsx(zo,{children:"Estado"}),a.jsx(zo,{children:"Acciones"})]})}),a.jsx("tbody",{children:G.map(ne=>a.jsxs(dV,{children:[a.jsx(Io,{children:ne.id}),a.jsx(Io,{children:ne.rut}),a.jsx(Io,{children:a.jsx(TE,{title:ne.nombre_sap,children:ne.nombre_sap})}),a.jsx(Io,{children:ne.clasificacion_nombre&&a.jsx($E,{$type:"info",children:ne.clasificacion_nombre})}),a.jsx(Io,{children:a.jsx(TE,{title:ne.email_contacto_1||"",children:ne.email_contacto_1||"-"})}),a.jsx(Io,{children:ne.phone_contacto_1||"-"}),a.jsx(Io,{children:a.jsx($E,{$type:ne.active===1?"active":"inactive",children:ne.active===1?"Activo":"Inactivo"})}),a.jsxs(Io,{children:[a.jsx(Q_,{$variant:"edit",onClick:()=>U(ne),title:"Editar",children:"Editar"}),ne.active===1?a.jsx(Q_,{$variant:"deactivate",onClick:()=>le(ne.id),disabled:M.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(Q_,{$variant:"activate",onClick:()=>ae(ne.id),disabled:P.isPending,title:"Activar",children:"Activar"})]})]},ne.id))})]}),z>1&&a.jsxs(pV,{children:[a.jsx(EE,{disabled:t===1,onClick:()=>r(ne=>ne-1),children:"Anterior"}),a.jsxs(mV,{children:["Pagina ",t," de ",z]}),a.jsx(EE,{disabled:t===z,onClick:()=>r(ne=>ne+1),children:"Siguiente"})]})]})})]})}const vV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,_V=p.div`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.875rem;
`,yV=p.div`
  padding: 1.5rem;
`,bV=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Lo=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;

  ${e=>e.$fullWidth&&`
    grid-column: 1 / -1;
  `}
`,Bo=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,mm=p.span`
  color: ${d.colors.danger};
  margin-left: 0.25rem;
`,Td=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,AE=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,jV=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`,FE=p.button`
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>e.$variant==="primary"?`
    background: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
    &:hover:not(:disabled) { background: #002d66; }
  `:`
    background: white;
    color: ${d.colors.textSecondary};
    border-color: ${d.colors.border};
    &:hover:not(:disabled) {
      border-color: ${d.colors.primary};
      color: ${d.colors.primary};
    }
  `}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Oh=p.span`
  color: ${d.colors.danger};
  font-size: 0.75rem;
  margin-top: 0.25rem;
`,DE=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.7rem;
  margin-top: 0.25rem;
`;function wV(e){if(!e)return!1;const t=e.replace(/[.-]/g,"").toUpperCase();if(t.length<2)return!1;const r=t.slice(-1),n=t.slice(0,-1);if(!/^\d+$/.test(n))return!1;let i=0,s=2;for(let c=n.length-1;c>=0;c--)i+=parseInt(n[c])*s,s=s<7?s+1:2;const o=11-i%11;let l;return o===11?l="0":o===10?l="K":l=o.toString(),r===l}function kV(e){let t=e.replace(/[^0-9kK]/g,"").toUpperCase();if(t.length>9&&(t=t.slice(0,9)),t.length>1){const r=t.slice(-1);return`${t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${r}`}return t}function SV({user:e,roles:t,workSpaces:r,onSubmit:n,onCancel:i,isLoading:s}){const o=!!e,[l,c]=C.useState({rut:(e==null?void 0:e.rut)||"",nombre:(e==null?void 0:e.nombre)||"",apellido:(e==null?void 0:e.apellido)||"",email:(e==null?void 0:e.email)||"",telefono:(e==null?void 0:e.telefono)||"",password:"",role_id:(e==null?void 0:e.role_id)||null,work_space_id:(e==null?void 0:e.work_space_id)||null}),[u,h]=C.useState({}),[f,m]=C.useState({});C.useEffect(()=>{e&&c({rut:e.rut||"",nombre:e.nombre||"",apellido:e.apellido||"",email:e.email||"",telefono:e.telefono||"",password:"",role_id:e.role_id||null,work_space_id:e.work_space_id||null})},[e]);const _=C.useCallback((b,x)=>{switch(b){case"rut":return x?wV(x)?void 0:"RUT invalido":"RUT es requerido";case"nombre":return x?x.length<2?"Nombre debe tener al menos 2 caracteres":void 0:"Nombre es requerido";case"apellido":return x?x.length<2?"Apellido debe tener al menos 2 caracteres":void 0:"Apellido es requerido";case"email":return x&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x)?"Email invalido":void 0;case"password":return!o&&!x?"Contrasea es requerida":x&&x.length<6?"Contrasea debe tener al menos 6 caracteres":void 0;default:return}},[o]),g=C.useCallback(b=>{const{name:x,value:j}=b.target,S=x==="rut"?kV(j):j;if(c(T=>({...T,[x]:["role_id","work_space_id"].includes(x)?j?Number(j):null:S})),f[x]){const T=_(x,S);h(F=>({...F,[x]:T}))}},[f,_]),v=C.useCallback(b=>{const{name:x,value:j}=b.target;m(T=>({...T,[x]:!0}));const S=_(x,j);h(T=>({...T,[x]:S}))},[_]),y=C.useCallback(b=>{b.preventDefault();const x={};if(x.rut=_("rut",l.rut),x.nombre=_("nombre",l.nombre),x.apellido=_("apellido",l.apellido),x.email=_("email",l.email),x.password=_("password",l.password),h(x),m({rut:!0,nombre:!0,apellido:!0,email:!0,password:!0}),!Object.values(x).some(j=>j))if(o){const j={nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password||void 0,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(j)}else{const j={rut:l.rut,nombre:l.nombre,apellido:l.apellido,email:l.email||void 0,telefono:l.telefono||void 0,password:l.password,role_id:l.role_id||void 0,work_space_id:l.work_space_id||void 0};n(j)}},[l,_,o,n]);return a.jsxs(vV,{children:[a.jsx(_V,{children:o?`Editando Usuario: ${e==null?void 0:e.nombre} ${e==null?void 0:e.apellido}`:"Nuevo Usuario"}),a.jsx(yV,{children:a.jsxs("form",{onSubmit:y,children:[a.jsxs(bV,{children:[a.jsxs(Lo,{children:[a.jsxs(Bo,{children:["RUT",a.jsx(mm,{children:"*"})]}),a.jsx(Td,{type:"text",name:"rut",value:l.rut,onChange:g,onBlur:v,placeholder:"12.345.678-9",disabled:o,maxLength:12}),u.rut&&f.rut&&a.jsx(Oh,{children:u.rut}),a.jsx(DE,{children:"Formato: 12.345.678-9"})]}),a.jsxs(Lo,{children:[a.jsxs(Bo,{children:["Nombre",a.jsx(mm,{children:"*"})]}),a.jsx(Td,{type:"text",name:"nombre",value:l.nombre,onChange:g,onBlur:v,placeholder:"Nombre",maxLength:100}),u.nombre&&f.nombre&&a.jsx(Oh,{children:u.nombre})]}),a.jsxs(Lo,{children:[a.jsxs(Bo,{children:["Apellido",a.jsx(mm,{children:"*"})]}),a.jsx(Td,{type:"text",name:"apellido",value:l.apellido,onChange:g,onBlur:v,placeholder:"Apellido",maxLength:100}),u.apellido&&f.apellido&&a.jsx(Oh,{children:u.apellido})]}),a.jsxs(Lo,{children:[a.jsx(Bo,{children:"Email"}),a.jsx(Td,{type:"email",name:"email",value:l.email,onChange:g,onBlur:v,placeholder:"correo@ejemplo.com",maxLength:100}),u.email&&f.email&&a.jsx(Oh,{children:u.email})]}),a.jsxs(Lo,{children:[a.jsx(Bo,{children:"Telefono"}),a.jsx(Td,{type:"text",name:"telefono",value:l.telefono,onChange:g,placeholder:"+56 9 1234 5678",maxLength:20})]}),a.jsxs(Lo,{children:[a.jsxs(Bo,{children:["Contrasea",!o&&a.jsx(mm,{children:"*"})]}),a.jsx(Td,{type:"password",name:"password",value:l.password,onChange:g,onBlur:v,placeholder:o?"Dejar vacio para no cambiar":"Minimo 6 caracteres",maxLength:100}),u.password&&f.password&&a.jsx(Oh,{children:u.password}),o&&a.jsx(DE,{children:"Dejar vacio para mantener contrasea actual"})]}),a.jsxs(Lo,{children:[a.jsx(Bo,{children:"Rol"}),a.jsxs(AE,{name:"role_id",value:l.role_id||"",onChange:g,children:[a.jsx("option",{value:"",children:"Sin rol asignado"}),t.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]}),a.jsxs(Lo,{children:[a.jsx(Bo,{children:"Area de Trabajo"}),a.jsxs(AE,{name:"work_space_id",value:l.work_space_id||"",onChange:g,children:[a.jsx("option",{value:"",children:"Sin area asignada"}),r.map(b=>a.jsx("option",{value:b.id,children:b.nombre},b.id))]})]})]}),a.jsxs(jV,{children:[a.jsx(FE,{type:"button",onClick:i,disabled:s,children:"Cancelar"}),a.jsx(FE,{type:"submit",$variant:"primary",disabled:s,children:s?"Guardando...":o?"Actualizar":"Crear"})]})]})})]})}const gm=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,xm=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,vm=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,_m=p.div`
  display: flex;
  gap: 0.75rem;
`,Zl=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,CV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,$V=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,Rh=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Nh=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,EV=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Z_=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,TV=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,AV=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Uo=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Vo=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,FV=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,ey=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"active":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"inactive":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"role":return`
          background: #6c757d15;
          color: #6c757d;
        `;case"area":return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,ty=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"edit":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"activate":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"deactivate":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,DV=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,PV=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,MV=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,OV=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,PE=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,RV=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,NV=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,zh=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,ME=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function zV({onNavigate:e}){const[t,r]=C.useState(1),[n,i]=C.useState(""),[s,o]=C.useState(null),[l,c]=C.useState(null),[u,h]=C.useState(void 0),[f,m]=C.useState(!1),[_,g]=C.useState(null),[v,y]=C.useState(null),[b,x]=C.useState(null),j={page:t,page_size:20,search:n||void 0,role_id:s||void 0,work_space_id:l||void 0,activo:u},{data:S,isLoading:T,error:F}=UU(j),{data:w}=VU(),{data:P}=HU(),M=WU(),A=GU(),D=qU(),H=KU(),U=C.useCallback(L=>{L.preventDefault(),r(1)},[]),W=C.useCallback(()=>{i(""),o(null),c(null),h(void 0),r(1)},[]),R=C.useCallback(()=>{g(null),m(!0)},[]),ae=C.useCallback(L=>{g(L),m(!0)},[]),le=C.useCallback(()=>{m(!1),g(null)},[]),G=C.useCallback(async L=>{try{_?(await A.mutateAsync({id:_.id,data:L}),y("Usuario actualizado correctamente")):(await M.mutateAsync(L),y("Usuario creado correctamente")),m(!1),g(null),x(null),setTimeout(()=>y(null),3e3)}catch(K){x(K.message||"Error al guardar usuario"),y(null)}},[_,M,A]),z=C.useCallback(async L=>{try{await D.mutateAsync(L),y("Usuario activado correctamente"),x(null),setTimeout(()=>y(null),3e3)}catch(K){x(K.message||"Error al activar usuario")}},[D]),ie=C.useCallback(async L=>{if(window.confirm("Est seguro de desactivar este usuario?"))try{await H.mutateAsync(L),y("Usuario desactivado correctamente"),x(null),setTimeout(()=>y(null),3e3)}catch(K){x(K.message||"Error al desactivar usuario")}},[H]);if(T)return a.jsxs(gm,{children:[a.jsxs(xm,{children:[a.jsx(vm,{children:"Mantenedor de Usuarios"}),a.jsx(_m,{children:a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsxs(PV,{children:[a.jsx(MV,{}),a.jsx("span",{children:"Cargando usuarios..."})]})]});if(F)return a.jsxs(gm,{children:[a.jsxs(xm,{children:[a.jsx(vm,{children:"Mantenedor de Usuarios"}),a.jsx(_m,{children:a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})})]}),a.jsx(zh,{$type:"error",children:"Error al cargar usuarios. Intente nuevamente."})]});const ne=(S==null?void 0:S.items)||[],O=(S==null?void 0:S.total_pages)||1,N=(S==null?void 0:S.total)||0;return f?a.jsxs(gm,{children:[a.jsxs(xm,{children:[a.jsx(vm,{children:_?"Editar Usuario":"Nuevo Usuario"}),a.jsx(_m,{children:a.jsx(Zl,{onClick:le,children:" Cancelar"})})]}),v&&a.jsx(zh,{$type:"success",children:v}),b&&a.jsx(zh,{$type:"error",children:b}),a.jsx(SV,{user:_,roles:w||[],workSpaces:P||[],onSubmit:G,onCancel:le,isLoading:M.isPending||A.isPending})]}):a.jsxs(gm,{children:[a.jsxs(xm,{children:[a.jsx(vm,{children:"Mantenedor de Usuarios"}),a.jsxs(_m,{children:[a.jsx(Zl,{$variant:"primary",onClick:R,children:"+ Nuevo Usuario"}),a.jsx(Zl,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"})]})]}),v&&a.jsx(zh,{$type:"success",children:v}),b&&a.jsx(zh,{$type:"error",children:b}),a.jsx(CV,{children:a.jsx("form",{onSubmit:U,children:a.jsxs($V,{children:[a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Buscar"}),a.jsx(EV,{type:"text",placeholder:"RUT, nombre, email...",value:n,onChange:L=>i(L.target.value)})]}),a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Rol"}),a.jsxs(Z_,{value:s||"",onChange:L=>o(L.target.value?Number(L.target.value):null),children:[a.jsx("option",{value:"",children:"Todos"}),w==null?void 0:w.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))]})]}),a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Area"}),a.jsxs(Z_,{value:l||"",onChange:L=>c(L.target.value?Number(L.target.value):null),children:[a.jsx("option",{value:"",children:"Todas"}),P==null?void 0:P.map(L=>a.jsx("option",{value:L.id,children:L.nombre},L.id))]})]}),a.jsxs(Rh,{children:[a.jsx(Nh,{children:"Estado"}),a.jsxs(Z_,{value:u===void 0?"":u?"true":"false",onChange:L=>h(L.target.value===""?void 0:L.target.value==="true"),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"true",children:"Activos"}),a.jsx("option",{value:"false",children:"Inactivos"})]})]}),a.jsxs(Rh,{children:[a.jsx(Nh,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Zl,{type:"submit",$variant:"primary",children:"Buscar"}),a.jsx(Zl,{type:"button",onClick:W,children:"Limpiar"})]})]})]})})}),a.jsxs(NV,{children:["Mostrando ",ne.length," de ",N," usuarios"]}),a.jsx(TV,{children:ne.length===0?a.jsx(DV,{children:a.jsx("p",{children:"No se encontraron usuarios"})}):a.jsxs(a.Fragment,{children:[a.jsxs(AV,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Uo,{children:"ID"}),a.jsx(Uo,{children:"RUT"}),a.jsx(Uo,{children:"Nombre"}),a.jsx(Uo,{children:"Email"}),a.jsx(Uo,{children:"Rol"}),a.jsx(Uo,{children:"Area"}),a.jsx(Uo,{children:"Estado"}),a.jsx(Uo,{children:"Acciones"})]})}),a.jsx("tbody",{children:ne.map(L=>a.jsxs(FV,{children:[a.jsx(Vo,{children:L.id}),a.jsx(Vo,{children:L.rut}),a.jsx(Vo,{children:a.jsxs(ME,{title:`${L.nombre} ${L.apellido}`,children:[L.nombre," ",L.apellido]})}),a.jsx(Vo,{children:a.jsx(ME,{title:L.email||"",children:L.email||"-"})}),a.jsx(Vo,{children:L.role_nombre&&a.jsx(ey,{$type:"role",children:L.role_nombre})}),a.jsx(Vo,{children:L.work_space_nombre&&a.jsx(ey,{$type:"area",children:L.work_space_nombre})}),a.jsx(Vo,{children:a.jsx(ey,{$type:L.activo?"active":"inactive",children:L.activo?"Activo":"Inactivo"})}),a.jsxs(Vo,{children:[a.jsx(ty,{$variant:"edit",onClick:()=>ae(L),title:"Editar",children:"Editar"}),L.activo?a.jsx(ty,{$variant:"deactivate",onClick:()=>ie(L.id),disabled:H.isPending,title:"Desactivar",children:"Desactivar"}):a.jsx(ty,{$variant:"activate",onClick:()=>z(L.id),disabled:D.isPending,title:"Activar",children:"Activar"})]})]},L.id))})]}),O>1&&a.jsxs(OV,{children:[a.jsx(PE,{disabled:t===1,onClick:()=>r(L=>L-1),children:"Anterior"}),a.jsxs(RV,{children:["Pagina ",t," de ",O]}),a.jsx(PE,{disabled:t===O,onClick:()=>r(L=>L+1),children:"Siguiente"})]})]})})]})}const IV=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,LV=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,BV=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,Ad=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,UV=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,VV=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,HV=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,WV=p.table`
  width: 100%;
  border-collapse: collapse;
`,Ih=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Lh=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,GV=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,qV=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,KV=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,ry=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,XV=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,OE=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,RE=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,YV=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,QV=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,JV=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,ZV=p.div`
  margin-bottom: ${d.spacing.md};
`,eH=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,tH=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,rH=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,nH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,aH=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function We({tablaKey:e}){const[t,r]=C.useState([]),[n,i]=C.useState(null),[s,o]=C.useState(!0),[l,c]=C.useState(1),[u,h]=C.useState(1),[f,m]=C.useState(0),[_,g]=C.useState(""),[v,y]=C.useState(""),[b,x]=C.useState(!1),[j,S]=C.useState(null),[T,F]=C.useState({}),[w,P]=C.useState(null),[M,A]=C.useState(null),[D,H]=C.useState(!1);C.useEffect(()=>{(async()=>{try{const L=(await to.getTablas()).find(K=>K.key===e);L&&i(L)}catch(N){console.error("Error loading tabla info:",N)}})()},[e]);const U=C.useCallback(async()=>{o(!0);try{const O=await to.list(e,{page:l,page_size:20,search:_||void 0,activo:v?parseInt(v):void 0});r(O.items),h(O.total_pages),m(O.total)}catch(O){console.error("Error loading data:",O),A("Error al cargar los datos")}finally{o(!1)}},[e,l,_,v]);C.useEffect(()=>{U()},[U]);const W=()=>{c(1),U()},R=()=>{S(null),F({}),x(!0)},ae=async O=>{try{const N=await to.get(e,O.id);S(O);const L={};Object.entries(N.data).forEach(([K,re])=>{K!=="id"&&K!=="created_at"&&K!=="updated_at"&&(L[K]=(re==null?void 0:re.toString())||"")}),F(L),x(!0)}catch(N){console.error("Error loading item:",N),A("Error al cargar el item")}},le=()=>{x(!1),S(null),F({})},G=async()=>{H(!0),A(null);try{const O={};Object.entries(T).forEach(([N,L])=>{L!==""&&(O[N]=L)}),j?(await to.update(e,j.id,O),P("Item actualizado exitosamente")):(await to.create(e,O),P("Item creado exitosamente")),le(),U()}catch(O){console.error("Error saving:",O),A("Error al guardar")}finally{H(!1)}},z=async O=>{try{await to.activate(e,O),P("Item activado"),U()}catch(N){console.error("Error activating:",N),A("Error al activar")}},ie=async O=>{try{await to.deactivate(e,O),P("Item desactivado"),U()}catch(N){console.error("Error deactivating:",N),A("Error al desactivar")}};C.useEffect(()=>{if(w||M){const O=setTimeout(()=>{P(null),A(null)},3e3);return()=>clearTimeout(O)}},[w,M]);const ne=()=>n?n.columns.filter(O=>O!=="id"&&O!=="active"&&O!=="created_at"&&O!=="updated_at"):[];return a.jsxs(IV,{children:[a.jsxs(LV,{children:[a.jsx(BV,{children:(n==null?void 0:n.display_name)||e}),a.jsx(Ad,{onClick:R,children:"+ Nuevo"})]}),w&&a.jsx(RE,{$type:"success",children:w}),M&&a.jsx(RE,{$type:"error",children:M}),a.jsxs(UV,{children:[a.jsx(VV,{type:"text",placeholder:"Buscar...",value:_,onChange:O=>g(O.target.value),onKeyDown:O=>O.key==="Enter"&&W()}),(n==null?void 0:n.has_active)&&a.jsxs(HV,{value:v,onChange:O=>{y(O.target.value),c(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(Ad,{onClick:W,children:"Filtrar"})]}),a.jsxs(OE,{children:["Mostrando ",t.length," de ",f," registros"]}),s?a.jsx(nH,{children:"Cargando..."}):t.length===0?a.jsx(aH,{children:"No hay registros"}):a.jsxs(WV,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ih,{children:"ID"}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx(Ih,{children:"Cdigo"}),a.jsx(Ih,{children:"Nombre"}),(n==null?void 0:n.has_active)&&a.jsx(Ih,{children:"Estado"}),a.jsx(Ih,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(O=>a.jsxs(GV,{children:[a.jsx(Lh,{children:O.id}),(n==null?void 0:n.columns.includes("codigo"))&&a.jsx(Lh,{children:O.codigo||"-"}),a.jsx(Lh,{children:O.nombre}),(n==null?void 0:n.has_active)&&a.jsx(Lh,{children:a.jsx(qV,{$active:O.active===1,children:O.active===1?"Activo":"Inactivo"})}),a.jsx(Lh,{children:a.jsxs(KV,{children:[a.jsx(ry,{onClick:()=>ae(O),title:"Editar",children:""}),(n==null?void 0:n.has_active)&&(O.active===1?a.jsx(ry,{$color:d.colors.danger,onClick:()=>ie(O.id),title:"Desactivar",children:""}):a.jsx(ry,{$color:d.colors.success,onClick:()=>z(O.id),title:"Activar",children:""}))]})})]},O.id))})]}),u>1&&a.jsxs(XV,{children:[a.jsx(Ad,{$variant:"secondary",onClick:()=>c(O=>Math.max(1,O-1)),disabled:l===1,children:"Anterior"}),a.jsxs(OE,{children:["Pgina ",l," de ",u]}),a.jsx(Ad,{$variant:"secondary",onClick:()=>c(O=>Math.min(u,O+1)),disabled:l===u,children:"Siguiente"})]}),b&&a.jsx(YV,{onClick:le,children:a.jsxs(QV,{onClick:O=>O.stopPropagation(),children:[a.jsxs(JV,{children:[j?"Editar":"Crear"," ",n==null?void 0:n.display_name]}),ne().map(O=>a.jsxs(ZV,{children:[a.jsx(eH,{children:O.charAt(0).toUpperCase()+O.slice(1).replace(/_/g," ")}),a.jsx(tH,{type:"text",value:T[O]||"",onChange:N=>F(L=>({...L,[O]:N.target.value}))})]},O)),a.jsxs(rH,{children:[a.jsx(Ad,{$variant:"secondary",onClick:le,children:"Cancelar"}),a.jsx(Ad,{onClick:G,disabled:D,children:D?"Guardando...":"Guardar"})]})]})})]})}const iH=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,sH=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,oH=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,lH=p.div`
  display: flex;
  gap: ${d.spacing.xs};
  margin-bottom: ${d.spacing.lg};
  border-bottom: 2px solid ${d.colors.border};
`,ny=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  border-radius: ${d.radius.md} ${d.radius.md} 0 0;
  transition: all 0.2s;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
  }
`,Fd=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,cH=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
`,dH=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  min-width: 200px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,NE=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  cursor: pointer;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,uH=p.table`
  width: 100%;
  border-collapse: collapse;
`,ec=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,tn=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.body};
`,ay=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,iy=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${({$active:e})=>e?`${d.colors.success}20`:`${d.colors.danger}20`};
  color: ${({$active:e})=>e?d.colors.success:d.colors.danger};
`,zE=p.span`
  padding: 2px 8px;
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.small};
  background: ${d.colors.primary}20;
  color: ${d.colors.primary};
`,sy=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,Us=p.button`
  padding: ${d.spacing.xs};
  border: none;
  background: transparent;
  cursor: pointer;
  color: ${({$color:e})=>e||d.colors.textSecondary};
  font-size: 16px;

  &:hover {
    color: ${d.colors.primary};
  }
`,hH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,IE=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,LE=p.div`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`,fH=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,pH=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  min-width: 400px;
  max-width: 500px;
`,mH=p.h3`
  margin: 0 0 ${d.spacing.lg};
  color: ${d.colors.textPrimary};
`,oy=p.div`
  margin-bottom: ${d.spacing.md};
`,ly=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,BE=p.input`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,gH=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  box-sizing: border-box;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,xH=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,vH=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,_H=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function cy({nivel:e}){const[t,r]=C.useState(e),[n,i]=C.useState(!0),[s,o]=C.useState(1),[l,c]=C.useState(1),[u,h]=C.useState(0),[f,m]=C.useState(""),[_,g]=C.useState(""),[v,y]=C.useState(""),[b,x]=C.useState(!1),[j,S]=C.useState(null),[T,F]=C.useState(null),[w,P]=C.useState(null),[M,A]=C.useState(!1),[D,H]=C.useState([]),[U,W]=C.useState([]),[R,ae]=C.useState([]),[le,G]=C.useState([]),[z,ie]=C.useState([]),[ne,O]=C.useState(""),[N,L]=C.useState(""),[K,re]=C.useState("");C.useEffect(()=>{(async()=>{try{if(t>=2){const _e=await wr.getNivel2Parents();G(_e)}if(t===3){const _e=await wr.getNivel3Parents();ie(_e)}}catch(_e){console.error("Error loading parents:",_e)}})()},[t]);const Z=C.useCallback(async()=>{i(!0);try{const E={page:s,page_size:20,search:f||void 0,activo:_?parseInt(_):void 0,hierarchy_id:v&&t>=2?parseInt(v):void 0,subhierarchy_id:v&&t===3?parseInt(v):void 0};if(t===1){const _e=await wr.listNivel1(E);H(_e.items),c(_e.total_pages),h(_e.total)}else if(t===2){const _e=await wr.listNivel2(E);W(_e.items),c(_e.total_pages),h(_e.total)}else{const _e=await wr.listNivel3(E);ae(_e.items),c(_e.total_pages),h(_e.total)}}catch(E){console.error("Error loading data:",E),P("Error al cargar los datos")}finally{i(!1)}},[t,s,f,_,v]);C.useEffect(()=>{Z()},[Z]),C.useEffect(()=>{o(1),m(""),g(""),y("")},[t]);const me=()=>{o(1),Z()},B=()=>{S(null),O(""),L(""),re(""),x(!0)},se=async E=>{try{if(t===1){const _e=await wr.getNivel1(E);O(_e.descripcion)}else if(t===2){const _e=await wr.getNivel2(E);O(_e.descripcion),re(_e.hierarchy_id.toString())}else{const _e=await wr.getNivel3(E);O(_e.descripcion),L(_e.jerarquia_sap||""),re(_e.subhierarchy_id.toString())}S(E),x(!0)}catch(_e){console.error("Error loading item:",_e),P("Error al cargar el item")}},we=()=>{x(!1),S(null)},V=async()=>{if(!ne.trim()){P("La descripcin es requerida");return}A(!0),P(null);try{if(t===1)j?await wr.updateNivel1(j,{descripcion:ne}):await wr.createNivel1({descripcion:ne});else if(t===2){if(!K){P("Debe seleccionar una Jerarqua 1"),A(!1);return}j?await wr.updateNivel2(j,{descripcion:ne,hierarchy_id:parseInt(K)}):await wr.createNivel2({descripcion:ne,hierarchy_id:parseInt(K)})}else{if(!K){P("Debe seleccionar una Jerarqua 2"),A(!1);return}j?await wr.updateNivel3(j,{descripcion:ne,jerarquia_sap:N||void 0,subhierarchy_id:parseInt(K)}):await wr.createNivel3({descripcion:ne,jerarquia_sap:N||void 0,subhierarchy_id:parseInt(K)})}F(j?"Actualizado exitosamente":"Creado exitosamente"),we(),Z()}catch(E){console.error("Error saving:",E),P("Error al guardar")}finally{A(!1)}},Ce=async E=>{try{t===1?await wr.activateNivel1(E):t===2?await wr.activateNivel2(E):await wr.activateNivel3(E),F("Activado"),Z()}catch(_e){console.error("Error activating:",_e),P("Error al activar")}},qe=async E=>{try{t===1?await wr.deactivateNivel1(E):t===2?await wr.deactivateNivel2(E):await wr.deactivateNivel3(E),F("Desactivado"),Z()}catch(_e){console.error("Error deactivating:",_e),P("Error al desactivar")}};C.useEffect(()=>{if(T||w){const E=setTimeout(()=>{F(null),P(null)},3e3);return()=>clearTimeout(E)}},[T,w]);const Te=()=>{switch(t){case 1:return"Jerarquas Nivel 1";case 2:return"Jerarquas Nivel 2";case 3:return"Jerarquas Nivel 3"}};return a.jsxs(iH,{children:[a.jsxs(sH,{children:[a.jsx(oH,{children:Te()}),a.jsx(Fd,{onClick:B,children:"+ Nueva Jerarqua"})]}),a.jsxs(lH,{children:[a.jsx(ny,{$active:t===1,onClick:()=>r(1),children:"Nivel 1"}),a.jsx(ny,{$active:t===2,onClick:()=>r(2),children:"Nivel 2"}),a.jsx(ny,{$active:t===3,onClick:()=>r(3),children:"Nivel 3"})]}),T&&a.jsx(LE,{$type:"success",children:T}),w&&a.jsx(LE,{$type:"error",children:w}),a.jsxs(cH,{children:[a.jsx(dH,{type:"text",placeholder:"Buscar...",value:f,onChange:E=>m(E.target.value),onKeyDown:E=>E.key==="Enter"&&me()}),t>=2&&a.jsxs(NE,{value:v,onChange:E=>{y(E.target.value),o(1)},children:[a.jsxs("option",{value:"",children:["Todas las Jerarquas ",t===2?"1":"2"]}),(t===2?le:z).map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]}),a.jsxs(NE,{value:_,onChange:E=>{g(E.target.value),o(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Activos"}),a.jsx("option",{value:"0",children:"Inactivos"})]}),a.jsx(Fd,{onClick:me,children:"Filtrar"})]}),a.jsxs(IE,{children:["Mostrando ",t===1?D.length:t===2?U.length:R.length," de ",u," registros"]}),n?a.jsx(vH,{children:"Cargando..."}):(t===1?D.length:t===2?U.length:R.length)===0?a.jsx(_H,{children:"No hay registros"}):a.jsxs(uH,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ec,{children:"ID"}),a.jsx(ec,{children:"Descripcin"}),t===3&&a.jsx(ec,{children:"SAP"}),t>=2&&a.jsx(ec,{children:"Padre"}),t<3&&a.jsx(ec,{children:"Hijos"}),a.jsx(ec,{children:"Estado"}),a.jsx(ec,{children:"Acciones"})]})}),a.jsxs("tbody",{children:[t===1&&D.map(E=>a.jsxs(ay,{children:[a.jsx(tn,{children:E.id}),a.jsx(tn,{children:E.descripcion}),a.jsx(tn,{children:a.jsx(zE,{children:E.count_children})}),a.jsx(tn,{children:a.jsx(iy,{$active:E.active===1,children:E.active===1?"Activo":"Inactivo"})}),a.jsx(tn,{children:a.jsxs(sy,{children:[a.jsx(Us,{onClick:()=>se(E.id),title:"Editar",children:""}),E.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>qe(E.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ce(E.id),title:"Activar",children:""})]})})]},E.id)),t===2&&U.map(E=>a.jsxs(ay,{children:[a.jsx(tn,{children:E.id}),a.jsx(tn,{children:E.descripcion}),a.jsx(tn,{children:E.hierarchy_nombre}),a.jsx(tn,{children:a.jsx(zE,{children:E.count_children})}),a.jsx(tn,{children:a.jsx(iy,{$active:E.active===1,children:E.active===1?"Activo":"Inactivo"})}),a.jsx(tn,{children:a.jsxs(sy,{children:[a.jsx(Us,{onClick:()=>se(E.id),title:"Editar",children:""}),E.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>qe(E.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ce(E.id),title:"Activar",children:""})]})})]},E.id)),t===3&&R.map(E=>a.jsxs(ay,{children:[a.jsx(tn,{children:E.id}),a.jsx(tn,{children:E.descripcion}),a.jsx(tn,{children:E.jerarquia_sap||"-"}),a.jsx(tn,{children:E.subhierarchy_nombre}),a.jsx(tn,{children:a.jsx(iy,{$active:E.active===1,children:E.active===1?"Activo":"Inactivo"})}),a.jsx(tn,{children:a.jsxs(sy,{children:[a.jsx(Us,{onClick:()=>se(E.id),title:"Editar",children:""}),E.active===1?a.jsx(Us,{$color:d.colors.danger,onClick:()=>qe(E.id),title:"Desactivar",children:""}):a.jsx(Us,{$color:d.colors.success,onClick:()=>Ce(E.id),title:"Activar",children:""})]})})]},E.id))]})]}),l>1&&a.jsxs(hH,{children:[a.jsx(Fd,{$variant:"secondary",onClick:()=>o(E=>Math.max(1,E-1)),disabled:s===1,children:"Anterior"}),a.jsxs(IE,{children:["Pgina ",s," de ",l]}),a.jsx(Fd,{$variant:"secondary",onClick:()=>o(E=>Math.min(l,E+1)),disabled:s===l,children:"Siguiente"})]}),b&&a.jsx(fH,{onClick:we,children:a.jsxs(pH,{onClick:E=>E.stopPropagation(),children:[a.jsxs(mH,{children:[j?"Editar":"Crear"," Jerarqua Nivel ",t]}),a.jsxs(oy,{children:[a.jsx(ly,{children:"Descripcin *"}),a.jsx(BE,{type:"text",value:ne,onChange:E=>O(E.target.value),placeholder:"Ingrese descripcin"})]}),t>=2&&a.jsxs(oy,{children:[a.jsxs(ly,{children:["Jerarqua ",t===2?"1":"2"," (Padre) *"]}),a.jsxs(gH,{value:K,onChange:E=>re(E.target.value),children:[a.jsx("option",{value:"",children:"Seleccione..."}),(t===2?le:z).map(E=>a.jsx("option",{value:E.id,children:E.nombre},E.id))]})]}),t===3&&a.jsxs(oy,{children:[a.jsx(ly,{children:"Cdigo SAP"}),a.jsx(BE,{type:"text",value:N,onChange:E=>L(E.target.value),placeholder:"Cdigo SAP (opcional)"})]}),a.jsxs(xH,{children:[a.jsx(Fd,{$variant:"secondary",onClick:we,children:"Cancelar"}),a.jsx(Fd,{onClick:V,disabled:M,children:M?"Guardando...":"Guardar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var o1={};o1.version="0.18.5";var UP=1252,yH=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_k={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yk=function(e){yH.indexOf(e)!=-1&&(UP=_k[0]=e)};function bH(){yk(1252)}var Ki=function(e){yk(e)};function bk(){Ki(1200),bH()}function UE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function jH(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var zf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?jH(e.slice(2)):t==254&&r==255?VP(e.slice(2)):t==65279?e.slice(1):e},ym=function(t){return String.fromCharCode(t)},VE=function(t){return String.fromCharCode(t)},D0,_l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function P0(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=_l.charAt(s)+_l.charAt(o)+_l.charAt(l)+_l.charAt(c);return t}function Ua(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=_l.indexOf(e.charAt(u++)),o=_l.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=_l.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=_l.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var dt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Co=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Nl(e){return dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function HE(e){return dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ra=function(t){return dt?Co(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function rv(e){if(typeof ArrayBuffer>"u")return Ra(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Wl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function wH(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function jk(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return jk(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Yr=dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Co(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function kH(e){for(var t=[],r=0,n=e.length+250,i=Nl(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Nl(65535),n=65530)}return t.push(i.slice(0,r)),Yr(t)}var Qn=/\u0000/g,If=/[\u0001-\u0006]/g;function mu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xi(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function wk(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function l1(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function SH(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function CH(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var WE=Math.pow(2,32);function Dd(e,t){if(e>WE||e<-WE)return SH(e,t);var r=Math.round(e);return CH(r,t)}function c1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var GE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dy=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $H(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},qE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},EH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function d1(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,h=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,h=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=h;if(h>t&&(u>t?(h=c,l=s):(h=u,l=o)),!r)return[0,n*l,h];var m=Math.floor(n*l/h);return[m,n*l-m*h,h]}function Fc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=MH(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var HP=new Date(1899,11,31,0,0,0),TH=HP.getTime(),AH=new Date(1900,2,1,0,0,0);function WP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=AH&&(r+=24*60*60*1e3),(r-(TH+(e.getTimezoneOffset()-HP.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function kk(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function DH(e){var t=e<0?12:11,r=kk(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function PH(e){var t=kk(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function M0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=DH(e):t===10?r=e.toFixed(10).substr(0,12):r=PH(e),kk(FH(r.toUpperCase()))}function sd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):M0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ei(14,WP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function MH(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function OH(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return dy[r.m-1][1];case 5:return dy[r.m-1][0];default:return dy[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return GE[r.q][0];default:return GE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xi(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Xi(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var h=u>0?Xi(c,u):"";return h}function yl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var GP=/%/g;function RH(e,t,r){var n=t.replace(GP,""),i=t.length-n.length;return go(e,n,r*Math.pow(10,2*i))+ur("%",i)}function NH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return go(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var KP=/# (\?+)( ?)\/( ?)(\d+)/;function zH(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?ur(" ",e[1].length+1+e[4].length):wk(o,e[1].length)+e[2]+"/"+e[3]+Xi(l,e[4].length))}function IH(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var XP=/^#*0*\.([0#]+)/,YP=/\).*[0#]/,QP=/\(###\) ###\\?-####/;function qn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function KE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function XE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function LH(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function BH(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ui(e,t,r){if(e.charCodeAt(0)===40&&!t.match(YP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ui("n",n,r):"("+ui("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return NH(e,t,r);if(t.indexOf("%")!==-1)return RH(e,t,r);if(t.indexOf("E")!==-1)return qP(t,r);if(t.charCodeAt(0)===36)return"$"+ui(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Dd(c,t.length);if(t.match(/^[#?]+$/))return i=Dd(r,0),i==="0"&&(i=""),i.length>t.length?i:qn(t.substr(0,t.length-i.length))+i;if(s=t.match(KP))return zH(s,c,u);if(t.match(/^#+0+$/))return u+Dd(c,t.length-t.indexOf("0"));if(s=t.match(XP))return i=KE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+qn(s[1])).replace(/\.$/,"."+qn(s[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+ur("0",qn(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+KE(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+yl(Dd(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ui(e,t,-r):yl(""+(Math.floor(r)+LH(r,s[1].length)))+"."+Xi(XE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ui(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(ui(e,t.replace(/[\\-]/g,""),r)),o=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(QP))return i=ui(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=d1(c,Math.pow(10,o)-1,!1),i=""+u,h=go("n",s[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=l1(l[2],o),h.length<s[4].length&&(h=qn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=d1(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?wk(l[1],o)+s[2]+"/"+s[3]+l1(l[2],o):ur(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Dd(r,0),t.length<=i.length?i:qn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,m=t.length-i.length-f;return qn(t.substr(0,f)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=XE(r,s[1].length),r<0?"-"+ui(e,t,-r):yl(BH(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xi(0,3-g.length):"")+g})+"."+Xi(o,s[1].length);switch(t){case"###,##0.00":return ui(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=yl(Dd(c,0));return _!=="0"?u+_:"";case"###,###.00":return ui(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ui(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function UH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return go(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function VH(e,t,r){var n=t.replace(GP,""),i=t.length-n.length;return go(e,n,r*Math.pow(10,2*i))+ur("%",i)}function JP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+JP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,h){return c+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function xs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(YP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xs("n",n,r):"("+xs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UH(e,t,r);if(t.indexOf("%")!==-1)return VH(e,t,r);if(t.indexOf("E")!==-1)return JP(t,r);if(t.charCodeAt(0)===36)return"$"+xs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Xi(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:qn(t.substr(0,t.length-i.length))+i;if(s=t.match(KP))return IH(s,c,u);if(t.match(/^#+0+$/))return u+Xi(c,t.length-t.indexOf("0"));if(s=t.match(XP))return i=(""+r).replace(/^([^\.]+)$/,"$1."+qn(s[1])).replace(/\.$/,"."+qn(s[1])),i=i.replace(/\.(\d*)$/,function(g,v){return"."+v+ur("0",qn(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+yl(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xs(e,t,-r):yl(""+r)+"."+ur("0",s[1].length);if(s=t.match(/^#,#*,#0/))return xs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(xs(e,t.replace(/[\\-]/g,""),r)),o=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(QP))return i=xs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=d1(c,Math.pow(10,o)-1,!1),i=""+u,h=go("n",s[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=l1(l[2],o),h.length<s[4].length&&(h=qn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=d1(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?wk(l[1],o)+s[2]+"/"+s[3]+l1(l[2],o):ur(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:qn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,m=t.length-i.length-f;return qn(t.substr(0,f)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+xs(e,t,-r):yl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Xi(0,3-g.length):"")+g})+"."+Xi(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=yl(""+c);return _!=="0"?u+_:"";default:if(t.match(/\.[0#?]*$/))return xs(e,t.slice(0,t.lastIndexOf(".")),r)+qn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function go(e,t,r){return(r|0)===r?xs(e,t,r):ui(e,t,r)}function HH(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ZP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ih(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":c1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ZP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function WH(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,h,f,m="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!c1(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var _=e.charAt(++o),g=_==="("||_===")"?_:"t";i[i.length]={t:g,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Fc(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Fc(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var v={t:l,v:l};if(u==null&&(u=Fc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",o+=5,m="h"):(v.t="t",++o),u==null&&v.t==="T")return"";i[i.length]=v,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ZP)){if(u==null&&(u=Fc(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ih(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,b=0,x;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,c="h",y<1&&(y=1);break;case"s":(x=i[o].v.match(/\.0+$/))&&(b=Math.max(b,x[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var j="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=OH(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((l=i[S].t)==="?"||l==="D"||(l===" "||l==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;j+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=sd(t,r);break}var T="",F,w;if(j.length>0){j.charCodeAt(0)==40?(F=t<0&&j.charCodeAt(0)===45?-t:t,w=go("n",j,F)):(F=t<0&&n>1?-t:t,w=go("n",j,F),F<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),S=w.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var M=i.length;if(P===i.length&&w.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=w.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=w.substr(0,S+1),S=-1),i[o].t="t",M=o);S>=0&&M<i.length&&(i[M].v=w.substr(0,S+1)+i[M].v)}else if(P!==i.length&&w.indexOf("E")===-1){for(S=w.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,T=i[o].v.substr(h+1);h>=0;--h)S>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(T=w.charAt(S--)+T);i[o].v=T,i[o].t="t",M=o}for(S>=0&&M<i.length&&(i[M].v=w.substr(0,S+1)+i[M].v),S=w.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(h=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,T=i[o].v.substr(0,h);h<i[o].v.length;++h)S<w.length&&(T+=w.charAt(S++));i[o].v=T,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(F=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=go(i[o].t,i[o].v,F),i[o].t="t");var A="";for(o=0;o!==i.length;++o)i[o]!=null&&(A+=i[o].v);return A}var YE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function QE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function GH(e,t){var r=HH(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(YE),l=r[1].match(YE);return QE(t,o)?[n,r[0]]:QE(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Ei(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ke)[e],n==null&&(n=r.table&&r.table[qE[e]]||Ke[qE[e]]),n==null&&(n=EH[e]||"General");break}if(c1(n,0))return sd(t,r);t instanceof Date&&(t=WP(t,r.date1904));var i=GH(n,t);if(c1(i[1]))return sd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return WH(i[1],t,r,i[0])}function xo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ke[r]==null){t<0&&(t=r);continue}if(Ke[r]==e){t=r;break}}t<0&&(t=391)}return Ke[t]=e,t}function nv(e){for(var t=0;t!=392;++t)e[t]!==void 0&&xo(e[t],t)}function sh(){Ke=$H()}var qH={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},e8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function KH(e){var t=typeof e=="number"?Ke[e]:e;return t=t.replace(e8,"(\\d+)"),new RegExp("^"+t+"$")}function XH(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(e8)||[]).forEach(function(f,m){var _=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=_;break;case"d":s=_;break;case"h":o=_;break;case"s":c=_;break;case"m":o>=0?l=_:i=_;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?h:u+"T"+h}var YH=function(){var e={};e.version="1.2.0";function t(){for(var w=0,P=new Array(256),M=0;M!=256;++M)w=M,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,P[M]=w;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(w){var P=0,M=0,A=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(A=0;A!=256;++A)D[A]=w[A];for(A=0;A!=256;++A)for(M=w[A],P=256+A;P<4096;P+=256)M=D[P]=M>>>8^w[M&255];var H=[];for(A=1;A!=16;++A)H[A-1]=typeof Int32Array<"u"?D.subarray(A*256,A*256+256):D.slice(A*256,A*256+256);return H}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],h=i[5],f=i[6],m=i[7],_=i[8],g=i[9],v=i[10],y=i[11],b=i[12],x=i[13],j=i[14];function S(w,P){for(var M=P^-1,A=0,D=w.length;A<D;)M=M>>>8^r[(M^w.charCodeAt(A++))&255];return~M}function T(w,P){for(var M=P^-1,A=w.length-15,D=0;D<A;)M=j[w[D++]^M&255]^x[w[D++]^M>>8&255]^b[w[D++]^M>>16&255]^y[w[D++]^M>>>24]^v[w[D++]]^g[w[D++]]^_[w[D++]]^m[w[D++]]^f[w[D++]]^h[w[D++]]^u[w[D++]]^c[w[D++]]^l[w[D++]]^o[w[D++]]^s[w[D++]]^r[w[D++]];for(A+=15;D<A;)M=M>>>8^r[(M^w[D++])&255];return~M}function F(w,P){for(var M=P^-1,A=0,D=w.length,H=0,U=0;A<D;)H=w.charCodeAt(A++),H<128?M=M>>>8^r[(M^H)&255]:H<2048?(M=M>>>8^r[(M^(192|H>>6&31))&255],M=M>>>8^r[(M^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,U=w.charCodeAt(A++)&1023,M=M>>>8^r[(M^(240|H>>8&7))&255],M=M>>>8^r[(M^(128|H>>2&63))&255],M=M>>>8^r[(M^(128|U>>6&15|(H&3)<<4))&255],M=M>>>8^r[(M^(128|U&63))&255]):(M=M>>>8^r[(M^(224|H>>12&15))&255],M=M>>>8^r[(M^(128|H>>6&63))&255],M=M>>>8^r[(M^(128|H&63))&255]);return~M}return e.table=r,e.bstr=S,e.buf=T,e.str=F,e}(),Ge=function(){var t={};t.version="1.2.1";function r(I,Y){for(var q=I.split("/"),X=Y.split("/"),Q=0,J=0,ce=Math.min(q.length,X.length);Q<ce;++Q){if(J=q[Q].length-X[Q].length)return J;if(q[Q]!=X[Q])return q[Q]<X[Q]?-1:1}return q.length-X.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var Y=I.lastIndexOf("/");return Y===-1?I:I.slice(0,Y+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var Y=I.lastIndexOf("/");return Y===-1?I:I.slice(Y+1)}function s(I,Y){typeof Y=="string"&&(Y=new Date(Y));var q=Y.getHours();q=q<<6|Y.getMinutes(),q=q<<5|Y.getSeconds()>>>1,I.write_shift(2,q);var X=Y.getFullYear()-1980;X=X<<4|Y.getMonth()+1,X=X<<5|Y.getDate(),I.write_shift(2,X)}function o(I){var Y=I.read_shift(2)&65535,q=I.read_shift(2)&65535,X=new Date,Q=q&31;q>>>=5;var J=q&15;q>>>=4,X.setMilliseconds(0),X.setFullYear(q+1980),X.setMonth(J-1),X.setDate(Q);var ce=Y&31;Y>>>=5;var ve=Y&63;return Y>>>=6,X.setHours(Y),X.setMinutes(ve),X.setSeconds(ce<<1),X}function l(I){ln(I,0);for(var Y={},q=0;I.l<=I.length-4;){var X=I.read_shift(2),Q=I.read_shift(2),J=I.l+Q,ce={};switch(X){case 21589:q=I.read_shift(1),q&1&&(ce.mtime=I.read_shift(4)),Q>5&&(q&2&&(ce.atime=I.read_shift(4)),q&4&&(ce.ctime=I.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}I.l=J,Y[X]=ce}return Y}var c;function u(){return c||(c={})}function h(I,Y){if(I[0]==80&&I[1]==75)return ph(I,Y);if((I[0]|32)==109&&(I[1]|32)==105)return Wr(I,Y);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var q=3,X=512,Q=0,J=0,ce=0,ve=0,oe=0,de=[],he=I.slice(0,512);ln(he,0);var be=f(he);switch(q=be[0],q){case 3:X=512;break;case 4:X=4096;break;case 0:if(be[1]==0)return ph(I,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}X!==512&&(he=I.slice(0,X),ln(he,28));var Ae=I.slice(0,X);m(he,q);var Re=he.read_shift(4,"i");if(q===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);he.l+=4,ce=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),ve=he.read_shift(4,"i"),Q=he.read_shift(4,"i"),oe=he.read_shift(4,"i"),J=he.read_shift(4,"i");for(var ke=-1,Me=0;Me<109&&(ke=he.read_shift(4,"i"),!(ke<0));++Me)de[Me]=ke;var Qe=_(I,X);y(oe,J,Qe,X,de);var zt=x(Qe,ce,de,X);zt[ce].name="!Directory",Q>0&&ve!==U&&(zt[ve].name="!MiniFAT"),zt[de[0]].name="!FAT",zt.fat_addrs=de,zt.ssz=X;var It={},Mr=[],Fo=[],Do=[];j(ce,zt,Qe,Mr,Q,It,Fo,ve),g(Fo,Do,Mr),Mr.shift();var is={FileIndex:Fo,FullPaths:Do};return Y&&Y.raw&&(is.raw={header:Ae,sectors:Qe}),is}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(W,"Header Signature: "),I.l+=16;var Y=I.read_shift(2,"u");return[I.read_shift(2,"u"),Y]}function m(I,Y){var q=9;switch(I.l+=2,q=I.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function _(I,Y){for(var q=Math.ceil(I.length/Y)-1,X=[],Q=1;Q<q;++Q)X[Q-1]=I.slice(Q*Y,(Q+1)*Y);return X[q-1]=I.slice(q*Y),X}function g(I,Y,q){for(var X=0,Q=0,J=0,ce=0,ve=0,oe=q.length,de=[],he=[];X<oe;++X)de[X]=he[X]=X,Y[X]=q[X];for(;ve<he.length;++ve)X=he[ve],Q=I[X].L,J=I[X].R,ce=I[X].C,de[X]===X&&(Q!==-1&&de[Q]!==Q&&(de[X]=de[Q]),J!==-1&&de[J]!==J&&(de[X]=de[J])),ce!==-1&&(de[ce]=X),Q!==-1&&X!=de[X]&&(de[Q]=de[X],he.lastIndexOf(Q)<ve&&he.push(Q)),J!==-1&&X!=de[X]&&(de[J]=de[X],he.lastIndexOf(J)<ve&&he.push(J));for(X=1;X<oe;++X)de[X]===X&&(J!==-1&&de[J]!==J?de[X]=de[J]:Q!==-1&&de[Q]!==Q&&(de[X]=de[Q]));for(X=1;X<oe;++X)if(I[X].type!==0){if(ve=X,ve!=de[ve])do ve=de[ve],Y[X]=Y[ve]+"/"+Y[X];while(ve!==0&&de[ve]!==-1&&ve!=de[ve]);de[X]=-1}for(Y[0]+="/",X=1;X<oe;++X)I[X].type!==2&&(Y[X]+="/")}function v(I,Y,q){for(var X=I.start,Q=I.size,J=[],ce=X;q&&Q>0&&ce>=0;)J.push(Y.slice(ce*H,ce*H+H)),Q-=H,ce=kc(q,ce*4);return J.length===0?xe(0):Yr(J).slice(0,I.size)}function y(I,Y,q,X,Q){var J=U;if(I===U){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ce=q[I],ve=(X>>>2)-1;if(!ce)return;for(var oe=0;oe<ve&&(J=kc(ce,oe*4))!==U;++oe)Q.push(J);y(kc(ce,X-4),Y-1,q,X,Q)}}function b(I,Y,q,X,Q){var J=[],ce=[];Q||(Q=[]);var ve=X-1,oe=0,de=0;for(oe=Y;oe>=0;){Q[oe]=!0,J[J.length]=oe,ce.push(I[oe]);var he=q[Math.floor(oe*4/X)];if(de=oe*4&ve,X<4+de)throw new Error("FAT boundary crossed: "+oe+" 4 "+X);if(!I[he])break;oe=kc(I[he],de)}return{nodes:J,data:cT([ce])}}function x(I,Y,q,X){var Q=I.length,J=[],ce=[],ve=[],oe=[],de=X-1,he=0,be=0,Ae=0,Re=0;for(he=0;he<Q;++he)if(ve=[],Ae=he+Y,Ae>=Q&&(Ae-=Q),!ce[Ae]){oe=[];var ke=[];for(be=Ae;be>=0;){ke[be]=!0,ce[be]=!0,ve[ve.length]=be,oe.push(I[be]);var Me=q[Math.floor(be*4/X)];if(Re=be*4&de,X<4+Re)throw new Error("FAT boundary crossed: "+be+" 4 "+X);if(!I[Me]||(be=kc(I[Me],Re),ke[be]))break}J[Ae]={nodes:ve,data:cT([oe])}}return J}function j(I,Y,q,X,Q,J,ce,ve){for(var oe=0,de=X.length?2:0,he=Y[I].data,be=0,Ae=0,Re;be<he.length;be+=128){var ke=he.slice(be,be+128);ln(ke,64),Ae=ke.read_shift(2),Re=Fk(ke,0,Ae-de),X.push(Re);var Me={name:Re,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},Qe=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Qe!==0&&(Me.ct=S(ke,ke.l-8));var zt=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);zt!==0&&(Me.mt=S(ke,ke.l-8)),Me.start=ke.read_shift(4,"i"),Me.size=ke.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=U,Me.name=""),Me.type===5?(oe=Me.start,Q>0&&oe!==U&&(Y[oe].name="!StreamData")):Me.size>=4096?(Me.storage="fat",Y[Me.start]===void 0&&(Y[Me.start]=b(q,Me.start,Y.fat_addrs,Y.ssz)),Y[Me.start].name=Me.name,Me.content=Y[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:oe!==U&&Me.start!==U&&Y[oe]&&(Me.content=v(Me,Y[oe].data,(Y[ve]||{}).data))),Me.content&&ln(Me.content,0),J[Re]=Me,ce.push(Me)}}function S(I,Y){return new Date((Oa(I,Y+4)/1e7*Math.pow(2,32)+Oa(I,Y)/1e7-11644473600)*1e3)}function T(I,Y){return u(),h(c.readFileSync(I),Y)}function F(I,Y){var q=Y&&Y.type;switch(q||dt&&Buffer.isBuffer(I)&&(q="buffer"),q||"base64"){case"file":return T(I,Y);case"base64":return h(Ra(Ua(I)),Y);case"binary":return h(Ra(I),Y)}return h(I,Y)}function w(I,Y){var q=Y||{},X=q.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=X+"/",I.FileIndex[0]={name:X,type:5}),q.CLSID&&(I.FileIndex[0].clsid=q.CLSID),P(I)}function P(I){var Y="Sh33tJ5";if(!Ge.find(I,"/"+Y)){var q=xe(4);q[0]=55,q[1]=q[3]=50,q[2]=54,I.FileIndex.push({name:Y,type:2,content:q,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+Y),M(I)}}function M(I,Y){w(I);for(var q=!1,X=!1,Q=I.FullPaths.length-1;Q>=0;--Q){var J=I.FileIndex[Q];switch(J.type){case 0:X?q=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(J.R*J.L*J.C)&&(q=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!Y)){var ce=new Date(1987,1,19),ve=0,oe=Object.create?Object.create(null):{},de=[];for(Q=0;Q<I.FullPaths.length;++Q)oe[I.FullPaths[Q]]=!0,I.FileIndex[Q].type!==0&&de.push([I.FullPaths[Q],I.FileIndex[Q]]);for(Q=0;Q<de.length;++Q){var he=n(de[Q][0]);X=oe[he],X||(de.push([he,{name:i(he).replace("/",""),type:1,clsid:ae,ct:ce,mt:ce,content:null}]),oe[he]=!0)}for(de.sort(function(Re,ke){return r(Re[0],ke[0])}),I.FullPaths=[],I.FileIndex=[],Q=0;Q<de.length;++Q)I.FullPaths[Q]=de[Q][0],I.FileIndex[Q]=de[Q][1];for(Q=0;Q<de.length;++Q){var be=I.FileIndex[Q],Ae=I.FullPaths[Q];if(be.name=i(Ae).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||ae,Q===0)be.C=de.length>1?1:-1,be.size=0,be.type=5;else if(Ae.slice(-1)=="/"){for(ve=Q+1;ve<de.length&&n(I.FullPaths[ve])!=Ae;++ve);for(be.C=ve>=de.length?-1:ve,ve=Q+1;ve<de.length&&n(I.FullPaths[ve])!=n(Ae);++ve);be.R=ve>=de.length?-1:ve,be.type=1}else n(I.FullPaths[Q+1]||"")==n(Ae)&&(be.R=Q+1),be.type=2}}}function A(I,Y){var q=Y||{};if(q.fileType=="mad")return qa(I,q);switch(M(I),q.fileType){case"zip":return k(I,q)}var X=function(Re){for(var ke=0,Me=0,Qe=0;Qe<Re.FileIndex.length;++Qe){var zt=Re.FileIndex[Qe];if(zt.content){var It=zt.content.length;It>0&&(It<4096?ke+=It+63>>6:Me+=It+511>>9)}}for(var Mr=Re.FullPaths.length+3>>2,Fo=ke+7>>3,Do=ke+127>>7,is=Fo+Me+Mr+Do,Kl=is+127>>7,vv=Kl<=109?0:Math.ceil((Kl-109)/127);is+Kl+vv+127>>7>Kl;)vv=++Kl<=109?0:Math.ceil((Kl-109)/127);var Rs=[1,vv,Kl,Do,Mr,Me,ke,0];return Re.FileIndex[0].size=ke<<6,Rs[7]=(Re.FileIndex[0].start=Rs[0]+Rs[1]+Rs[2]+Rs[3]+Rs[4]+Rs[5])+(Rs[6]+7>>3),Rs}(I),Q=xe(X[7]<<9),J=0,ce=0;{for(J=0;J<8;++J)Q.write_shift(1,R[J]);for(J=0;J<8;++J)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),J=0;J<3;++J)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,X[2]),Q.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:U),Q.write_shift(4,X[3]),Q.write_shift(-4,X[1]?X[0]-1:U),Q.write_shift(4,X[1]),J=0;J<109;++J)Q.write_shift(-4,J<X[2]?X[1]+J:-1)}if(X[1])for(ce=0;ce<X[1];++ce){for(;J<236+ce*127;++J)Q.write_shift(-4,J<X[2]?X[1]+J:-1);Q.write_shift(-4,ce===X[1]-1?U:ce+1)}var ve=function(Re){for(ce+=Re;J<ce-1;++J)Q.write_shift(-4,J+1);Re&&(++J,Q.write_shift(-4,U))};for(ce=J=0,ce+=X[1];J<ce;++J)Q.write_shift(-4,le.DIFSECT);for(ce+=X[2];J<ce;++J)Q.write_shift(-4,le.FATSECT);ve(X[3]),ve(X[4]);for(var oe=0,de=0,he=I.FileIndex[0];oe<I.FileIndex.length;++oe)he=I.FileIndex[oe],he.content&&(de=he.content.length,!(de<4096)&&(he.start=ce,ve(de+511>>9)));for(ve(X[6]+7>>3);Q.l&511;)Q.write_shift(-4,le.ENDOFCHAIN);for(ce=J=0,oe=0;oe<I.FileIndex.length;++oe)he=I.FileIndex[oe],he.content&&(de=he.content.length,!(!de||de>=4096)&&(he.start=ce,ve(de+63>>6)));for(;Q.l&511;)Q.write_shift(-4,le.ENDOFCHAIN);for(J=0;J<X[4]<<2;++J){var be=I.FullPaths[J];if(!be||be.length===0){for(oe=0;oe<17;++oe)Q.write_shift(4,0);for(oe=0;oe<3;++oe)Q.write_shift(4,-1);for(oe=0;oe<12;++oe)Q.write_shift(4,0);continue}he=I.FileIndex[J],J===0&&(he.start=he.size?he.start-1:U);var Ae=J===0&&q.root||he.name;if(de=2*(Ae.length+1),Q.write_shift(64,Ae,"utf16le"),Q.write_shift(2,de),Q.write_shift(1,he.type),Q.write_shift(1,he.color),Q.write_shift(-4,he.L),Q.write_shift(-4,he.R),Q.write_shift(-4,he.C),he.clsid)Q.write_shift(16,he.clsid,"hex");else for(oe=0;oe<4;++oe)Q.write_shift(4,0);Q.write_shift(4,he.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,he.start),Q.write_shift(4,he.size),Q.write_shift(4,0)}for(J=1;J<I.FileIndex.length;++J)if(he=I.FileIndex[J],he.size>=4096)if(Q.l=he.start+1<<9,dt&&Buffer.isBuffer(he.content))he.content.copy(Q,Q.l,0,he.size),Q.l+=he.size+511&-512;else{for(oe=0;oe<he.size;++oe)Q.write_shift(1,he.content[oe]);for(;oe&511;++oe)Q.write_shift(1,0)}for(J=1;J<I.FileIndex.length;++J)if(he=I.FileIndex[J],he.size>0&&he.size<4096)if(dt&&Buffer.isBuffer(he.content))he.content.copy(Q,Q.l,0,he.size),Q.l+=he.size+63&-64;else{for(oe=0;oe<he.size;++oe)Q.write_shift(1,he.content[oe]);for(;oe&63;++oe)Q.write_shift(1,0)}if(dt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function D(I,Y){var q=I.FullPaths.map(function(oe){return oe.toUpperCase()}),X=q.map(function(oe){var de=oe.split("/");return de[de.length-(oe.slice(-1)=="/"?2:1)]}),Q=!1;Y.charCodeAt(0)===47?(Q=!0,Y=q[0].slice(0,-1)+Y):Q=Y.indexOf("/")!==-1;var J=Y.toUpperCase(),ce=Q===!0?q.indexOf(J):X.indexOf(J);if(ce!==-1)return I.FileIndex[ce];var ve=!J.match(If);for(J=J.replace(Qn,""),ve&&(J=J.replace(If,"!")),ce=0;ce<q.length;++ce)if((ve?q[ce].replace(If,"!"):q[ce]).replace(Qn,"")==J||(ve?X[ce].replace(If,"!"):X[ce]).replace(Qn,"")==J)return I.FileIndex[ce];return null}var H=64,U=-2,W="d0cf11e0a1b11ae1",R=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(I,Y,q){u();var X=A(I,q);c.writeFileSync(Y,X)}function z(I){for(var Y=new Array(I.length),q=0;q<I.length;++q)Y[q]=String.fromCharCode(I[q]);return Y.join("")}function ie(I,Y){var q=A(I,Y);switch(Y&&Y.type||"buffer"){case"file":return u(),c.writeFileSync(Y.filename,q),q;case"binary":return typeof q=="string"?q:z(q);case"base64":return P0(typeof q=="string"?q:z(q));case"buffer":if(dt)return Buffer.isBuffer(q)?q:Co(q);case"array":return typeof q=="string"?Ra(q):q}return q}var ne;function O(I){try{var Y=I.InflateRaw,q=new Y;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)ne=I;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function N(I,Y){if(!ne)return hh(I,Y);var q=ne.InflateRaw,X=new q,Q=X._processChunk(I.slice(I.l),X._finishFlushFlag);return I.l+=X.bytesRead,Q}function L(I){return ne?ne.deflateRawSync(I):tt(I)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(I){var Y=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var B=typeof Uint8Array<"u",se=B?new Uint8Array(256):[],we=0;we<256;++we)se[we]=me(we);function V(I,Y){var q=se[I&255];return Y<=8?q>>>8-Y:(q=q<<8|se[I>>8&255],Y<=16?q>>>16-Y:(q=q<<8|se[I>>16&255],q>>>24-Y))}function Ce(I,Y){var q=Y&7,X=Y>>>3;return(I[X]|(q<=6?0:I[X+1]<<8))>>>q&3}function qe(I,Y){var q=Y&7,X=Y>>>3;return(I[X]|(q<=5?0:I[X+1]<<8))>>>q&7}function Te(I,Y){var q=Y&7,X=Y>>>3;return(I[X]|(q<=4?0:I[X+1]<<8))>>>q&15}function E(I,Y){var q=Y&7,X=Y>>>3;return(I[X]|(q<=3?0:I[X+1]<<8))>>>q&31}function _e(I,Y){var q=Y&7,X=Y>>>3;return(I[X]|(q<=1?0:I[X+1]<<8))>>>q&127}function wt(I,Y,q){var X=Y&7,Q=Y>>>3,J=(1<<q)-1,ce=I[Q]>>>X;return q<8-X||(ce|=I[Q+1]<<8-X,q<16-X)||(ce|=I[Q+2]<<16-X,q<24-X)||(ce|=I[Q+3]<<24-X),ce&J}function Vr(I,Y,q){var X=Y&7,Q=Y>>>3;return X<=5?I[Q]|=(q&7)<<X:(I[Q]|=q<<X&255,I[Q+1]=(q&7)>>8-X),Y+3}function pn(I,Y,q){var X=Y&7,Q=Y>>>3;return q=(q&1)<<X,I[Q]|=q,Y+1}function Nn(I,Y,q){var X=Y&7,Q=Y>>>3;return q<<=X,I[Q]|=q&255,q>>>=8,I[Q+1]=q,Y+8}function te(I,Y,q){var X=Y&7,Q=Y>>>3;return q<<=X,I[Q]|=q&255,q>>>=8,I[Q+1]=q&255,I[Q+2]=q>>>8,Y+16}function Pe(I,Y){var q=I.length,X=2*q>Y?2*q:Y+5,Q=0;if(q>=Y)return I;if(dt){var J=HE(X);if(I.copy)I.copy(J);else for(;Q<I.length;++Q)J[Q]=I[Q];return J}else if(B){var ce=new Uint8Array(X);if(ce.set)ce.set(I);else for(;Q<q;++Q)ce[Q]=I[Q];return ce}return I.length=X,I}function Qt(I){for(var Y=new Array(I),q=0;q<I;++q)Y[q]=0;return Y}function Wa(I,Y,q){var X=1,Q=0,J=0,ce=0,ve=0,oe=I.length,de=B?new Uint16Array(32):Qt(32);for(J=0;J<32;++J)de[J]=0;for(J=oe;J<q;++J)I[J]=0;oe=I.length;var he=B?new Uint16Array(oe):Qt(oe);for(J=0;J<oe;++J)de[Q=I[J]]++,X<Q&&(X=Q),he[J]=0;for(de[0]=0,J=1;J<=X;++J)de[J+16]=ve=ve+de[J-1]<<1;for(J=0;J<oe;++J)ve=I[J],ve!=0&&(he[J]=de[ve+16]++);var be=0;for(J=0;J<oe;++J)if(be=I[J],be!=0)for(ve=V(he[J],X)>>X-be,ce=(1<<X+4-be)-1;ce>=0;--ce)Y[ve|ce<<be]=be&15|J<<4;return X}var Fi=B?new Uint16Array(512):Qt(512),To=B?new Uint16Array(32):Qt(32);if(!B){for(var Hr=0;Hr<512;++Hr)Fi[Hr]=0;for(Hr=0;Hr<32;++Hr)To[Hr]=0}(function(){for(var I=[],Y=0;Y<32;Y++)I.push(5);Wa(I,To,32);var q=[];for(Y=0;Y<=143;Y++)q.push(8);for(;Y<=255;Y++)q.push(9);for(;Y<=279;Y++)q.push(7);for(;Y<=287;Y++)q.push(8);Wa(q,Fi,288)})();var ka=function(){for(var Y=B?new Uint8Array(32768):[],q=0,X=0;q<Z.length-1;++q)for(;X<Z[q+1];++X)Y[X]=q;for(;X<32768;++X)Y[X]=29;var Q=B?new Uint8Array(259):[];for(q=0,X=0;q<re.length-1;++q)for(;X<re[q+1];++X)Q[X]=q;function J(ve,oe){for(var de=0;de<ve.length;){var he=Math.min(65535,ve.length-de),be=de+he==ve.length;for(oe.write_shift(1,+be),oe.write_shift(2,he),oe.write_shift(2,~he&65535);he-- >0;)oe[oe.l++]=ve[de++]}return oe.l}function ce(ve,oe){for(var de=0,he=0,be=B?new Uint16Array(32768):[];he<ve.length;){var Ae=Math.min(65535,ve.length-he);if(Ae<10){for(de=Vr(oe,de,+(he+Ae==ve.length)),de&7&&(de+=8-(de&7)),oe.l=de/8|0,oe.write_shift(2,Ae),oe.write_shift(2,~Ae&65535);Ae-- >0;)oe[oe.l++]=ve[he++];de=oe.l*8;continue}de=Vr(oe,de,+(he+Ae==ve.length)+2);for(var Re=0;Ae-- >0;){var ke=ve[he];Re=(Re<<5^ke)&32767;var Me=-1,Qe=0;if((Me=be[Re])&&(Me|=he&-32768,Me>he&&(Me-=32768),Me<he))for(;ve[Me+Qe]==ve[he+Qe]&&Qe<250;)++Qe;if(Qe>2){ke=Q[Qe],ke<=22?de=Nn(oe,de,se[ke+1]>>1)-1:(Nn(oe,de,3),de+=5,Nn(oe,de,se[ke-23]>>5),de+=3);var zt=ke<8?0:ke-4>>2;zt>0&&(te(oe,de,Qe-re[ke]),de+=zt),ke=Y[he-Me],de=Nn(oe,de,se[ke]>>3),de-=3;var It=ke<4?0:ke-2>>1;It>0&&(te(oe,de,he-Me-Z[ke]),de+=It);for(var Mr=0;Mr<Qe;++Mr)be[Re]=he&32767,Re=(Re<<5^ve[he])&32767,++he;Ae-=Qe-1}else ke<=143?ke=ke+48:de=pn(oe,de,1),de=Nn(oe,de,se[ke]),be[Re]=he&32767,++he}de=Nn(oe,de,0)-1}return oe.l=(de+7)/8|0,oe.l}return function(oe,de){return oe.length<8?J(oe,de):ce(oe,de)}}();function tt(I){var Y=xe(50+Math.floor(I.length*1.1)),q=ka(I,Y);return Y.slice(0,q)}var Xt=B?new Uint16Array(32768):Qt(32768),zn=B?new Uint16Array(32768):Qt(32768),sr=B?new Uint16Array(128):Qt(128),as=1,uh=1;function Sp(I,Y){var q=E(I,Y)+257;Y+=5;var X=E(I,Y)+1;Y+=5;var Q=Te(I,Y)+4;Y+=4;for(var J=0,ce=B?new Uint8Array(19):Qt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,de=B?new Uint8Array(8):Qt(8),he=B?new Uint8Array(8):Qt(8),be=ce.length,Ae=0;Ae<Q;++Ae)ce[K[Ae]]=J=qe(I,Y),oe<J&&(oe=J),de[J]++,Y+=3;var Re=0;for(de[0]=0,Ae=1;Ae<=oe;++Ae)he[Ae]=Re=Re+de[Ae-1]<<1;for(Ae=0;Ae<be;++Ae)(Re=ce[Ae])!=0&&(ve[Ae]=he[Re]++);var ke=0;for(Ae=0;Ae<be;++Ae)if(ke=ce[Ae],ke!=0){Re=se[ve[Ae]]>>8-ke;for(var Me=(1<<7-ke)-1;Me>=0;--Me)sr[Re|Me<<ke]=ke&7|Ae<<3}var Qe=[];for(oe=1;Qe.length<q+X;)switch(Re=sr[_e(I,Y)],Y+=Re&7,Re>>>=3){case 16:for(J=3+Ce(I,Y),Y+=2,Re=Qe[Qe.length-1];J-- >0;)Qe.push(Re);break;case 17:for(J=3+qe(I,Y),Y+=3;J-- >0;)Qe.push(0);break;case 18:for(J=11+_e(I,Y),Y+=7;J-- >0;)Qe.push(0);break;default:Qe.push(Re),oe<Re&&(oe=Re);break}var zt=Qe.slice(0,q),It=Qe.slice(q);for(Ae=q;Ae<286;++Ae)zt[Ae]=0;for(Ae=X;Ae<30;++Ae)It[Ae]=0;return as=Wa(zt,Xt,286),uh=Wa(It,zn,30),Y}function Cp(I,Y){if(I[0]==3&&!(I[1]&3))return[Nl(Y),2];for(var q=0,X=0,Q=HE(Y||1<<18),J=0,ce=Q.length>>>0,ve=0,oe=0;!(X&1);){if(X=qe(I,q),q+=3,X>>>1)X>>1==1?(ve=9,oe=5):(q=Sp(I,q),ve=as,oe=uh);else{q&7&&(q+=8-(q&7));var de=I[q>>>3]|I[(q>>>3)+1]<<8;if(q+=32,de>0)for(!Y&&ce<J+de&&(Q=Pe(Q,J+de),ce=Q.length);de-- >0;)Q[J++]=I[q>>>3],q+=8;continue}for(;;){!Y&&ce<J+32767&&(Q=Pe(Q,J+32767),ce=Q.length);var he=wt(I,q,ve),be=X>>>1==1?Fi[he]:Xt[he];if(q+=be&15,be>>>=4,!(be>>>8&255))Q[J++]=be;else{if(be==256)break;be-=257;var Ae=be<8?0:be-4>>2;Ae>5&&(Ae=0);var Re=J+re[be];Ae>0&&(Re+=wt(I,q,Ae),q+=Ae),he=wt(I,q,oe),be=X>>>1==1?To[he]:zn[he],q+=be&15,be>>>=4;var ke=be<4?0:be-2>>1,Me=Z[be];for(ke>0&&(Me+=wt(I,q,ke),q+=ke),!Y&&ce<Re&&(Q=Pe(Q,Re+100),ce=Q.length);J<Re;)Q[J]=Q[J-Me],++J}}}return Y?[Q,q+7>>>3]:[Q.slice(0,J),q+7>>>3]}function hh(I,Y){var q=I.slice(I.l||0),X=Cp(q,Y);return I.l+=X[1],X[0]}function fh(I,Y){if(I)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function ph(I,Y){var q=I;ln(q,0);var X=[],Q=[],J={FileIndex:X,FullPaths:Q};w(J,{root:Y.root});for(var ce=q.length-4;(q[ce]!=80||q[ce+1]!=75||q[ce+2]!=5||q[ce+3]!=6)&&ce>=0;)--ce;q.l=ce+4,q.l+=4;var ve=q.read_shift(2);q.l+=6;var oe=q.read_shift(4);for(q.l=oe,ce=0;ce<ve;++ce){q.l+=20;var de=q.read_shift(4),he=q.read_shift(4),be=q.read_shift(2),Ae=q.read_shift(2),Re=q.read_shift(2);q.l+=8;var ke=q.read_shift(4),Me=l(q.slice(q.l+be,q.l+be+Ae));q.l+=be+Ae+Re;var Qe=q.l;q.l=ke+4,$p(q,de,he,J,Me),q.l=Qe}return J}function $p(I,Y,q,X,Q){I.l+=2;var J=I.read_shift(2),ce=I.read_shift(2),ve=o(I);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var oe=I.read_shift(4),de=I.read_shift(4),he=I.read_shift(4),be=I.read_shift(2),Ae=I.read_shift(2),Re="",ke=0;ke<be;++ke)Re+=String.fromCharCode(I[I.l++]);if(Ae){var Me=l(I.slice(I.l,I.l+Ae));(Me[21589]||{}).mt&&(ve=Me[21589].mt),((Q||{})[21589]||{}).mt&&(ve=Q[21589].mt)}I.l+=Ae;var Qe=I.slice(I.l,I.l+de);switch(ce){case 8:Qe=N(I,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var zt=!1;J&8&&(oe=I.read_shift(4),oe==134695760&&(oe=I.read_shift(4),zt=!0),de=I.read_shift(4),he=I.read_shift(4)),de!=Y&&fh(zt,"Bad compressed size: "+Y+" != "+de),he!=q&&fh(zt,"Bad uncompressed size: "+q+" != "+he),Xa(X,Re,Qe,{unsafe:!0,mt:ve})}function k(I,Y){var q=Y||{},X=[],Q=[],J=xe(1),ce=q.compression?8:0,ve=0,oe=0,de=0,he=0,be=0,Ae=I.FullPaths[0],Re=Ae,ke=I.FileIndex[0],Me=[],Qe=0;for(oe=1;oe<I.FullPaths.length;++oe)if(Re=I.FullPaths[oe].slice(Ae.length),ke=I.FileIndex[oe],!(!ke.size||!ke.content||Re=="Sh33tJ5")){var zt=he,It=xe(Re.length);for(de=0;de<Re.length;++de)It.write_shift(1,Re.charCodeAt(de)&127);It=It.slice(0,It.l),Me[be]=YH.buf(ke.content,0);var Mr=ke.content;ce==8&&(Mr=L(Mr)),J=xe(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,ce),ke.mt?s(J,ke.mt):J.write_shift(4,0),J.write_shift(-4,Me[be]),J.write_shift(4,Mr.length),J.write_shift(4,ke.content.length),J.write_shift(2,It.length),J.write_shift(2,0),he+=J.length,X.push(J),he+=It.length,X.push(It),he+=Mr.length,X.push(Mr),J=xe(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,ce),J.write_shift(4,0),J.write_shift(-4,Me[be]),J.write_shift(4,Mr.length),J.write_shift(4,ke.content.length),J.write_shift(2,It.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,zt),Qe+=J.l,Q.push(J),Qe+=It.length,Q.push(It),++be}return J=xe(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,be),J.write_shift(2,be),J.write_shift(4,Qe),J.write_shift(4,he),J.write_shift(2,0),Yr([Yr(X),Yr(Q),J])}var ft={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Et(I,Y){if(I.ctype)return I.ctype;var q=I.name||"",X=q.match(/\.([^\.]+)$/);return X&&ft[X[1]]||Y&&(X=(q=Y).match(/[\.\\]([^\.\\])+$/),X&&ft[X[1]])?ft[X[1]]:"application/octet-stream"}function mn(I){for(var Y=P0(I),q=[],X=0;X<Y.length;X+=76)q.push(Y.slice(X,X+76));return q.join(`\r
`)+`\r
`}function or(I){var Y=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var he=de.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],X=Y.split(`\r
`),Q=0;Q<X.length;++Q){var J=X[Q];if(J.length==0){q.push("");continue}for(var ce=0;ce<J.length;){var ve=76,oe=J.slice(ce,ce+ve);oe.charAt(ve-1)=="="?ve--:oe.charAt(ve-2)=="="?ve-=2:oe.charAt(ve-3)=="="&&(ve-=3),oe=J.slice(ce,ce+ve),ce+=ve,ce<J.length&&(oe+="="),q.push(oe)}}return q.join(`\r
`)}function Ao(I){for(var Y=[],q=0;q<I.length;++q){for(var X=I[q];q<=I.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+I[++q];Y.push(X)}for(var Q=0;Q<Y.length;++Q)Y[Q]=Y[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Ra(Y.join(`\r
`))}function Ga(I,Y,q){for(var X="",Q="",J="",ce,ve=0;ve<10;++ve){var oe=Y[ve];if(!oe||oe.match(/^\s*$/))break;var de=oe.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":X=de[2].trim();break;case"content-type":J=de[2].trim();break;case"content-transfer-encoding":Q=de[2].trim();break}}switch(++ve,Q.toLowerCase()){case"base64":ce=Ra(Ua(Y.slice(ve).join("")));break;case"quoted-printable":ce=Ao(Y.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var he=Xa(I,X.slice(q.length),ce,{unsafe:!0});J&&(he.ctype=J)}function Wr(I,Y){if(z(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=Y&&Y.root||"",X=(dt&&Buffer.isBuffer(I)?I.toString("binary"):z(I)).split(`\r
`),Q=0,J="";for(Q=0;Q<X.length;++Q)if(J=X[Q],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),q||(q=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),J.slice(0,q.length)!=q););var ce=(X[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ve="--"+(ce[1]||""),oe=[],de=[],he={FileIndex:oe,FullPaths:de};w(he);var be,Ae=0;for(Q=0;Q<X.length;++Q){var Re=X[Q];Re!==ve&&Re!==ve+"--"||(Ae++&&Ga(he,X.slice(be,Q),q),be=Q)}return he}function qa(I,Y){var q=Y||{},X=q.boundary||"SheetJS";X="------="+X;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],J=I.FullPaths[0],ce=J,ve=I.FileIndex[0],oe=1;oe<I.FullPaths.length;++oe)if(ce=I.FullPaths[oe].slice(J.length),ve=I.FileIndex[oe],!(!ve.size||!ve.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var de=ve.content,he=dt&&Buffer.isBuffer(de)?de.toString("binary"):z(de),be=0,Ae=Math.min(1024,he.length),Re=0,ke=0;ke<=Ae;++ke)(Re=he.charCodeAt(ke))>=32&&Re<128&&++be;var Me=be>=Ae*4/5;Q.push(X),Q.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+ce),Q.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),Q.push("Content-Type: "+Et(ve,ce)),Q.push(""),Q.push(Me?or(he):mn(he))}return Q.push(X+`--\r
`),Q.join(`\r
`)}function Ka(I){var Y={};return w(Y,I),Y}function Xa(I,Y,q,X){var Q=X&&X.unsafe;Q||w(I);var J=!Q&&Ge.find(I,Y);if(!J){var ce=I.FullPaths[0];Y.slice(0,ce.length)==ce?ce=Y:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+Y).replace("//","/")),J={name:i(Y),type:2},I.FileIndex.push(J),I.FullPaths.push(ce),Q||Ge.utils.cfb_gc(I)}return J.content=q,J.size=q?q.length:0,X&&(X.CLSID&&(J.clsid=X.CLSID),X.mt&&(J.mt=X.mt),X.ct&&(J.ct=X.ct)),J}function Cd(I,Y){w(I);var q=Ge.find(I,Y);if(q){for(var X=0;X<I.FileIndex.length;++X)if(I.FileIndex[X]==q)return I.FileIndex.splice(X,1),I.FullPaths.splice(X,1),!0}return!1}function Os(I,Y,q){w(I);var X=Ge.find(I,Y);if(X){for(var Q=0;Q<I.FileIndex.length;++Q)if(I.FileIndex[Q]==X)return I.FileIndex[Q].name=i(q),I.FullPaths[Q]=q,!0}return!1}function jS(I){M(I,!0)}return t.find=D,t.read=F,t.parse=h,t.write=ie,t.writeFile=G,t.utils={cfb_new:Ka,cfb_add:Xa,cfb_del:Cd,cfb_mov:Os,cfb_gc:jS,ReadShift:t0,CheckField:j8,prep_blob:ln,bconcat:Yr,use_zlib:O,_deflateRaw:tt,_inflateRaw:hh,consts:le},t}();function QH(e){return typeof e=="string"?rv(e):Array.isArray(e)?wH(e):e}function mp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=rv(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ts(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([QH(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Wl(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function JH(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function pr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function JE(e,t){for(var r=[],n=pr(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function av(e){for(var t=[],r=pr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function iv(e){for(var t=[],r=pr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function ZH(e){for(var t=[],r=pr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var u1=new Date(1899,11,30,0,0,0);function Ur(e,t){var r=e.getTime(),n=u1.getTime()+(e.getTimezoneOffset()-u1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var t8=new Date,eW=u1.getTime()+(t8.getTimezoneOffset()-u1.getTimezoneOffset())*6e4,ZE=t8.getTimezoneOffset();function sv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+eW),t.getTimezoneOffset()!==ZE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ZE)*6e4),t}function tW(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var eT=new Date("2017-02-19T19:06:09.000Z"),r8=isNaN(eT.getFullYear())?new Date("2/19/17"):eT,rW=r8.getFullYear()==2017;function qt(e,t){var r=new Date(e);if(rW)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(r8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function od(e,t){if(dt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ts(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ts(VP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ts(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ts(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Kt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Kt(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function Zi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var nW=["january","february","march","april","may","june","july","august","september","october","november","december"];function qu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&nW.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var aW=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function n8(e){return e?e.content&&e.type?od(e.content,!0):e.data?zf(e.data):e.asNodeBuffer&&dt?zf(e.asNodeBuffer().toString("binary")):e.asBinary?zf(e.asBinary()):e._data&&e._data.getContent?zf(od(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function a8(e){if(!e)return null;if(e.data)return UE(e.data);if(e.asNodeBuffer&&dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?UE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function iW(e){return e&&e.name.slice(-4)===".bin"?a8(e):n8(e)}function pi(e,t){for(var r=e.FullPaths||pr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Sk(e,t){var r=pi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Er(e,t,r){if(!r)return iW(Sk(e,t));if(!t)return null;try{return Er(e,t)}catch{return null}}function Na(e,t,r){if(!r)return n8(Sk(e,t));if(!t)return null;try{return Na(e,t)}catch{return null}}function sW(e,t,r){return a8(Sk(e,t))}function tT(e){for(var t=e.FullPaths||pr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function rt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return dt?n=Co(r):n=kH(r),Ge.utils.cfb_add(e,t,n)}Ge.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ck(){return Ge.utils.cfb_new()}function i8(e,t){switch(t.type){case"base64":return Ge.read(e,{type:"base64"});case"binary":return Ge.read(e,{type:"binary"});case"buffer":case"array":return Ge.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Lf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var jr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,oW=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,lW=/<[^>]*>/g,Rn=jr.match(rT)?rT:lW,cW=/<\w*:/,dW=/<(\/?)\w+:/;function Ye(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(oW),l=0,c="",u=0,h="",f="",m=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(m=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+m,f.length-m),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var _=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[_]&&h.slice(l-3,l)=="ext")continue;n[_]=c,n[_.toLowerCase()]=c}}return n}function Ps(e){return e.replace(dW,"<$1")}var s8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$k=av(s8),_t=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return s8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),Ek=/[&<>'"]/g,uW=/[\u0000-\u0008\u000b-\u001f]/g;function Mt(e){var t=e+"";return t.replace(Ek,function(r){return $k[r]}).replace(uW,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nT(e){return Mt(e).replace(/ /g,"_x0020_")}var o8=/[\u0000-\u001f]/g;function Tk(e){var t=e+"";return t.replace(Ek,function(r){return $k[r]}).replace(/\n/g,"<br/>").replace(o8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function hW(e){var t=e+"";return t.replace(Ek,function(r){return $k[r]}).replace(o8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var aT=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function fW(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uy(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function iT(e){var t=Nl(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function sT(e){return Co(e,"binary").toString("utf8")}var bm="foo bar baz",Rt=dt&&(sT(bm)==uy(bm)&&sT||iT(bm)==uy(bm)&&iT)||uy,Ts=dt?function(e){return Co(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},O0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),l8=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),pW=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),mW=/<\/?(?:vt:)?variant>/g,gW=/<(?:vt:)([^>]*)>([\s\S]*)</;function oT(e,t){var r=Ye(e),n=e.match(pW(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(mW,"").match(gW);o&&i.push({v:Rt(o[2]),t:o[1]})}),i}var c8=/(^\s|\s$|\n)/;function cn(e,t){return"<"+e+(t.match(c8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function R0(e){return pr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function $e(e,t,r){return"<"+e+(r!=null?R0(r):"")+(t!=null?(t.match(c8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Pw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function xW(e,t){switch(typeof e){case"string":var r=$e("vt:lpwstr",Mt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $e((e|0)==e?"vt:i4":"vt:r8",Mt(String(e)));case"boolean":return $e("vt:bool",e?"true":"false")}if(e instanceof Date)return $e("vt:filetime",Pw(e));throw new Error("Unable to serialize "+e)}function Ak(e){if(dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rt(Wl(jk(e)));throw new Error("Bad input format: expected Buffer or string")}var N0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function vW(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function _W(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var lT=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},cT=dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Co(t)})):lT(e)}:lT,dT=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(uo(e,i)));return n.join("").replace(Qn,"")},Fk=dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qn,""):dT(e,t,r)}:dT,uT=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},d8=dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):uT(e,t,r)}:uT,hT=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(qd(e,i)));return n.join("")},gp=dt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):hT(t,r,n)}:hT,u8=function(e,t){var r=Oa(e,t);return r>0?gp(e,t+4,t+4+r-1):""},h8=u8,f8=function(e,t){var r=Oa(e,t);return r>0?gp(e,t+4,t+4+r-1):""},p8=f8,m8=function(e,t){var r=2*Oa(e,t);return r>0?gp(e,t+4,t+4+r-1):""},g8=m8,x8=function(t,r){var n=Oa(t,r);return n>0?Fk(t,r+4,r+4+n):""},v8=x8,_8=function(e,t){var r=Oa(e,t);return r>0?gp(e,t+4,t+4+r):""},y8=_8,b8=function(e,t){return vW(e,t)},h1=b8,Dk=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};dt&&(h8=function(t,r){if(!Buffer.isBuffer(t))return u8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},p8=function(t,r){if(!Buffer.isBuffer(t))return f8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},g8=function(t,r){if(!Buffer.isBuffer(t))return m8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},v8=function(t,r){if(!Buffer.isBuffer(t))return x8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},y8=function(t,r){if(!Buffer.isBuffer(t))return _8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},h1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):b8(t,r)},Dk=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var qd=function(e,t){return e[t]},uo=function(e,t){return e[t+1]*256+e[t]},yW=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Oa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},kc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},bW=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function t0(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,dt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(uo(this,u)),u+=2;e*=2;break;case"utf8":r=gp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fk(this,this.l,this.l+e);break;case"wstr":return t0.call(this,e,"dbcs");case"lpstr-ansi":r=h8(this,this.l),e=4+Oa(this,this.l);break;case"lpstr-cp":r=p8(this,this.l),e=4+Oa(this,this.l);break;case"lpwstr":r=g8(this,this.l),e=4+2*Oa(this,this.l);break;case"lpp4":e=4+Oa(this,this.l),r=v8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Oa(this,this.l),r=y8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=qd(this,this.l+e++))!==0;)s.push(ym(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=uo(this,this.l+e))!==0;)s.push(ym(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=qd(this,u),this.l=u+1,l=t0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ym(uo(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=qd(this,u),this.l=u+1,l=t0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ym(qd(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=qd(this,this.l),this.l++,n;case 2:return n=(t==="i"?yW:uo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?kc:bW)(this,this.l),this.l+=4,n):(i=Oa(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=h1(this,this.l):i=h1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=d8(this,this.l,e);break}}return this.l+=e,r}var jW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},wW=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},kW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function SW(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)kW(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,jW(this,t,this.l);break;case 8:if(n=8,r==="f"){_W(this,t,this.l);break}case 16:break;case-4:n=4,wW(this,t,this.l);break}return this.l+=n,this}function j8(e,t){var r=d8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ln(e,t){e.l=t,e.read_shift=t0,e.chk=j8,e.write_shift=SW}function Mn(e,t){e.l+=t}function xe(e){var t=Nl(e);return ln(t,0),t}function $o(e,t,r){if(e){var n,i,s;ln(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=V0[l]||V0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var h=u.f&&u.f(e,s,r);if(e.l=c,t(h,u,l))return}}}function ja(){var e=[],t=dt?256:2048,r=function(u){var h=xe(u);return ln(h,0),h},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Yr(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function ye(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=V0[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Dk(r)&&e.push(r)}}function r0(e,t,r){var n=Kt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fT(e,t,r){var n=Kt(e);return n.s=r0(n.s,t.s,r),n.e=r0(n.e,t.s,r),n}function n0(e,t){if(e.cRel&&e.c<0)for(e=Kt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Kt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xe(e);return!e.cRel&&e.cRel!=null&&(r=EW(r)),!e.rRel&&e.rRel!=null&&(r=CW(r)),r}function hy(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tr(e.s.c)+":"+(e.e.cRel?"":"$")+tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+br(e.s.r)+":"+(e.e.rRel?"":"$")+br(e.e.r):n0(e.s,t.biff)+":"+n0(e.e,t.biff)}function Pk(e){return parseInt($W(e),10)-1}function br(e){return""+(e+1)}function CW(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $W(e){return e.replace(/\$(\d+)$/,"$1")}function Mk(e){for(var t=TW(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function EW(e){return e.replace(/^([A-Z])/,"$$$1")}function TW(e){return e.replace(/^\$([A-Z])/,"$1")}function AW(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Xe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wa(e){var t=e.indexOf(":");return t==-1?{s:rr(e),e:rr(e)}:{s:rr(e.slice(0,t)),e:rr(e.slice(t+1))}}function et(e,t){return typeof t>"u"||typeof t=="number"?et(e.s,e.e):(typeof e!="string"&&(e=Xe(e)),typeof t!="string"&&(t=Xe(t)),e==t?e:e+":"+t)}function yt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function pT(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ei(e.z,r?Ur(t):t)}catch{}try{return e.w=Ei((e.XF||{}).numFmtId||(r?14:0),r?Ur(t):t)}catch{return""+t}}function ko(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Eo[e.v]||e.v:t==null?pT(e,e.v):pT(e,t))}function Gl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function w8(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?rr(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=yt(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(u.e.r=o=h.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var _={v:t[f][m]},g=o+f,v=l+m;if(u.s.r>g&&(u.s.r=g),u.s.c>v&&(u.s.c=v),u.e.r<g&&(u.e.r=g),u.e.c<v&&(u.e.c=v),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))_=t[f][m];else if(Array.isArray(_.v)&&(_.f=t[f][m][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||Ke[14],n.cellDates?(_.t="d",_.w=Ei(_.z,Ur(_.v))):(_.t="n",_.v=Ur(_.v),_.w=Ei(_.z,_.v))):_.t="s";if(i)s[g]||(s[g]=[]),s[g][v]&&s[g][v].z&&(_.z=s[g][v].z),s[g][v]=_;else{var y=Xe({c:v,r:g});s[y]&&s[y].z&&(_.z=s[y].z),s[y]=_}}}return u.s.c<1e7&&(s["!ref"]=et(u)),s}function oh(e,t){return w8(null,e,t)}function FW(e){return e.read_shift(4,"i")}function es(e,t){return t||(t=xe(4)),t.write_shift(4,e),t}function Dn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qr(e,t){var r=!1;return t==null&&(r=!0,t=xe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function DW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function PW(e,t){return t||(t=xe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ok(e,t){var r=e.l,n=e.read_shift(1),i=Dn(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(DW(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function MW(e,t){var r=!1;return t==null&&(r=!0,t=xe(15+4*e.t.length)),t.write_shift(1,0),Qr(e.t,t),r?t.slice(0,t.l):t}var OW=Ok;function RW(e,t){var r=!1;return t==null&&(r=!0,t=xe(23+4*e.t.length)),t.write_shift(1,1),Qr(e.t,t),t.write_shift(4,1),PW({},t),r?t.slice(0,t.l):t}function Ai(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function _d(e,t){return t==null&&(t=xe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yd(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bd(e,t){return t==null&&(t=xe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var NW=Dn,k8=Qr;function Rk(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function f1(e,t){var r=!1;return t==null&&(r=!0,t=xe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zW=Dn,Mw=Rk,Nk=f1;function zk(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?h1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):kc(t,0)>>2;return r?i/100:i}function S8(e,t){t==null&&(t=xe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function C8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function IW(e,t){return t||(t=xe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var jd=C8,lh=IW;function $n(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ld(e,t){return(t||xe(8)).write_shift(8,e,"f")}function LW(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=Gc[i];u&&(t.rgb=I0(u));break;case 2:t.rgb=I0([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function p1(e,t){if(t||(t=xe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function BW(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function UW(e,t){t||(t=xe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function $8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function VW(e){return $8(e,1)}function HW(e){return $8(e,2)}var Ik=2,ha=3,jm=11,mT=12,m1=19,wm=64,WW=65,GW=71,qW=4108,KW=4126,qr=80,E8=81,XW=[qr,E8],Ow={1:{n:"CodePage",t:Ik},2:{n:"Category",t:qr},3:{n:"PresentationFormat",t:qr},4:{n:"ByteCount",t:ha},5:{n:"LineCount",t:ha},6:{n:"ParagraphCount",t:ha},7:{n:"SlideCount",t:ha},8:{n:"NoteCount",t:ha},9:{n:"HiddenCount",t:ha},10:{n:"MultimediaClipCount",t:ha},11:{n:"ScaleCrop",t:jm},12:{n:"HeadingPairs",t:qW},13:{n:"TitlesOfParts",t:KW},14:{n:"Manager",t:qr},15:{n:"Company",t:qr},16:{n:"LinksUpToDate",t:jm},17:{n:"CharacterCount",t:ha},19:{n:"SharedDoc",t:jm},22:{n:"HyperlinksChanged",t:jm},23:{n:"AppVersion",t:ha,p:"version"},24:{n:"DigSig",t:WW},26:{n:"ContentType",t:qr},27:{n:"ContentStatus",t:qr},28:{n:"Language",t:qr},29:{n:"Version",t:qr},255:{},2147483648:{n:"Locale",t:m1},2147483651:{n:"Behavior",t:m1},1919054434:{}},Rw={1:{n:"CodePage",t:Ik},2:{n:"Title",t:qr},3:{n:"Subject",t:qr},4:{n:"Author",t:qr},5:{n:"Keywords",t:qr},6:{n:"Comments",t:qr},7:{n:"Template",t:qr},8:{n:"LastAuthor",t:qr},9:{n:"RevNumber",t:qr},10:{n:"EditTime",t:wm},11:{n:"LastPrinted",t:wm},12:{n:"CreatedDate",t:wm},13:{n:"ModifiedDate",t:wm},14:{n:"PageCount",t:ha},15:{n:"WordCount",t:ha},16:{n:"CharCount",t:ha},17:{n:"Thumbnail",t:GW},18:{n:"Application",t:qr},19:{n:"DocSecurity",t:ha},255:{},2147483648:{n:"Locale",t:m1},2147483651:{n:"Behavior",t:m1},1919054434:{}},gT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},YW=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QW(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var JW=QW([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gc=Kt(JW),Eo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},T8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Nw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},km={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Lk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ZW(e){var t=Lk();if(!e||!e.match)return t;var r={};if((e.match(Rn)||[]).forEach(function(n){var i=Ye(n);switch(i[0].replace(cW,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Nw[i.ContentType]]!==void 0&&t[Nw[i.ContentType]].push(i.PartName);break}}),t.xmlns!==zr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function A8(e,t){var r=ZH(Nw),n=[],i;n[n.length]=jr,n[n.length]=$e("Types",null,{xmlns:zr.CT,"xmlns:xsd":zr.xsd,"xmlns:xsi":zr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return $e("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=$e("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:km[c][t.bookType]||km[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:km[c][t.bookType]||km[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ut={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function z0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function a0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Rn)||[]).forEach(function(i){var s=Ye(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Lf(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function gu(e){var t=[jr,$e("Relationships",null,{xmlns:zr.RELS})];return pr(e["!id"]).forEach(function(r){t[t.length]=$e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ft(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[ut.HLINK,ut.XPATH,ut.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var eG="application/vnd.oasis.opendocument.spreadsheet";function tG(e,t){for(var r=Ak(e),n,i;n=N0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ye(n[0],!1),i.path=="/"&&i.type!==eG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function rG(e){var t=[jr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function xT(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function nG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function aG(e){var t=[jr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(xT(e[r][0],e[r][1])),t.push(nG("",e[r][0]));return t.push(xT("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function F8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+o1.version+"</meta:generator></office:meta></office:document-meta>"}var ki=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],iG=function(){for(var e=new Array(ki.length),t=0;t<ki.length;++t){var r=ki[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function D8(e){var t={};e=Rt(e);for(var r=0;r<ki.length;++r){var n=ki[r],i=e.match(iG[r]);i!=null&&i.length>0&&(t[n[1]]=_t(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=qt(t[n[1]]))}return t}function fy(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Mt(t),n[n.length]=r?$e(e,t,r):cn(e,t))}function P8(e,t){var r=t||{},n=[jr,$e("cp:coreProperties",null,{"xmlns:cp":zr.CORE_PROPS,"xmlns:dc":zr.dc,"xmlns:dcterms":zr.dcterms,"xmlns:dcmitype":zr.dcmitype,"xmlns:xsi":zr.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&fy("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Pw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&fy("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Pw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ki.length;++s){var o=ki[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&fy(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],M8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function O8(e,t,r,n){var i=[];if(typeof e=="string")i=oT(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(h){return{v:h}}));var o=typeof t=="string"?oT(t,n).map(function(h){return h.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function sG(e,t,r){var n={};return t||(t={}),e=Rt(e),qc.forEach(function(i){var s=(e.match(O0(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=_t(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&O8(n.HeadingPairs,n.TitlesOfParts,t,r),t}function R8(e){var t=[],r=$e;return e||(e={}),e.Application="SheetJS",t[t.length]=jr,t[t.length]=$e("Properties",null,{xmlns:zr.EXT_PROPS,"xmlns:vt":zr.vt}),qc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Mt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var oG=/<[^>]+>[^<]*/g;function lG(e,t){var r={},n="",i=e.match(oG);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Ye(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=_t(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),h=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=_t(h);break;case"bool":r[n]=Wt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=qt(h);break;case"cy":case"error":r[n]=_t(h);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function N8(e){var t=[jr,$e("Properties",null,{xmlns:zr.CUST_PROPS,"xmlns:vt":zr.vt})];if(!e)return t.join("");var r=1;return pr(e).forEach(function(i){++r,t[t.length]=$e("property",xW(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Mt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var zw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},py;function cG(e,t,r){py||(py=av(zw)),t=py[t]||t,e[t]=r}function dG(e,t){var r=[];return pr(zw).map(function(n){for(var i=0;i<ki.length;++i)if(ki[i][1]==n)return ki[i];for(i=0;i<qc.length;++i)if(qc[i][1]==n)return qc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(cn(zw[n[1]]||n[1],i))}}),$e("DocumentProperties",r.join(""),{xmlns:Ma.o})}function uG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&pr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<ki.length;++o)if(s==ki[o][1])return;for(o=0;o<qc.length;++o)if(s==qc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push($e(nT(s),l,{"dt:dt":c}))}}),t&&pr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push($e(nT(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Ma.o+'">'+i.join("")+"</"+n+">"}function Bk(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function hG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=xe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function z8(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function I8(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function L8(e,t,r){return t===31?I8(e):z8(e,t,r)}function Iw(e,t,r){return L8(e,t,r===!1?0:4)}function fG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return L8(e,t,0)}function pG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Qn,""),e.l-i&2&&(e.l+=2)}return r}function mG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Qn,"");return r}function gG(e){var t=e.l,r=g1(e,E8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=g1(e,ha);return[r,n]}function xG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(gG(e));return r}function vT(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Qn,"").replace(If,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function B8(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function vG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function g1(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==mT&&n!==t&&XW.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===mT?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return z8(e,n,4).replace(Qn,"");case 31:return I8(e);case 64:return Bk(e);case 65:return B8(e);case 71:return vG(e);case 80:return Iw(e,n,!s.raw).replace(Qn,"");case 81:return fG(e,n).replace(Qn,"");case 4108:return xG(e);case 4126:case 4127:return n==4127?pG(e):mG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function _T(e,t){var r=xe(4),n=xe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=xe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=hG(t);break;case 31:case 80:for(n=xe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yr([r,n])}function yT(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var h=e.read_shift(4),f=e.read_shift(4);s[o]=[h,f+r]}s.sort(function(x,j){return x[1]-j[1]});var m={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var _=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(_=!1,e.l=s[o][1]),_)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[s[o][0]];if(m[g.n]=g1(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ki(l=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(s[o][0]===1){if(l=m.CodePage=g1(e,Ik),Ki(l),c!==-1){var v=e.l;e.l=s[c][1],u=vT(e,l),e.l=v}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=vT(e,l)}else{var y=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=B8(e);break;case 30:e.l+=4,b=Iw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Iw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=xr(e,4);break;case 64:e.l+=4,b=qt(Bk(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[y]=b}}return e.l=r+n,m}var U8=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function _G(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bT(e,t,r){var n=xe(8),i=[],s=[],o=8,l=0,c=xe(8),u=xe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=xe(8),u.write_shift(4,0),i.unshift(u);var h=[xe(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=xe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Yr(h),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(U8.indexOf(e[l][0])>-1||M8.indexOf(e[l][0])>-1)&&e[l][1]!=null){var m=e[l][1],_=0;if(t){_=+t[e[l][0]];var g=r[_];if(g.p=="version"&&typeof m=="string"){var v=m.split(".");m=(+v[0]<<16)+(+v[1]||0)}c=_T(g.t,m)}else{var y=_G(m);y==-1&&(y=31,m=String(m)),c=_T(y,m)}s.push(c),u=xe(8),u.write_shift(4,t?_:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Yr([n].concat(i).concat(s))}function jT(e,t,r){var n=e.content;if(!n)return{};ln(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==Ge.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=yT(n,t),m={SystemIdentifier:u};for(var _ in f)m[_]=f[_];if(m.FMTID=s,i===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=yT(n,null)}catch{}for(_ in g)m[_]=g[_];return m.FMTID=[s,o],m}function wT(e,t,r,n,i,s){var o=xe(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ge.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=bT(e,r,n);if(l.push(c),i){var u=bT(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Yr(l)}function Ho(e,t){return e.read_shift(t),null}function yG(e,t){t||(t=xe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function bG(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function xr(e,t){return e.read_shift(t)===1}function Kn(e,t){return t||(t=xe(2)),t.write_shift(2,+!!e),t}function Tr(e){return e.read_shift(2,"u")}function gi(e,t){return t||(t=xe(2)),t.write_shift(2,e),t}function V8(e,t){return bG(e,t,Tr)}function jG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function H8(e,t,r){return r||(r=xe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function xp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function wG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=h,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function kG(e){var t=e.t||"",r=xe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=xe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Yr(i)}function cd(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function vp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):cd(e,n,r)}function wd(e,t,r){if(r.biff>5)return vp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function W8(e,t,r){return r||(r=xe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function SG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function CG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Qn,"");return n&&(e.l+=24),i}function $G(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Qn,"");return r+o}function EG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return CG(e);case"0303000000000000c000000000000046":return $G(e);default:throw new Error("Unsupported Moniker "+r)}}function Sm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Qn,""):"";return r}function kT(e,t){t||(t=xe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function TG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",h,f;i&16&&(s=Sm(e,r-e.l)),i&128&&(o=Sm(e,r-e.l)),(i&257)===257&&(l=Sm(e,r-e.l)),(i&257)===1&&(c=EG(e,r-e.l)),i&8&&(u=Sm(e,r-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(f=Bk(e)),e.l=r;var m=o||l||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var _={Target:m};return h&&(_.guid=h),f&&(_.time=f),s&&(_.Tooltip=s),_}function AG(e){var t=xe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),kT(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&kT(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function G8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function q8(e,t){var r=G8(e);return r[3]=0,r}function Ms(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function dd(e,t,r,n){return n||(n=xe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function FG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function DG(e,t,r){return t===0?"":wd(e,t,r)}function PG(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function K8(e){var t=e.read_shift(2),r=zk(e);return[t,r]}function MG(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=xp(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function ov(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function X8(e,t){return t||(t=xe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Y8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var OG=Y8;function Q8(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function RG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function NG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function vn(e){e.l+=2,e.l+=e.read_shift(2)}var zG={0:vn,4:vn,5:vn,6:vn,7:NG,8:vn,9:vn,10:vn,11:vn,12:vn,13:RG,14:vn,15:vn,16:vn,17:vn,18:vn,19:vn,20:vn,21:Q8};function IG(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(zG[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Cm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Uk(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=xe(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function LG(e,t){return t===0||e.read_shift(2),1200}function BG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=wd(e,0,r);return e.read_shift(t+n-e.l),i}function UG(e,t){var r=!t||t.biff==8,n=xe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function VG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function HG(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=xp(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function WG(e,t){var r=!t||t.biff>=8?2:1,n=xe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function GG(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(wG(e));return s.Count=n,s.Unique=i,s}function qG(e,t){var r=xe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=kG(e[i]);var s=Yr([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function KG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function XG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function YG(e){var t=FG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function QG(e){return e.read_shift(2),e.read_shift(4)}function ST(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function JG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function ZG(){var e=xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function eq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function tq(e){var t=xe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function rq(){}function nq(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=xp(e,0,r),n}function aq(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=xe(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function iq(e){var t=Ms(e);return t.isst=e.read_shift(4),t}function sq(e,t,r,n){var i=xe(10);return dd(e,t,n,i),i.write_shift(4,r),i}function oq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Ms(e);r.biff==2&&e.l++;var s=vp(e,n-e.l,r);return i.val=s,i}function lq(e,t,r,n,i){var s=!i||i.biff==8,o=xe(8+ +s+(1+s)*r.length);return dd(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function cq(e,t,r){var n=e.read_shift(2),i=wd(e,0,r);return[n,i]}function dq(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var uq=wd;function CT(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function hq(e,t){var r=t.biff==8||!t.biff?4:2,n=xe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function fq(e){var t=e.read_shift(2),r=e.read_shift(2),n=K8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function pq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(K8(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function mq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function gq(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=YW[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function xq(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=gq(e,t,n.fStyle,r),n}function $T(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function vq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function _q(e){var t=xe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ET(e,t,r){var n=Ms(e);(r.biff==2||t==9)&&++e.l;var i=jG(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function yq(e,t,r,n,i,s){var o=xe(8);return dd(e,t,n,o),H8(r,s,o),o}function bq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ms(e),i=$n(e);return n.val=i,n}function jq(e,t,r,n){var i=xe(14);return dd(e,t,n,i),ld(r,i),i}var TT=DG;function wq(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=cd(e,s),l=[];n>e.l;)l.push(vp(e));return[s,i,o,l]}function AT(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=MG(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var kq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function FT(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=cd(e,o,r);i&32&&(u=kq[u.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var f=n==e.l||l===0||!(h>0)?[]:IQ(e,h,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function J8(e,t,r){if(r.biff<8)return Sq(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(PG(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Sq(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=xp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Cq(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=cd(e,n,r),o=cd(e,i,r);return[s,o]}function $q(e,t,r){var n=Y8(e);e.l++;var i=e.read_shift(1);return t-=8,[LQ(e,t,r),i,n]}function DT(e,t,r){var n=OG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,NQ(e,t,r)]}function Eq(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Tq(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=wd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function Aq(e,t,r){return Tq(e,t,r)}function Fq(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ov(e));return r}function Dq(e){var t=xe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)X8(e[r],t);return t}function Pq(e,t,r){if(r&&r.biff<8)return Oq(e,t,r);var n=Q8(e),i=IG(e,t-22,n[1]);return{cmo:n,ft:i}}var Mq={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Oq(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Mq[n]||Mn)(e,t,r)),{cmo:[i,n,s],ft:o}}function Rq(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=SG(e,6,r);var l=e.read_shift(2);e.read_shift(2),Tr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var h=e[e.l],f=cd(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(h?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Nq(e,t){var r=ov(e);e.l+=16;var n=TG(e,t-24);return[r,n]}function zq(e){var t=xe(24),r=rr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Yr([t,AG(e[1])])}function Iq(e,t){e.read_shift(2);var r=ov(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Qn,""),[r,n]}function Lq(e){var t=e[1].Tooltip,r=xe(10+2*(t.length+1));r.write_shift(2,2048);var n=rr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Bq(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=gT[r]||r,r=e.read_shift(2),t[1]=gT[r]||r,t}function Uq(e){return e||(e=xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Vq(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(q8(e));return r}function Hq(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(q8(e));return r}function Wq(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Z8(e,t,r){if(!r.cellStyles)return Mn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Gq(e,t){var r=xe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function qq(e,t){var r={};return t<32||(e.l+=16,r.header=$n(e),r.footer=$n(e),e.l+=2),r}function Kq(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function Xq(e){for(var t=xe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Yq=Ms,Qq=V8,Jq=vp;function Zq(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function eK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ms(e);++e.l;var i=wd(e,t-7,r);return n.t="str",n.val=i,n}function tK(e){var t=Ms(e);++e.l;var r=$n(e);return t.t="n",t.val=r,t}function rK(e,t,r){var n=xe(15);return jp(n,e,t),n.write_shift(8,r,"f"),n}function nK(e){var t=Ms(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function aK(e,t,r){var n=xe(9);return jp(n,e,t),n.write_shift(2,r),n}function iK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function sK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function oK(e,t,r){var n=e.l+t,i=Ms(e),s=e.read_shift(2),o=cd(e,s,r);return e.l=n,i.t="str",i.val=o,i}var lK=[2,3,48,49,131,139,140,245],Lw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=av({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],h=Nl(1);switch(c.type){case"base64":h=Ra(Ua(l));break;case"binary":h=Ra(l);break;case"buffer":case"array":h=l;break}ln(h,0);var f=h.read_shift(1),m=!!(f&136),_=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:_=!0,m=!0;break;case 49:_=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,y=521;f==2&&(v=h.read_shift(2)),h.l+=3,f!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(y=h.read_shift(2));var b=h.read_shift(2),x=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(x=e[h[h.l]]),h.l+=1,h.l+=2),g&&(h.l+=36);for(var j=[],S={},T=Math.min(h.length,f==2?521:y-10-(_?264:0)),F=g?32:11;h.l<T&&h[h.l]!=13;)switch(S={},S.name=D0.utils.decode(x,h.slice(h.l,h.l+F)).replace(/[\u0000\r\n].*$/g,""),h.l+=F,S.type=String.fromCharCode(h.read_shift(1)),f!=2&&!g&&(S.offset=h.read_shift(4)),S.len=h.read_shift(1),f==2&&(S.offset=h.read_shift(2)),S.dec=h.read_shift(1),S.name.length&&j.push(S),f!=2&&(h.l+=g?13:14),S.type){case"B":(!_||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var w=0,P=0;for(u[0]=[],P=0;P!=j.length;++P)u[0][P]=j[P].name;for(;v-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,u[++w]=[],P=0,P=0;P!=j.length;++P){var M=h.slice(h.l,h.l+j[P].len);h.l+=j[P].len,ln(M,0);var A=D0.utils.decode(x,M);switch(j[P].type){case"C":A.trim().length&&(u[w][P]=A.replace(/\s+$/,""));break;case"D":A.length===8?u[w][P]=new Date(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8)):u[w][P]=A;break;case"F":u[w][P]=parseFloat(A.trim());break;case"+":case"I":u[w][P]=g?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(A.trim().toUpperCase()){case"Y":case"T":u[w][P]=!0;break;case"N":case"F":u[w][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+A+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[w][P]="##MEMO##"+(g?parseInt(A.trim(),10):M.read_shift(4));break;case"N":A=A.replace(/\u0000/g,"").trim(),A&&A!="."&&(u[w][P]=+A||0);break;case"@":u[w][P]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[w][P]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[w][P]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][P]=-M.read_shift(-8,"f");break;case"B":if(_&&j[P].len==8){u[w][P]=M.read_shift(8,"f");break}case"G":case"P":M.l+=j[P].len;break;case"0":if(j[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[P].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=j,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var h=oh(r(l,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(l,c){try{return Gl(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Ki(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=ja(),f=_1(l,{header:1,raw:!0,cellDates:!0}),m=f[0],_=f.slice(1),g=l["!cols"]||[],v=0,y=0,b=0,x=1;for(v=0;v<m.length;++v){if(((g[v]||{}).DBF||{}).name){m[v]=g[v].DBF.name,++b;continue}if(m[v]!=null){if(++b,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(y=0;y<1024;++y)if(m.indexOf(m[v]+"_"+y)==-1){m[v]+="_"+y;break}}}}var j=yt(l["!ref"]),S=[],T=[],F=[];for(v=0;v<=j.e.c-j.s.c;++v){var w="",P="",M=0,A=[];for(y=0;y<_.length;++y)_[y][v]!=null&&A.push(_[y][v]);if(A.length==0||m[v]==null){S[v]="?";continue}for(y=0;y<A.length;++y){switch(typeof A[y]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=A[y]instanceof Date?"D":"C";break;default:P="C"}M=Math.max(M,String(A[y]).length),w=w&&w!=P?"C":P}M>250&&(M=250),P=((g[v]||{}).DBF||{}).type,P=="C"&&g[v].DBF.len>M&&(M=g[v].DBF.len),w=="B"&&P=="N"&&(w="N",F[v]=g[v].DBF.dec,M=g[v].DBF.len),T[v]=w=="C"||P=="N"?M:s[w]||0,x+=T[v],S[v]=w}var D=h.next(32);for(D.write_shift(4,318902576),D.write_shift(4,_.length),D.write_shift(2,296+32*b),D.write_shift(2,x),v=0;v<4;++v)D.write_shift(4,0);for(D.write_shift(4,0|(+t[UP]||3)<<8),v=0,y=0;v<m.length;++v)if(m[v]!=null){var H=h.next(32),U=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,U,"sbcs"),H.write_shift(1,S[v]=="?"?"C":S[v],"sbcs"),H.write_shift(4,y),H.write_shift(1,T[v]||s[S[v]]||0),H.write_shift(1,F[v]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),y+=T[v]||s[S[v]]||0}var W=h.next(264);for(W.write_shift(4,13),v=0;v<65;++v)W.write_shift(4,0);for(v=0;v<_.length;++v){var R=h.next(x);for(R.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(S[y]){case"L":R.write_shift(1,_[v][y]==null?63:_[v][y]?84:70);break;case"B":R.write_shift(8,_[v][y]||0,"f");break;case"N":var ae="0";for(typeof _[v][y]=="number"&&(ae=_[v][y].toFixed(F[y]||0)),b=0;b<T[y]-ae.length;++b)R.write_shift(1,32);R.write_shift(1,ae,"sbcs");break;case"D":_[v][y]?(R.write_shift(4,("0000"+_[v][y].getFullYear()).slice(-4),"sbcs"),R.write_shift(2,("00"+(_[v][y].getMonth()+1)).slice(-2),"sbcs"),R.write_shift(2,("00"+_[v][y].getDate()).slice(-2),"sbcs")):R.write_shift(8,"00000000","sbcs");break;case"C":var le=String(_[v][y]!=null?_[v][y]:"").slice(0,T[y]);for(R.write_shift(1,le,"sbcs"),b=0;b<T[y]-le.length;++b)R.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),eM=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,_){var g=e[_];return typeof g=="number"?VE(g):g},n=function(m,_,g){var v=_.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?m:VE(v)};e["|"]=254;function i(m,_){switch(_.type){case"base64":return s(Ua(m),_);case"binary":return s(m,_);case"buffer":return s(dt&&Buffer.isBuffer(m)?m.toString("binary"):Wl(m),_);case"array":return s(od(m),_)}throw new Error("Unrecognized type "+_.type)}function s(m,_){var g=m.split(/[\n\r]+/),v=-1,y=-1,b=0,x=0,j=[],S=[],T=null,F={},w=[],P=[],M=[],A=0,D;for(+_.codepage>=0&&Ki(+_.codepage);b!==g.length;++b){A=0;var H=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=H.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),W=U[0],R;if(H.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&S.push(H.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,le=!1,G=!1,z=!1,ie=-1,ne=-1;for(x=1;x<U.length;++x)switch(U[x].charAt(0)){case"A":break;case"X":y=parseInt(U[x].slice(1))-1,le=!0;break;case"Y":for(v=parseInt(U[x].slice(1))-1,le||(y=0),D=j.length;D<=v;++D)j[D]=[];break;case"K":R=U[x].slice(1),R.charAt(0)==='"'?R=R.slice(1,R.length-1):R==="TRUE"?R=!0:R==="FALSE"?R=!1:isNaN(Zi(R))?isNaN(qu(R).getDate())||(R=qt(R)):(R=Zi(R),T!==null&&ih(T)&&(R=sv(R))),ae=!0;break;case"E":z=!0;var O=xu(U[x].slice(1),{r:v,c:y});j[v][y]=[j[v][y],O];break;case"S":G=!0,j[v][y]=[j[v][y],"S5S"];break;case"G":break;case"R":ie=parseInt(U[x].slice(1))-1;break;case"C":ne=parseInt(U[x].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+H)}if(ae&&(j[v][y]&&j[v][y].length==2?j[v][y][0]=R:j[v][y]=R,T=null),G){if(z)throw new Error("SYLK shared formula cannot have own formula");var N=ie>-1&&j[ie][ne];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");j[v][y][1]=vM(N[1],{r:v-ie,c:y-ne})}break;case"F":var L=0;for(x=1;x<U.length;++x)switch(U[x].charAt(0)){case"X":y=parseInt(U[x].slice(1))-1,++L;break;case"Y":for(v=parseInt(U[x].slice(1))-1,D=j.length;D<=v;++D)j[D]=[];break;case"M":A=parseInt(U[x].slice(1))/20;break;case"F":break;case"G":break;case"P":T=S[parseInt(U[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=U[x].slice(1).split(" "),D=parseInt(M[0],10);D<=parseInt(M[1],10);++D)A=parseInt(M[2],10),P[D-1]=A===0?{hidden:!0}:{wch:A},zl(P[D-1]);break;case"C":y=parseInt(U[x].slice(1))-1,P[y]||(P[y]={});break;case"R":v=parseInt(U[x].slice(1))-1,w[v]||(w[v]={}),A>0?(w[v].hpt=A,w[v].hpx=Xu(A)):A===0&&(w[v].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+H)}L<1&&(T=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+H)}}return w.length>0&&(F["!rows"]=w),P.length>0&&(F["!cols"]=P),_&&_.sheetRows&&(j=j.slice(0,_.sheetRows)),[j,F]}function o(m,_){var g=i(m,_),v=g[0],y=g[1],b=oh(v,_);return pr(y).forEach(function(x){b[x]=y[x]}),b}function l(m,_){return Gl(o(m,_),_)}function c(m,_,g,v){var y="C;Y"+(g+1)+";X"+(v+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+Kk(m.f,{r:g,c:v}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(m,_){_.forEach(function(g,v){var y="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=L0(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=B0(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function h(m,_){_.forEach(function(g,v){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*U0(g.hpx)+";"),y.length>2&&m.push(y+"R"+(v+1))})}function f(m,_){var g=["ID;PWXL;N;E"],v=[],y=yt(m["!ref"]),b,x=Array.isArray(m),j=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&u(g,m["!cols"]),m["!rows"]&&h(g,m["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var T=y.s.c;T<=y.e.c;++T){var F=Xe({r:S,c:T});b=x?(m[S]||[])[T]:m[F],!(!b||b.v==null&&(!b.f||b.F))&&v.push(c(b,m,S,T))}return g.join(j)+j+v.join(j)+j+"E"+j}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),tM=function(){function e(s,o){switch(o.type){case"base64":return t(Ua(s),o);case"binary":return t(s,o);case"buffer":return t(dt&&Buffer.isBuffer(s)?s.toString("binary"):Wl(s),o);case"array":return t(od(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,h=0,f=[];h!==l.length;++h){if(l[h].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=l[h].trim().split(","),_=m[0],g=m[1];++h;for(var v=l[h]||"";(v.match(/["]/g)||[]).length&1&&h<l.length-1;)v+=`
`+l[++h];switch(v=v.trim(),+_){case-1:if(v==="BOT"){f[++c]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[c][u]=!0:v==="FALSE"?f[c][u]=!1:isNaN(Zi(g))?isNaN(qu(g).getDate())?f[c][u]=g:f[c][u]=qt(g):f[c][u]=Zi(g),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[c][u++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return oh(e(s,o),o)}function n(s,o){return Gl(r(s,o),o)}var i=function(){var s=function(c,u,h,f,m){c.push(u),c.push(h+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,u,h,f){c.push(u+","+h),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],h=yt(c["!ref"]),f,m=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var _=h.s.r;_<=h.e.r;++_){o(u,-1,0,"BOT");for(var g=h.s.c;g<=h.e.c;++g){var v=Xe({r:_,c:g});if(f=m?(c[_]||[])[g]:c[v],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ei(f.z||Ke[14],Ur(qt(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,x=u.join(b);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),rM=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var _=f.split(`
`),g=-1,v=-1,y=0,b=[];y!==_.length;++y){var x=_[y].trim().split(":");if(x[0]==="cell"){var j=rr(x[1]);if(b.length<=j.r)for(g=b.length;g<=j.r;++g)b[g]||(b[g]=[]);switch(g=j.r,v=j.c,x[2]){case"t":b[g][v]=e(x[3]);break;case"v":b[g][v]=+x[3];break;case"vtf":var S=x[x.length-1];case"vtc":switch(x[3]){case"nl":b[g][v]=!!+x[4];break;default:b[g][v]=+x[4];break}x[2]=="vtf"&&(b[g][v]=[b[g][v],S])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function n(f,m){return oh(r(f,m),m)}function i(f,m){return Gl(n(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],_=[],g,v="",y=wa(f["!ref"]),b=Array.isArray(f),x=y.s.r;x<=y.e.r;++x)for(var j=y.s.c;j<=y.e.c;++j)if(v=Xe({r:x,c:j}),g=b?(f[x]||[])[j]:f[v],!(!g||g.v==null||g.t==="z")){switch(_=["cell",v,"t"],g.t){case"s":case"str":_.push(t(g.v));break;case"n":g.f?(_[2]="vtf",_[3]="n",_[4]=g.v,_[5]=t(g.f)):(_[2]="v",_[3]=g.v);break;case"b":_[2]="vt"+(g.f?"f":"c"),_[3]="nl",_[4]=g.v?"1":"0",_[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var S=Ur(qt(g.v));_[2]="vtc",_[3]="nd",_[4]=""+S,_[5]=g.w||Ei(g.z||Ke[14],S);break;case"e":continue}m.push(_.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),Ku=function(){function e(h,f,m,_,g){g.raw?f[m][_]=h:h===""||(h==="TRUE"?f[m][_]=!0:h==="FALSE"?f[m][_]=!1:isNaN(Zi(h))?isNaN(qu(h).getDate())?f[m][_]=h:f[m][_]=qt(h):f[m][_]=Zi(h))}function t(h,f){var m=f||{},_=[];if(!h||h.length===0)return _;for(var g=h.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var y=10,b=0,x=0;x<=v;++x)b=g[x].indexOf(" "),b==-1?b=g[x].length:b++,y=Math.max(y,b);for(x=0;x<=v;++x){_[x]=[];var j=0;for(e(g[x].slice(0,y).trim(),_,x,j,m),j=1;j<=(g[x].length-y)/10+1;++j)e(g[x].slice(y+(j-1)*10,y+j*10).trim(),_,x,j,m)}return m.sheetRows&&(_=_.slice(0,m.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},m=!1,_=0,g=0;_<h.length;++_)(g=h.charCodeAt(_))==34?m=!m:!m&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&g.push([f[_],_]);if(!g.length){f=n;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&g.push([f[_],_])}return g.sort(function(v,y){return v[0]-y[0]||n[v[1]]-n[y[1]]}),r[g.pop()[1]]||44}function s(h,f){var m=f||{},_="",g=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(_=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(_=h.charAt(4),h=h.slice(6)):_=i(h.slice(0,1024)):m&&m.FS?_=m.FS:_=i(h.slice(0,1024));var y=0,b=0,x=0,j=0,S=0,T=_.charCodeAt(0),F=!1,w=0,P=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=m.dateNF!=null?KH(m.dateNF):null;function A(){var D=h.slice(j,S),H={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)H.t="z";else if(m.raw)H.t="s",H.v=D;else if(D.trim().length===0)H.t="s",H.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(H.t="s",H.v=D.slice(2,-1).replace(/""/g,'"')):wY(D)?(H.t="n",H.f=D.slice(1)):(H.t="s",H.v=D);else if(D=="TRUE")H.t="b",H.v=!0;else if(D=="FALSE")H.t="b",H.v=!1;else if(!isNaN(x=Zi(D)))H.t="n",m.cellText!==!1&&(H.w=D),H.v=x;else if(!isNaN(qu(D).getDate())||M&&D.match(M)){H.z=m.dateNF||Ke[14];var U=0;M&&D.match(M)&&(D=XH(D,m.dateNF,D.match(M)||[]),U=1),m.cellDates?(H.t="d",H.v=qt(D,U)):(H.t="n",H.v=Ur(qt(D,U))),m.cellText!==!1&&(H.w=Ei(H.z,H.v instanceof Date?Ur(H.v):H.v)),m.cellNF||delete H.z}else H.t="s",H.v=D;if(H.t=="z"||(m.dense?(g[y]||(g[y]=[]),g[y][b]=H):g[Xe({c:b,r:y})]=H),j=S+1,P=h.charCodeAt(j),v.e.c<b&&(v.e.c=b),v.e.r<y&&(v.e.r=y),w==T)++b;else if(b=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;S<h.length;++S)switch(w=h.charCodeAt(S)){case 34:P===34&&(F=!F);break;case T:case 10:case 13:if(!F&&A())break e;break}return S-j>0&&A(),g["!ref"]=et(v),g}function o(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):oh(t(h,f),f)}function l(h,f){var m="",_=f.type=="string"?[0,0,0,0]:rS(h,f);switch(f.type){case"base64":m=Ua(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):f.codepage&&typeof D0<"u"||(m=dt&&Buffer.isBuffer(h)?h.toString("binary"):Wl(h));break;case"array":m=od(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return _[0]==239&&_[1]==187&&_[2]==191?m=Rt(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=Rt(m):f.type=="binary"&&typeof D0<"u",m.slice(0,19)=="socialcalc:version:"?rM.to_sheet(f.type=="string"?m:Rt(m),f):o(m,f)}function c(h,f){return Gl(l(h,f),f)}function u(h){for(var f=[],m=yt(h["!ref"]),_,g=Array.isArray(h),v=m.s.r;v<=m.e.r;++v){for(var y=[],b=m.s.c;b<=m.e.c;++b){var x=Xe({r:v,c:b});if(_=g?(h[v]||[])[b]:h[x],!_||_.v==null){y.push("          ");continue}for(var j=(_.w||(ko(_),_.w)||"").slice(0,10);j.length<10;)j+=" ";y.push(j+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function cK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=eM.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ku.to_workbook(e,t)}}var Kc=function(){function e(O,N,L){if(O){ln(O,O.l||0);for(var K=L.Enum||ie;O.l<O.length;){var re=O.read_shift(2),Z=K[re]||K[65535],me=O.read_shift(2),B=O.l+me,se=Z.f&&Z.f(O,me,L);if(O.l=B,N(se,Z,re))return}}}function t(O,N){switch(N.type){case"base64":return r(Ra(Ua(O)),N);case"binary":return r(Ra(O),N);case"buffer":case"array":return r(O,N)}throw"Unsupported type "+N.type}function r(O,N){if(!O)return O;var L=N||{},K=L.dense?[]:{},re="Sheet1",Z="",me=0,B={},se=[],we=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ce=L.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)L.Enum=ie,e(O,function(_e,wt,Vr){switch(Vr){case 0:L.vers=_e,_e>=4096&&(L.qpro=!0);break;case 6:V=_e;break;case 204:_e&&(Z=_e);break;case 222:Z=_e;break;case 15:case 51:L.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Vr==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=L.dateNF||Ke[14],L.cellDates&&(_e[1].t="d",_e[1].v=sv(_e[1].v))),L.qpro&&_e[3]>me&&(K["!ref"]=et(V),B[re]=K,se.push(re),K=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},me=_e[3],re=Z||"Sheet"+(me+1),Z="");var pn=L.dense?(K[_e[0].r]||[])[_e[0].c]:K[Xe(_e[0])];if(pn){pn.t=_e[1].t,pn.v=_e[1].v,_e[1].z!=null&&(pn.z=_e[1].z),_e[1].f!=null&&(pn.f=_e[1].f);break}L.dense?(K[_e[0].r]||(K[_e[0].r]=[]),K[_e[0].r][_e[0].c]=_e[1]):K[Xe(_e[0])]=_e[1];break}},L);else if(O[2]==26||O[2]==14)L.Enum=ne,O[2]==14&&(L.qpro=!0,O.l=0),e(O,function(_e,wt,Vr){switch(Vr){case 204:re=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>me&&(K["!ref"]=et(V),B[re]=K,se.push(re),K=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},me=_e[3],re="Sheet"+(me+1)),Ce>0&&_e[0].r>=Ce)break;L.dense?(K[_e[0].r]||(K[_e[0].r]=[]),K[_e[0].r][_e[0].c]=_e[1]):K[Xe(_e[0])]=_e[1],V.e.c<_e[0].c&&(V.e.c=_e[0].c),V.e.r<_e[0].r&&(V.e.r=_e[0].r);break;case 27:_e[14e3]&&(we[_e[14e3][0]]=_e[14e3][1]);break;case 1537:we[_e[0]]=_e[1],_e[0]==me&&(re=_e[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(K["!ref"]=et(V),B[Z||re]=K,se.push(Z||re),!we.length)return{SheetNames:se,Sheets:B};for(var qe={},Te=[],E=0;E<we.length;++E)B[se[E]]?(Te.push(we[E]||se[E]),qe[we[E]]=B[we[E]]||B[se[E]]):(Te.push(we[E]),qe[we[E]]={"!ref":"A1"});return{SheetNames:Te,Sheets:qe}}function n(O,N){var L=N||{};if(+L.codepage>=0&&Ki(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var K=ja(),re=yt(O["!ref"]),Z=Array.isArray(O),me=[];Ee(K,0,s(1030)),Ee(K,6,c(re));for(var B=Math.min(re.e.r,8191),se=re.s.r;se<=B;++se)for(var we=br(se),V=re.s.c;V<=re.e.c;++V){se===re.s.r&&(me[V]=tr(V));var Ce=me[V]+we,qe=Z?(O[se]||[])[V]:O[Ce];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?Ee(K,13,_(se,V,qe.v)):Ee(K,14,v(se,V,qe.v));else{var Te=ko(qe);Ee(K,15,f(se,V,Te.slice(0,239)))}}return Ee(K,1),K.end()}function i(O,N){var L=N||{};if(+L.codepage>=0&&Ki(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var K=ja();Ee(K,0,o(O));for(var re=0,Z=0;re<O.SheetNames.length;++re)(O.Sheets[O.SheetNames[re]]||{})["!ref"]&&Ee(K,27,z(O.SheetNames[re],Z++));var me=0;for(re=0;re<O.SheetNames.length;++re){var B=O.Sheets[O.SheetNames[re]];if(!(!B||!B["!ref"])){for(var se=yt(B["!ref"]),we=Array.isArray(B),V=[],Ce=Math.min(se.e.r,8191),qe=se.s.r;qe<=Ce;++qe)for(var Te=br(qe),E=se.s.c;E<=se.e.c;++E){qe===se.s.r&&(V[E]=tr(E));var _e=V[E]+Te,wt=we?(B[qe]||[])[E]:B[_e];if(!(!wt||wt.t=="z"))if(wt.t=="n")Ee(K,23,A(qe,E,me,wt.v));else{var Vr=ko(wt);Ee(K,22,w(qe,E,me,Vr.slice(0,239)))}}++me}}return Ee(K,1),K.end()}function s(O){var N=xe(2);return N.write_shift(2,O),N}function o(O){var N=xe(26);N.write_shift(2,4096),N.write_shift(2,4),N.write_shift(4,0);for(var L=0,K=0,re=0,Z=0;Z<O.SheetNames.length;++Z){var me=O.SheetNames[Z],B=O.Sheets[me];if(!(!B||!B["!ref"])){++re;var se=wa(B["!ref"]);L<se.e.r&&(L=se.e.r),K<se.e.c&&(K=se.e.c)}}return L>8191&&(L=8191),N.write_shift(2,L),N.write_shift(1,re),N.write_shift(1,K),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(1,1),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(4,0),N}function l(O,N,L){var K={s:{c:0,r:0},e:{c:0,r:0}};return N==8&&L.qpro?(K.s.c=O.read_shift(1),O.l++,K.s.r=O.read_shift(2),K.e.c=O.read_shift(1),O.l++,K.e.r=O.read_shift(2),K):(K.s.c=O.read_shift(2),K.s.r=O.read_shift(2),N==12&&L.qpro&&(O.l+=2),K.e.c=O.read_shift(2),K.e.r=O.read_shift(2),N==12&&L.qpro&&(O.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function c(O){var N=xe(8);return N.write_shift(2,O.s.c),N.write_shift(2,O.s.r),N.write_shift(2,O.e.c),N.write_shift(2,O.e.r),N}function u(O,N,L){var K=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(K[0].c=O.read_shift(1),K[3]=O.read_shift(1),K[0].r=O.read_shift(2),O.l+=2):(K[2]=O.read_shift(1),K[0].c=O.read_shift(2),K[0].r=O.read_shift(2)),K}function h(O,N,L){var K=O.l+N,re=u(O,N,L);if(re[1].t="s",L.vers==20768){O.l++;var Z=O.read_shift(1);return re[1].v=O.read_shift(Z,"utf8"),re}return L.qpro&&O.l++,re[1].v=O.read_shift(K-O.l,"cstr"),re}function f(O,N,L){var K=xe(7+L.length);K.write_shift(1,255),K.write_shift(2,N),K.write_shift(2,O),K.write_shift(1,39);for(var re=0;re<K.length;++re){var Z=L.charCodeAt(re);K.write_shift(1,Z>=128?95:Z)}return K.write_shift(1,0),K}function m(O,N,L){var K=u(O,N,L);return K[1].v=O.read_shift(2,"i"),K}function _(O,N,L){var K=xe(7);return K.write_shift(1,255),K.write_shift(2,N),K.write_shift(2,O),K.write_shift(2,L,"i"),K}function g(O,N,L){var K=u(O,N,L);return K[1].v=O.read_shift(8,"f"),K}function v(O,N,L){var K=xe(13);return K.write_shift(1,255),K.write_shift(2,N),K.write_shift(2,O),K.write_shift(8,L,"f"),K}function y(O,N,L){var K=O.l+N,re=u(O,N,L);if(re[1].v=O.read_shift(8,"f"),L.qpro)O.l=K;else{var Z=O.read_shift(2);S(O.slice(O.l,O.l+Z),re),O.l+=Z}return re}function b(O,N,L){var K=N&32768;return N&=-32769,N=(K?O:0)+(N>=8192?N-16384:N),(K?"":"$")+(L?tr(N):br(N))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(O,N){ln(O,0);for(var L=[],K=0,re="",Z="",me="",B="";O.l<O.length;){var se=O[O.l++];switch(se){case 0:L.push(O.read_shift(8,"f"));break;case 1:Z=b(N[0].c,O.read_shift(2),!0),re=b(N[0].r,O.read_shift(2),!1),L.push(Z+re);break;case 2:{var we=b(N[0].c,O.read_shift(2),!0),V=b(N[0].r,O.read_shift(2),!1);Z=b(N[0].c,O.read_shift(2),!0),re=b(N[0].r,O.read_shift(2),!1),L.push(we+V+":"+Z+re)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(O.read_shift(2));break;case 6:{for(var Ce="";se=O[O.l++];)Ce+=String.fromCharCode(se);L.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:B=L.pop(),me=L.pop(),L.push(["AND","OR"][se-20]+"("+me+","+B+")");break;default:if(se<32&&j[se])B=L.pop(),me=L.pop(),L.push(me+j[se]+B);else if(x[se]){if(K=x[se][1],K==69&&(K=O[O.l++]),K>L.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+L.join("|")+"|");return}var qe=L.slice(-K);L.length-=K,L.push(x[se][0]+"("+qe.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}L.length==1?N[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function T(O){var N=[{c:0,r:0},{t:"n",v:0},0];return N[0].r=O.read_shift(2),N[3]=O[O.l++],N[0].c=O[O.l++],N}function F(O,N){var L=T(O);return L[1].t="s",L[1].v=O.read_shift(N-4,"cstr"),L}function w(O,N,L,K){var re=xe(6+K.length);re.write_shift(2,O),re.write_shift(1,L),re.write_shift(1,N),re.write_shift(1,39);for(var Z=0;Z<K.length;++Z){var me=K.charCodeAt(Z);re.write_shift(1,me>=128?95:me)}return re.write_shift(1,0),re}function P(O,N){var L=T(O);L[1].v=O.read_shift(2);var K=L[1].v>>1;if(L[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return L[1].v=K,L}function M(O,N){var L=T(O),K=O.read_shift(4),re=O.read_shift(4),Z=O.read_shift(2);if(Z==65535)return K===0&&re===3221225472?(L[1].t="e",L[1].v=15):K===0&&re===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var me=Z&32768;return Z=(Z&32767)-16446,L[1].v=(1-me*2)*(re*Math.pow(2,Z+32)+K*Math.pow(2,Z)),L}function A(O,N,L,K){var re=xe(14);if(re.write_shift(2,O),re.write_shift(1,L),re.write_shift(1,N),K==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var Z=0,me=0,B=0,se=0;return K<0&&(Z=1,K=-K),me=Math.log2(K)|0,K/=Math.pow(2,me-31),se=K>>>0,se&2147483648||(K/=2,++me,se=K>>>0),K-=se,se|=2147483648,se>>>=0,K*=Math.pow(2,32),B=K>>>0,re.write_shift(4,B),re.write_shift(4,se),me+=16383+(Z?32768:0),re.write_shift(2,me),re}function D(O,N){var L=M(O);return O.l+=N-14,L}function H(O,N){var L=T(O),K=O.read_shift(4);return L[1].v=K>>6,L}function U(O,N){var L=T(O),K=O.read_shift(8,"f");return L[1].v=K,L}function W(O,N){var L=U(O);return O.l+=N-10,L}function R(O,N){return O[O.l+N-1]==0?O.read_shift(N,"cstr"):""}function ae(O,N){var L=O[O.l++];L>N-1&&(L=N-1);for(var K="";K.length<L;)K+=String.fromCharCode(O[O.l++]);return K}function le(O,N,L){if(!(!L.qpro||N<21)){var K=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var re=O.read_shift(N-21,"cstr");return[K,re]}}function G(O,N){for(var L={},K=O.l+N;O.l<K;){var re=O.read_shift(2);if(re==14e3){for(L[re]=[0,""],L[re][0]=O.read_shift(2);O[O.l];)L[re][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return L}function z(O,N){var L=xe(5+O.length);L.write_shift(2,14e3),L.write_shift(2,N);for(var K=0;K<O.length;++K){var re=O.charCodeAt(K);L[L.l++]=re>127?95:re}return L[L.l++]=0,L}var ie={0:{n:"BOF",f:Tr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:R},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:R},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function dK(e){var t={},r=e.match(Rn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ye(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=_k[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var uK=function(){var e=O0("t"),t=O0("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:_t(o[1])},c=s.match(t);return c&&(l.s=dK(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),hK=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),fK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,pK=/<(?:\w+:)?r>/,mK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vk(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=_t(Rt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rt(e),r&&(n.h=Tk(n.t))):e.match(pK)&&(n.r=Rt(e),n.t=_t(Rt((e.replace(mK,"").match(fK)||[]).join("").replace(Rn,""))),r&&(n.h=hK(uK(n.r)))),n):{t:""}}var gK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,xK=/<(?:\w+:)?(?:si|sstItem)>/g,vK=/<\/(?:\w+:)?(?:si|sstItem)>/;function _K(e,t){var r=[],n="";if(!e)return r;var i=e.match(gK);if(i){n=i[2].replace(xK,"").split(vK);for(var s=0;s!=n.length;++s){var o=Vk(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Ye(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var yK=/^\s|\s$|[\t\n\r]/;function nM(e,t){if(!t.bookSST)return"";var r=[jr];r[r.length]=$e("sst",null,{xmlns:vd[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(yK)&&(s+=' xml:space="preserve"'),s+=">"+Mt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function bK(e){return[e.read_shift(4),e.read_shift(4)]}function jK(e,t){var r=[],n=!1;return $o(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function wK(e,t){return t||(t=xe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var kK=MW;function SK(e){var t=ja();ye(t,159,wK(e));for(var r=0;r<e.length;++r)ye(t,19,kK(e[r]));return ye(t,160),t.end()}function aM(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function vo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function CK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=vo(e,4),t.U=vo(e,4),t.W=vo(e,4),t}function $K(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function EK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($K(e));return t}function TK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function AK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=vo(e,4),t.U=vo(e,4),t.W=vo(e,4),t}function FK(e){var t=AK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function iM(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function sM(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function DK(e){var t=vo(e);switch(t.Minor){case 2:return[t.Minor,PK(e)];case 3:return[t.Minor,MK()];case 4:return[t.Minor,OK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=iM(e,r),i=sM(e,e.length-e.l);return{t:"Std",h:n,v:i}}function MK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function OK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Rn,function(s){var o=Ye(s);switch(Ps(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function RK(e,t){var r={},n=r.EncryptionVersionInfo=vo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=iM(e,i),t-=i,r.EncryptionVerifier=sM(e,t),r}function NK(e){var t={},r=t.EncryptionVersionInfo=vo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Hk(e){var t=0,r,n=aM(e),i=n.length+1,s,o,l,c,u;for(r=Nl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var oM=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var h=o[u],f=0;f!=7;++f)h&64&&(l^=r[c]),h*=2,--c;return l};return function(o){for(var l=aM(o),c=s(l),u=l.length,h=Nl(16),f=0;f!=16;++f)h[f]=0;var m,_,g;for((u&1)===1&&(m=c>>8,h[u]=i(e[0],m),--u,m=c&255,_=l[l.length-1],h[u]=i(_,m));u>0;)--u,m=c>>8,h[u]=i(l[u],m),--u,m=c&255,h[u]=i(l[u],m);for(u=15,g=15-l.length;g>0;)m=c>>8,h[u]=i(e[g],m),--u,--g,m=c&255,h[u]=i(l[u],m),--u,--g;return h}}(),zK=function(e,t,r,n,i){i||(i=t),n||(n=oM(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},IK=function(e){var t=0,r=oM(e);return function(n){var i=zK("",n,t,r);return t=i[1],i[0]}};function LK(e,t,r,n){var i={key:Tr(e),verificationBytes:Tr(e)};return r.password&&(i.verifier=Hk(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=IK(r.password)),i}function BK(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=NK(e):n.Data=RK(e,t),n}function UK(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?BK(e,t-2,n):LK(e,r.biff>=8?t:t-2,r,n),n}var lM=function(){function e(i,s){switch(s.type){case"base64":return t(Ua(i),s);case"binary":return t(i,s);case"buffer":return t(dt&&Buffer.isBuffer(i)?i.toString("binary"):Wl(i),s);case"array":return t(od(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var m=/\\\w+\b/g,_=0,g,v=-1;g=m.exec(h);){switch(g[0]){case"\\cell":var y=h.slice(_,m.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++v,y.length){var b={v:y,t:"s"};Array.isArray(l)?l[f][v]=b:l[Xe({r:f,c:v})]=b}break}_=m.lastIndex}v>u.e.c&&(u.e.c=v)}),l["!ref"]=et(u),l}function r(i,s){return Gl(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=yt(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var f=Xe({r:u,c:h});l=c?(i[u]||[])[h]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(ko(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function VK(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function I0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function HK(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function WK(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function x1(e,t){if(t===0)return e;var r=HK(VK(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),I0(WK(r))}var cM=6,GK=15,qK=1,Sn=cM;function L0(e){return Math.floor((e+Math.round(128/Sn)/256)*Sn)}function B0(e){return Math.floor((e-5)/Sn*100+.5)/100}function v1(e){return Math.round((e*Sn+5)/Sn*256)/256}function my(e){return v1(B0(L0(e)))}function Wk(e){var t=Math.abs(e-my(e)),r=Sn;if(t>.005)for(Sn=qK;Sn<GK;++Sn)Math.abs(e-my(e))<=t&&(t=Math.abs(e-my(e)),r=Sn);Sn=r}function zl(e){e.width?(e.wpx=L0(e.width),e.wch=B0(e.wpx),e.MDW=Sn):e.wpx?(e.wch=B0(e.wpx),e.width=v1(e.wch),e.MDW=Sn):typeof e.wch=="number"&&(e.width=v1(e.wch),e.wpx=L0(e.width),e.MDW=Sn),e.customWidth&&delete e.customWidth}var KK=96,dM=KK;function U0(e){return e*96/dM}function Xu(e){return e*dM/96}var XK={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function YK(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Rn)||[]).forEach(function(o){var l=Ye(o);switch(Ps(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=Wt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=Wt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function QK(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Rn)||[]).forEach(function(o){var l=Ye(o);switch(Ps(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function JK(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Rn)||[]).forEach(function(o){var l=Ye(o);switch(Ps(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Rt(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?Wt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?Wt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?Wt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?Wt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?Wt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?Wt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?Wt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=_k[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=Wt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=Gc[i.color.index];i.color.index==81&&(c=Gc[1]),c||(c=Gc[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=x1(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function ZK(e,t,r){t.NumberFmt=[];for(var n=pr(Ke),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ke[n[i]];var s=e[0].match(Rn);if(s)for(i=0;i<s.length;++i){var o=Ye(s[i]);switch(Ps(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=_t(Rt(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}xo(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function eX(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=$e("numFmt",null,{numFmtId:n,formatCode:Mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=$e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var $m=["numFmtId","fillId","fontId","borderId","xfId"],Em=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function tX(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Rn)||[]).forEach(function(s){var o=Ye(s),l=0;switch(Ps(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<$m.length;++l)n[$m[l]]&&(n[$m[l]]=parseInt(n[$m[l]],10));for(l=0;l<Em.length;++l)n[Em[l]]&&(n[Em[l]]=Wt(n[Em[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Wt(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function rX(e){var t=[];return t[t.length]=$e("cellXfs",null),e.forEach(function(r){t[t.length]=$e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=$e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var nX=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&ZK(f,h,u),(f=l.match(i))&&JK(f,h,c,u),(f=l.match(n))&&QK(f,h,c,u),(f=l.match(s))&&YK(f,h,c,u),(f=l.match(r))&&tX(f,h,u),h}}();function uM(e,t){var r=[jr,$e("styleSheet",null,{xmlns:vd[0],"xmlns:vt":zr.vt})],n;return e.SSF&&(n=eX(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=rX(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function aX(e,t){var r=e.read_shift(2),n=Dn(e);return[r,n]}function iX(e,t,r){r||(r=xe(6+4*t.length)),r.write_shift(2,e),Qr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function sX(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=BW(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=LW(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Dn(e),n}function oX(e,t){t||(t=xe(25+4*32)),t.write_shift(2,e.sz*20),UW(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),p1(e.color,t);var n=0;return n=2,t.write_shift(1,n),Qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var lX=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gy,cX=Mn;function PT(e,t){t||(t=xe(4*3+8*7+16*1)),gy||(gy=av(lX));var r=gy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(p1({auto:1},t),p1({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function dX(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function hM(e,t,r){r||(r=xe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bh(e,t){return t||(t=xe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var uX=Mn;function hX(e,t){return t||(t=xe(51)),t.write_shift(1,0),Bh(null,t),Bh(null,t),Bh(null,t),Bh(null,t),Bh(null,t),t.length>t.l?t.slice(0,t.l):t}function fX(e,t){return t||(t=xe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),f1(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function pX(e,t,r){var n=xe(2052);return n.write_shift(4,e),f1(t,n),f1(r,n),n.length>n.l?n.slice(0,n.l):n}function mX(e,t,r){var n={};n.NumberFmt=[];for(var i in Ke)n.NumberFmt[i]=Ke[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return $o(e,function(c,u,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],xo(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=x1(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(h);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function gX(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(ye(e,615,es(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ye(e,44,iX(i,t[i]))}),ye(e,616))}}function xX(e){var t=1;ye(e,611,es(t)),ye(e,43,oX({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(e,612)}function vX(e){var t=2;ye(e,603,es(t)),ye(e,45,PT({patternType:"none"})),ye(e,45,PT({patternType:"gray125"})),ye(e,604)}function _X(e){var t=1;ye(e,613,es(t)),ye(e,46,hX()),ye(e,614)}function yX(e){var t=1;ye(e,626,es(t)),ye(e,47,hM({numFmtId:0},65535)),ye(e,627)}function bX(e,t){ye(e,617,es(t.length)),t.forEach(function(r){ye(e,47,hM(r,0))}),ye(e,618)}function jX(e){var t=1;ye(e,619,es(t)),ye(e,48,fX({xfId:0,name:"Normal"})),ye(e,620)}function wX(e){var t=0;ye(e,505,es(t)),ye(e,506)}function kX(e){var t=0;ye(e,508,pX(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function SX(e,t){var r=ja();return ye(r,278),gX(r,e.SSF),xX(r),vX(r),_X(r),yX(r),bX(r,t.cellXfs),jX(r),wX(r),kX(r),ye(r,279),r.end()}var CX=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $X(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Rn)||[]).forEach(function(i){var s=Ye(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[CX.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function EX(){}function TX(){}var AX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,FX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function PX(e,t,r){t.themeElements={};var n;[["clrScheme",AX,$X],["fontScheme",FX,EX],["fmtScheme",DX,TX]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var MX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fM(e,t){(!e||e.length===0)&&(e=Gk());var r,n={};if(!(r=e.match(MX)))throw new Error("themeElements not found in theme");return PX(r[0],n,t),n.raw=e,n}function Gk(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[jr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function OX(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=i8(s,{type:"array"})}catch{return}var l=Na(o,"theme/theme/theme1.xml",!0);if(l)return fM(l,r)}}function RX(e){return e.read_shift(4)}function NX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=zX(e,4);break;case 2:t.xclrValue=G8(e);break;case 3:t.xclrValue=RX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function zX(e,t){return Mn(e,t)}function IX(e,t){return Mn(e,t)}function LX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=NX(e);break;case 6:n[1]=IX(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function BX(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(LX(e,r-e.l));return{ixfe:n,ext:s}}function UX(e,t){t.forEach(function(r){switch(r[0]){}})}function VX(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dn(e)}}function HX(e){var t=xe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qr(e.name,t),t.slice(0,t.l)}function WX(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function GX(e){var t=xe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function qX(e,t){var r=xe(8+2*t.length);return r.write_shift(4,e),Qr(t,r),r.slice(0,r.l)}function KX(e){return e.l+=4,e.read_shift(4)!=0}function XX(e,t){var r=xe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function YX(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return $o(e,function(c,u,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function QX(){var e=ja();return ye(e,332),ye(e,334,es(1)),ye(e,335,HX({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,qX(1,"XLDAPR")),ye(e,52),ye(e,35,es(514)),ye(e,4096,es(0)),ye(e,4097,gi(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,XX(1)),ye(e,51,GX([[1,0]])),ye(e,338),ye(e,333),e.end()}function JX(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Rn,function(l){var c=Ye(l);switch(Ps(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function pM(){var e=[jr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ZX(e){var t=[];if(!e)return t;var r=1;return(e.match(Rn)||[]).forEach(function(n){var i=Ye(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function eY(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function tY(e,t,r){var n=[];return $o(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function rY(e,t,r,n){if(!e)return e;var i=n||{},s=!1;$o(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function nY(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ou=1024;function mM(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[$e("xml",null,{"xmlns:v":Ma.v,"xmlns:o":Ma.o,"xmlns:x":Ma.x,"xmlns:mv":Ma.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ou<e*1e3;)ou+=1e3;return t.forEach(function(s){var o=rr(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=$e("v:fill",c,l),h={on:"t",obscured:"t"};++ou,i=i.concat(["<v:shape"+R0({id:"_x0000_s"+ou,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,$e("v:shadow",null,h),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),cn("x:AutoFill","False"),cn("x:Row",String(o.r)),cn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function MT(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=rr(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=yt(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=et(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function aY(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ye(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=rr(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&Vk(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function gM(e){var t=[jr,$e("comments",null,{xmlns:vd[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Mt(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Mt(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(cn("t",Mt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(cn("t",Mt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function iY(e,t){var r=[],n=!1,i={},s=0;return e.replace(Rn,function(l,c){var u=Ye(l);switch(Ps(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function sY(e,t,r){var n=[jr,$e("ThreadedComments",null,{xmlns:zr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push($e("threadedComment",cn("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function oY(e,t){var r=[],n=!1;return e.replace(Rn,function(s){var o=Ye(s);switch(Ps(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function lY(e){var t=[jr,$e("personList",null,{xmlns:zr.TCMNT,"xmlns:x":vd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push($e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function cY(e){var t={};t.iauthor=e.read_shift(4);var r=jd(e);return t.rfx=r.s,t.ref=Xe(r.s),e.l+=16,t}function dY(e,t){return t==null&&(t=xe(36)),t.write_shift(4,e[1].iauthor),lh(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var uY=Dn;function hY(e){return Qr(e.slice(0,54))}function fY(e,t){var r=[],n=[],i={},s=!1;return $o(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function pY(e){var t=ja(),r=[];return ye(t,628),ye(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ye(t,632,hY(i.a)))})}),ye(t,631),ye(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:rr(n[0]),e:rr(n[0])};ye(t,635,dY([s,i])),i.t&&i.t.length>0&&ye(t,637,RW(i)),ye(t,636),delete i.iauthor})}),ye(t,634),ye(t,629),t.end()}var mY="application/vnd.ms-office.vbaProject";function gY(e){var t=Ge.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ge.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Ge.write(t)}function xY(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ge.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var xM=["xlsb","xlsm","xlam","biff8","xla"];function vY(){return{"!type":"dialog"}}function _Y(){return{"!type":"dialog"}}function yY(){return{"!type":"macro"}}function bY(){return{"!type":"macro"}}var xu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,c?u+=t.r:--u,i+(l?"":"$")+tr(h)+(c?"":"$")+br(u)}return function(i,s){return t=s,i.replace(e,r)}}(),qk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Kk=function(){return function(t,r){return t.replace(qk,function(n,i,s,o,l,c){var u=Mk(o)-(s?0:r.c),h=Pk(c)-(l?0:r.r),f=h==0?"":l?h+1:"["+h+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+m})}}();function vM(e,t){return e.replace(qk,function(r,n,i,s,o,l){return n+(i=="$"?i+s:tr(Mk(s)+t.c))+(o=="$"?o+l:br(Pk(l)+t.r))})}function jY(e,t,r){var n=wa(t),i=n.s,s=rr(r),o={r:s.r-i.r,c:s.c-i.c};return vM(e,o)}function wY(e){return e.length!=1}function OT(e){return e.replace(/_xlfn\./g,"")}function Sr(e){e.l+=1}function Il(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _M(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return yM(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=Il(e),l=Il(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function yM(e){var t=Il(e),r=Il(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function kY(e,t,r){if(r.biff<8)return yM(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Il(e),o=Il(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function bM(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SY(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Il(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function SY(e){var t=Il(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function CY(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $Y(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EY(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function EY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function TY(e,t,r){var n=(e[e.l++]&96)>>5,i=_M(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AY(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=_M(e,s,r);return[n,i,o]}function FY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function DY(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function PY(e,t,r){var n=(e[e.l++]&96)>>5,i=kY(e,t-1,r);return[n,i]}function MY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function RT(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function OY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function RY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function zY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function IY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jM(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function LY(e){return e.read_shift(2),jM(e)}function BY(e){return e.read_shift(2),jM(e)}function UY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=bM(e,0,r);return[n,i]}function VY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=$Y(e,0,r);return[n,i]}function HY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=bM(e,0,r);return[n,i,s]}function WY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[KQ[i],SM[i],n]}function GY(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:qY(e);return[i,(s[0]===0?SM:qQ)[s[1]]]}function qY(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function KY(e,t,r){e.l+=r&&r.biff==2?3:4}function XY(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function YY(e){return e.l++,Eo[e.read_shift(1)]}function QY(e){return e.l++,e.read_shift(2)}function JY(e){return e.l++,e.read_shift(1)!==0}function ZY(e){return e.l++,$n(e)}function eQ(e,t,r){return e.l++,xp(e,t-1,r)}function tQ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Eo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$n(e);break;case 2:r[1]=wd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function rQ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?jd:ov)(e));return i}function nQ(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=tQ(e,r.biff);return o}function aQ(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function iQ(e,t,r){if(r.biff==5)return sQ(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function sQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function oQ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function lQ(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function cQ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function dQ(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var uQ=Mn,hQ=Mn,fQ=Mn;function _p(e,t,r){return e.l+=2,[CY(e)]}function Xk(e){return e.l+=6,[]}var pQ=_p,mQ=Xk,gQ=Xk,xQ=_p;function wM(e){return e.l+=2,[Tr(e),e.read_shift(2)&1]}var vQ=_p,_Q=wM,yQ=Xk,bQ=_p,jQ=_p,wQ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function kQ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=wQ[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function SQ(e){return e.l+=2,[e.read_shift(4)]}function CQ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $Q(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AQ(e){return e.l+=4,[0,0]}var NT={1:{n:"PtgExp",f:XY},2:{n:"PtgTbl",f:fQ},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:eQ},26:{n:"PtgSheet",f:CQ},27:{n:"PtgEndSheet",f:$Q},28:{n:"PtgErr",f:YY},29:{n:"PtgBool",f:JY},30:{n:"PtgInt",f:QY},31:{n:"PtgNum",f:ZY},32:{n:"PtgArray",f:MY},33:{n:"PtgFunc",f:WY},34:{n:"PtgFuncVar",f:GY},35:{n:"PtgName",f:aQ},36:{n:"PtgRef",f:UY},37:{n:"PtgArea",f:TY},38:{n:"PtgMemArea",f:oQ},39:{n:"PtgMemErr",f:uQ},40:{n:"PtgMemNoMem",f:hQ},41:{n:"PtgMemFunc",f:lQ},42:{n:"PtgRefErr",f:cQ},43:{n:"PtgAreaErr",f:FY},44:{n:"PtgRefN",f:VY},45:{n:"PtgAreaN",f:PY},46:{n:"PtgMemAreaN",f:EQ},47:{n:"PtgMemNoMemN",f:TQ},57:{n:"PtgNameX",f:iQ},58:{n:"PtgRef3d",f:HY},59:{n:"PtgArea3d",f:AY},60:{n:"PtgRefErr3d",f:dQ},61:{n:"PtgAreaErr3d",f:DY},255:{}},FQ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DQ={1:{n:"PtgElfLel",f:wM},2:{n:"PtgElfRw",f:bQ},3:{n:"PtgElfCol",f:pQ},6:{n:"PtgElfRwV",f:jQ},7:{n:"PtgElfColV",f:xQ},10:{n:"PtgElfRadical",f:vQ},11:{n:"PtgElfRadicalS",f:yQ},13:{n:"PtgElfColS",f:mQ},15:{n:"PtgElfColSV",f:gQ},16:{n:"PtgElfRadicalLel",f:_Q},25:{n:"PtgList",f:kQ},29:{n:"PtgSxName",f:SQ},255:{}},PQ={0:{n:"PtgAttrNoop",f:AQ},1:{n:"PtgAttrSemi",f:IY},2:{n:"PtgAttrIf",f:NY},4:{n:"PtgAttrChoose",f:OY},8:{n:"PtgAttrGoto",f:RY},16:{n:"PtgAttrSum",f:KY},32:{n:"PtgAttrBaxcel",f:RT},33:{n:"PtgAttrBaxcel",f:RT},64:{n:"PtgAttrSpace",f:LY},65:{n:"PtgAttrSpaceSemi",f:BY},128:{n:"PtgAttrIfError",f:zY},255:{}};function yp(e,t,r,n){if(n.biff<8)return Mn(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=nQ(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=rQ(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(Mn(e,t)),s}function bp(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=NT[s]||NT[FQ[s]],(s===24||s===25)&&(i=(s===24?DQ:PQ)[e[e.l+1]]),!i||!i.f?Mn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function MQ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var OQ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function RQ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kM(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function zT(e,t,r){var n=kM(e,t,r);return n=="#REF"?n:RQ(n,r)}function wn(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,h,f=0,m=0,_,g="";if(!e[0]||!e[0][0])return"";for(var v=-1,y="",b=0,x=e[0].length;b<x;++b){var j=e[0][b];switch(j[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),v>=0){switch(e[0][v][1][0]){case 0:y=ur(" ",e[0][v][1][1]);break;case 1:y=ur("\r",e[0][v][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+y,v=-1}l.push(u+OQ[j[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=r0(j[1][1],o,i),l.push(n0(h,s));break;case"PtgRefN":h=r?r0(j[1][1],r,i):j[1][1],l.push(n0(h,s));break;case"PtgRef3d":f=j[1][1],h=r0(j[1][2],o,i),g=zT(n,f,i),l.push(g+"!"+n0(h,s));break;case"PtgFunc":case"PtgFuncVar":var S=j[1][0],T=j[1][1];S||(S=0),S&=127;var F=S==0?[]:l.slice(-S);l.length-=S,T==="User"&&(T=F.shift()),l.push(T+"("+F.join(",")+")");break;case"PtgBool":l.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(j[1]);break;case"PtgNum":l.push(String(j[1]));break;case"PtgStr":l.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(j[1]);break;case"PtgAreaN":_=fT(j[1][1],r?{s:r}:o,i),l.push(hy(_,i));break;case"PtgArea":_=fT(j[1][1],o,i),l.push(hy(_,i));break;case"PtgArea3d":f=j[1][1],_=j[1][2],g=zT(n,f,i),l.push(g+"!"+hy(_,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=j[1][2];var w=(n.names||[])[m-1]||(n[0]||[])[m],P=w?w.Name:"SH33TJSNAME"+String(m);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var M=j[1][1];m=j[1][2];var A;if(i.biff<=5)M<0&&(M=-M),n[M]&&(A=n[M][m]);else{var D="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][m]&&n[M][m].itab>0&&(D=n.SheetNames[n[M][m].itab-1]+"!"):D=n.SheetNames[m-1]+"!"),n[M]&&n[M][m])D+=n[M][m].Name;else if(n[0]&&n[0][m])D+=n[0][m].Name;else{var H=(kM(n,M,i)||"").split(";;");H[m-1]?D=H[m-1]:D+="SH33TJSERRX"}l.push(D);break}A||(A={Name:"SH33TJSERRY"}),l.push(A.Name);break;case"PtgParen":var U="(",W=")";if(v>=0){switch(y="",e[0][v][1][0]){case 2:U=ur(" ",e[0][v][1][1])+U;break;case 3:U=ur("\r",e[0][v][1][1])+U;break;case 4:W=ur(" ",e[0][v][1][1])+W;break;case 5:W=ur("\r",e[0][v][1][1])+W;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}l.push(U+l.pop()+W);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:j[1][1],r:j[1][0]};var R={c:r.c,r:r.r};if(n.sharedf[Xe(h)]){var ae=n.sharedf[Xe(h)];l.push(wn(ae,o,R,n,i))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){l.push(wn(u[1],o,R,n,i)),le=!0;break}le||l.push(j[1])}break;case"PtgArray":l.push("{"+MQ(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&G.indexOf(e[0][b][0])==-1){j=e[0][v];var z=!0;switch(j[1][0]){case 4:z=!1;case 0:y=ur(" ",j[1][1]);break;case 5:z=!1;case 1:y=ur("\r",j[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}l.push((z?y:"")+l.pop()+(z?"":y)),v=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function NQ(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Mn(e,t-2)];var l=bp(e,o,r);return t!==o+i&&(s=yp(e,t-o-i,l,r)),e.l=n,[l,s]}function zQ(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Mn(e,t-2)];var l=bp(e,o,r);return t!==o+i&&(s=yp(e,t-o-i,l,r)),e.l=n,[l,s]}function IQ(e,t,r,n){var i=e.l+t,s=bp(e,n,r),o;return i!==e.l&&(o=yp(e,i-e.l,s,r)),[s,o]}function LQ(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=bp(e,s,r);return s==65535?[[],Mn(e,t-2)]:(t!==s+2&&(i=yp(e,n-s-2,o,r)),[o,i])}function BQ(e){var t;if(uo(e,e.l+6)!==65535)return[$n(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function UQ(e){if(e==null){var t=xe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ld(e);return ld(0)}function xy(e,t,r){var n=e.l+t,i=Ms(e);r.biff==2&&++e.l;var s=BQ(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=zQ(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function VQ(e,t,r,n,i){var s=dd(t,r,i),o=UQ(e.v),l=xe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=xe(e.bf.length),h=0;h<e.bf.length;++h)u[h]=e.bf[h];var f=Yr([s,o,l,u]);return f}function lv(e,t,r){var n=e.read_shift(4),i=bp(e,n,r),s=e.read_shift(4),o=s>0?yp(e,s,i,r):null;return[i,o]}var HQ=lv,cv=lv,WQ=lv,GQ=lv,qQ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},SM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},KQ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function IT(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function XQ(e){var t="of:="+e.replace(qk,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function vy(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function YQ(e){return e.replace(/\./,"!")}var i0={},vu={},s0=typeof Map<"u";function Yk(e,t,r){var n=0,i=e.length;if(r){if(s0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=s0?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(s0?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function dv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=B0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=v1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Xc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ql(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){xo(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function CM(e,t,r,n,i,s){try{n.cellNF&&(e.z=Ke[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=qt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ke[t]==null&&xo(qH[t]||"General",t),e.t==="e")e.w=e.w||Eo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=M0(e.v);else if(e.t==="d"){var o=Ur(e.v);(o|0)===o?e.w=o.toString(10):e.w=M0(o)}else{if(e.v===void 0)return"";e.w=sd(e.v,vu)}else e.t==="d"?e.w=Ei(t,Ur(e.v),vu):e.w=Ei(t,e.v,vu)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=x1(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=x1(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function QQ(e,t,r){if(e&&e["!ref"]){var n=yt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function JQ(e,t){var r=yt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=et(r))}var ZQ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,eJ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,tJ=/<(?:\w:)?hyperlink [^>]*>/mg,rJ=/"(\w*:\w*)"/,nJ=/<(?:\w:)?col\b[^>]*[\/]?>/g,aJ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,iJ=/<(?:\w:)?pageMargins[^>]*\/>/g,$M=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sJ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,oJ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function lJ(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",f=e.match(eJ);f?(u=e.slice(0,f.index),h=e.slice(f.index+f[0].length)):u=h=e;var m=u.match($M);m?Qk(m[0],l,i,r):(m=u.match(sJ))&&dJ(m[0],m[1]||"",l,i,r);var _=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var g=u.slice(_,_+50).match(rJ);g&&JQ(l,g[1])}var v=u.match(oJ);v&&v[1]&&wJ(v[1],i);var y=[];if(t.cellStyles){var b=u.match(nJ);b&&vJ(y,b)}f&&CJ(f[1],l,t,c,s,o);var x=h.match(aJ);x&&(l["!autofilter"]=yJ(x[0]));var j=[],S=h.match(ZQ);if(S)for(_=0;_!=S.length;++_)j[_]=yt(S[_].slice(S[_].indexOf('"')+1));var T=h.match(tJ);T&&mJ(l,T,n);var F=h.match(iJ);if(F&&(l["!margins"]=gJ(Ye(F[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=et(c)),t.sheetRows>0&&l["!ref"]){var w=yt(l["!ref"]);t.sheetRows<=+w.e.r&&(w.e.r=t.sheetRows-1,w.e.r>c.e.r&&(w.e.r=c.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>c.e.c&&(w.e.c=c.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),l["!fullref"]=l["!ref"],l["!ref"]=et(w))}return y.length>0&&(l["!cols"]=y),j.length>0&&(l["!merges"]=j),l}function cJ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+et(e[r])+'"/>';return t+"</mergeCells>"}function Qk(e,t,r,n){var i=Ye(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=_t(Rt(i.codeName)))}function dJ(e,t,r,n,i){Qk(e.slice(0,e.indexOf(">")),r,n,i)}function uJ(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Ts(Mt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+$e("outlinePr",null,u)}!s&&!l||(i[i.length]=$e("sheetPr",l,o))}var hJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],fJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pJ(e){var t={sheet:1};return hJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),fJ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Hk(e.password).toString(16).toUpperCase()),$e("sheetProtection",null,t)}function mJ(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Ye(Rt(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+_t(s.location))):(s.Target="#"+_t(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=yt(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var h=Xe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}function gJ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function xJ(e){return Xc(e),$e("pageMargins",null,e)}function vJ(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Ye(t[n],!0);i.hidden&&(i.hidden=Wt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Wk(i.width)),zl(i);s<=o;)e[s++]=Kt(i)}}function _J(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=$e("col",null,dv(i,n)));return r[r.length]="</cols>",r.join("")}function yJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function bJ(e,t,r,n){var i=typeof e.ref=="string"?e.ref:et(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=wa(i);o.s.r==o.e.r&&(o.e.r=wa(t["!ref"]).e.r,i=et(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),$e("autoFilter",null,{ref:i})}var jJ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function wJ(e,t){t.Views||(t.Views=[{}]),(e.match(jJ)||[]).forEach(function(r,n){var i=Ye(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Wt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function kJ(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,i),{})}function SJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Eo[e.v];break;case"d":n&&n.cellDates?i=qt(e.v,-1).toISOString():(e=Kt(e),e.t="n",i=""+(e.v=Ur(qt(e.v)))),typeof e.z>"u"&&(e.z=Ke[14]);break;default:i=e.v;break}var l=cn("v",Mt(i)),c={r:t},u=ql(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=cn("v",""+Yk(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=$e("f",Mt(e.f),h)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),$e("c",l,c)}var CJ=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=O0("v"),o=O0("f");return function(c,u,h,f,m,_){for(var g=0,v="",y=[],b=[],x=0,j=0,S=0,T="",F,w,P=0,M=0,A,D,H=0,U=0,W=Array.isArray(_.CellXf),R,ae=[],le=[],G=Array.isArray(u),z=[],ie={},ne=!1,O=!!h.sheetStubs,N=c.split(t),L=0,K=N.length;L!=K;++L){v=N[L].trim();var re=v.length;if(re!==0){var Z=0;e:for(g=0;g<re;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(h&&h.cellStyles){if(w=Ye(v.slice(Z,g),!0),P=w.r!=null?parseInt(w.r,10):P+1,M=-1,h.sheetRows&&h.sheetRows<P)continue;ie={},ne=!1,w.ht&&(ne=!0,ie.hpt=parseFloat(w.ht),ie.hpx=Xu(ie.hpt)),w.hidden=="1"&&(ne=!0,ie.hidden=!0),w.outlineLevel!=null&&(ne=!0,ie.level=+w.outlineLevel),ne&&(z[P-1]=ie)}break;case"<":Z=g;break}if(Z>=g)break;if(w=Ye(v.slice(Z,g),!0),P=w.r!=null?parseInt(w.r,10):P+1,M=-1,!(h.sheetRows&&h.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),h&&h.cellStyles&&(ie={},ne=!1,w.ht&&(ne=!0,ie.hpt=parseFloat(w.ht),ie.hpx=Xu(ie.hpt)),w.hidden=="1"&&(ne=!0,ie.hidden=!0),w.outlineLevel!=null&&(ne=!0,ie.level=+w.outlineLevel),ne&&(z[P-1]=ie)),y=v.slice(g).split(e);for(var me=0;me!=y.length&&y[me].trim().charAt(0)=="<";++me);for(y=y.slice(me),g=0;g!=y.length;++g)if(v=y[g].trim(),v.length!==0){if(b=v.match(r),x=g,j=0,S=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,b!=null&&b.length===2){for(x=0,T=b[1],j=0;j!=T.length&&!((S=T.charCodeAt(j)-64)<1||S>26);++j)x=26*x+S;--x,M=x}else++M;for(j=0;j!=v.length&&v.charCodeAt(j)!==62;++j);if(++j,w=Ye(v.slice(0,j),!0),w.r||(w.r=Xe({r:P-1,c:M})),T=v.slice(j),F={t:""},(b=T.match(s))!=null&&b[1]!==""&&(F.v=_t(b[1])),h.cellFormula){if((b=T.match(o))!=null&&b[1]!==""){if(F.f=_t(Rt(b[1])).replace(/\r\n/g,`
`),h.xlfn||(F.f=OT(F.f)),b[0].indexOf('t="array"')>-1)F.F=(T.match(i)||[])[1],F.F.indexOf(":")>-1&&ae.push([yt(F.F),F.F]);else if(b[0].indexOf('t="shared"')>-1){D=Ye(b[0]);var B=_t(Rt(b[1]));h.xlfn||(B=OT(B)),le[parseInt(D.si,10)]=[D,B,w.r]}}else(b=T.match(/<f[^>]*\/>/))&&(D=Ye(b[0]),le[D.si]&&(F.f=jY(le[D.si][1],le[D.si][2],w.r)));var se=rr(w.r);for(j=0;j<ae.length;++j)se.r>=ae[j][0].s.r&&se.r<=ae[j][0].e.r&&se.c>=ae[j][0].s.c&&se.c<=ae[j][0].e.c&&(F.F=ae[j][1])}if(w.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(O)F.t="z";else continue;else F.t=w.t||"n";switch(f.s.c>M&&(f.s.c=M),f.e.c<M&&(f.e.c=M),F.t){case"n":if(F.v==""||F.v==null){if(!O)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!O)continue;F.t="z"}else A=i0[parseInt(F.v,10)],F.v=A.t,F.r=A.r,h.cellHTML&&(F.h=A.h);break;case"str":F.t="s",F.v=F.v!=null?Rt(F.v):"",h.cellHTML&&(F.h=Tk(F.v));break;case"inlineStr":b=T.match(n),F.t="s",b!=null&&(A=Vk(b[1]))?(F.v=A.t,h.cellHTML&&(F.h=A.h)):F.v="";break;case"b":F.v=Wt(F.v);break;case"d":h.cellDates?F.v=qt(F.v,1):(F.v=Ur(qt(F.v,1)),F.t="n");break;case"e":(!h||h.cellText!==!1)&&(F.w=F.v),F.v=T8[F.v];break}if(H=U=0,R=null,W&&w.s!==void 0&&(R=_.CellXf[w.s],R!=null&&(R.numFmtId!=null&&(H=R.numFmtId),h.cellStyles&&R.fillId!=null&&(U=R.fillId))),CM(F,H,U,h,m,_),h.cellDates&&W&&F.t=="n"&&ih(Ke[H])&&(F.t="d",F.v=sv(F.v)),w.cm&&h.xlmeta){var we=(h.xlmeta.Cell||[])[+w.cm-1];we&&we.type=="XLDAPR"&&(F.D=!0)}if(G){var V=rr(w.r);u[V.r]||(u[V.r]=[]),u[V.r][V.c]=F}else u[w.r]=F}}}}z.length>0&&(u["!rows"]=z)}}();function $J(e,t,r,n){var i=[],s=[],o=yt(e["!ref"]),l="",c,u="",h=[],f=0,m=0,_=e["!rows"],g=Array.isArray(e),v={r:u},y,b=-1;for(m=o.s.c;m<=o.e.c;++m)h[m]=tr(m);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=br(f),m=o.s.c;m<=o.e.c;++m){c=h[m]+u;var x=g?(e[f]||[])[m]:e[c];x!==void 0&&(l=SJ(x,c,e,t))!=null&&s.push(l)}(s.length>0||_&&_[f])&&(v={r:u},_&&_[f]&&(y=_[f],y.hidden&&(v.hidden=1),b=-1,y.hpx?b=U0(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(v.ht=b,v.customHeight=1),y.level&&(v.outlineLevel=y.level)),i[i.length]=$e("row",s.join(""),v))}if(_)for(;f<_.length;++f)_&&_[f]&&(v={r:f+1},y=_[f],y.hidden&&(v.hidden=1),b=-1,y.hpx?b=U0(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(v.ht=b,v.customHeight=1),y.level&&(v.outlineLevel=y.level),i[i.length]=$e("row","",v));return i.join("")}function EM(e,t,r,n){var i=[jr,$e("worksheet",null,{xmlns:vd[0],"xmlns:r":zr.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",h=yt(u);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=et(h)}n||(n={}),c["!comments"]=[];var f=[];uJ(c,r,e,t,i),i[i.length]=$e("dimension",null,{ref:u}),i[i.length]=kJ(c,t,e,r),t.sheetFormat&&(i[i.length]=$e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=_J(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=$J(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=pJ(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=bJ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=cJ(c["!merges"]));var m=-1,_,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(_={ref:v[0]},v[1].Target.charAt(0)!="#"&&(g=Ft(n,-1,Mt(v[1].Target).replace(/#.*$/,""),ut.HLINK),_["r:id"]="rId"+g),(m=v[1].Target.indexOf("#"))>-1&&(_.location=Mt(v[1].Target.slice(m+1))),v[1].Tooltip&&(_.tooltip=Mt(v[1].Tooltip)),i[i.length]=$e("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=xJ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=cn("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Ft(n,-1,"../drawings/drawing"+(e+1)+".xml",ut.DRAW),i[i.length]=$e("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Ft(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ut.VML),i[i.length]=$e("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function EJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function TJ(e,t,r){var n=xe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=U0(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,m=-1,_=h<<10;_<h+1<<10;++_){u.c=_;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Xe(u)];g&&(f<0&&(f=_),m=_)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var v=n.l;return n.l=c,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function AJ(e,t,r,n){var i=TJ(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&ye(e,0,i)}var FJ=jd,DJ=lh;function PJ(){}function MJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=NW(e),r}function OJ(e,t,r){r==null&&(r=xe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return p1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),k8(e,r),r.slice(0,r.l)}function RJ(e){var t=Ai(e);return[t]}function NJ(e,t,r){return r==null&&(r=xe(8)),_d(t,r)}function zJ(e){var t=yd(e);return[t]}function IJ(e,t,r){return r==null&&(r=xe(4)),bd(t,r)}function LJ(e){var t=Ai(e),r=e.read_shift(1);return[t,r,"b"]}function BJ(e,t,r){return r==null&&(r=xe(9)),_d(t,r),r.write_shift(1,e.v?1:0),r}function UJ(e){var t=yd(e),r=e.read_shift(1);return[t,r,"b"]}function VJ(e,t,r){return r==null&&(r=xe(5)),bd(t,r),r.write_shift(1,e.v?1:0),r}function HJ(e){var t=Ai(e),r=e.read_shift(1);return[t,r,"e"]}function WJ(e,t,r){return r==null&&(r=xe(9)),_d(t,r),r.write_shift(1,e.v),r}function GJ(e){var t=yd(e),r=e.read_shift(1);return[t,r,"e"]}function qJ(e,t,r){return r==null&&(r=xe(8)),bd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function KJ(e){var t=Ai(e),r=e.read_shift(4);return[t,r,"s"]}function XJ(e,t,r){return r==null&&(r=xe(12)),_d(t,r),r.write_shift(4,t.v),r}function YJ(e){var t=yd(e),r=e.read_shift(4);return[t,r,"s"]}function QJ(e,t,r){return r==null&&(r=xe(8)),bd(t,r),r.write_shift(4,t.v),r}function JJ(e){var t=Ai(e),r=$n(e);return[t,r,"n"]}function ZJ(e,t,r){return r==null&&(r=xe(16)),_d(t,r),ld(e.v,r),r}function TM(e){var t=yd(e),r=$n(e);return[t,r,"n"]}function eZ(e,t,r){return r==null&&(r=xe(12)),bd(t,r),ld(e.v,r),r}function tZ(e){var t=Ai(e),r=zk(e);return[t,r,"n"]}function rZ(e,t,r){return r==null&&(r=xe(12)),_d(t,r),S8(e.v,r),r}function nZ(e){var t=yd(e),r=zk(e);return[t,r,"n"]}function aZ(e,t,r){return r==null&&(r=xe(8)),bd(t,r),S8(e.v,r),r}function iZ(e){var t=Ai(e),r=Ok(e);return[t,r,"is"]}function sZ(e){var t=Ai(e),r=Dn(e);return[t,r,"str"]}function oZ(e,t,r){return r==null&&(r=xe(12+4*e.v.length)),_d(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lZ(e){var t=yd(e),r=Dn(e);return[t,r,"str"]}function cZ(e,t,r){return r==null&&(r=xe(8+4*e.v.length)),bd(t,r),Qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function dZ(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=cv(e,n-e.l,r);o[3]=wn(l,null,i,r.supbooks,r)}else e.l=n;return o}function uZ(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=cv(e,n-e.l,r);o[3]=wn(l,null,i,r.supbooks,r)}else e.l=n;return o}function hZ(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var s=$n(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=cv(e,n-e.l,r);o[3]=wn(l,null,i,r.supbooks,r)}else e.l=n;return o}function fZ(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var s=Dn(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=cv(e,n-e.l,r);o[3]=wn(l,null,i,r.supbooks,r)}else e.l=n;return o}var pZ=jd,mZ=lh;function gZ(e,t){return t==null&&(t=xe(4)),t.write_shift(4,e),t}function xZ(e,t){var r=e.l+t,n=jd(e),i=Rk(e),s=Dn(e),o=Dn(e),l=Dn(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function vZ(e,t){var r=xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));lh({s:rr(e[0]),e:rr(e[0])},r),Nk("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Qr(i||"",r),Qr(e[1].Tooltip||"",r),Qr("",r),r.slice(0,r.l)}function _Z(){}function yZ(e,t,r){var n=e.l+t,i=C8(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=HQ(e,n-e.l,r);o[1]=l}else e.l=n;return o}function bZ(e,t,r){var n=e.l+t,i=jd(e),s=[i];if(r.cellFormula){var o=GQ(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function jZ(e,t,r){r==null&&(r=xe(18));var n=dv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var AM=["left","right","top","bottom","header","footer"];function wZ(e){var t={};return AM.forEach(function(r){t[r]=$n(e)}),t}function kZ(e,t){return t==null&&(t=xe(6*8)),Xc(e),AM.forEach(function(r){ld(e[r],t)}),t}function SZ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function CZ(e,t,r){r==null&&(r=xe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $Z(e){var t=xe(24);return t.write_shift(4,4),t.write_shift(4,1),lh(e,t),t}function EZ(e,t){return t==null&&(t=xe(16*4+2)),t.write_shift(2,e.password?Hk(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function TZ(){}function AZ(){}function FZ(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,_,g,v,y,b,x,j,S,T,F=[];l.biff=12,l["!row"]=0;var w=0,P=!1,M=[],A={},D=l.supbooks||i.supbooks||[[]];if(D.sharedf=A,D.arrayf=M,D.SheetNames=i.SheetNames||i.Sheets.map(function(G){return G.name}),!l.supbooks&&(l.supbooks=D,i.Names))for(var H=0;H<i.Names.length;++H)D[0][H+1]=i.Names[H];var U=[],W=[],R=!1;V0[16]={n:"BrtShortReal",f:TM};var ae;if($o(e,function(z,ie,ne){if(!m)switch(ne){case 148:u=z;break;case 0:_=z,l.sheetRows&&l.sheetRows<=_.r&&(m=!0),S=br(y=_.r),l["!row"]=_.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Xu(z.hpt)),W[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:z[2]},z[2]){case"n":g.v=z[1];break;case"s":j=i0[z[1]],g.v=j.t,g.r=j.r;break;case"b":g.v=!!z[1];break;case"e":g.v=z[1],l.cellText!==!1&&(g.w=Eo[g.v]);break;case"str":g.t="s",g.v=z[1];break;case"is":g.t="s",g.v=z[1].t;break}if((v=o.CellXf[z[0].iStyleRef])&&CM(g,v.numFmtId,null,l,s,o),b=z[0].c==-1?b+1:z[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=g):c[tr(b)+S]=g,l.cellFormula){for(P=!1,w=0;w<M.length;++w){var O=M[w];_.r>=O[0].s.r&&_.r<=O[0].e.r&&b>=O[0].s.c&&b<=O[0].e.c&&(g.F=et(O[0]),P=!0)}!P&&z.length>3&&(g.f=z[3])}if(h.s.r>_.r&&(h.s.r=_.r),h.s.c>b&&(h.s.c=b),h.e.r<_.r&&(h.e.r=_.r),h.e.c<b&&(h.e.c=b),l.cellDates&&v&&g.t=="n"&&ih(Ke[v.numFmtId])){var N=Fc(g.v);N&&(g.t="d",g.v=new Date(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u))}ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},b=z[0].c==-1?b+1:z[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=g):c[tr(b)+S]=g,h.s.r>_.r&&(h.s.r=_.r),h.s.c>b&&(h.s.c=b),h.e.r<_.r&&(h.e.r=_.r),h.e.c<b&&(h.e.c=b),ae&&(ae.type=="XLDAPR"&&(g.D=!0),ae=void 0);break;case 176:F.push(z);break;case 49:ae=((l.xlmeta||{}).Cell||[])[z-1];break;case 494:var L=n["!id"][z.relId];for(L?(z.Target=L.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=L):z.relId==""&&(z.Target="#"+z.loc),y=z.rfx.s.r;y<=z.rfx.e.r;++y)for(b=z.rfx.s.c;b<=z.rfx.e.c;++b)l.dense?(c[y]||(c[y]=[]),c[y][b]||(c[y][b]={t:"z",v:void 0}),c[y][b].l=z):(x=Xe({c:b,r:y}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=z);break;case 426:if(!l.cellFormula)break;M.push(z),T=l.dense?c[y][b]:c[tr(b)+S],T.f=wn(z[1],h,{r:_.r,c:b},D,l),T.F=et(z[0]);break;case 427:if(!l.cellFormula)break;A[Xe(z[0].s)]=z[1],T=l.dense?c[y][b]:c[tr(b)+S],T.f=wn(z[1],h,{r:_.r,c:b},D,l);break;case 60:if(!l.cellStyles)break;for(;z.e>=z.s;)U[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},R||(R=!0,Wk(z.w/256)),zl(U[z.e+1]);break;case 161:c["!autofilter"]={ref:et(z)};break;case 476:c["!margins"]=z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),z.name&&(i.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ie.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ne.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=et(u||h)),l.sheetRows&&c["!ref"]){var le=yt(c["!ref"]);l.sheetRows<=+le.e.r&&(le.e.r=l.sheetRows-1,le.e.r>h.e.r&&(le.e.r=h.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>h.e.c&&(le.e.c=h.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),c["!fullref"]=c["!ref"],c["!ref"]=et(le))}return F.length>0&&(c["!merges"]=F),U.length>0&&(c["!cols"]=U),W.length>0&&(c["!rows"]=W),c}function DZ(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Kt(t),t.z=t.z||Ke[14],t.v=Ur(qt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=ql(i.cellXfs,t,i),t.l&&s["!links"].push([Xe(c),t.l]),t.c&&s["!comments"].push([Xe(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=Yk(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?ye(e,18,QJ(t,c)):ye(e,7,XJ(t,c))):(c.t="str",o?ye(e,17,cZ(t,c)):ye(e,6,oZ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ye(e,13,aZ(t,c)):ye(e,2,rZ(t,c)):o?ye(e,16,eZ(t,c)):ye(e,5,ZJ(t,c)),!0;case"b":return c.t="b",o?ye(e,15,VJ(t,c)):ye(e,4,BJ(t,c)),!0;case"e":return c.t="e",o?ye(e,14,qJ(t,c)):ye(e,3,WJ(t,c)),!0}return o?ye(e,12,IJ(t,c)):ye(e,1,NJ(t,c)),!0}function PZ(e,t,r,n){var i=yt(t["!ref"]||"A1"),s,o="",l=[];ye(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=u;++h){o=br(h),AJ(e,t,i,h);var f=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(l[m]=tr(m)),s=l[m]+o;var _=c?(t[h]||[])[m]:t[s];if(!_){f=!1;continue}f=DZ(e,_,h,m,n,t,f)}}ye(e,146)}function MZ(e,t){!t||!t["!merges"]||(ye(e,177,gZ(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,mZ(r))}),ye(e,178))}function OZ(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,n){r&&ye(e,60,jZ(n,r))}),ye(e,391))}function RZ(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,$Z(yt(t["!ref"]))),ye(e,650))}function NZ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Ft(r,-1,n[1].Target.replace(/#.*$/,""),ut.HLINK);ye(e,494,vZ(n,i))}}),delete t["!links"]}function zZ(e,t,r,n){if(t["!comments"].length>0){var i=Ft(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ut.VML);ye(e,551,Nk("rId"+i)),t["!legacy"]=i}}function IZ(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:et(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=wa(s);l.s.r==l.e.r&&(l.e.r=wa(t["!ref"]).e.r,s=et(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ye(e,161,lh(yt(s))),ye(e,162)}}function LZ(e,t,r){ye(e,133),ye(e,137,CZ(t,r)),ye(e,138),ye(e,134)}function BZ(e,t){t["!protect"]&&ye(e,535,EZ(t["!protect"]))}function UZ(e,t,r,n){var i=ja(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=yt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ye(i,129),(r.vbaraw||o["!outline"])&&ye(i,147,OJ(l,o["!outline"])),ye(i,148,DJ(c)),LZ(i,o,r.Workbook),OZ(i,o),PZ(i,o,e,t),BZ(i,o),IZ(i,o,r,e),MZ(i,o),NZ(i,o,n),o["!margins"]&&ye(i,476,kZ(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&RZ(i,o),zZ(i,o,e,n),ye(i,130),i.end()}function VZ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=_t((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function HZ(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=VZ(f);h.s.r=h.s.c=0,h.e.c=l,u=tr(l),m[0].forEach(function(_,g){o[u+br(g)]={t:"n",v:_,z:m[1]},c=g}),h.e.r<c&&(h.e.r=c),++l}),l>0&&(o["!ref"]=et(h)),o}function WZ(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match($M);return l&&Qk(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function GZ(e,t){e.l+=10;var r=Dn(e);return{name:r}}function qZ(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return $o(e,function(c,u,h){switch(h){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Jk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],KZ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],XZ=[],YZ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function LT(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Wt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function BT(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function FM(e){BT(e.WBProps,Jk),BT(e.CalcPr,YZ),LT(e.WBView,KZ),LT(e.Sheets,XZ),vu.date1904=Wt(e.WBProps.date1904)}function QZ(e){return!e.Workbook||!e.Workbook.WBProps?"false":Wt(e.Workbook.WBProps.date1904)?"true":"false"}var JZ="][*?/\\".split("");function DM(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return JZ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ZZ(e,t,r){e.forEach(function(n,i){DM(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function eee(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ZZ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)QQ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var tee=/<\w+:workbook/;function ree(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Rn,function(c,u){var h=Ye(c);switch(Ps(h[0])){case"<?xml":break;case"<workbook":c.match(tee)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jk.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Wt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=Rt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=_t(Rt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Rt(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Wt(h.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=_t(Rt(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),vd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return FM(r),r}function PM(e){var t=[jr];t[t.length]=$e("workbook",null,{xmlns:vd[0],"xmlns:r":zr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Jk.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=$e("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Mt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=$e("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=$e("definedName",Mt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function nee(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Mw(e),r.name=Dn(e),r}function aee(e,t){return t||(t=xe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Nk(e.strRelID,t),Qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function iee(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Dn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function see(e,t){t||(t=xe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),k8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function oee(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function lee(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=zW(e),o=WQ(e,0,r),l=Rk(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function cee(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],V0[16]={n:"BrtFRTArchID$",f:oee},$o(e,function(c,u,h){switch(h){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=wn(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,c]):o[0]=[h,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),FM(r),r.Names=s,r.supbooks=o,r}function dee(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,aee(i))}ye(e,144)}function uee(e,t){t||(t=xe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qr("SheetJS",t),Qr(o1.version,t),Qr(o1.version,t),Qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function hee(e,t){t||(t=xe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function fee(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ye(e,135),ye(e,158,hee(i)),ye(e,136))}}function pee(e,t){var r=ja();return ye(r,131),ye(r,128,uee()),ye(r,153,see(e.Workbook&&e.Workbook.WBProps||null)),fee(r,e),dee(r,e),ye(r,132),r.end()}function mee(e,t,r){return t.slice(-4)===".bin"?cee(e,r):ree(e,r)}function gee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?FZ(e,n,r,i,s,o,l):lJ(e,n,r,i,s,o,l)}function xee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?qZ(e,n,r,i,s):WZ(e,n,r,i,s)}function vee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?yY():bY()}function _ee(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?vY():_Y()}function yee(e,t,r,n){return t.slice(-4)===".bin"?mX(e,r,n):nX(e,r,n)}function bee(e,t,r){return fM(e,r)}function jee(e,t,r){return t.slice(-4)===".bin"?jK(e,r):_K(e,r)}function wee(e,t,r){return t.slice(-4)===".bin"?fY(e,r):aY(e,r)}function kee(e,t,r){return t.slice(-4)===".bin"?tY(e):ZX(e)}function See(e,t,r,n){return r.slice(-4)===".bin"?rY(e,t,r,n):void 0}function Cee(e,t,r){return t.slice(-4)===".bin"?YX(e,t,r):JX(e,t,r)}function $ee(e,t,r){return(t.slice(-4)===".bin"?pee:PM)(e)}function Eee(e,t,r,n,i){return(t.slice(-4)===".bin"?UZ:EM)(e,r,n,i)}function Tee(e,t,r){return(t.slice(-4)===".bin"?SX:uM)(e,r)}function Aee(e,t,r){return(t.slice(-4)===".bin"?SK:nM)(e,r)}function Fee(e,t,r){return(t.slice(-4)===".bin"?pY:gM)(e)}function Dee(e){return(e.slice(-4)===".bin"?QX:pM)()}var MM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,OM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Li(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(MM),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(OM),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Pee(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(MM),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(OM),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var o0;function Mee(e,t){var r=o0[e]||_t(e);return r==="General"?sd(t):Ei(r,t)}function Oee(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Wt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=qt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[_t(t)]=i}function Ree(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Eo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=M0(e.v):e.w=sd(e.v):e.w=Mee(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=o0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ih(n)){var i=Fc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Nee(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=XK[n.Pattern]||n.Pattern)}e[t.ID]=t}function zee(e,t,r,n,i,s,o,l,c,u){var h="General",f=n.StyleID,m={};u=u||{};var _=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&_.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Wt(e);break;case"String":n.t="s",n.r=aT(_t(e)),n.v=e.indexOf("<")>-1?_t(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(qt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=_t(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=T8[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=aT(t||e));break}if(Ree(n,h,u),u.cellFormula!==!1)if(n.Formula){var v=_t(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=xu(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=xu("RC:RC",i):n.ArrayRange&&(n.F=xu(n.ArrayRange,i),c.push([yt(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(_.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Iee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _y(e,t){var r=t||{};sh();var n=zf(Ak(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Kt(r);return o.type="string",Ku.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wt){i.indexOf("<"+wt)>=0&&(s=!0)}),s)return kte(n,r);o0={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,h={},f=[],m=r.dense?[]:{},_="",g={},v={},y=Li('<Data ss:Type="String">'),b=0,x=0,j=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},F={},w="",P=0,M=[],A={},D={},H=0,U=[],W=[],R={},ae=[],le,G=!1,z=[],ie=[],ne={},O=0,N=0,L={Sheets:[],WBProps:{date1904:!1}},K={};N0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";l=N0.exec(n);)switch(l[3]=(re=l[3]).toLowerCase()){case"data":if(re=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?zee(n.slice(b,l.index),w,y,c[c.length-1][0]=="comment"?R:g,{c:x,r:j},T,ae[x],v,z,r):(w="",y=Li(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(W.length>0&&(g.c=W),(!r.sheetRows||r.sheetRows>j)&&g.v!==void 0&&(r.dense?(m[j]||(m[j]=[]),m[j][x]=g):m[tr(x)+br(j)]=g),g.HRef&&(g.l={Target:_t(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(O=x+(parseInt(g.MergeAcross,10)|0),N=j+(parseInt(g.MergeDown,10)|0),M.push({s:{c:x,r:j},e:{c:O,r:N}})),!r.sheetStubs)g.MergeAcross?x=O+1:++x;else if(g.MergeAcross||g.MergeDown){for(var Z=x;Z<=O;++Z)for(var me=j;me<=N;++me)(Z>x||me>j)&&(r.dense?(m[me]||(m[me]=[]),m[me][Z]={t:"z"}):m[tr(Z)+br(me)]={t:"z"});x=O+1}else++x;else g=Pee(l[0]),g.Index&&(x=+g.Index-1),x<S.s.c&&(S.s.c=x),x>S.e.c&&(S.e.c=x),l[0].slice(-2)==="/>"&&++x,W=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(j<S.s.r&&(S.s.r=j),j>S.e.r&&(S.e.r=j),l[0].slice(-2)==="/>"&&(v=Li(l[0]),v.Index&&(j=+v.Index-1)),x=0,++j):(v=Li(l[0]),v.Index&&(j=+v.Index-1),ne={},(v.AutoFitHeight=="0"||v.Height)&&(ne.hpx=parseInt(v.Height,10),ne.hpt=U0(ne.hpx),ie[j]=ne),v.Hidden=="1"&&(ne.hidden=!0,ie[j]=ne));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(_),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(m["!ref"]=et(S),r.sheetRows&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=et(S))),M.length&&(m["!merges"]=M),ae.length>0&&(m["!cols"]=ae),ie.length>0&&(m["!rows"]=ie),h[_]=m}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=x=0,c.push([l[3],!1]),u=Li(l[0]),_=_t(u.Name),m=r.dense?[]:{},M=[],z=[],ie=[],K={name:_,Hidden:0},L.Sheets.push(K);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],G=!1}break;case"style":l[1]==="/"?Nee(T,F,r):F=Li(l[0]);break;case"numberformat":F.nf=_t(Li(l[0]).Format||"General"),o0[F.nf]&&(F.nf=o0[F.nf]);for(var B=0;B!=392&&Ke[B]!=F.nf;++B);if(B==392){for(B=57;B!=392;++B)if(Ke[B]==null){xo(F.nf,B);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(le=Li(l[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!G&&le.wpx>10){G=!0,Sn=cM;for(var se=0;se<ae.length;++se)ae[se]&&zl(ae[se])}G&&zl(le),ae[le.Index-1||ae.length]=le;for(var we=0;we<+le.Span;++we)ae[ae.length]=Kt(le);break;case"namedrange":if(l[1]==="/")break;L.Names||(L.Names=[]);var V=Ye(l[0]),Ce={Name:V.Name,Ref:xu(V.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Ce.Sheet=L.Sheets.length-1),L.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?w+=n.slice(P,l.index):P=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Li(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?cG(A,re,n.slice(H,l.index)):H=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Iee(R),W.push(R)}else c.push([l[3],!1]),u=Li(l[0]),R={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var qe=Li(l[0]);m["!autofilter"]={ref:xu(qe.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return GT(n,r);var Te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(H,l.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else H=l.index+l[0].length;break;case"header":m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(m["!margins"].header=+Ye(l[0]).Margin);break;case"footer":m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+Ye(l[0]).Margin)||(m["!margins"].footer=+Ye(l[0]).Margin);break;case"pagemargins":var E=Ye(l[0]);m["!margins"]||Xc(m["!margins"]={},"xlml"),isNaN(+E.Top)||(m["!margins"].top=+E.Top),isNaN(+E.Left)||(m["!margins"].left=+E.Left),isNaN(+E.Right)||(m["!margins"].right=+E.Right),isNaN(+E.Bottom)||(m["!margins"].bottom=+E.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Oee(D,re,U,n.slice(H,l.index)):(U=l,H=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=h),_e.SheetNames=f,_e.Workbook=L,_e.SSF=Kt(Ke),_e.Props=A,_e.Custprops=D,_e}function Bw(e,t){switch(eS(t=t||{}),t.type||"base64"){case"base64":return _y(Ua(e),t);case"binary":case"buffer":case"file":return _y(e,t);case"array":return _y(Wl(e),t)}}function Lee(e,t){var r=[];return e.Props&&r.push(dG(e.Props,t)),e.Custprops&&r.push(uG(e.Props,e.Custprops)),r.join("")}function Bee(){return""}function Uee(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push($e("NumberFormat",null,{"ss:Format":Mt(Ke[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push($e("Style",s.join(""),o))}),$e("Styles",r.join(""))}function RM(e){return $e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Kk(e.Ref,{r:0,c:0})})}function Vee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(RM(i)))}return $e("Names",r.join(""))}function Hee(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(RM(l)))}return s.join("")}function Wee(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push($e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push($e("Footer",null,{"x:Margin":e["!margins"].footer})),i.push($e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push($e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(cn("ProtectContents","True")),e["!protect"].objects&&i.push(cn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(cn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(cn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":$e("WorksheetOptions",i.join(""),{xmlns:Ma.x})}function Gee(e){return e.map(function(t){var r=fW(t.t||""),n=$e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",n,{"ss:Author":t.a})}).join("")}function qee(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Mt(Kk(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=rr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Mt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Mt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],h=0;h!=u.length;++h)u[h].s.c!=o.c||u[h].s.r!=o.r||(u[h].e.c>u[h].s.c&&(l["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(l["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=Eo[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ke[14]);break;case"s":f="String",m=hW(e.v||"");break}var _=ql(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+_),l["ss:Index"]=o.c+1;var g=e.v!=null?m:"",v=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(v+=Gee(e.c)),$e("Cell",v,l)}function Kee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Xee(e,t,r,n){if(!e["!ref"])return"";var i=yt(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,b){zl(y);var x=!!y.width,j=dv(b,y),S={"ss:Index":b+1};x&&(S["ss:Width"]=L0(j.width)),y.hidden&&(S["ss:Hidden"]="1"),l.push($e("Column",null,S))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var h=[Kee(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var m=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(m=!0);break}if(!m){var _={r:u,c:f},g=Xe(_),v=c?(e[u]||[])[f]:e[g];h.push(qee(v,g,e,t,r,n,_))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function Yee(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Hee(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?Xee(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Wee(s,t,e,r)),n.join("")}function Qee(e,t){t||(t={}),e.SSF||(e.SSF=Kt(Ke)),e.SSF&&(sh(),nv(e.SSF),t.revssf=iv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Lee(e,t)),r.push(Bee()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push($e("Worksheet",Yee(n,t,e),{"ss:Name":Mt(e.SheetNames[n])}));return r[2]=Uee(e,t),r[3]=Vee(e),jr+$e("Workbook",r.join(""),{xmlns:Ma.ss,"xmlns:o":Ma.o,"xmlns:x":Ma.x,"xmlns:ss":Ma.ss,"xmlns:dt":Ma.dt,"xmlns:html":Ma.html})}function Jee(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=VW(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=HW(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Zee=[60,1084,2066,2165,2175];function ete(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=uo(r,r.l),u=Uw[c],h=0;u!=null&&Zee.indexOf(c)>-1;)s=uo(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),l=r.slice(h,r.l+4+s),o.push(l),r.l+=4+s,u=Uw[c=uo(r,r.l)];var f=Yr(o);ln(f,0);var m=0;f.lens=[];for(var _=0;_<o.length;++_)f.lens.push(m),m+=o[_].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function us(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ke[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Eo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=M0(e.v):e.w=sd(e.v):e.w=Ei(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ih(Ke[n]||String(n))){var i=Fc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Tm(e,t,r){return{v:e,ixfe:t,t:r}}function tte(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",h={},f,m="",_,g,v,y,b={},x=[],j,S,T=[],F=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},M=function(tt){return tt<8?Gc[tt]:tt<64&&F[tt-8]||Gc[tt]},A=function(tt,Xt,zn){var sr=Xt.XF.data;if(!(!sr||!sr.patternType||!zn||!zn.cellStyles)){Xt.s={},Xt.s.patternType=sr.patternType;var as;(as=I0(M(sr.icvFore)))&&(Xt.s.fgColor={rgb:as}),(as=I0(M(sr.icvBack)))&&(Xt.s.bgColor={rgb:as})}},D=function(tt,Xt,zn){if(!(ne>1)&&!(zn.sheetRows&&tt.r>=zn.sheetRows)){if(zn.cellStyles&&Xt.XF&&Xt.XF.data&&A(tt,Xt,zn),delete Xt.ixfe,delete Xt.XF,f=tt,m=Xe(tt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<o.s.r&&(o.s.r=tt.r),tt.c<o.s.c&&(o.s.c=tt.c),tt.r+1>o.e.r&&(o.e.r=tt.r+1),tt.c+1>o.e.c&&(o.e.c=tt.c+1),zn.cellFormula&&Xt.f){for(var sr=0;sr<x.length;++sr)if(!(x[sr][0].s.c>tt.c||x[sr][0].s.r>tt.r)&&!(x[sr][0].e.c<tt.c||x[sr][0].e.r<tt.r)){Xt.F=et(x[sr][0]),(x[sr][0].s.c!=tt.c||x[sr][0].s.r!=tt.r)&&delete Xt.f,Xt.f&&(Xt.f=""+wn(x[sr][1],o,tt,z,H));break}}zn.dense?(i[tt.r]||(i[tt.r]=[]),i[tt.r][tt.c]=Xt):i[m]=Xt}},H={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(H.password=t.password);var U,W=[],R=[],ae=[],le=[],G=!1,z=[];z.SheetNames=H.snames,z.sharedf=H.sharedf,z.arrayf=H.arrayf,z.names=[],z.XTI=[];var ie=0,ne=0,O=0,N=[],L=[],K;H.codepage=1200,Ki(1200);for(var re=!1;e.l<e.length-1;){var Z=e.l,me=e.read_shift(2);if(me===0&&ie===10)break;var B=e.l===e.length?0:e.read_shift(2),se=Uw[me];if(se&&se.f){if(t.bookSheets&&ie===133&&me!==133)break;if(ie=me,se.r===2||se.r==12){var we=e.read_shift(2);if(B-=2,!H.enc&&we!==me&&((we&255)<<8|we>>8)!==me)throw new Error("rt mismatch: "+we+"!="+me);se.r==12&&(e.l+=10,B-=10)}var V={};if(me===10?V=se.f(e,B,H):V=ete(me,se,e,B,H),ne==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(me){case 34:r.opts.Date1904=w.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(H.enc||(e.l=0),H.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=V;break;case 66:var Ce=Number(V);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}Ki(H.codepage=Ce),re=!0;break;case 317:H.rrtabid=V;break;case 25:H.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:H.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(i["!type"]="dialog"),V.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),V.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(V);break;case 430:z.push([V]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(V);break;case 24:case 536:K={Name:V.Name,Ref:wn(V.rgce,o,null,z,H)},V.itab>0&&(K.Sheet=V.itab-1),z.names.push(K),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(L[V.itab-1]={ref:et(V.rgce[0][0][1][2])});break;case 22:H.ExternCount=V;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(V),z.XTI=z.XTI.concat(V);break;case 2196:if(H.biff<8)break;K!=null&&(K.Comment=V[1]);break;case 18:i["!protect"]=V;break;case 19:V!==0&&H.WTF&&console.error("Password verifier: "+V);break;case 133:s[V.pos]=V,H.snames.push(V.name);break;case 10:{if(--ne)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=et(o),t.sheetRows&&t.sheetRows<=o.e.r){var qe=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=et(o),o.e.r=qe}o.e.r++,o.e.c++}W.length>0&&(i["!merges"]=W),R.length>0&&(i["!objects"]=R),ae.length>0&&(i["!cols"]=ae),le.length>0&&(i["!rows"]=le),w.Sheets.push(P)}u===""?h=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),H.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(H.biff=5,re=!0,Ki(H.codepage=28591)),H.biff==8&&V.BIFFVer==0&&V.dt==16&&(H.biff=2),ne++)break;if(i=t.dense?[]:{},H.biff<8&&!re&&(re=!0,Ki(H.codepage=t.codepage||1252)),H.biff<5||V.BIFFVer==0&&V.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-B,name:u};s[Te.pos]=Te,H.snames.push(u)}else u=(s[Z]||{name:""}).name;V.dt==32&&(i["!type"]="chart"),V.dt==64&&(i["!type"]="macro"),W=[],R=[],H.arrayf=x=[],ae=[],le=[],G=!1,P={Hidden:(s[Z]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[V.r]||[])[V.c]:i[Xe({c:V.c,r:V.r})])&&++V.c,j={ixfe:V.ixfe,XF:T[V.ixfe]||{},v:V.val,t:"n"},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 5:case 517:j={ixfe:V.ixfe,XF:T[V.ixfe],v:V.val,t:V.t},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 638:j={ixfe:V.ixfe,XF:T[V.ixfe],v:V.rknum,t:"n"},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 189:for(var E=V.c;E<=V.C;++E){var _e=V.rkrec[E-V.c][0];j={ixfe:_e,XF:T[_e],v:V.rkrec[E-V.c][1],t:"n"},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:E,r:V.r},j,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){l=V;break}if(j=Tm(V.val,V.cell.ixfe,V.tt),j.XF=T[j.ixfe],t.cellFormula){var wt=V.formula;if(wt&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp"){var Vr=wt[0][0][1][0],pn=wt[0][0][1][1],Nn=Xe({r:Vr,c:pn});b[Nn]?j.f=""+wn(V.formula,o,V.cell,z,H):j.F=((t.dense?(i[Vr]||[])[pn]:i[Nn])||{}).F}else j.f=""+wn(V.formula,o,V.cell,z,H)}O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D(V.cell,j,t),l=V}break;case 7:case 519:if(l)l.val=V,j=Tm(V,l.cell.ixfe,"s"),j.XF=T[j.ixfe],t.cellFormula&&(j.f=""+wn(l.formula,o,l.cell,z,H)),O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D(l.cell,j,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(V);var te=Xe(V[0].s);if(_=t.dense?(i[V[0].s.r]||[])[V[0].s.c]:i[te],t.cellFormula&&_){if(!l||!te||!_)break;_.f=""+wn(V[1],o,V[0],z,H),_.F=et(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!l)break;b[Xe(l.cell)]=V[0],_=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Xe(l.cell)],(_||{}).f=""+wn(V[0],o,f,z,H)}}break;case 253:j=Tm(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(j.h=c[V.isst].h),j.XF=T[j.ixfe],O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 513:t.sheetStubs&&(j={ixfe:V.ixfe,XF:T[V.ixfe],t:"z"},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t));break;case 190:if(t.sheetStubs)for(var Pe=V.c;Pe<=V.C;++Pe){var Qt=V.ixfe[Pe-V.c];j={ixfe:Qt,XF:T[Qt],t:"z"},O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:Pe,r:V.r},j,t)}break;case 214:case 516:case 4:j=Tm(V.val,V.ixfe,"s"),j.XF=T[j.ixfe],O>0&&(j.z=N[j.ixfe>>8&63]),us(j,t,r.opts.Date1904),D({c:V.c,r:V.r},j,t);break;case 0:case 512:ne===1&&(o=V);break;case 252:c=V;break;case 1054:if(H.biff==4){N[O++]=V[1];for(var Wa=0;Wa<O+163&&Ke[Wa]!=V[1];++Wa);Wa>=163&&xo(V[1],O+163)}else xo(V[1],V[0]);break;case 30:{N[O++]=V;for(var Fi=0;Fi<O+163&&Ke[Fi]!=V;++Fi);Fi>=163&&xo(V,O+163)}break;case 229:W=W.concat(V);break;case 93:R[V.cmo[0]]=H.lastobj=V;break;case 438:H.lastobj.TxO=V;break;case 127:H.lastobj.ImData=V;break;case 440:for(y=V[0].s.r;y<=V[0].e.r;++y)for(v=V[0].s.c;v<=V[0].e.c;++v)_=t.dense?(i[y]||[])[v]:i[Xe({c:v,r:y})],_&&(_.l=V[1]);break;case 2048:for(y=V[0].s.r;y<=V[0].e.r;++y)for(v=V[0].s.c;v<=V[0].e.c;++v)_=t.dense?(i[y]||[])[v]:i[Xe({c:v,r:y})],_&&_.l&&(_.l.Tooltip=V[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;_=t.dense?(i[V[0].r]||[])[V[0].c]:i[Xe(V[0])];var To=R[V[2]];_||(t.dense?(i[V[0].r]||(i[V[0].r]=[]),_=i[V[0].r][V[0].c]={t:"z"}):_=i[Xe(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),_.c||(_.c=[]),g={a:V[1],t:To.TxO.t},_.c.push(g)}break;case 2173:UX(T[V.ixfe],V.ext);break;case 125:{if(!H.cellStyles)break;for(;V.e>=V.s;)ae[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},G||(G=!0,Wk(V.w/256)),zl(ae[V.e+1])}break;case 520:{var Hr={};V.level!=null&&(le[V.r]=Hr,Hr.level=V.level),V.hidden&&(le[V.r]=Hr,Hr.hidden=!0),V.hpt&&(le[V.r]=Hr,Hr.hpt=V.hpt,Hr.hpx=Xu(V.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Xc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=V;break;case 161:i["!margins"]||Xc(i["!margins"]={}),i["!margins"].header=V.header,i["!margins"].footer=V.footer;break;case 574:V.RTL&&(w.Views[0].RTL=!0);break;case 146:F=V;break;case 2198:U=V;break;case 140:S=V;break;case 442:u?P.CodeName=V||P.name:w.WBProps.CodeName=V||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+me.toString(16)),e.l+=B}return r.SheetNames=pr(s).sort(function(ka,tt){return Number(ka)-Number(tt)}).map(function(ka){return s[ka].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&L.forEach(function(ka,tt){r.Sheets[r.SheetNames[tt]]["!autofilter"]=ka}),r.Strings=c,r.SSF=Kt(Ke),H.enc&&(r.Encryption=H.enc),U&&(r.Themes=U),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),z.names.length>0&&(w.Names=z.names),r.Workbook=w,r}var l0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rte(e,t,r){var n=Ge.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=jT(n,Ow,l0.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=Ge.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=jT(o,Rw,l0.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(O8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function nte(e,t){var r=[],n=[],i=[],s=0,o,l=JE(Ow,"n"),c=JE(Rw,"n");if(e.Props)for(o=pr(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=pr(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)U8.indexOf(i[s][0])>-1||M8.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Ge.utils.cfb_add(t,"/SummaryInformation",wT(n,l0.SI,c,Rw)),(r.length||u.length)&&Ge.utils.cfb_add(t,"/DocumentSummaryInformation",wT(r,l0.DSI,l,Ow,u.length?u:null,l0.UDI))}function NM(e,t){t||(t={}),eS(t),bk(),t.codepage&&yk(t.codepage);var r,n;if(e.FullPaths){if(Ge.find(e,"/encryption"))throw new Error("File is password-protected");r=Ge.find(e,"!CompObj"),n=Ge.find(e,"/Workbook")||Ge.find(e,"/Book")}else{switch(t.type){case"base64":e=Ra(Ua(e));break;case"binary":e=Ra(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ln(e,0),n={content:e}}var i,s;if(r&&Jee(r),t.bookProps&&!t.bookSheets)i={};else{var o=dt?"buffer":"array";if(n&&n.content)i=tte(n.content,t);else if((s=Ge.find(e,"PerfectOffice_MAIN"))&&s.content)i=Kc.to_workbook(s.content,(t.type=o,t));else if((s=Ge.find(e,"NativeContent_MAIN"))&&s.content)i=Kc.to_workbook(s.content,(t.type=o,t));else throw(s=Ge.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ge.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=gY(e))}var l={};return e.FullPaths&&rte(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function ate(e,t){var r=t||{},n=Ge.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ge.utils.cfb_add(n,i,zM(e,r)),r.biff==8&&(e.Props||e.Custprops)&&nte(e,n),r.biff==8&&e.vbaraw&&xY(n,Ge.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var V0={0:{f:EJ},1:{f:RJ},2:{f:tZ},3:{f:HJ},4:{f:LJ},5:{f:JJ},6:{f:sZ},7:{f:KJ},8:{f:fZ},9:{f:hZ},10:{f:dZ},11:{f:uZ},12:{f:zJ},13:{f:nZ},14:{f:GJ},15:{f:UJ},16:{f:TM},17:{f:lZ},18:{f:YJ},19:{f:Ok},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:lee},40:{},42:{},43:{f:sX},44:{f:aX},45:{f:cX},46:{f:uX},47:{f:dX},48:{},49:{f:FW},50:{},51:{f:WX},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Z8},62:{f:iZ},63:{f:eY},64:{f:TZ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SZ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MJ},148:{f:FJ,p:16},151:{f:_Z},152:{},153:{f:iee},154:{},155:{},156:{f:nee},157:{},158:{},159:{T:1,f:bK},160:{T:-1},161:{T:1,f:jd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pZ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:VX},336:{T:-1},337:{f:KX,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Mw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:J8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yZ},427:{f:bZ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wZ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:PJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xZ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Mw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uY},633:{T:1},634:{T:-1},635:{T:1,f:cY},636:{T:-1},637:{f:OW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:GZ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AZ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Uw={6:{f:xy},10:{f:Ho},12:{f:Tr},13:{f:Tr},14:{f:xr},15:{f:xr},16:{f:$n},17:{f:xr},18:{f:xr},19:{f:Tr},20:{f:TT},21:{f:TT},23:{f:J8},24:{f:FT},25:{f:xr},26:{},27:{},28:{f:Aq},29:{},34:{f:xr},35:{f:AT},38:{f:$n},39:{f:$n},40:{f:$n},41:{f:$n},42:{f:xr},43:{f:xr},47:{f:UK},49:{f:nq},51:{f:Tr},60:{},61:{f:JG},64:{f:xr},65:{f:rq},66:{f:Tr},77:{},80:{},81:{},82:{},85:{f:Tr},89:{},90:{},91:{},92:{f:BG},93:{f:Pq},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:Z8},128:{f:vq},129:{f:VG},130:{f:Tr},131:{f:xr},132:{f:xr},133:{f:HG},134:{},140:{f:Bq},141:{f:Tr},144:{},146:{f:Hq},151:{},152:{},153:{},154:{},155:{},156:{f:Tr},157:{},158:{},160:{f:Qq},161:{f:qq},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pq},190:{f:mq},193:{f:Ho},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tr},220:{},221:{f:xr},222:{},224:{f:xq},225:{f:LG},226:{f:Ho},227:{},229:{f:Fq},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:GG},253:{f:iq},255:{f:KG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V8},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:Ho},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wq},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:Rq},439:{f:xr},440:{f:Nq},441:{},442:{f:vp},443:{},444:{f:Tr},445:{},446:{},448:{f:Ho},449:{f:QG,r:2},450:{f:Ho},512:{f:CT},513:{f:Yq},515:{f:bq},516:{f:oq},517:{f:ET},519:{f:Jq},520:{f:XG},523:{},545:{f:DT},549:{f:ST},566:{},574:{f:eq},638:{f:fq},659:{},1048:{},1054:{f:cq},1084:{},1212:{f:$q},2048:{f:Iq},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Cm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ho},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Wq,r:12},2173:{f:BX,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Cq,r:12},2197:{},2198:{f:OX,r:12},2199:{},2200:{},2201:{},2202:{f:Eq,r:12},2203:{f:Ho},2204:{},2205:{},2206:{},2207:{},2211:{f:YG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Kq},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Vq},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:CT},1:{},2:{f:nK},3:{f:tK},4:{f:eK},5:{f:ET},7:{f:iK},8:{},9:{f:Cm},11:{},22:{f:Tr},30:{f:uq},31:{},32:{},33:{f:DT},36:{},37:{f:ST},50:{f:sK},62:{},52:{},67:{},68:{f:Tr},69:{},86:{},126:{},127:{f:Zq},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:oK},223:{},234:{},354:{},421:{},518:{f:xy},521:{f:Cm},536:{f:FT},547:{f:AT},561:{},579:{},1030:{f:xy},1033:{f:Cm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ee(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Dk(r)&&e.push(r)}}function ite(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ee(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(h=e.next(4),h.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;h.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function jp(e,t,r){return e||(e=xe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function ste(e,t,r,n){var i=xe(9);return jp(i,e,t),H8(r,n||"b",i),i}function ote(e,t,r){var n=xe(8+2*r.length);return jp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function lte(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Ur(qt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ee(e,2,aK(r,n,i)):Ee(e,3,rK(r,n,i));return;case"b":case"e":Ee(e,5,ste(r,n,t.v,t.t));return;case"s":case"str":Ee(e,4,ote(r,n,(t.v||"").slice(0,255)));return}Ee(e,1,jp(null,r,n))}function cte(e,t,r,n){var i=Array.isArray(t),s=yt(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=et(s)}for(var u=s.s.r;u<=s.e.r;++u){l=br(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(c[h]=tr(h)),o=c[h]+l;var f=i?(t[u]||[])[h]:t[o];f&&lte(e,f,u,h)}}}function dte(e,t){for(var r=t||{},n=ja(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ee(n,r.biff==4?1033:r.biff==3?521:9,Uk(e,16,r)),cte(n,e.Sheets[e.SheetNames[i]],i,r),Ee(n,10),n.end()}function ute(e,t,r){Ee(e,49,aq({sz:12,name:"Arial"},r))}function hte(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ee(e,1054,dq(i,t[i],r))})}function fte(e,t){var r=xe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ee(e,2151,r),r=xe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),X8(yt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ee(e,2152,r)}function pte(e,t){for(var r=0;r<16;++r)Ee(e,224,$T({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ee(e,224,$T(n,0,t))})}function mte(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ee(e,440,zq(n)),n[1].Tooltip&&Ee(e,2048,Lq(n))}delete t["!links"]}function gte(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ee(e,125,Gq(dv(i,n),i))})}}function xte(e,t,r,n,i){var s=16+ql(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ee(e,513,dd(r,n,s));return}if(t.bf)Ee(e,6,VQ(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ur(qt(t.v)):t.v;Ee(e,515,jq(r,n,o,s));break;case"b":case"e":Ee(e,517,yq(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=Yk(i.Strings,t.v,i.revStrings);Ee(e,253,sq(r,n,l,s))}else Ee(e,516,lq(r,n,(t.v||"").slice(0,255),s,i));break;default:Ee(e,513,dd(r,n,s))}}function vte(e,t,r){var n=ja(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,h,f="",m=[],_=yt(s["!ref"]||"A1"),g=u?65536:16384;if(_.e.c>255||_.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,g-1)}Ee(n,2057,Uk(r,16,t)),Ee(n,13,gi(1)),Ee(n,12,gi(100)),Ee(n,15,Kn(!0)),Ee(n,17,Kn(!1)),Ee(n,16,ld(.001)),Ee(n,95,Kn(!0)),Ee(n,42,Kn(!1)),Ee(n,43,Kn(!1)),Ee(n,130,gi(1)),Ee(n,128,_q()),Ee(n,131,Kn(!1)),Ee(n,132,Kn(!1)),u&&gte(n,s["!cols"]),Ee(n,512,hq(_,t)),u&&(s["!links"]=[]);for(var v=_.s.r;v<=_.e.r;++v){f=br(v);for(var y=_.s.c;y<=_.e.c;++y){v===_.s.r&&(m[y]=tr(y)),h=m[y]+f;var b=c?(s[v]||[])[y]:s[h];b&&(xte(n,b,v,y,t),u&&b.l&&s["!links"].push([h,b.l]))}}var x=l.CodeName||l.name||i;return u&&Ee(n,574,tq((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ee(n,229,Dq(s["!merges"])),u&&mte(n,s),Ee(n,442,W8(x)),u&&fte(n,s),Ee(n,10),n.end()}function _te(e,t,r){var n=ja(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ee(n,2057,Uk(e,5,r)),r.bookType=="xla"&&Ee(n,135),Ee(n,225,l?gi(1200):null),Ee(n,193,yG(2)),c&&Ee(n,191),c&&Ee(n,192),Ee(n,226),Ee(n,92,UG("SheetJS",r)),Ee(n,66,gi(l?1200:1252)),l&&Ee(n,353,gi(0)),l&&Ee(n,448),Ee(n,317,Xq(e.SheetNames.length)),l&&e.vbaraw&&Ee(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Ee(n,442,W8(u))}Ee(n,156,gi(17)),Ee(n,25,Kn(!1)),Ee(n,18,Kn(!1)),Ee(n,19,gi(0)),l&&Ee(n,431,Kn(!1)),l&&Ee(n,444,gi(0)),Ee(n,61,ZG()),Ee(n,64,Kn(!1)),Ee(n,141,gi(0)),Ee(n,34,Kn(QZ(e)=="true")),Ee(n,14,Kn(!0)),l&&Ee(n,439,Kn(!1)),Ee(n,218,gi(0)),ute(n,e,r),hte(n,e.SSF,r),pte(n,r),l&&Ee(n,352,Kn(!1));var h=n.end(),f=ja();l&&Ee(f,140,Uq()),l&&r.Strings&&ite(f,252,qG(r.Strings)),Ee(f,10);var m=f.end(),_=ja(),g=0,v=0;for(v=0;v<e.SheetNames.length;++v)g+=(l?12:11)+(l?2:1)*e.SheetNames[v].length;var y=h.length+g+m.length;for(v=0;v<e.SheetNames.length;++v){var b=s[v]||{};Ee(_,133,WG({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[v]},r)),y+=t[v].length}var x=_.end();if(g!=x.length)throw new Error("BS8 "+g+" != "+x.length);var j=[];return h.length&&j.push(h),x.length&&j.push(x),m.length&&j.push(m),Yr(j)}function yte(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Kt(Ke)),e&&e.SSF&&(sh(),nv(e.SSF),r.revssf=iv(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,tS(r),r.cellXfs=[],ql(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=vte(i,r,e);return n.unshift(_te(e,n,r)),Yr(n)}function zM(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=wa(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return yte(e,t);case 4:case 3:case 2:return dte(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function UT(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=aW(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,f=0,m=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var v=c[o].trim(),y=v.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(y!="<td"&&y!="<th")){var b=v.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var x=b[l].trim();if(x.match(/<t[dh]/i)){for(var j=x,S=0;j.charAt(0)=="<"&&(S=j.indexOf(">"))>-1;)j=j.slice(S+1);for(var T=0;T<g.length;++T){var F=g[T];F.s.c==h&&F.s.r<u&&u<=F.e.r&&(h=F.e.c+1,T=-1)}var w=Ye(x.slice(0,x.indexOf(">")));m=w.colspan?+w.colspan:1,((f=+w.rowspan)>1||m>1)&&g.push({s:{r:u,c:h},e:{r:u+(f||1)-1,c:h+m-1}});var P=w.t||w["data-t"]||"";if(!j.length){h+=m;continue}if(j=l8(j),_.s.r>u&&(_.s.r=u),_.e.r<u&&(_.e.r=u),_.s.c>h&&(_.s.c=h),_.e.c<h&&(_.e.c=h),!j.length){h+=m;continue}var M={t:"s",v:j};r.raw||!j.trim().length||P=="s"||(j==="TRUE"?M={t:"b",v:!0}:j==="FALSE"?M={t:"b",v:!1}:isNaN(Zi(j))?isNaN(qu(j).getDate())||(M={t:"d",v:qt(j)},r.cellDates||(M={t:"n",v:Ur(M.v)}),M.z=r.dateNF||Ke[14]):M={t:"n",v:Zi(j)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=M):n[Xe({r:u,c:h})]=M,h+=m}}}}return n["!ref"]=et(_),g.length&&(n["!merges"]=g),n}function bte(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var h=Xe({r,c:o}),f=n.dense?(e[r]||[])[o]:e[h],m=f&&f.v!=null&&(f.h||Tk(f.w||(ko(f),f.w)||""))||"",_={};l>1&&(_.rowspan=l),c>1&&(_.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(_["data-t"]=f&&f.t||"z",f.v!=null&&(_["data-v"]=f.v),f.z!=null&&(_["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),_.id=(n.id||"sjs")+"-"+h,s.push($e("td",m,_))}}var g="<tr>";return g+s.join("")+"</tr>"}var jte='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wte="</body></html>";function kte(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Gl(UT(r[0],t),t);var n=aS();return r.forEach(function(i,s){iS(n,UT(i,t),"Sheet"+(s+1))}),n}function Ste(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function IM(e,t){var r=t||{},n=r.header!=null?r.header:jte,i=r.footer!=null?r.footer:wte,s=[n],o=wa(e["!ref"]);r.dense=Array.isArray(e),s.push(Ste(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(bte(e,o,l,r));return s.push("</table>"+i),s.join("")}function LM(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?rr(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var h=wa(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],m=0,_=e["!rows"]||(e["!rows"]=[]),g=0,v=0,y=0,b=0,x=0,j=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&v<c;++g){var S=l[g];if(VT(S)){if(n.display)continue;_[v]={hidden:!0}}var T=S.children;for(y=b=0;y<T.length;++y){var F=T[y];if(!(n.display&&VT(F))){var w=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):l8(F.innerHTML),P=F.getAttribute("data-z")||F.getAttribute("z");for(m=0;m<f.length;++m){var M=f[m];M.s.c==b+s&&M.s.r<v+i&&v+i<=M.e.r&&(b=M.e.c+1-s,m=-1)}j=+F.getAttribute("colspan")||1,((x=+F.getAttribute("rowspan")||1)>1||j>1)&&f.push({s:{r:v+i,c:b+s},e:{r:v+i+(x||1)-1,c:b+s+(j||1)-1}});var A={t:"s",v:w},D=F.getAttribute("data-t")||F.getAttribute("t")||"";w!=null&&(w.length==0?A.t=D||"z":n.raw||w.trim().length==0||D=="s"||(w==="TRUE"?A={t:"b",v:!0}:w==="FALSE"?A={t:"b",v:!1}:isNaN(Zi(w))?isNaN(qu(w).getDate())||(A={t:"d",v:qt(w)},n.cellDates||(A={t:"n",v:Ur(A.v)}),A.z=n.dateNF||Ke[14]):A={t:"n",v:Zi(w)})),A.z===void 0&&P!=null&&(A.z=P);var H="",U=F.getElementsByTagName("A");if(U&&U.length)for(var W=0;W<U.length&&!(U[W].hasAttribute("href")&&(H=U[W].getAttribute("href"),H.charAt(0)!="#"));++W);H&&H.charAt(0)!="#"&&(A.l={Target:H}),n.dense?(e[v+i]||(e[v+i]=[]),e[v+i][b+s]=A):e[Xe({c:b+s,r:v+i})]=A,u.e.c<b+s&&(u.e.c=b+s),b+=j}}++v}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,v-1+i),e["!ref"]=et(u),v>=c&&(e["!fullref"]=et((u.e.r=l.length-g+v-1+i,u))),e}function BM(e,t){var r=t||{},n=r.dense?[]:{};return LM(n,e,t)}function Cte(e,t){return Gl(BM(e,t),t)}function VT(e){var t="",r=$te(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $te(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ete(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=_t(t.replace(/<[^>]*>/g,""));return[r]}var HT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function UM(e,t){var r=t||{},n=Ak(e),i=[],s,o,l={name:""},c="",u=0,h,f,m={},_=[],g=r.dense?[]:{},v,y,b={value:""},x="",j=0,S=[],T=-1,F=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,M={},A=[],D={},H=0,U=0,W=[],R=1,ae=1,le=[],G={Names:[]},z={},ie=["",""],ne=[],O={},N="",L=0,K=!1,re=!1,Z=0;for(N0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=N0.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?g["!ref"]=et(w):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(g["!fullref"]=g["!ref"],w.e.r=r.sheetRows-1,g["!ref"]=et(w)),A.length&&(g["!merges"]=A),W.length&&(g["!rows"]=W),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),_.push(h.name),m[h.name]=g,re=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=Ye(v[0],!1),T=F=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,g=r.dense?[]:{},A=[],W=[],re=!0);break;case"table-row-group":v[1]==="/"?--P:++P;break;case"table-row":case"":if(v[1]==="/"){T+=R,R=1;break}if(f=Ye(v[0],!1),f.?T=f.-1:T==-1&&(T=0),R=+f["number-rows-repeated"]||1,R<10)for(Z=0;Z<R;++Z)P>0&&(W[T+Z]={level:P});F=-1;break;case"covered-table-cell":v[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(g[T]||(g[T]=[]),g[T][F]={t:"z"}):g[Xe({r:T,c:F})]={t:"z"}),x="",S=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++F,b=Ye(v[0],!1),ae=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=IT(_t(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=_t(b["string-value"]||""),r.dense?(g[T]||(g[T]=[]),g[T][F]=y):g[Xe({r:T,c:F})]=y),F+=ae-1;else if(v[1]!=="/"){++F,x="",j=0,S=[],ae=1;var me=R?T+R-1:T;if(F>w.e.c&&(w.e.c=F),F<w.s.c&&(w.s.c=F),T<w.s.r&&(w.s.r=T),me>w.e.r&&(w.e.r=me),b=Ye(v[0],!1),ne=[],O={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=_t(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(H=parseInt(b["number-matrix-rows-spanned"],10)||0,U=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:T,c:F},e:{r:T+H-1,c:F+U-1}},y.F=et(D),le.push([D,y.F])),b.formula)y.f=IT(b.formula);else for(Z=0;Z<le.length;++Z)T>=le[Z][0].s.r&&T<=le[Z][0].e.r&&F>=le[Z][0].s.c&&F<=le[Z][0].e.c&&(y.F=le[Z][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(H=parseInt(b["number-rows-spanned"],10)||0,U=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:T,c:F},e:{r:T+H-1,c:F+U-1}},A.push(D)),b["number-columns-repeated"]&&(ae=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Wt(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=qt(b["date-value"]),r.cellDates||(y.t="n",y.v=Ur(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=tW(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=sv(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(x=_t(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(K=!1,y.t==="s"&&(y.v=x||"",S.length&&(y.R=S),K=j==0),z.Target&&(y.l=z),ne.length>0&&(y.c=ne,ne=[]),x&&r.cellText!==!1&&(y.w=x),K&&(y.t="z",delete y.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var B=0;B<R;++B){if(ae=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(g[T+B]||(g[T+B]=[]),g[T+B][F]=B==0?y:Kt(y);--ae>0;)g[T+B][F+ae]=Kt(y);else for(g[Xe({r:T+B,c:F})]=y;--ae>0;)g[Xe({r:T+B,c:F+ae})]=Kt(y);w.e.c<=F&&(w.e.c=F)}ae=parseInt(b["number-columns-repeated"]||"1",10),F+=ae-1,ae=0,y={},x="",S=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s;O.t=x,S.length&&(O.R=S),O.a=N,ne.push(O)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);N="",L=0,x="",j=0,S=[];break;case"creator":v[1]==="/"?N=n.slice(L,v.index):L=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);x="",j=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(M[l.name]=c,(s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(c="",l=Ye(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(v[0],!1),c+=HT[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(v[0],!1),c+=HT[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":o=Ye(v[0],!1),ie=vy(o["cell-range-address"]);var se={Name:o.name,Ref:ie[0]+"!"+ie[1]};re&&(se.Sheet=_.length),G.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!b||!b["string-value"])){var we=Ete(n.slice(j,v.index));x=(x.length>0?x+`
`:"")+we[0]}else Ye(v[0],!1),j=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ie=vy(Ye(v[0])["target-range-address"]),m[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(z=Ye(v[0],!1),!z.href)break;z.Target=_t(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ie=vy(z.Target.slice(1)),z.Target="#"+ie[0]+"!"+ie[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var V={Sheets:m,SheetNames:_,Workbook:G};return r.bookSheets&&delete V.Sheets,V}function WT(e,t){t=t||{},pi(e,"META-INF/manifest.xml")&&tG(Er(e,"META-INF/manifest.xml"),t);var r=Na(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=UM(Rt(r),t);return pi(e,"meta.xml")&&(n.Props=D8(Er(e,"meta.xml"))),n}function GT(e,t){return UM(e,t)}var Tte=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+R0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return jr+t}}(),qT=function(){var e=function(s){return Mt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Mt(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,h=0,f=wa(s["!ref"]||"A1"),m=s["!merges"]||[],_=0,g=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",y=s["!rows"]||[];for(u=0;u<f.s.r;++u)v=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=f.e.r;++u){for(v=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+v+`>
`),h=0;h<f.s.c;++h)c.push(t);for(;h<=f.e.c;++h){var b=!1,x={},j="";for(_=0;_!=m.length;++_)if(!(m[_].s.c>h)&&!(m[_].s.r>u)&&!(m[_].e.c<h)&&!(m[_].e.r<u)){(m[_].s.c!=h||m[_].s.r!=u)&&(b=!0),x["table:number-columns-spanned"]=m[_].e.c-m[_].s.c+1,x["table:number-rows-spanned"]=m[_].e.r-m[_].s.r+1;break}if(b){c.push(r);continue}var S=Xe({r:u,c:h}),T=g?(s[u]||[])[h]:s[S];if(T&&T.f&&(x["table:formula"]=Mt(XQ(T.f)),T.F&&T.F.slice(0,S.length)==S)){var F=wa(T.F);x["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,x["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!T){c.push(t);continue}switch(T.t){case"b":j=T.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=T.v?"true":"false";break;case"n":j=T.w||String(T.v||0),x["office:value-type"]="float",x["office:value"]=T.v||0;break;case"s":case"str":j=T.v==null?"":T.v,x["office:value-type"]="string";break;case"d":j=T.w||qt(T.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=qt(T.v).toISOString(),x["table:style-name"]="ce1";break;default:c.push(t);continue}var w=e(j);if(T.l&&T.l.Target){var P=T.l.Target;P=P.charAt(0)=="#"?"#"+YQ(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),w=$e("text:a",w,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+$e("table:table-cell",$e("text:p",w,{}),x)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;zl(f),f.ods=l;var m=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=c;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[jr],u=R0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=R0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+h+`>
`),c.push(F8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function VM(e,t){if(t.bookType=="fods")return qT(e,t);var r=Ck(),n="",i=[],s=[];return n="mimetype",rt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",rt(r,n,qT(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",rt(r,n,Tte(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",rt(r,n,jr+F8()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",rt(r,n,aG(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",rt(r,n,rG(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ud(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Vw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rt(Wl(e))}function Ate(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ra(Ts(e))}function Fte(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ll(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function KT(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Dte(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Pte(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function H0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function At(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function hr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function bt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=H0(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=H0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function sn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(At(n*8+i.type)),i.type==2&&t.push(At(i.data.length)),t.push(i.data))})}),Ll(t)}function Zk(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function hi(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=H0(e,n),s=bt(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:hr(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=bt(l.data),u=hr(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=hr(s[3][0].data)>>>0>0),r.push(o)}return r}function Pd(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:At(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:At(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:At(o.data.length)}],n[2].push({data:sn(o.meta),type:2})});var s=sn(n);t.push(At(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),Ll(t)}function Mte(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=H0(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ll(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var h=Ll(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function fi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Mte(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ll(t)}function Md(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=At(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Ll(t)}function Ote(e,t,r,n){var i=ud(e),s=i.getUint32(4,!0),o=(n>1?12:8)+KT(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,h=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=KT(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Rte(e,t,r){var n=ud(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);i&1&&(c=Dte(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function yy(e,t){var r=new Uint8Array(32),n=ud(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Pte(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function by(e,t){var r=new Uint8Array(32),n=ud(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Nte(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ote(e,t,r,e[0]);case 5:return Rte(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function jn(e){var t=bt(e);return H0(t[1][0].data)}function XT(e,t){var r=bt(t.data),n=hr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=bt(o.data),c=hr(l[1][0].data)>>>0;switch(n){case 1:s[c]=Vw(l[3][0].data);break;case 8:{var u=e[jn(l[9][0].data)][0],h=bt(u.data),f=e[jn(h[1][0].data)][0],m=hr(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var _=bt(f.data);s[c]=_[3].map(function(g){return Vw(g.data)}).join("")}break}}),s}function zte(e,t){var r,n,i,s,o,l,c,u,h,f,m,_,g,v,y=bt(e),b=hr(y[1][0].data)>>>0,x=hr(y[2][0].data)>>>0,j=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&hr(y[8][0].data)>0||!1,S,T;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,T=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(h=y[4])==null?void 0:h[0])!=null&&f.data&&t!=1)S=(_=(m=y[4])==null?void 0:m[0])==null?void 0:_.data,T=(v=(g=y[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=j?4:1,w=ud(S),P=[],M=0;M<S.length/2;++M){var A=w.getUint16(M*2,!0);A<65535&&P.push([M,A])}if(P.length!=x)throw"Expected ".concat(x," cells, found ").concat(P.length);var D=[];for(M=0;M<P.length-1;++M)D[P[M][0]]=T.subarray(P[M][1]*F,P[M+1][1]*F);return P.length>=1&&(D[P[P.length-1][0]]=T.subarray(P[P.length-1][1]*F)),{R:b,cells:D}}function Ite(e,t){var r,n=bt(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?hr(n[7][0].data)>>>0>0?1:0:-1,s=Zk(n[5],function(o){return zte(o,i)});return{nrows:hr(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function Lte(e,t,r){var n,i=bt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(hr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(hr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=et(s);var o=bt(i[4][0].data),l=XT(e,e[jn(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?XT(e,e[jn(o[17][0].data)][0]):[],u=bt(o[3][0].data),h=0;u[1].forEach(function(f){var m=bt(f.data),_=e[jn(m[2][0].data)][0],g=hr(_.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var v=Ite(e,_);v.data.forEach(function(y,b){y.forEach(function(x,j){var S=Xe({r:h+b,c:j}),T=Nte(x,l,c);T&&(r[S]=T)})}),h+=v.nrows})}function Bte(e,t){var r=bt(t.data),n={"!ref":"A1"},i=e[jn(r[2][0].data)],s=hr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Lte(e,i[0],n),n}function Ute(e,t){var r,n=bt(t.data),i={name:(r=n[1])!=null&&r[0]?Vw(n[1][0].data):"",sheets:[]},s=Zk(n[2],jn);return s.forEach(function(o){e[o].forEach(function(l){var c=hr(l.meta[1][0].data);c==6e3&&i.sheets.push(Bte(e,l))})}),i}function Vte(e,t){var r=aS(),n=bt(t.data),i=Zk(n[1],jn);if(i.forEach(function(s){e[s].forEach(function(o){var l=hr(o.meta[1][0].data);if(l==2){var c=Ute(e,o);c.sheets.forEach(function(u,h){iS(r,u,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jy(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=fi(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=hi(u)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&hr(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var h=hr(u.meta[1][0].data)>>>0;if(h==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Vte(s,l)}function Hte(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&hr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=ud(e[7][0].data),h=0,f=[],m=ud(e[4][0].data),_=0,g=[],v=0;v<t.length;++v){if(t[v]==null){u.setUint16(v*2,65535,!0),m.setUint16(v*2,65535);continue}u.setUint16(v*2,h,!0),m.setUint16(v*2,_,!0);var y,b;switch(typeof t[v]){case"string":y=yy({t:"s",v:t[v]},r),b=by({t:"s",v:t[v]},r);break;case"number":y=yy({t:"n",v:t[v]},r),b=by({t:"n",v:t[v]},r);break;case"boolean":y=yy({t:"b",v:t[v]},r),b=by({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}f.push(y),h+=y.length,g.push(b),_+=b.length,++c}for(e[2][0].data=At(c);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),m.setUint16(v*2,65535,!0);return e[6][0].data=Ll(f),e[3][0].data=Ll(g),c}function Wte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=wa(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(et(n)));var s=_1(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(N){return N.forEach(function(L){typeof L=="string"&&o.push(L)})});var l={},c=[],u=Ge.read(t.numbers,{type:"base64"});u.FileIndex.map(function(N,L){return[N,u.FullPaths[L]]}).forEach(function(N){var L=N[0],K=N[1];if(L.type==2&&L.name.match(/\.iwa/)){var re=L.content,Z=fi(re),me=hi(Z);me.forEach(function(B){c.push(B.id),l[B.id]={deps:[],location:K,type:hr(B.messages[0].meta[1][0].data)}})}}),c.sort(function(N,L){return N-L});var h=c.filter(function(N){return N>1}).map(function(N){return[N,At(N)]});u.FileIndex.map(function(N,L){return[N,u.FullPaths[L]]}).forEach(function(N){var L=N[0];if(N[1],!!L.name.match(/\.iwa/)){var K=hi(fi(L.content));K.forEach(function(re){re.messages.forEach(function(Z){h.forEach(function(me){re.messages.some(function(B){return hr(B.meta[1][0].data)!=11006&&Fte(B.data,me[1])})&&l[me[0]].deps.push(re.id)})})})}});for(var f=Ge.find(u,l[1].location),m=hi(fi(f.content)),_,g=0;g<m.length;++g){var v=m[g];v.id==1&&(_=v)}var y=jn(bt(_.messages[0].data)[1][0].data);for(f=Ge.find(u,l[y].location),m=hi(fi(f.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(_=v);for(y=jn(bt(_.messages[0].data)[2][0].data),f=Ge.find(u,l[y].location),m=hi(fi(f.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(_=v);for(y=jn(bt(_.messages[0].data)[2][0].data),f=Ge.find(u,l[y].location),m=hi(fi(f.content)),g=0;g<m.length;++g)v=m[g],v.id==y&&(_=v);var b=bt(_.messages[0].data);{b[6][0].data=At(n.e.r+1),b[7][0].data=At(n.e.c+1);var x=jn(b[46][0].data),j=Ge.find(u,l[x].location),S=hi(fi(j.content));{for(var T=0;T<S.length&&S[T].id!=x;++T);if(S[T].id!=x)throw"Bad ColumnRowUIDMapArchive";var F=bt(S[T].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var w=0;w<=n.e.c;++w){var P=[];P[1]=P[2]=[{type:0,data:At(w+420690)}],F[1].push({type:2,data:sn(P)}),F[2].push({type:0,data:At(w)}),F[3].push({type:0,data:At(w)})}F[4]=[],F[5]=[],F[6]=[];for(var M=0;M<=n.e.r;++M)P=[],P[1]=P[2]=[{type:0,data:At(M+726270)}],F[4].push({type:2,data:sn(P)}),F[5].push({type:0,data:At(M)}),F[6].push({type:0,data:At(M)});S[T].messages[0].data=sn(F)}j.content=Md(Pd(S)),j.size=j.content.length,delete b[46];var A=bt(b[4][0].data);{A[7][0].data=At(n.e.r+1);var D=bt(A[1][0].data),H=jn(D[2][0].data);j=Ge.find(u,l[H].location),S=hi(fi(j.content));{if(S[0].id!=H)throw"Bad HeaderStorageBucket";var U=bt(S[0].messages[0].data);for(M=0;M<s.length;++M){var W=bt(U[2][0].data);W[1][0].data=At(M),W[4][0].data=At(s[M].length),U[2][M]={type:U[2][0].type,data:sn(W)}}S[0].messages[0].data=sn(U)}j.content=Md(Pd(S)),j.size=j.content.length;var R=jn(A[2][0].data);j=Ge.find(u,l[R].location),S=hi(fi(j.content));{if(S[0].id!=R)throw"Bad HeaderStorageBucket";for(U=bt(S[0].messages[0].data),w=0;w<=n.e.c;++w)W=bt(U[2][0].data),W[1][0].data=At(w),W[4][0].data=At(n.e.r+1),U[2][w]={type:U[2][0].type,data:sn(W)};S[0].messages[0].data=sn(U)}j.content=Md(Pd(S)),j.size=j.content.length;var ae=jn(A[4][0].data);(function(){for(var N=Ge.find(u,l[ae].location),L=hi(fi(N.content)),K,re=0;re<L.length;++re){var Z=L[re];Z.id==ae&&(K=Z)}var me=bt(K.messages[0].data);{me[3]=[];var B=[];o.forEach(function(V,Ce){B[1]=[{type:0,data:At(Ce)}],B[2]=[{type:0,data:At(1)}],B[3]=[{type:2,data:Ate(V)}],me[3].push({type:2,data:sn(B)})})}K.messages[0].data=sn(me);var se=Pd(L),we=Md(se);N.content=we,N.size=N.content.length})();var le=bt(A[3][0].data);{var G=le[1][0];delete le[2];var z=bt(G.data);{var ie=jn(z[2][0].data);(function(){for(var N=Ge.find(u,l[ie].location),L=hi(fi(N.content)),K,re=0;re<L.length;++re){var Z=L[re];Z.id==ie&&(K=Z)}var me=bt(K.messages[0].data);{delete me[6],delete le[7];var B=new Uint8Array(me[5][0].data);me[5]=[];for(var se=0,we=0;we<=n.e.r;++we){var V=bt(B);se+=Hte(V,s[we],o),V[1][0].data=At(we),me[5].push({data:sn(V),type:2})}me[1]=[{type:0,data:At(n.e.c+1)}],me[2]=[{type:0,data:At(n.e.r+1)}],me[3]=[{type:0,data:At(se)}],me[4]=[{type:0,data:At(n.e.r+1)}]}K.messages[0].data=sn(me);var Ce=Pd(L),qe=Md(Ce);N.content=qe,N.size=N.content.length})()}G.data=sn(z)}A[3][0].data=sn(le)}b[4][0].data=sn(A)}_.messages[0].data=sn(b);var ne=Pd(m),O=Md(ne);return f.content=O,f.size=f.content.length,u}function HM(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function eS(e){HM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function tS(e){HM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Gte(e){return ut.WS.indexOf(e)>-1?"sheet":e==ut.CS?"chart":e==ut.DS?"dialog":e==ut.MS?"macro":e&&e.length?e:"sheet"}function qte(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Gte(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Kte(e,t,r,n,i,s,o,l,c,u,h,f){try{s[n]=a0(Na(e,r,!0),t);var m=Er(e,t),_;switch(l){case"sheet":_=gee(m,t,i,c,s[n],u,h,f);break;case"chart":if(_=xee(m,t,i,c,s[n],u,h,f),!_||!_["!drawel"])break;var g=Lf(_["!drawel"].Target,t),v=z0(g),y=nY(Na(e,g,!0),a0(Na(e,v,!0),g)),b=Lf(y,g),x=z0(b);_=HZ(Na(e,b,!0),b,c,a0(Na(e,x,!0),b),u,_);break;case"macro":_=vee(m,t,i,c,s[n],u,h,f);break;case"dialog":_=_ee(m,t,i,c,s[n],u,h,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=_;var j=[];s&&s[n]&&pr(s[n]).forEach(function(S){var T="";if(s[n][S].Type==ut.CMNT){T=Lf(s[n][S].Target,t);var F=wee(Er(e,T,!0),T,c);if(!F||!F.length)return;MT(_,F,!1)}s[n][S].Type==ut.TCMNT&&(T=Lf(s[n][S].Target,t),j=j.concat(iY(Er(e,T,!0),c)))}),j&&j.length&&MT(_,j,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function ai(e){return e.charAt(0)=="/"?e.slice(1):e}function Xte(e,t){if(sh(),t=t||{},eS(t),pi(e,"META-INF/manifest.xml")||pi(e,"objectdata.xml"))return WT(e,t);if(pi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jy<"u"){if(e.FileIndex)return jy(e);var r=Ge.utils.cfb_new();return tT(e).forEach(function(W){rt(r,W,sW(e,W))}),jy(r)}throw new Error("Unsupported NUMBERS file")}if(!pi(e,"[Content_Types].xml"))throw pi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tT(e),i=ZW(Na(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",Er(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!Er(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(i0=[],i.sst)try{i0=jee(Er(e,ai(i.sst)),i.sst,t)}catch(W){if(t.WTF)throw W}t.cellStyles&&i.themes.length&&(c=bee(Na(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=yee(Er(e,ai(i.style)),i.style,c,t))}i.links.map(function(W){try{var R=a0(Na(e,z0(ai(W))),W);return See(Er(e,ai(W)),R,W,t)}catch{}});var h=mee(Er(e,ai(i.workbooks[0])),i.workbooks[0],t),f={},m="";i.coreprops.length&&(m=Er(e,ai(i.coreprops[0]),!0),m&&(f=D8(m)),i.extprops.length!==0&&(m=Er(e,ai(i.extprops[0]),!0),m&&sG(m,f,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=Na(e,ai(i.custprops[0]),!0),m&&(_=lG(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(R){return R.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=_),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var v={};t.bookDeps&&i.calcchain&&(v=kee(Er(e,ai(i.calcchain)),i.calcchain));var y=0,b={},x,j;{var S=h.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var T=0;T!=S.length;++T)f.SheetNames[T]=S[T].name}var F=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");pi(e,P)||(P="xl/_rels/workbook."+F+".rels");var M=a0(Na(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Cee(Er(e,ai(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=oY(Er(e,ai(i.people[0])),t)),M&&(M=qte(M,h.Sheets));var A=Er(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var D="sheet";if(M&&M[y]?(x="xl/"+M[y][1].replace(/[\/]?xl\//,""),pi(e,x)||(x=M[y][1]),pi(e,x)||(x=P.replace(/_rels\/.*$/,"")+M[y][1]),D=M[y][2]):(x="xl/worksheets/sheet"+(y+1-A)+"."+F,x=x.replace(/sheet0\./,"sheet.")),j=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var H=!1,U=0;U!=t.sheets.length;++U)typeof t.sheets[U]=="number"&&t.sheets[U]==y&&(H=1),typeof t.sheets[U]=="string"&&t.sheets[U].toLowerCase()==f.SheetNames[y].toLowerCase()&&(H=1);if(!H)continue e}}Kte(e,x,j,f.SheetNames[y],y,b,o,D,t,h,c,u)}return g={Directory:i,Workbook:h,Props:f,Custprops:_,Deps:v,Sheets:o,SheetNames:f.SheetNames,Strings:i0,Styles:u,Themes:c,SSF:Kt(Ke)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(W,R){W=W.replace(/^Root Entry[\/]/,""),g.keys.push(W),g.files[W]=e.FileIndex[R]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=Er(e,ai(i.vba[0]),!0):i.defaults&&i.defaults.bin===mY&&(g.vbaraw=Er(e,"xl/vbaProject.bin",!0))),g}function Yte(e,t){var r=t||{},n="Workbook",i=Ge.find(e,n);try{if(n="/!DataSpaces/Version",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(CK(i.content),n="/!DataSpaces/DataSpaceMap",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=EK(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=TK(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);FK(i.content)}catch{}if(n="/EncryptionInfo",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=DK(i.content);if(n="/EncryptedPackage",i=Ge.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Qte(e,t){return t.bookType=="ods"?VM(e,t):t.bookType=="numbers"?Wte(e,t):t.bookType=="xlsb"?Jte(e,t):Zte(e,t)}function Jte(e,t){ou=1024,e&&!e.SSF&&(e.SSF=Kt(Ke)),e&&e.SSF&&(sh(),nv(e.SSF),t.revssf=iv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,s0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=xM.indexOf(t.bookType)>-1,i=Lk();tS(t=t||{});var s=Ck(),o="",l=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,P8(e.Props,t)),i.coreprops.push(o),Ft(t.rels,2,o,ut.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,R8(e.Props)),i.extprops.push(o),Ft(t.rels,3,o,ut.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,N8(e.Custprops)),i.custprops.push(o),Ft(t.rels,4,o,ut.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,rt(s,o,Eee(l-1,o,t,e,h)),i.sheets.push(o),Ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ut.WS[0])}if(f){var _=f["!comments"],g=!1,v="";_&&_.length>0&&(v="xl/comments"+l+"."+r,rt(s,v,Fee(_,v)),i.comments.push(v),Ft(h,-1,"../comments"+l+"."+r,ut.CMNT),g=!0),f["!legacy"]&&g&&rt(s,"xl/drawings/vmlDrawing"+l+".vml",mM(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&rt(s,z0(o),gu(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,rt(s,o,Aee(t.Strings,o,t)),i.strs.push(o),Ft(t.wbrels,-1,"sharedStrings."+r,ut.SST)),o="xl/workbook."+r,rt(s,o,$ee(e,o)),i.workbooks.push(o),Ft(t.rels,1,o,ut.WB),o="xl/theme/theme1.xml",rt(s,o,Gk(e.Themes,t)),i.themes.push(o),Ft(t.wbrels,-1,"theme/theme1.xml",ut.THEME),o="xl/styles."+r,rt(s,o,Tee(e,o,t)),i.styles.push(o),Ft(t.wbrels,-1,"styles."+r,ut.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Ft(t.wbrels,-1,"vbaProject.bin",ut.VBA)),o="xl/metadata."+r,rt(s,o,Dee(o)),i.metadata.push(o),Ft(t.wbrels,-1,"metadata."+r,ut.XLMETA),rt(s,"[Content_Types].xml",A8(i,t)),rt(s,"_rels/.rels",gu(t.rels)),rt(s,"xl/_rels/workbook."+r+".rels",gu(t.wbrels)),delete t.revssf,delete t.ssf,s}function Zte(e,t){ou=1024,e&&!e.SSF&&(e.SSF=Kt(Ke)),e&&e.SSF&&(sh(),nv(e.SSF),t.revssf=iv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,s0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=xM.indexOf(t.bookType)>-1,i=Lk();tS(t=t||{});var s=Ck(),o="",l=0;if(t.cellXfs=[],ql(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,P8(e.Props,t)),i.coreprops.push(o),Ft(t.rels,2,o,ut.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,R8(e.Props)),i.extprops.push(o),Ft(t.rels,3,o,ut.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,N8(e.Custprops)),i.custprops.push(o),Ft(t.rels,4,o,ut.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],_=(m||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,rt(s,o,EM(l-1,t,e,f)),i.sheets.push(o),Ft(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ut.WS[0])}if(m){var g=m["!comments"],v=!1,y="";if(g&&g.length>0){var b=!1;g.forEach(function(x){x[1].forEach(function(j){j.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+l+"."+r,rt(s,y,sY(g,h,t)),i.threadedcomments.push(y),Ft(f,-1,"../threadedComments/threadedComment"+l+"."+r,ut.TCMNT)),y="xl/comments"+l+"."+r,rt(s,y,gM(g)),i.comments.push(y),Ft(f,-1,"../comments"+l+"."+r,ut.CMNT),v=!0}m["!legacy"]&&v&&rt(s,"xl/drawings/vmlDrawing"+l+".vml",mM(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&rt(s,z0(o),gu(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,rt(s,o,nM(t.Strings,t)),i.strs.push(o),Ft(t.wbrels,-1,"sharedStrings."+r,ut.SST)),o="xl/workbook."+r,rt(s,o,PM(e)),i.workbooks.push(o),Ft(t.rels,1,o,ut.WB),o="xl/theme/theme1.xml",rt(s,o,Gk(e.Themes,t)),i.themes.push(o),Ft(t.wbrels,-1,"theme/theme1.xml",ut.THEME),o="xl/styles."+r,rt(s,o,uM(e,t)),i.styles.push(o),Ft(t.wbrels,-1,"styles."+r,ut.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Ft(t.wbrels,-1,"vbaProject.bin",ut.VBA)),o="xl/metadata."+r,rt(s,o,pM()),i.metadata.push(o),Ft(t.wbrels,-1,"metadata."+r,ut.XLMETA),h.length>1&&(o="xl/persons/person.xml",rt(s,o,lY(h)),i.people.push(o),Ft(t.wbrels,-1,"persons/person.xml",ut.PEOPLE)),rt(s,"[Content_Types].xml",A8(i,t)),rt(s,"_rels/.rels",gu(t.rels)),rt(s,"xl/_rels/workbook."+r+".rels",gu(t.wbrels)),delete t.revssf,delete t.ssf,s}function rS(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ua(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ere(e,t){return Ge.find(e,"EncryptedPackage")?Yte(e,t):NM(e,t)}function tre(e,t){var r,n=e,i=t||{};return i.type||(i.type=dt&&Buffer.isBuffer(e)?"buffer":"base64"),r=i8(n,i),Xte(r,i)}function WM(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Bw(e.slice(r),t);default:break e}return Ku.to_workbook(e,t)}function rre(e,t){var r="",n=rS(e,t);switch(t.type){case"base64":r=Ua(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=od(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rt(r)),t.type="binary",WM(r,t)}function nre(e,t){var r=e;return t.type=="base64"&&(r=Ua(r)),r=D0.utils.decode(1200,r.slice(2),"str"),t.type="binary",WM(r,t)}function are(e){return e.match(/[^\x00-\x7F]/)?Ts(e):e}function wy(e,t,r,n){return n?(r.type="string",Ku.to_workbook(e,r)):Ku.to_workbook(t,r)}function Hw(e,t){bk();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hw(new Uint8Array(e),(r=Kt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vu={},r.dateNF&&(vu.dateNF=r.dateNF),r.type||(r.type=dt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=dt?"buffer":"binary",n=JH(e),typeof Uint8Array<"u"&&!dt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=are(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Kt(r),r.type="array",Hw(jk(n),r)}switch((i=rS(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return ere(Ge.read(n,r),r);break;case 9:if(i[1]<=8)return NM(n,r);break;case 60:return Bw(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return cK(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return tM.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?tre(n,r):wy(e,n,r,s);case 239:return i[3]===60?Bw(n,r):wy(e,n,r,s);case 255:if(i[1]===254)return nre(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Kc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Kc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Lw.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return lM.to_workbook(n,r);break;case 10:case 13:case 32:return rre(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return lK.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Lw.to_workbook(n,r):wy(e,n,r,s)}function GM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mp(t.file,Ge.write(e,{type:dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ge.write(e,t)}function ire(e,t){var r=Kt(t||{}),n=Qte(e,r);return sre(n,r)}function sre(e,t){var r={},n=dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ge.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(rv(i))}return t.password&&typeof encrypt_agile<"u"?GM(encrypt_agile(i,t.password),t):t.type==="file"?mp(t.file,i):t.type=="string"?Rt(i):i}function ore(e,t){var r=t||{},n=ate(e,r);return GM(n,r)}function vs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return P0(Ts(n));case"binary":return Ts(n);case"string":return e;case"file":return mp(t.file,n,"utf8");case"buffer":return dt?Co(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):vs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function lre(e,t){switch(t.type){case"base64":return P0(e);case"binary":return e;case"string":return e;case"file":return mp(t.file,e,"binary");case"buffer":return dt?Co(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Am(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?P0(r):t.type=="string"?Rt(r):r;case"file":return mp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function qM(e,t){bk(),eee(e);var r=Kt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=qM(e,r);return r.type="array",rv(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return vs(Qee(e,r),r);case"slk":case"sylk":return vs(eM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return vs(IM(e.Sheets[e.SheetNames[i]],r),r);case"txt":return lre(KM(e.Sheets[e.SheetNames[i]],r),r);case"csv":return vs(nS(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return vs(tM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Am(Lw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return vs(Ku.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return vs(lM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return vs(rM.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return vs(VM(e,r),r);case"wk1":return Am(Kc.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Am(Kc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Am(zM(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ore(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ire(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function cre(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function dre(e,t,r){var n={};return n.type="file",n.file=t,cre(n),qM(e,n)}function ure(e,t,r,n,i,s,o,l){var c=br(r),u=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var _=t.s.c;_<=t.e.c;++_){var g=o?e[r][_]:e[n[_]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[_]!=null&&(m[s[_]]=u);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[_]!=null){if(v==null)if(g.t=="e"&&v===null)m[s[_]]=null;else if(u!==void 0)m[s[_]]=u;else if(h&&v===null)m[s[_]]=null;else continue;else m[s[_]]=h&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?v:ko(g,v,l);v!=null&&(f=!1)}}return{row:m,isempty:f}}function _1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":c=yt(h);break;case"number":c=yt(e["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=br(c.s.r),m=[],_=[],g=0,v=0,y=Array.isArray(e),b=c.s.r,x=0,j={};y&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],T=u.skipHidden&&e["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(S[x]||{}).hidden)switch(m[x]=tr(x),r=y?e[b][x]:e[m[x]+f],n){case 1:s[x]=x-c.s.c;break;case 2:s[x]=m[x];break;case 3:s[x]=u.header[x-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=ko(r,null,u),v=j[o]||0,!v)j[o]=1;else{do l=o+"_"+v++;while(j[l]);j[o]=v,j[l]=1}s[x]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(T[b]||{}).hidden){var F=ure(e,c,b,m,n,s,y,u);(F.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(_[g++]=F.row)}return _.length=g,_}var YT=/"/g;function hre(e,t,r,n,i,s,o,l){for(var c=!0,u=[],h="",f=br(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var _=l.dense?(e[r]||[])[m]:e[n[m]+f];if(_==null)h="";else if(_.v!=null){c=!1,h=""+(l.rawNumbers&&_.t=="n"?_.v:ko(_,null,l));for(var g=0,v=0;g!==h.length;++g)if((v=h.charCodeAt(g))===i||v===s||v===34||l.forceQuotes){h='"'+h.replace(YT,'""')+'"';break}h=="ID"&&(h='"ID"')}else _.f!=null&&!_.F?(c=!1,h="="+_.f,h.indexOf(",")>=0&&(h='"'+h.replace(YT,'""')+'"')):h="";u.push(h)}return l.blankrows===!1&&c?null:u.join(o)}function nS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=yt(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],_=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(f[g]=tr(g));for(var v=0,y=i.s.r;y<=i.e.r;++y)(_[y]||{}).hidden||(h=hre(e,i,y,f,o,c,s,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((v++?l:"")+h)));return delete n.dense,r.join("")}function KM(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=nS(e,t);return r}function fre(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=yt(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=tr(l);for(var h=i.s.r;h<=i.e.r;++h)for(s=br(h),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function XM(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?rr(n.origin):n.origin;o=c.r,l=c.c}var u,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=yt(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),o==-1&&(o=f.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var m=n.header||[],_=0;t.forEach(function(v,y){pr(v).forEach(function(b){(_=m.indexOf(b))==-1&&(m[_=m.length]=b);var x=v[b],j="z",S="",T=Xe({c:l+_,r:o+y+i});u=W0(s,T),x&&typeof x=="object"&&!(x instanceof Date)?s[T]=x:(typeof x=="number"?j="n":typeof x=="boolean"?j="b":typeof x=="string"?j="s":x instanceof Date?(j="d",n.cellDates||(j="n",x=Ur(x)),S=n.dateNF||Ke[14]):x===null&&n.nullError&&(j="e",x=0),u?(u.t=j,u.v=x,delete u.w,delete u.R,S&&(u.z=S)):s[T]=u={t:j,v:x},S&&(u.z=S))})}),h.e.c=Math.max(h.e.c,l+m.length-1);var g=br(o);if(i)for(_=0;_<m.length;++_)s[tr(_+l)+g]={t:"s",v:m[_]};return s["!ref"]=et(h),s}function pre(e,t){return XM(null,e,t)}function W0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=rr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?W0(e,Xe(t)):W0(e,Xe({r:t,c:r||0}))}function mre(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function aS(){return{SheetNames:[],Sheets:{}}}function iS(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(DM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function gre(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=mre(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function xre(e,t){return e.z=t,e}function YM(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function vre(e,t,r){return YM(e,"#"+t,r)}function _re(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yre(e,t,r,n){for(var i=typeof t!="string"?t:yt(t),s=typeof t=="string"?t:et(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=W0(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Fm={encode_col:tr,encode_row:br,encode_cell:Xe,encode_range:et,decode_col:Mk,decode_row:Pk,split_cell:AW,decode_cell:rr,decode_range:wa,format_cell:ko,sheet_add_aoa:w8,sheet_add_json:XM,sheet_add_dom:LM,aoa_to_sheet:oh,json_to_sheet:pre,table_to_sheet:BM,table_to_book:Cte,sheet_to_csv:nS,sheet_to_txt:KM,sheet_to_json:_1,sheet_to_html:IM,sheet_to_formulae:fre,sheet_to_row_object_array:_1,sheet_get_cell:W0,book_new:aS,book_append_sheet:iS,book_set_sheet_visibility:gre,cell_set_number_format:xre,cell_set_hyperlink:YM,cell_set_internal_link:vre,cell_add_comment:_re,sheet_set_array_formula:yre,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const bre=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
`,jre=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
`,wre=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0;
`,kre=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`,Sre=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.xl};
`,ky=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-radius: ${d.radius.md};
  background: ${({$active:e,$completed:t})=>e?d.colors.primary:t?`${d.colors.success}20`:d.colors.bgLight};
  color: ${({$active:e,$completed:t})=>e?"white":t?d.colors.success:d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`,Sy=p.span`
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: ${({$active:e})=>e?"white":"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:"inherit"};
  border: 2px solid currentColor;
`,Cy=p.div`
  margin-bottom: ${d.spacing.xl};
`,$y=p.h3`
  font-size: ${d.typography.sizes.h4};
  color: ${d.colors.textPrimary};
  margin: 0 0 ${d.spacing.md} 0;
`,Cre=p.div`
  border: 2px dashed ${({$isDragging:e,$hasFile:t})=>e?d.colors.primary:t?d.colors.success:d.colors.border};
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  text-align: center;
  background: ${({$isDragging:e})=>e?`${d.colors.primary}05`:"transparent"};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    background: ${d.colors.primary}05;
  }
`,$re=p.div`
  font-size: 48px;
  margin-bottom: ${d.spacing.md};
`,Ere=p.p`
  color: ${d.colors.textSecondary};
  margin: 0 0 ${d.spacing.sm} 0;
`,Tre=p.span`
  color: ${d.colors.textMuted};
  font-size: ${d.typography.sizes.small};
`,Are=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.md};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  margin-top: ${d.spacing.md};
`,Fre=p.span`
  flex: 1;
  font-weight: ${d.typography.weights.medium};
`,Dre=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
`,Pre=p.button`
  background: none;
  border: none;
  color: ${d.colors.danger};
  cursor: pointer;
  padding: ${d.spacing.xs};

  &:hover {
    opacity: 0.7;
  }
`,QT=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: ${d.typography.sizes.small};
`,Uh=p.th`
  text-align: left;
  padding: ${d.spacing.sm};
  background: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
`,Vh=p.td`
  padding: ${d.spacing.sm};
  border: 1px solid ${d.colors.border};
  background: ${({$error:e})=>e?`${d.colors.danger}10`:"transparent"};
`,Mre=p.span`
  color: ${d.colors.danger};
  font-size: ${d.typography.sizes.tiny};
  display: block;
`,JT=p.div`
  max-height: 400px;
  overflow: auto;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
`,ZT=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: ${d.spacing.md};
  margin-bottom: ${d.spacing.lg};
`,tc=p.div`
  padding: ${d.spacing.md};
  background: ${({$color:e})=>e?`${e}10`:d.colors.bgLight};
  border-radius: ${d.radius.md};
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,rc=p.div`
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  color: ${d.colors.textPrimary};
`,nc=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
`,e5=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,Dm=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"success":return`background: ${d.colors.success}; color: white;`;case"danger":return`background: ${d.colors.danger}; color: white;`;case"secondary":return`background: ${d.colors.bgLight}; color: ${d.colors.textSecondary}; border: 1px solid ${d.colors.border};`;default:return`background: ${d.colors.primary}; color: white;`}}}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,Pm=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.md};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:e==="error"?`${d.colors.danger}15`:`${d.colors.primary}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:e==="error"?d.colors.danger:d.colors.primary};
`,Ore=p.div`
  width: 100%;
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  margin: ${d.spacing.md} 0;
`,Rre=p.div`
  width: ${({$percent:e})=>e}%;
  height: 100%;
  background: ${d.colors.primary};
  transition: width 0.3s ease;
`,t5=p.a`
  color: ${d.colors.primary};
  text-decoration: none;
  font-size: ${d.typography.sizes.small};
  cursor: pointer;

  &:hover {
    text-decoration: underline;
  }
`,Nre=p.select`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  background: white;
  min-width: 250px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,zre=p.div`
  margin-bottom: ${d.spacing.md};
`,Ire=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
`;function Lre({tablaKey:e,onNavigate:t}){const[r,n]=C.useState(1),[i,s]=C.useState(e||""),[o,l]=C.useState(null),[c,u]=C.useState([]),[h,f]=C.useState(null),[m,_]=C.useState(!1),[g,v]=C.useState([]),[y,b]=C.useState(!1),[x,j]=C.useState(0),[S,T]=C.useState(null),[F,w]=C.useState(null),P=C.useRef(null);C.useEffect(()=>{(async()=>{try{const L=await to.getTablas();if(u(L),e){const K=L.find(re=>re.key===e);K&&l(K)}}catch(L){console.error("Error loading tablas:",L)}})()},[e]);const M=C.useCallback(async N=>{if(s(N),f(null),v([]),N){const L=c.find(K=>K.key===N);L&&l(L)}else l(null)},[c]),A=N=>{N.preventDefault(),_(!0)},D=()=>{_(!1)},H=N=>{N.preventDefault(),_(!1);const L=N.dataTransfer.files[0];L&&W(L)},U=N=>{var K;const L=(K=N.target.files)==null?void 0:K[0];L&&W(L)},W=async N=>{if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(N.type)&&!N.name.match(/\.(csv|xlsx|xls)$/i)){w("Formato de archivo no valido. Use CSV o Excel (.xlsx, .xls)");return}f(N),w(null);try{let K;if(N.name.match(/\.(xlsx|xls)$/i)){const re=await N.arrayBuffer(),Z=Hw(re,{type:"array"}),me=Z.SheetNames[0],B=Z.Sheets[me];K=Fm.sheet_to_json(B,{header:1,raw:!1,defval:""})}else{const re=await N.text();K=R(re)}ae(K)}catch(K){w("Error al leer el archivo. Verifique que el formato sea correcto."),console.error(K)}},R=N=>N.trim().split(`
`).map(K=>{const re=[];let Z="",me=!1;for(const B of K)B==='"'?me=!me:(B===","||B===";")&&!me?(re.push(Z.trim()),Z=""):Z+=B;return re.push(Z.trim()),re}),ae=N=>{if(N.length<2){w("El archivo debe tener al menos una fila de encabezados y una de datos");return}const L=N[0].map(Z=>Z.toLowerCase().trim()),K=(o==null?void 0:o.columns.filter(Z=>Z!=="id"&&Z!=="active"&&Z!=="created_at"&&Z!=="updated_at"))||[],re=N.slice(1).map((Z,me)=>{const B={},se=[];return L.forEach((we,V)=>{const Ce=Z[V]||"";B[we]=Ce}),K.forEach(we=>{!B[we]&&we!=="active"&&["nombre","codigo","descripcion","denominacion"].includes(we)&&(B[we]||se.push(`Campo "${we}" es requerido`))}),{rowIndex:me+2,data:B,errors:se,isValid:se.length===0}});v(re),re.length>0&&n(2)},le=()=>{f(null),v([]),n(1),P.current&&(P.current.value="")},G=async()=>{if(!i||g.length===0)return;b(!0),j(10),T(null);const N=g.filter(L=>L.isValid);try{j(30);const L=N.map(Z=>({data:Z.data})),K=await to.bulkUpload(i,L);j(100);const re={success:K.insertados,failed:K.errores,errors:K.detalles_errores.map(Z=>({row:Z.fila,error:Z.error}))};T(re)}catch(L){const K={success:0,failed:N.length,errors:[{row:0,error:L instanceof Error?L.message:"Error en carga masiva"}]};T(K)}b(!1),n(3)},z=(N="xlsx")=>{if(!o)return;const L=o.columns.filter(K=>K!=="id"&&K!=="active"&&K!=="created_at"&&K!=="updated_at");if(N==="xlsx"){const K=[L],re=Fm.aoa_to_sheet(K);re["!cols"]=L.map(()=>({wch:20}));const Z=Fm.book_new();Fm.book_append_sheet(Z,re,o.display_name),dre(Z,`plantilla_${i}.xlsx`)}else{const K=L.join(",")+`
`,re=new Blob([K],{type:"text/csv"}),Z=URL.createObjectURL(re),me=document.createElement("a");me.href=Z,me.download=`plantilla_${i}.csv`,me.click(),URL.revokeObjectURL(Z)}},ie=g.filter(N=>N.isValid).length,ne=g.filter(N=>!N.isValid).length,O=N=>N<1024?N+" B":N<1024*1024?(N/1024).toFixed(1)+" KB":(N/(1024*1024)).toFixed(1)+" MB";return a.jsxs(bre,{children:[a.jsxs(jre,{children:[a.jsx(kre,{onClick:()=>t("mantenedores"),children:" Volver a Mantenedores"}),a.jsx(wre,{children:"Carga Masiva"})]}),a.jsxs(Sre,{children:[a.jsxs(ky,{$active:r===1,$completed:r>1,children:[a.jsx(Sy,{$active:r===1,$completed:r>1,children:r>1?"":"1"}),"Seleccionar Archivo"]}),a.jsxs(ky,{$active:r===2,$completed:r>2,children:[a.jsx(Sy,{$active:r===2,$completed:r>2,children:r>2?"":"2"}),"Validar Datos"]}),a.jsxs(ky,{$active:r===3,$completed:!1,children:[a.jsx(Sy,{$active:r===3,$completed:!1,children:"3"}),"Resultados"]})]}),F&&a.jsx(Pm,{$type:"error",children:F}),r===1&&a.jsxs(Cy,{children:[a.jsxs(zre,{children:[a.jsx(Ire,{children:"Seleccione el mantenedor"}),a.jsxs(Nre,{value:i,onChange:N=>M(N.target.value),children:[a.jsx("option",{value:"",children:"-- Seleccionar --"}),c.map(N=>a.jsx("option",{value:N.key,children:N.display_name},N.key))]})]}),i&&o&&a.jsxs(a.Fragment,{children:[a.jsxs(Pm,{$type:"info",children:["Columnas esperadas: ",o.columns.filter(N=>N!=="id"&&N!=="active"&&N!=="created_at"&&N!=="updated_at").join(", ")]}),a.jsxs(Cre,{$isDragging:m,$hasFile:!!h,onDragOver:A,onDragLeave:D,onDrop:H,onClick:()=>{var N;return(N=P.current)==null?void 0:N.click()},children:[a.jsx("input",{ref:P,type:"file",accept:".csv,.xlsx,.xls",onChange:U,style:{display:"none"}}),a.jsx($re,{children:""}),a.jsx(Ere,{children:m?"Suelte el archivo aqui":"Arrastre un archivo o haga clic para seleccionar"}),a.jsx(Tre,{children:"Formatos soportados: CSV, Excel (.xlsx, .xls)"})]}),a.jsxs("div",{style:{marginTop:d.spacing.md,display:"flex",gap:d.spacing.md},children:[a.jsx(t5,{onClick:()=>z("xlsx"),children:" Descargar plantilla Excel"}),a.jsx(t5,{onClick:()=>z("csv"),children:" Descargar plantilla CSV"})]}),h&&a.jsxs(Are,{children:[a.jsx("span",{children:""}),a.jsx(Fre,{children:h.name}),a.jsx(Dre,{children:O(h.size)}),a.jsx(Pre,{onClick:le,children:""})]})]})]}),r===2&&a.jsxs(Cy,{children:[a.jsx($y,{children:"Vista Previa de Datos"}),a.jsxs(ZT,{children:[a.jsxs(tc,{$color:d.colors.primary,children:[a.jsx(rc,{children:g.length}),a.jsx(nc,{children:"Total Filas"})]}),a.jsxs(tc,{$color:d.colors.success,children:[a.jsx(rc,{children:ie}),a.jsx(nc,{children:"Validos"})]}),a.jsxs(tc,{$color:d.colors.danger,children:[a.jsx(rc,{children:ne}),a.jsx(nc,{children:"Con Errores"})]}),a.jsxs(tc,{$color:d.colors.warning,children:[a.jsxs(rc,{children:[Math.round(ie/g.length*100),"%"]}),a.jsx(nc,{children:"Tasa Exito"})]})]}),a.jsx(JT,{children:a.jsxs(QT,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Uh,{children:"#"}),o==null?void 0:o.columns.filter(N=>N!=="id"&&N!=="active"&&N!=="created_at"&&N!=="updated_at").map(N=>a.jsx(Uh,{children:N},N)),a.jsx(Uh,{children:"Estado"})]})}),a.jsx("tbody",{children:g.slice(0,100).map((N,L)=>a.jsxs("tr",{children:[a.jsx(Vh,{children:N.rowIndex}),o==null?void 0:o.columns.filter(K=>K!=="id"&&K!=="active"&&K!=="created_at"&&K!=="updated_at").map(K=>a.jsxs(Vh,{$error:N.errors.some(re=>re.includes(K)),children:[N.data[K]||"-",N.errors.filter(re=>re.includes(K)).map((re,Z)=>a.jsx(Mre,{children:re},Z))]},K)),a.jsx(Vh,{children:N.isValid?a.jsx("span",{style:{color:d.colors.success},children:" Valido"}):a.jsx("span",{style:{color:d.colors.danger},children:" Error"})})]},L))})]})}),g.length>100&&a.jsxs(Pm,{$type:"info",children:["Mostrando primeras 100 filas de ",g.length]}),y&&a.jsxs(a.Fragment,{children:[a.jsx(Ore,{children:a.jsx(Rre,{$percent:x})}),a.jsxs("div",{style:{textAlign:"center",color:d.colors.textSecondary},children:["Procesando... ",x,"%"]})]}),a.jsxs(e5,{children:[a.jsx(Dm,{$variant:"secondary",onClick:()=>n(1),disabled:y,children:"Atras"}),a.jsx(Dm,{$variant:"success",onClick:G,disabled:y||ie===0,children:y?"Procesando...":`Cargar ${ie} registros`})]})]}),r===3&&S&&a.jsxs(Cy,{children:[a.jsx($y,{children:"Resultados de la Carga"}),a.jsxs(ZT,{children:[a.jsxs(tc,{$color:d.colors.success,children:[a.jsx(rc,{children:S.success}),a.jsx(nc,{children:"Exitosos"})]}),a.jsxs(tc,{$color:d.colors.danger,children:[a.jsx(rc,{children:S.failed}),a.jsx(nc,{children:"Fallidos"})]}),a.jsxs(tc,{$color:d.colors.primary,children:[a.jsxs(rc,{children:[Math.round(S.success/(S.success+S.failed)*100),"%"]}),a.jsx(nc,{children:"Tasa Exito"})]})]}),S.success>0&&a.jsxs(Pm,{$type:"success",children:["Se cargaron ",S.success," registros exitosamente."]}),S.errors.length>0&&a.jsxs(a.Fragment,{children:[a.jsx($y,{children:"Errores Encontrados"}),a.jsx(JT,{style:{maxHeight:"200px"},children:a.jsxs(QT,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Uh,{children:"Fila"}),a.jsx(Uh,{children:"Error"})]})}),a.jsx("tbody",{children:S.errors.map((N,L)=>a.jsxs("tr",{children:[a.jsx(Vh,{children:N.row}),a.jsx(Vh,{$error:!0,children:N.error})]},L))})]})})]}),a.jsxs(e5,{children:[a.jsx(Dm,{$variant:"secondary",onClick:()=>{n(1),f(null),v([]),T(null)},children:"Nueva Carga"}),a.jsx(Dm,{onClick:()=>t("mantenedores"),children:"Volver a Mantenedores"})]})]})]})}p.div`
  padding: 1.5rem;
  max-width: 100%;
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`;p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`;p.div`
  display: flex;
  gap: 0.75rem;
`;p.button`
  padding: 0.5rem 1rem;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>{switch(e){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border: none;
          &:hover { background: ${d.colors.primaryDark}; }
        `;case"secondary":return`
          background: white;
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgLight}; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border: none;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
`;p.div`
  display: grid;
  grid-template-columns: 1fr 200px auto;
  gap: 1rem;
  align-items: end;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`;p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`;p.input`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.select`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`;p.table`
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
`;p.th`
  padding: 0.75rem 1rem;
  text-align: left;
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  background: ${d.colors.bgLight};
  border-bottom: 1px solid ${d.colors.border};
`;p.td`
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  border-bottom: 1px solid ${d.colors.border};
`;p.span`
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;

  ${({$variant:e})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"info":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`;p.button`
  padding: 0.25rem 0.5rem;
  border: none;
  background: ${({$color:e})=>e?`${e}15`:`${d.colors.primary}15`};
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  margin-right: 0.25rem;

  &:hover {
    background: ${({$color:e})=>e?`${e}25`:`${d.colors.primary}25`};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 1rem;
  padding: 0.75rem;
  background: white;
  border-radius: 8px;
`;p.span`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
`;p.div`
  display: flex;
  gap: 0.5rem;
`;p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`;p.div`
  display: flex;
  flex-direction: column;
  gap: 1rem;
`;p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid ${d.colors.border};
`;p.textarea`
  padding: 0.5rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 6px;
  font-size: 0.875rem;
  min-height: 80px;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;p.div`
  padding: 0.75rem 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${({$type:e})=>e==="success"?`background: ${d.colors.success}15; color: ${d.colors.success}; border: 1px solid ${d.colors.success}30;`:`background: ${d.colors.danger}15; color: ${d.colors.danger}; border: 1px solid ${d.colors.danger}30;`}
`;p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`;p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`;const Bre=p.div`
  max-width: 500px;
  margin: 0 auto;
  padding: ${d.spacing.xl};
`,Ure=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.xl};
`,Vre=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  margin: 0 0 ${d.spacing.xs} 0;
`,Hre=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
`,Wre=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,Ey=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,Ty=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,Ay=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }
`,Fy=p.div`
  position: relative;
`,Dy=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,r5=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;

  ${({$variant:e="primary"})=>e==="primary"?`
        background: ${d.colors.primary};
        color: white;
      `:`
        background: ${d.colors.bgLight};
        color: ${d.colors.textSecondary};
        border: 1px solid ${d.colors.border};
      `}

  &:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,n5=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
`,Gre=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,qre=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,Mm=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,Kre=p.div`
  display: flex;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.md};
`,Xre=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  padding: 0;
  margin-bottom: ${d.spacing.lg};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};

  &:hover {
    text-decoration: underline;
  }
`;function Yre({onNavigate:e}){const[t,r]=C.useState(""),[n,i]=C.useState(""),[s,o]=C.useState(""),[l,c]=C.useState(!1),[u,h]=C.useState(!1),[f,m]=C.useState(!1),[_,g]=C.useState(!1),[v,y]=C.useState(!1),[b,x]=C.useState(null),j=n.length>=6,S=/[A-Z]/.test(n),T=/[a-z]/.test(n),F=/[0-9]/.test(n),w=n===s&&s!=="",P=j&&w,M=async D=>{var H,U;if(D.preventDefault(),x(null),y(!1),!t){x("Ingrese su contrasea actual");return}if(!P){x("La nueva contrasea no cumple con los requisitos");return}g(!0);try{await mo.changePassword(t,n),y(!0),r(""),i(""),o("")}catch(W){const R=W instanceof Error?W.message:((U=(H=W==null?void 0:W.response)==null?void 0:H.data)==null?void 0:U.detail)||"Error al cambiar la contrasea";x(R)}finally{g(!1)}},A=()=>{r(""),i(""),o(""),x(null),y(!1)};return a.jsxs(Bre,{children:[a.jsx(Xre,{onClick:()=>e("dashboard"),children:" Volver al Dashboard"}),a.jsxs(Ure,{children:[a.jsx(Vre,{children:"Cambiar Contrasea"}),a.jsx(Hre,{children:"Ingrese su contrasea actual y luego la nueva contrasea que desea usar."}),v&&a.jsx(n5,{$type:"success",children:" Su contrasea ha sido actualizada exitosamente."}),b&&a.jsxs(n5,{$type:"error",children:[" ",b]}),a.jsxs(Wre,{onSubmit:M,children:[a.jsxs(Ey,{children:[a.jsx(Ty,{children:"Contrasea Actual"}),a.jsxs(Fy,{children:[a.jsx(Ay,{type:l?"text":"password",value:t,onChange:D=>r(D.target.value),placeholder:"Ingrese su contrasea actual",disabled:_}),a.jsx(Dy,{type:"button",onClick:()=>c(!l),children:l?"":""})]})]}),a.jsxs(Ey,{children:[a.jsx(Ty,{children:"Nueva Contrasea"}),a.jsxs(Fy,{children:[a.jsx(Ay,{type:u?"text":"password",value:n,onChange:D=>i(D.target.value),placeholder:"Ingrese la nueva contrasea",disabled:_}),a.jsx(Dy,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs(Gre,{children:[a.jsx(qre,{children:"Requisitos de la contrasea:"}),a.jsxs(Mm,{$valid:j,children:[j?"":""," Minimo 6 caracteres"]}),a.jsxs(Mm,{$valid:S,children:[S?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs(Mm,{$valid:T,children:[T?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs(Mm,{$valid:F,children:[F?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(Ey,{children:[a.jsx(Ty,{children:"Confirmar Nueva Contrasea"}),a.jsxs(Fy,{children:[a.jsx(Ay,{type:f?"text":"password",value:s,onChange:D=>o(D.target.value),placeholder:"Repita la nueva contrasea",disabled:_}),a.jsx(Dy,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),s&&!w&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contraseas no coinciden"}),w&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contraseas coinciden"})]}),a.jsxs(Kre,{children:[a.jsx(r5,{type:"button",$variant:"secondary",onClick:A,disabled:_,children:"Limpiar"}),a.jsx(r5,{type:"submit",disabled:_||!P,children:_?"Guardando...":"Cambiar Contrasea"})]})]})]})]})}const Qre=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,Jre=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,Zre=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,ene=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,tne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,rne=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,nne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,ane=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,ine=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,sne=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,one=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,a5=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,i5=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary}}};
`,lne=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,cne=p.div`
  margin-top: ${d.spacing.lg};
  padding: ${d.spacing.md};
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  border: 1px dashed ${d.colors.border};
`,dne=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${d.colors.textMuted};
  margin-bottom: ${d.spacing.xs};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,s5=p.div`
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textSecondary};
  word-break: break-all;
  font-family: monospace;
`;function une({onNavigate:e}){const[t,r]=C.useState(""),[n,i]=C.useState(!1),[s,o]=C.useState(!1),[l,c]=C.useState(null),[u,h]=C.useState(null),[f,m]=C.useState(null),_=y=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y),g=async y=>{var b,x;if(y.preventDefault(),c(null),o(!1),h(null),m(null),!t.trim()){c("Ingrese su correo electronico");return}if(!_(t)){c("Ingrese un correo electronico valido");return}i(!0);try{const j=await mo.forgotPassword(t);o(!0),j._dev_token&&(h(j._dev_token),m(j._dev_reset_url||null))}catch(j){const S=j instanceof Error?j.message:((x=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:x.detail)||"Error al procesar la solicitud";c(S)}finally{i(!1)}},v=()=>{u&&e("reset-password",{token:u,email:t})};return a.jsx(Qre,{children:a.jsxs(Jre,{children:[a.jsxs(Zre,{children:[a.jsx(ene,{children:"INVEB"}),a.jsx(tne,{children:"Sistema de Gestion"})]}),a.jsx(rne,{children:"Recuperar Contrasena"}),a.jsx(nne,{children:"Ingresa tu correo electronico y te enviaremos instrucciones para restablecer tu contrasena."}),s&&a.jsx(i5,{$type:"success",children:"Si el correo esta registrado, recibiras instrucciones para restablecer tu contrasena."}),l&&a.jsx(i5,{$type:"error",children:l}),!s&&a.jsxs(ane,{onSubmit:g,children:[a.jsxs(ine,{children:[a.jsx(sne,{children:"Correo Electronico"}),a.jsx(one,{type:"email",value:t,onChange:y=>r(y.target.value),placeholder:"ejemplo@empresa.com",disabled:n,autoComplete:"email",autoFocus:!0})]}),a.jsx(a5,{type:"submit",disabled:n||!t.trim(),children:n?"Enviando...":"Enviar Instrucciones"})]}),u&&a.jsxs(cne,{children:[a.jsx(dne,{children:"Modo Desarrollo"}),a.jsxs(s5,{children:["Token: ",u.substring(0,20),"..."]}),f&&a.jsxs(a.Fragment,{children:[a.jsxs(s5,{style:{marginTop:"8px"},children:["URL: ",f]}),a.jsx(a5,{type:"button",onClick:v,style:{marginTop:"12px",width:"100%"},children:"Ir a Restablecer Contrasena"})]})]}),a.jsx(lne,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const Om=p.div`
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, ${d.colors.bgLight} 0%, ${d.colors.bgMedium} 100%);
  padding: ${d.spacing.lg};
`,Rm=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.lg};
  padding: ${d.spacing.xxl};
  width: 100%;
  max-width: 420px;
`,Nm=p.div`
  text-align: center;
  margin-bottom: ${d.spacing.xl};
`,zm=p.h1`
  color: ${d.colors.primary};
  font-size: 2rem;
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Im=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: ${d.spacing.xs} 0 0 0;
`,Py=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  font-weight: ${d.typography.weights.semibold};
  margin: 0 0 ${d.spacing.sm} 0;
  text-align: center;
`,hne=p.p`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  margin: 0 0 ${d.spacing.xl} 0;
  text-align: center;
  line-height: 1.5;
`,fne=p.form`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.lg};
`,o5=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,l5=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,c5=p.input`
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }

  &::placeholder {
    color: ${d.colors.textMuted};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,d5=p.div`
  position: relative;
`,u5=p.button`
  position: absolute;
  right: ${d.spacing.sm};
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  padding: ${d.spacing.xs};
  font-size: 1.1rem;

  &:hover {
    color: ${d.colors.textPrimary};
  }
`,My=p.button`
  padding: ${d.spacing.md} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  background: ${d.colors.primary};
  color: white;

  &:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,Oy=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.small};
  text-align: center;
  background: ${({$type:e})=>{switch(e){case"success":return`${d.colors.success}15`;case"error":return`${d.colors.danger}15`;case"info":return`${d.colors.primary}15`;case"warning":return`${d.colors.warning}15`}}};
  color: ${({$type:e})=>{switch(e){case"success":return d.colors.success;case"error":return d.colors.danger;case"info":return d.colors.primary;case"warning":return d.colors.warning}}};
`,pne=p.div`
  background: ${d.colors.bgLight};
  border-radius: ${d.radius.md};
  padding: ${d.spacing.md};
  margin-top: ${d.spacing.sm};
`,mne=p.div`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
  margin-bottom: ${d.spacing.xs};
`,Lm=p.div`
  font-size: ${d.typography.sizes.tiny};
  color: ${({$valid:e})=>e?d.colors.success:d.colors.textMuted};
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  margin-top: ${d.spacing.xs};
`,h5=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  padding: 0;
  margin-top: ${d.spacing.lg};
  display: block;
  width: 100%;
  text-align: center;

  &:hover {
    text-decoration: underline;
  }
`,gne=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`;function xne({onNavigate:e,token:t,email:r}){const[n,i]=C.useState(r||""),[s,o]=C.useState(""),[l,c]=C.useState(""),[u,h]=C.useState(!1),[f,m]=C.useState(!1),[_,g]=C.useState(!1),[v,y]=C.useState(!0),[b,x]=C.useState(!1),[j,S]=C.useState(!1),[T,F]=C.useState(null),w=s.length>=6,P=/[A-Z]/.test(s),M=/[a-z]/.test(s),A=/[0-9]/.test(s),D=s===l&&l!=="",H=w&&D;C.useEffect(()=>{(async()=>{if(!t||!n){y(!1),F("Enlace invalido. Por favor solicita uno nuevo.");return}try{const R=await mo.validateResetToken(t,n);x(R.valid),R.valid||F(R.message||"El enlace es invalido o ha expirado.")}catch{F("Error al validar el enlace.")}finally{y(!1)}})()},[t,n]);const U=async W=>{var R,ae;if(W.preventDefault(),F(null),!H){F("La contrasena no cumple con los requisitos");return}if(!t){F("Token no valido");return}g(!0);try{await mo.resetPassword(t,n,s),S(!0)}catch(le){const G=le instanceof Error?le.message:((ae=(R=le==null?void 0:le.response)==null?void 0:R.data)==null?void 0:ae.detail)||"Error al restablecer la contrasena";F(G)}finally{g(!1)}};return v?a.jsx(Om,{children:a.jsxs(Rm,{children:[a.jsxs(Nm,{children:[a.jsx(zm,{children:"INVEB"}),a.jsx(Im,{children:"Sistema de Gestion"})]}),a.jsx(gne,{children:"Validando enlace..."})]})}):!b&&!j?a.jsx(Om,{children:a.jsxs(Rm,{children:[a.jsxs(Nm,{children:[a.jsx(zm,{children:"INVEB"}),a.jsx(Im,{children:"Sistema de Gestion"})]}),a.jsx(Py,{children:"Enlace Invalido"}),a.jsx(Oy,{$type:"error",children:T||"El enlace de recuperacion es invalido o ha expirado."}),a.jsx(My,{type:"button",onClick:()=>e("forgot-password"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Solicitar Nuevo Enlace"}),a.jsx(h5,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})}):j?a.jsx(Om,{children:a.jsxs(Rm,{children:[a.jsxs(Nm,{children:[a.jsx(zm,{children:"INVEB"}),a.jsx(Im,{children:"Sistema de Gestion"})]}),a.jsx(Py,{children:"Contrasena Restablecida"}),a.jsx(Oy,{$type:"success",children:"Tu contrasena ha sido restablecida exitosamente. Ya puedes iniciar sesion con tu nueva contrasena."}),a.jsx(My,{type:"button",onClick:()=>e("login"),style:{marginTop:d.spacing.lg,width:"100%"},children:"Ir a Iniciar Sesion"})]})}):a.jsx(Om,{children:a.jsxs(Rm,{children:[a.jsxs(Nm,{children:[a.jsx(zm,{children:"INVEB"}),a.jsx(Im,{children:"Sistema de Gestion"})]}),a.jsx(Py,{children:"Nueva Contrasena"}),a.jsxs(hne,{children:["Ingresa tu nueva contrasena para la cuenta: ",a.jsx("strong",{children:n})]}),T&&a.jsx(Oy,{$type:"error",children:T}),a.jsxs(fne,{onSubmit:U,children:[a.jsxs(o5,{children:[a.jsx(l5,{children:"Nueva Contrasena"}),a.jsxs(d5,{children:[a.jsx(c5,{type:u?"text":"password",value:s,onChange:W=>o(W.target.value),placeholder:"Ingresa tu nueva contrasena",disabled:_,autoComplete:"new-password",autoFocus:!0}),a.jsx(u5,{type:"button",onClick:()=>h(!u),children:u?"":""})]}),a.jsxs(pne,{children:[a.jsx(mne,{children:"Requisitos de la contrasena:"}),a.jsxs(Lm,{$valid:w,children:[w?"":""," Minimo 6 caracteres"]}),a.jsxs(Lm,{$valid:P,children:[P?"":""," Al menos una mayuscula (recomendado)"]}),a.jsxs(Lm,{$valid:M,children:[M?"":""," Al menos una minuscula (recomendado)"]}),a.jsxs(Lm,{$valid:A,children:[A?"":""," Al menos un numero (recomendado)"]})]})]}),a.jsxs(o5,{children:[a.jsx(l5,{children:"Confirmar Contrasena"}),a.jsxs(d5,{children:[a.jsx(c5,{type:f?"text":"password",value:l,onChange:W=>c(W.target.value),placeholder:"Repite la nueva contrasena",disabled:_,autoComplete:"new-password"}),a.jsx(u5,{type:"button",onClick:()=>m(!f),children:f?"":""})]}),l&&!D&&a.jsx("span",{style:{color:d.colors.danger,fontSize:d.typography.sizes.tiny},children:"Las contrasenas no coinciden"}),D&&a.jsx("span",{style:{color:d.colors.success,fontSize:d.typography.sizes.tiny},children:" Las contrasenas coinciden"})]}),a.jsx(My,{type:"submit",disabled:_||!H,children:_?"Guardando...":"Restablecer Contrasena"})]}),a.jsx(h5,{onClick:()=>e("login"),children:"Volver a Iniciar Sesion"})]})})}const Ry=p.div`
  padding: 1.5rem;
  max-width: 100%;
  background: #f5f5f5;
  min-height: calc(100vh - 60px);
`,Ny=p.div`
  display: flex;
  align-items: center;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,zy=p.h1`
  font-size: 1.75rem;
  font-weight: 400;
  color: #333;
  margin: 0;
`,Iy=p.button`
  background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
  color: white;
  border: none;
  padding: 0.6rem 1.5rem;
  border-radius: 50px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);

  &:hover {
    background: linear-gradient(135deg, #138496 0%, #117a8b 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
`,vne=p.div`
  background: white;
  padding: 1rem 1.5rem;
  margin-bottom: 1rem;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.08);
`,_ne=p.div`
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: flex-end;
`,Wo=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  min-width: 120px;
`,Go=p.label`
  font-size: 0.7rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Ly=p.input`
  padding: 0.45rem 0.6rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  width: 100%;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }

  &::placeholder {
    color: #999;
  }
`,Bm=p.select`
  padding: 0.45rem 0.6rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  min-width: 140px;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
  }
`,yne=p.button`
  background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
  color: white;
  border: none;
  padding: 0.5rem 1.25rem;
  border-radius: 4px;
  font-size: 0.85rem;
  cursor: pointer;
  white-space: nowrap;

  &:hover {
    background: linear-gradient(135deg, #138496 0%, #117a8b 100%);
  }
`,bne=p.div`
  background: white;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  overflow: hidden;
`,jne=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,ii=p.th`
  background: linear-gradient(135deg, #343a40 0%, #23272b 100%);
  color: white;
  padding: 0.75rem 0.5rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: none;
  white-space: nowrap;
  border: none;
`,si=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid #eee;
  vertical-align: middle;
  text-align: center;
  font-size: 0.82rem;
  color: #333;
`,wne=p.tr`
  &:hover {
    background: #f8f9fa;
  }

  &:last-child td {
    border-bottom: none;
  }
`,kne=p.span`
  display: inline-block;
  padding: 0.3rem 0.75rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  white-space: nowrap;

  ${e=>{switch(e.$state){case"rechazada":return"background: #dc3545; color: white;";case"liberada":case"aprobada":case"vigente":return"background: #28a745; color: white;";case"por_aprobar":case"pendiente":return"background: #ffc107; color: #333;";case"borrador":return"background: #6c757d; color: white;";case"vencida":return"background: #6c757d; color: white;";default:return"background: #17a2b8; color: white;"}}}
`,Sne=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-size: 0.8rem;
`,By=p.span`
  display: inline-flex;
  align-items: center;
  gap: 0.15rem;

  ${e=>{switch(e.$type){case"box":return"color: #333;";case"thumbsUp":return"color: #28a745;";case"thumbsDown":return"color: #dc3545;";default:return"color: #333;"}}}
`,Cne=p.div`
  display: flex;
  justify-content: center;
  gap: 0.25rem;
`,Uy=p.button`
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  transition: all 0.15s;
  background: ${e=>e.$color||"#6c757d"};
  color: white;

  &:hover {
    opacity: 0.85;
    transform: scale(1.05);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
`,f5=p.span`
  color: #17a2b8;
  font-weight: 500;
`,$ne=p.div`
  text-align: center;
  padding: 3rem;
  color: #666;
`,Ene=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: #666;
`,Tne=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid #ddd;
  border-top-color: #17a2b8;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Vy=p.div`
  padding: 1rem;
  border-radius: 4px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Ane={1:{label:"Borrador",key:"borrador"},2:{label:"Por Aprobar",key:"por_aprobar"},3:{label:"Liberada",key:"liberada"},4:{label:"Vigente",key:"vigente"},5:{label:"Vencida",key:"vencida"},6:{label:"Rechazada",key:"rechazada"}};function Fne({onNavigate:e}){const t=Pr(),[r,n]=C.useState(()=>{const z=new Date;return z.setMonth(z.getMonth()-2),z.toISOString().split("T")[0]}),[i,s]=C.useState(()=>new Date().toISOString().split("T")[0]),[o,l]=C.useState(""),[c,u]=C.useState([]),[h,f]=C.useState([]),[m,_]=C.useState(""),[g,v]=C.useState(""),[y,b]=C.useState({page:1,page_size:50}),[x,j]=C.useState(null),[S,T]=C.useState(null),{data:F,isLoading:w,error:P}=Nt({queryKey:["cotizaciones",y],queryFn:()=>Xn.list(y)}),{data:M}=Nt({queryKey:["cotizacion-estados"],queryFn:()=>Xn.getEstados()}),A=jt({mutationFn:z=>Xn.delete(z),onSuccess:()=>{t.invalidateQueries({queryKey:["cotizaciones"]}),j("Cotizacin eliminada correctamente"),setTimeout(()=>j(null),3e3)},onError:z=>{T(z.message||"Error al eliminar cotizacin"),setTimeout(()=>T(null),5e3)}}),D=C.useCallback(()=>{const z={page:1,page_size:50};r&&(z.date_desde=r),i&&(z.date_hasta=i),o&&(z.cotizacion_id=parseInt(o,10)),h.length>0&&(z.estado_id=h.map(ie=>parseInt(ie,10))),b(z)},[r,i,o,h]),H=C.useCallback(()=>{e("cotizacion-nueva")},[e]),U=C.useCallback(z=>{e("cotizacion-editar",z)},[e]),W=C.useCallback(z=>{e("cotizacion-editar",z)},[e]),R=C.useCallback(z=>{window.confirm("Est seguro de eliminar esta cotizacin?")&&A.mutate(z)},[A]),ae=z=>{if(!z)return"-";const ie=new Date(z);return`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}-${String(ie.getDate()).padStart(2,"0")}
${String(ie.getHours()).padStart(2,"0")}:${String(ie.getMinutes()).padStart(2,"0")}:${String(ie.getSeconds()).padStart(2,"0")}`},le=z=>{const ie=Ane[z]||{label:"Desconocido",key:"default"};return a.jsx(kne,{$state:ie.key,children:ie.label})};if(w)return a.jsxs(Ry,{children:[a.jsxs(Ny,{children:[a.jsx(zy,{children:"Cotizaciones"}),a.jsx(Iy,{onClick:H,children:"Crear Cotizacin"})]}),a.jsxs(Ene,{children:[a.jsx(Tne,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(P)return a.jsxs(Ry,{children:[a.jsxs(Ny,{children:[a.jsx(zy,{children:"Cotizaciones"}),a.jsx(Iy,{onClick:H,children:"Crear Cotizacin"})]}),a.jsxs(Vy,{$type:"error",children:["Error al cargar cotizaciones: ",P.message]})]});const G=(F==null?void 0:F.items)||[];return a.jsxs(Ry,{children:[a.jsxs(Ny,{children:[a.jsx(zy,{children:"Cotizaciones"}),a.jsx(Iy,{onClick:H,children:"Crear Cotizacin"})]}),x&&a.jsx(Vy,{$type:"success",children:x}),S&&a.jsx(Vy,{$type:"error",children:S}),a.jsx(vne,{children:a.jsxs(_ne,{children:[a.jsxs(Wo,{children:[a.jsx(Go,{children:"DESDE"}),a.jsx(Ly,{type:"date",value:r,onChange:z=>n(z.target.value)})]}),a.jsxs(Wo,{children:[a.jsx(Go,{children:"HASTA"}),a.jsx(Ly,{type:"date",value:i,onChange:z=>s(z.target.value)})]}),a.jsxs(Wo,{children:[a.jsx(Go,{children:"N DE COTIZACION"}),a.jsx(Ly,{type:"text",value:o,onChange:z=>l(z.target.value),placeholder:""})]}),a.jsxs(Wo,{style:{minWidth:"160px"},children:[a.jsx(Go,{children:"CLIENTE"}),a.jsx(Bm,{value:c[0]||"",onChange:z=>u(z.target.value?[z.target.value]:[]),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Wo,{style:{minWidth:"160px"},children:[a.jsx(Go,{children:"ESTADO"}),a.jsxs(Bm,{value:h[0]||"",onChange:z=>f(z.target.value?[z.target.value]:[]),children:[a.jsx("option",{value:"",children:"Selecciona..."}),M==null?void 0:M.map(z=>a.jsx("option",{value:z.id,children:z.nombre},z.id))]})]}),a.jsxs(Wo,{children:[a.jsx(Go,{children:"OT"}),a.jsx(Bm,{value:m,onChange:z=>_(z.target.value),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Wo,{children:[a.jsx(Go,{children:"CAD"}),a.jsx(Bm,{value:g,onChange:z=>v(z.target.value),children:a.jsx("option",{value:"",children:"Selecciona..."})})]}),a.jsxs(Wo,{children:[a.jsx(Go,{children:""}),a.jsx(yne,{onClick:D,children:"Filtrar Cotizacin"})]})]})}),a.jsx(bne,{children:G.length===0?a.jsx($ne,{children:a.jsx("p",{children:"No se encontraron cotizaciones"})}):a.jsxs(jne,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ii,{children:"Cotizacin N"}),a.jsx(ii,{children:"N de Productos"}),a.jsx(ii,{children:"Creador"}),a.jsx(ii,{children:"Cliente"}),a.jsxs(ii,{children:["Fecha Creacin",a.jsx("br",{}),"1ra Ver."]}),a.jsxs(ii,{children:["Fecha Creacin",a.jsx("br",{}),"Ult. Ver."]}),a.jsx(ii,{children:"Descrip."}),a.jsx(ii,{children:"CAD"}),a.jsx(ii,{children:"OT"}),a.jsx(ii,{children:"N Versin"}),a.jsx(ii,{children:"Estado"}),a.jsx(ii,{children:"Acciones"})]})}),a.jsx("tbody",{children:G.map(z=>a.jsxs(wne,{children:[a.jsx(si,{children:a.jsx("strong",{children:z.id})}),a.jsx(si,{children:a.jsxs(Sne,{children:[a.jsxs(By,{$type:"box",children:[" ",z.total_detalles||0]}),a.jsx(By,{$type:"thumbsUp",children:" 0"}),a.jsx(By,{$type:"thumbsDown",children:" 0"})]})}),a.jsx(si,{children:z.usuario_nombre||"Vendedor Ventas"}),a.jsx(si,{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:z.cliente_nombre||"-"}),a.jsx(si,{style:{whiteSpace:"pre-line",fontSize:"0.75rem"},children:ae(z.created_at)}),a.jsx(si,{style:{whiteSpace:"pre-line",fontSize:"0.75rem"},children:ae(z.updated_at||z.created_at)}),a.jsx(si,{children:z.primer_detalle_descripcion||"-"}),a.jsx(si,{children:z.primer_detalle_cad?a.jsx(f5,{children:z.primer_detalle_cad}):"-"}),a.jsx(si,{children:z.primer_detalle_ot?a.jsx(f5,{children:z.primer_detalle_ot}):"-"}),a.jsx(si,{children:z.version_number||1}),a.jsx(si,{children:le(z.estado_id)}),a.jsx(si,{children:a.jsxs(Cne,{children:[a.jsx(Uy,{$color:"#ffc107",onClick:()=>W(z.id),title:"Editar",children:""}),a.jsx(Uy,{$color:"#17a2b8",onClick:()=>U(z.id),title:"Ver detalles",children:""}),z.estado_id===1&&a.jsx(Uy,{$color:"#dc3545",onClick:()=>R(z.id),disabled:A.isPending,title:"Eliminar",children:""})]})})]},z.id))})]})})]})}const p5="http://localhost:8001/api/v1",Dne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
  z-index: 1100;
  overflow-y: auto;
`,Pne=p.div`
  background: white;
  border-radius: 4px;
  width: 100%;
  max-width: 900px;
  margin: 20px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
`,Mne=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #dee2e6;
`,One=p.h1`
  margin: 0;
  font-size: 1.25rem;
  color: #333;
`,Rne=p.button`
  background: none;
  border: none;
  font-size: 28px;
  cursor: pointer;
  color: #666;
  padding: 0;
  line-height: 1;

  &:hover {
    color: #333;
  }
`,Nne=p.div`
  padding: 24px;
  background-color: #F2F4FD;
`,zne=p.div`
  background: white;
  border-radius: 4px;
  padding: 20px;
`,Hh=p.div`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -12px;
`,hs=p.div`
  flex: 0 0 ${e=>(e.$size||12)/12*100}%;
  max-width: ${e=>(e.$size||12)/12*100}%;
  padding: 0 12px;
  ${e=>e.$offset?`margin-left: ${e.$offset/12*100}%;`:""}
  box-sizing: border-box;
`,st=p.div`
  margin-bottom: 16px;
`,ot=p.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,Jt=p.label`
  font-size: 12px;
  font-weight: 600;
  color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
  text-transform: uppercase;
  white-space: nowrap;
  min-width: 100px;
`,_n=p.label`
  font-size: 12px;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
  white-space: nowrap;
  min-width: 160px;
`,fs=p.input`
  flex: 1;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};
  min-width: 0;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(23, 162, 184, 0.25)"};
  }

  &:disabled, &[readonly] {
    background: #e9ecef;
  }
`,Ea=p.select`
  flex: 1;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};
  min-width: 0;

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#17a2b8"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(23, 162, 184, 0.25)"};
  }
`,m5=p.button`
  background: #17a2b8;
  color: white;
  border: none;
  padding: 8px 24px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #138496;
  }

  &:disabled {
    opacity: 0.65;
    cursor: not-allowed;
  }
`,Hy=p.button`
  background: #f8f9fa;
  color: #333;
  border: 1px solid #ddd;
  padding: 8px 24px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #e2e6ea;
  }
`,g5=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  width: 100%;

  &:hover {
    background: #218838;
  }
`,x5=p.div`
  h3 {
    font-size: 14px;
    font-weight: 600;
    margin: 0 0 12px 0;
    color: #333;
  }
`,yn=p.span`
  flex: 1;
  padding: 6px 0;
  font-size: 14px;
  color: #333;
`,Ine=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 16px;
`,Lne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1200;
`,Bne=p.div`
  background: white;
  border-radius: 4px;
  padding: 20px;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  text-align: center;
`,Une=p.p`
  margin: 0 0 20px 0;
  font-size: 14px;
  color: #333;
`,Vne=p.div`
  display: flex;
  justify-content: center;
  gap: 12px;
`,v5={tipo_calculo:1,interno_largo:null,interno_ancho:null,interno_alto:null,style_id:null,traslape:null,areahc_product_type_id:null,prepicado_ventilacion:0,onda_id:null,process_id:null,rubro_id:null,carton_color:null,ect_min_ingresado:null,envase_id:null,contenido_caja:null,areahc_pallets_apilados:null,cajas_apiladas_por_pallet:null,filas_columnares_por_pallet:null,numero_colores:null,rmt:null},Wy={externo_largo:null,externo_ancho:null,externo_alto:null,areahc:null,rmt_resultado:null,ect_min:null,codigo_carton_id:null,codigo_carton:"",ect_min_carton:null,interno_largo:null,interno_ancho:null,interno_alto:null,rubro_id:null,process_id:null,product_type_id:null,numero_colores:null},Hne={styles:[],product_types:[],processes:[],rubros:[],ondas:[],envases:[],tipos_calculo:[{id:1,nombre:"Clculo HC y Cartn"},{id:2,nombre:"Clculo HC"},{id:3,nombre:"Cartn"}],colores_carton:[{id:1,nombre:"Caf"},{id:2,nombre:"Blanco"}],prepicado_ventilacion:[{id:0,nombre:"No"},{id:1,nombre:"S"}],numero_colores:[{id:0,nombre:"0"},{id:1,nombre:"1"},{id:2,nombre:"2"},{id:3,nombre:"3"},{id:4,nombre:"4"},{id:5,nombre:"5"}]};function Wne({mode:e,onClose:t,onApply:r}){const[n,i]=C.useState(()=>({...v5,tipo_calculo:e==="carton"?3:e==="calculo_hc"?2:1})),[s,o]=C.useState(Wy),[l,c]=C.useState({}),[u,h]=C.useState(!1),[f,m]=C.useState(Hne),[_,g]=C.useState(!1),[v,y]=C.useState(!1),[b,x]=C.useState(!1);C.useEffect(()=>{(async()=>{g(!0);try{const z=await fetch(`${p5}/areahc/form-options`);if(z.ok){const ie=await z.json();m(ne=>({...ne,styles:ie.styles||[],product_types:ie.product_types||[],processes:ie.processes||[],rubros:ie.rubros||[],ondas:ie.ondas||[],envases:ie.envases||[],tipos_calculo:ie.tipos_calculo||ne.tipos_calculo,colores_carton:ie.colores_carton||ne.colores_carton,prepicado_ventilacion:ie.prepicado_ventilacion||ne.prepicado_ventilacion,numero_colores:ie.numero_colores||ne.numero_colores}))}}catch(z){console.error("Error fetching form options:",z)}finally{g(!1)}})()},[]);const j=n.tipo_calculo,S=j===1,T=j===2,F=j===3,w=S||T,P=S||F,M=C.useCallback(G=>{const{name:z,value:ie,type:ne}=G.target;let O=ie;ne==="number"?O=ie===""?null:parseFloat(ie):G.target.tagName==="SELECT"&&(O=ie===""?null:parseInt(ie)),i(N=>({...N,[z]:O})),l[z]&&c(N=>{const L={...N};return delete L[z],L}),z==="tipo_calculo"&&(o(Wy),h(!1),c({}))},[l]),A=C.useCallback(()=>{const G={},z=n.tipo_calculo;return(z===1||z===2)&&((!n.interno_largo||n.interno_largo<=0)&&(G.interno_largo="Campo requerido"),(!n.interno_ancho||n.interno_ancho<=0)&&(G.interno_ancho="Campo requerido"),(!n.interno_alto||n.interno_alto<=0)&&(G.interno_alto="Campo requerido"),n.style_id||(G.style_id="Seleccione un estilo"),n.onda_id||(G.onda_id="Seleccione tipo de onda"),n.process_id||(G.process_id="Seleccione un proceso")),(z===1||z===3)&&(n.onda_id||(G.onda_id="Seleccione tipo de onda"),n.rubro_id||(G.rubro_id="Seleccione un rubro"),n.carton_color||(G.carton_color="Seleccione color de cartn")),z===3&&(!n.ect_min_ingresado||n.ect_min_ingresado<=0)&&(G.ect_min_ingresado="Ingrese ECT mnimo"),c(G),Object.keys(G).length===0},[n]),D=C.useCallback(async()=>{if(A()){y(!0);try{const G=await fetch(`${p5}/areahc/calcular`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(G.ok){const z=await G.json();z.success?(o({externo_largo:z.externo_largo,externo_ancho:z.externo_ancho,externo_alto:z.externo_alto,areahc:z.areahc,rmt_resultado:z.rmt,ect_min:z.ect_min,codigo_carton_id:z.codigo_carton_id,codigo_carton:z.codigo_carton||"",ect_min_carton:z.ect_min_carton,interno_largo:n.interno_largo,interno_ancho:n.interno_ancho,interno_alto:n.interno_alto,rubro_id:n.rubro_id,process_id:n.process_id,product_type_id:n.areahc_product_type_id,numero_colores:n.numero_colores}),h(!0)):(console.error("Calculation error:",z.error),alert(z.error||"Error en el clculo"))}else console.error("API error:",G.status),alert("Error al comunicarse con el servidor")}catch(G){console.error("Network error:",G),alert("Error de conexin")}finally{y(!1)}}},[n,A]),H=C.useCallback(()=>{i({...v5,tipo_calculo:e==="carton"?3:e==="calculo_hc"?2:1}),o(Wy),c({}),h(!1)},[e]),U=C.useCallback(()=>{u&&x(!0)},[u]),W=C.useCallback(()=>{if(r&&u){const G={...s,interno_largo:n.interno_largo,interno_ancho:n.interno_ancho,interno_alto:n.interno_alto,rubro_id:n.rubro_id,process_id:n.process_id,product_type_id:n.areahc_product_type_id,numero_colores:n.numero_colores};r(G),x(!1),t()}},[r,s,u,n,t]),R=C.useCallback(()=>{x(!1)},[]),ae=()=>a.jsxs(Hh,{children:[a.jsxs(hs,{$size:8,children:[a.jsxs(Hh,{style:{marginBottom:"16px"},children:[a.jsx(hs,{$size:6,children:a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.onda_id,children:"Tipo de Onda:"}),a.jsxs(Ea,{name:"onda_id",value:n.onda_id??"",onChange:M,$hasError:!!l.onda_id,disabled:_,"data-testid":"select-onda",children:[a.jsx("option",{value:"",children:"-"}),f.ondas.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})})}),a.jsx(hs,{$size:6,children:a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.carton_color,children:"Color Cartn:"}),a.jsxs(Ea,{name:"carton_color",value:n.carton_color??"",onChange:M,$hasError:!!l.carton_color,"data-testid":"select-color-carton",children:[a.jsx("option",{value:"",children:"-"}),f.colores_carton.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})})})]}),a.jsxs(Hh,{children:[a.jsx(hs,{$size:6,children:a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.rubro_id,children:"Rubro:"}),a.jsxs(Ea,{name:"rubro_id",value:n.rubro_id??"",onChange:M,$hasError:!!l.rubro_id,disabled:_,"data-testid":"select-rubro",children:[a.jsx("option",{value:"",children:"-"}),f.rubros.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})})}),a.jsx(hs,{$size:6,children:a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.ect_min_ingresado,children:"ECT min (lbf):"}),a.jsx(fs,{type:"number",name:"ect_min_ingresado",value:n.ect_min_ingresado??"",onChange:M,$hasError:!!l.ect_min_ingresado,"data-testid":"input-ect-min"})]})})})]})]}),a.jsx(hs,{$size:4,children:a.jsxs(x5,{children:[a.jsx("h3",{children:"Resultados"}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Largo Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-largo",children:u?s.externo_largo??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Ancho Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-ancho",children:u?s.externo_ancho??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Alto Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-alto",children:u?s.externo_alto??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Area HC (m2):"}),a.jsx(yn,{"data-testid":"result-areahc",children:u?s.areahc??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"RMT (lb):"}),a.jsx(yn,{"data-testid":"result-rmt",children:u?s.rmt_resultado??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"ECT min (lbf):"}),a.jsx(yn,{"data-testid":"result-ect",children:u?s.ect_min??"":""})]})}),a.jsx("h3",{children:"Cartn Seleccionado"}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Cdigo Cartn:"}),a.jsx(yn,{"data-testid":"result-codigo-carton",children:u?s.codigo_carton:""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"ECT min (lbf) Cartn:"}),a.jsx(yn,{"data-testid":"result-ect-carton",children:u?s.ect_min_carton??"":""})]})}),u&&a.jsx(g5,{type:"button",onClick:U,style:{marginTop:"16px"},"data-testid":"btn-llevar-detalle",children:"Llevar a Detalle"})]})})]}),le=()=>a.jsxs(Hh,{children:[a.jsx(hs,{$size:4,children:w&&a.jsxs(a.Fragment,{children:[a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.interno_largo,children:"Largo (mm):"}),a.jsx(fs,{type:"number",name:"interno_largo",value:n.interno_largo??"",onChange:M,$hasError:!!l.interno_largo,"data-testid":"input-largo"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.interno_ancho,children:"Ancho (mm):"}),a.jsx(fs,{type:"number",name:"interno_ancho",value:n.interno_ancho??"",onChange:M,$hasError:!!l.interno_ancho,"data-testid":"input-ancho"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.interno_alto,children:"Alto (mm):"}),a.jsx(fs,{type:"number",name:"interno_alto",value:n.interno_alto??"",onChange:M,$hasError:!!l.interno_alto,"data-testid":"input-alto"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.style_id,children:"Estilo:"}),a.jsxs(Ea,{name:"style_id",value:n.style_id??"",onChange:M,$hasError:!!l.style_id,disabled:_,"data-testid":"select-estilo",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.styles.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Traslape [mm]:"}),a.jsx(fs,{type:"number",name:"traslape",value:n.traslape??"",onChange:M,"data-testid":"input-traslape"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.areahc_product_type_id,children:"Tipo item:"}),a.jsxs(Ea,{name:"areahc_product_type_id",value:n.areahc_product_type_id??"",onChange:M,$hasError:!!l.areahc_product_type_id,disabled:_,"data-testid":"select-tipo-item",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.product_types.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),S&&a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Prepicado:"}),a.jsx(Ea,{name:"prepicado_ventilacion",value:n.prepicado_ventilacion,onChange:M,"data-testid":"select-prepicado",children:f.prepicado_ventilacion.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.onda_id,children:"Tipo de Onda:"}),a.jsxs(Ea,{name:"onda_id",value:n.onda_id??"",onChange:M,$hasError:!!l.onda_id,disabled:_,"data-testid":"select-onda",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.ondas.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.process_id,children:"Proceso:"}),a.jsxs(Ea,{name:"process_id",value:n.process_id??"",onChange:M,$hasError:!!l.process_id,disabled:_,"data-testid":"select-proceso",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.processes.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),P&&a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.rubro_id,children:"Rubro:"}),a.jsxs(Ea,{name:"rubro_id",value:n.rubro_id??"",onChange:M,$hasError:!!l.rubro_id,disabled:_,"data-testid":"select-rubro",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.rubros.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})})]})}),a.jsx(hs,{$size:4,children:w&&S&&a.jsxs(a.Fragment,{children:[a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Envase Primario:"}),a.jsxs(Ea,{name:"envase_id",value:n.envase_id??"",onChange:M,disabled:_,"data-testid":"select-envase",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.envases.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Contenido Caja (Kg):"}),a.jsx(fs,{type:"number",name:"contenido_caja",value:n.contenido_caja??"",onChange:M,"data-testid":"input-contenido-caja"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"N Palets apilados:"}),a.jsx(fs,{type:"number",name:"areahc_pallets_apilados",value:n.areahc_pallets_apilados??"",onChange:M,"data-testid":"input-pallets"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"N Cajas Apiladas:"}),a.jsx(fs,{type:"number",name:"cajas_apiladas_por_pallet",value:n.cajas_apiladas_por_pallet??"",onChange:M,"data-testid":"input-cajas-apiladas"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"N Filas Colum.:"}),a.jsx(fs,{type:"number",name:"filas_columnares_por_pallet",value:n.filas_columnares_por_pallet??"",onChange:M,"data-testid":"input-filas"})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{$hasError:!!l.carton_color,children:"Color Cartn:"}),a.jsxs(Ea,{name:"carton_color",value:n.carton_color??"",onChange:M,$hasError:!!l.carton_color,"data-testid":"select-color-carton",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.colores_carton.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Nmero Colores:"}),a.jsxs(Ea,{name:"numero_colores",value:n.numero_colores??"",onChange:M,"data-testid":"select-numero-colores",children:[a.jsx("option",{value:"",children:"Seleccionar..."}),f.numero_colores.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))]})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"RMT (Lb):"}),a.jsx(fs,{type:"number",name:"rmt",value:n.rmt??"",onChange:M,"data-testid":"input-rmt"})]})})]})}),a.jsx(hs,{$size:4,children:a.jsxs(x5,{children:[a.jsx("h3",{children:"Resultados"}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Largo Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-largo",children:u?s.externo_largo??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Ancho Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-ancho",children:u?s.externo_ancho??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Alto Exterior (mm):"}),a.jsx(yn,{"data-testid":"result-alto",children:u?s.externo_alto??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Area HC (m2):"}),a.jsx(yn,{"data-testid":"result-areahc",children:u?s.areahc??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"RMT (lb):"}),a.jsx(yn,{"data-testid":"result-rmt",children:u?s.rmt_resultado??"":""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"ECT min (lbf):"}),a.jsx(yn,{"data-testid":"result-ect",children:u?s.ect_min??"":""})]})}),a.jsx("h3",{children:"Cartn Seleccionado"}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"Cdigo Cartn:"}),a.jsx(yn,{"data-testid":"result-codigo-carton",children:u?s.codigo_carton:""})]})}),a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(_n,{children:"ECT min (lbf) Cartn:"}),a.jsx(yn,{"data-testid":"result-ect-carton",children:u?s.ect_min_carton??"":""})]})}),u&&a.jsx(g5,{type:"button",onClick:U,style:{marginTop:"16px"},"data-testid":"btn-llevar-detalle",children:"Llevar a Detalle"})]})})]});return a.jsxs(a.Fragment,{children:[a.jsx(Dne,{"data-testid":"modal-calculo-hc",children:a.jsxs(Pne,{children:[a.jsxs(Mne,{children:[a.jsx(One,{children:"Clculo HC y Cartn"}),a.jsx(Rne,{onClick:t,"data-testid":"btn-close",children:""})]}),a.jsxs(Nne,{children:[a.jsxs(zne,{children:[a.jsx(Hh,{style:{marginBottom:"24px"},children:a.jsx(hs,{$size:4,$offset:4,children:a.jsx(st,{children:a.jsxs(ot,{children:[a.jsx(Jt,{children:"Tipo de Clculo"}),a.jsx(Ea,{name:"tipo_calculo",value:n.tipo_calculo,onChange:M,disabled:_,"data-testid":"select-tipo-calculo",children:f.tipos_calculo.map(G=>a.jsx("option",{value:G.id,children:G.nombre},G.id))})]})})})}),F?ae():le()]}),a.jsxs(Ine,{children:[a.jsx(Hy,{onClick:t,"data-testid":"btn-cancelar",children:"Cancelar"}),a.jsx(Hy,{onClick:H,"data-testid":"btn-limpiar",children:"Limpiar"}),a.jsx(m5,{onClick:D,disabled:v,"data-testid":"btn-calcular",children:v?"Calculando...":"Calcular"})]})]})]})}),b&&a.jsx(Lne,{children:a.jsxs(Bne,{children:[a.jsx(Une,{children:n.carton_color?"Cartn estimado, favor validar este dato con desarrollo":"rea Hoja Corrugada estimada, favor validar este dato con desarrollo"}),a.jsxs(Vne,{children:[a.jsx(Hy,{onClick:R,children:"Cancelar"}),a.jsx(m5,{onClick:W,children:"Confirmo"})]})]})})]})}const Gne="http://localhost:8001/api/v1",qne={product_types:[],processes:[],rubros:[],cartons:[],printing_machines:[],print_types:[],pegados:[],barniz_types:[],ink_types:[],pallet_heights:[],cities:[],hierarchies:[],cartons_esquinero:[],maquila_servicios:[],pallets:[{id:0,nombre:"No"},{id:1,nombre:"Madera"},{id:2,nombre:"Plstico"}],zunchos:[{id:0,nombre:"No"},{id:1,nombre:"1 zuncho"},{id:2,nombre:"2 zunchos"},{id:3,nombre:"3 zunchos"}],si_no:[{id:0,nombre:"No"},{id:1,nombre:"Si"}],numero_colores:Array.from({length:7},(e,t)=>({id:t,nombre:String(t)})),pallets_apilados:[{id:1,nombre:"1"},{id:2,nombre:"2"}],tipo_destino_esquinero:[{id:1,nombre:"Tarima Nacional"},{id:2,nombre:"Empaque Exportacin (Granel)"},{id:3,nombre:"Tarima de Exportacin"}],tipo_camion_esquinero:[{id:1,nombre:"Camin 7x2,6mts"}]},Kne=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
  z-index: 1000;
  overflow-y: auto;
`,Xne=p.div`
  background: white;
  border-radius: 4px;
  width: 100%;
  max-width: 1400px;
  margin: 20px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
`,Yne=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-bottom: 1px solid #dee2e6;
`,Qne=p.h1`
  margin: 0;
  font-size: 1.5rem;
  color: #333;
`,Jne=p.button`
  background: none;
  border: none;
  font-size: 28px;
  cursor: pointer;
  color: #666;
  padding: 0;
  line-height: 1;

  &:hover {
    color: #333;
  }
`,Zne=p.div`
  padding: 16px;
  background: #F2F4FD;
  max-height: calc(100vh - 180px);
  overflow-y: auto;
`,Od=p.div`
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.125);
  border-radius: 4px;
  margin-bottom: 16px;
`,ac=p.div`
  padding: 12px 20px;
  background: #f8f9fa;
  border-bottom: 1px solid rgba(0, 0, 0, 0.125);
  font-weight: 500;
  font-size: 14px;
  color: #333;
  ${e=>e.$center&&`
    text-align: center;
    font-size: 18px;
  `}
`,Rd=p.div`
  padding: 20px;
`,oi=p.div`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -8px;
`,Zt=p.div`
  flex: 0 0 ${e=>(e.$size||12)/12*100}%;
  max-width: ${e=>(e.$size||12)/12*100}%;
  padding: 0 8px;
  ${e=>e.$offset&&`margin-left: ${e.$offset/12*100}%;`}
`,Be=p.div`
  margin-bottom: 12px;
`,Ue=p.label`
  font-size: 12px;
  color: #333;
  margin-bottom: 4px;
  display: block;
  min-width: auto;
  white-space: nowrap;
`,lr=p.input`
  width: 100%;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#80bdff"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(0, 123, 255, 0.25)"};
  }

  &:disabled, &[readonly] {
    background: #e9ecef;
  }
`,lt=p.select`
  width: 100%;
  padding: 6px 12px;
  border: 1px solid ${e=>e.$hasError?"#dc3545":"#ced4da"};
  border-radius: 4px;
  font-size: 14px;
  background: ${e=>e.$hasError?"#fff8f8":"white"};

  &:focus {
    outline: none;
    border-color: ${e=>e.$hasError?"#dc3545":"#80bdff"};
    box-shadow: 0 0 0 0.2rem ${e=>e.$hasError?"rgba(220, 53, 69, 0.25)":"rgba(0, 123, 255, 0.25)"};
  }
`,la=p.div`
  color: #dc3545;
  font-size: 11px;
  margin-top: 4px;
`,Ww=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 4px;

  &:hover {
    background: #218838;
  }

  &:disabled {
    opacity: 0.65;
    cursor: not-allowed;
  }
`,eae=p.button`
  background: #f8f9fa;
  color: #333;
  border: 1px solid #ddd;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;

  &:hover {
    background: #e2e6ea;
  }
`,_5=p.button`
  background: #28a745;
  color: white;
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;

  &:hover {
    background: #218838;
  }
`,tae=p(Ww)`
  width: 100%;
`,y5=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #6c757d;
  color: white;
  font-size: 12px;
  cursor: help;
  margin-left: 4px;
`,b5=p.div`
  display: flex;
  gap: 8px;

  input, select {
    flex: 1;
  }
`,j5=p.div`
  display: flex;
  align-items: center;
  gap: 4px;

  input {
    flex: 1;
  }
`,w5={tipo_detalle_id:1,cantidad:null,product_type_id:null,numero_colores:null,planta_id:1,variable_cotizador_id:1,largo:null,ancho:null,alto:null,tipo_medida:1,area_hc:null,anchura:null,largura:null,carton_id:null,golpes_largo:1,golpes_ancho:1,printing_machine_id:null,print_type_id:null,process_id:null,ink_type_id:null,numero_colores_esquinero:null,pegado_id:null,cinta_desgarro:null,barniz:null,barniz_type_id:null,cobertura_color_percent:0,cobertura_barniz_cm2:0,cobertura_color_cm2:0,pallet:1,pallet_height_id:null,zuncho:null,funda:0,stretch_film:1,ensamblado:null,desgajado_cabezal:null,rubro_id:null,bct_min_lb:null,bct_min_kg:null,descripcion_material_detalle:"",cad_material_detalle:"",codigo_cliente:"",devolucion_pallets:1,ajuste_precios:0,codigo_material_detalle:"",hierarchy_id:null,subhierarchy_id:null,subsubhierarchy_id:null,matriz:null,clisse:0,royalty:0,maquila:0,maquila_servicio_id:null,cuchillos_gomas:null,armado_automatico:null,armado_usd_caja:null,largo_esquinero:null,carton_esquinero_id:null,funda_esquinero:null,tipo_destino_esquinero:null,tipo_camion_esquinero:null,maquila_esquinero:null,clisse_esquinero:null,cantidad_esquinero:null,ciudad_id:null,pallets_apilados:null};function rae({detalle:e,plantaId:t,onSubmit:r,onCancel:n}){const[i,s]=C.useState(e||{...w5,planta_id:t||1}),[o,l]=C.useState({}),[c,u]=C.useState(!1),[h,f]=C.useState("ambos"),[m,_]=C.useState(qne),[g,v]=C.useState(!0),y=!!(e!=null&&e.id),b=i.tipo_detalle_id===1;C.useEffect(()=>{(async()=>{v(!0);try{const D=await fetch(`${Gne}/areahc/form-options-complete`);if(D.ok){const H=await D.json();_(U=>({...U,...H}))}else console.error("Error fetching form options:",D.status)}catch(D){console.error("Error fetching form options:",D)}finally{v(!1)}})()},[]),C.useEffect(()=>{if(i.bct_min_lb){const A=i.bct_min_lb*.453592;s(D=>({...D,bct_min_kg:parseFloat(A.toFixed(2))}))}},[i.bct_min_lb]),C.useEffect(()=>{t&&t!==i.planta_id&&s(A=>({...A,planta_id:t}))},[t]);const x=C.useCallback(A=>{const{name:D,value:H,type:U}=A.target;let W=H;U==="number"?W=H===""?null:parseFloat(H):A.target.tagName==="SELECT"&&(W=H===""?null:parseInt(H)),s(R=>({...R,[D]:W})),o[D]&&l(R=>{const ae={...R};return delete ae[D],ae})},[o]),j=C.useCallback(A=>{const{name:D,value:H}=A.target;s(U=>({...U,[D]:H}))},[]),S=C.useCallback(()=>{const A={};return b?(i.carton_id||(A.carton_id="Seleccione un cartn"),(!i.area_hc||i.area_hc<=0)&&(A.area_hc="El rea HC es requerida"),(!i.anchura||i.anchura<=0)&&(A.anchura="El ancho hoja madre es requerido"),(!i.largura||i.largura<=0)&&(A.largura="El largo hoja madre es requerido"),(i.numero_colores===null||i.numero_colores===void 0)&&(A.numero_colores="Seleccione nmero de colores"),i.process_id||(A.process_id="Seleccione un proceso"),(!i.cantidad||i.cantidad<=0)&&(A.cantidad="La cantidad debe ser mayor a 0"),i.product_type_id||(A.product_type_id="Seleccione un tipo de item"),(i.cinta_desgarro===null||i.cinta_desgarro===void 0)&&(A.cinta_desgarro="Seleccione cinta desgarro"),(i.zuncho===null||i.zuncho===void 0)&&(A.zuncho="Seleccione zunchos"),i.rubro_id||(A.rubro_id="Seleccione un rubro"),i.ciudad_id||(A.ciudad_id="Seleccione una ciudad")):((!i.cantidad_esquinero||i.cantidad_esquinero<=0)&&(A.cantidad_esquinero="La cantidad debe ser mayor a 0"),i.carton_esquinero_id||(A.carton_esquinero_id="Seleccione un cartn")),l(A),Object.keys(A).length===0},[i,b]),T=C.useCallback(()=>{S()&&r(i)},[i,S,r]),F=C.useCallback(()=>{s({...w5,planta_id:t||1}),l({})},[t]),w=C.useCallback(()=>{f("carton"),u(!0)},[]),P=C.useCallback(()=>{f("calculo_hc"),u(!0)},[]),M=C.useCallback(A=>{s(D=>({...D,...A.interno_largo!==void 0&&A.interno_largo!==null&&{largo:A.interno_largo},...A.interno_ancho!==void 0&&A.interno_ancho!==null&&{ancho:A.interno_ancho},...A.interno_alto!==void 0&&A.interno_alto!==null&&{alto:A.interno_alto},...A.areahc!==void 0&&A.areahc!==null&&{area_hc:A.areahc},...A.codigo_carton_id!==void 0&&A.codigo_carton_id!==null&&{carton_id:A.codigo_carton_id},...A.rubro_id!==void 0&&A.rubro_id!==null&&{rubro_id:A.rubro_id},...A.process_id!==void 0&&A.process_id!==null&&{process_id:A.process_id},...A.product_type_id!==void 0&&A.product_type_id!==null&&{product_type_id:A.product_type_id},...A.numero_colores!==void 0&&A.numero_colores!==null&&{numero_colores:A.numero_colores}})),u(!1)},[]);return a.jsxs(Kne,{children:[a.jsxs(Xne,{children:[a.jsxs(Yne,{children:[a.jsx(Qne,{children:y?"Editar Detalle":"Crear Detalle"}),a.jsx(Jne,{onClick:n,children:""})]}),a.jsxs(Zne,{children:[g&&a.jsx("div",{style:{textAlign:"center",padding:"10px",color:"#666"},children:"Cargando opciones..."}),a.jsxs(Od,{children:[a.jsx(ac,{children:"SELECCIONAR TIPO DE PRODUCTO"}),a.jsx(Rd,{style:{padding:"4px 20px"},children:a.jsx(oi,{children:a.jsx(Zt,{$size:4,$offset:4,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Producto"}),a.jsxs(lt,{name:"tipo_detalle_id",value:i.tipo_detalle_id,onChange:x,children:[a.jsx("option",{value:1,children:"Corrugado"}),a.jsx("option",{value:2,children:"Esquinero"})]})]})})})})]}),a.jsxs(Od,{children:[a.jsx(ac,{$center:!0,children:b?"CORRUGADO":"ESQUINERO"}),a.jsx(ac,{children:"Caracteristicas"}),a.jsxs(Rd,{children:[b&&a.jsx(oi,{style:{marginBottom:"16px"},children:a.jsx(Zt,{$size:4,children:a.jsx(tae,{type:"button",children:"Buscar por Material "})})}),b?a.jsxs(oi,{children:[a.jsxs(Zt,{$size:4,children:[a.jsx(Be,{children:a.jsxs(b5,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Cartn ",o.carton_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"carton_id",value:i.carton_id||"",onChange:x,$hasError:!!o.carton_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cartons.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.carton_id&&a.jsx(la,{children:o.carton_id})]}),a.jsx(_5,{type:"button",style:{marginTop:"20px"},onClick:w,children:"Estimacin Cartn"})]})}),a.jsx(Be,{children:a.jsxs(b5,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Area HC (m2): ",o.area_hc&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(lr,{type:"number",name:"area_hc",value:i.area_hc??"",onChange:x,min:0,max:99,$hasError:!!o.area_hc}),o.area_hc&&a.jsx(la,{children:o.area_hc})]}),a.jsx(_5,{type:"button",style:{marginTop:"20px"},onClick:P,children:"Clculo AHC"})]})}),a.jsx(Be,{children:a.jsxs(j5,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Ancho Hoja Madre (mm): ",o.anchura&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(lr,{type:"number",name:"anchura",value:i.anchura??"",onChange:x,$hasError:!!o.anchura}),o.anchura&&a.jsx(la,{children:o.anchura})]}),a.jsx(y5,{title:"Ver imagen de referencia",children:"?"})]})}),a.jsx(Be,{children:a.jsxs(j5,{children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs(Ue,{children:["Largo Hoja Madre (mm): ",o.largura&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(lr,{type:"number",name:"largura",value:i.largura??"",onChange:x,$hasError:!!o.largura}),o.largura&&a.jsx(la,{children:o.largura})]}),a.jsx(y5,{title:"Ver imagen de referencia",children:"?"})]})}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Tipo item ",o.product_type_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"product_type_id",value:i.product_type_id||"",onChange:x,$hasError:!!o.product_type_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.product_types.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.product_type_id&&a.jsx(la,{children:o.product_type_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Mquina Impresora"}),a.jsxs(lt,{name:"printing_machine_id",value:i.printing_machine_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.printing_machines.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Impresin"}),a.jsxs(lt,{name:"print_type_id",value:i.print_type_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.print_types.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Nmero Colores ",o.numero_colores&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"numero_colores",value:i.numero_colores??"",onChange:x,$hasError:!!o.numero_colores,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),[0,1,2,3,4,5,6].map(A=>a.jsx("option",{value:A,children:A},A))]}),o.numero_colores&&a.jsx(la,{children:o.numero_colores})]}),a.jsxs(oi,{children:[a.jsx(Zt,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Golpes largo:"}),a.jsx(lr,{type:"number",name:"golpes_largo",value:i.golpes_largo,onChange:x,min:0,max:20})]})}),a.jsx(Zt,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Golpes ancho:"}),a.jsx(lr,{type:"number",name:"golpes_ancho",value:i.golpes_ancho,onChange:x,min:0,max:20})]})})]})]}),a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Proceso ",o.process_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"process_id",value:i.process_id||"",onChange:x,$hasError:!!o.process_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.processes.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.process_id&&a.jsx(la,{children:o.process_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Pegado"}),a.jsxs(lt,{name:"pegado_id",value:i.pegado_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.pegados.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cinta Desgarro ",o.cinta_desgarro&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"cinta_desgarro",value:i.cinta_desgarro??"",onChange:x,$hasError:!!o.cinta_desgarro,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]}),o.cinta_desgarro&&a.jsx(la,{children:o.cinta_desgarro})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Barniz"}),a.jsxs(lt,{name:"barniz",value:i.barniz??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo de Barniz"}),a.jsxs(lt,{name:"barniz_type_id",value:i.barniz_type_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.barniz_types.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cobertura color (%):"}),a.jsx(lr,{type:"number",name:"cobertura_color_percent",value:i.cobertura_color_percent,onChange:x,min:0})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cobertura barniz (cm2):"}),a.jsx(lr,{type:"number",name:"cobertura_barniz_cm2",value:i.cobertura_barniz_cm2,onChange:x,min:0})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse por un golpe (cm2):"}),a.jsx(lr,{type:"number",name:"cobertura_color_cm2",value:i.cobertura_color_cm2,onChange:x,min:0})]})]}),a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Pallet"}),a.jsx(lt,{name:"pallet",value:i.pallet,onChange:x,children:m.pallets.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Altura Pallet"}),a.jsxs(lt,{name:"pallet_height_id",value:i.pallet_height_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.pallet_heights.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Zunchos ",o.zuncho&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"zuncho",value:i.zuncho??"",onChange:x,$hasError:!!o.zuncho,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.zunchos.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.zuncho&&a.jsx(la,{children:o.zuncho})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Funda"}),a.jsxs(lt,{name:"funda",value:i.funda,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Strech Film"}),a.jsxs(lt,{name:"stretch_film",value:i.stretch_film,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Ensamblado"}),a.jsxs(lt,{name:"ensamblado",value:i.ensamblado??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Desgajado Cabezal"}),a.jsxs(lt,{name:"desgajado_cabezal",value:i.desgajado_cabezal??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Rubro ",o.rubro_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"rubro_id",value:i.rubro_id||"",onChange:x,$hasError:!!o.rubro_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.rubros.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.rubro_id&&a.jsx(la,{children:o.rubro_id})]})]})]}):a.jsx(oi,{children:a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Largo o medida (m):"}),a.jsx(lr,{type:"number",name:"largo_esquinero",value:i.largo_esquinero??"",onChange:x,min:0,max:3})]}),a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cartn ",o.carton_esquinero_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"carton_esquinero_id",value:i.carton_esquinero_id||"",onChange:x,$hasError:!!o.carton_esquinero_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cartons_esquinero.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.carton_esquinero_id&&a.jsx(la,{children:o.carton_esquinero_id})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Nmero Colores"}),a.jsxs(lt,{name:"numero_colores_esquinero",value:i.numero_colores_esquinero??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),[0,1,2].map(A=>a.jsx("option",{value:A,children:A},A))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Incluye funda?"}),a.jsxs(lt,{name:"funda_esquinero",value:i.funda_esquinero??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})})]})]}),b&&a.jsxs(oi,{children:[a.jsx(Zt,{$size:8,children:a.jsxs(Od,{style:{height:"100%"},children:[a.jsx(ac,{children:"CAMPOS OPCIONALES (DATOS PARA INCLUIR EN LA CARTA DE OFERTA)"}),a.jsx(Rd,{children:a.jsxs(oi,{children:[a.jsxs(Zt,{$size:6,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Medidas"}),a.jsxs(lt,{name:"tipo_medida",value:i.tipo_medida,onChange:x,children:[a.jsx("option",{value:1,children:"Internas"}),a.jsx("option",{value:2,children:"Externas"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Largo (mm):"}),a.jsx(lr,{type:"number",name:"largo",value:i.largo??"",onChange:x})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Ancho (mm):"}),a.jsx(lr,{type:"number",name:"ancho",value:i.ancho??"",onChange:x})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Alto (mm):"}),a.jsx(lr,{type:"number",name:"alto",value:i.alto??"",onChange:x})]}),a.jsxs(oi,{children:[a.jsx(Zt,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"BCT MIN (LB):"}),a.jsx(lr,{type:"number",name:"bct_min_lb",value:i.bct_min_lb||"",onChange:x})]})}),a.jsx(Zt,{$size:6,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"BCT MIN (KG):"}),a.jsx(lr,{type:"text",value:i.bct_min_kg||"",readOnly:!0})]})})]})]}),a.jsxs(Zt,{$size:6,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Descripcin (material):"}),a.jsx(lr,{type:"text",name:"descripcion_material_detalle",value:i.descripcion_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"CAD (material):"}),a.jsx(lr,{type:"text",name:"cad_material_detalle",value:i.cad_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cod. interno cliente:"}),a.jsx(lr,{type:"text",name:"codigo_cliente",value:i.codigo_cliente,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clusula Devolucin de Pallets"}),a.jsxs(lt,{name:"devolucion_pallets",value:i.devolucion_pallets,onChange:x,children:[a.jsx("option",{value:1,children:"Si"}),a.jsx("option",{value:0,children:"No"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clusula Ajuste de Precios"}),a.jsxs(lt,{name:"ajuste_precios",value:i.ajuste_precios,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})]})})]})}),a.jsx(Zt,{$size:4,children:a.jsxs(Od,{style:{height:"100%"},children:[a.jsx(ac,{children:"CAMPOS OPCIONALES (SOLO EN CASO QUE SE QUIERA CONVERTIR COTIZACIN A OT)"}),a.jsxs(Rd,{children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cdigo (material):"}),a.jsx(lr,{type:"text",name:"codigo_material_detalle",value:i.codigo_material_detalle,onChange:j})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 1"}),a.jsxs(lt,{name:"hierarchy_id",value:i.hierarchy_id||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.hierarchies.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 2"}),a.jsx(lt,{name:"subhierarchy_id",value:i.subhierarchy_id||"",onChange:x,children:a.jsx("option",{value:"",children:"Seleccionar..."})})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Jerarqua 3"}),a.jsx(lt,{name:"subsubhierarchy_id",value:i.subsubhierarchy_id||"",onChange:x,children:a.jsx("option",{value:"",children:"Seleccionar..."})})]})]})]})})]}),a.jsxs(Od,{children:[a.jsx(ac,{children:"Servicios"}),a.jsx(Rd,{children:b?a.jsxs(oi,{children:[a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Matriz"}),a.jsxs(lt,{name:"matriz",value:i.matriz??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse"}),a.jsxs(lt,{name:"clisse",value:i.clisse,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Royalty"}),a.jsxs(lt,{name:"royalty",value:i.royalty,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]}),a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Maquila"}),a.jsxs(lt,{name:"maquila",value:i.maquila,onChange:x,children:[a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Cuchillos y gomas (m):"}),a.jsx(lr,{type:"number",name:"cuchillos_gomas",value:i.cuchillos_gomas??"",onChange:x})]})]}),a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Armado"}),a.jsxs(lt,{name:"armado_automatico",value:i.armado_automatico??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Armado (US$/UN):"}),a.jsx(lr,{type:"number",name:"armado_usd_caja",value:i.armado_usd_caja??"",onChange:x})]})]})]}):a.jsx(oi,{children:a.jsxs(Zt,{$size:4,children:[a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo Destino (palletizado)"}),a.jsxs(lt,{name:"tipo_destino_esquinero",value:i.tipo_destino_esquinero||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.tipo_destino_esquinero.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Tipo Camin"}),a.jsxs(lt,{name:"tipo_camion_esquinero",value:i.tipo_camion_esquinero||"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.tipo_camion_esquinero.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Maquila"}),a.jsxs(lt,{name:"maquila_esquinero",value:i.maquila_esquinero??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]}),a.jsxs(Be,{children:[a.jsx(Ue,{children:"Clisse"}),a.jsxs(lt,{name:"clisse_esquinero",value:i.clisse_esquinero??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:0,children:"No"}),a.jsx("option",{value:1,children:"Si"})]})]})]})})})]}),a.jsxs(Od,{children:[a.jsx(ac,{children:"Destino"}),a.jsxs(Rd,{children:[a.jsxs(oi,{children:[a.jsx(Zt,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Lugar de Destino ",o.ciudad_id&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsxs(lt,{name:"ciudad_id",value:i.ciudad_id||"",onChange:x,$hasError:!!o.ciudad_id,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),m.cities.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))]}),o.ciudad_id&&a.jsx(la,{children:o.ciudad_id})]})}),b&&a.jsxs(a.Fragment,{children:[a.jsx(Zt,{$size:3,children:a.jsxs(Be,{children:[a.jsx(Ue,{children:"Pallets Apilados"}),a.jsxs(lt,{name:"pallets_apilados",value:i.pallets_apilados??"",onChange:x,children:[a.jsx("option",{value:"",children:"Seleccionar..."}),a.jsx("option",{value:1,children:"1"}),a.jsx("option",{value:2,children:"2"})]})]})}),a.jsx(Zt,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cantidad (UN): ",o.cantidad&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(lr,{type:"number",name:"cantidad",value:i.cantidad??"",onChange:x,min:1,$hasError:!!o.cantidad}),o.cantidad&&a.jsx(la,{children:o.cantidad})]})})]}),!b&&a.jsx(Zt,{$size:3,children:a.jsxs(Be,{children:[a.jsxs(Ue,{children:["Cantidad (UN): ",o.cantidad_esquinero&&a.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),a.jsx(lr,{type:"number",name:"cantidad_esquinero",value:i.cantidad_esquinero??"",onChange:x,min:1,$hasError:!!o.cantidad_esquinero}),o.cantidad_esquinero&&a.jsx(la,{children:o.cantidad_esquinero})]})})]}),a.jsx(oi,{style:{marginTop:"16px"},children:a.jsx(Zt,{$size:12,style:{textAlign:"center"},children:a.jsx(Ww,{type:"button",children:"Agregar Destino"})})})]})]}),a.jsxs("div",{style:{marginTop:"16px",textAlign:"right"},children:[a.jsx(eae,{onClick:F,style:{marginRight:"8px"},children:"Limpiar"}),a.jsx(Ww,{onClick:T,children:"Guardar Detalle"})]})]})]}),c&&a.jsx(Wne,{mode:h,onClose:()=>u(!1),onApply:M})]})}const nae=p.div`
  padding: 1.5rem;
  max-width: 100%;
  background: #f5f5f5;
  min-height: calc(100vh - 60px);
`,aae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1.5rem;
`,iae=p.div``,sae=p.button`
  background: none;
  border: none;
  color: #17a2b8;
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,oae=p.h1`
  font-size: 1.5rem;
  font-weight: 400;
  color: #333;
  margin: 0;
`,lae=p.div`
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 0.5rem;
`,Um=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  color: #666;
`,Vm=p.span`
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: #17a2b8;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: 600;
`,Gy=p.div`
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 1.5rem;
`,k5=p.div`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid #ddd;
  background: #fafafa;
`,qy=p.h3`
  font-size: 0.8rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  margin: 0;
  letter-spacing: 0.5px;
`,Ky=p.div`
  padding: 1rem;
`,cae=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;

  @media (max-width: 1200px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,dae=p.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-top: 1rem;
`,ic=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,sc=p.label`
  font-size: 0.7rem;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Xy=p.select`
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;
  background: white;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }
`,Yy=p.input`
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.85rem;

  &:focus {
    outline: none;
    border-color: #17a2b8;
    box-shadow: 0 0 0 2px rgba(23, 162, 184, 0.15);
  }

  &:disabled {
    background: #f5f5f5;
    color: #666;
  }
`,uae=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,hae=p.input`
  width: 16px;
  height: 16px;
  accent-color: #17a2b8;
`,fae=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #17a2b8;
  color: white;
  font-size: 0.7rem;
  cursor: help;
`,pae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid #ddd;
  background: #fafafa;
`,mae=p.div`
  display: flex;
  gap: 0.5rem;
`,Wh=p.button`
  padding: 0.45rem 1rem;
  border-radius: 4px;
  font-size: 0.85rem;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;

  ${e=>{switch(e.$variant){case"primary":return`
          background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
          color: white;
          border: none;
          &:hover { background: linear-gradient(135deg, #138496 0%, #117a8b 100%); }
        `;case"success":return`
          background: linear-gradient(135deg, #28a745 0%, #218838 100%);
          color: white;
          border: none;
          &:hover { background: linear-gradient(135deg, #218838 0%, #1e7e34 100%); }
        `;case"outline":return`
          background: white;
          color: #17a2b8;
          border: 1px solid #17a2b8;
          &:hover { background: #f0f9fa; }
        `;case"danger":return`
          background: #dc3545;
          color: white;
          border: none;
          &:hover { background: #c82333; }
        `;default:return`
          background: #f0f0f0;
          color: #333;
          border: 1px solid #ddd;
          &:hover { background: #e0e0e0; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,gae=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,Cr=p.th`
  background: linear-gradient(135deg, #343a40 0%, #23272b 100%);
  color: white;
  padding: 0.6rem 0.4rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.7rem;
  white-space: nowrap;
  border: none;
`,$r=p.td`
  padding: 0.5rem 0.4rem;
  border-bottom: 1px solid #eee;
  vertical-align: middle;
  text-align: center;
  font-size: 0.8rem;
  color: #333;
`,xae=p.tr`
  &:hover {
    background: #f8f9fa;
  }
`,vae=p.div`
  text-align: center;
  padding: 2rem;
  color: #666;
`,_ae=p.div`
  display: flex;
  align-items: center;
  gap: 2rem;
  flex-wrap: wrap;
`,Qy=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,Jy=p.span`
  font-size: 0.75rem;
  font-weight: 600;
  color: #17a2b8;
  text-transform: uppercase;
`,S5=p.select`
  padding: 0.4rem 0.75rem;
  border: none;
  border-bottom: 1px solid #17a2b8;
  font-size: 0.85rem;
  background: transparent;
  color: #333;

  &:focus {
    outline: none;
    border-bottom-color: #138496;
  }
`,yae=p.input`
  padding: 0.4rem 0.5rem;
  border: none;
  border-bottom: 1px solid #17a2b8;
  font-size: 0.85rem;
  width: 80px;
  background: transparent;

  &:focus {
    outline: none;
    border-bottom-color: #138496;
  }
`,bae=p.span`
  font-size: 0.7rem;
  color: #666;
`,jae=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,C5=p.div`
  border: 1px solid #ddd;
  border-radius: 4px;
`,$5=p.div`
  padding: 0.5rem 0.75rem;
  background: #fafafa;
  border-bottom: 1px solid #ddd;
  font-size: 0.75rem;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
`,E5=p.div`
  padding: 0;
`,T5=p.textarea`
  width: 100%;
  min-height: 80px;
  padding: 0.75rem;
  border: none;
  font-size: 0.85rem;
  resize: vertical;

  &:focus {
    outline: none;
  }
`,A5=p.div`
  color: #dc3545;
  font-size: 0.85rem;
  margin-top: 1rem;
`,F5=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,D5=p.div`
  padding: 1rem;
  border-radius: 4px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,P5=p.button`
  width: 26px;
  height: 26px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  background: ${e=>e.$color||"#6c757d"};
  color: white;
  margin: 0 2px;

  &:hover {
    opacity: 0.85;
  }
`,wae=p.div`
  margin-top: 2rem;
  border-top: 2px solid #28a745;
  padding-top: 1rem;
`,kae=p.h1`
  font-size: 1.3rem;
  font-weight: 500;
  color: #333;
  margin-bottom: 1.5rem;
`,Hm=p.div`
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 1rem;
`,Wm=p.div`
  padding: 0.5rem 1rem;
  background: #28a745;
  color: white;
  font-size: 0.9rem;
  font-weight: 500;
`,Gm=p.div`
  padding: 0;
`,qm=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;

  th, td {
    border: 1px solid #dee2e6;
    padding: 0.4rem 0.5rem;
    text-align: left;
  }

  th {
    background: #f8f9fa;
    font-weight: 600;
    color: #495057;
    white-space: nowrap;
  }

  td {
    vertical-align: middle;
  }

  tbody tr:hover {
    background: #f1f3f5;
  }
`,Sae=p.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 2rem;
`,Cae=p.button`
  padding: 0.75rem 1.5rem;
  font-size: 1rem;
  font-weight: 500;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;

  &:hover {
    background: #218838;
  }

  &:disabled {
    background: #6c757d;
    cursor: not-allowed;
  }
`,$ae=[{id:1,codigo:"USD",nombre:"Dolar"},{id:2,codigo:"CLP",nombre:"Peso Chileno"}];function Km({cotizacionId:e,onNavigate:t,isExterno:r=!1}){const n=!!e,i=r?"cotizador-externo":"cotizaciones",[s,o]=C.useState({cliente_id:null,instalacion_id:null,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",clasificacion_id:null,moneda_id:1,dias_pago:0,comision:2,observacion_interna:"",observacion_cliente:"",detalles:[],detallesData:[]}),[l,c]=C.useState(!0),[u,h]=C.useState(!1),[f,m]=C.useState(null),[_,g]=C.useState(null),[v,y]=C.useState(null),[b,x]=C.useState(!1),[j]=C.useState(!1),[S]=C.useState(!1),[T,F]=C.useState(!1),[w,P]=C.useState(null),[M,A]=C.useState(!1),{data:D,isLoading:H}=Nt({queryKey:["clients-for-cotizacion"],queryFn:async()=>(await gd.list({page_size:2e3,activo:!0})).items,staleTime:5*60*1e3}),U=C.useMemo(()=>[...D||[]].sort((se,we)=>{const V=se.codigo?parseInt(se.codigo,10):1/0,Ce=we.codigo?parseInt(we.codigo,10):1/0;return isNaN(V)&&isNaN(Ce)?0:isNaN(V)?1:isNaN(Ce)?-1:V-Ce}),[D]),{data:W,isLoading:R}=Nt({queryKey:["instalaciones-cotiza",s.cliente_id],queryFn:async()=>s.cliente_id?s1.getInstalacionesClienteCotiza(s.cliente_id):{instalaciones:[],clasificacion_id:null},enabled:!!s.cliente_id}),ae=(W==null?void 0:W.instalaciones)||[],{data:le,isLoading:G}=Nt({queryKey:["contactos",s.cliente_id,s.instalacion_id],queryFn:async()=>s.cliente_id?s1.getContactosCliente(s.cliente_id,s.instalacion_id||void 0):[],enabled:!!s.cliente_id}),z=le||[];C.useEffect(()=>{e&&console.log("Loading cotizacion:",e)},[e]),C.useEffect(()=>{W!=null&&W.clasificacion_id&&!s.clasificacion_id&&o(B=>({...B,clasificacion_id:W.clasificacion_id||null}))},[W,s.clasificacion_id]),C.useEffect(()=>{if(!n||!e)return;(async()=>{try{const se=await Xn.get(e);console.log("Loaded cotizacion:",se);const we=(se.detalles||[]).map((V,Ce)=>({id:V.id,numero:Ce+1,descripcion:V.descripcion_material_detalle||`Detalle ${Ce+1}`,cad_id:V.cad_material_id||null,cad_nombre:V.cad_material_detalle||"-",tipo_producto_id:V.tipo_detalle_id,tipo_producto_nombre:V.tipo_detalle_id===1?"Corrugado":"Esquinero",cantidad:V.cantidad||0,area:V.area_hc?parseFloat(String(V.area_hc)):0,carton_id:V.carton_id||null,carton_nombre:V.carton_codigo||(V.carton_id?`Carton ${V.carton_id}`:"-"),item:"-",proceso_id:V.process_id||null,proceso_nombre:V.proceso_nombre||"-",colores:V.numero_colores||0,pct_impresion:Number(V.impresion)||0,pct_cobertura:0,matriz:V.matriz?"Si":"-",clisse:V.clisse?"Si":"-",royalty:V.royalty||0,maquila:V.maquila||0,armado:V.armado_automatico?"Auto":"-",ot_id:V.work_order_id||null,muestra:!1}));o(V=>({...V,cliente_id:se.client_id,nombre_contacto:se.nombre_contacto||"",email_contacto:se.email_contacto||"",telefono_contacto:se.telefono_contacto||"",moneda_id:se.moneda_id||1,dias_pago:se.dias_pago||0,comision:se.comision||2,observacion_interna:se.observacion_interna||"",observacion_cliente:se.observacion_cliente||"",detalles:we,detallesData:se.detalles||[]}))}catch(se){console.error("Error loading cotizacion:",se),y("Error al cargar la cotizacin")}})()},[n,e]);const ie=C.useCallback(B=>{o(se=>({...se,cliente_id:B,instalacion_id:null,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:"",clasificacion_id:null}))},[]),ne=C.useCallback(B=>{o(se=>({...se,instalacion_id:B,contacto_id:null,nombre_contacto:"",email_contacto:"",telefono_contacto:""}))},[]),O=C.useCallback(B=>{const se=z.find(we=>we.id===B);o(we=>({...we,contacto_id:B,nombre_contacto:(se==null?void 0:se.nombre)||we.nombre_contacto,email_contacto:(se==null?void 0:se.email)||"",telefono_contacto:(se==null?void 0:se.telefono)||""}))},[z]),N=C.useCallback((B,se)=>{o(we=>({...we,[B]:se}))},[]),L=C.useCallback(()=>{m(null),h(!0)},[]),K=C.useCallback(B=>{m(B),h(!0)},[]),re=C.useCallback(B=>{window.confirm("Est seguro de eliminar este detalle?")&&o(se=>({...se,detalles:se.detalles.filter((we,V)=>V!==B),detallesData:se.detallesData.filter((we,V)=>V!==B)}))},[]),Z=C.useCallback(B=>{const se={numero:s.detalles.length+1,descripcion:B.descripcion||`Detalle ${s.detalles.length+1}`,cad_id:B.cad_id,cad_nombre:B.cad_id?`CAD-${B.cad_id}`:"-",tipo_producto_id:B.tipo_detalle_id,tipo_producto_nombre:B.tipo_detalle_id===1?"Corrugado":"Esquinero",cantidad:B.cantidad||0,area:B.area_hc||0,carton_id:B.carton_id,carton_nombre:B.carton_id?`Carton ${B.carton_id}`:"-",item:"-",proceso_id:B.process_id,proceso_nombre:B.process_id?`Proceso ${B.process_id}`:"-",colores:B.colores||0,pct_impresion:B.pct_impresion||0,pct_cobertura:B.pct_cobertura||0,matriz:"-",clisse:"-",royalty:0,maquila:0,armado:"-",ot_id:null,muestra:!1};o(we=>{if(f){const V=we.detalles.findIndex(Ce=>Ce.numero===f.numero);if(V>=0){const Ce=[...we.detalles];Ce[V]={...se,numero:f.numero};const qe=[...we.detallesData];return qe[V]=B,{...we,detalles:Ce,detallesData:qe}}}return{...we,detalles:[...we.detalles,se],detallesData:[...we.detallesData,B]}}),h(!1),m(null)},[s.detalles.length,f]),me=C.useCallback(async()=>{if(!s.cliente_id){y("Debe seleccionar un cliente");return}const B=mo.getStoredUser();if(!B){y("No hay usuario autenticado");return}x(!0),y(null);try{const se={client_id:s.cliente_id,nombre_contacto:s.nombre_contacto||void 0,email_contacto:s.email_contacto||void 0,telefono_contacto:s.telefono_contacto||void 0,moneda_id:s.moneda_id||void 0,dias_pago:s.dias_pago||void 0,comision:s.comision||void 0,observacion_interna:s.observacion_interna||void 0,observacion_cliente:s.observacion_cliente||void 0,user_id:B.id};console.log("Saving cotizacion:",se);let we;if(n&&e)await Xn.update(e,se),we=e,g("Cotizacin actualizada correctamente");else{const V=await Xn.create(se);if(we=V.id,console.log("Cotizacion created:",V),s.detallesData.length>0){console.log(`Saving ${s.detallesData.length} detalles...`);let Ce=0;const qe=[];for(const Te of s.detallesData)try{const E={tipo_detalle_id:Te.tipo_detalle_id||1,cantidad:Te.cantidad||1,product_type_id:Te.product_type_id||1,planta_id:Te.planta_id||1,variable_cotizador_id:Te.variable_cotizador_id||1,numero_colores:Te.numero_colores,largo:Te.largo,ancho:Te.ancho,alto:Te.alto,area_hc:Te.area_hc,anchura:Te.anchura,largura:Te.largura,carton_id:Te.carton_id,impresion:Te.impresion,golpes_largo:Te.golpes_largo,golpes_ancho:Te.golpes_ancho,process_id:Te.process_id,rubro_id:Te.rubro_id,printing_machine_id:Te.printing_machine_id,print_type_id:Te.print_type_id,ink_type_id:Te.ink_type_id,barniz_type_id:Te.barniz_type_id,pegado_id:Te.pegado_id,cinta_desgarro:Te.cinta_desgarro,matriz:Te.matriz,clisse:Te.clisse,royalty:Te.royalty,maquila:Te.maquila,maquila_servicio_id:Te.maquila_servicio_id,armado_automatico:Te.armado_automatico,armado_usd_caja:Te.armado_usd_caja,pallet:Te.pallet,pallet_height_id:Te.pallet_height_id,zuncho:Te.zuncho,funda:Te.funda,stretch_film:Te.stretch_film,ciudad_id:Te.ciudad_id,margen:Te.margen,descripcion_material_detalle:Te.descripcion_material_detalle,cad_material_id:Te.cad_material_id,largo_esquinero:Te.largo_esquinero,carton_esquinero_id:Te.carton_esquinero_id};await Xn.createDetalle(we,E),Ce++}catch(E){console.error("Error saving detalle:",E),qe.push(`Error en detalle ${Ce+1}`)}qe.length>0?g(`Pre-Cotizacin generada. ${Ce}/${s.detallesData.length} detalles guardados.`):g(`Pre-Cotizacin generada con ${Ce} detalle(s)`)}else g("Pre-Cotizacin generada correctamente")}A(!0);try{const V=await Xn.getCostosResumen(we);P(V),F(!0)}catch(V){console.error("Error fetching cost summary:",V)}finally{A(!1)}}catch(se){console.error("Error saving cotizacion:",se),y("Error al guardar la cotizacin")}finally{x(!1)}},[s,n,e,t,i]);return u?a.jsx(rae,{detalle:null,plantaId:1,onSubmit:Z,onCancel:()=>{h(!1),m(null)}}):a.jsxs(nae,{children:[a.jsxs(aae,{children:[a.jsxs(iae,{children:[a.jsx(sae,{onClick:()=>t(i),children:"< Volver"}),a.jsx(oae,{children:n?`Editar Cotizacin #${e}`:"Ingreso Cotizacin"})]}),a.jsxs(lae,{children:[a.jsxs(Um,{children:[a.jsx("span",{children:"Seleccionar Cliente"}),a.jsx(Vm,{children:"1"})]}),a.jsxs(Um,{children:[a.jsx("span",{children:"Agregar Detalles"}),a.jsx(Vm,{children:"2"})]}),a.jsxs(Um,{children:[a.jsx("span",{children:"Completar Cotizacin"}),a.jsx(Vm,{children:"3"})]}),a.jsxs(Um,{children:[a.jsx("span",{children:"Guardar Cotizacin"}),a.jsx(Vm,{children:"4"})]})]})]}),_&&a.jsx(D5,{$type:"success",children:_}),v&&a.jsx(D5,{$type:"error",children:v}),a.jsxs(Gy,{children:[a.jsx(k5,{children:a.jsx(qy,{children:"Datos Comerciales"})}),a.jsxs(Ky,{children:[a.jsxs(cae,{children:[a.jsxs(ic,{children:[a.jsx(sc,{children:"Cliente"}),a.jsx(zP,{options:U,value:s.cliente_id,onChange:B=>ie(B),getOptionValue:B=>B.id,getOptionLabel:B=>`${B.nombre_sap}${B.codigo?` - ${B.codigo}`:""}`,placeholder:"Seleccionar...",disabled:H,loading:H})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Instalacin"}),a.jsxs(Xy,{value:s.instalacion_id||"",onChange:B=>ne(B.target.value?Number(B.target.value):null),disabled:!s.cliente_id||R,children:[a.jsx("option",{value:"",children:R?"Cargando...":"-"}),ae.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))]})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Contactos"}),a.jsxs(Xy,{value:s.contacto_id||"",onChange:B=>O(B.target.value?Number(B.target.value):null),disabled:!s.cliente_id||G,children:[a.jsx("option",{value:"",children:G?"Cargando...":"-"}),z.map(B=>a.jsx("option",{value:B.id,children:B.nombre},B.id))]})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Nombre:"}),a.jsxs(uae,{children:[a.jsx(hae,{type:"checkbox",checked:l,onChange:B=>c(B.target.checked)}),a.jsx(Yy,{value:s.nombre_contacto,onChange:B=>N("nombre_contacto",B.target.value),disabled:!l,placeholder:"Nombre contacto"}),a.jsx(fae,{title:"Puede ingresar nombre personalizado",children:"?"})]})]})]}),a.jsxs(dae,{children:[a.jsxs(ic,{children:[a.jsx(sc,{children:"Email:"}),a.jsx(Yy,{value:s.email_contacto,onChange:B=>N("email_contacto",B.target.value),disabled:!0})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Telfono:"}),a.jsx(Yy,{value:s.telefono_contacto,onChange:B=>N("telefono_contacto",B.target.value),disabled:!0})]}),a.jsxs(ic,{children:[a.jsx(sc,{children:"Clasificacin"}),a.jsxs(Xy,{value:s.clasificacion_id||"",onChange:B=>N("clasificacion_id",B.target.value?Number(B.target.value):null),disabled:!!s.cliente_id,children:[a.jsx("option",{value:"",children:"-"}),(W==null?void 0:W.clasificacion_id)&&a.jsx("option",{value:W.clasificacion_id,children:W.clasificacion_nombre||"Sin clasificacin"})]})]})]})]})]}),a.jsxs(Gy,{children:[a.jsxs(pae,{children:[a.jsx(qy,{children:"Detalles"}),a.jsxs(mae,{children:[a.jsx(Wh,{$variant:"outline",children:"Carga Masiva"}),a.jsx(Wh,{$variant:"success",onClick:L,children:"Crear Detalle +"})]})]}),a.jsx(Ky,{style:{padding:0},children:s.detalles.length===0?a.jsxs(vae,{children:[a.jsx("p",{children:"No hay detalles agregados"}),a.jsx("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:'Haga clic en "Crear Detalle +" para agregar items'})]}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs(gae,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Cr,{children:"N"}),a.jsx(Cr,{children:"Descrip."}),a.jsx(Cr,{children:"CAD"}),a.jsx(Cr,{children:"Tipo Producto"}),a.jsx(Cr,{children:"Cantidad"}),a.jsx(Cr,{children:"rea"}),a.jsx(Cr,{children:"Cartn"}),a.jsx(Cr,{children:"Item"}),a.jsx(Cr,{children:"Proceso"}),a.jsx(Cr,{children:"Colores"}),a.jsx(Cr,{children:"% Impr."}),a.jsx(Cr,{children:"%Cob."}),a.jsx(Cr,{children:"Matriz"}),a.jsx(Cr,{children:"Clisse"}),a.jsx(Cr,{children:"Royalty"}),a.jsx(Cr,{children:"Maquila"}),a.jsx(Cr,{children:"Armado"}),a.jsx(Cr,{children:"OT"}),a.jsx(Cr,{}),a.jsx(Cr,{children:"Acciones"})]})}),a.jsx("tbody",{children:s.detalles.map((B,se)=>a.jsxs(xae,{children:[a.jsx($r,{children:B.numero}),a.jsx($r,{children:B.descripcion}),a.jsx($r,{children:B.cad_nombre}),a.jsx($r,{children:B.tipo_producto_nombre}),a.jsx($r,{children:B.cantidad.toLocaleString()}),a.jsx($r,{children:B.area.toFixed(2)}),a.jsx($r,{children:B.carton_nombre}),a.jsx($r,{children:B.item}),a.jsx($r,{children:B.proceso_nombre}),a.jsx($r,{children:B.colores}),a.jsxs($r,{children:[B.pct_impresion,"%"]}),a.jsxs($r,{children:[B.pct_cobertura,"%"]}),a.jsx($r,{children:B.matriz}),a.jsx($r,{children:B.clisse}),a.jsx($r,{children:B.royalty}),a.jsx($r,{children:B.maquila}),a.jsx($r,{children:B.armado}),a.jsx($r,{children:B.ot_id||"-"}),a.jsx($r,{children:B.muestra?"":""}),a.jsxs($r,{children:[a.jsx(P5,{$color:"#ffc107",onClick:()=>K(B),title:"Editar",children:""}),a.jsx(P5,{$color:"#dc3545",onClick:()=>re(se),title:"Eliminar",children:""})]})]},se))})]})})})]}),a.jsxs(Gy,{children:[a.jsx(k5,{children:a.jsx(qy,{children:"Moneda - Das Pago - % Comisin"})}),a.jsx(Ky,{children:a.jsxs(_ae,{children:[a.jsxs(Qy,{children:[a.jsx(Jy,{children:"Moneda"}),a.jsx(S5,{value:s.moneda_id,onChange:B=>N("moneda_id",Number(B.target.value)),children:$ae.map(B=>a.jsx("option",{value:B.id,children:B.codigo},B.id))})]}),a.jsxs(Qy,{children:[a.jsx(Jy,{children:"Das Pago"}),a.jsxs(S5,{value:s.dias_pago,onChange:B=>N("dias_pago",Number(B.target.value)),children:[a.jsx("option",{value:"0",children:"0"}),a.jsx("option",{value:"30",children:"30"}),a.jsx("option",{value:"60",children:"60"}),a.jsx("option",{value:"90",children:"90"})]})]}),a.jsxs(Qy,{children:[a.jsx(Jy,{children:"Comisin %:"}),a.jsx(yae,{type:"number",value:s.comision,onChange:B=>N("comision",Number(B.target.value))}),a.jsx(bae,{children:"*Solo para Exportacion"})]})]})})]}),a.jsxs(jae,{children:[a.jsxs(C5,{children:[a.jsx($5,{children:"Observacin Interna"}),a.jsx(E5,{children:a.jsx(T5,{value:s.observacion_interna,onChange:B=>N("observacion_interna",B.target.value),placeholder:"Observaciones internas..."})})]}),a.jsxs(C5,{children:[a.jsx($5,{children:"Observacin Cliente"}),a.jsx(E5,{children:a.jsx(T5,{value:s.observacion_cliente,onChange:B=>N("observacion_cliente",B.target.value),placeholder:"Observaciones para el cliente..."})})]})]}),(j||S)&&a.jsxs(a.Fragment,{children:[j&&a.jsx(A5,{children:"Recuerde que esta cotizacion contiene un rea Hoja Corrugada estimada, favor validar este dato con desarrollo"}),S&&a.jsx(A5,{children:"Recuerde que esta cotizacion contiene un Cartn estimado, favor validar este dato con desarrollo"})]}),!T&&a.jsxs(F5,{children:[a.jsx(Wh,{onClick:()=>t(i),children:"Cancelar"}),a.jsx(Wh,{$variant:"success",onClick:me,disabled:b||M,children:b?"Guardando...":M?"Cargando...":"Generar Pre-Cotizacin"})]}),T&&w&&a.jsxs(wae,{children:[a.jsx(kae,{children:"Resumen de Costos por producto"}),a.jsxs(Hm,{children:[a.jsx(Wm,{children:"Parametros Por Producto"}),a.jsxs(Gm,{children:[a.jsxs(qm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Planta"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Flete"}),a.jsx("th",{children:"Margen Papeles (USD/Mm2)"}),a.jsx("th",{children:"Margen (USD/Mm2)"}),a.jsx("th",{children:"Margen MNIMO (USD/Mm2)"}),a.jsx("th",{children:"Precio (USD/Mm2)"}),a.jsx("th",{children:"Precio (USD/Ton)"}),a.jsx("th",{children:"Precio (USD/UN)"}),a.jsx("th",{children:"Precio ($/UN)"}),a.jsx("th",{children:"Cantidad"}),a.jsx("th",{children:"Precio Total (MUSD)"})]})}),a.jsx("tbody",{children:w.parametros_producto.length>0?w.parametros_producto.map(B=>a.jsxs("tr",{children:[a.jsx("td",{children:B.numero}),a.jsx("td",{children:B.descripcion}),a.jsx("td",{children:B.cad}),a.jsx("td",{children:B.planta}),a.jsx("td",{children:B.tipo_producto}),a.jsx("td",{children:B.item}),a.jsx("td",{children:B.carton}),a.jsx("td",{children:B.flete}),a.jsx("td",{children:typeof B.margen_papeles=="number"?B.margen_papeles.toFixed(2):B.margen_papeles}),a.jsx("td",{children:typeof B.margen=="number"?B.margen.toFixed(2):B.margen}),a.jsx("td",{children:typeof B.margen_minimo=="number"?B.margen_minimo.toFixed(2):B.margen_minimo}),a.jsx("td",{children:typeof B.precio_usd_mm2=="number"?B.precio_usd_mm2.toFixed(2):B.precio_usd_mm2}),a.jsx("td",{children:typeof B.precio_usd_ton=="number"?B.precio_usd_ton.toFixed(2):B.precio_usd_ton}),a.jsx("td",{children:typeof B.precio_usd_un=="number"?B.precio_usd_un.toFixed(3):B.precio_usd_un}),a.jsx("td",{children:typeof B.precio_clp_un=="number"?B.precio_clp_un.toFixed(2):B.precio_clp_un}),a.jsx("td",{children:B.cantidad}),a.jsx("td",{children:typeof B.precio_total_musd=="number"?B.precio_total_musd.toFixed(3):B.precio_total_musd})]},B.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:17,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]}),a.jsx("span",{style:{color:"#025902",fontSize:"0.75rem",marginLeft:"0.5rem"},children:"* En verde: Promedios ponderados por columna"})]})]}),a.jsxs(Hm,{children:[a.jsx(Wm,{children:"Nuevos Detalles Cotizacion"}),a.jsx(Gm,{children:a.jsxs(qm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"MC (USD/Mm2)"}),a.jsx("th",{children:"Margen bruto sin flete (USD/Mm2)"}),a.jsx("th",{children:"Margen de servir (USD/Mm2)"}),a.jsx("th",{children:"Mg EBITDA (%)"})]})}),a.jsx("tbody",{children:w.nuevos_detalles.length>0?w.nuevos_detalles.map(B=>a.jsxs("tr",{children:[a.jsx("td",{children:B.numero}),a.jsx("td",{children:B.descripcion}),a.jsx("td",{children:B.cad}),a.jsx("td",{children:B.tipo_producto}),a.jsx("td",{children:B.item}),a.jsx("td",{children:B.carton}),a.jsx("td",{children:typeof B.mc_usd_mm2=="number"?B.mc_usd_mm2.toFixed(2):B.mc_usd_mm2}),a.jsx("td",{children:typeof B.margen_bruto_sin_flete=="number"?B.margen_bruto_sin_flete.toFixed(2):B.margen_bruto_sin_flete}),a.jsx("td",{children:typeof B.margen_servir=="number"?B.margen_servir.toFixed(2):B.margen_servir}),a.jsx("td",{children:typeof B.mg_ebitda=="number"?B.mg_ebitda.toFixed(2):B.mg_ebitda})]},B.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:10,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsxs(Hm,{children:[a.jsx(Wm,{children:"Costos Productos (USD/MM2)"}),a.jsx(Gm,{children:a.jsxs(qm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Costo Directo"}),a.jsx("th",{children:"Costo Indirecto"}),a.jsx("th",{children:"GVV"}),a.jsx("th",{children:"Costo Fijo"}),a.jsx("th",{children:"Costo Total"})]})}),a.jsx("tbody",{children:w.costos_productos.length>0?w.costos_productos.map(B=>a.jsxs("tr",{children:[a.jsx("td",{children:B.numero}),a.jsx("td",{children:B.descripcion}),a.jsx("td",{children:B.cad}),a.jsx("td",{children:B.tipo_producto}),a.jsx("td",{children:B.item}),a.jsx("td",{children:B.carton}),a.jsx("td",{children:typeof B.costo_directo=="number"?B.costo_directo.toFixed(2):B.costo_directo}),a.jsx("td",{children:typeof B.costo_indirecto=="number"?B.costo_indirecto.toFixed(2):B.costo_indirecto}),a.jsx("td",{children:typeof B.gvv=="number"?B.gvv.toFixed(2):B.gvv}),a.jsx("td",{children:typeof B.costo_fijo=="number"?B.costo_fijo.toFixed(2):B.costo_fijo}),a.jsx("td",{children:typeof B.costo_total=="number"?B.costo_total.toFixed(2):B.costo_total})]},B.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:11,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsxs(Hm,{children:[a.jsx(Wm,{children:"Costos Servicios (USD/MM2)"}),a.jsx(Gm,{children:a.jsxs(qm,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:"N"}),a.jsx("th",{children:"Descripcin"}),a.jsx("th",{children:"CAD"}),a.jsx("th",{children:"Tipo Producto"}),a.jsx("th",{children:"Item"}),a.jsx("th",{children:"Cartn"}),a.jsx("th",{children:"Maquila"}),a.jsx("th",{children:"Armado"}),a.jsx("th",{children:"Clisses"}),a.jsx("th",{children:"Matriz"}),a.jsx("th",{children:"Mano de Obra"}),a.jsx("th",{children:"Flete"})]})}),a.jsx("tbody",{children:w.costos_servicios.length>0?w.costos_servicios.map(B=>a.jsxs("tr",{children:[a.jsx("td",{children:B.numero}),a.jsx("td",{children:B.descripcion}),a.jsx("td",{children:B.cad}),a.jsx("td",{children:B.tipo_producto}),a.jsx("td",{children:B.item}),a.jsx("td",{children:B.carton}),a.jsx("td",{children:typeof B.maquila=="number"?B.maquila.toFixed(2):B.maquila}),a.jsx("td",{children:typeof B.armado=="number"?B.armado.toFixed(2):B.armado}),a.jsx("td",{children:typeof B.clisses=="number"?B.clisses.toFixed(2):B.clisses}),a.jsx("td",{children:typeof B.matriz=="number"?B.matriz.toFixed(2):B.matriz}),a.jsx("td",{children:typeof B.mano_obra=="number"?B.mano_obra.toFixed(2):B.mano_obra}),a.jsx("td",{children:typeof B.flete=="number"?B.flete.toFixed(2):B.flete})]},B.numero)):a.jsx("tr",{children:a.jsx("td",{colSpan:12,style:{textAlign:"center",color:"#666"},children:"Sin datos de costos calculados"})})})]})})]}),a.jsx(Sae,{children:a.jsx(Cae,{onClick:()=>{alert("Funcionalidad de Solicitar Aprobacin prximamente")},children:"Solicitar Aprobacin"})}),a.jsx(F5,{children:a.jsx(Wh,{onClick:()=>t(i),children:"Volver al listado"})})]})]})}const M5="/api/v1",O5=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,R5=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,N5=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,z5=p.div`
  display: flex;
  gap: 0.75rem;
`,oc=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          border-color: ${d.colors.danger};
          &:hover { background: #c82333; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Eae=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Tae=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  align-items: end;
`,Xm=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ym=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,Aae=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Fae=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Dae=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Pae=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,Vs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Hs=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,Mae=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,I5=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: ${d.colors.warning}15;
          color: ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Zy=p.button`
  padding: 0.35rem 0.65rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"approve":return`
          background: ${d.colors.success};
          color: white;
          &:hover { background: #218838; }
        `;case"reject":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { background: #c82333; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Oae=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Rae=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Nae=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,zae=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,L5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Iae=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,Lae=p.div`
  margin-bottom: 1rem;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,B5=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,Bae=p.span`
  display: block;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Uae=p.span`
  font-family: 'Consolas', monospace;
  font-weight: 500;
`,Vae=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,Hae=p.div`
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
`,Wae=p.h2`
  font-size: 1.25rem;
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,Gae=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 1.5rem;
`,qae=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`;function Kae({onNavigate:e}){const[t,r]=C.useState([]),[n,i]=C.useState(1),[s,o]=C.useState(""),[l,c]=C.useState(""),[u,h]=C.useState(null),[f,m]=C.useState(null),[_,g]=C.useState(!0),[v,y]=C.useState(1),[b,x]=C.useState(0),[j,S]=C.useState(!1),[T,F]=C.useState("aprobar"),[w,P]=C.useState(null),[M,A]=C.useState(""),[D,H]=C.useState(!1),U=C.useCallback(async()=>{g(!0);try{const N=new URLSearchParams;N.append("page",n.toString()),N.append("page_size","20"),N.append("estado_id","2"),l&&N.append("user_id",l),s&&N.append("cotizacion_id",s);const L=await fetch(`${M5}/cotizaciones/?${N.toString()}`);if(!L.ok)throw new Error("Error al cargar cotizaciones");const K=await L.json();r(K.items||[]),x(K.total||0),y(K.total_pages||1)}catch(N){console.error("Error fetching cotizaciones:",N),m("Error al cargar las cotizaciones pendientes"),r([{id:1,client_id:1,cliente_nombre:"Vina Concha y Toro S.A.",usuario_nombre:"Juan Perez",user_id:1,estado_id:2,nivel_aprobacion:1,role_can_show:3,version_number:1,total_detalles:3,monto_total_usd:12500,created_at:"2024-01-15T10:30:00",updated_at:"2024-01-15T10:30:00"},{id:2,client_id:2,cliente_nombre:"Frutas del Sur Ltda.",usuario_nombre:"Maria Garcia",user_id:2,estado_id:2,nivel_aprobacion:2,role_can_show:15,version_number:1,total_detalles:2,monto_total_usd:8750.5,created_at:"2024-01-14T14:20:00",updated_at:"2024-01-14T14:20:00"}]),x(2),y(1)}finally{g(!1)}},[n,s,l]);C.useEffect(()=>{U()},[U]);const W=C.useCallback(N=>{N.preventDefault(),i(1),U()},[U]),R=C.useCallback(()=>{o(""),c(""),i(1)},[]),ae=C.useCallback(N=>{e("cotizacion-editar",N)},[e]),le=C.useCallback((N,L)=>{P(N),F(L),A(""),S(!0)},[]),G=C.useCallback(()=>{S(!1),P(null),A(""),H(!1)},[]),z=C.useCallback(async()=>{if(w){H(!0);try{if(!(await fetch(`${M5}/cotizaciones/${w.id}/gestionar-aprobacion`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:T,motivo:M})})).ok)throw new Error("Error al procesar la aprobacion");const L=T==="aprobar"?"aprobada":"rechazada";h(`Cotizacion #${w.id} ${L} correctamente`),G(),U(),setTimeout(()=>h(null),4e3)}catch(N){console.error("Error:",N),m("Error al procesar la aprobacion"),setTimeout(()=>m(null),4e3)}finally{H(!1)}}},[w,T,M,G,U]),ie=N=>`$${N.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,ne=N=>{try{return new Date(N).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return N}},O=N=>{switch(N){case 1:return"Jefe Ventas";case 2:return"Gerente Comercial";case 3:return"Gerente General";default:return`Nivel ${N}`}};return _?a.jsxs(O5,{children:[a.jsxs(R5,{children:[a.jsx(N5,{children:"Aprobaciones"}),a.jsx(z5,{children:a.jsx(oc,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})})]}),a.jsxs(Rae,{children:[a.jsx(Nae,{}),a.jsx("span",{children:"Cargando cotizaciones pendientes..."})]})]}):a.jsxs(O5,{children:[a.jsxs(R5,{children:[a.jsx(N5,{children:"Cotizaciones por Aprobar"}),a.jsxs(z5,{children:[a.jsx(oc,{onClick:()=>U(),children:"Actualizar"}),a.jsx(oc,{onClick:()=>e("cotizaciones"),children:"Ir a Cotizaciones"})]})]}),u&&a.jsx(B5,{$type:"success",children:u}),f&&a.jsx(B5,{$type:"error",children:f}),a.jsx(Eae,{children:a.jsx("form",{onSubmit:W,children:a.jsxs(Tae,{children:[a.jsxs(Xm,{children:[a.jsx(Ym,{children:"N Cotizacion"}),a.jsx(Aae,{type:"text",placeholder:"ID de cotizacion...",value:s,onChange:N=>o(N.target.value)})]}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:"Creador"}),a.jsxs(Fae,{value:l,onChange:N=>c(N.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"1",children:"Juan Perez"}),a.jsx("option",{value:"2",children:"Maria Garcia"})]})]}),a.jsxs(Xm,{children:[a.jsx(Ym,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(oc,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(oc,{type:"button",onClick:R,children:"Limpiar"})]})]})]})})}),a.jsx(Lae,{children:b===0?"No hay cotizaciones pendientes de aprobacion":`${b} cotizacion${b!==1?"es":""} pendiente${b!==1?"s":""} de aprobacion`}),a.jsx(Dae,{children:t.length===0?a.jsxs(Oae,{children:[a.jsx("p",{children:"No hay cotizaciones pendientes de aprobacion"}),a.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"Las cotizaciones aparecen aqui cuando un vendedor solicita su aprobacion."})]}):a.jsxs(a.Fragment,{children:[a.jsxs(Pae,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Vs,{children:"Cotizacion N"}),a.jsx(Vs,{children:"Fecha Creacion"}),a.jsx(Vs,{children:"Creador"}),a.jsx(Vs,{children:"Cliente"}),a.jsx(Vs,{children:"N Productos"}),a.jsx(Vs,{children:"Monto Total (USD)"}),a.jsx(Vs,{children:"Version"}),a.jsx(Vs,{children:"Nivel"}),a.jsx(Vs,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(N=>a.jsxs(Mae,{children:[a.jsx(Hs,{children:a.jsx("strong",{children:N.id})}),a.jsx(Hs,{children:ne(N.created_at)}),a.jsx(Hs,{children:N.usuario_nombre||"-"}),a.jsx(Hs,{children:a.jsx(Bae,{title:N.cliente_nombre,children:N.cliente_nombre||"-"})}),a.jsx(Hs,{children:a.jsx(I5,{$type:"info",children:N.total_detalles})}),a.jsx(Hs,{children:a.jsx(Uae,{children:N.monto_total_usd?ie(N.monto_total_usd):"-"})}),a.jsx(Hs,{children:N.version_number||1}),a.jsx(Hs,{children:a.jsx(I5,{$type:"warning",children:O(N.nivel_aprobacion)})}),a.jsxs(Hs,{children:[a.jsx(Zy,{$variant:"view",onClick:()=>ae(N.id),title:"Ver detalle",children:"Ver"}),a.jsx(Zy,{$variant:"approve",onClick:()=>le(N,"aprobar"),title:"Aprobar",children:"Aprobar"}),a.jsx(Zy,{$variant:"reject",onClick:()=>le(N,"rechazar"),title:"Rechazar",children:"Rechazar"})]})]},N.id))})]}),v>1&&a.jsxs(zae,{children:[a.jsx(L5,{disabled:n===1,onClick:()=>i(N=>N-1),children:"Anterior"}),a.jsxs(Iae,{children:["Pagina ",n," de ",v]}),a.jsx(L5,{disabled:n===v,onClick:()=>i(N=>N+1),children:"Siguiente"})]})]})}),j&&w&&a.jsx(Vae,{onClick:G,children:a.jsxs(Hae,{onClick:N=>N.stopPropagation(),children:[a.jsxs(Wae,{children:[T==="aprobar"?"Aprobar":"Rechazar"," Cotizacion #",w.id]}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",w.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Creador:"})," ",w.usuario_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Productos:"})," ",w.total_detalles]})]}),a.jsxs(Xm,{children:[a.jsxs(Ym,{children:["Observacion ",T==="rechazar"&&"(Requerido)"]}),a.jsx(qae,{value:M,onChange:N=>A(N.target.value),placeholder:T==="aprobar"?"Ingrese una observacion opcional...":"Ingrese el motivo del rechazo...",required:T==="rechazar"})]}),a.jsxs(Gae,{children:[a.jsx(oc,{onClick:G,disabled:D,children:"Cancelar"}),a.jsx(oc,{$variant:T==="aprobar"?"success":"danger",onClick:z,disabled:D||T==="rechazar"&&!M.trim(),children:D?"Procesando...":T==="aprobar"?"Confirmar Aprobacion":"Confirmar Rechazo"})]})]})})]})}const Xae=p.div`
  padding: ${d.spacing.lg};
  max-width: 1400px;
  margin: 0 auto;
`,Yae=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,Qae=p.h1`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Jae=p.div`
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.sm};
  padding: ${d.spacing.lg};
  margin-bottom: ${d.spacing.lg};
`,Zae=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: ${d.spacing.md};
  align-items: end;
`,Gh=p.div`
  display: flex;
  flex-direction: column;
  gap: ${d.spacing.xs};
`,Qm=p.label`
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textSecondary};
`,eb=p.input`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,qh=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  font-weight: ${d.typography.weights.medium};
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: ${d.spacing.xs};

  ${({$variant:e="primary"})=>{switch(e){case"success":return`
          background: ${d.colors.success};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"danger":return`
          background: ${d.colors.danger};
          color: white;
          &:hover { opacity: 0.9; }
        `;case"secondary":return`
          background: ${d.colors.bgLight};
          color: ${d.colors.textPrimary};
          border: 1px solid ${d.colors.border};
          &:hover { background: ${d.colors.bgMedium}; }
        `;default:return`
          background: ${d.colors.primary};
          color: white;
          &:hover { opacity: 0.9; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,eie=p.table`
  width: 100%;
  border-collapse: collapse;
  background: ${d.colors.bgWhite};
  border-radius: ${d.radius.lg};
  overflow: hidden;
  box-shadow: ${d.shadows.sm};
`,ps=p.th`
  background: ${d.colors.primary};
  color: white;
  padding: ${d.spacing.md};
  text-align: left;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  white-space: nowrap;
`,ms=p.td`
  padding: ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  vertical-align: middle;
`,tie=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }
`,Jm=p.span`
  display: inline-block;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};

  ${({$variant:e="info"})=>{switch(e){case"success":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"danger":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.primary}20; color: ${d.colors.primary};`}}}
`,rie=p.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  padding: ${d.spacing.xs} ${d.spacing.sm};
  border-radius: ${d.radius.full};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.bold};

  ${({$dias:e})=>e<=2?`background: ${d.colors.success}; color: white;`:e<=5?`background: ${d.colors.warning}; color: white;`:`background: ${d.colors.danger}; color: white;`}
`,nie=p.div`
  display: flex;
  gap: ${d.spacing.xs};
`,Zm=p.button`
  width: 32px;
  height: 32px;
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;

  ${({$variant:e="view"})=>{switch(e){case"approve":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"reject":return`
          background: ${d.colors.danger}20;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;default:return`
          background: ${d.colors.primary}20;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}
`,U5=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,aie=p.div`
  text-align: center;
  padding: ${d.spacing.xxl};
  color: ${d.colors.textSecondary};
`,iie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,tb=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.md};
  background: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  cursor: pointer;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,sie=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,oie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  width: 100%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
`,V5=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg} 0;
`,H5=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.xl};
`,lie=p.textarea`
  width: 100%;
  padding: ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  resize: vertical;
  min-height: 100px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 3px ${d.colors.primary}20;
  }
`,cie=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
  font-size: ${d.typography.sizes.small};

  th, td {
    padding: ${d.spacing.sm};
    border: 1px solid ${d.colors.border};
    text-align: left;
  }

  th {
    background: ${d.colors.bgLight};
    font-weight: ${d.typography.weights.semibold};
  }
`,W5=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background: ${({$type:e})=>e==="success"?`${d.colors.success}15`:`${d.colors.danger}15`};
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
`;function die({onNavigate:e}){const[t,r]=C.useState([]),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),[u,h]=C.useState(1),[f,m]=C.useState(1),[_,g]=C.useState(0),[v,y]=C.useState({date_desde:"",date_hasta:"",cotizacion_id:""}),[b,x]=C.useState(!1),[j,S]=C.useState("aprobar"),[T,F]=C.useState(null),[w,P]=C.useState(""),[M,A]=C.useState(!1),[D,H]=C.useState([]),U=C.useCallback(async()=>{i(!0),o(null);try{const O={page:u,page_size:20};v.date_desde&&(O.date_desde=v.date_desde),v.date_hasta&&(O.date_hasta=v.date_hasta),v.cotizacion_id&&(O.cotizacion_id=parseInt(v.cotizacion_id));const N=await Xn.getPendientesAprobacionExterno(O);r(N.items||[]),g(N.total||0),m(N.total_pages||1)}catch(O){console.error("Error loading cotizaciones:",O),o("Error al cargar las cotizaciones pendientes")}finally{i(!1)}},[u,v]);C.useEffect(()=>{U()},[U]);const W=(O,N)=>{y(L=>({...L,[O]:N})),h(1)},R=()=>{h(1),U()},ae=()=>{y({date_desde:"",date_hasta:"",cotizacion_id:""}),h(1)},le=(O,N)=>{F(O),S(N),P(""),x(!0),N==="historial"&&z(O.id)},G=()=>{x(!1),F(null),P(""),H([])},z=async O=>{try{const N=await Xn.getHistorialAprobaciones(O);H(N.historial||[])}catch(N){console.error("Error loading historial:",N)}},ie=async()=>{if(T){A(!0),o(null);try{await Xn.gestionarAprobacionExterno(T.id,{action:j==="aprobar"?"aprobar":"rechazar",motivo:w||void 0}),c(`Cotizacin #${T.id} ${j==="aprobar"?"aprobada":"rechazada"} exitosamente`),G(),U(),setTimeout(()=>c(null),5e3)}catch(O){console.error("Error gestionando aprobacin:",O),o("Error al procesar la accin")}finally{A(!1)}}},ne=O=>O?new Date(O).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}):"-";return a.jsxs(Xae,{children:[a.jsxs(Yae,{children:[a.jsx(Qae,{children:"Aprobacin Externa de Cotizaciones"}),a.jsxs(Jm,{$variant:"info",children:[_," pendientes"]})]}),l&&a.jsx(W5,{$type:"success",children:l}),s&&a.jsx(W5,{$type:"error",children:s}),a.jsx(Jae,{children:a.jsxs(Zae,{children:[a.jsxs(Gh,{children:[a.jsx(Qm,{children:"Fecha Desde"}),a.jsx(eb,{type:"date",value:v.date_desde,onChange:O=>W("date_desde",O.target.value)})]}),a.jsxs(Gh,{children:[a.jsx(Qm,{children:"Fecha Hasta"}),a.jsx(eb,{type:"date",value:v.date_hasta,onChange:O=>W("date_hasta",O.target.value)})]}),a.jsxs(Gh,{children:[a.jsx(Qm,{children:"N Cotizacin"}),a.jsx(eb,{type:"number",placeholder:"ID",value:v.cotizacion_id,onChange:O=>W("cotizacion_id",O.target.value)})]}),a.jsxs(Gh,{style:{flexDirection:"row",alignItems:"flex-end",gap:d.spacing.sm},children:[a.jsx(qh,{onClick:R,children:"Filtrar"}),a.jsx(qh,{$variant:"secondary",onClick:ae,children:"Limpiar"})]})]})}),n?a.jsx(aie,{children:"Cargando cotizaciones..."}):t.length===0?a.jsxs(U5,{children:[a.jsx("div",{style:{fontSize:"3rem",marginBottom:d.spacing.md},children:""}),a.jsx("div",{children:"No hay cotizaciones pendientes de aprobacin externa"})]}):a.jsxs(a.Fragment,{children:[a.jsxs(eie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(ps,{children:"N"}),a.jsx(ps,{children:"Das"}),a.jsx(ps,{children:"Cliente"}),a.jsx(ps,{children:"Descripcin"}),a.jsx(ps,{children:"CAD"}),a.jsx(ps,{children:"Detalles"}),a.jsx(ps,{children:"Versin"}),a.jsx(ps,{children:"Creador"}),a.jsx(ps,{children:"Fecha"}),a.jsx(ps,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(O=>a.jsxs(tie,{children:[a.jsx(ms,{children:a.jsx("strong",{children:O.id})}),a.jsx(ms,{children:a.jsxs(rie,{$dias:O.dias_pendiente,children:[O.dias_pendiente,"d"]})}),a.jsx(ms,{children:O.cliente_nombre||"-"}),a.jsx(ms,{children:O.primer_detalle_descripcion||"-"}),a.jsx(ms,{children:O.primer_detalle_cad||"-"}),a.jsxs(ms,{children:[a.jsx("span",{children:O.total_detalles}),O.detalles_ganados>0&&a.jsxs(Jm,{$variant:"success",style:{marginLeft:"4px"},children:["+",O.detalles_ganados]}),O.detalles_perdidos>0&&a.jsxs(Jm,{$variant:"danger",style:{marginLeft:"4px"},children:["-",O.detalles_perdidos]})]}),a.jsxs(ms,{children:["v",O.version_number||1]}),a.jsx(ms,{children:O.creador_nombre||"-"}),a.jsx(ms,{children:ne(O.created_at)}),a.jsx(ms,{children:a.jsxs(nie,{children:[a.jsx(Zm,{$variant:"view",onClick:()=>e("cotizacion-editar",O.id),title:"Ver detalle",children:""}),a.jsx(Zm,{$variant:"view",onClick:()=>le(O,"historial"),title:"Ver historial",children:""}),a.jsx(Zm,{$variant:"approve",onClick:()=>le(O,"aprobar"),title:"Aprobar",children:""}),a.jsx(Zm,{$variant:"reject",onClick:()=>le(O,"rechazar"),title:"Rechazar",children:""})]})})]},O.id))})]}),f>1&&a.jsxs(iie,{children:[a.jsx(tb,{onClick:()=>h(O=>Math.max(1,O-1)),disabled:u===1,children:""}),Array.from({length:Math.min(5,f)},(O,N)=>{const L=Math.max(1,Math.min(u-2,f-4))+N;return L>f?null:a.jsx(tb,{$active:u===L,onClick:()=>h(L),children:L},L)}),a.jsx(tb,{onClick:()=>h(O=>Math.min(f,O+1)),disabled:u===f,children:""})]})]}),b&&T&&a.jsx(sie,{onClick:G,children:a.jsx(oie,{onClick:O=>O.stopPropagation(),children:j==="historial"?a.jsxs(a.Fragment,{children:[a.jsxs(V5,{children:["Historial de Aprobaciones - Cotizacin #",T.id]}),D.length===0?a.jsx(U5,{children:"No hay historial de aprobaciones"}):a.jsxs(cie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Fecha"}),a.jsx("th",{children:"Usuario"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Accin"}),a.jsx("th",{children:"Motivo"})]})}),a.jsx("tbody",{children:D.map(O=>a.jsxs("tr",{children:[a.jsx("td",{children:ne(O.created_at)}),a.jsx("td",{children:O.usuario_nombre||"-"}),a.jsx("td",{children:O.rol_nombre}),a.jsx("td",{children:a.jsx(Jm,{$variant:O.action_made.includes("Rechazo")?"danger":"success",children:O.action_made})}),a.jsx("td",{children:O.motivo||"-"})]},O.id))})]}),a.jsx(H5,{children:a.jsx(qh,{$variant:"secondary",onClick:G,children:"Cerrar"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs(V5,{children:[j==="aprobar"?" Aprobar":" Rechazar"," Cotizacin #",T.id]}),a.jsxs("div",{style:{marginBottom:d.spacing.lg},children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",T.cliente_nombre]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Descripcin:"})," ",T.primer_detalle_descripcion||"-"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Detalles:"})," ",T.total_detalles]})]}),a.jsxs(Gh,{children:[a.jsx(Qm,{children:j==="aprobar"?"Observaciones (opcional)":"Motivo del rechazo"}),a.jsx(lie,{value:w,onChange:O=>P(O.target.value),placeholder:j==="aprobar"?"Ingrese observaciones adicionales...":"Indique el motivo del rechazo...",required:j==="rechazar"})]}),a.jsxs(H5,{children:[a.jsx(qh,{$variant:"secondary",onClick:G,disabled:M,children:"Cancelar"}),a.jsx(qh,{$variant:j==="aprobar"?"success":"danger",onClick:ie,disabled:M||j==="rechazar"&&!w.trim(),children:M?"Procesando...":j==="aprobar"?"Confirmar Aprobacin":"Confirmar Rechazo"})]})]})})})]})}const uie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  box-shadow: ${d.shadows.md};
  padding: ${d.spacing.xl};
`,hie=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: ${d.spacing.lg};
  flex-wrap: wrap;
  gap: ${d.spacing.md};
`,fie=p.h2`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.semibold};
  margin: 0;
`,pie=p.button`
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.bgLight};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,mie=p.div`
  background: ${d.colors.bgBlueLight};
  border-left: 4px solid ${d.colors.primary};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,gie=p.p`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.body};
  margin: 0;
`,xie=p.table`
  width: 100%;
  border-collapse: collapse;
  margin-top: ${d.spacing.md};
`,Ws=p.th`
  text-align: left;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background-color: ${d.colors.cardHeader};
  color: white;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};

  &:first-child {
    border-radius: ${d.radius.md} 0 0 0;
  }

  &:last-child {
    border-radius: 0 ${d.radius.md} 0 0;
  }
`,Gs=p.td`
  padding: ${d.spacing.sm} ${d.spacing.md};
  border-bottom: 1px solid ${d.colors.border};
  font-size: ${d.typography.sizes.small};
  color: ${d.colors.textPrimary};
`,vie=p.tr`
  &:hover {
    background-color: ${d.colors.bgLight};
  }
`,_ie=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }
`,yie=p.span`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$color:e})=>e||d.colors.primary}20;
  color: ${({$color:e})=>e||d.colors.primary};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.tiny};
  font-weight: ${d.typography.weights.medium};
`,bie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: ${d.spacing.sm};
  margin-top: ${d.spacing.lg};
`,G5=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: ${({$active:e})=>e?d.colors.primary:"white"};
  color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  border: 1px solid ${({$active:e})=>e?d.colors.primary:d.colors.border};
  border-radius: ${d.radius.sm};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    background-color: ${d.colors.primary};
    color: white;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,jie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,wie=p.div`
  text-align: center;
  padding: ${d.spacing.xl};
  color: ${d.colors.textSecondary};
`,kie=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
`,Sie=p.div`
  background: white;
  border-radius: ${d.radius.lg};
  padding: ${d.spacing.xl};
  max-width: 500px;
  width: 90%;
  box-shadow: ${d.shadows.lg};
`,Cie=p.h3`
  color: ${d.colors.textPrimary};
  font-size: ${d.typography.sizes.h3};
  margin: 0 0 ${d.spacing.lg};
`,$ie=p.div`
  margin-bottom: ${d.spacing.lg};
`,Eie=p.label`
  display: block;
  margin-bottom: ${d.spacing.xs};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  color: ${d.colors.textPrimary};
`,Tie=p.select`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  color: ${d.colors.textPrimary};
  background-color: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Aie=p.div`
  display: flex;
  justify-content: flex-end;
  gap: ${d.spacing.md};
  margin-top: ${d.spacing.lg};
`,Fie=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.bgLight};
  color: ${d.colors.textSecondary};
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.border};
  }
`,Die=p.button`
  padding: ${d.spacing.sm} ${d.spacing.lg};
  background-color: ${d.colors.success};
  color: white;
  border: none;
  border-radius: ${d.radius.md};
  font-size: ${d.typography.sizes.body};
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${d.colors.success}dd;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Pie=p.div`
  background: ${d.colors.bgLight};
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
`,rb=p.div`
  display: flex;
  justify-content: space-between;
  padding: ${d.spacing.xs} 0;
  font-size: ${d.typography.sizes.small};

  &:not(:last-child) {
    border-bottom: 1px solid ${d.colors.border};
  }
`,nb=p.span`
  color: ${d.colors.textSecondary};
`,ab=p.span`
  color: ${d.colors.textPrimary};
  font-weight: ${d.typography.weights.medium};
`,Mie=p.div`
  padding: ${d.spacing.md};
  border-radius: ${d.radius.md};
  margin-bottom: ${d.spacing.lg};
  background-color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}15;
  color: ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger};
  border: 1px solid ${({$type:e})=>e==="success"?d.colors.success:d.colors.danger}30;
`,Oie=[{id:1,nombre:"Desarrollo Completo"},{id:5,nombre:"Arte con Material"}];function Rie({onNavigate:e}){const[t,r]=C.useState([]),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(1),[u,h]=C.useState(1),[f,m]=C.useState(0),[_,g]=C.useState(!1),[v,y]=C.useState(null),[b,x]=C.useState(1),[j,S]=C.useState(!1),T=C.useCallback(async()=>{i(!0),o(null);try{const A=await Xn.getDetallesParaOT(void 0,l,20);r(A.items),h(A.total_pages),m(A.total)}catch(A){console.error("Error cargando detalles:",A),o("Error al cargar los detalles de cotizaciones")}finally{i(!1)}},[l]);C.useEffect(()=>{T()},[T]);const F=A=>{y(A),x(1),g(!0)},w=async()=>{if(v){S(!0);try{const A=await Xn.getDetalleParaOT(v.detalle_id,b);A.success&&(g(!1),e("crear-ot-desde-cotizacion",void 0,A.datos_ot))}catch(A){console.error("Error obteniendo datos para OT:",A),o("Error al preparar los datos para la OT")}finally{S(!1)}}},P=A=>{try{return new Date(A).toLocaleDateString("es-CL")}catch{return A}},M=(A,D,H)=>!A&&!D&&!H?"-":`${A||0} x ${D||0} x ${H||0}`;return a.jsxs(uie,{children:[a.jsxs(hie,{children:[a.jsx(fie,{children:"Crear OT desde Cotizacion"}),a.jsx(pie,{onClick:()=>e("cotizaciones"),children:"Volver a Cotizaciones"})]}),a.jsx(mie,{children:a.jsx(gie,{children:"Seleccione un detalle de cotizacion aprobada para crear una nueva Orden de Trabajo. Solo se muestran detalles de cotizaciones aprobadas que aun no tienen OT asociada."})}),s&&a.jsx(Mie,{$type:"error",children:s}),n?a.jsx(jie,{children:"Cargando detalles..."}):t.length===0?a.jsxs(wie,{children:[a.jsx("p",{children:"No hay detalles disponibles para crear OT."}),a.jsx("p",{children:"Los detalles deben pertenecer a cotizaciones aprobadas."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("p",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Mostrando ",t.length," de ",f," detalles disponibles"]}),a.jsxs(xie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ws,{children:"Cot. #"}),a.jsx(Ws,{children:"Cliente"}),a.jsx(Ws,{children:"Descripcion"}),a.jsx(Ws,{children:"Dimensiones"}),a.jsx(Ws,{children:"CAD"}),a.jsx(Ws,{children:"Carton"}),a.jsx(Ws,{children:"Estado"}),a.jsx(Ws,{children:"Fecha"}),a.jsx(Ws,{children:"Acciones"})]})}),a.jsx("tbody",{children:t.map(A=>a.jsxs(vie,{children:[a.jsx(Gs,{children:a.jsxs("strong",{children:["#",A.cotizacion_id]})}),a.jsx(Gs,{children:A.cliente_nombre}),a.jsx(Gs,{children:A.descripcion_material_detalle||A.descripcion||"-"}),a.jsx(Gs,{children:M(A.largura,A.anchura,A.altura)}),a.jsx(Gs,{children:A.cad_codigo||"-"}),a.jsx(Gs,{children:A.carton_codigo||"-"}),a.jsx(Gs,{children:a.jsx(yie,{$color:d.colors.success,children:A.estado_nombre})}),a.jsx(Gs,{children:P(A.cotizacion_fecha)}),a.jsx(Gs,{children:a.jsx(_ie,{onClick:()=>F(A),children:"Crear OT"})})]},A.detalle_id))})]}),u>1&&a.jsxs(bie,{children:[a.jsx(G5,{onClick:()=>c(A=>Math.max(1,A-1)),disabled:l===1,children:"Anterior"}),a.jsxs("span",{style:{color:d.colors.textSecondary,fontSize:d.typography.sizes.small},children:["Pagina ",l," de ",u]}),a.jsx(G5,{onClick:()=>c(A=>Math.min(u,A+1)),disabled:l===u,children:"Siguiente"})]})]}),_&&v&&a.jsx(kie,{onClick:()=>g(!1),children:a.jsxs(Sie,{onClick:A=>A.stopPropagation(),children:[a.jsx(Cie,{children:"Crear Orden de Trabajo"}),a.jsxs(Pie,{children:[a.jsxs(rb,{children:[a.jsx(nb,{children:"Cotizacion:"}),a.jsxs(ab,{children:["#",v.cotizacion_id]})]}),a.jsxs(rb,{children:[a.jsx(nb,{children:"Cliente:"}),a.jsx(ab,{children:v.cliente_nombre})]}),a.jsxs(rb,{children:[a.jsx(nb,{children:"Descripcion:"}),a.jsx(ab,{children:v.descripcion_material_detalle||v.descripcion||"-"})]})]}),a.jsxs($ie,{children:[a.jsx(Eie,{htmlFor:"tipo_solicitud",children:"Tipo de Solicitud *"}),a.jsx(Tie,{id:"tipo_solicitud",value:b,onChange:A=>x(Number(A.target.value)),children:Oie.map(A=>a.jsx("option",{value:A.id,children:A.nombre},A.id))})]}),a.jsxs(Aie,{children:[a.jsx(Fie,{onClick:()=>g(!1),children:"Cancelar"}),a.jsx(Die,{onClick:w,disabled:j,children:j?"Procesando...":"Continuar"})]})]})})]})}p.div`
  padding: 1.5rem;
  max-width: 1200px;
  margin: 0 auto;
`;p.div`
  margin-bottom: 2rem;
`;p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 0.9rem;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  margin-bottom: 0.5rem;

  &:hover {
    text-decoration: underline;
  }
`;p.h1`
  font-size: 1.75rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.5rem 0;
`;p.p`
  font-size: 1rem;
  color: ${d.colors.textSecondary};
  margin: 0;
`;p.div`
  display: grid;
  grid-template-columns: 250px 1fr;
  gap: 2rem;

  @media (max-width: 900px) {
    grid-template-columns: 1fr;
  }
`;p.nav`
  background: white;
  border-radius: 12px;
  padding: 1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  position: sticky;
  top: 1rem;
  height: fit-content;
`;p.h3`
  font-size: 0.75rem;
  font-weight: 600;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  margin: 0 0 0.75rem 0;
  padding: 0 0.5rem;
`;p.a`
  display: block;
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  background: ${({$active:e})=>e?`${d.colors.primary}10`:"transparent"};
  border-radius: 6px;
  text-decoration: none;
  cursor: pointer;
  margin-bottom: 0.25rem;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;p.div`
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
`;p.section`
  margin-bottom: 2.5rem;

  &:last-child {
    margin-bottom: 0;
  }
`;p.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary}20;
`;p.p`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin: 0 0 1rem 0;
`;p.ul`
  margin: 0 0 1rem 0;
  padding-left: 1.5rem;
`;p.li`
  font-size: 0.9375rem;
  color: ${d.colors.textPrimary};
  line-height: 1.7;
  margin-bottom: 0.5rem;
`;p.div`
  display: flex;
  gap: 1rem;
  padding: 1rem;
  background: ${d.colors.bgLight};
  border-radius: 8px;
  margin-bottom: 1rem;
`;p.div`
  width: 32px;
  height: 32px;
  background: ${d.colors.primary};
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  flex-shrink: 0;
`;p.div`
  flex: 1;
`;p.h4`
  font-size: 0.9375rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 0.25rem 0;
`;p.p`
  font-size: 0.875rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`;p.div`
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;

  ${({$type:e="info"})=>{switch(e){case"warning":return`
          background: ${d.colors.warning}15;
          border-left: 4px solid ${d.colors.warning};
        `;case"success":return`
          background: ${d.colors.success}15;
          border-left: 4px solid ${d.colors.success};
        `;default:return`
          background: ${d.colors.primary}10;
          border-left: 4px solid ${d.colors.primary};
        `}}}
`;p.div`
  font-weight: 600;
  font-size: 0.875rem;
  margin-bottom: 0.25rem;
`;p.div`
  font-size: 0.875rem;
  line-height: 1.5;
`;p.table`
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
  font-size: 0.875rem;
`;p.th`
  text-align: left;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
`;p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
`;p.code`
  background: ${d.colors.bgLight};
  padding: 0.125rem 0.375rem;
  border-radius: 4px;
  font-family: 'Consolas', monospace;
  font-size: 0.85em;
`;const ib=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,sb=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,ob=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,lb=p.div`
  display: flex;
  gap: 0.75rem;
`,Kh=p.button`
  padding: 0.5rem 1.25rem;
  border-radius: 50px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid;

  ${e=>{switch(e.$variant){case"primary":return`
          background: ${d.colors.primary};
          color: white;
          border-color: ${d.colors.primary};
          &:hover { background: #002d66; }
        `;case"success":return`
          background: ${d.colors.success};
          color: white;
          border-color: ${d.colors.success};
          &:hover { background: #218838; }
        `;default:return`
          background: white;
          color: ${d.colors.textSecondary};
          border-color: ${d.colors.border};
          &:hover {
            border-color: ${d.colors.primary};
            color: ${d.colors.primary};
          }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Nie=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,zie=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  align-items: end;
`,Nd=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,zd=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
`,eg=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Iie=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  background: white;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
    box-shadow: 0 0 0 2px ${d.colors.primary}20;
  }
`,Lie=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,Bie=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
`,li=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.6rem 0.5rem;
  text-align: center;
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  white-space: nowrap;
`,ci=p.td`
  padding: 0.6rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
  text-align: center;
`,Uie=p.tr`
  ${e=>e.$inactive&&`
    color: #999;
  `}

  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,Vie=p.span`
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"borrador":return`
          background: #6c757d;
          color: white;
        `;case"pendiente":return`
          background: ${d.colors.warning};
          color: #333;
        `;case"aprobada":return`
          background: ${d.colors.success};
          color: white;
        `;case"rechazada":return`
          background: ${d.colors.danger};
          color: white;
        `;case"vencida":return`
          background: #6c757d;
          color: white;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,Hie=p.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
`,cb=p.span`
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 0.75rem;

  ${e=>{switch(e.$type){case"ganados":return`color: ${d.colors.success};`;case"perdidos":return`color: ${d.colors.danger};`;default:return"color: #666;"}}}
`,q5=p.button`
  padding: 0.3rem 0.5rem;
  border: none;
  border-radius: 4px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"view":return`
          background: ${d.colors.primary};
          color: white;
          &:hover { background: #002d66; }
        `;case"edit":return`
          background: ${d.colors.warning};
          color: white;
          &:hover { background: #e0a800; }
        `;case"pdf":return`
          background: #e74c3c;
          color: white;
          &:hover { background: #c0392b; }
        `;default:return`
          background: ${d.colors.border};
          color: ${d.colors.textPrimary};
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Wie=p.div`
  text-align: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Gie=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,qie=p.div`
  width: 40px;
  height: 40px;
  border: 3px solid ${d.colors.border};
  border-top-color: ${d.colors.primary};
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-bottom: 0.75rem;

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
`,Kie=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-top: 1px solid ${d.colors.border};
`,K5=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  background: white;
  color: ${d.colors.textSecondary};
  cursor: pointer;
  transition: all 0.2s;

  &:hover:not(:disabled) {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Xie=p.span`
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
`,X5=p.div`
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.875rem;

  ${e=>e.$type==="success"&&`
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  `}

  ${e=>e.$type==="error"&&`
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  `}
`,tg=p.span`
  display: block;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Yie={1:{label:"Borrador",type:"borrador"},2:{label:"Pendiente",type:"pendiente"},3:{label:"Aprobada",type:"aprobada"},4:{label:"Vigente",type:"aprobada"},5:{label:"Vencida",type:"vencida"},6:{label:"Rechazada",type:"rechazada"}},rg=()=>{const e=new Date;return e.setMonth(e.getMonth()-3),e.toISOString().split("T")[0]},ng=()=>new Date().toISOString().split("T")[0];function Qie({onNavigate:e}){const[t,r]=C.useState({page:1,page_size:20,date_desde:rg(),date_hasta:ng()}),[n,i]=C.useState(""),[s,o]=C.useState(rg()),[l,c]=C.useState(ng()),[u,h]=C.useState(""),[f,m]=C.useState(""),[_,g]=C.useState(null),{data:v,isLoading:y,error:b}=Nt({queryKey:["cotizaciones-externo",t],queryFn:()=>Xn.list(t)}),{data:x}=Nt({queryKey:["cotizacion-estados"],queryFn:()=>Xn.getEstados()}),j=C.useCallback(R=>{R.preventDefault();const ae={...t,page:1,date_desde:s,date_hasta:l};n?ae.cotizacion_id=parseInt(n,10):delete ae.cotizacion_id,u?ae.estado_id=[parseInt(u,10)]:delete ae.estado_id,f?ae.cad=f:delete ae.cad,r(ae)},[t,n,u,f,s,l]),S=C.useCallback(()=>{i(""),h(""),m(""),o(rg()),c(ng()),r({page:1,page_size:20,date_desde:rg(),date_hasta:ng()})},[]),T=C.useCallback(()=>{e("cotizacion-externa-nueva")},[e]),F=C.useCallback(R=>{e("cotizacion-externa-editar",R.id)},[e]),w=C.useCallback(R=>{const ae=`/api/v1/api/cotizaciones/${R}/pdf`;window.open(ae,"_blank"),g("Descargando PDF..."),setTimeout(()=>g(null),2e3)},[]),P=C.useCallback(R=>{r(ae=>({...ae,page:R}))},[]),M=R=>R?new Date(R).toLocaleString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",A=R=>{const ae=Yie[R]||{label:"Desconocido",type:"info"};return a.jsx(Vie,{$type:ae.type,children:ae.label})};if(y)return a.jsxs(ib,{children:[a.jsxs(sb,{children:[a.jsx(ob,{children:"Cotizaciones"}),a.jsx(lb,{children:a.jsx(Kh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(Gie,{children:[a.jsx(qie,{}),a.jsx("span",{children:"Cargando cotizaciones..."})]})]});if(b)return a.jsxs(ib,{children:[a.jsxs(sb,{children:[a.jsx(ob,{children:"Cotizaciones"}),a.jsx(lb,{children:a.jsx(Kh,{onClick:()=>e("dashboard"),children:"Volver al Dashboard"})})]}),a.jsxs(X5,{$type:"error",children:["Error al cargar cotizaciones: ",b.message]})]});const D=(v==null?void 0:v.items)||[],H=(v==null?void 0:v.total)||0,U=(v==null?void 0:v.total_pages)||1,W=(v==null?void 0:v.page)||1;return a.jsxs(ib,{children:[a.jsxs(sb,{children:[a.jsxs(ob,{children:["Cotizaciones (",H,")"]}),a.jsx(lb,{children:a.jsx(Kh,{$variant:"primary",onClick:T,children:"Crear Cotizacion"})})]}),_&&a.jsx(X5,{$type:"success",children:_}),a.jsx(Nie,{children:a.jsx("form",{onSubmit:j,children:a.jsxs(zie,{children:[a.jsxs(Nd,{children:[a.jsx(zd,{children:"Desde"}),a.jsx(eg,{type:"date",value:s,onChange:R=>o(R.target.value)})]}),a.jsxs(Nd,{children:[a.jsx(zd,{children:"Hasta"}),a.jsx(eg,{type:"date",value:l,onChange:R=>c(R.target.value)})]}),a.jsxs(Nd,{children:[a.jsx(zd,{children:"N Cotizacion"}),a.jsx(eg,{type:"number",placeholder:"ID...",value:n,onChange:R=>i(R.target.value)})]}),a.jsxs(Nd,{children:[a.jsx(zd,{children:"Estado"}),a.jsxs(Iie,{value:u,onChange:R=>h(R.target.value),children:[a.jsx("option",{value:"",children:"Selecciona..."}),x==null?void 0:x.map(R=>a.jsx("option",{value:R.id,children:R.nombre},R.id))]})]}),a.jsxs(Nd,{children:[a.jsx(zd,{children:"CAD"}),a.jsx(eg,{type:"text",placeholder:"CAD...",value:f,onChange:R=>m(R.target.value)})]}),a.jsxs(Nd,{children:[a.jsx(zd,{children:""}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx(Kh,{type:"submit",$variant:"primary",children:"Filtrar"}),a.jsx(Kh,{type:"button",onClick:S,children:"Limpiar"})]})]})]})})}),a.jsx(Lie,{children:D.length===0?a.jsx(Wie,{children:a.jsx("p",{children:"No hay cotizaciones actualmente"})}):a.jsxs(a.Fragment,{children:[a.jsxs(Bie,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(li,{children:"Cotizacion N"}),a.jsx(li,{children:"N de Productos"}),a.jsx(li,{children:"Creador"}),a.jsx(li,{children:"Cliente"}),a.jsx(li,{children:"Fecha 1ra Ver."}),a.jsx(li,{children:"Fecha Ult. Ver."}),a.jsx(li,{children:"Descrip."}),a.jsx(li,{children:"CAD"}),a.jsx(li,{children:"OT"}),a.jsx(li,{children:"N Version"}),a.jsx(li,{children:"Estado"}),a.jsx(li,{children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(R=>a.jsxs(Uie,{$inactive:R.active===0,children:[a.jsx(ci,{children:a.jsx("strong",{children:R.id})}),a.jsx(ci,{children:a.jsxs(Hie,{children:[a.jsx(cb,{$type:"total",title:"Total Detalles",children:R.total_detalles||0}),a.jsxs(cb,{$type:"ganados",title:"Detalles Ganados",style:{opacity:R.estado_id>=3?1:.15},children:["+",R.detalles_ganados||0]}),a.jsxs(cb,{$type:"perdidos",title:"Detalles Perdidos",style:{opacity:R.estado_id>=3?1:.15},children:["-",R.detalles_perdidos||0]})]})}),a.jsx(ci,{children:a.jsx(tg,{title:R.usuario_nombre||"-",children:R.usuario_nombre||"-"})}),a.jsx(ci,{children:a.jsx(tg,{title:R.cliente_nombre||"-",children:R.cliente_nombre||"-"})}),a.jsx(ci,{children:M(R.fecha_primera_version||R.created_at)}),a.jsx(ci,{children:M(R.created_at)}),a.jsx(ci,{children:a.jsx(tg,{title:R.primer_detalle_descripcion||"-",children:R.primer_detalle_descripcion||"-"})}),a.jsx(ci,{children:a.jsx(tg,{title:R.primer_detalle_cad||"-",children:R.primer_detalle_cad||"-"})}),a.jsx(ci,{children:R.primer_detalle_ot||"-"}),a.jsx(ci,{children:R.version_number||"-"}),a.jsx(ci,{children:A(R.estado_id)}),a.jsxs(ci,{children:[a.jsx(q5,{$variant:R.estado_id===3?"view":"edit",onClick:()=>F(R),title:R.estado_id===3?"Ver":"Editar",children:R.estado_id===3?"Ver":"Editar"}),R.estado_id===3&&a.jsx(q5,{$variant:"pdf",onClick:()=>w(R.id),title:"Descargar PDF",children:"PDF"})]})]},R.id))})]}),U>1&&a.jsxs(Kie,{children:[a.jsx(K5,{disabled:W===1,onClick:()=>P(W-1),children:"Anterior"}),a.jsxs(Xie,{children:["Pagina ",W," de ",U]}),a.jsx(K5,{disabled:W===U,onClick:()=>P(W+1),children:"Siguiente"})]})]})})]})}const Jie=p.div`
  padding: 1.5rem;
  max-width: 1400px;
  margin: 0 auto;
`,Zie=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: #1a1a2e;
  margin-bottom: 1.5rem;
`,ese=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
`,tse=p.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  transition: transform 0.2s, box-shadow 0.2s;

  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  }
`,rse=p.a`
  display: block;
  cursor: pointer;
`,nse=p.img`
  width: 100%;
  height: 160px;
  object-fit: cover;
`,ase=p.div`
  padding: 1rem;
`,ise=p.p`
  font-size: 0.95rem;
  font-weight: 600;
  color: #333;
  margin: 0;
  line-height: 1.4;
`,sse=p.button`
  background: #f0f0f0;
  border: 1px solid #ddd;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  margin-bottom: 1rem;

  &:hover {
    background: #e0e0e0;
  }
`,ose=[{title:"Cmo pasar de un detalle de una Cotizacin a una OT?",video:"cotizacion a OT.mp4"},{title:"Cmo pasar de una OT a una Cotizacin?",video:"OT a Cotizacion.mp4"},{title:"Cmo crear una nueva Cotizacin rapidamente?",video:"crear Cotizacion.mp4"},{title:"Cmo agregar detalle corrugado?",video:"Corrugado.mp4"},{title:"Cmo agregar detalle esquinero?",video:"Esquinero.mp4"},{title:"Cmo calcular un area HC?",video:"AreaHC.mp4"},{title:"Cmo estimar un cartn?",video:"CartonHC.mp4"},{title:"Cmo versionar una cotizacin? (Editar Cotizacin activa)",video:"Versionar.mp4"},{title:"Cmo Agregar un Multidestino?",video:"Multidestino.mp4"},{title:"Cmo cargar una cotizacin masiva? (Carga de Archivo)",video:"cargaMasiva.mp4"},{title:"Cmo duplicar cotizacin? (Cotizacin independiente)",video:"Duplicar.mp4"},{title:"Cmo imprimir cotizacin? (Carta Tipo)",video:"DescargarPDF.mp4"}],lse="https://techrev.me/wp-content/uploads/2019/09/cropped-how-to-make-tutorial-videos-1600x768.jpg",cse="http://localhost:8080";function dse({onNavigate:e}){const t=r=>{window.open(`${cse}/videos/${r}`,"_blank")};return a.jsxs(Jie,{children:[a.jsx(sse,{onClick:()=>e("cotizaciones"),children:" Volver a Cotizaciones"}),a.jsx(Zie,{children:"Seccin de Ayuda"}),a.jsx(ese,{children:ose.map((r,n)=>a.jsxs(tse,{children:[a.jsx(rse,{onClick:()=>t(r.video),children:a.jsx(nse,{src:lse,alt:r.title})}),a.jsx(ase,{children:a.jsx(ise,{children:r.title})})]},n))})]})}const db=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,ub=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,hb=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,use=p.div`
  display: flex;
  gap: 0.75rem;
`,fb=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,hse=p.button`
  padding: 0.5rem 1.25rem;
  border: none;
  border-radius: 50px;
  background: ${d.colors.primary};
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background: ${d.colors.primaryDark};
  }
`,Y5=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  overflow: hidden;
`,fse=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
`,qs=p.th`
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  white-space: nowrap;
`,Ks=p.td`
  padding: 0.75rem;
  border-bottom: 1px solid ${d.colors.border};
  vertical-align: middle;
`,Q5=p.tr`
  &:hover {
    background: ${d.colors.bgLight};
  }

  &:last-child td {
    border-bottom: none;
  }
`,pse=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$type){case"warning":return`
          background: #ffc10715;
          color: #ffc107;
        `;case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
        `;case"priority":return`
          background: #ff572215;
          color: #ff5722;
        `;case"state":return`
          background: #6c757d15;
          color: #6c757d;
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
        `}}}
`,mse=p.span`
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 50px;
  font-size: 0.7rem;
  font-weight: 500;

  ${e=>{switch(e.$estado){case 0:return"background: #6c757d15; color: #6c757d;";case 1:return"background: #2196f315; color: #2196f3;";case 2:return`background: ${d.colors.danger}15; color: ${d.colors.danger};`;case 3:return`background: ${d.colors.success}15; color: ${d.colors.success};`;case 4:return"background: #9e9e9e15; color: #9e9e9e;";case 5:return"background: #ff980015; color: #ff9800;";case 6:return"background: #9c27b015; color: #9c27b0;";default:return"background: #6c757d15; color: #6c757d;"}}}
`,Bi=p.button`
  padding: 0.35rem 0.6rem;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.25rem;

  ${e=>{switch(e.$variant){case"success":return`
          background: ${d.colors.success}15;
          color: ${d.colors.success};
          &:hover { background: ${d.colors.success}; color: white; }
        `;case"danger":return`
          background: ${d.colors.danger}15;
          color: ${d.colors.danger};
          &:hover { background: ${d.colors.danger}; color: white; }
        `;case"warning":return`
          background: #ffc10715;
          color: #ffc107;
          &:hover { background: #ffc107; color: white; }
        `;case"info":return`
          background: #2196f315;
          color: #2196f3;
          &:hover { background: #2196f3; color: white; }
        `;default:return`
          background: ${d.colors.primary}15;
          color: ${d.colors.primary};
          &:hover { background: ${d.colors.primary}; color: white; }
        `}}}

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,J5=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: ${d.colors.textSecondary};
`,Z5=p.div`
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
`,e4=p.p`
  font-size: 1rem;
  margin: 0;
`,gse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,xse=p.div`
  display: flex;
  gap: 0.25rem;
  flex-wrap: wrap;
  justify-content: flex-start;
`,ag=p.span`
  display: block;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,vse=p.span`
  color: #ff5722;
  font-weight: bold;
  margin-right: 0.25rem;
`,pb=p.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,mb=p.div`
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  max-width: 400px;
  width: 100%;
`,gb=p.h3`
  margin: 0 0 1rem 0;
  color: ${d.colors.textPrimary};
`,t4=p.textarea`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,_se=p.select`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 1rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,xb=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
`,Id=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;function yse({otId:e,onNavigate:t,onCreateMuestra:r}){var re;const n=Pr(),[i,s]=C.useState(!1),[o,l]=C.useState(!1),[c,u]=C.useState(!1),[h,f]=C.useState(null),[m,_]=C.useState(""),[g,v]=C.useState(null),{data:y,isLoading:b,error:x}=Nt({queryKey:["muestras",e],queryFn:()=>vr.listByOT(e)}),{data:j}=Nt({queryKey:["muestras-options"],queryFn:()=>vr.getOptions()}),S=jt({mutationFn:Z=>vr.terminar(Z),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),T=jt({mutationFn:({id:Z,obs:me})=>vr.rechazar(Z,me),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),s(!1),_("")}}),F=jt({mutationFn:Z=>vr.anular(Z),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),w=jt({mutationFn:({id:Z,obs:me})=>vr.devolver(Z,me),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),l(!1),_("")}}),P=jt({mutationFn:Z=>vr.togglePrioritaria(Z),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),M=jt({mutationFn:Z=>vr.delete(Z),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),A=jt({mutationFn:({id:Z,salaId:me})=>vr.asignarSalaCorte(Z,me),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),u(!1),v(null)}}),D=jt({mutationFn:Z=>vr.iniciarProceso(Z),onSuccess:()=>n.invalidateQueries({queryKey:["muestras",e]})}),H=C.useCallback(Z=>{window.confirm("Marcar muestra como terminada?")&&S.mutate(Z)},[S]),U=C.useCallback(Z=>{f(Z),s(!0)},[]),W=C.useCallback(Z=>{window.confirm("Anular esta muestra?")&&F.mutate(Z)},[F]),R=C.useCallback(Z=>{f(Z),l(!0)},[]),ae=C.useCallback(Z=>{P.mutate(Z)},[P]),le=C.useCallback(Z=>{window.confirm("Eliminar esta muestra? Esta accin no se puede deshacer.")&&M.mutate(Z)},[M]),G=C.useCallback(Z=>{f(Z),u(!0)},[]),z=C.useCallback(Z=>{window.confirm("Iniciar proceso de esta muestra?")&&D.mutate(Z)},[D]),ie=()=>{h&&T.mutate({id:h,obs:m})},ne=()=>{h&&w.mutate({id:h,obs:m})},O=()=>{h&&g&&A.mutate({id:h,salaId:g})},N=Z=>{const me=[],B=Z.estado;switch(me.push(a.jsx(Bi,{$variant:"primary",onClick:()=>t("muestra-detalle",Z.id),title:"Ver detalle",children:"Ver"},"ver")),me.push(a.jsx(Bi,{$variant:"info",onClick:()=>i1.downloadEtiquetaMuestra(Z.id,"producto"),title:"Etiqueta Producto (10x10cm)",children:"Etq"},"etq-prod")),me.push(a.jsx(Bi,{$variant:"info",onClick:()=>i1.downloadEtiquetaMuestra(Z.id,"cliente"),title:"Etiqueta Cliente (A4)",children:"Envo"},"etq-cli")),B!==3&&B!==4&&me.push(a.jsx(Bi,{$variant:Z.prioritaria?"warning":"info",onClick:()=>ae(Z.id),title:Z.prioritaria?"Quitar prioridad":"Marcar prioritaria",disabled:P.isPending,children:Z.prioritaria?"":""},"priority")),B){case 0:me.push(a.jsx(Bi,{$variant:"info",onClick:()=>G(Z.id),title:"Asignar sala de corte",children:"Sala"},"sala")),me.push(a.jsx(Bi,{$variant:"danger",onClick:()=>le(Z.id),title:"Eliminar",disabled:M.isPending,children:""},"delete"));break;case 1:me.push(a.jsx(Bi,{$variant:"success",onClick:()=>H(Z.id),title:"Terminar",disabled:S.isPending,children:""},"terminar")),me.push(a.jsx(Bi,{$variant:"danger",onClick:()=>U(Z.id),title:"Rechazar",children:""},"rechazar")),me.push(a.jsx(Bi,{$variant:"warning",onClick:()=>R(Z.id),title:"Devolver",children:""},"devolver"));break;case 6:me.push(a.jsx(Bi,{$variant:"info",onClick:()=>z(Z.id),title:"Iniciar proceso",disabled:D.isPending,children:""},"iniciar"));break;case 3:case 4:break;default:B!==4&&me.push(a.jsx(Bi,{$variant:"danger",onClick:()=>W(Z.id),title:"Anular",disabled:F.isPending,children:"Anular"},"anular"))}return me};if(b)return a.jsxs(db,{children:[a.jsxs(ub,{children:[a.jsxs(hb,{children:["Muestras de OT #",e]}),a.jsx(fb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsx(gse,{children:"Cargando..."})]});if(x)return a.jsxs(db,{children:[a.jsxs(ub,{children:[a.jsxs(hb,{children:["Muestras de OT #",e]}),a.jsx(fb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]}),a.jsxs(J5,{children:[a.jsx(Z5,{children:"!"}),a.jsx(e4,{children:"Error al cargar las muestras"})]})]});const L=(y==null?void 0:y.items)||[],K=(y==null?void 0:y.total)||0;return a.jsxs(db,{children:[a.jsxs(ub,{children:[a.jsxs(hb,{children:["Muestras de OT #",e," (",K,")"]}),a.jsxs(use,{children:[a.jsx(hse,{onClick:r,children:"+ Nueva Muestra"}),a.jsx(fb,{onClick:()=>t("gestionar-ot",e),children:"Volver a OT"})]})]}),L.length===0?a.jsx(Y5,{children:a.jsxs(J5,{children:[a.jsx(Z5,{children:""}),a.jsx(e4,{children:"No hay muestras para esta OT"})]})}):a.jsx(Y5,{children:a.jsxs(fse,{children:[a.jsx("thead",{children:a.jsxs(Q5,{children:[a.jsx(qs,{style:{width:"60px"},children:"ID"}),a.jsx(qs,{style:{width:"90px"},children:"Estado"}),a.jsx(qs,{children:"CAD"}),a.jsx(qs,{children:"Cartn"}),a.jsx(qs,{children:"Sala Corte"}),a.jsx(qs,{style:{width:"80px"},children:"Cantidad"}),a.jsx(qs,{style:{width:"100px"},children:"Creado"}),a.jsx(qs,{children:"Creador"}),a.jsx(qs,{style:{width:"180px"},children:"Acciones"})]})}),a.jsx("tbody",{children:L.map(Z=>a.jsxs(Q5,{children:[a.jsxs(Ks,{children:[Z.prioritaria&&a.jsx(vse,{title:"Prioritaria",children:""}),a.jsx(pse,{children:Z.id})]}),a.jsx(Ks,{children:a.jsx(mse,{$estado:Z.estado,children:o7[Z.estado]||"Desconocido"})}),a.jsx(Ks,{children:a.jsx(ag,{title:Z.cad||"",children:Z.cad||"-"})}),a.jsx(Ks,{children:a.jsx(ag,{title:Z.carton||"",children:Z.carton||"-"})}),a.jsx(Ks,{children:a.jsx(ag,{title:Z.sala_corte||"",children:Z.sala_corte||"-"})}),a.jsx(Ks,{children:Z.cantidad_total}),a.jsx(Ks,{children:Z.created_at}),a.jsx(Ks,{children:a.jsx(ag,{title:Z.creador_nombre||"",children:Z.creador_nombre||"-"})}),a.jsx(Ks,{children:a.jsx(xse,{children:N(Z)})})]},Z.id))})]})}),i&&a.jsx(pb,{onClick:()=>s(!1),children:a.jsxs(mb,{onClick:Z=>Z.stopPropagation(),children:[a.jsx(gb,{children:"Rechazar Muestra"}),a.jsx(t4,{placeholder:"Motivo del rechazo (opcional)",value:m,onChange:Z=>_(Z.target.value)}),a.jsxs(xb,{children:[a.jsx(Id,{onClick:()=>s(!1),children:"Cancelar"}),a.jsx(Id,{$primary:!0,onClick:ie,disabled:T.isPending,children:T.isPending?"Rechazando...":"Rechazar"})]})]})}),o&&a.jsx(pb,{onClick:()=>l(!1),children:a.jsxs(mb,{onClick:Z=>Z.stopPropagation(),children:[a.jsx(gb,{children:"Devolver Muestra"}),a.jsx(t4,{placeholder:"Motivo de la devolucin (opcional)",value:m,onChange:Z=>_(Z.target.value)}),a.jsxs(xb,{children:[a.jsx(Id,{onClick:()=>l(!1),children:"Cancelar"}),a.jsx(Id,{$primary:!0,onClick:ne,disabled:w.isPending,children:w.isPending?"Devolviendo...":"Devolver"})]})]})}),c&&a.jsx(pb,{onClick:()=>u(!1),children:a.jsxs(mb,{onClick:Z=>Z.stopPropagation(),children:[a.jsx(gb,{children:"Asignar Sala de Corte"}),a.jsxs(_se,{value:g||"",onChange:Z=>v(Number(Z.target.value)||null),children:[a.jsx("option",{value:"",children:"Seleccionar sala..."}),(re=j==null?void 0:j.salas_corte)==null?void 0:re.map(Z=>a.jsx("option",{value:Z.id,children:Z.nombre},Z.id))]}),a.jsxs(xb,{children:[a.jsx(Id,{onClick:()=>u(!1),children:"Cancelar"}),a.jsx(Id,{$primary:!0,onClick:O,disabled:!g||A.isPending,children:A.isPending?"Asignando...":"Asignar"})]})]})})]})}const r4=p.div`
  padding: 1.5rem;
  max-width: 900px;
`,n4=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid ${d.colors.primary};
`,a4=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,i4=p.button`
  padding: 0.5rem 1.25rem;
  border: 1px solid ${d.colors.border};
  border-radius: 50px;
  background: white;
  color: ${d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,bse=p.form`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.5rem;
`,s4=p.div`
  margin-bottom: 1.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }
`,o4=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,l4=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;

  &:last-child {
    margin-bottom: 0;
  }
`,rn=p.div`
  display: flex;
  flex-direction: column;
`,nn=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
  margin-bottom: 0.375rem;
  text-transform: uppercase;
`,Ta=p.input`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }

  &:disabled {
    background: ${d.colors.bgLight};
    cursor: not-allowed;
  }
`,vb=p.select`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,jse=p.textarea`
  padding: 0.625rem 0.75rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 80px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Xh=p.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,Yh=p.input`
  width: 1rem;
  height: 1rem;
  cursor: pointer;
`,Qh=p.label`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
  cursor: pointer;
`,Jh=p.div`
  background: ${e=>e.$enabled?d.colors.primary+"08":d.colors.bgLight};
  border: 1px solid ${e=>e.$enabled?d.colors.primary+"40":d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  transition: all 0.2s;
`,Zh=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
`,ef=p.span`
  font-weight: 600;
  color: ${d.colors.textPrimary};
`,tf=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 0.75rem;
`,wse=p.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid ${d.colors.border};
`,c4=p.button`
  padding: 0.625rem 1.5rem;
  border: 1px solid ${e=>e.$primary?d.colors.primary:d.colors.border};
  border-radius: 4px;
  background: ${e=>e.$primary?d.colors.primary:"white"};
  color: ${e=>e.$primary?"white":d.colors.textSecondary};
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,kse=p.div`
  background: ${d.colors.danger}15;
  border: 1px solid ${d.colors.danger}40;
  border-radius: 4px;
  padding: 0.75rem;
  color: ${d.colors.danger};
  font-size: 0.875rem;
  margin-bottom: 1rem;
`,Sse=p.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Cse={work_order_id:0,sala_corte_id:void 0,cad_id:void 0,carton_id:void 0,observacion_muestra:"",vendedor_nombre:"",vendedor_direccion:"",vendedor_ciudad:"",vendedor_check:0,cantidad_vendedor:0,disenador_nombre:"",disenador_direccion:"",disenador_ciudad:"",disenador_check:0,cantidad_disenador:0,laboratorio_check:0,cantidad_laboratorio:0,cliente_check:0,cantidad_cliente:0,disenador_revision_nombre:"",disenador_revision_direccion:"",disenador_revision_check:0,cantidad_disenador_revision:0};function $se({otId:e,onNavigate:t,onSuccess:r}){var v,y,b;const n=Pr(),[i,s]=C.useState({...Cse,work_order_id:e}),[o,l]=C.useState(null),{data:c,isLoading:u}=Nt({queryKey:["muestras-options"],queryFn:()=>vr.getOptions()}),h=jt({mutationFn:x=>vr.create(x),onSuccess:()=>{n.invalidateQueries({queryKey:["muestras",e]}),r?r():t("muestras-list",e)},onError:x=>{const j=x instanceof Error?x.message:"Error al crear la muestra";l(j)}}),f=C.useCallback((x,j)=>{s(S=>({...S,[x]:j}))},[]),m=C.useCallback((x,j)=>{s(S=>({...S,[x]:j?1:0}))},[]),_=C.useCallback(x=>{if(x.preventDefault(),l(null),(i.cantidad_vendedor||0)+(i.cantidad_disenador||0)+(i.cantidad_laboratorio||0)+(i.cantidad_cliente||0)+(i.cantidad_disenador_revision||0)===0){l("Debe especificar al menos una cantidad en algn destino");return}h.mutate(i)},[i,h]),g=C.useCallback(()=>{t("muestras-list",e)},[t,e]);return u?a.jsxs(r4,{children:[a.jsxs(n4,{children:[a.jsxs(a4,{children:["Nueva Muestra para OT #",e]}),a.jsx(i4,{onClick:g,children:"Cancelar"})]}),a.jsx(Sse,{children:"Cargando opciones..."})]}):a.jsxs(r4,{children:[a.jsxs(n4,{children:[a.jsxs(a4,{children:["Nueva Muestra para OT #",e]}),a.jsx(i4,{onClick:g,children:"Cancelar"})]}),a.jsxs(bse,{onSubmit:_,children:[o&&a.jsx(kse,{children:o}),a.jsxs(s4,{children:[a.jsx(o4,{children:"Informacin General"}),a.jsxs(l4,{children:[a.jsxs(rn,{children:[a.jsx(nn,{children:"Sala de Corte"}),a.jsxs(vb,{value:i.sala_corte_id||"",onChange:x=>f("sala_corte_id",x.target.value?Number(x.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(v=c==null?void 0:c.salas_corte)==null?void 0:v.map(x=>a.jsx("option",{value:x.id,children:x.nombre},x.id))]})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"CAD"}),a.jsxs(vb,{value:i.cad_id||"",onChange:x=>f("cad_id",x.target.value?Number(x.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(y=c==null?void 0:c.cads)==null?void 0:y.map(x=>a.jsx("option",{value:x.id,children:x.codigo},x.id))]})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Cartn"}),a.jsxs(vb,{value:i.carton_id||"",onChange:x=>f("carton_id",x.target.value?Number(x.target.value):void 0),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),(b=c==null?void 0:c.cartones)==null?void 0:b.map(x=>a.jsx("option",{value:x.id,children:x.codigo},x.id))]})]})]}),a.jsx(l4,{children:a.jsxs(rn,{style:{gridColumn:"1 / -1"},children:[a.jsx(nn,{children:"Observacin"}),a.jsx(jse,{value:i.observacion_muestra||"",onChange:x=>f("observacion_muestra",x.target.value),placeholder:"Observaciones generales de la muestra..."})]})})]}),a.jsxs(s4,{children:[a.jsx(o4,{children:"Destinos de Muestras"}),a.jsxs(Jh,{$enabled:!!i.vendedor_check,style:{marginBottom:"1rem"},children:[a.jsx(Zh,{children:a.jsxs(Xh,{children:[a.jsx(Yh,{type:"checkbox",id:"vendedor_check",checked:!!i.vendedor_check,onChange:x=>m("vendedor_check",x.target.checked)}),a.jsx(Qh,{htmlFor:"vendedor_check",children:a.jsx(ef,{children:"Vendedor"})})]})}),i.vendedor_check?a.jsxs(tf,{children:[a.jsxs(rn,{children:[a.jsx(nn,{children:"Nombre"}),a.jsx(Ta,{value:i.vendedor_nombre||"",onChange:x=>f("vendedor_nombre",x.target.value),placeholder:"Nombre del vendedor"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Direccin"}),a.jsx(Ta,{value:i.vendedor_direccion||"",onChange:x=>f("vendedor_direccion",x.target.value),placeholder:"Direccin"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Ciudad"}),a.jsx(Ta,{value:i.vendedor_ciudad||"",onChange:x=>f("vendedor_ciudad",x.target.value),placeholder:"Ciudad"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Cantidad"}),a.jsx(Ta,{type:"number",min:"0",value:i.cantidad_vendedor||"",onChange:x=>f("cantidad_vendedor",x.target.value?Number(x.target.value):0)})]})]}):null]}),a.jsxs(Jh,{$enabled:!!i.disenador_check,style:{marginBottom:"1rem"},children:[a.jsx(Zh,{children:a.jsxs(Xh,{children:[a.jsx(Yh,{type:"checkbox",id:"disenador_check",checked:!!i.disenador_check,onChange:x=>m("disenador_check",x.target.checked)}),a.jsx(Qh,{htmlFor:"disenador_check",children:a.jsx(ef,{children:"Diseador"})})]})}),i.disenador_check?a.jsxs(tf,{children:[a.jsxs(rn,{children:[a.jsx(nn,{children:"Nombre"}),a.jsx(Ta,{value:i.disenador_nombre||"",onChange:x=>f("disenador_nombre",x.target.value),placeholder:"Nombre del diseador"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Direccin"}),a.jsx(Ta,{value:i.disenador_direccion||"",onChange:x=>f("disenador_direccion",x.target.value),placeholder:"Direccin"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Ciudad"}),a.jsx(Ta,{value:i.disenador_ciudad||"",onChange:x=>f("disenador_ciudad",x.target.value),placeholder:"Ciudad"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Cantidad"}),a.jsx(Ta,{type:"number",min:"0",value:i.cantidad_disenador||"",onChange:x=>f("cantidad_disenador",x.target.value?Number(x.target.value):0)})]})]}):null]}),a.jsxs(Jh,{$enabled:!!i.laboratorio_check,style:{marginBottom:"1rem"},children:[a.jsx(Zh,{children:a.jsxs(Xh,{children:[a.jsx(Yh,{type:"checkbox",id:"laboratorio_check",checked:!!i.laboratorio_check,onChange:x=>m("laboratorio_check",x.target.checked)}),a.jsx(Qh,{htmlFor:"laboratorio_check",children:a.jsx(ef,{children:"Laboratorio"})})]})}),i.laboratorio_check?a.jsx(tf,{children:a.jsxs(rn,{children:[a.jsx(nn,{children:"Cantidad"}),a.jsx(Ta,{type:"number",min:"0",value:i.cantidad_laboratorio||"",onChange:x=>f("cantidad_laboratorio",x.target.value?Number(x.target.value):0)})]})}):null]}),a.jsxs(Jh,{$enabled:!!i.cliente_check,style:{marginBottom:"1rem"},children:[a.jsx(Zh,{children:a.jsxs(Xh,{children:[a.jsx(Yh,{type:"checkbox",id:"cliente_check",checked:!!i.cliente_check,onChange:x=>m("cliente_check",x.target.checked)}),a.jsx(Qh,{htmlFor:"cliente_check",children:a.jsx(ef,{children:"Cliente"})})]})}),i.cliente_check?a.jsx(tf,{children:a.jsxs(rn,{children:[a.jsx(nn,{children:"Cantidad"}),a.jsx(Ta,{type:"number",min:"0",value:i.cantidad_cliente||"",onChange:x=>f("cantidad_cliente",x.target.value?Number(x.target.value):0)})]})}):null]}),a.jsxs(Jh,{$enabled:!!i.disenador_revision_check,children:[a.jsx(Zh,{children:a.jsxs(Xh,{children:[a.jsx(Yh,{type:"checkbox",id:"disenador_revision_check",checked:!!i.disenador_revision_check,onChange:x=>m("disenador_revision_check",x.target.checked)}),a.jsx(Qh,{htmlFor:"disenador_revision_check",children:a.jsx(ef,{children:"Diseador Revisin"})})]})}),i.disenador_revision_check?a.jsxs(tf,{children:[a.jsxs(rn,{children:[a.jsx(nn,{children:"Nombre"}),a.jsx(Ta,{value:i.disenador_revision_nombre||"",onChange:x=>f("disenador_revision_nombre",x.target.value),placeholder:"Nombre del diseador revisor"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Direccin"}),a.jsx(Ta,{value:i.disenador_revision_direccion||"",onChange:x=>f("disenador_revision_direccion",x.target.value),placeholder:"Direccin"})]}),a.jsxs(rn,{children:[a.jsx(nn,{children:"Cantidad"}),a.jsx(Ta,{type:"number",min:"0",value:i.cantidad_disenador_revision||"",onChange:x=>f("cantidad_disenador_revision",x.target.value?Number(x.target.value):0)})]})]}):null]})]}),a.jsxs(wse,{children:[a.jsx(c4,{type:"button",onClick:g,children:"Cancelar"}),a.jsx(c4,{type:"submit",$primary:!0,disabled:h.isPending,children:h.isPending?"Creando...":"Crear Muestra"})]})]})]})}const Ese=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Tse=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,Ase=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Fse=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1rem;
`,Dse=p.div`
  margin-bottom: 2rem;
`,Pse=p.h2`
  font-size: 1.1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid ${d.colors.primary};
`,Mse=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  cursor: ${({$status:e})=>e==="available"?"pointer":"default"};
  transition: all 0.2s;
  opacity: ${({$status:e})=>e==="disabled"?.5:1};

  &:hover {
    ${({$status:e})=>e==="available"&&`
      border-color: ${d.colors.primary};
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    `}
  }
`,Ose=p.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.5rem;
`,Rse=p.h3`
  font-size: 0.95rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0;
`,Nse=p.span`
  font-size: 0.65rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  text-transform: uppercase;

  ${({$status:e})=>{switch(e){case"available":return`
          background: ${d.colors.success}20;
          color: ${d.colors.success};
        `;case"pending":return`
          background: ${d.colors.warning}20;
          color: ${d.colors.warning};
        `;case"disabled":return`
          background: ${d.colors.textSecondary}20;
          color: ${d.colors.textSecondary};
        `}}}
`,zse=p.p`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.4;
`,Ise=p.div`
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
`,d4=p.div`
  background: ${d.colors.primary}10;
  border: 1px solid ${d.colors.primary}30;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,u4=p.p`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin: 0;
  line-height: 1.5;
`,_b=[{name:"OTs y Gestion",reports:[{id:"active-ots-per-area",title:"OTs Activas por Usuario",description:"Visualiza la distribucion de OTs activas por usuario y area",icon:"",status:"available",route:"reporte-ots-activas"},{id:"completed-ots",title:"OTs Completadas",description:"Resumen de OTs completadas con metricas de tiempo",icon:"",status:"available",route:"reporte-ots-completadas"},{id:"completed-ots-dates",title:"OTs Completadas Entre Fechas",description:"Filtro avanzado de OTs completadas por rango de fechas",icon:"",status:"available",route:"reporte-ots-completadas-fechas"},{id:"gestion-ot-actives",title:"Gestion OTs Activas",description:"Dashboard de gestion de OTs en proceso",icon:"",status:"available",route:"reporte-gestion-ots-activas"},{id:"gestion-load-month",title:"Carga de OTs por Mes",description:"Analisis de carga de trabajo mensual",icon:"",status:"available",route:"reporte-carga-mensual"}]},{name:"Tiempos y Rendimiento",reports:[{id:"time-by-area",title:"Tiempo por Area",description:"Tiempo promedio de OTs por area mensual",icon:"",status:"available",route:"reporte-tiempo-area"},{id:"tiempo-disenador-externo",title:"Tiempo Disenador Externo",description:"Metricas de tiempo para disenadores externos",icon:"",status:"available",route:"reporte-tiempo-disenador-externo"},{id:"tiempo-primera-muestra",title:"Tiempo Primera Muestra",description:"Tiempo hasta la primera muestra por OT",icon:"",status:"available",route:"reporte-tiempo-primera-muestra"}]},{name:"Sala de Muestras",reports:[{id:"sala-muestra",title:"Sala de Muestra",description:"Estado y gestion de la sala de muestras",icon:"",status:"available",route:"reporte-sala-muestra"},{id:"indicador-sala-muestra",title:"Indicador Sala Muestra",description:"KPIs de la sala de muestras",icon:"",status:"available",route:"reporte-indicador-sala-muestra"},{id:"diseno-estructural-sala",title:"Diseno Estructural y Sala Muestra",description:"Relacion entre diseno y sala de muestras",icon:"",status:"available",route:"reporte-diseno-estructural-sala"},{id:"muestras",title:"Muestras",description:"Listado y estado de muestras",icon:"",status:"available",route:"reporte-muestras"}]},{name:"Rechazos y Anulaciones",reports:[{id:"anulaciones",title:"Anulaciones",description:"Registro de OTs anuladas con motivos y tendencias",icon:"",status:"available",route:"reporte-anulaciones"},{id:"rechazos-mes",title:"Rechazos por Mes",description:"Tendencia de rechazos mensual",icon:"",status:"available",route:"reporte-rechazos"},{id:"reasons-rejection",title:"Motivos de Rechazo",description:"Analisis de razones de rechazo por mes",icon:"",status:"available",route:"reporte-motivos-rechazo"}]}];function Lse({onNavigate:e}){const[t,r]=C.useState(null),n=l=>{l.status==="available"&&l.route?e(l.route):l.status==="pending"&&(r(l.id),setTimeout(()=>r(null),2e3))},i=l=>{switch(l){case"available":return"Disponible";case"pending":return"En desarrollo";case"disabled":return"Deshabilitado"}},s=_b.reduce((l,c)=>l+c.reports.length,0),o=_b.reduce((l,c)=>l+c.reports.filter(u=>u.status==="available").length,0);return a.jsxs(Ese,{children:[a.jsx(Tse,{onClick:()=>e("dashboard"),children:" Volver"}),a.jsxs(Ase,{children:["Reporteria (",o,"/",s," disponibles)"]}),a.jsx(d4,{children:a.jsx(u4,{children:'Los reportes estan siendo migrados desde el sistema Laravel. Cada reporte mostrara graficos interactivos con Chart.js y permitira filtrar por fechas, areas y usuarios. Los reportes marcados como "En desarrollo" estaran disponibles proximamente.'})}),t&&a.jsx(d4,{style:{background:`${d.colors.warning}10`,borderColor:`${d.colors.warning}30`},children:a.jsx(u4,{style:{color:d.colors.warning},children:"Este reporte esta en desarrollo. Estara disponible proximamente."})}),_b.map(l=>a.jsxs(Dse,{children:[a.jsx(Pse,{children:l.name}),a.jsx(Fse,{children:l.reports.map(c=>a.jsxs(Mse,{$status:c.status,onClick:()=>n(c),children:[a.jsx(Ise,{children:c.icon}),a.jsxs(Ose,{children:[a.jsx(Rse,{children:c.title}),a.jsx(Nse,{$status:c.status,children:i(c.status)})]}),a.jsx(zse,{children:c.description})]},c.id))})]},l.name))]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function wp(e){return e+.5|0}const bl=(e,t,r)=>Math.max(Math.min(e,r),t);function Bf(e){return bl(wp(e*2.55),0,255)}function Ml(e){return bl(wp(e*255),0,255)}function no(e){return bl(wp(e/2.55)/100,0,1)}function h4(e){return bl(wp(e*100),0,100)}const di={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Gw=[..."0123456789ABCDEF"],Bse=e=>Gw[e&15],Use=e=>Gw[(e&240)>>4]+Gw[e&15],ig=e=>(e&240)>>4===(e&15),Vse=e=>ig(e.r)&&ig(e.g)&&ig(e.b)&&ig(e.a);function Hse(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&di[e[1]]*17,g:255&di[e[2]]*17,b:255&di[e[3]]*17,a:t===5?di[e[4]]*17:255}:(t===7||t===9)&&(r={r:di[e[1]]<<4|di[e[2]],g:di[e[3]]<<4|di[e[4]],b:di[e[5]]<<4|di[e[6]],a:t===9?di[e[7]]<<4|di[e[8]]:255})),r}const Wse=(e,t)=>e<255?t(e):"";function Gse(e){var t=Vse(e)?Bse:Use;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Wse(e.a,t):void 0}const qse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function QM(e,t,r){const n=t*Math.min(r,1-r),i=(s,o=(s+e/30)%12)=>r-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function Kse(e,t,r){const n=(i,s=(i+e/60)%6)=>r-r*t*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function Xse(e,t,r){const n=QM(e,1,.5);let i;for(t+r>1&&(i=1/(t+r),t*=i,r*=i),i=0;i<3;i++)n[i]*=1-t-r,n[i]+=t;return n}function Yse(e,t,r,n,i){return e===i?(t-r)/n+(t<r?6:0):t===i?(r-e)/n+2:(e-t)/n+4}function sS(e){const r=e.r/255,n=e.g/255,i=e.b/255,s=Math.max(r,n,i),o=Math.min(r,n,i),l=(s+o)/2;let c,u,h;return s!==o&&(h=s-o,u=l>.5?h/(2-s-o):h/(s+o),c=Yse(r,n,i,h,s),c=c*60+.5),[c|0,u||0,l]}function oS(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(Ml)}function lS(e,t,r){return oS(QM,e,t,r)}function Qse(e,t,r){return oS(Xse,e,t,r)}function Jse(e,t,r){return oS(Kse,e,t,r)}function JM(e){return(e%360+360)%360}function Zse(e){const t=qse.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?Bf(+t[5]):Ml(+t[5]));const i=JM(+t[2]),s=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=Qse(i,s,o):t[1]==="hsv"?n=Jse(i,s,o):n=lS(i,s,o),{r:n[0],g:n[1],b:n[2],a:r}}function eoe(e,t){var r=sS(e);r[0]=JM(r[0]+t),r=lS(r),e.r=r[0],e.g=r[1],e.b=r[2]}function toe(e){if(!e)return;const t=sS(e),r=t[0],n=h4(t[1]),i=h4(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${i}%, ${no(e.a)})`:`hsl(${r}, ${n}%, ${i}%)`}const f4={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},p4={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function roe(){const e={},t=Object.keys(p4),r=Object.keys(f4);let n,i,s,o,l;for(n=0;n<t.length;n++){for(o=l=t[n],i=0;i<r.length;i++)s=r[i],l=l.replace(s,f4[s]);s=parseInt(p4[o],16),e[l]=[s>>16&255,s>>8&255,s&255]}return e}let sg;function noe(e){sg||(sg=roe(),sg.transparent=[0,0,0,0]);const t=sg[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const aoe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ioe(e){const t=aoe.exec(e);let r=255,n,i,s;if(t){if(t[7]!==n){const o=+t[7];r=t[8]?Bf(o):bl(o*255,0,255)}return n=+t[1],i=+t[3],s=+t[5],n=255&(t[2]?Bf(n):bl(n,0,255)),i=255&(t[4]?Bf(i):bl(i,0,255)),s=255&(t[6]?Bf(s):bl(s,0,255)),{r:n,g:i,b:s,a:r}}}function soe(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${no(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const yb=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Ld=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function ooe(e,t,r){const n=Ld(no(e.r)),i=Ld(no(e.g)),s=Ld(no(e.b));return{r:Ml(yb(n+r*(Ld(no(t.r))-n))),g:Ml(yb(i+r*(Ld(no(t.g))-i))),b:Ml(yb(s+r*(Ld(no(t.b))-s))),a:e.a+r*(t.a-e.a)}}function og(e,t,r){if(e){let n=sS(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=lS(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function ZM(e,t){return e&&Object.assign(t||{},e)}function m4(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Ml(e[3]))):(t=ZM(e,{r:0,g:0,b:0,a:1}),t.a=Ml(t.a)),t}function loe(e){return e.charAt(0)==="r"?ioe(e):Zse(e)}class G0{constructor(t){if(t instanceof G0)return t;const r=typeof t;let n;r==="object"?n=m4(t):r==="string"&&(n=Hse(t)||noe(t)||loe(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=ZM(this._rgb);return t&&(t.a=no(t.a)),t}set rgb(t){this._rgb=m4(t)}rgbString(){return this._valid?soe(this._rgb):void 0}hexString(){return this._valid?Gse(this._rgb):void 0}hslString(){return this._valid?toe(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,i=t.rgb;let s;const o=r===s?.5:r,l=2*o-1,c=n.a-i.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;s=1-u,n.r=255&u*n.r+s*i.r+.5,n.g=255&u*n.g+s*i.g+.5,n.b=255&u*n.b+s*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=ooe(this._rgb,t._rgb,r)),this}clone(){return new G0(this.rgb)}alpha(t){return this._rgb.a=Ml(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=wp(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return og(this._rgb,2,t),this}darken(t){return og(this._rgb,2,-t),this}saturate(t){return og(this._rgb,1,t),this}desaturate(t){return og(this._rgb,1,-t),this}rotate(t){return eoe(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Xs(){}const coe=(()=>{let e=0;return()=>e++})();function Ct(e){return e==null}function Dr(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function pt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function On(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function gs(e,t){return On(e)?e:t}function it(e,t){return typeof e>"u"?t:e}const doe=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,e6=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Ht(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function Dt(e,t,r,n){let i,s,o;if(Dr(e))for(s=e.length,i=0;i<s;i++)t.call(r,e[i],i);else if(pt(e))for(o=Object.keys(e),s=o.length,i=0;i<s;i++)t.call(r,e[o[i]],o[i])}function y1(e,t){let r,n,i,s;if(!e||!t||e.length!==t.length)return!1;for(r=0,n=e.length;r<n;++r)if(i=e[r],s=t[r],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function b1(e){if(Dr(e))return e.map(b1);if(pt(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let i=0;for(;i<n;++i)t[r[i]]=b1(e[r[i]]);return t}return e}function t6(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function uoe(e,t,r,n){if(!t6(e))return;const i=t[e],s=r[e];pt(i)&&pt(s)?q0(i,s,n):t[e]=b1(s)}function q0(e,t,r){const n=Dr(t)?t:[t],i=n.length;if(!pt(e))return e;r=r||{};const s=r.merger||uoe;let o;for(let l=0;l<i;++l){if(o=n[l],!pt(o))continue;const c=Object.keys(o);for(let u=0,h=c.length;u<h;++u)s(c[u],e,o,r)}return e}function c0(e,t){return q0(e,t,{merger:hoe})}function hoe(e,t,r){if(!t6(e))return;const n=t[e],i=r[e];pt(n)&&pt(i)?c0(n,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=b1(i))}const g4={"":e=>e,x:e=>e.x,y:e=>e.y};function foe(e){const t=e.split("."),r=[];let n="";for(const i of t)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function poe(e){const t=foe(e);return r=>{for(const n of t){if(n==="")break;r=r&&r[n]}return r}}function hd(e,t){return(g4[t]||(g4[t]=poe(t)))(e)}function cS(e){return e.charAt(0).toUpperCase()+e.slice(1)}const K0=e=>typeof e<"u",Bl=e=>typeof e=="function",x4=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function moe(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Pt=Math.PI,nr=2*Pt,goe=nr+Pt,j1=Number.POSITIVE_INFINITY,xoe=Pt/180,Lr=Pt/2,lc=Pt/4,v4=Pt*2/3,r6=Math.log10,Ds=Math.sign;function d0(e,t,r){return Math.abs(e-t)<r}function _4(e){const t=Math.round(e);e=d0(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(r6(e))),n=e/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function voe(e){const t=[],r=Math.sqrt(e);let n;for(n=1;n<r;n++)e%n===0&&(t.push(n),t.push(e/n));return r===(r|0)&&t.push(r),t.sort((i,s)=>i-s).pop(),t}function _oe(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function X0(e){return!_oe(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function yoe(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}function boe(e,t,r){let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n][r],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function ho(e){return e*(Pt/180)}function joe(e){return e*(180/Pt)}function y4(e){if(!On(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function n6(e,t){const r=t.x-e.x,n=t.y-e.y,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*Pt&&(s+=nr),{angle:s,distance:i}}function qw(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function woe(e,t){return(e-t+goe)%nr-Pt}function Pa(e){return(e%nr+nr)%nr}function Y0(e,t,r,n){const i=Pa(e),s=Pa(t),o=Pa(r),l=Pa(s-i),c=Pa(o-i),u=Pa(i-s),h=Pa(i-o);return i===s||i===o||n&&s===o||l>c&&u<h}function Tn(e,t,r){return Math.max(t,Math.min(r,e))}function koe(e){return Tn(e,-32768,32767)}function fo(e,t,r,n=1e-6){return e>=Math.min(t,r)-n&&e<=Math.max(t,r)+n}function dS(e,t,r){r=r||(o=>e[o]<t);let n=e.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,r(s)?i=s:n=s;return{lo:i,hi:n}}const Dc=(e,t,r,n)=>dS(e,r,n?i=>{const s=e[i][t];return s<r||s===r&&e[i+1][t]===r}:i=>e[i][t]<r),Soe=(e,t,r)=>dS(e,r,n=>e[n][t]>=r);function Coe(e,t,r){let n=0,i=e.length;for(;n<i&&e[n]<t;)n++;for(;i>n&&e[i-1]>r;)i--;return n>0||i<e.length?e.slice(n,i):e}const a6=["push","pop","shift","splice","unshift"];function $oe(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),a6.forEach(r=>{const n="_onData"+cS(r),i=e[r];Object.defineProperty(e,r,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return e._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...s)}),o}})})}function b4(e,t){const r=e._chartjs;if(!r)return;const n=r.listeners,i=n.indexOf(t);i!==-1&&n.splice(i,1),!(n.length>0)&&(a6.forEach(s=>{delete e[s]}),delete e._chartjs)}function i6(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const s6=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function o6(e,t){let r=[],n=!1;return function(...i){r=i,n||(n=!0,s6.call(window,()=>{n=!1,e.apply(t,r)}))}}function Eoe(e,t){let r;return function(...n){return t?(clearTimeout(r),r=setTimeout(e,t,n)):e.apply(this,n),t}}const uS=e=>e==="start"?"left":e==="end"?"right":"center",bn=(e,t,r)=>e==="start"?t:e==="end"?r:(t+r)/2,Toe=(e,t,r,n)=>e===(n?"left":"right")?r:e==="center"?(t+r)/2:t;function Aoe(e,t,r){const n=t.length;let i=0,s=n;if(e._sorted){const{iScale:o,vScale:l,_parsed:c}=e,u=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,h=o.axis,{min:f,max:m,minDefined:_,maxDefined:g}=o.getUserBounds();if(_){if(i=Math.min(Dc(c,h,f).lo,r?n:Dc(t,h,o.getPixelForValue(f)).lo),u){const v=c.slice(0,i+1).reverse().findIndex(y=>!Ct(y[l.axis]));i-=Math.max(0,v)}i=Tn(i,0,n-1)}if(g){let v=Math.max(Dc(c,o.axis,m,!0).hi+1,r?0:Dc(t,h,o.getPixelForValue(m),!0).hi+1);if(u){const y=c.slice(v-1).findIndex(b=>!Ct(b[l.axis]));v+=Math.max(0,y)}s=Tn(v,i,n)-i}else s=n-i}return{start:i,count:s}}function Foe(e){const{xScale:t,yScale:r,_scaleRanges:n}=e,i={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!n)return e._scaleRanges=i,!0;const s=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,i),s}const lg=e=>e===0||e===1,j4=(e,t,r)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*nr/r)),w4=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*nr/r)+1,u0={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Lr)+1,easeOutSine:e=>Math.sin(e*Lr),easeInOutSine:e=>-.5*(Math.cos(Pt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>lg(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>lg(e)?e:j4(e,.075,.3),easeOutElastic:e=>lg(e)?e:w4(e,.075,.3),easeInOutElastic(e){return lg(e)?e:e<.5?.5*j4(e*2,.1125,.45):.5+.5*w4(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-u0.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?u0.easeInBounce(e*2)*.5:u0.easeOutBounce(e*2-1)*.5+.5};function hS(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function k4(e){return hS(e)?e:new G0(e)}function bb(e){return hS(e)?e:new G0(e).saturate(.5).darken(.1).hexString()}const Doe=["x","y","borderWidth","radius","tension"],Poe=["color","borderColor","backgroundColor"];function Moe(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:Poe},numbers:{type:"number",properties:Doe}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Ooe(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const S4=new Map;function Roe(e,t){t=t||{};const r=e+JSON.stringify(t);let n=S4.get(r);return n||(n=new Intl.NumberFormat(e,t),S4.set(r,n)),n}function fS(e,t,r){return Roe(t,r).format(e)}const Noe={values(e){return Dr(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let i,s=e;if(r.length>1){const u=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(u<1e-4||u>1e15)&&(i="scientific"),s=zoe(e,r)}const o=r6(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),fS(e,n,c)}};function zoe(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var l6={formatters:Noe};function Ioe(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:l6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const fd=Object.create(null),Kw=Object.create(null);function h0(e,t){if(!t)return e;const r=t.split(".");for(let n=0,i=r.length;n<i;++n){const s=r[n];e=e[s]||(e[s]=Object.create(null))}return e}function jb(e,t,r){return typeof t=="string"?q0(h0(e,t),r):q0(h0(e,""),t)}class Loe{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>bb(i.backgroundColor),this.hoverBorderColor=(n,i)=>bb(i.borderColor),this.hoverColor=(n,i)=>bb(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return jb(this,t,r)}get(t){return h0(this,t)}describe(t,r){return jb(Kw,t,r)}override(t,r){return jb(fd,t,r)}route(t,r,n,i){const s=h0(this,t),o=h0(this,n),l="_"+r;Object.defineProperties(s,{[l]:{value:s[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],u=o[i];return pt(c)?Object.assign({},u,c):it(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(r=>r(this))}}var yr=new Loe({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Moe,Ooe,Ioe]);function Boe(e){return!e||Ct(e.size)||Ct(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function C4(e,t,r,n,i){let s=t[i];return s||(s=t[i]=e.measureText(i).width,r.push(i)),s>n&&(n=s),n}function cc(e,t,r){const n=e.currentDevicePixelRatio,i=r!==0?Math.max(r/2,.5):0;return Math.round((t-i)*n)/n+i}function $4(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Xw(e,t,r,n){c6(e,t,r,n,null)}function c6(e,t,r,n,i){let s,o,l,c,u,h,f,m;const _=t.pointStyle,g=t.rotation,v=t.radius;let y=(g||0)*xoe;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(r,n),e.rotate(y),e.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),e.restore();return}if(!(isNaN(v)||v<=0)){switch(e.beginPath(),_){default:i?e.ellipse(r,n,i/2,v,0,0,nr):e.arc(r,n,v,0,nr),e.closePath();break;case"triangle":h=i?i/2:v,e.moveTo(r+Math.sin(y)*h,n-Math.cos(y)*v),y+=v4,e.lineTo(r+Math.sin(y)*h,n-Math.cos(y)*v),y+=v4,e.lineTo(r+Math.sin(y)*h,n-Math.cos(y)*v),e.closePath();break;case"rectRounded":u=v*.516,c=v-u,o=Math.cos(y+lc)*c,f=Math.cos(y+lc)*(i?i/2-u:c),l=Math.sin(y+lc)*c,m=Math.sin(y+lc)*(i?i/2-u:c),e.arc(r-f,n-l,u,y-Pt,y-Lr),e.arc(r+m,n-o,u,y-Lr,y),e.arc(r+f,n+l,u,y,y+Lr),e.arc(r-m,n+o,u,y+Lr,y+Pt),e.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*v,h=i?i/2:c,e.rect(r-h,n-c,2*h,2*c);break}y+=lc;case"rectRot":f=Math.cos(y)*(i?i/2:v),o=Math.cos(y)*v,l=Math.sin(y)*v,m=Math.sin(y)*(i?i/2:v),e.moveTo(r-f,n-l),e.lineTo(r+m,n-o),e.lineTo(r+f,n+l),e.lineTo(r-m,n+o),e.closePath();break;case"crossRot":y+=lc;case"cross":f=Math.cos(y)*(i?i/2:v),o=Math.cos(y)*v,l=Math.sin(y)*v,m=Math.sin(y)*(i?i/2:v),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"star":f=Math.cos(y)*(i?i/2:v),o=Math.cos(y)*v,l=Math.sin(y)*v,m=Math.sin(y)*(i?i/2:v),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o),y+=lc,f=Math.cos(y)*(i?i/2:v),o=Math.cos(y)*v,l=Math.sin(y)*v,m=Math.sin(y)*(i?i/2:v),e.moveTo(r-f,n-l),e.lineTo(r+f,n+l),e.moveTo(r+m,n-o),e.lineTo(r-m,n+o);break;case"line":o=i?i/2:Math.cos(y)*v,l=Math.sin(y)*v,e.moveTo(r-o,n-l),e.lineTo(r+o,n+l);break;case"dash":e.moveTo(r,n),e.lineTo(r+Math.cos(y)*(i?i/2:v),n+Math.sin(y)*v);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Q0(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function uv(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function hv(e){e.restore()}function Uoe(e,t,r,n,i){if(!t)return e.lineTo(r.x,r.y);if(i==="middle"){const s=(t.x+r.x)/2;e.lineTo(s,t.y),e.lineTo(s,r.y)}else i==="after"!=!!n?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function Voe(e,t,r,n){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function Hoe(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Ct(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Woe(e,t,r,n,i){if(i.strikethrough||i.underline){const s=e.measureText(n),o=t-s.actualBoundingBoxLeft,l=t+s.actualBoundingBoxRight,c=r-s.actualBoundingBoxAscent,u=r+s.actualBoundingBoxDescent,h=i.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(o,h),e.lineTo(l,h),e.stroke()}}function Goe(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function J0(e,t,r,n,i,s={}){const o=Dr(t)?t:[t],l=s.strokeWidth>0&&s.strokeColor!=="";let c,u;for(e.save(),e.font=i.string,Hoe(e,s),c=0;c<o.length;++c)u=o[c],s.backdrop&&Goe(e,s.backdrop),l&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),Ct(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(u,r,n,s.maxWidth)),e.fillText(u,r,n,s.maxWidth),Woe(e,r,n,u,s),n+=Number(i.lineHeight);e.restore()}function w1(e,t){const{x:r,y:n,w:i,h:s,radius:o}=t;e.arc(r+o.topLeft,n+o.topLeft,o.topLeft,1.5*Pt,Pt,!0),e.lineTo(r,n+s-o.bottomLeft),e.arc(r+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,Pt,Lr,!0),e.lineTo(r+i-o.bottomRight,n+s),e.arc(r+i-o.bottomRight,n+s-o.bottomRight,o.bottomRight,Lr,0,!0),e.lineTo(r+i,n+o.topRight),e.arc(r+i-o.topRight,n+o.topRight,o.topRight,0,-Lr,!0),e.lineTo(r+o.topLeft,n)}const qoe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Koe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Xoe(e,t){const r=(""+e).match(qoe);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const Yoe=e=>+e||0;function pS(e,t){const r={},n=pt(t),i=n?Object.keys(t):t,s=pt(e)?n?o=>it(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of i)r[o]=Yoe(s(o));return r}function d6(e){return pS(e,{top:"y",right:"x",bottom:"y",left:"x"})}function _u(e){return pS(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Ti(e){const t=d6(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function An(e,t){e=e||{},t=t||yr.font;let r=it(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=it(e.style,t.style);n&&!(""+n).match(Koe)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:it(e.family,t.family),lineHeight:Xoe(it(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:it(e.weight,t.weight),string:""};return i.string=Boe(i),i}function cg(e,t,r,n){let i,s,o;for(i=0,s=e.length;i<s;++i)if(o=e[i],o!==void 0&&o!==void 0)return o}function Qoe(e,t,r){const{min:n,max:i}=e,s=e6(t,(i-n)/2),o=(l,c)=>r&&l===0?0:l+c;return{min:o(n,-Math.abs(s)),max:o(i,s)}}function kd(e,t){return Object.assign(Object.create(e),t)}function mS(e,t=[""],r,n,i=()=>e[0]){const s=r||e;typeof n>"u"&&(n=p6("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:n,_getTarget:i,override:l=>mS([l,...e],t,s,n)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return h6(l,c,()=>ile(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return T4(l).includes(c)},ownKeys(l){return T4(l)},set(l,c,u){const h=l._storage||(l._storage=i());return l[c]=h[c]=u,delete l._keys,!0}})}function Yu(e,t,r,n){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:u6(e,n),setContext:s=>Yu(e,s,r,n),override:s=>Yu(e.override(s),t,r,n)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete e[o],!0},get(s,o,l){return h6(s,o,()=>Zoe(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(s,o,l){return e[o]=l,delete s[o],!0}})}function u6(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:r,indexable:n,isScriptable:Bl(r)?r:()=>r,isIndexable:Bl(n)?n:()=>n}}const Joe=(e,t)=>e?e+cS(t):t,gS=(e,t)=>pt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function h6(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const n=r();return e[t]=n,n}function Zoe(e,t,r){const{_proxy:n,_context:i,_subProxy:s,_descriptors:o}=e;let l=n[t];return Bl(l)&&o.isScriptable(t)&&(l=ele(t,l,e,r)),Dr(l)&&l.length&&(l=tle(t,l,e,o.isIndexable)),gS(t,l)&&(l=Yu(l,i,s&&s[t],o)),l}function ele(e,t,r,n){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=r;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(s,o||n);return l.delete(e),gS(e,c)&&(c=xS(i._scopes,i,e,c)),c}function tle(e,t,r,n){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=r;if(typeof s.index<"u"&&n(e))return t[s.index%t.length];if(pt(t[0])){const c=t,u=i._scopes.filter(h=>h!==c);t=[];for(const h of c){const f=xS(u,i,e,h);t.push(Yu(f,s,o&&o[e],l))}}return t}function f6(e,t,r){return Bl(e)?e(t,r):e}const rle=(e,t)=>e===!0?t:typeof e=="string"?hd(t,e):void 0;function nle(e,t,r,n,i){for(const s of t){const o=rle(r,s);if(o){e.add(o);const l=f6(o._fallback,r,i);if(typeof l<"u"&&l!==r&&l!==n)return l}else if(o===!1&&typeof n<"u"&&r!==n)return null}return!1}function xS(e,t,r,n){const i=t._rootScopes,s=f6(t._fallback,r,n),o=[...e,...i],l=new Set;l.add(n);let c=E4(l,o,r,s||r,n);return c===null||typeof s<"u"&&s!==r&&(c=E4(l,o,s,c,n),c===null)?!1:mS(Array.from(l),[""],i,s,()=>ale(t,r,n))}function E4(e,t,r,n,i){for(;r;)r=nle(e,t,r,n,i);return r}function ale(e,t,r){const n=e._getTarget();t in n||(n[t]={});const i=n[t];return Dr(i)&&pt(r)?r:i||{}}function ile(e,t,r,n){let i;for(const s of t)if(i=p6(Joe(s,e),r),typeof i<"u")return gS(e,i)?xS(r,n,e,i):i}function p6(e,t){for(const r of t){if(!r)continue;const n=r[e];if(typeof n<"u")return n}}function T4(e){let t=e._keys;return t||(t=e._keys=sle(e._scopes)),t}function sle(e){const t=new Set;for(const r of e)for(const n of Object.keys(r).filter(i=>!i.startsWith("_")))t.add(n);return Array.from(t)}const ole=Number.EPSILON||1e-14,Qu=(e,t)=>t<e.length&&!e[t].skip&&e[t],m6=e=>e==="x"?"y":"x";function lle(e,t,r,n){const i=e.skip?t:e,s=t,o=r.skip?t:r,l=qw(s,i),c=qw(o,s);let u=l/(l+c),h=c/(l+c);u=isNaN(u)?0:u,h=isNaN(h)?0:h;const f=n*u,m=n*h;return{previous:{x:s.x-f*(o.x-i.x),y:s.y-f*(o.y-i.y)},next:{x:s.x+m*(o.x-i.x),y:s.y+m*(o.y-i.y)}}}function cle(e,t,r){const n=e.length;let i,s,o,l,c,u=Qu(e,0);for(let h=0;h<n-1;++h)if(c=u,u=Qu(e,h+1),!(!c||!u)){if(d0(t[h],0,ole)){r[h]=r[h+1]=0;continue}i=r[h]/t[h],s=r[h+1]/t[h],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),r[h]=i*o*t[h],r[h+1]=s*o*t[h])}}function dle(e,t,r="x"){const n=m6(r),i=e.length;let s,o,l,c=Qu(e,0);for(let u=0;u<i;++u){if(o=l,l=c,c=Qu(e,u+1),!l)continue;const h=l[r],f=l[n];o&&(s=(h-o[r])/3,l[`cp1${r}`]=h-s,l[`cp1${n}`]=f-s*t[u]),c&&(s=(c[r]-h)/3,l[`cp2${r}`]=h+s,l[`cp2${n}`]=f+s*t[u])}}function ule(e,t="x"){const r=m6(t),n=e.length,i=Array(n).fill(0),s=Array(n);let o,l,c,u=Qu(e,0);for(o=0;o<n;++o)if(l=c,c=u,u=Qu(e,o+1),!!c){if(u){const h=u[t]-c[t];i[o]=h!==0?(u[r]-c[r])/h:0}s[o]=l?u?Ds(i[o-1])!==Ds(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}cle(e,i,s),dle(e,s,t)}function dg(e,t,r){return Math.max(Math.min(e,r),t)}function hle(e,t){let r,n,i,s,o,l=Q0(e[0],t);for(r=0,n=e.length;r<n;++r)o=s,s=l,l=r<n-1&&Q0(e[r+1],t),s&&(i=e[r],o&&(i.cp1x=dg(i.cp1x,t.left,t.right),i.cp1y=dg(i.cp1y,t.top,t.bottom)),l&&(i.cp2x=dg(i.cp2x,t.left,t.right),i.cp2y=dg(i.cp2y,t.top,t.bottom)))}function fle(e,t,r,n,i){let s,o,l,c;if(t.spanGaps&&(e=e.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")ule(e,i);else{let u=n?e[e.length-1]:e[0];for(s=0,o=e.length;s<o;++s)l=e[s],c=lle(u,l,e[Math.min(s+1,o-(n?0:1))%o],t.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}t.capBezierPoints&&hle(e,r)}function vS(){return typeof window<"u"&&typeof document<"u"}function _S(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function k1(e,t,r){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[r])):n=e,n}const fv=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function ple(e,t){return fv(e).getPropertyValue(t)}const mle=["top","right","bottom","left"];function Yc(e,t,r){const n={};r=r?"-"+r:"";for(let i=0;i<4;i++){const s=mle[i];n[s]=parseFloat(e[t+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const gle=(e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot);function xle(e,t){const r=e.touches,n=r&&r.length?r[0]:e,{offsetX:i,offsetY:s}=n;let o=!1,l,c;if(gle(i,s,e.target))l=i,c=s;else{const u=t.getBoundingClientRect();l=n.clientX-u.left,c=n.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function jc(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:n}=t,i=fv(r),s=i.boxSizing==="border-box",o=Yc(i,"padding"),l=Yc(i,"border","width"),{x:c,y:u,box:h}=xle(e,r),f=o.left+(h&&l.left),m=o.top+(h&&l.top);let{width:_,height:g}=t;return s&&(_-=o.width+l.width,g-=o.height+l.height),{x:Math.round((c-f)/_*r.width/n),y:Math.round((u-m)/g*r.height/n)}}function vle(e,t,r){let n,i;if(t===void 0||r===void 0){const s=e&&_S(e);if(!s)t=e.clientWidth,r=e.clientHeight;else{const o=s.getBoundingClientRect(),l=fv(s),c=Yc(l,"border","width"),u=Yc(l,"padding");t=o.width-u.width-c.width,r=o.height-u.height-c.height,n=k1(l.maxWidth,s,"clientWidth"),i=k1(l.maxHeight,s,"clientHeight")}}return{width:t,height:r,maxWidth:n||j1,maxHeight:i||j1}}const jl=e=>Math.round(e*10)/10;function _le(e,t,r,n){const i=fv(e),s=Yc(i,"margin"),o=k1(i.maxWidth,e,"clientWidth")||j1,l=k1(i.maxHeight,e,"clientHeight")||j1,c=vle(e,t,r);let{width:u,height:h}=c;if(i.boxSizing==="content-box"){const m=Yc(i,"border","width"),_=Yc(i,"padding");u-=_.width+m.width,h-=_.height+m.height}return u=Math.max(0,u-s.width),h=Math.max(0,n?u/n:h-s.height),u=jl(Math.min(u,o,c.maxWidth)),h=jl(Math.min(h,l,c.maxHeight)),u&&!h&&(h=jl(u/2)),(t!==void 0||r!==void 0)&&n&&c.height&&h>c.height&&(h=c.height,u=jl(Math.floor(h*n))),{width:u,height:h}}function A4(e,t,r){const n=t||1,i=jl(e.height*n),s=jl(e.width*n);e.height=jl(e.height),e.width=jl(e.width);const o=e.canvas;return o.style&&(r||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||o.height!==i||o.width!==s?(e.currentDevicePixelRatio=n,o.height=i,o.width=s,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const yle=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};vS()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function F4(e,t){const r=ple(e,t),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function wc(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function ble(e,t,r,n){return{x:e.x+r*(t.x-e.x),y:n==="middle"?r<.5?e.y:t.y:n==="after"?r<1?e.y:t.y:r>0?t.y:e.y}}function jle(e,t,r,n){const i={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},o=wc(e,i,r),l=wc(i,s,r),c=wc(s,t,r),u=wc(o,l,r),h=wc(l,c,r);return wc(u,h,r)}const wle=function(e,t){return{x(r){return e+e+t-r},setWidth(r){t=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},kle=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function yu(e,t,r){return e?wle(t,r):kle()}function g6(e,t){let r,n;(t==="ltr"||t==="rtl")&&(r=e.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=n)}function x6(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function v6(e){return e==="angle"?{between:Y0,compare:woe,normalize:Pa}:{between:fo,compare:(t,r)=>t-r,normalize:t=>t}}function D4({start:e,end:t,count:r,loop:n,style:i}){return{start:e%r,end:t%r,loop:n&&(t-e+1)%r===0,style:i}}function Sle(e,t,r){const{property:n,start:i,end:s}=r,{between:o,normalize:l}=v6(n),c=t.length;let{start:u,end:h,loop:f}=e,m,_;if(f){for(u+=c,h+=c,m=0,_=c;m<_&&o(l(t[u%c][n]),i,s);++m)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:f,style:e.style}}function _6(e,t,r){if(!r)return[e];const{property:n,start:i,end:s}=r,o=t.length,{compare:l,between:c,normalize:u}=v6(n),{start:h,end:f,loop:m,style:_}=Sle(e,t,r),g=[];let v=!1,y=null,b,x,j;const S=()=>c(i,j,b)&&l(i,j)!==0,T=()=>l(s,b)===0||c(s,j,b),F=()=>v||S(),w=()=>!v||T();for(let P=h,M=h;P<=f;++P)x=t[P%o],!x.skip&&(b=u(x[n]),b!==j&&(v=c(b,i,s),y===null&&F()&&(y=l(b,i)===0?P:M),y!==null&&w()&&(g.push(D4({start:y,end:P,loop:m,count:o,style:_})),y=null),M=P,j=b));return y!==null&&g.push(D4({start:y,end:f,loop:m,count:o,style:_})),g}function y6(e,t){const r=[],n=e.segments;for(let i=0;i<n.length;i++){const s=_6(n[i],e.points,t);s.length&&r.push(...s)}return r}function Cle(e,t,r,n){let i=0,s=t-1;if(r&&!n)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,r&&(s+=i);s>i&&e[s%t].skip;)s--;return s%=t,{start:i,end:s}}function $le(e,t,r,n){const i=e.length,s=[];let o=t,l=e[t],c;for(c=t+1;c<=r;++c){const u=e[c%i];u.skip||u.stop?l.skip||(n=!1,s.push({start:t%i,end:(c-1)%i,loop:n}),t=o=u.stop?c:null):(o=c,l.skip&&(t=c)),l=u}return o!==null&&s.push({start:t%i,end:o%i,loop:n}),s}function Ele(e,t){const r=e.points,n=e.options.spanGaps,i=r.length;if(!i)return[];const s=!!e._loop,{start:o,end:l}=Cle(r,i,s,n);if(n===!0)return P4(e,[{start:o,end:l,loop:s}],r,t);const c=l<o?l+i:l,u=!!e._fullLoop&&o===0&&l===i-1;return P4(e,$le(r,o,c,u),r,t)}function P4(e,t,r,n){return!n||!n.setContext||!r?t:Tle(e,t,r,n)}function Tle(e,t,r,n){const i=e._chart.getContext(),s=M4(e.options),{_datasetIndex:o,options:{spanGaps:l}}=e,c=r.length,u=[];let h=s,f=t[0].start,m=f;function _(g,v,y,b){const x=l?-1:1;if(g!==v){for(g+=c;r[g%c].skip;)g-=x;for(;r[v%c].skip;)v+=x;g%c!==v%c&&(u.push({start:g%c,end:v%c,loop:y,style:b}),h=b,f=v%c)}}for(const g of t){f=l?f:g.start;let v=r[f%c],y;for(m=f+1;m<=g.end;m++){const b=r[m%c];y=M4(n.setContext(kd(i,{type:"segment",p0:v,p1:b,p0DataIndex:(m-1)%c,p1DataIndex:m%c,datasetIndex:o}))),Ale(y,h)&&_(f,m-1,g.loop,h),v=b,h=y}f<m-1&&_(f,m-1,g.loop,h)}return u}function M4(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Ale(e,t){if(!t)return!1;const r=[],n=function(i,s){return hS(s)?(r.includes(s)||r.push(s),r.indexOf(s)):s};return JSON.stringify(e,n)!==JSON.stringify(t,n)}function ug(e,t,r){return e.options.clip?e[r]:t[r]}function Fle(e,t){const{xScale:r,yScale:n}=e;return r&&n?{left:ug(r,t,"left"),right:ug(r,t,"right"),top:ug(n,t,"top"),bottom:ug(n,t,"bottom")}:t}function b6(e,t){const r=t._clip;if(r.disabled)return!1;const n=Fle(t,e.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?e.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?e.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Dle{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,r,n,i){const s=r.listeners[i],o=r.duration;s.forEach(l=>l({chart:t,initial:r.initial,numSteps:o,currentStep:Math.min(n-r.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=s6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let r=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,l=!1,c;for(;o>=0;--o)c=s[o],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(t),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,n,t,"progress")),s.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),r+=s.length}),this._lastDate=t,r===0&&(this._running=!1)}_getAnims(t){const r=this._charts;let n=r.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(t,n)),n}listen(t,r,n){this._getAnims(t).listeners[r].push(n)}add(t,r){!r||!r.length||this._getAnims(t).items.push(...r)}has(t){return this._getAnims(t).items.length>0}start(t){const r=this._charts.get(t);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const r=this._charts.get(t);return!(!r||!r.running||!r.items.length)}stop(t){const r=this._charts.get(t);if(!r||!r.items.length)return;const n=r.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();r.items=[],this._notify(t,r,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Qs=new Dle;const O4="transparent",Ple={boolean(e,t,r){return r>.5?t:e},color(e,t,r){const n=k4(e||O4),i=n.valid&&k4(t||O4);return i&&i.valid?i.mix(n,r).hexString():t},number(e,t,r){return e+(t-e)*r}};class Mle{constructor(t,r,n,i){const s=r[n];i=cg([t.to,i,s,t.from]);const o=cg([t.from,s,i]);this._active=!0,this._fn=t.fn||Ple[t.type||typeof o],this._easing=u0[t.easing]||u0.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=r,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,r,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=cg([t.to,r,i,t.from]),this._from=cg([t.from,i,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const r=t-this._start,n=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let c;if(this._active=s!==l&&(o||r<n),!this._active){this._target[i]=l,this._notify(!0);return}if(r<0){this._target[i]=s;return}c=r/n%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[i]=this._fn(s,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((r,n)=>{t.push({res:r,rej:n})})}_notify(t){const r=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][r]()}}class j6{constructor(t,r){this._chart=t,this._properties=new Map,this.configure(r)}configure(t){if(!pt(t))return;const r=Object.keys(yr.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!pt(s))return;const o={};for(const l of r)o[l]=s[l];(Dr(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!n.has(l))&&n.set(l,o)})})}_animateOptions(t,r){const n=r.options,i=Rle(t,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&Ole(t.options.$animations,n).then(()=>{t.options=n},()=>{}),s}_createAnimations(t,r){const n=this._properties,i=[],s=t.$animations||(t.$animations={}),o=Object.keys(r),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){i.push(...this._animateOptions(t,r));continue}const h=r[u];let f=s[u];const m=n.get(u);if(f)if(m&&f.active()){f.update(m,h,l);continue}else f.cancel();if(!m||!m.duration){t[u]=h;continue}s[u]=f=new Mle(m,t,u,h),i.push(f)}return i}update(t,r){if(this._properties.size===0){Object.assign(t,r);return}const n=this._createAnimations(t,r);if(n.length)return Qs.add(this._chart,n),!0}}function Ole(e,t){const r=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const s=e[n[i]];s&&s.active()&&r.push(s.wait())}return Promise.all(r)}function Rle(e,t){if(!t)return;let r=e.options;if(!r){e.options=t;return}return r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function R4(e,t){const r=e&&e.options||{},n=r.reverse,i=r.min===void 0?t:0,s=r.max===void 0?t:0;return{start:n?s:i,end:n?i:s}}function Nle(e,t,r){if(r===!1)return!1;const n=R4(e,r),i=R4(t,r);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function zle(e){let t,r,n,i;return pt(e)?(t=e.top,r=e.right,n=e.bottom,i=e.left):t=r=n=i=e,{top:t,right:r,bottom:n,left:i,disabled:e===!1}}function w6(e,t){const r=[],n=e._getSortedDatasetMetas(t);let i,s;for(i=0,s=n.length;i<s;++i)r.push(n[i].index);return r}function N4(e,t,r,n={}){const i=e.keys,s=n.mode==="single";let o,l,c,u;if(t===null)return;let h=!1;for(o=0,l=i.length;o<l;++o){if(c=+i[o],c===r){if(h=!0,n.all)continue;break}u=e.values[c],On(u)&&(s||t===0||Ds(t)===Ds(u))&&(t+=u)}return!h&&!n.all?0:t}function Ile(e,t){const{iScale:r,vScale:n}=t,i=r.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,h;for(c=0,u=o.length;c<u;++c)h=o[c],l[c]={[i]:h,[s]:e[h]};return l}function wb(e,t){const r=e&&e.options.stacked;return r||r===void 0&&t.stack!==void 0}function Lle(e,t,r){return`${e.id}.${t.id}.${r.stack||r.type}`}function Ble(e){const{min:t,max:r,minDefined:n,maxDefined:i}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}function Ule(e,t,r){const n=e[t]||(e[t]={});return n[r]||(n[r]={})}function z4(e,t,r,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const s=e[i.index];if(r&&s>0||!r&&s<0)return i.index}return null}function I4(e,t){const{chart:r,_cachedMeta:n}=e,i=r._stacks||(r._stacks={}),{iScale:s,vScale:o,index:l}=n,c=s.axis,u=o.axis,h=Lle(s,o,n),f=t.length;let m;for(let _=0;_<f;++_){const g=t[_],{[c]:v,[u]:y}=g,b=g._stacks||(g._stacks={});m=b[u]=Ule(i,h,v),m[l]=y,m._top=z4(m,o,!0,n.type),m._bottom=z4(m,o,!1,n.type);const x=m._visualValues||(m._visualValues={});x[l]=y}}function kb(e,t){const r=e.scales;return Object.keys(r).filter(n=>r[n].axis===t).shift()}function Vle(e,t){return kd(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Hle(e,t,r){return kd(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function rf(e,t){const r=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const i of t){const s=i._stacks;if(!s||s[n]===void 0||s[n][r]===void 0)return;delete s[n][r],s[n]._visualValues!==void 0&&s[n]._visualValues[r]!==void 0&&delete s[n]._visualValues[r]}}}const Sb=e=>e==="reset"||e==="none",L4=(e,t)=>t?e:Object.assign({},e),Wle=(e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:w6(r,!0),values:null};class Qc{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=wb(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&rf(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,r=this._cachedMeta,n=this.getDataset(),i=(f,m,_,g)=>f==="x"?m:f==="r"?g:_,s=r.xAxisID=it(n.xAxisID,kb(t,"x")),o=r.yAxisID=it(n.yAxisID,kb(t,"y")),l=r.rAxisID=it(n.rAxisID,kb(t,"r")),c=r.indexAxis,u=r.iAxisID=i(c,s,o,l),h=r.vAxisID=i(c,o,s,l);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(o),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&b4(this._data,this),t._stacked&&rf(t)}_dataCheck(){const t=this.getDataset(),r=t.data||(t.data=[]),n=this._data;if(pt(r)){const i=this._cachedMeta;this._data=Ile(r,i)}else if(n!==r){if(n){b4(n,this);const i=this._cachedMeta;rf(i),i._parsed=[]}r&&Object.isExtensible(r)&&$oe(r,this),this._syncList=[],this._data=r}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const r=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=r._stacked;r._stacked=wb(r.vScale,r),r.stack!==n.stack&&(i=!0,rf(r),r.stack=n.stack),this._resyncElements(t),(i||s!==r._stacked)&&(I4(this,r._parsed),r._stacked=wb(r.vScale,r))}configure(){const t=this.chart.config,r=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),r,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,r){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:o}=n,l=s.axis;let c=t===0&&r===i.length?!0:n._sorted,u=t>0&&n._parsed[t-1],h,f,m;if(this._parsing===!1)n._parsed=i,n._sorted=!0,m=i;else{Dr(i[t])?m=this.parseArrayData(n,i,t,r):pt(i[t])?m=this.parseObjectData(n,i,t,r):m=this.parsePrimitiveData(n,i,t,r);const _=()=>f[l]===null||u&&f[l]<u[l];for(h=0;h<r;++h)n._parsed[h+t]=f=m[h],c&&(_()&&(c=!1),u=f);n._sorted=c}o&&I4(this,m)}parsePrimitiveData(t,r,n,i){const{iScale:s,vScale:o}=t,l=s.axis,c=o.axis,u=s.getLabels(),h=s===o,f=new Array(i);let m,_,g;for(m=0,_=i;m<_;++m)g=m+n,f[m]={[l]:h||s.parse(u[g],g),[c]:o.parse(r[g],g)};return f}parseArrayData(t,r,n,i){const{xScale:s,yScale:o}=t,l=new Array(i);let c,u,h,f;for(c=0,u=i;c<u;++c)h=c+n,f=r[h],l[c]={x:s.parse(f[0],h),y:o.parse(f[1],h)};return l}parseObjectData(t,r,n,i){const{xScale:s,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(i);let h,f,m,_;for(h=0,f=i;h<f;++h)m=h+n,_=r[m],u[h]={x:s.parse(hd(_,l),m),y:o.parse(hd(_,c),m)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,n){const i=this.chart,s=this._cachedMeta,o=r[t.axis],l={keys:w6(i,!0),values:r._stacks[t.axis]._visualValues};return N4(l,o,s.index,{mode:n})}updateRangeFromParsed(t,r,n,i){const s=n[r.axis];let o=s===null?NaN:s;const l=i&&n._stacks[r.axis];i&&l&&(i.values=l,o=N4(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,r){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&t===n.iScale,o=i.length,l=this._getOtherScale(t),c=Wle(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=Ble(l);let m,_;function g(){_=i[m];const v=_[l.axis];return!On(_[t.axis])||h>v||f<v}for(m=0;m<o&&!(!g()&&(this.updateRangeFromParsed(u,t,_,c),s));++m);if(s){for(m=o-1;m>=0;--m)if(!g()){this.updateRangeFromParsed(u,t,_,c);break}}return u}getAllParsedValues(t){const r=this._cachedMeta._parsed,n=[];let i,s,o;for(i=0,s=r.length;i<s;++i)o=r[i][t.axis],On(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const r=this._cachedMeta,n=r.iScale,i=r.vScale,s=this.getParsed(t);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const r=this._cachedMeta;this.update(t||"default"),r._clip=zle(it(this.options.clip,Nle(r.xScale,r.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,r=this.chart,n=this._cachedMeta,i=n.data||[],s=r.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||i.length-l,u=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(t,s,l,c),h=l;h<l+c;++h){const f=i[h];f.hidden||(f.active&&u?o.push(f):f.draw(t,s))}for(h=0;h<o.length;++h)o[h].draw(t,s)}getStyle(t,r){const n=r?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,r,n){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];s=o.$context||(o.$context=Hle(this.getContext(),t,o)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=Vle(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",n){const i=r==="active",s=this._cachedDataOpts,o=t+"-"+r,l=s[o],c=this.enableOptionSharing&&K0(n);if(l)return L4(l,c);const u=this.chart.config,h=u.datasetElementScopeKeys(this._type,t),f=i?[`${t}Hover`,"hover",t,""]:[t,""],m=u.getOptionScopes(this.getDataset(),h),_=Object.keys(yr.elements[t]),g=()=>this.getContext(n,i,r),v=u.resolveNamedOptions(m,_,g,f);return v.$shared&&(v.$shared=c,s[o]=Object.freeze(L4(v,c))),v}_resolveAnimations(t,r,n){const i=this.chart,s=this._cachedDataOpts,o=`animation-${r}`,l=s[o];if(l)return l;let c;if(i.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,r),m=h.getOptionScopes(this.getDataset(),f);c=h.createResolver(m,this.getContext(t,n,r))}const u=new j6(i,c&&c.animations);return c&&c._cacheable&&(s[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||Sb(t)||this.chart._animationsDisabled}_getSharedOptions(t,r){const n=this.resolveDataElementOptions(t,r),i=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(r,s)||s!==i;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:o}}updateElement(t,r,n,i){Sb(i)?Object.assign(t,n):this._resolveAnimations(r,i).update(t,n)}updateSharedOptions(t,r,n){t&&!Sb(r)&&this._resolveAnimations(void 0,r).update(t,n)}_setStyle(t,r,n,i){t.active=i;const s=this.getStyle(r,i);this._resolveAnimations(r,n,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,r,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,r,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this._data,n=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const i=n.length,s=r.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,r,n=!0){const i=this._cachedMeta,s=i.data,o=t+r;let l;const c=u=>{for(u.length+=r,l=u.length-1;l>=o;l--)u[l]=u[l-r]};for(c(s),l=t;l<o;++l)s[l]=new this.dataElementType;this._parsing&&c(i._parsed),this.parse(t,r),n&&this.updateElements(s,t,r,"reset")}updateElements(t,r,n,i){}_removeElements(t,r){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,r);n._stacked&&rf(n,i)}n.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,n,i]=t;this[r](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){r&&this._sync(["_removeElements",t,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Le(Qc,"defaults",{}),Le(Qc,"datasetElementType",null),Le(Qc,"dataElementType",null);function Gle(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let n=[];for(let i=0,s=r.length;i<s;i++)n=n.concat(r[i].controller.getAllParsedValues(e));e._cache.$bar=i6(n.sort((i,s)=>i-s))}return e._cache.$bar}function qle(e){const t=e.iScale,r=Gle(t,e.type);let n=t._length,i,s,o,l;const c=()=>{o===32767||o===-32768||(K0(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(i=0,s=r.length;i<s;++i)o=t.getPixelForValue(r[i]),c();for(l=void 0,i=0,s=t.ticks.length;i<s;++i)o=t.getPixelForTick(i),c();return n}function Kle(e,t,r,n){const i=r.barThickness;let s,o;return Ct(i)?(s=t.min*r.categoryPercentage,o=r.barPercentage):(s=i*n,o=1),{chunk:s/n,ratio:o,start:t.pixels[e]-s/2}}function Xle(e,t,r,n){const i=t.pixels,s=i[e];let o=e>0?i[e-1]:null,l=e<i.length-1?i[e+1]:null;const c=r.categoryPercentage;o===null&&(o=s-(l===null?t.end-t.start:l-s)),l===null&&(l=s+s-o);const u=s-(s-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/n,ratio:r.barPercentage,start:u}}function Yle(e,t,r,n){const i=r.parse(e[0],n),s=r.parse(e[1],n),o=Math.min(i,s),l=Math.max(i,s);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[r.axis]=u,t._custom={barStart:c,barEnd:u,start:i,end:s,min:o,max:l}}function k6(e,t,r,n){return Dr(e)?Yle(e,t,r,n):t[r.axis]=r.parse(e,n),t}function B4(e,t,r,n){const i=e.iScale,s=e.vScale,o=i.getLabels(),l=i===s,c=[];let u,h,f,m;for(u=r,h=r+n;u<h;++u)m=t[u],f={},f[i.axis]=l||i.parse(o[u],u),c.push(k6(m,f,s,u));return c}function Cb(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Qle(e,t,r){return e!==0?Ds(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}function Jle(e){let t,r,n,i,s;return e.horizontal?(t=e.base>e.x,r="left",n="right"):(t=e.base<e.y,r="bottom",n="top"),t?(i="end",s="start"):(i="start",s="end"),{start:r,end:n,reverse:t,top:i,bottom:s}}function Zle(e,t,r,n){let i=t.borderSkipped;const s={};if(!i){e.borderSkipped=s;return}if(i===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:h}=Jle(e);i==="middle"&&r&&(e.enableBorderRadius=!0,(r._top||0)===n?i=u:(r._bottom||0)===n?i=h:(s[U4(h,o,l,c)]=!0,i=u)),s[U4(i,o,l,c)]=!0,e.borderSkipped=s}function U4(e,t,r,n){return n?(e=ece(e,t,r),e=V4(e,r,t)):e=V4(e,t,r),e}function ece(e,t,r){return e===t?r:e===r?t:e}function V4(e,t,r){return e==="start"?t:e==="end"?r:e}function tce(e,{inflateAmount:t},r){e.inflateAmount=t==="auto"?r===1?.33:0:t}class wx extends Qc{parsePrimitiveData(t,r,n,i){return B4(t,r,n,i)}parseArrayData(t,r,n,i){return B4(t,r,n,i)}parseObjectData(t,r,n,i){const{iScale:s,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=s.axis==="x"?l:c,h=o.axis==="x"?l:c,f=[];let m,_,g,v;for(m=n,_=n+i;m<_;++m)v=r[m],g={},g[s.axis]=s.parse(hd(v,u),m),f.push(k6(hd(v,h),g,o,m));return f}updateRangeFromParsed(t,r,n,i){super.updateRangeFromParsed(t,r,n,i);const s=n._custom;s&&r===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const r=this._cachedMeta,{iScale:n,vScale:i}=r,s=this.getParsed(t),o=s._custom,l=Cb(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,t)}updateElements(t,r,n,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),h=this._getRuler(),{sharedOptions:f,includeOptions:m}=this._getSharedOptions(r,i);for(let _=r;_<r+n;_++){const g=this.getParsed(_),v=s||Ct(g[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(_),y=this._calculateBarIndexPixels(_,h),b=(g._stacks||{})[l.axis],x={horizontal:u,base:v.base,enableBorderRadius:!b||Cb(g._custom)||o===b._top||o===b._bottom,x:u?v.head:y.center,y:u?y.center:v.head,height:u?y.size:Math.abs(v.size),width:u?Math.abs(v.size):y.size};m&&(x.options=f||this.resolveDataElementOptions(_,t[_].active?"active":i));const j=x.options||t[_].options;Zle(x,j,b,o),tce(x,j,h.ratio),this.updateElement(t[_],_,x,i)}}_getStacks(t,r){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),s=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(r),c=l&&l[n.axis],u=h=>{const f=h._parsed.find(_=>_[n.axis]===c),m=f&&f[h.vScale.axis];if(Ct(m)||isNaN(m))return!0};for(const h of i)if(!(r!==void 0&&u(h))&&((s===!1||o.indexOf(h.stack)===-1||s===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,r=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===r).shift()}_getAxis(){const t={},r=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[it(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,r)]=!0;return Object.keys(t)}_getStackIndex(t,r,n){const i=this._getStacks(t,n),s=r!==void 0?i.indexOf(r):-1;return s===-1?i.length-1:s}_getRuler(){const t=this.options,r=this._cachedMeta,n=r.iScale,i=[];let s,o;for(s=0,o=r.data.length;s<o;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const l=t.barThickness;return{min:l||qle(r),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:r,_stacked:n,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,c=this.getParsed(t),u=c._custom,h=Cb(u);let f=c[r.axis],m=0,_=n?this.applyStack(r,c,n):f,g,v;_!==f&&(m=_-f,_=f),h&&(f=u.barStart,_=u.barEnd-u.barStart,f!==0&&Ds(f)!==Ds(u.barEnd)&&(m=0),m+=f);const y=!Ct(s)&&!h?s:m;let b=r.getPixelForValue(y);if(this.chart.getDataVisibility(t)?g=r.getPixelForValue(m+_):g=b,v=g-b,Math.abs(v)<o){v=Qle(v,r,l)*o,f===l&&(b-=v/2);const x=r.getPixelForDecimal(0),j=r.getPixelForDecimal(1),S=Math.min(x,j),T=Math.max(x,j);b=Math.max(Math.min(b,T),S),g=b+v,n&&!h&&(c._stacks[r.axis]._visualValues[i]=r.getValueForPixel(g)-r.getValueForPixel(b))}if(b===r.getPixelForValue(l)){const x=Ds(v)*r.getLineWidthForValue(l)/2;b+=x,v-=x}return{size:v,base:b,head:g,center:g+v/2}}_calculateBarIndexPixels(t,r){const n=r.scale,i=this.options,s=i.skipNull,o=it(i.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(r.grouped){const h=s?this._getStackCount(t):r.stackCount,f=i.barThickness==="flex"?Xle(t,r,i,h*u):Kle(t,r,i,h*u),m=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,_=this._getAxis().indexOf(it(m,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0)+_;l=f.start+f.chunk*g+f.chunk/2,c=Math.min(o,f.chunk*f.ratio)}else l=n.getPixelForValue(this.getParsed(t)[n.axis],t),c=Math.min(o,r.min*r.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,r=t.vScale,n=t.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[r.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}Le(wx,"id","bar"),Le(wx,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Le(wx,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function rce(e,t,r){let n=1,i=1,s=0,o=0;if(t<nr){const l=e,c=l+t,u=Math.cos(l),h=Math.sin(l),f=Math.cos(c),m=Math.sin(c),_=(j,S,T)=>Y0(j,l,c,!0)?1:Math.max(S,S*r,T,T*r),g=(j,S,T)=>Y0(j,l,c,!0)?-1:Math.min(S,S*r,T,T*r),v=_(0,u,f),y=_(Lr,h,m),b=g(Pt,u,f),x=g(Pt+Lr,h,m);n=(v-b)/2,i=(y-x)/2,s=-(v+b)/2,o=-(y+x)/2}return{ratioX:n,ratioY:i,offsetX:s,offsetY:o}}class lu extends Qc{constructor(t,r){super(t,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,r){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let s=c=>+n[c];if(pt(n[t])){const{key:c="value"}=this._parsing;s=u=>+hd(n[u],c)}let o,l;for(o=t,l=t+r;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return ho(this.options.rotation-90)}_getCircumference(){return ho(this.options.circumference)}_getRotationExtents(){let t=nr,r=-nr;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),o=i._getCircumference();t=Math.min(t,s),r=Math.max(r,s+o)}return{rotation:t,circumference:r-t}}update(t){const r=this.chart,{chartArea:n}=r,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),c=Math.min(doe(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:h,rotation:f}=this._getRotationExtents(),{ratioX:m,ratioY:_,offsetX:g,offsetY:v}=rce(f,h,c),y=(n.width-o)/m,b=(n.height-o)/_,x=Math.max(Math.min(y,b)/2,0),j=e6(this.options.radius,x),S=Math.max(j*c,0),T=(j-S)/this._getVisibleDatasetWeightTotal();this.offsetX=g*j,this.offsetY=v*j,i.total=this.calculateTotal(),this.outerRadius=j-T*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-T*u,0),this.updateElements(s,0,s.length,t)}_circumference(t,r){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*s/nr)}updateElements(t,r,n,i){const s=i==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,h=(l.left+l.right)/2,f=(l.top+l.bottom)/2,m=s&&u.animateScale,_=m?0:this.innerRadius,g=m?0:this.outerRadius,{sharedOptions:v,includeOptions:y}=this._getSharedOptions(r,i);let b=this._getRotation(),x;for(x=0;x<r;++x)b+=this._circumference(x,s);for(x=r;x<r+n;++x){const j=this._circumference(x,s),S=t[x],T={x:h+this.offsetX,y:f+this.offsetY,startAngle:b,endAngle:b+j,circumference:j,outerRadius:g,innerRadius:_};y&&(T.options=v||this.resolveDataElementOptions(x,S.active?"active":i)),b+=j,this.updateElement(S,x,T,i)}}calculateTotal(){const t=this._cachedMeta,r=t.data;let n=0,i;for(i=0;i<r.length;i++){const s=t._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!r[i].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(t){const r=this._cachedMeta.total;return r>0&&!isNaN(t)?nr*(Math.abs(t)/r):0}getLabelAndValue(t){const r=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=fS(r._parsed[t],n.options.locale);return{label:i[t]||"",value:s}}getMaxBorderWidth(t){let r=0;const n=this.chart;let i,s,o,l,c;if(!t){for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),t=o.data,l=o.controller;break}}if(!t)return 0;for(i=0,s=t.length;i<s;++i)c=l.resolveDataElementOptions(i),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(t){let r=0;for(let n=0,i=t.length;n<i;++n){const s=this.resolveDataElementOptions(n);r=Math.max(r,s.offset||0,s.hoverOffset||0)}return r}_getRingWeightOffset(t){let r=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(t){return Math.max(it(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Le(lu,"id","doughnut"),Le(lu,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Le(lu,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Le(lu,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const r=t.data,{labels:{pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=t.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,u)=>{const f=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:f.backgroundColor,fontColor:s,hidden:!t.getDataVisibility(u),lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:f.borderWidth,strokeStyle:f.borderColor,textAlign:i,pointStyle:n,borderRadius:o&&(l||f.borderRadius),index:u}}):[]}},onClick(t,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}});class kx extends Qc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const r=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=r,o=this.chart._animationsDisabled;let{start:l,count:c}=Aoe(r,i,o);this._drawStart=l,this._drawCount=c,Foe(r)&&(l=0,c=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:u},t),this.updateElements(i,l,c,t)}updateElements(t,r,n,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:f}=this._getSharedOptions(r,i),m=o.axis,_=l.axis,{spanGaps:g,segment:v}=this.options,y=X0(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||i==="none",x=r+n,j=t.length;let S=r>0&&this.getParsed(r-1);for(let T=0;T<j;++T){const F=t[T],w=b?F:{};if(T<r||T>=x){w.skip=!0;continue}const P=this.getParsed(T),M=Ct(P[_]),A=w[m]=o.getPixelForValue(P[m],T),D=w[_]=s||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,P,c):P[_],T);w.skip=isNaN(A)||isNaN(D)||M,w.stop=T>0&&Math.abs(P[m]-S[m])>y,v&&(w.parsed=P,w.raw=u.data[T]),f&&(w.options=h||this.resolveDataElementOptions(T,F.active?"active":i)),b||this.updateElement(F,T,w,i),S=P}}getMaxOverflow(){const t=this._cachedMeta,r=t.dataset,n=r.options&&r.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Le(kx,"id","line"),Le(kx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Le(kx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Yw extends lu{}Le(Yw,"id","pie"),Le(Yw,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function dc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yS{constructor(t){Le(this,"options");this.options=t||{}}static override(t){Object.assign(yS.prototype,t)}init(){}formats(){return dc()}parse(){return dc()}format(){return dc()}add(){return dc()}diff(){return dc()}startOf(){return dc()}endOf(){return dc()}}var nce={_date:yS};function ace(e,t,r,n){const{controller:i,data:s,_sorted:o}=e,l=i._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&s.length){const u=l._reversePixels?Soe:Dc;if(n){if(i._sharedOptions){const h=s[0],f=typeof h.getRange=="function"&&h.getRange(t);if(f){const m=u(s,t,r-f),_=u(s,t,r+f);return{lo:m.lo,hi:_.hi}}}}else{const h=u(s,t,r);if(c){const{vScale:f}=i._cachedMeta,{_parsed:m}=e,_=m.slice(0,h.lo+1).reverse().findIndex(v=>!Ct(v[f.axis]));h.lo-=Math.max(0,_);const g=m.slice(h.hi).findIndex(v=>!Ct(v[f.axis]));h.hi+=Math.max(0,g)}return h}}return{lo:0,hi:s.length-1}}function pv(e,t,r,n,i){const s=e.getSortedVisibleDatasetMetas(),o=r[t];for(let l=0,c=s.length;l<c;++l){const{index:u,data:h}=s[l],{lo:f,hi:m}=ace(s[l],t,o,i);for(let _=f;_<=m;++_){const g=h[_];g.skip||n(g,u,_)}}}function ice(e){const t=e.indexOf("x")!==-1,r=e.indexOf("y")!==-1;return function(n,i){const s=t?Math.abs(n.x-i.x):0,o=r?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function $b(e,t,r,n,i){const s=[];return!i&&!e.isPointInArea(t)||pv(e,r,t,function(l,c,u){!i&&!Q0(l,e.chartArea,0)||l.inRange(t.x,t.y,n)&&s.push({element:l,datasetIndex:c,index:u})},!0),s}function sce(e,t,r,n){let i=[];function s(o,l,c){const{startAngle:u,endAngle:h}=o.getProps(["startAngle","endAngle"],n),{angle:f}=n6(o,{x:t.x,y:t.y});Y0(f,u,h)&&i.push({element:o,datasetIndex:l,index:c})}return pv(e,r,t,s),i}function oce(e,t,r,n,i,s){let o=[];const l=ice(r);let c=Number.POSITIVE_INFINITY;function u(h,f,m){const _=h.inRange(t.x,t.y,i);if(n&&!_)return;const g=h.getCenterPoint(i);if(!(!!s||e.isPointInArea(g))&&!_)return;const y=l(t,g);y<c?(o=[{element:h,datasetIndex:f,index:m}],c=y):y===c&&o.push({element:h,datasetIndex:f,index:m})}return pv(e,r,t,u),o}function Eb(e,t,r,n,i,s){return!s&&!e.isPointInArea(t)?[]:r==="r"&&!n?sce(e,t,r,i):oce(e,t,r,n,i,s)}function H4(e,t,r,n,i){const s=[],o=r==="x"?"inXRange":"inYRange";let l=!1;return pv(e,r,t,(c,u,h)=>{c[o]&&c[o](t[r],i)&&(s.push({element:c,datasetIndex:u,index:h}),l=l||c.inRange(t.x,t.y,i))}),n&&!l?[]:s}var lce={modes:{index(e,t,r,n){const i=jc(t,e),s=r.axis||"x",o=r.includeInvisible||!1,l=r.intersect?$b(e,i,s,n,o):Eb(e,i,s,!1,n,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const h=l[0].index,f=u.data[h];f&&!f.skip&&c.push({element:f,datasetIndex:u.index,index:h})}),c):[]},dataset(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;let l=r.intersect?$b(e,i,s,n,o):Eb(e,i,s,!1,n,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let h=0;h<u.length;++h)l.push({element:u[h],datasetIndex:c,index:h})}return l},point(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;return $b(e,i,s,n,o)},nearest(e,t,r,n){const i=jc(t,e),s=r.axis||"xy",o=r.includeInvisible||!1;return Eb(e,i,s,r.intersect,n,o)},x(e,t,r,n){const i=jc(t,e);return H4(e,i,"x",r.intersect,n)},y(e,t,r,n){const i=jc(t,e);return H4(e,i,"y",r.intersect,n)}}};const S6=["left","top","right","bottom"];function nf(e,t){return e.filter(r=>r.pos===t)}function W4(e,t){return e.filter(r=>S6.indexOf(r.pos)===-1&&r.box.axis===t)}function af(e,t){return e.sort((r,n)=>{const i=t?n:r,s=t?r:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function cce(e){const t=[];let r,n,i,s,o,l;for(r=0,n=(e||[]).length;r<n;++r)i=e[r],{position:s,options:{stack:o,stackWeight:l=1}}=i,t.push({index:r,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return t}function dce(e){const t={};for(const r of e){const{stack:n,pos:i,stackWeight:s}=r;if(!n||!S6.includes(i))continue;const o=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return t}function uce(e,t){const r=dce(e),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let s,o,l;for(s=0,o=e.length;s<o;++s){l=e[s];const{fullSize:c}=l.box,u=r[l.stack],h=u&&l.stackWeight/u.weight;l.horizontal?(l.width=h?h*n:c&&t.availableWidth,l.height=i):(l.width=n,l.height=h?h*i:c&&t.availableHeight)}return r}function hce(e){const t=cce(e),r=af(t.filter(u=>u.box.fullSize),!0),n=af(nf(t,"left"),!0),i=af(nf(t,"right")),s=af(nf(t,"top"),!0),o=af(nf(t,"bottom")),l=W4(t,"x"),c=W4(t,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:i.concat(c).concat(o).concat(l),chartArea:nf(t,"chartArea"),vertical:n.concat(i).concat(c),horizontal:s.concat(o).concat(l)}}function G4(e,t,r,n){return Math.max(e[r],t[r])+Math.max(e[n],t[n])}function C6(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function fce(e,t,r,n){const{pos:i,box:s}=r,o=e.maxPadding;if(!pt(i)){r.size&&(e[i]-=r.size);const f=n[r.stack]||{size:0,count:1};f.size=Math.max(f.size,r.horizontal?s.height:s.width),r.size=f.size/f.count,e[i]+=r.size}s.getPadding&&C6(o,s.getPadding());const l=Math.max(0,t.outerWidth-G4(o,e,"left","right")),c=Math.max(0,t.outerHeight-G4(o,e,"top","bottom")),u=l!==e.w,h=c!==e.h;return e.w=l,e.h=c,r.horizontal?{same:u,other:h}:{same:h,other:u}}function pce(e){const t=e.maxPadding;function r(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}function mce(e,t){const r=t.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(t[o],r[o])}),s}return n(e?["left","right"]:["top","bottom"])}function Uf(e,t,r,n){const i=[];let s,o,l,c,u,h;for(s=0,o=e.length,u=0;s<o;++s){l=e[s],c=l.box,c.update(l.width||t.w,l.height||t.h,mce(l.horizontal,t));const{same:f,other:m}=fce(t,r,l,n);u|=f&&i.length,h=h||m,c.fullSize||i.push(l)}return u&&Uf(i,t,r,n)||h}function hg(e,t,r,n,i){e.top=r,e.left=t,e.right=t+n,e.bottom=r+i,e.width=n,e.height=i}function q4(e,t,r,n){const i=r.padding;let{x:s,y:o}=t;for(const l of e){const c=l.box,u=n[l.stack]||{placed:0,weight:1},h=l.stackWeight/u.weight||1;if(l.horizontal){const f=t.w*h,m=u.size||c.height;K0(u.start)&&(o=u.start),c.fullSize?hg(c,i.left,o,r.outerWidth-i.right-i.left,m):hg(c,t.left+u.placed,o,f,m),u.start=o,u.placed+=f,o=c.bottom}else{const f=t.h*h,m=u.size||c.width;K0(u.start)&&(s=u.start),c.fullSize?hg(c,s,i.top,m,r.outerHeight-i.bottom-i.top):hg(c,s,t.top+u.placed,m,f),u.start=s,u.placed+=f,s=c.right}}t.x=s,t.y=o}var ji={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;r!==-1&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,n){if(!e)return;const i=Ti(e.options.layout.padding),s=Math.max(t-i.width,0),o=Math.max(r-i.height,0),l=hce(e.boxes),c=l.vertical,u=l.horizontal;Dt(e.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const h=c.reduce((v,y)=>y.box.options&&y.box.options.display===!1?v:v+1,0)||1,f=Object.freeze({outerWidth:t,outerHeight:r,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/h,hBoxMaxHeight:o/2}),m=Object.assign({},i);C6(m,Ti(n));const _=Object.assign({maxPadding:m,w:s,h:o,x:i.left,y:i.top},i),g=uce(c.concat(u),f);Uf(l.fullSize,_,f,g),Uf(c,_,f,g),Uf(u,_,f,g)&&Uf(c,_,f,g),pce(_),q4(l.leftAndTop,_,f,g),_.x+=_.w,_.y+=_.h,q4(l.rightAndBottom,_,f,g),e.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},Dt(l.chartArea,v=>{const y=v.box;Object.assign(y,e.chartArea),y.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class $6{acquireContext(t,r){}releaseContext(t){return!1}addEventListener(t,r,n){}removeEventListener(t,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,r,n,i){return r=Math.max(0,r||t.width),n=n||t.height,{width:r,height:Math.max(0,i?Math.floor(r/i):n)}}isAttached(t){return!0}updateConfig(t){}}class gce extends $6{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Sx="$chartjs",xce={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},K4=e=>e===null||e==="";function vce(e,t){const r=e.style,n=e.getAttribute("height"),i=e.getAttribute("width");if(e[Sx]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",K4(i)){const s=F4(e,"width");s!==void 0&&(e.width=s)}if(K4(n))if(e.style.height==="")e.height=e.width/(t||2);else{const s=F4(e,"height");s!==void 0&&(e.height=s)}return e}const E6=yle?{passive:!0}:!1;function _ce(e,t,r){e&&e.addEventListener(t,r,E6)}function yce(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,E6)}function bce(e,t){const r=xce[e.type]||e.type,{x:n,y:i}=jc(e,t);return{type:r,chart:t,native:e,x:n!==void 0?n:null,y:i!==void 0?i:null}}function S1(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function jce(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||S1(l.addedNodes,n),o=o&&!S1(l.removedNodes,n);o&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function wce(e,t,r){const n=e.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||S1(l.removedNodes,n),o=o&&!S1(l.addedNodes,n);o&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const Z0=new Map;let X4=0;function T6(){const e=window.devicePixelRatio;e!==X4&&(X4=e,Z0.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function kce(e,t){Z0.size||window.addEventListener("resize",T6),Z0.set(e,t)}function Sce(e){Z0.delete(e),Z0.size||window.removeEventListener("resize",T6)}function Cce(e,t,r){const n=e.canvas,i=n&&_S(n);if(!i)return;const s=o6((l,c)=>{const u=i.clientWidth;r(l,c),u<i.clientWidth&&r()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,h=c.contentRect.height;u===0&&h===0||s(u,h)});return o.observe(i),kce(e,s),o}function Tb(e,t,r){r&&r.disconnect(),t==="resize"&&Sce(e)}function $ce(e,t,r){const n=e.canvas,i=o6(s=>{e.ctx!==null&&r(bce(s,e))},e);return _ce(n,t,i),i}class Ece extends $6{acquireContext(t,r){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(vce(t,r),n):null}releaseContext(t){const r=t.canvas;if(!r[Sx])return!1;const n=r[Sx].initial;["height","width"].forEach(s=>{const o=n[s];Ct(o)?r.removeAttribute(s):r.setAttribute(s,o)});const i=n.style||{};return Object.keys(i).forEach(s=>{r.style[s]=i[s]}),r.width=r.width,delete r[Sx],!0}addEventListener(t,r,n){this.removeEventListener(t,r);const i=t.$proxies||(t.$proxies={}),o={attach:jce,detach:wce,resize:Cce}[r]||$ce;i[r]=o(t,r,n)}removeEventListener(t,r){const n=t.$proxies||(t.$proxies={}),i=n[r];if(!i)return;({attach:Tb,detach:Tb,resize:Tb}[r]||yce)(t,r,i),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,r,n,i){return _le(t,r,n,i)}isAttached(t){const r=t&&_S(t);return!!(r&&r.isConnected)}}function Tce(e){return!vS()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?gce:Ece}class rs{constructor(){Le(this,"x");Le(this,"y");Le(this,"active",!1);Le(this,"options");Le(this,"$animations")}tooltipPosition(t){const{x:r,y:n}=this.getProps(["x","y"],t);return{x:r,y:n}}hasValue(){return X0(this.x)&&X0(this.y)}getProps(t,r){const n=this.$animations;if(!r||!n)return this;const i={};return t.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}}Le(rs,"defaults",{}),Le(rs,"defaultRoutes");function Ace(e,t){const r=e.options.ticks,n=Fce(e),i=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?Pce(t):[],o=s.length,l=s[0],c=s[o-1],u=[];if(o>i)return Mce(t,u,s,o/i),u;const h=Dce(s,t,i);if(o>0){let f,m;const _=o>1?Math.round((c-l)/(o-1)):null;for(fg(t,u,h,Ct(_)?0:l-_,l),f=0,m=o-1;f<m;f++)fg(t,u,h,s[f],s[f+1]);return fg(t,u,h,c,Ct(_)?t.length:c+_),u}return fg(t,u,h),u}function Fce(e){const t=e.options.offset,r=e._tickSize(),n=e._length/r+(t?0:1),i=e._maxLength/r;return Math.floor(Math.min(n,i))}function Dce(e,t,r){const n=Oce(e),i=t.length/r;if(!n)return Math.max(i,1);const s=voe(n);for(let o=0,l=s.length-1;o<l;o++){const c=s[o];if(c>i)return c}return Math.max(i,1)}function Pce(e){const t=[];let r,n;for(r=0,n=e.length;r<n;r++)e[r].major&&t.push(r);return t}function Mce(e,t,r,n){let i=0,s=r[0],o;for(n=Math.ceil(n),o=0;o<e.length;o++)o===s&&(t.push(e[o]),i++,s=r[i*n])}function fg(e,t,r,n,i){const s=it(n,0),o=Math.min(it(i,e.length),e.length);let l=0,c,u,h;for(r=Math.ceil(r),i&&(c=i-n,r=c/Math.floor(c/r)),h=s;h<0;)l++,h=Math.round(s+l*r);for(u=Math.max(s,0);u<o;u++)u===h&&(t.push(e[u]),l++,h=Math.round(s+l*r))}function Oce(e){const t=e.length;let r,n;if(t<2)return!1;for(n=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==n)return!1;return n}const Rce=e=>e==="left"?"right":e==="right"?"left":e,Y4=(e,t,r)=>t==="top"||t==="left"?e[t]+r:e[t]-r,Q4=(e,t)=>Math.min(t||e,e);function J4(e,t){const r=[],n=e.length/t,i=e.length;let s=0;for(;s<i;s+=n)r.push(e[Math.floor(s)]);return r}function Nce(e,t,r){const n=e.ticks.length,i=Math.min(t,n-1),s=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(i),u;if(!(r&&(n===1?u=Math.max(c-s,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(i-1))/2,c+=i<t?u:-u,c<s-l||c>o+l)))return c}function zce(e,t){Dt(e,r=>{const n=r.gc,i=n.length/2;let s;if(i>t){for(s=0;s<i;++s)delete r.data[n[s]];n.splice(0,i)}})}function sf(e){return e.drawTicks?e.tickLength:0}function Z4(e,t){if(!e.display)return 0;const r=An(e.font,t),n=Ti(e.padding);return(Dr(e.text)?e.text.length:1)*r.lineHeight+n.height}function Ice(e,t){return kd(e,{scale:t,type:"scale"})}function Lce(e,t,r){return kd(e,{tick:r,index:t,type:"tick"})}function Bce(e,t,r){let n=uS(e);return(r&&t!=="right"||!r&&t==="right")&&(n=Rce(n)),n}function Uce(e,t,r,n){const{top:i,left:s,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:h}=c;let f=0,m,_,g;const v=o-i,y=l-s;if(e.isHorizontal()){if(_=bn(n,s,l),pt(r)){const b=Object.keys(r)[0],x=r[b];g=h[b].getPixelForValue(x)+v-t}else r==="center"?g=(u.bottom+u.top)/2+v-t:g=Y4(e,r,t);m=l-s}else{if(pt(r)){const b=Object.keys(r)[0],x=r[b];_=h[b].getPixelForValue(x)-y+t}else r==="center"?_=(u.left+u.right)/2-y+t:_=Y4(e,r,t);g=bn(n,o,i),f=r==="left"?-Lr:Lr}return{titleX:_,titleY:g,maxWidth:m,rotation:f}}class ch extends rs{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:n,_suggestedMax:i}=this;return t=gs(t,Number.POSITIVE_INFINITY),r=gs(r,Number.NEGATIVE_INFINITY),n=gs(n,Number.POSITIVE_INFINITY),i=gs(i,Number.NEGATIVE_INFINITY),{min:gs(t,n),max:gs(r,i),minDefined:On(t),maxDefined:On(r)}}getMinMax(t){let{min:r,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:r,max:n};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),i||(r=Math.min(r,o.min)),s||(n=Math.max(n,o.max));return r=s&&r>n?n:r,n=i&&r>n?r:n,{min:gs(r,gs(n,r)),max:gs(n,gs(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ht(this.options.beforeUpdate,[this])}update(t,r,n){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Qoe(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?J4(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Ace(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,t=!t),this._startPixel=r,this._endPixel=n,this._reversePixels=t,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ht(this.options.afterUpdate,[this])}beforeSetDimensions(){Ht(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ht(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Ht(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ht(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n],s.label=Ht(r.callback,[s.value,n,t],this)}afterTickToLabelConversion(){Ht(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ht(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,n=Q4(this.ticks.length,t.ticks.maxTicksLimit),i=r.minRotation||0,s=r.maxRotation;let o=i,l,c,u;if(!this._isVisible()||!r.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),f=h.widest.width,m=h.highest.height,_=Tn(this.chart.width-f,0,this.maxWidth);l=t.offset?this.maxWidth/n:_/(n-1),f+6>l&&(l=_/(n-(t.offset?.5:1)),c=this.maxHeight-sf(t.grid)-r.padding-Z4(t.title,this.chart.options.font),u=Math.sqrt(f*f+m*m),o=joe(Math.min(Math.asin(Tn((h.highest.height+6)/l,-1,1)),Math.asin(Tn(c/u,-1,1))-Math.asin(Tn(m/u,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Ht(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ht(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:n,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=Z4(i,r.options.font);if(l?(t.width=this.maxWidth,t.height=sf(s)+c):(t.height=this.maxHeight,t.width=sf(s)+c),n.display&&this.ticks.length){const{first:u,last:h,widest:f,highest:m}=this._getLabelSizes(),_=n.padding*2,g=ho(this.labelRotation),v=Math.cos(g),y=Math.sin(g);if(l){const b=n.mirror?0:y*f.width+v*m.height;t.height=Math.min(this.maxHeight,t.height+b+_)}else{const b=n.mirror?0:v*f.width+y*m.height;t.width=Math.min(this.maxWidth,t.width+b+_)}this._calculatePadding(u,h,y,v)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,n,i){const{ticks:{align:s,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,_=0;c?u?(m=i*t.width,_=n*r.height):(m=n*t.height,_=i*r.width):s==="start"?_=r.width:s==="end"?m=t.width:s!=="inner"&&(m=t.width/2,_=r.width/2),this.paddingLeft=Math.max((m-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((_-f+o)*this.width/(this.width-f),0)}else{let h=r.height/2,f=t.height/2;s==="start"?(h=0,f=t.height):s==="end"&&(h=r.height,f=0),this.paddingTop=h+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ht(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,n;for(r=0,n=t.length;r<n;r++)Ct(t[r].label)&&(t.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=J4(n,r)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,n){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],c=Math.floor(r/Q4(r,n));let u=0,h=0,f,m,_,g,v,y,b,x,j,S,T;for(f=0;f<r;f+=c){if(g=t[f].label,v=this._resolveTickFontOptions(f),i.font=y=v.string,b=s[y]=s[y]||{data:{},gc:[]},x=v.lineHeight,j=S=0,!Ct(g)&&!Dr(g))j=C4(i,b.data,b.gc,j,g),S=x;else if(Dr(g))for(m=0,_=g.length;m<_;++m)T=g[m],!Ct(T)&&!Dr(T)&&(j=C4(i,b.data,b.gc,j,T),S+=x);o.push(j),l.push(S),u=Math.max(j,u),h=Math.max(S,h)}zce(s,r);const F=o.indexOf(u),w=l.indexOf(h),P=M=>({width:o[M]||0,height:l[M]||0});return{first:P(0),last:P(r-1),widest:P(F),highest:P(w),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return koe(this._alignToPixels?cc(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const n=r[t];return n.$context||(n.$context=Lce(this.getContext(),t,n))}return this.$context||(this.$context=Ice(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=ho(this.labelRotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,l=s?s.widest.width+o:0,c=s?s.highest.height+o:0;return this.isHorizontal()?c*n>l*i?l/n:c/i:c*i<l*n?c/n:l/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,n=this.chart,i=this.options,{grid:s,position:o,border:l}=i,c=s.offset,u=this.isHorizontal(),f=this.ticks.length+(c?1:0),m=sf(s),_=[],g=l.setContext(this.getContext()),v=g.display?g.width:0,y=v/2,b=function(ae){return cc(n,ae,v)};let x,j,S,T,F,w,P,M,A,D,H,U;if(o==="top")x=b(this.bottom),w=this.bottom-m,M=x-y,D=b(t.top)+y,U=t.bottom;else if(o==="bottom")x=b(this.top),D=t.top,U=b(t.bottom)-y,w=x+y,M=this.top+m;else if(o==="left")x=b(this.right),F=this.right-m,P=x-y,A=b(t.left)+y,H=t.right;else if(o==="right")x=b(this.left),A=t.left,H=b(t.right)-y,F=x+y,P=this.left+m;else if(r==="x"){if(o==="center")x=b((t.top+t.bottom)/2+.5);else if(pt(o)){const ae=Object.keys(o)[0],le=o[ae];x=b(this.chart.scales[ae].getPixelForValue(le))}D=t.top,U=t.bottom,w=x+y,M=w+m}else if(r==="y"){if(o==="center")x=b((t.left+t.right)/2);else if(pt(o)){const ae=Object.keys(o)[0],le=o[ae];x=b(this.chart.scales[ae].getPixelForValue(le))}F=x-y,P=F-m,A=t.left,H=t.right}const W=it(i.ticks.maxTicksLimit,f),R=Math.max(1,Math.ceil(f/W));for(j=0;j<f;j+=R){const ae=this.getContext(j),le=s.setContext(ae),G=l.setContext(ae),z=le.lineWidth,ie=le.color,ne=G.dash||[],O=G.dashOffset,N=le.tickWidth,L=le.tickColor,K=le.tickBorderDash||[],re=le.tickBorderDashOffset;S=Nce(this,j,c),S!==void 0&&(T=cc(n,S,z),u?F=P=A=H=T:w=M=D=U=T,_.push({tx1:F,ty1:w,tx2:P,ty2:M,x1:A,y1:D,x2:H,y2:U,width:z,color:ie,borderDash:ne,borderDashOffset:O,tickWidth:N,tickColor:L,tickBorderDash:K,tickBorderDashOffset:re}))}return this._ticksLength=f,this._borderValue=x,_}_computeLabelItems(t){const r=this.axis,n=this.options,{position:i,ticks:s}=n,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:h,mirror:f}=s,m=sf(n.grid),_=m+h,g=f?-h:_,v=-ho(this.labelRotation),y=[];let b,x,j,S,T,F,w,P,M,A,D,H,U="middle";if(i==="top")F=this.bottom-g,w=this._getXAxisLabelAlignment();else if(i==="bottom")F=this.top+g,w=this._getXAxisLabelAlignment();else if(i==="left"){const R=this._getYAxisLabelAlignment(m);w=R.textAlign,T=R.x}else if(i==="right"){const R=this._getYAxisLabelAlignment(m);w=R.textAlign,T=R.x}else if(r==="x"){if(i==="center")F=(t.top+t.bottom)/2+_;else if(pt(i)){const R=Object.keys(i)[0],ae=i[R];F=this.chart.scales[R].getPixelForValue(ae)+_}w=this._getXAxisLabelAlignment()}else if(r==="y"){if(i==="center")T=(t.left+t.right)/2-_;else if(pt(i)){const R=Object.keys(i)[0],ae=i[R];T=this.chart.scales[R].getPixelForValue(ae)}w=this._getYAxisLabelAlignment(m).textAlign}r==="y"&&(c==="start"?U="top":c==="end"&&(U="bottom"));const W=this._getLabelSizes();for(b=0,x=l.length;b<x;++b){j=l[b],S=j.label;const R=s.setContext(this.getContext(b));P=this.getPixelForTick(b)+s.labelOffset,M=this._resolveTickFontOptions(b),A=M.lineHeight,D=Dr(S)?S.length:1;const ae=D/2,le=R.color,G=R.textStrokeColor,z=R.textStrokeWidth;let ie=w;o?(T=P,w==="inner"&&(b===x-1?ie=this.options.reverse?"left":"right":b===0?ie=this.options.reverse?"right":"left":ie="center"),i==="top"?u==="near"||v!==0?H=-D*A+A/2:u==="center"?H=-W.highest.height/2-ae*A+A:H=-W.highest.height+A/2:u==="near"||v!==0?H=A/2:u==="center"?H=W.highest.height/2-ae*A:H=W.highest.height-D*A,f&&(H*=-1),v!==0&&!R.showLabelBackdrop&&(T+=A/2*Math.sin(v))):(F=P,H=(1-D)*A/2);let ne;if(R.showLabelBackdrop){const O=Ti(R.backdropPadding),N=W.heights[b],L=W.widths[b];let K=H-O.top,re=0-O.left;switch(U){case"middle":K-=N/2;break;case"bottom":K-=N;break}switch(w){case"center":re-=L/2;break;case"right":re-=L;break;case"inner":b===x-1?re-=L:b>0&&(re-=L/2);break}ne={left:re,top:K,width:L+O.width,height:N+O.height,color:R.backdropColor}}y.push({label:S,font:M,textOffset:H,options:{rotation:v,color:le,strokeColor:G,strokeWidth:z,textAlign:ie,textBaseline:U,translation:[T,F],backdrop:ne}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-ho(this.labelRotation))return t==="top"?"left":"right";let i="center";return r.align==="start"?i="left":r.align==="end"?i="right":r.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=t+s,c=o.widest.width;let u,h;return r==="left"?i?(h=this.right+s,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h+=c)):(h=this.right-l,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h=this.left)):r==="right"?i?(h=this.left+s,n==="near"?u="right":n==="center"?(u="center",h-=c/2):(u="left",h-=c)):(h=this.left+l,n==="near"?u="left":n==="center"?(u="center",h+=c/2):(u="right",h=this.right)):u="right",{textAlign:u,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:n,top:i,width:s,height:o}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(n,i,s,o),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const i=this.ticks.findIndex(s=>s.value===t);return i>=0?r.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const r=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,o;const l=(c,u,h)=>{!h.width||!h.color||(n.save(),n.lineWidth=h.width,n.strokeStyle=h.color,n.setLineDash(h.borderDash||[]),n.lineDashOffset=h.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(r.display)for(s=0,o=i.length;s<o;++s){const c=i[s];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,h,f,m;this.isHorizontal()?(u=cc(t,this.left,o)-o/2,h=cc(t,this.right,l)+l/2,f=m=c):(f=cc(t,this.top,o)-o/2,m=cc(t,this.bottom,l)+l/2,u=h=c),r.save(),r.lineWidth=s.width,r.strokeStyle=s.color,r.beginPath(),r.moveTo(u,f),r.lineTo(h,m),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&uv(n,i);const s=this.getLabelItems(t);for(const o of s){const l=o.options,c=o.font,u=o.label,h=o.textOffset;J0(n,u,0,h,c,l)}i&&hv(n)}drawTitle(){const{ctx:t,options:{position:r,title:n,reverse:i}}=this;if(!n.display)return;const s=An(n.font),o=Ti(n.padding),l=n.align;let c=s.lineHeight/2;r==="bottom"||r==="center"||pt(r)?(c+=o.bottom,Dr(n.text)&&(c+=s.lineHeight*(n.text.length-1))):c+=o.top;const{titleX:u,titleY:h,maxWidth:f,rotation:m}=Uce(this,c,r,l);J0(t,n.text,0,0,s,{color:n.color,maxWidth:f,rotation:m,textAlign:Bce(l,r,i),textBaseline:"middle",translation:[u,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,n=it(t.grid&&t.grid.z,-1),i=it(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==ch.prototype.draw?[{z:r,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:r,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,o;for(s=0,o=r.length;s<o;++s){const l=r[s];l[n]===this.id&&(!t||l.type===t)&&i.push(l)}return i}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return An(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class pg{constructor(t,r,n){this.type=t,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const r=Object.getPrototypeOf(t);let n;Wce(r)&&(n=this.register(r));const i=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,Vce(t,o,n),this.override&&yr.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const r=this.items,n=t.id,i=this.scope;n in r&&delete r[n],i&&n in yr[i]&&(delete yr[i][n],this.override&&delete fd[n])}}function Vce(e,t,r){const n=q0(Object.create(null),[r?yr.get(r):{},yr.get(t),e.defaults]);yr.set(t,n),e.defaultRoutes&&Hce(t,e.defaultRoutes),e.descriptors&&yr.describe(t,e.descriptors)}function Hce(e,t){Object.keys(t).forEach(r=>{const n=r.split("."),i=n.pop(),s=[e].concat(n).join("."),o=t[r].split("."),l=o.pop(),c=o.join(".");yr.route(s,i,c,l)})}function Wce(e){return"id"in e&&"defaults"in e}class Gce{constructor(){this.controllers=new pg(Qc,"datasets",!0),this.elements=new pg(rs,"elements"),this.plugins=new pg(Object,"plugins"),this.scales=new pg(ch,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,r,n){[...r].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(t,s,i):Dt(i,o=>{const l=n||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,r,n){const i=cS(t);Ht(n["before"+i],[],n),r[t](n),Ht(n["after"+i],[],n)}_getRegistryForType(t){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(t))return n}return this.plugins}_get(t,r,n){const i=r.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var bs=new Gce;class qce{constructor(){this._init=void 0}notify(t,r,n,i){if(r==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const s=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(s,t,r,n);return r==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,r,n,i){i=i||{};for(const s of t){const o=s.plugin,l=o[n],c=[r,i,s.options];if(Ht(l,c,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Ct(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),r}_createDescriptors(t,r){const n=t&&t.config,i=it(n.options&&n.options.plugins,{}),s=Kce(n);return i===!1&&!r?[]:Yce(t,s,i,r)}_notifyStateChanges(t){const r=this._oldCache||[],n=this._cache,i=(s,o)=>s.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(i(r,n),t,"stop"),this._notify(i(n,r),t,"start")}}function Kce(e){const t={},r=[],n=Object.keys(bs.plugins.items);for(let s=0;s<n.length;s++)r.push(bs.getPlugin(n[s]));const i=e.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];r.indexOf(o)===-1&&(r.push(o),t[o.id]=!0)}return{plugins:r,localIds:t}}function Xce(e,t){return!t&&e===!1?null:e===!0?{}:e}function Yce(e,{plugins:t,localIds:r},n,i){const s=[],o=e.getContext();for(const l of t){const c=l.id,u=Xce(n[c],i);u!==null&&s.push({plugin:l,options:Qce(e.config,{plugin:l,local:r[c]},u,o)})}return s}function Qce(e,{plugin:t,local:r},n,i){const s=e.pluginScopeKeys(t),o=e.getOptionScopes(n,s);return r&&t.defaults&&o.push(t.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Qw(e,t){const r=yr.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function Jce(e,t){let r=e;return e==="_index_"?r=t:e==="_value_"&&(r=t==="x"?"y":"x"),r}function Zce(e,t){return e===t?"_index_":"_value_"}function eA(e){if(e==="x"||e==="y"||e==="r")return e}function ede(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Jw(e,...t){if(eA(e))return e;for(const r of t){const n=r.axis||ede(r.position)||e.length>1&&eA(e[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function tA(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function tde(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(n=>n.xAxisID===e||n.yAxisID===e);if(r.length)return tA(e,"x",r[0])||tA(e,"y",r[0])}return{}}function rde(e,t){const r=fd[e.type]||{scales:{}},n=t.scales||{},i=Qw(e.type,t),s=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!pt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=Jw(o,l,tde(o,e),yr.scales[l.type]),u=Zce(c,i),h=r.scales||{};s[o]=c0(Object.create(null),[{axis:c},l,h[c],h[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||Qw(l,t),h=(fd[l]||{}).scales||{};Object.keys(h).forEach(f=>{const m=Jce(f,c),_=o[m+"AxisID"]||m;s[_]=s[_]||Object.create(null),c0(s[_],[{axis:m},n[_],h[f]])})}),Object.keys(s).forEach(o=>{const l=s[o];c0(l,[yr.scales[l.type],yr.scale])}),s}function A6(e){const t=e.options||(e.options={});t.plugins=it(t.plugins,{}),t.scales=rde(e,t)}function F6(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function nde(e){return e=e||{},e.data=F6(e.data),A6(e),e}const rA=new Map,D6=new Set;function mg(e,t){let r=rA.get(e);return r||(r=t(),rA.set(e,r),D6.add(r)),r}const of=(e,t,r)=>{const n=hd(t,r);n!==void 0&&e.add(n)};class ade{constructor(t){this._config=nde(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=F6(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),A6(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return mg(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,r){return mg(`${t}.transition.${r}`,()=>[[`datasets.${t}.transitions.${r}`,`transitions.${r}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,r){return mg(`${t}-${r}`,()=>[[`datasets.${t}.elements.${r}`,`datasets.${t}`,`elements.${r}`,""]])}pluginScopeKeys(t){const r=t.id,n=this.type;return mg(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,r){const n=this._scopeCache;let i=n.get(t);return(!i||r)&&(i=new Map,n.set(t,i)),i}getOptionScopes(t,r,n){const{options:i,type:s}=this,o=this._cachedScopes(t,n),l=o.get(r);if(l)return l;const c=new Set;r.forEach(h=>{t&&(c.add(t),h.forEach(f=>of(c,t,f))),h.forEach(f=>of(c,i,f)),h.forEach(f=>of(c,fd[s]||{},f)),h.forEach(f=>of(c,yr,f)),h.forEach(f=>of(c,Kw,f))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),D6.has(r)&&o.set(r,u),u}chartOptionScopes(){const{options:t,type:r}=this;return[t,fd[r]||{},yr.datasets[r]||{},{type:r},yr,Kw]}resolveNamedOptions(t,r,n,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=nA(this._resolverCache,t,i);let c=o;if(sde(o,r)){s.$shared=!1,n=Bl(n)?n():n;const u=this.createResolver(t,n,l);c=Yu(o,n,u)}for(const u of r)s[u]=c[u];return s}createResolver(t,r,n=[""],i){const{resolver:s}=nA(this._resolverCache,t,n);return pt(r)?Yu(s,r,void 0,i):s}}function nA(e,t,r){let n=e.get(t);n||(n=new Map,e.set(t,n));const i=r.join();let s=n.get(i);return s||(s={resolver:mS(t,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},n.set(i,s)),s}const ide=e=>pt(e)&&Object.getOwnPropertyNames(e).some(t=>Bl(e[t]));function sde(e,t){const{isScriptable:r,isIndexable:n}=u6(e);for(const i of t){const s=r(i),o=n(i),l=(o||s)&&e[i];if(s&&(Bl(l)||ide(l))||o&&Dr(l))return!0}return!1}var ode="4.5.1";const lde=["top","bottom","left","right","chartArea"];function aA(e,t){return e==="top"||e==="bottom"||lde.indexOf(e)===-1&&t==="x"}function iA(e,t){return function(r,n){return r[e]===n[e]?r[t]-n[t]:r[e]-n[e]}}function sA(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),Ht(r&&r.onComplete,[e],t)}function cde(e){const t=e.chart,r=t.options.animation;Ht(r&&r.onProgress,[e],t)}function P6(e){return vS()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Cx={},oA=e=>{const t=P6(e);return Object.values(Cx).filter(r=>r.canvas===t).pop()};function dde(e,t,r){const n=Object.keys(e);for(const i of n){const s=+i;if(s>=t){const o=e[i];delete e[i],(r>0||s>t)&&(e[s+r]=o)}}}function ude(e,t,r,n){return!r||e.type==="mouseout"?null:n?t:e}var Zo;let en=(Zo=class{static register(...t){bs.add(...t),lA()}static unregister(...t){bs.remove(...t),lA()}constructor(t,r){const n=this.config=new ade(r),i=P6(t),s=oA(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Tce(i)),this.platform.updateConfig(n);const l=this.platform.acquireContext(i,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;if(this.id=coe(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new qce,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Eoe(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],Cx[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Qs.listen(this,"complete",sA),Qs.listen(this,"progress",cde),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:r},width:n,height:i,_aspectRatio:s}=this;return Ct(t)?r&&s?s:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return bs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():A4(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return $4(this.canvas,this.ctx),this}stop(){return Qs.stop(this),this}resize(t,r){Qs.running(this)?this._resizeBeforeDraw={width:t,height:r}:this._resize(t,r)}_resize(t,r){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,r,s),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,A4(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Ht(n.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Dt(r,(n,i)=>{n.id=i})}buildOrUpdateScales(){const t=this.options,r=t.scales,n=this.scales,i=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let s=[];r&&(s=s.concat(Object.keys(r).map(o=>{const l=r[o],c=Jw(o,l),u=c==="r",h=c==="x";return{options:l,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),Dt(s,o=>{const l=o.options,c=l.id,u=Jw(c,l),h=it(l.type,o.dtype);(l.position===void 0||aA(l.position,u)!==aA(o.dposition))&&(l.position=o.dposition),i[c]=!0;let f=null;if(c in n&&n[c].type===h)f=n[c];else{const m=bs.getScale(h);f=new m({id:c,type:h,ctx:this.ctx,chart:this}),n[f.id]=f}f.init(l,t)}),Dt(i,(o,l)=>{o||delete n[l]}),Dt(n,o=>{ji.configure(this,o,o.options),ji.addBox(this,o)})}_updateMetasets(){const t=this._metasets,r=this.data.datasets.length,n=t.length;if(t.sort((i,s)=>i.index-s.index),n>r){for(let i=r;i<n;++i)this._destroyDatasetMeta(i);t.splice(r,n-r)}this._sortedMetasets=t.slice(0).sort(iA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:r}}=this;t.length>r.length&&delete this._stacks,t.forEach((n,i)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const s=r[n];let o=this.getDatasetMeta(n);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=s.indexAxis||Qw(l,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const c=bs.getController(l),{datasetElementType:u,dataElementType:h}=yr.datasets[l];Object.assign(c,{dataElementType:bs.getElement(h),datasetElementType:u&&bs.getElement(u)}),o.controller=new c(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Dt(this.data.datasets,(t,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){const{controller:f}=this.getDatasetMeta(u),m=!i&&s.indexOf(f)===-1;f.buildOrUpdateElements(m),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||Dt(s,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(iA("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Dt(this.scales,t=>{ji.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!x4(r,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of r){const o=n==="_removeElements"?-s:s;dde(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=s=>new Set(t.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=n(0);for(let s=1;s<r;s++)if(!x4(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ji.update(this,this.width,this.height,t);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],Dt(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,Bl(t)?t({datasetIndex:r}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,r){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(r),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Qs.has(this)?this.attached&&!Qs.running(this)&&Qs.start(this):(this.draw(),sA({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(this.chartArea);for(this._drawDatasets();t<r.length;++t)r[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const r=this._sortedMetasets,n=[];let i,s;for(i=0,s=r.length;i<s;++i){const o=r[i];(!t||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)this._drawDataset(t[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const r=this.ctx,n={meta:t,index:t.index,cancelable:!0},i=b6(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&uv(r,i),t.controller.draw(),i&&hv(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return Q0(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,r,n,i){const s=lce.modes[r];return typeof s=="function"?s(this,t,n,i):[]}getDatasetMeta(t){const r=this.data.datasets[t],n=this._metasets;let i=n.filter(s=>s&&s._dataset===r).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:t,_dataset:r,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=kd(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const r=this.data.datasets[t];if(!r)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(t,r){const n=this.getDatasetMeta(t);n.hidden=!r}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,r,n){const i=n?"show":"hide",s=this.getDatasetMeta(t),o=s.controller._resolveAnimations(void 0,i);K0(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(s,{visible:n}),this.update(l=>l.datasetIndex===t?i:void 0))}hide(t,r){this._updateVisibility(t,r,!1)}show(t,r){this._updateVisibility(t,r,!0)}_destroyDatasetMeta(t){const r=this._metasets[t];r&&r.controller&&r.controller._destroy(),delete this._metasets[t]}_stop(){let t,r;for(this.stop(),Qs.remove(this),t=0,r=this.data.datasets.length;t<r;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:r}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),$4(t,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete Cx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,r=this.platform,n=(s,o)=>{r.addEventListener(this,s,o),t[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};Dt(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,r=this.platform,n=(c,u)=>{r.addEventListener(this,c,u),t[c]=u},i=(c,u)=>{t[c]&&(r.removeEventListener(this,c,u),delete t[c])},s=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",l)},r.isAttached(this.canvas)?l():o()}unbindEvents(){Dt(this._listeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._listeners={},Dt(this._responsiveListeners,(t,r)=>{this.platform.removeEventListener(this,r,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,r,n){const i=n?"set":"remove";let s,o,l,c;for(r==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const r=this._active||[],n=t.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!y1(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(t,r,n){return this._plugins.notify(this,t,r,n)}isPluginEnabled(t){return this._plugins._cache.filter(r=>r.plugin.id===t).length===1}_updateHoverStyles(t,r,n){const i=this.options.hover,s=(c,u)=>c.filter(h=>!u.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),o=s(r,t),l=n?t:s(t,r);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(t,r){const n={event:t,replay:r,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(t,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(t,r,n){const{_active:i=[],options:s}=this,o=r,l=this._getActiveElements(t,i,n,o),c=moe(t),u=ude(t,this._lastEvent,n,c);n&&(this._lastEvent=null,Ht(s.onHover,[t,l,this],this),c&&Ht(s.onClick,[t,l,this],this));const h=!y1(l,i);return(h||r)&&(this._active=l,this._updateHoverStyles(l,i,r)),this._lastEvent=u,h}_getActiveElements(t,r,n,i){if(t.type==="mouseout")return[];if(!n)return r;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}},Le(Zo,"defaults",yr),Le(Zo,"instances",Cx),Le(Zo,"overrides",fd),Le(Zo,"registry",bs),Le(Zo,"version",ode),Le(Zo,"getChart",oA),Zo);function lA(){return Dt(en.instances,e=>e._plugins.invalidate())}function hde(e,t,r){const{startAngle:n,x:i,y:s,outerRadius:o,innerRadius:l,options:c}=t,{borderWidth:u,borderJoinStyle:h}=c,f=Math.min(u/o,Pa(n-r));if(e.beginPath(),e.arc(i,s,o-u/2,n+f/2,r-f/2),l>0){const m=Math.min(u/l,Pa(n-r));e.arc(i,s,l+u/2,r-m/2,n+m/2,!0)}else{const m=Math.min(u/2,o*Pa(n-r));if(h==="round")e.arc(i,s,m,r-Pt/2,n+Pt/2,!0);else if(h==="bevel"){const _=2*m*m,g=-_*Math.cos(r+Pt/2)+i,v=-_*Math.sin(r+Pt/2)+s,y=_*Math.cos(n+Pt/2)+i,b=_*Math.sin(n+Pt/2)+s;e.lineTo(g,v),e.lineTo(y,b)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function fde(e,t,r){const{startAngle:n,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:c}=t;let u=i/l;e.beginPath(),e.arc(s,o,l,n-u,r+u),c>i?(u=i/c,e.arc(s,o,c,r+u,n-u,!0)):e.arc(s,o,i,r+Lr,n-Lr),e.closePath(),e.clip()}function pde(e){return pS(e,["outerStart","outerEnd","innerStart","innerEnd"])}function mde(e,t,r,n){const i=pde(e.options.borderRadius),s=(r-t)/2,o=Math.min(s,n*t/2),l=c=>{const u=(r-Math.min(s,c))*n/2;return Tn(c,0,Math.min(s,u))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Tn(i.innerStart,0,o),innerEnd:Tn(i.innerEnd,0,o)}}function Bd(e,t,r,n){return{x:r+e*Math.cos(t),y:n+e*Math.sin(t)}}function C1(e,t,r,n,i,s){const{x:o,y:l,startAngle:c,pixelMargin:u,innerRadius:h}=t,f=Math.max(t.outerRadius+n+r-u,0),m=h>0?h+n+r+u:0;let _=0;const g=i-c;if(n){const R=h>0?h-n:0,ae=f>0?f-n:0,le=(R+ae)/2,G=le!==0?g*le/(le+n):g;_=(g-G)/2}const v=Math.max(.001,g*f-r/Pt)/f,y=(g-v)/2,b=c+y+_,x=i-y-_,{outerStart:j,outerEnd:S,innerStart:T,innerEnd:F}=mde(t,m,f,x-b),w=f-j,P=f-S,M=b+j/w,A=x-S/P,D=m+T,H=m+F,U=b+T/D,W=x-F/H;if(e.beginPath(),s){const R=(M+A)/2;if(e.arc(o,l,f,M,R),e.arc(o,l,f,R,A),S>0){const z=Bd(P,A,o,l);e.arc(z.x,z.y,S,A,x+Lr)}const ae=Bd(H,x,o,l);if(e.lineTo(ae.x,ae.y),F>0){const z=Bd(H,W,o,l);e.arc(z.x,z.y,F,x+Lr,W+Math.PI)}const le=(x-F/m+(b+T/m))/2;if(e.arc(o,l,m,x-F/m,le,!0),e.arc(o,l,m,le,b+T/m,!0),T>0){const z=Bd(D,U,o,l);e.arc(z.x,z.y,T,U+Math.PI,b-Lr)}const G=Bd(w,b,o,l);if(e.lineTo(G.x,G.y),j>0){const z=Bd(w,M,o,l);e.arc(z.x,z.y,j,b-Lr,M)}}else{e.moveTo(o,l);const R=Math.cos(M)*f+o,ae=Math.sin(M)*f+l;e.lineTo(R,ae);const le=Math.cos(A)*f+o,G=Math.sin(A)*f+l;e.lineTo(le,G)}e.closePath()}function gde(e,t,r,n,i){const{fullCircles:s,startAngle:o,circumference:l}=t;let c=t.endAngle;if(s){C1(e,t,r,n,c,i);for(let u=0;u<s;++u)e.fill();isNaN(l)||(c=o+(l%nr||nr))}return C1(e,t,r,n,c,i),e.fill(),c}function xde(e,t,r,n,i){const{fullCircles:s,startAngle:o,circumference:l,options:c}=t,{borderWidth:u,borderJoinStyle:h,borderDash:f,borderDashOffset:m,borderRadius:_}=c,g=c.borderAlign==="inner";if(!u)return;e.setLineDash(f||[]),e.lineDashOffset=m,g?(e.lineWidth=u*2,e.lineJoin=h||"round"):(e.lineWidth=u,e.lineJoin=h||"bevel");let v=t.endAngle;if(s){C1(e,t,r,n,v,i);for(let y=0;y<s;++y)e.stroke();isNaN(l)||(v=o+(l%nr||nr))}g&&fde(e,t,v),c.selfJoin&&v-o>=Pt&&_===0&&h!=="miter"&&hde(e,t,v),s||(C1(e,t,r,n,v,i),e.stroke())}class ga extends rs{constructor(r){super();Le(this,"circumference");Le(this,"endAngle");Le(this,"fullCircles");Le(this,"innerRadius");Le(this,"outerRadius");Le(this,"pixelMargin");Le(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=n6(s,{x:r,y:n}),{startAngle:c,endAngle:u,innerRadius:h,outerRadius:f,circumference:m}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),_=(this.options.spacing+this.options.borderWidth)/2,g=it(m,u-c),v=Y0(o,c,u)&&c!==u,y=g>=nr||v,b=fo(l,h+_,f+_);return y&&b}getCenterPoint(r){const{x:n,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:u,spacing:h}=this.options,f=(s+o)/2,m=(l+c+h+u)/2;return{x:n+Math.cos(f)*m,y:i+Math.sin(f)*m}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:n,circumference:i}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>nr?Math.floor(i/nr):0,i===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const c=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(c)*s,Math.sin(c)*s);const u=1-Math.sin(Math.min(Pt,i||0)),h=s*u;r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,gde(r,this,h,o,l),xde(r,this,h,o,l),r.restore()}}Le(ga,"id","arc"),Le(ga,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Le(ga,"defaultRoutes",{backgroundColor:"backgroundColor"}),Le(ga,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});function M6(e,t,r=t){e.lineCap=it(r.borderCapStyle,t.borderCapStyle),e.setLineDash(it(r.borderDash,t.borderDash)),e.lineDashOffset=it(r.borderDashOffset,t.borderDashOffset),e.lineJoin=it(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=it(r.borderWidth,t.borderWidth),e.strokeStyle=it(r.borderColor,t.borderColor)}function vde(e,t,r){e.lineTo(r.x,r.y)}function _de(e){return e.stepped?Uoe:e.tension||e.cubicInterpolationMode==="monotone"?Voe:vde}function O6(e,t,r={}){const n=e.length,{start:i=0,end:s=n-1}=r,{start:o,end:l}=t,c=Math.max(i,o),u=Math.min(s,l),h=i<o&&s<o||i>l&&s>l;return{count:n,start:c,loop:t.loop,ilen:u<c&&!h?n+u-c:u-c}}function yde(e,t,r,n){const{points:i,options:s}=t,{count:o,start:l,loop:c,ilen:u}=O6(i,r,n),h=_de(s);let{move:f=!0,reverse:m}=n||{},_,g,v;for(_=0;_<=u;++_)g=i[(l+(m?u-_:_))%o],!g.skip&&(f?(e.moveTo(g.x,g.y),f=!1):h(e,v,g,m,s.stepped),v=g);return c&&(g=i[(l+(m?u:0))%o],h(e,v,g,m,s.stepped)),!!c}function bde(e,t,r,n){const i=t.points,{count:s,start:o,ilen:l}=O6(i,r,n),{move:c=!0,reverse:u}=n||{};let h=0,f=0,m,_,g,v,y,b;const x=S=>(o+(u?l-S:S))%s,j=()=>{v!==y&&(e.lineTo(h,y),e.lineTo(h,v),e.lineTo(h,b))};for(c&&(_=i[x(0)],e.moveTo(_.x,_.y)),m=0;m<=l;++m){if(_=i[x(m)],_.skip)continue;const S=_.x,T=_.y,F=S|0;F===g?(T<v?v=T:T>y&&(y=T),h=(f*h+S)/++f):(j(),e.lineTo(S,T),g=F,f=0,v=y=T),b=T}j()}function Zw(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!r?bde:yde}function jde(e){return e.stepped?ble:e.tension||e.cubicInterpolationMode==="monotone"?jle:wc}function wde(e,t,r,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,r,n)&&i.closePath()),M6(e,t.options),e.stroke(i)}function kde(e,t,r,n){const{segments:i,options:s}=t,o=Zw(t);for(const l of i)M6(e,s,l.style),e.beginPath(),o(e,t,l,{start:r,end:r+n-1})&&e.closePath(),e.stroke()}const Sde=typeof Path2D=="function";function Cde(e,t,r,n){Sde&&!t.options.segment?wde(e,t,r,n):kde(e,t,r,n)}class Br extends rs{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;fle(this._points,n,t,i,r),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ele(this,this.options.segment))}first(){const t=this.segments,r=this.points;return t.length&&r[t[0].start]}last(){const t=this.segments,r=this.points,n=t.length;return n&&r[t[n-1].end]}interpolate(t,r){const n=this.options,i=t[r],s=this.points,o=y6(this,{property:r,start:i,end:i});if(!o.length)return;const l=[],c=jde(n);let u,h;for(u=0,h=o.length;u<h;++u){const{start:f,end:m}=o[u],_=s[f],g=s[m];if(_===g){l.push(_);continue}const v=Math.abs((i-_[r])/(g[r]-_[r])),y=c(_,g,v,n.stepped);y[r]=t[r],l.push(y)}return l.length===1?l[0]:l}pathSegment(t,r,n){return Zw(this)(t,this,r,n)}path(t,r,n){const i=this.segments,s=Zw(this);let o=this._loop;r=r||0,n=n||this.points.length-r;for(const l of i)o&=s(t,this,l,{start:r,end:r+n-1});return!!o}draw(t,r,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),Cde(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Le(Br,"id","line"),Le(Br,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Le(Br,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Le(Br,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function cA(e,t,r,n){const i=e.options,{[r]:s}=e.getProps([r],n);return Math.abs(t-s)<i.radius+i.hitRadius}class Jn extends rs{constructor(r){super();Le(this,"parsed");Le(this,"skip");Le(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(r-o,2)+Math.pow(n-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(r,n){return cA(this,r,"x",n)}inYRange(r,n){return cA(this,r,"y",n)}getCenterPoint(r){const{x:n,y:i}=this.getProps(["x","y"],r);return{x:n,y:i}}size(r){r=r||this.options||{};let n=r.radius||0;n=Math.max(n,n&&r.hoverRadius||0);const i=n&&r.borderWidth||0;return(n+i)*2}draw(r,n){const i=this.options;this.skip||i.radius<.1||!Q0(this,n,this.size(i)/2)||(r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.fillStyle=i.backgroundColor,Xw(r,i,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}Le(Jn,"id","point"),Le(Jn,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Le(Jn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function R6(e,t){const{x:r,y:n,base:i,width:s,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,h,f;return e.horizontal?(f=o/2,l=Math.min(r,i),c=Math.max(r,i),u=n-f,h=n+f):(f=s/2,l=r-f,c=r+f,u=Math.min(n,i),h=Math.max(n,i)),{left:l,top:u,right:c,bottom:h}}function wl(e,t,r,n){return e?0:Tn(t,r,n)}function $de(e,t,r){const n=e.options.borderWidth,i=e.borderSkipped,s=d6(n);return{t:wl(i.top,s.top,0,r),r:wl(i.right,s.right,0,t),b:wl(i.bottom,s.bottom,0,r),l:wl(i.left,s.left,0,t)}}function Ede(e,t,r){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,s=_u(i),o=Math.min(t,r),l=e.borderSkipped,c=n||pt(i);return{topLeft:wl(!c||l.top||l.left,s.topLeft,0,o),topRight:wl(!c||l.top||l.right,s.topRight,0,o),bottomLeft:wl(!c||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:wl(!c||l.bottom||l.right,s.bottomRight,0,o)}}function Tde(e){const t=R6(e),r=t.right-t.left,n=t.bottom-t.top,i=$de(e,r/2,n/2),s=Ede(e,r/2,n/2);return{outer:{x:t.left,y:t.top,w:r,h:n,radius:s},inner:{x:t.left+i.l,y:t.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Ab(e,t,r,n){const i=t===null,s=r===null,l=e&&!(i&&s)&&R6(e,n);return l&&(i||fo(t,l.left,l.right))&&(s||fo(r,l.top,l.bottom))}function Ade(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function Fde(e,t){e.rect(t.x,t.y,t.w,t.h)}function Fb(e,t,r={}){const n=e.x!==r.x?-t:0,i=e.y!==r.y?-t:0,s=(e.x+e.w!==r.x+r.w?t:0)-n,o=(e.y+e.h!==r.y+r.h?t:0)-i;return{x:e.x+n,y:e.y+i,w:e.w+s,h:e.h+o,radius:e.radius}}class Zr extends rs{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:r,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:o}=Tde(this),l=Ade(o.radius)?w1:Fde;t.save(),(o.w!==s.w||o.h!==s.h)&&(t.beginPath(),l(t,Fb(o,r,s)),t.clip(),l(t,Fb(s,-r,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),l(t,Fb(s,r)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,r,n){return Ab(this,t,r,n)}inXRange(t,r){return Ab(this,t,null,r)}inYRange(t,r){return Ab(this,null,t,r)}getCenterPoint(t){const{x:r,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(r+i)/2:r,y:s?n:(n+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Le(Zr,"id","bar"),Le(Zr,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Le(Zr,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Dde(e,t,r){const n=e.segments,i=e.points,s=t.points,o=[];for(const l of n){let{start:c,end:u}=l;u=mv(c,u,i);const h=e2(r,i[c],i[u],l.loop);if(!t.segments){o.push({source:l,target:h,start:i[c],end:i[u]});continue}const f=y6(t,h);for(const m of f){const _=e2(r,s[m.start],s[m.end],m.loop),g=_6(l,i,_);for(const v of g)o.push({source:v,target:m,start:{[r]:dA(h,_,"start",Math.max)},end:{[r]:dA(h,_,"end",Math.min)}})}}return o}function e2(e,t,r,n){if(n)return;let i=t[e],s=r[e];return e==="angle"&&(i=Pa(i),s=Pa(s)),{property:e,start:i,end:s}}function Pde(e,t){const{x:r=null,y:n=null}=e||{},i=t.points,s=[];return t.segments.forEach(({start:o,end:l})=>{l=mv(o,l,i);const c=i[o],u=i[l];n!==null?(s.push({x:c.x,y:n}),s.push({x:u.x,y:n})):r!==null&&(s.push({x:r,y:c.y}),s.push({x:r,y:u.y}))}),s}function mv(e,t,r){for(;t>e;t--){const n=r[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function dA(e,t,r,n){return e&&t?n(e[r],t[r]):e?e[r]:t?t[r]:0}function N6(e,t){let r=[],n=!1;return Dr(e)?(n=!0,r=e):r=Pde(e,t),r.length?new Br({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function uA(e){return e&&e.fill!==!1}function Mde(e,t,r){let i=e[t].fill;const s=[t];let o;if(!r)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!On(i))return i;if(o=e[i],!o)return!1;if(o.visible)return i;s.push(i),i=o.fill}return!1}function Ode(e,t,r){const n=Ide(e);if(pt(n))return isNaN(n.value)?!1:n;let i=parseFloat(n);return On(i)&&Math.floor(i)===i?Rde(n[0],t,i,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Rde(e,t,r,n){return(e==="-"||e==="+")&&(r=t+r),r===t||r<0||r>=n?!1:r}function Nde(e,t){let r=null;return e==="start"?r=t.bottom:e==="end"?r=t.top:pt(e)?r=t.getPixelForValue(e.value):t.getBasePixel&&(r=t.getBasePixel()),r}function zde(e,t,r){let n;return e==="start"?n=r:e==="end"?n=t.options.reverse?t.min:t.max:pt(e)?n=e.value:n=t.getBaseValue(),n}function Ide(e){const t=e.options,r=t.fill;let n=it(r&&r.target,r);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function Lde(e){const{scale:t,index:r,line:n}=e,i=[],s=n.segments,o=n.points,l=Bde(t,r);l.push(N6({x:null,y:t.bottom},n));for(let c=0;c<s.length;c++){const u=s[c];for(let h=u.start;h<=u.end;h++)Ude(i,o[h],l)}return new Br({points:i,options:{}})}function Bde(e,t){const r=[],n=e.getMatchingVisibleMetas("line");for(let i=0;i<n.length;i++){const s=n[i];if(s.index===t)break;s.hidden||r.unshift(s.dataset)}return r}function Ude(e,t,r){const n=[];for(let i=0;i<r.length;i++){const s=r[i],{first:o,last:l,point:c}=Vde(s,t,"x");if(!(!c||o&&l)){if(o)n.unshift(c);else if(e.push(c),!l)break}}e.push(...n)}function Vde(e,t,r){const n=e.interpolate(t,r);if(!n)return{};const i=n[r],s=e.segments,o=e.points;let l=!1,c=!1;for(let u=0;u<s.length;u++){const h=s[u],f=o[h.start][r],m=o[h.end][r];if(fo(i,f,m)){l=i===f,c=i===m;break}}return{first:l,last:c,point:n}}class z6{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,r,n){const{x:i,y:s,radius:o}=this;return r=r||{start:0,end:nr},t.arc(i,s,o,r.end,r.start,!0),!n.bounds}interpolate(t){const{x:r,y:n,radius:i}=this,s=t.angle;return{x:r+Math.cos(s)*i,y:n+Math.sin(s)*i,angle:s}}}function Hde(e){const{chart:t,fill:r,line:n}=e;if(On(r))return Wde(t,r);if(r==="stack")return Lde(e);if(r==="shape")return!0;const i=Gde(e);return i instanceof z6?i:N6(i,n)}function Wde(e,t){const r=e.getDatasetMeta(t);return r&&e.isDatasetVisible(t)?r.dataset:null}function Gde(e){return(e.scale||{}).getPointPositionForValue?Kde(e):qde(e)}function qde(e){const{scale:t={},fill:r}=e,n=Nde(r,t);if(On(n)){const i=t.isHorizontal();return{x:i?n:null,y:i?null:n}}return null}function Kde(e){const{scale:t,fill:r}=e,n=t.options,i=t.getLabels().length,s=n.reverse?t.max:t.min,o=zde(r,t,s),l=[];if(n.grid.circular){const c=t.getPointPositionForValue(0,s);return new z6({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<i;++c)l.push(t.getPointPositionForValue(c,o));return l}function Db(e,t,r){const n=Hde(t),{chart:i,index:s,line:o,scale:l,axis:c}=t,u=o.options,h=u.fill,f=u.backgroundColor,{above:m=f,below:_=f}=h||{},g=i.getDatasetMeta(s),v=b6(i,g);n&&o.points.length&&(uv(e,r),Xde(e,{line:o,target:n,above:m,below:_,area:r,scale:l,axis:c,clip:v}),hv(e))}function Xde(e,t){const{line:r,target:n,above:i,below:s,area:o,scale:l,clip:c}=t,u=r._loop?"angle":t.axis;e.save();let h=s;s!==i&&(u==="x"?(hA(e,n,o.top),Pb(e,{line:r,target:n,color:i,scale:l,property:u,clip:c}),e.restore(),e.save(),hA(e,n,o.bottom)):u==="y"&&(fA(e,n,o.left),Pb(e,{line:r,target:n,color:s,scale:l,property:u,clip:c}),e.restore(),e.save(),fA(e,n,o.right),h=i)),Pb(e,{line:r,target:n,color:h,scale:l,property:u,clip:c}),e.restore()}function hA(e,t,r){const{segments:n,points:i}=t;let s=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=i[c],f=i[mv(c,u,i)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(h.x,r),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(f.x,r)}e.lineTo(t.first().x,r),e.closePath(),e.clip()}function fA(e,t,r){const{segments:n,points:i}=t;let s=!0,o=!1;e.beginPath();for(const l of n){const{start:c,end:u}=l,h=i[c],f=i[mv(c,u,i)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(r,h.y),e.lineTo(h.x,h.y)),o=!!t.pathSegment(e,l,{move:o}),o?e.closePath():e.lineTo(r,f.y)}e.lineTo(r,t.first().y),e.closePath(),e.clip()}function Pb(e,t){const{line:r,target:n,property:i,color:s,scale:o,clip:l}=t,c=Dde(r,n,i);for(const{source:u,target:h,start:f,end:m}of c){const{style:{backgroundColor:_=s}={}}=u,g=n!==!0;e.save(),e.fillStyle=_,Yde(e,o,l,g&&e2(i,f,m)),e.beginPath();const v=!!r.pathSegment(e,u);let y;if(g){v?e.closePath():pA(e,n,m,i);const b=!!n.pathSegment(e,h,{move:v,reverse:!0});y=v&&b,y||pA(e,n,f,i)}e.closePath(),e.fill(y?"evenodd":"nonzero"),e.restore()}}function Yde(e,t,r,n){const i=t.chart.chartArea,{property:s,start:o,end:l}=n||{};if(s==="x"||s==="y"){let c,u,h,f;s==="x"?(c=o,u=i.top,h=l,f=i.bottom):(c=i.left,u=o,h=i.right,f=l),e.beginPath(),r&&(c=Math.max(c,r.left),h=Math.min(h,r.right),u=Math.max(u,r.top),f=Math.min(f,r.bottom)),e.rect(c,u,h-c,f-u),e.clip()}}function pA(e,t,r,n){const i=t.interpolate(r,n);i&&e.lineTo(i.x,i.y)}var dh={id:"filler",afterDatasetsUpdate(e,t,r){const n=(e.data.datasets||[]).length,i=[];let s,o,l,c;for(o=0;o<n;++o)s=e.getDatasetMeta(o),l=s.dataset,c=null,l&&l.options&&l instanceof Br&&(c={visible:e.isDatasetVisible(o),index:o,fill:Ode(l,o,n),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:l}),s.$filler=c,i.push(c);for(o=0;o<n;++o)c=i[o],!(!c||c.fill===!1)&&(c.fill=Mde(i,o,r.propagate))},beforeDraw(e,t,r){const n=r.drawTime==="beforeDraw",i=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let o=i.length-1;o>=0;--o){const l=i[o].$filler;l&&(l.line.updateControlPoints(s,l.axis),n&&l.fill&&Db(e.ctx,l,s))}},beforeDatasetsDraw(e,t,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=e.getSortedVisibleDatasetMetas();for(let i=n.length-1;i>=0;--i){const s=n[i].$filler;uA(s)&&Db(e.ctx,s,e.chartArea)}},beforeDatasetDraw(e,t,r){const n=t.meta.$filler;!uA(n)||r.drawTime!=="beforeDatasetDraw"||Db(e.ctx,n,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const mA=(e,t)=>{let{boxHeight:r=t,boxWidth:n=t}=e;return e.usePointStyle&&(r=Math.min(r,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(t,r)}},Qde=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class gA extends rs{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r,n){this.maxWidth=t,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let r=Ht(t.generateLabels,[this.chart],this)||[];t.filter&&(r=r.filter(n=>t.filter(n,this.chart.data))),t.sort&&(r=r.sort((n,i)=>t.sort(n,i,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:t,ctx:r}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,i=An(n.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=mA(n,s);let u,h;r.font=i.string,this.isHorizontal()?(u=this.maxWidth,h=this._fitRows(o,s,l,c)+10):(h=this.maxHeight,u=this._fitCols(o,i,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,r,n,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],h=i+l;let f=t;s.textAlign="left",s.textBaseline="middle";let m=-1,_=-h;return this.legendItems.forEach((g,v)=>{const y=n+r/2+s.measureText(g.text).width;(v===0||u[u.length-1]+y+2*l>o)&&(f+=h,u[u.length-(v>0?0:1)]=0,_+=h,m++),c[v]={left:0,top:_,row:m,width:y,height:i},u[u.length-1]+=y+l}),f}_fitCols(t,r,n,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],h=o-t;let f=l,m=0,_=0,g=0,v=0;return this.legendItems.forEach((y,b)=>{const{itemWidth:x,itemHeight:j}=Jde(n,r,s,y,i);b>0&&_+j+2*l>h&&(f+=m+l,u.push({width:m,height:_}),g+=m+l,v++,m=_=0),c[b]={left:g,top:_,col:v,width:x,height:j},m=Math.max(m,x),_+=j+l}),f+=m,u.push({width:m,height:_}),f}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:i},rtl:s}}=this,o=yu(s,this.left,this.width);if(this.isHorizontal()){let l=0,c=bn(n,this.left+i,this.right-this.lineWidths[l]);for(const u of r)l!==u.row&&(l=u.row,c=bn(n,this.left+i,this.right-this.lineWidths[l])),u.top+=this.top+t+i,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+i}else{let l=0,c=bn(n,this.top+t+i,this.bottom-this.columnSizes[l].height);for(const u of r)u.col!==l&&(l=u.col,c=bn(n,this.top+t+i,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+i,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;uv(t,this),this._draw(),hv(t)}}_draw(){const{options:t,columnSizes:r,lineWidths:n,ctx:i}=this,{align:s,labels:o}=t,l=yr.color,c=yu(t.rtl,this.left,this.width),u=An(o.font),{padding:h}=o,f=u.size,m=f/2;let _;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=u.string;const{boxWidth:g,boxHeight:v,itemHeight:y}=mA(o,f),b=function(F,w,P){if(isNaN(g)||g<=0||isNaN(v)||v<0)return;i.save();const M=it(P.lineWidth,1);if(i.fillStyle=it(P.fillStyle,l),i.lineCap=it(P.lineCap,"butt"),i.lineDashOffset=it(P.lineDashOffset,0),i.lineJoin=it(P.lineJoin,"miter"),i.lineWidth=M,i.strokeStyle=it(P.strokeStyle,l),i.setLineDash(it(P.lineDash,[])),o.usePointStyle){const A={radius:v*Math.SQRT2/2,pointStyle:P.pointStyle,rotation:P.rotation,borderWidth:M},D=c.xPlus(F,g/2),H=w+m;c6(i,A,D,H,o.pointStyleWidth&&g)}else{const A=w+Math.max((f-v)/2,0),D=c.leftForLtr(F,g),H=_u(P.borderRadius);i.beginPath(),Object.values(H).some(U=>U!==0)?w1(i,{x:D,y:A,w:g,h:v,radius:H}):i.rect(D,A,g,v),i.fill(),M!==0&&i.stroke()}i.restore()},x=function(F,w,P){J0(i,P.text,F,w+y/2,u,{strikethrough:P.hidden,textAlign:c.textAlign(P.textAlign)})},j=this.isHorizontal(),S=this._computeTitleHeight();j?_={x:bn(s,this.left+h,this.right-n[0]),y:this.top+h+S,line:0}:_={x:this.left+h,y:bn(s,this.top+S+h,this.bottom-r[0].height),line:0},g6(this.ctx,t.textDirection);const T=y+h;this.legendItems.forEach((F,w)=>{i.strokeStyle=F.fontColor,i.fillStyle=F.fontColor;const P=i.measureText(F.text).width,M=c.textAlign(F.textAlign||(F.textAlign=o.textAlign)),A=g+m+P;let D=_.x,H=_.y;c.setWidth(this.width),j?w>0&&D+A+h>this.right&&(H=_.y+=T,_.line++,D=_.x=bn(s,this.left+h,this.right-n[_.line])):w>0&&H+T>this.bottom&&(D=_.x=D+r[_.line].width+h,_.line++,H=_.y=bn(s,this.top+S+h,this.bottom-r[_.line].height));const U=c.x(D);if(b(U,H,F),D=Toe(M,D+g+m,j?D+A:this.right,t.rtl),x(c.x(D),H,F),j)_.x+=A+h;else if(typeof F.text!="string"){const W=u.lineHeight;_.y+=I6(F,W)+h}else _.y+=T}),x6(this.ctx,t.textDirection)}drawTitle(){const t=this.options,r=t.title,n=An(r.font),i=Ti(r.padding);if(!r.display)return;const s=yu(t.rtl,this.left,this.width),o=this.ctx,l=r.position,c=n.size/2,u=i.top+c;let h,f=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),h=this.top+u,f=bn(t.align,f,this.right-m);else{const g=this.columnSizes.reduce((v,y)=>Math.max(v,y.height),0);h=u+bn(t.align,this.top,this.bottom-g-t.labels.padding-this._computeTitleHeight())}const _=bn(l,f,f+m);o.textAlign=s.textAlign(uS(l)),o.textBaseline="middle",o.strokeStyle=r.color,o.fillStyle=r.color,o.font=n.string,J0(o,r.text,_,h,n)}_computeTitleHeight(){const t=this.options.title,r=An(t.font),n=Ti(t.padding);return t.display?r.lineHeight+n.height:0}_getLegendItemAt(t,r){let n,i,s;if(fo(t,this.left,this.right)&&fo(r,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],fo(t,i.left,i.left+i.width)&&fo(r,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(t){const r=this.options;if(!tue(t.type,r))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,s=Qde(i,n);i&&!s&&Ht(r.onLeave,[t,i,this],this),this._hoveredItem=n,n&&!s&&Ht(r.onHover,[t,n,this],this)}else n&&Ht(r.onClick,[t,n,this],this)}}function Jde(e,t,r,n,i){const s=Zde(n,e,t,r),o=eue(i,n,t.lineHeight);return{itemWidth:s,itemHeight:o}}function Zde(e,t,r,n){let i=e.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),t+r.size/2+n.measureText(i).width}function eue(e,t,r){let n=e;return typeof t.text!="string"&&(n=I6(t,r)),n}function I6(e,t){const r=e.text?e.text.length:0;return t*r}function tue(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var ra={id:"legend",_element:gA,start(e,t,r){const n=e.legend=new gA({ctx:e.ctx,options:r,chart:e});ji.configure(e,n,r),ji.addBox(e,n)},stop(e){ji.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const n=e.legend;ji.configure(e,n,r),n.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const n=t.datasetIndex,i=r.chart;i.isDatasetVisible(n)?(i.hide(n),t.hidden=!0):(i.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(r?0:void 0),h=Ti(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:s,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:i||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class L6 extends rs{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=r;const i=Dr(n.text)?n.text.length:1;this._padding=Ti(n.padding);const s=i*An(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:r,left:n,bottom:i,right:s,options:o}=this,l=o.align;let c=0,u,h,f;return this.isHorizontal()?(h=bn(l,n,s),f=r+t,u=s-n):(o.position==="left"?(h=n+t,f=bn(l,i,r),c=Pt*-.5):(h=s-t,f=bn(l,r,i),c=Pt*.5),u=i-r),{titleX:h,titleY:f,maxWidth:u,rotation:c}}draw(){const t=this.ctx,r=this.options;if(!r.display)return;const n=An(r.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(s);J0(t,r.text,0,0,n,{color:r.color,maxWidth:c,rotation:u,textAlign:uS(r.align),textBaseline:"middle",translation:[o,l]})}}function rue(e,t){const r=new L6({ctx:e.ctx,options:t,chart:e});ji.configure(e,r,t),ji.addBox(e,r),e.titleBlock=r}var na={id:"title",_element:L6,start(e,t,r){rue(e,r)},stop(e){const t=e.titleBlock;ji.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const n=e.titleBlock;ji.configure(e,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vf={average(e){if(!e.length)return!1;let t,r,n=new Set,i=0,s=0;for(t=0,r=e.length;t<r;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();n.add(c.x),i+=c.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((l,c)=>l+c)/n.size,y:i/s}},nearest(e,t){if(!e.length)return!1;let r=t.x,n=t.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=e.length;s<o;++s){const c=e[s].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),h=qw(t,u);h<i&&(i=h,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,n=c.y}return{x:r,y:n}}};function _s(e,t){return t&&(Dr(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Js(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function nue(e,t){const{element:r,datasetIndex:n,index:i}=t,s=e.getDatasetMeta(n).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:e,label:o,parsed:s.getParsed(i),raw:e.data.datasets[n].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:r}}function xA(e,t){const r=e.chart.ctx,{body:n,footer:i,title:s}=e,{boxWidth:o,boxHeight:l}=t,c=An(t.bodyFont),u=An(t.titleFont),h=An(t.footerFont),f=s.length,m=i.length,_=n.length,g=Ti(t.padding);let v=g.height,y=0,b=n.reduce((S,T)=>S+T.before.length+T.lines.length+T.after.length,0);if(b+=e.beforeBody.length+e.afterBody.length,f&&(v+=f*u.lineHeight+(f-1)*t.titleSpacing+t.titleMarginBottom),b){const S=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;v+=_*S+(b-_)*c.lineHeight+(b-1)*t.bodySpacing}m&&(v+=t.footerMarginTop+m*h.lineHeight+(m-1)*t.footerSpacing);let x=0;const j=function(S){y=Math.max(y,r.measureText(S).width+x)};return r.save(),r.font=u.string,Dt(e.title,j),r.font=c.string,Dt(e.beforeBody.concat(e.afterBody),j),x=t.displayColors?o+2+t.boxPadding:0,Dt(n,S=>{Dt(S.before,j),Dt(S.lines,j),Dt(S.after,j)}),x=0,r.font=h.string,Dt(e.footer,j),r.restore(),y+=g.width,{width:y,height:v}}function aue(e,t){const{y:r,height:n}=t;return r<n/2?"top":r>e.height-n/2?"bottom":"center"}function iue(e,t,r,n){const{x:i,width:s}=n,o=r.caretSize+r.caretPadding;if(e==="left"&&i+s+o>t.width||e==="right"&&i-s-o<0)return!0}function sue(e,t,r,n){const{x:i,width:s}=r,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return n==="center"?u=i<=(l+c)/2?"left":"right":i<=s/2?u="left":i>=o-s/2&&(u="right"),iue(u,e,t,r)&&(u="center"),u}function vA(e,t,r){const n=r.yAlign||t.yAlign||aue(e,r);return{xAlign:r.xAlign||t.xAlign||sue(e,t,r,n),yAlign:n}}function oue(e,t){let{x:r,width:n}=e;return t==="right"?r-=n:t==="center"&&(r-=n/2),r}function lue(e,t,r){let{y:n,height:i}=e;return t==="top"?n+=r:t==="bottom"?n-=i+r:n-=i/2,n}function _A(e,t,r,n){const{caretSize:i,caretPadding:s,cornerRadius:o}=e,{xAlign:l,yAlign:c}=r,u=i+s,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:_}=_u(o);let g=oue(t,l);const v=lue(t,c,u);return c==="center"?l==="left"?g+=u:l==="right"&&(g-=u):l==="left"?g-=Math.max(h,m)+i:l==="right"&&(g+=Math.max(f,_)+i),{x:Tn(g,0,n.width-t.width),y:Tn(v,0,n.height-t.height)}}function gg(e,t,r){const n=Ti(r.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function yA(e){return _s([],Js(e))}function cue(e,t,r){return kd(e,{tooltip:t,tooltipItems:r,type:"tooltip"})}function bA(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const B6={beforeTitle:Xs,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return r[t.dataIndex]}return""},afterTitle:Xs,beforeBody:Xs,beforeLabel:Xs,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return Ct(r)||(t+=r),t},labelColor(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const r=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Xs,afterBody:Xs,beforeFooter:Xs,footer:Xs,afterFooter:Xs};function ca(e,t,r,n){const i=e[t].call(r,n);return typeof i>"u"?B6[t].call(r,n):i}class t2 extends rs{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const r=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&r.options.animation&&n.animations,s=new j6(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=cue(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,r){const{callbacks:n}=r,i=ca(n,"beforeTitle",this,t),s=ca(n,"title",this,t),o=ca(n,"afterTitle",this,t);let l=[];return l=_s(l,Js(i)),l=_s(l,Js(s)),l=_s(l,Js(o)),l}getBeforeBody(t,r){return yA(ca(r.callbacks,"beforeBody",this,t))}getBody(t,r){const{callbacks:n}=r,i=[];return Dt(t,s=>{const o={before:[],lines:[],after:[]},l=bA(n,s);_s(o.before,Js(ca(l,"beforeLabel",this,s))),_s(o.lines,ca(l,"label",this,s)),_s(o.after,Js(ca(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(t,r){return yA(ca(r.callbacks,"afterBody",this,t))}getFooter(t,r){const{callbacks:n}=r,i=ca(n,"beforeFooter",this,t),s=ca(n,"footer",this,t),o=ca(n,"afterFooter",this,t);let l=[];return l=_s(l,Js(i)),l=_s(l,Js(s)),l=_s(l,Js(o)),l}_createItems(t){const r=this._active,n=this.chart.data,i=[],s=[],o=[];let l=[],c,u;for(c=0,u=r.length;c<u;++c)l.push(nue(this.chart,r[c]));return t.filter&&(l=l.filter((h,f,m)=>t.filter(h,f,m,n))),t.itemSort&&(l=l.sort((h,f)=>t.itemSort(h,f,n))),Dt(l,h=>{const f=bA(t.callbacks,h);i.push(ca(f,"labelColor",this,h)),s.push(ca(f,"labelPointStyle",this,h)),o.push(ca(f,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(t,r){const n=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=Vf[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const c=this._size=xA(this,n),u=Object.assign({},l,c),h=vA(this.chart,n,u),f=_A(n,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:f.x,y:f.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(t,r,n,i){const s=this.getCaretPosition(t,n,i);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(t,r,n){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:f}=_u(l),{x:m,y:_}=t,{width:g,height:v}=r;let y,b,x,j,S,T;return s==="center"?(S=_+v/2,i==="left"?(y=m,b=y-o,j=S+o,T=S-o):(y=m+g,b=y+o,j=S-o,T=S+o),x=y):(i==="left"?b=m+Math.max(c,h)+o:i==="right"?b=m+g-Math.max(u,f)-o:b=this.caretX,s==="top"?(j=_,S=j-o,y=b-o,x=b+o):(j=_+v,S=j+o,y=b+o,x=b-o),T=j),{x1:y,x2:b,x3:x,y1:j,y2:S,y3:T}}drawTitle(t,r,n){const i=this.title,s=i.length;let o,l,c;if(s){const u=yu(n.rtl,this.x,this.width);for(t.x=gg(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",o=An(n.titleFont),l=n.titleSpacing,r.fillStyle=n.titleColor,r.font=o.string,c=0;c<s;++c)r.fillText(i[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===s&&(t.y+=n.titleMarginBottom-l)}}_drawColorBox(t,r,n,i,s){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:c,boxWidth:u}=s,h=An(s.bodyFont),f=gg(this,"left",s),m=i.x(f),_=c<h.lineHeight?(h.lineHeight-c)/2:0,g=r.y+_;if(s.usePointStyle){const v={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=i.leftForLtr(m,u)+u/2,b=g+c/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,Xw(t,v,y,b),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Xw(t,v,y,b)}else{t.lineWidth=pt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const v=i.leftForLtr(m,u),y=i.leftForLtr(i.xPlus(m,1),u-2),b=_u(o.borderRadius);Object.values(b).some(x=>x!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,w1(t,{x:v,y:g,w:u,h:c,radius:b}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),w1(t,{x:y,y:g+1,w:u-2,h:c-2,radius:b}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(v,g,u,c),t.strokeRect(v,g,u,c),t.fillStyle=o.backgroundColor,t.fillRect(y,g+1,u-2,c-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,r,n){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:h}=n,f=An(n.bodyFont);let m=f.lineHeight,_=0;const g=yu(n.rtl,this.x,this.width),v=function(P){r.fillText(P,g.x(t.x+_),t.y+m/2),t.y+=m+s},y=g.textAlign(o);let b,x,j,S,T,F,w;for(r.textAlign=o,r.textBaseline="middle",r.font=f.string,t.x=gg(this,y,n),r.fillStyle=n.bodyColor,Dt(this.beforeBody,v),_=l&&y!=="right"?o==="center"?u/2+h:u+2+h:0,S=0,F=i.length;S<F;++S){for(b=i[S],x=this.labelTextColors[S],r.fillStyle=x,Dt(b.before,v),j=b.lines,l&&j.length&&(this._drawColorBox(r,t,S,g,n),m=Math.max(f.lineHeight,c)),T=0,w=j.length;T<w;++T)v(j[T]),m=f.lineHeight;Dt(b.after,v)}_=0,m=f.lineHeight,Dt(this.afterBody,v),t.y-=s}drawFooter(t,r,n){const i=this.footer,s=i.length;let o,l;if(s){const c=yu(n.rtl,this.x,this.width);for(t.x=gg(this,n.footerAlign,n),t.y+=n.footerMarginTop,r.textAlign=c.textAlign(n.footerAlign),r.textBaseline="middle",o=An(n.footerFont),r.fillStyle=n.footerColor,r.font=o.string,l=0;l<s;++l)r.fillText(i[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,r,n,i){const{xAlign:s,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:h}=n,{topLeft:f,topRight:m,bottomLeft:_,bottomRight:g}=_u(i.cornerRadius);r.fillStyle=i.backgroundColor,r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.beginPath(),r.moveTo(l+f,c),o==="top"&&this.drawCaret(t,r,n,i),r.lineTo(l+u-m,c),r.quadraticCurveTo(l+u,c,l+u,c+m),o==="center"&&s==="right"&&this.drawCaret(t,r,n,i),r.lineTo(l+u,c+h-g),r.quadraticCurveTo(l+u,c+h,l+u-g,c+h),o==="bottom"&&this.drawCaret(t,r,n,i),r.lineTo(l+_,c+h),r.quadraticCurveTo(l,c+h,l,c+h-_),o==="center"&&s==="left"&&this.drawCaret(t,r,n,i),r.lineTo(l,c+f),r.quadraticCurveTo(l,c,l+f,c),r.closePath(),r.fill(),i.borderWidth>0&&r.stroke()}_updateAnimationTarget(t){const r=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const o=Vf[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=xA(this,t),c=Object.assign({},o,this._size),u=vA(r,t,c),h=_A(t,c,u,r);(i._to!==h.x||s._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Ti(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(t.save(),t.globalAlpha=n,this.drawBackground(s,t,i,r),g6(t,r.textDirection),s.y+=o.top,this.drawTitle(s,t,r),this.drawBody(s,t,r),this.drawFooter(s,t,r),x6(t,r.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,r){const n=this._active,i=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),s=!y1(n,i),o=this._positionChanged(i,r);(s||o)&&(this._active=i,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(t,s,r,n),l=this._positionChanged(o,t),c=r||!y1(o,s)||l;return c&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,r))),c}_getActiveElements(t,r,n,i){const s=this.options;if(t.type==="mouseout")return[];if(!i)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(t,r){const{caretX:n,caretY:i,options:s}=this,o=Vf[s.position].call(this,t,r);return o!==!1&&(n!==o.x||i!==o.y)}}Le(t2,"positioners",Vf);var aa={id:"tooltip",_element:t2,positioners:Vf,afterInit(e,t,r){r&&(e.tooltip=new t2({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:B6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const due=(e,t,r,n)=>(typeof t=="string"?(r=e.push(t)-1,n.unshift({index:r,label:t})):isNaN(t)&&(r=null),r);function uue(e,t,r,n){const i=e.indexOf(t);if(i===-1)return due(e,t,r,n);const s=e.lastIndexOf(t);return i!==s?r:i}const hue=(e,t)=>e===null?null:Tn(Math.round(e),0,t);function jA(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class hn extends ch{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:i,label:s}of r)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,r){if(Ct(t))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===t?r:uue(n,t,it(r,t),this._addedLabels),hue(r,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),r||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,r=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=t===0&&r===s.length-1?s:s.slice(t,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=r;o++)i.push({value:o});return i}getLabelForValue(t){return jA.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Le(hn,"id","category"),Le(hn,"defaults",{ticks:{callback:jA}});function fue(e,t){const r=[],{bounds:i,step:s,min:o,max:l,precision:c,count:u,maxTicks:h,maxDigits:f,includeBounds:m}=e,_=s||1,g=h-1,{min:v,max:y}=t,b=!Ct(o),x=!Ct(l),j=!Ct(u),S=(y-v)/(f+1);let T=_4((y-v)/g/_)*_,F,w,P,M;if(T<1e-14&&!b&&!x)return[{value:v},{value:y}];M=Math.ceil(y/T)-Math.floor(v/T),M>g&&(T=_4(M*T/g/_)*_),Ct(c)||(F=Math.pow(10,c),T=Math.ceil(T*F)/F),i==="ticks"?(w=Math.floor(v/T)*T,P=Math.ceil(y/T)*T):(w=v,P=y),b&&x&&s&&yoe((l-o)/s,T/1e3)?(M=Math.round(Math.min((l-o)/T,h)),T=(l-o)/M,w=o,P=l):j?(w=b?o:w,P=x?l:P,M=u-1,T=(P-w)/M):(M=(P-w)/T,d0(M,Math.round(M),T/1e3)?M=Math.round(M):M=Math.ceil(M));const A=Math.max(y4(T),y4(w));F=Math.pow(10,Ct(c)?A:c),w=Math.round(w*F)/F,P=Math.round(P*F)/F;let D=0;for(b&&(m&&w!==o?(r.push({value:o}),w<o&&D++,d0(Math.round((w+D*T)*F)/F,o,wA(o,S,e))&&D++):w<o&&D++);D<M;++D){const H=Math.round((w+D*T)*F)/F;if(x&&H>l)break;r.push({value:H})}return x&&m&&P!==l?r.length&&d0(r[r.length-1].value,l,wA(l,S,e))?r[r.length-1].value=l:r.push({value:l}):(!x||P===l)&&r.push({value:P}),r}function wA(e,t,{horizontal:r,minRotation:n}){const i=ho(n),s=(r?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+e).length;return Math.min(t/s,o)}class pue extends ch{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,r){return Ct(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const o=c=>i=r?i:c,l=c=>s=n?s:c;if(t){const c=Ds(i),u=Ds(s);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(i===s){let c=s===0?1:Math.abs(s*.05);l(s+c),t||o(i-c)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=t,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),r=r||11),r&&(i=Math.min(r,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,r=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},s=this._range||this,o=fue(i,s);return t.bounds==="ticks"&&boe(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-r)/Math.max(t.length-1,1)/2;r-=i,n+=i}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(t){return fS(t,this.chart.options.locale,this.options.ticks.format)}}class fn extends pue{determineDataLimits(){const{min:t,max:r}=this.getMinMax(!0);this.min=On(t)?t:0,this.max=On(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),r=t?this.width:this.height,n=ho(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Le(fn,"id","linear"),Le(fn,"defaults",{ticks:{callback:l6.formatters.numeric}});const gv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},pa=Object.keys(gv);function kA(e,t){return e-t}function SA(e,t){if(Ct(t))return null;const r=e._adapter,{parser:n,round:i,isoWeekday:s}=e._parseOpts;let o=t;return typeof n=="function"&&(o=n(o)),On(o)||(o=typeof n=="string"?r.parse(o,n):r.parse(o)),o===null?null:(i&&(o=i==="week"&&(X0(s)||s===!0)?r.startOf(o,"isoWeek",s):r.startOf(o,i)),+o)}function CA(e,t,r,n){const i=pa.length;for(let s=pa.indexOf(e);s<i-1;++s){const o=gv[pa[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((r-t)/(l*o.size))<=n)return pa[s]}return pa[i-1]}function mue(e,t,r,n,i){for(let s=pa.length-1;s>=pa.indexOf(r);s--){const o=pa[s];if(gv[o].common&&e._adapter.diff(i,n,o)>=t-1)return o}return pa[r?pa.indexOf(r):0]}function gue(e){for(let t=pa.indexOf(e)+1,r=pa.length;t<r;++t)if(gv[pa[t]].common)return pa[t]}function $A(e,t,r){if(!r)e[t]=!0;else if(r.length){const{lo:n,hi:i}=dS(r,t),s=r[n]>=t?r[n]:r[i];e[s]=!0}}function xue(e,t,r,n){const i=e._adapter,s=+i.startOf(t[0].value,n),o=t[t.length-1].value;let l,c;for(l=s;l<=o;l=+i.add(l,1,n))c=r[l],c>=0&&(t[c].major=!0);return t}function EA(e,t,r){const n=[],i={},s=t.length;let o,l;for(o=0;o<s;++o)l=t[o],i[l]=o,n.push({value:l,major:!1});return s===0||!r?n:xue(e,n,i,r)}class $1 extends ch{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r={}){const n=t.time||(t.time={}),i=this._adapter=new nce._date(t.adapters.date);i.init(r),c0(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return t===void 0?null:SA(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,r=this._adapter,n=t.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(i=Math.min(i,u.min)),!l&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),i=On(i)&&!isNaN(i)?i:+r.startOf(Date.now(),n),s=On(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],n=t[t.length-1]),{min:r,max:n}}buildTicks(){const t=this.options,r=t.time,n=t.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=Coe(i,s,o);return this._unit=r.unit||(n.autoSkip?CA(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):mue(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:gue(this._unit),this.initOffsets(i),t.reverse&&l.reverse(),EA(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let r=0,n=0,i,s;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?r=1-i:r=(this.getDecimalForValue(t[1])-i)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?n=s:n=(s-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;r=Tn(r,0,o),n=Tn(n,0,o),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const t=this._adapter,r=this.min,n=this.max,i=this.options,s=i.time,o=s.unit||CA(s.minUnit,r,n,this._getLabelCapacity(r)),l=it(i.ticks.stepSize,1),c=o==="week"?s.isoWeekday:!1,u=X0(c)||c===!0,h={};let f=r,m,_;if(u&&(f=+t.startOf(f,"isoWeek",c)),f=+t.startOf(f,u?"day":o),t.diff(n,r,o)>1e5*l)throw new Error(r+" and "+n+" are too far apart with stepSize of "+l+" "+o);const g=i.ticks.source==="data"&&this.getDataTimestamps();for(m=f,_=0;m<n;m=+t.add(m,l,o),_++)$A(h,m,g);return(m===n||i.bounds==="ticks"||_===1)&&$A(h,m,g),Object.keys(h).sort(kA).map(v=>+v)}getLabelForValue(t){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(t,n.tooltipFormat):r.format(t,n.displayFormats.datetime)}format(t,r){const i=this.options.time.displayFormats,s=this._unit,o=r||i[s];return this._adapter.format(t,o)}_tickFormatFunction(t,r,n,i){const s=this.options,o=s.ticks.callback;if(o)return Ht(o,[t,r,n],this);const l=s.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&l[c],f=u&&l[u],m=n[r],_=u&&f&&m&&m.major;return this._adapter.format(t,i||(_?f:h))}generateTickLabels(t){let r,n,i;for(r=0,n=t.length;r<n;++r)i=t[r],i.label=this._tickFormatFunction(i.value,r,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const r=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const r=this.options.ticks,n=this.ctx.measureText(t).width,i=ho(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:n*s+l*o,h:n*o+l*s}}_getLabelCapacity(t){const r=this.options.time,n=r.displayFormats,i=n[r.unit]||n.millisecond,s=this._tickFormatFunction(t,0,EA(this,[t],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],r,n;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(r=0,n=i.length;r<n;++r)t=t.concat(i[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let r,n;if(t.length)return t;const i=this.getLabels();for(r=0,n=i.length;r<n;++r)t.push(SA(this,i[r]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return i6(t.sort(kA))}}Le($1,"id","time"),Le($1,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function xg(e,t,r){let n=0,i=e.length-1,s,o,l,c;r?(t>=e[n].pos&&t<=e[i].pos&&({lo:n,hi:i}=Dc(e,"pos",t)),{pos:s,time:l}=e[n],{pos:o,time:c}=e[i]):(t>=e[n].time&&t<=e[i].time&&({lo:n,hi:i}=Dc(e,"time",t)),{time:s,pos:l}=e[n],{time:o,pos:c}=e[i]);const u=o-s;return u?l+(c-l)*(t-s)/u:l}class TA extends $1{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(t);this._minPos=xg(r,this.min),this._tableRange=xg(r,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:r,max:n}=this,i=[],s=[];let o,l,c,u,h;for(o=0,l=t.length;o<l;++o)u=t[o],u>=r&&u<=n&&i.push(u);if(i.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(o=0,l=i.length;o<l;++o)h=i[o+1],c=i[o-1],u=i[o],Math.round((h+c)/2)!==u&&s.push({time:u,pos:o/(l-1)});return s}_generate(){const t=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?t=this.normalize(r.concat(n)):t=r.length?r:n,t=this._cache.all=t,t}getDecimalForValue(t){return(xg(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const r=this._offsets,n=this.getDecimalForPixel(t)/r.factor-r.end;return xg(this._table,n*this._tableRange+this._minPos,!0)}}Le(TA,"id","timeseries"),Le(TA,"defaults",$1.defaults);const U6="label";function AA(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function vue(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function V6(e,t){e.labels=t}function H6(e,t,r=U6){const n=[];e.datasets=t.map(i=>{const s=e.datasets.find(o=>o[r]===i[r]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function _ue(e,t=U6){const r={labels:[],datasets:[]};return V6(r,e.labels),H6(r,e.datasets,t),r}function yue(e,t){const{height:r=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:f,...m}=e,_=C.useRef(null),g=C.useRef(null),v=()=>{_.current&&(g.current=new en(_.current,{type:o,data:_ue(l,s),options:c&&{...c},plugins:u}),AA(t,g.current))},y=()=>{AA(t,null),g.current&&(g.current.destroy(),g.current=null)};return C.useEffect(()=>{!i&&g.current&&c&&vue(g.current,c)},[i,c]),C.useEffect(()=>{!i&&g.current&&V6(g.current.config.data,l.labels)},[i,l.labels]),C.useEffect(()=>{!i&&g.current&&l.datasets&&H6(g.current.config.data,l.datasets,s)},[i,l.datasets]),C.useEffect(()=>{g.current&&(i?(y(),setTimeout(v)):g.current.update(f))},[i,c,l.labels,l.datasets,f]),C.useEffect(()=>{g.current&&(y(),setTimeout(v))},[o]),C.useEffect(()=>(v(),()=>y()),[]),a.jsx("canvas",{ref:_,role:"img",height:r,width:n,...m,children:h})}const bue=C.forwardRef(yue);function xv(e,t){return en.register(t),C.forwardRef((r,n)=>a.jsx(bue,{...r,ref:n,type:e}))}const Sd=xv("line",kx),ia=xv("bar",wx),kp=xv("doughnut",lu),bS=xv("pie",Yw);en.register(hn,fn,Zr,na,aa,ra,ga);const jue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,wue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;

  &:hover {
    text-decoration: underline;
  }
`,kue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Sue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Cue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Mb=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ob=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,$ue=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,FA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;

  &:focus {
    outline: none;
    border-color: ${d.colors.primary};
  }
`,Eue=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    opacity: 0.9;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Tue=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
`,Rb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Nb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Aue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;

  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
`,vg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,_g=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,yg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Fue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,uc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,qo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Due=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;

  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$percentage:e})=>e}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,zb=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Pue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,bg={Ventas:"#4F46E5",Desarrollo:"#059669","Diseno Grafico":"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2","Sin asignar":"#6B7280"};function Mue({onNavigate:e}){const[t,r]=C.useState("all"),[n,i]=C.useState(""),[s,o]=C.useState(""),[l,c]=C.useState(!0),[u,h]=C.useState(null),[f,m]=C.useState(null),_=async()=>{c(!0),h(null);try{const w=await ta.getOTsPorUsuario({date_desde:n||void 0,date_hasta:s||void 0,area_id:t!=="all"?parseInt(t):void 0});m(w)}catch(w){console.error("Error fetching report data:",w),h("Error al cargar los datos del reporte. Intente nuevamente.")}finally{c(!1)}};C.useEffect(()=>{_()},[]);const g=()=>{_()},v=C.useMemo(()=>f?f.items.map(w=>({userId:w.usuario_id,userName:w.usuario_nombre,area:w.area_nombre,areaId:w.area_id,otsActivas:w.ots_activas,otsCompletadas:w.ots_completadas,totalOTs:w.total_ots,tiempoPromedioDias:w.tiempo_promedio})):[],[f]),y=C.useMemo(()=>({totalOTsActivas:v.reduce((w,P)=>w+P.otsActivas,0),totalCompletadas:v.reduce((w,P)=>w+P.otsCompletadas,0),totalOTs:(f==null?void 0:f.total_ots)||0,totalUsuarios:(f==null?void 0:f.total_usuarios)||0}),[v,f]),b=C.useMemo(()=>({labels:v.slice(0,10).map(w=>w.userName.split(" ")[0]),datasets:[{label:"OTs Activas",data:v.slice(0,10).map(w=>w.otsActivas),backgroundColor:"#60A5FA"},{label:"OTs Completadas",data:v.slice(0,10).map(w=>w.otsCompletadas),backgroundColor:"#34D399"}]}),[v]),x=C.useMemo(()=>{const w=v.reduce((M,A)=>{const D=A.area||"Sin asignar";return M[D]=(M[D]||0)+A.totalOTs,M},{}),P=Object.entries(w);return{labels:P.map(([M])=>M),datasets:[{data:P.map(([,M])=>M),backgroundColor:P.map(([M])=>bg[M]||"#6B7280")}]}},[v]),j={responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!1},y:{stacked:!1,beginAtZero:!0}}},S={responsive:!0,plugins:{legend:{position:"right"}}},T=Math.max(...v.map(w=>w.totalOTs),1),F=(f==null?void 0:f.areas)||[];return a.jsxs(jue,{children:[a.jsx(wue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(kue,{children:"OTs Activas por Usuario"}),a.jsx(Sue,{children:a.jsxs(Cue,{children:[a.jsxs(Mb,{children:[a.jsx(Ob,{children:"Area"}),a.jsxs($ue,{value:t,onChange:w=>r(w.target.value),children:[a.jsx("option",{value:"all",children:"Todas las Areas"}),F.map(w=>a.jsx("option",{value:w.id.toString(),children:w.nombre},w.id))]})]}),a.jsxs(Mb,{children:[a.jsx(Ob,{children:"Fecha Desde"}),a.jsx(FA,{type:"date",value:n,onChange:w=>i(w.target.value)})]}),a.jsxs(Mb,{children:[a.jsx(Ob,{children:"Fecha Hasta"}),a.jsx(FA,{type:"date",value:s,onChange:w=>o(w.target.value)})]}),a.jsx(Eue,{$variant:"primary",onClick:g,disabled:l,children:l?"Cargando...":"Aplicar Filtros"})]})}),u&&a.jsx(Pue,{children:u}),l?a.jsx(zb,{children:"Cargando datos del reporte..."}):a.jsxs(a.Fragment,{children:[a.jsxs(Aue,{children:[a.jsxs(vg,{$color:d.colors.primary,children:[a.jsx(_g,{children:y.totalOTs}),a.jsx(yg,{children:"OTs Totales"})]}),a.jsxs(vg,{$color:"#60A5FA",children:[a.jsx(_g,{children:y.totalOTsActivas}),a.jsx(yg,{children:"OTs Activas"})]}),a.jsxs(vg,{$color:d.colors.success,children:[a.jsx(_g,{children:y.totalCompletadas}),a.jsx(yg,{children:"OTs Completadas"})]}),a.jsxs(vg,{$color:"#7C3AED",children:[a.jsx(_g,{children:y.totalUsuarios}),a.jsx(yg,{children:"Usuarios Activos"})]})]}),a.jsxs(Tue,{children:[a.jsxs(Rb,{children:[a.jsx(Nb,{children:"Top 10 Usuarios por OTs"}),v.length>0?a.jsx(ia,{data:b,options:j}):a.jsx(zb,{children:"No hay datos para mostrar"})]}),a.jsxs(Rb,{children:[a.jsx(Nb,{children:"Distribucion por Area"}),v.length>0?a.jsx(bS,{data:x,options:S}):a.jsx(zb,{children:"No hay datos para mostrar"})]})]}),a.jsxs(Rb,{children:[a.jsxs(Nb,{children:["Detalle por Usuario (",v.length," registros)"]}),a.jsxs(Fue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(uc,{children:"Usuario"}),a.jsx(uc,{children:"Area"}),a.jsx(uc,{children:"OTs Totales"}),a.jsx(uc,{children:"Activas"}),a.jsx(uc,{children:"Completadas"}),a.jsx(uc,{children:"Tiempo Prom. (dias)"}),a.jsx(uc,{style:{width:"150px"},children:"Carga"})]})}),a.jsx("tbody",{children:v.length===0?a.jsx("tr",{children:a.jsx(qo,{colSpan:7,style:{textAlign:"center"},children:"No hay datos disponibles para los filtros seleccionados"})}):v.map(w=>a.jsxs("tr",{children:[a.jsx(qo,{style:{fontWeight:500},children:w.userName}),a.jsx(qo,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${bg[w.area]||"#6B7280"}20`,color:bg[w.area]||"#6B7280"},children:w.area})}),a.jsx(qo,{style:{fontWeight:600},children:w.totalOTs}),a.jsx(qo,{children:w.otsActivas}),a.jsx(qo,{children:w.otsCompletadas}),a.jsx(qo,{children:w.tiempoPromedioDias.toFixed(1)}),a.jsx(qo,{children:a.jsx(Due,{$percentage:w.totalOTs/T*100,$color:bg[w.area]||d.colors.primary})})]},`${w.userId}-${w.areaId}`))})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,na,aa,ra,dh);const Oue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Rue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Nue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,zue=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Iue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,DA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,PA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,MA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Ib=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Lue=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,jg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,wg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,kg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Bue=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,OA=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,RA=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Uue=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,hc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Ko=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Vue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Hue=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Wue=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,Gue=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function que({onNavigate:e}){const t=Gue(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState(1),[c,u]=C.useState(!0),[h,f]=C.useState(null),[m,_]=C.useState(null),g=async()=>{u(!0),f(null);try{const x=await ta.getOTsCompletadas({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});_(x)}catch(x){console.error("Error fetching report:",x),f("Error al cargar los datos del reporte.")}finally{u(!1)}};C.useEffect(()=>{g()},[o]);const v=()=>{l(1),g()},y=C.useMemo(()=>{if(!m)return null;const x=[{label:"0-3 dias",min:0,max:3,color:d.colors.success},{label:"4-7 dias",min:4,max:7,color:"#60A5FA"},{label:"8-15 dias",min:8,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],j=x.map(S=>m.items.filter(T=>T.tiempo_total>=S.min&&T.tiempo_total<=S.max).length);return{labels:x.map(S=>S.label),datasets:[{label:"OTs por Tiempo",data:j,backgroundColor:x.map(S=>S.color)}]}},[m]),b={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(Oue,{children:[a.jsx(Rue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Nue,{children:"OTs Completadas"}),a.jsx(zue,{children:a.jsxs(Iue,{children:[a.jsxs(DA,{children:[a.jsx(PA,{children:"Desde"}),a.jsx(MA,{type:"date",value:r,onChange:x=>n(x.target.value)})]}),a.jsxs(DA,{children:[a.jsx(PA,{children:"Hasta"}),a.jsx(MA,{type:"date",value:i,onChange:x=>s(x.target.value)})]}),a.jsx(Ib,{$variant:"primary",onClick:v,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(Hue,{children:h}),c?a.jsx(Vue,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(Lue,{children:[a.jsxs(jg,{$color:d.colors.success,children:[a.jsx(wg,{children:m.resumen.total_completadas}),a.jsx(kg,{children:"Total Completadas"})]}),a.jsxs(jg,{$color:d.colors.primary,children:[a.jsxs(wg,{children:[m.resumen.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(kg,{children:"Tiempo Promedio"})]}),a.jsxs(jg,{$color:"#60A5FA",children:[a.jsxs(wg,{children:[m.resumen.tiempo_minimo.toFixed(1)," dias"]}),a.jsx(kg,{children:"Tiempo Minimo"})]}),a.jsxs(jg,{$color:d.colors.warning,children:[a.jsxs(wg,{children:[m.resumen.tiempo_maximo.toFixed(1)," dias"]}),a.jsx(kg,{children:"Tiempo Maximo"})]})]}),a.jsx(Bue,{children:y&&a.jsxs(OA,{children:[a.jsx(RA,{children:"Distribucion por Tiempo de Completado"}),a.jsx(ia,{data:y,options:b})]})}),a.jsxs(OA,{children:[a.jsxs(RA,{children:["OTs Completadas (",m.total," registros)"]}),a.jsxs(Uue,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(hc,{children:"OT ID"}),a.jsx(hc,{children:"Cliente"}),a.jsx(hc,{children:"Descripcion"}),a.jsx(hc,{children:"Creacion"}),a.jsx(hc,{children:"Completada"}),a.jsx(hc,{children:"Tiempo (dias)"}),a.jsx(hc,{children:"Estado"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(Ko,{colSpan:7,style:{textAlign:"center"},children:"No hay OTs completadas en el periodo seleccionado"})}):m.items.map(x=>{var j;return a.jsxs("tr",{children:[a.jsxs(Ko,{style:{fontWeight:600},children:["#",x.id]}),a.jsx(Ko,{children:x.client_name||"Sin cliente"}),a.jsxs(Ko,{children:[((j=x.descripcion)==null?void 0:j.substring(0,40))||"-","..."]}),a.jsx(Ko,{children:x.created_at}),a.jsx(Ko,{children:x.completed_at}),a.jsx(Ko,{style:{fontWeight:600,color:x.tiempo_total<=5?d.colors.success:x.tiempo_total<=10?d.colors.warning:d.colors.danger},children:x.tiempo_total.toFixed(1)}),a.jsx(Ko,{children:a.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:`${d.colors.success}20`,color:d.colors.success},children:x.estado})})]},x.id)})})]}),m.total_pages>1&&a.jsxs(Wue,{children:[a.jsx(Ib,{onClick:()=>l(x=>Math.max(1,x-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Ib,{onClick:()=>l(x=>Math.min(m.total_pages,x+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,na,aa,ra);const Kue=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Xue=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Yue=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Que=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Jue=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Zue=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ehe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,the=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,rhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,nhe=p.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
`,ahe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,ihe=p.div`
  font-size: 1.5rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,she=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,ohe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,r2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,lhe=p(r2)`
  grid-column: 1 / -1;
`,Lb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,che=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Sg=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,lf=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,dhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,uhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,cf={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function hhe({onNavigate:e}){const[t,r]=C.useState(new Date().getFullYear()),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),u=async()=>{i(!0),o(null);try{const v=await ta.getTiempoPorArea(t);c(v)}catch(v){console.error("Error fetching report:",v),o("Error al cargar los datos del reporte.")}finally{i(!1)}};C.useEffect(()=>{u()},[t]);const h=C.useMemo(()=>{if(!l)return[];const v={};return l.items.forEach(y=>{v[y.area_nombre]||(v[y.area_nombre]={total_tiempo:0,total_ots:0,count:0}),v[y.area_nombre].total_tiempo+=y.tiempo_promedio*y.total_ots,v[y.area_nombre].total_ots+=y.total_ots,v[y.area_nombre].count++}),Object.entries(v).map(([y,b])=>({area:y,tiempoPromedio:b.total_ots>0?b.total_tiempo/b.total_ots:0,totalOTs:b.total_ots}))},[l]),f=C.useMemo(()=>h.length?{labels:h.map(v=>v.area),datasets:[{label:"Tiempo Promedio (dias)",data:h.map(v=>v.tiempoPromedio),backgroundColor:h.map(v=>cf[v.area]||"#6B7280")}]}:null,[h]),m=C.useMemo(()=>{if(!l)return null;const v=[...new Set(l.items.map(y=>y.area_nombre))];return{labels:l.meses,datasets:v.map(y=>({label:y,data:l.meses.map(b=>{const x=l.items.find(j=>j.mes===b&&j.area_nombre===y);return(x==null?void 0:x.tiempo_promedio)||0}),borderColor:cf[y]||"#6B7280",backgroundColor:`${cf[y]||"#6B7280"}20`,tension:.3}))}},[l]),_={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}};return a.jsxs(Kue,{children:[a.jsx(Xue,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Yue,{children:"Tiempo Promedio por Area"}),a.jsx(Que,{children:a.jsxs(Jue,{children:[a.jsxs(Zue,{children:[a.jsx(ehe,{children:"Ano"}),a.jsx(the,{value:t,onChange:v=>r(Number(v.target.value)),children:Array.from({length:6},(v,y)=>new Date().getFullYear()-y).map(v=>a.jsx("option",{value:v,children:v},v))})]}),a.jsx(rhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(uhe,{children:s}),n?a.jsx(dhe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsx(nhe,{children:h.map(v=>a.jsxs(ahe,{$color:cf[v.area]||"#6B7280",children:[a.jsxs(ihe,{children:[v.tiempoPromedio.toFixed(1)," dias"]}),a.jsxs(she,{children:[v.area," (",v.totalOTs," OTs)"]})]},v.area))}),a.jsxs(ohe,{children:[f&&a.jsxs(r2,{children:[a.jsx(Lb,{children:"Tiempo Promedio por Area"}),a.jsx(ia,{data:f,options:_})]}),m&&m.datasets.length>0&&a.jsxs(r2,{children:[a.jsx(Lb,{children:"Evolucion Mensual"}),a.jsx(Sd,{data:m,options:g})]})]}),a.jsxs(lhe,{children:[a.jsx(Lb,{children:"Detalle por Area y Mes"}),a.jsxs(che,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Sg,{children:"Mes"}),a.jsx(Sg,{children:"Area"}),a.jsx(Sg,{children:"Tiempo Promedio"}),a.jsx(Sg,{children:"OTs Procesadas"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(lf,{colSpan:4,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.items.map((v,y)=>a.jsxs("tr",{children:[a.jsx(lf,{style:{fontWeight:600},children:v.mes}),a.jsxs(lf,{children:[a.jsx("span",{style:{display:"inline-block",width:"10px",height:"10px",borderRadius:"50%",backgroundColor:cf[v.area_nombre]||"#6B7280",marginRight:"0.5rem"}}),v.area_nombre]}),a.jsxs(lf,{style:{fontWeight:600},children:[v.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(lf,{children:v.total_ots})]},y))})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra,dh);const fhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,phe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,mhe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,ghe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,xhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,vhe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,_he=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,yhe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,bhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,jhe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Cg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,$g=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Eg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,NA=p.div`
  font-size: 0.7rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,zA=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,df=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,uf=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,whe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Bb=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Tg=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,khe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,She=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
`,Che=p.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: ${d.colors.bgLight};
  border-radius: 4px;
`,$he=p.span`
  font-size: 0.875rem;
  color: ${d.colors.textPrimary};
`,Ehe=p.span`
  font-size: 0.875rem;
  font-weight: 600;
  color: ${d.colors.danger};
`,The=p.div`
  flex: 1;
  margin: 0 1rem;
  height: 8px;
  background: white;
  border-radius: 4px;
  overflow: hidden;
`,Ahe=p.div`
  height: 100%;
  width: ${({$width:e})=>e}%;
  background: ${({$color:e})=>e};
  border-radius: 4px;
`,Fhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Dhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Ub={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Phe({onNavigate:e}){var S,T,F,w,P;const[t,r]=C.useState(new Date().getFullYear()),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),u=async()=>{i(!0),o(null);try{const M=await ta.getRechazosMes(t);c(M)}catch(M){console.error("Error fetching report:",M),o("Error al cargar los datos del reporte.")}finally{i(!1)}};C.useEffect(()=>{u()},[t]);const h=C.useMemo(()=>{if(!l)return[];const M={};return l.items.forEach(A=>{M[A.mes]||(M[A.mes]=0),M[A.mes]+=A.total_rechazos}),Object.entries(M).map(([A,D])=>({mes:A,rechazos:D}))},[l]),f=C.useMemo(()=>h.length?{labels:h.map(M=>M.mes),datasets:[{label:"Rechazos",data:h.map(M=>M.rechazos),backgroundColor:d.colors.danger}]}:null,[h]),m=C.useMemo(()=>h.length?{labels:h.map(M=>M.mes),datasets:[{label:"Rechazos por Mes",data:h.map(M=>M.rechazos),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.3}]}:null,[h]),_=C.useMemo(()=>{var M;return(M=l==null?void 0:l.por_area)!=null&&M.length?{labels:l.por_area.map(A=>A.area),datasets:[{data:l.por_area.map(A=>A.cantidad),backgroundColor:l.por_area.map(A=>Ub[A.area]||"#6B7280"),borderWidth:0}]}:null},[l]),g={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad"}}}},v={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}},y={responsive:!0,plugins:{legend:{position:"right"}}},b=(S=l==null?void 0:l.por_area)!=null&&S.length?Math.max(...l.por_area.map(M=>M.cantidad)):0,x=C.useMemo(()=>{var D,H;if(h.length<2)return"stable";const M=((D=h[h.length-1])==null?void 0:D.rechazos)||0,A=((H=h[h.length-2])==null?void 0:H.rechazos)||0;return M<A?"down":M>A?"up":"stable"},[h]),j=h.length>0?h[h.length-1].rechazos:0;return a.jsxs(fhe,{children:[a.jsx(phe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(mhe,{children:"Rechazos por Mes"}),a.jsx(ghe,{children:a.jsxs(xhe,{children:[a.jsxs(vhe,{children:[a.jsx(_he,{children:"Ano"}),a.jsx(yhe,{value:t,onChange:M=>r(Number(M.target.value)),children:Array.from({length:6},(M,A)=>new Date().getFullYear()-A).map(M=>a.jsx("option",{value:M,children:M},M))})]}),a.jsx(bhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(Dhe,{children:s}),n?a.jsx(Fhe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(jhe,{children:[a.jsxs(Cg,{$color:d.colors.danger,children:[a.jsx($g,{children:l.total_rechazos}),a.jsx(Eg,{children:"Total Rechazos (Ano)"})]}),a.jsxs(Cg,{$color:d.colors.warning,children:[a.jsx($g,{children:l.promedio_mensual.toFixed(1)}),a.jsx(Eg,{children:"Promedio Mensual"})]}),a.jsxs(Cg,{$color:x==="down"?d.colors.success:d.colors.danger,children:[a.jsx($g,{children:j}),a.jsx(Eg,{children:"Rechazos Ultimo Mes"}),a.jsx(NA,{children:x==="down"?" Mejorando":x==="up"?" Aumentando":" Estable"})]}),a.jsxs(Cg,{$color:d.colors.primary,children:[a.jsx($g,{children:((w=(F=(T=l.por_area)==null?void 0:T[0])==null?void 0:F.area)==null?void 0:w.split(" ")[0])||"-"}),a.jsx(Eg,{children:"Area con mas Rechazos"}),a.jsx(NA,{children:(P=l.por_area)!=null&&P[0]?`${l.por_area[0].cantidad} casos`:""})]})]}),a.jsxs(zA,{children:[f&&a.jsxs(df,{children:[a.jsx(uf,{children:"Rechazos por Mes"}),a.jsx(ia,{data:f,options:g})]}),_&&a.jsxs(df,{children:[a.jsx(uf,{children:"Distribucion por Area"}),a.jsx(kp,{data:_,options:y})]})]}),a.jsxs(zA,{children:[m&&a.jsxs(df,{children:[a.jsx(uf,{children:"Tendencia de Rechazos"}),a.jsx(Sd,{data:m,options:v})]}),l.por_area&&l.por_area.length>0&&a.jsxs(df,{children:[a.jsx(uf,{children:"Rechazos por Area"}),a.jsx(She,{children:l.por_area.map(M=>a.jsxs(Che,{children:[a.jsx($he,{children:M.area}),a.jsx(The,{children:a.jsx(Ahe,{$width:M.cantidad/b*100,$color:Ub[M.area]||"#6B7280"})}),a.jsx(Ehe,{children:M.cantidad})]},M.area))})]})]}),a.jsxs(df,{children:[a.jsx(uf,{children:"Detalle por Mes y Area"}),a.jsxs(whe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Bb,{children:"Mes"}),a.jsx(Bb,{children:"Area"}),a.jsx(Bb,{children:"Rechazos"})]})}),a.jsx("tbody",{children:l.items.length===0?a.jsx("tr",{children:a.jsx(Tg,{colSpan:3,style:{textAlign:"center"},children:"No hay datos de rechazos para el ano seleccionado"})}):l.items.map((M,A)=>a.jsxs("tr",{children:[a.jsx(Tg,{style:{fontWeight:600},children:M.mes}),a.jsx(Tg,{children:a.jsx(khe,{$color:Ub[M.area_nombre||""]||"#6B7280",children:M.area_nombre||"Sin area"})}),a.jsx(Tg,{style:{fontWeight:600,color:d.colors.danger},children:M.total_rechazos})]},A))})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,na,aa,ra,dh);const Mhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Ohe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Rhe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Nhe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,zhe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Ihe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Lhe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Bhe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Uhe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Vhe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Ag=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Fg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Dg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Hhe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,n2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Whe=p(n2)`
  grid-column: 1 / -1;
`,Vb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Ghe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ud=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,fc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,qhe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Khe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Xhe=p.span`
  font-size: 0.75rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  background: ${({$trend:e})=>e==="up"?`${d.colors.success}20`:e==="down"?`${d.colors.danger}20`:`${d.colors.textSecondary}20`};
  color: ${({$trend:e})=>e==="up"?d.colors.success:e==="down"?d.colors.danger:d.colors.textSecondary};
`;function Yhe({onNavigate:e}){const[t,r]=C.useState(new Date().getFullYear()),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),u=async()=>{i(!0),o(null);try{const y=await ta.getCargaMensual(t);c(y)}catch(y){console.error("Error fetching report:",y),o("Error al cargar los datos del reporte.")}finally{i(!1)}};C.useEffect(()=>{u()},[t]);const h=C.useMemo(()=>{if(!l)return[];let y=0;return l.items.map(b=>(y+=b.total_ots-b.ots_completadas,{...b,pendientesAcum:Math.max(0,y),balance:b.total_ots-b.ots_completadas}))},[l]),f=C.useMemo(()=>h.length?{labels:h.map(y=>y.mes),datasets:[{label:"OTs Nuevas",data:h.map(y=>y.ots_nuevas),backgroundColor:d.colors.primary},{label:"OTs Completadas",data:h.map(y=>y.ots_completadas),backgroundColor:d.colors.success}]}:null,[h]),m=C.useMemo(()=>h.length?{labels:h.map(y=>y.mes),datasets:[{label:"OTs Activas",data:h.map(y=>y.ots_activas),borderColor:"#7C3AED",backgroundColor:"#7C3AED20",fill:!0,tension:.3},{label:"Pendientes Acum.",data:h.map(y=>y.pendientesAcum),borderColor:d.colors.warning,backgroundColor:`${d.colors.warning}20`,fill:!0,tension:.3}]}:null,[h]),_={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},v=y=>y<0?"up":y>5?"down":"stable";return a.jsxs(Mhe,{children:[a.jsx(Ohe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Rhe,{children:"Carga de OTs por Mes"}),a.jsx(Nhe,{children:a.jsxs(zhe,{children:[a.jsxs(Ihe,{children:[a.jsx(Lhe,{children:"Ano"}),a.jsx(Bhe,{value:t,onChange:y=>r(Number(y.target.value)),children:Array.from({length:6},(y,b)=>new Date().getFullYear()-b).map(y=>a.jsx("option",{value:y,children:y},y))})]}),a.jsx(Uhe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(Khe,{children:s}),n?a.jsx(qhe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(Vhe,{children:[a.jsxs(Ag,{$color:d.colors.primary,children:[a.jsx(Fg,{children:l.total_anual}),a.jsx(Dg,{children:"OTs Totales (Ano)"})]}),a.jsxs(Ag,{$color:d.colors.success,children:[a.jsx(Fg,{children:l.items.reduce((y,b)=>y+b.ots_completadas,0)}),a.jsx(Dg,{children:"OTs Completadas (Ano)"})]}),a.jsxs(Ag,{$color:"#7C3AED",children:[a.jsx(Fg,{children:l.promedio_mensual.toFixed(0)}),a.jsx(Dg,{children:"Promedio Mensual"})]}),a.jsxs(Ag,{$color:d.colors.warning,children:[a.jsx(Fg,{children:h.length>0?h[h.length-1].ots_activas:0}),a.jsx(Dg,{children:"OTs Activas Actuales"})]})]}),a.jsxs(Hhe,{children:[f&&a.jsxs(n2,{children:[a.jsx(Vb,{children:"OTs Creadas vs Completadas"}),a.jsx(ia,{data:f,options:_})]}),m&&a.jsxs(n2,{children:[a.jsx(Vb,{children:"Tendencia de Carga"}),a.jsx(Sd,{data:m,options:g})]})]}),a.jsxs(Whe,{children:[a.jsx(Vb,{children:"Detalle Mensual"}),a.jsxs(Ghe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ud,{children:"Mes"}),a.jsx(Ud,{children:"OTs Nuevas"}),a.jsx(Ud,{children:"OTs Completadas"}),a.jsx(Ud,{children:"Balance"}),a.jsx(Ud,{children:"OTs Activas"}),a.jsx(Ud,{children:"Tendencia"})]})}),a.jsx("tbody",{children:h.length===0?a.jsx("tr",{children:a.jsx(fc,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):h.map(y=>a.jsxs("tr",{children:[a.jsx(fc,{style:{fontWeight:600},children:y.mes}),a.jsx(fc,{children:y.ots_nuevas}),a.jsx(fc,{children:y.ots_completadas}),a.jsxs(fc,{style:{color:y.balance>0?d.colors.danger:d.colors.success},children:[y.balance>0?"+":"",y.balance]}),a.jsx(fc,{children:y.ots_activas}),a.jsx(fc,{children:a.jsx(Xhe,{$trend:v(y.balance),children:v(y.balance)==="up"?" Eficiente":v(y.balance)==="down"?" Acumulando":" Estable"})})]},y.mes))})]})]})]})]})}en.register(hn,fn,Zr,ga,na,aa,ra);const Qhe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Jhe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Zhe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,efe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,tfe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,IA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,LA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,BA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Hb=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,rfe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Pg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Mg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Og=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,nfe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,Wb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Gb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,afe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Vd=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,pc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,ife=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,sfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,ofe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,lfe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,UA={"Cancelacion del cliente":"#DC2626","Error en especificaciones":"#D97706",Duplicado:"#7C3AED","Cambio de prioridades":"#059669",Otros:"#6B7280"},cfe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function dfe({onNavigate:e}){var F,w;const t=cfe(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState(1),[c,u]=C.useState(!0),[h,f]=C.useState(null),[m,_]=C.useState(null),g=async()=>{u(!0),f(null);try{const P=await ta.getAnulaciones({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});_(P)}catch(P){console.error("Error fetching report:",P),f("Error al cargar los datos del reporte.")}finally{u(!1)}};C.useEffect(()=>{g()},[o]);const v=()=>{l(1),g()},y=C.useMemo(()=>{if(!m)return[];const P={};return m.items.forEach(M=>{const A=M.motivo||"Otros";P[A]||(P[A]=0),P[A]++}),Object.entries(P).map(([M,A])=>({motivo:M,cantidad:A})).sort((M,A)=>A.cantidad-M.cantidad)},[m]),b=C.useMemo(()=>{var M;return(M=m==null?void 0:m.por_mes)!=null&&M.length?(m.por_mes.reduce((A,D)=>A+D.cantidad,0)/m.por_mes.length).toFixed(1):0},[m]),x=C.useMemo(()=>{var P;return(P=m==null?void 0:m.por_mes)!=null&&P.length?{labels:m.por_mes.map(M=>M.mes),datasets:[{label:"Anulaciones",data:m.por_mes.map(M=>M.cantidad),backgroundColor:d.colors.danger}]}:null},[m]),j=C.useMemo(()=>y.length?{labels:y.map(P=>P.motivo),datasets:[{data:y.map(P=>P.cantidad),backgroundColor:y.map(P=>UA[P.motivo]||"#6B7280"),borderWidth:0}]}:null,[y]),S=((F=y[0])==null?void 0:F.motivo)||"-",T=(w=m==null?void 0:m.por_mes)!=null&&w.length?m.por_mes[m.por_mes.length-1].cantidad:0;return a.jsxs(Qhe,{children:[a.jsx(Jhe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Zhe,{children:"Anulaciones de OTs"}),a.jsx(efe,{children:a.jsxs(tfe,{children:[a.jsxs(IA,{children:[a.jsx(LA,{children:"Desde"}),a.jsx(BA,{type:"date",value:r,onChange:P=>n(P.target.value)})]}),a.jsxs(IA,{children:[a.jsx(LA,{children:"Hasta"}),a.jsx(BA,{type:"date",value:i,onChange:P=>s(P.target.value)})]}),a.jsx(Hb,{$variant:"primary",onClick:v,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(ofe,{children:h}),c?a.jsx(sfe,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(rfe,{children:[a.jsxs(Pg,{$color:d.colors.danger,children:[a.jsx(Mg,{children:m.total}),a.jsx(Og,{children:"Total Anulaciones"})]}),a.jsxs(Pg,{$color:d.colors.warning,children:[a.jsx(Mg,{children:b}),a.jsx(Og,{children:"Promedio Mensual"})]}),a.jsxs(Pg,{$color:d.colors.primary,children:[a.jsx(Mg,{children:T}),a.jsx(Og,{children:"Ultimo Mes"})]}),a.jsxs(Pg,{$color:"#7C3AED",children:[a.jsx(Mg,{children:S.split(" ")[0]}),a.jsx(Og,{children:"Motivo Principal"})]})]}),a.jsxs(nfe,{children:[x&&a.jsxs(Wb,{children:[a.jsx(Gb,{children:"Anulaciones por Mes"}),a.jsx(ia,{data:x,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),j&&a.jsxs(Wb,{children:[a.jsx(Gb,{children:"Distribucion por Motivo"}),a.jsx(kp,{data:j,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]})]}),a.jsxs(Wb,{children:[a.jsxs(Gb,{children:["Ultimas Anulaciones (",m.total," registros)"]}),a.jsxs(afe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Vd,{children:"OT ID"}),a.jsx(Vd,{children:"Cliente"}),a.jsx(Vd,{children:"Descripcion"}),a.jsx(Vd,{children:"Motivo"}),a.jsx(Vd,{children:"Fecha"}),a.jsx(Vd,{children:"Usuario"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(pc,{colSpan:6,style:{textAlign:"center"},children:"No hay anulaciones en el periodo seleccionado"})}):m.items.map(P=>{var M;return a.jsxs("tr",{children:[a.jsxs(pc,{style:{fontWeight:600},children:["#",P.id]}),a.jsx(pc,{children:P.client_name||"Sin cliente"}),a.jsxs(pc,{children:[((M=P.descripcion)==null?void 0:M.substring(0,40))||"-","..."]}),a.jsx(pc,{children:a.jsx(ife,{$color:UA[P.motivo||"Otros"]||"#6B7280",children:P.motivo||"Sin motivo"})}),a.jsx(pc,{children:P.fecha}),a.jsx(pc,{children:P.usuario})]},P.id)})})]}),m.total_pages>1&&a.jsxs(lfe,{children:[a.jsx(Hb,{onClick:()=>l(P=>Math.max(1,P-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Hb,{onClick:()=>l(P=>Math.min(m.total_pages,P+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}en.register(hn,fn,Zr,Br,Jn,na,aa,ra);const ufe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,hfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,ffe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,pfe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,mfe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Rg=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Ng=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,qb=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,gfe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,xfe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,vfe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,hf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,ff=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,pf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,_fe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,zg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Ig=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,VA=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Ui=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Aa=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,HA=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,yfe=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
    border-radius: 4px;
  }
`,Kb=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,bfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,WA={"Diseno Grafico":"#4F46E5","Diseno Estructural":"#059669","Pre-Prensa":"#D97706",Cotizaciones:"#7C3AED","Sala de Muestras":"#DC2626","Area de Ventas":"#0891B2",Catalogacion:"#BE185D"},jfe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function wfe({onNavigate:e}){const t=jfe(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState("todas"),[c,u]=C.useState(""),[h,f]=C.useState(!0),[m,_]=C.useState(null),[g,v]=C.useState(null),y=async()=>{f(!0),_(null);try{const w=await ta.getOTsCompletadas({date_desde:r,date_hasta:i,area_id:o!=="todas"?parseInt(o):void 0,page_size:100});v(w)}catch(w){console.error("Error fetching report:",w),_("Error al cargar los datos del reporte.")}finally{f(!1)}};C.useEffect(()=>{y()},[]);const b=C.useMemo(()=>{var w,P,M,A;return g?{total:((w=g.resumen)==null?void 0:w.total)||g.total||0,enPlazo:((P=g.resumen)==null?void 0:P.en_plazo)||0,fueraPlazo:((M=g.resumen)==null?void 0:M.fuera_plazo)||0,promedioDias:((A=g.resumen)==null?void 0:A.promedio_dias)||0}:{total:0,enPlazo:0,fueraPlazo:0,promedioDias:0}},[g]),x=C.useMemo(()=>{if(!(g!=null&&g.items))return[];const w={};g.items.forEach(M=>{const A=M.area_nombre||"Sin Area";w[A]=(w[A]||0)+1});const P=g.items.length||1;return Object.entries(w).map(([M,A])=>({area:M,completadas:A,porcentaje:A/P*100})).sort((M,A)=>A.completadas-M.completadas)},[g]),j=C.useMemo(()=>{if(!(g!=null&&g.items))return[];const w={};return g.items.forEach(P=>{const M=new Date(P.completed_at||P.created_at),D=`Sem ${Math.ceil(M.getDate()/7)}`;w[D]||(w[D]={completadas:0,enPlazo:0,fueraPlazo:0}),w[D].completadas++,P.en_plazo?w[D].enPlazo++:w[D].fueraPlazo++}),Object.entries(w).map(([P,M])=>({week:P,...M})).sort((P,M)=>P.week.localeCompare(M.week))},[g]),S=b.total>0?(b.enPlazo/b.total*100).toFixed(1):"0",T=C.useMemo(()=>({labels:j.map(w=>w.week),datasets:[{label:"En Plazo",data:j.map(w=>w.enPlazo),backgroundColor:d.colors.success},{label:"Fuera de Plazo",data:j.map(w=>w.fueraPlazo),backgroundColor:d.colors.danger}]}),[j]),F=C.useMemo(()=>({labels:j.map(w=>w.week),datasets:[{label:"OTs Completadas",data:j.map(w=>w.completadas),borderColor:d.colors.primary,backgroundColor:`${d.colors.primary}20`,fill:!0,tension:.4}]}),[j]);return a.jsxs(ufe,{children:[a.jsx(hfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(ffe,{children:"OTs Completadas Entre Fechas"}),a.jsx(pfe,{children:a.jsxs(mfe,{children:[a.jsxs(Rg,{children:[a.jsx(Ng,{children:"Fecha Desde"}),a.jsx(qb,{type:"date",value:r,onChange:w=>n(w.target.value)})]}),a.jsxs(Rg,{children:[a.jsx(Ng,{children:"Fecha Hasta"}),a.jsx(qb,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(Rg,{children:[a.jsx(Ng,{children:"Area"}),a.jsxs(gfe,{value:o,onChange:w=>l(w.target.value),children:[a.jsx("option",{value:"todas",children:"Todas las Areas"}),a.jsx("option",{value:"1",children:"Area de Ventas"}),a.jsx("option",{value:"2",children:"Diseno Estructural"}),a.jsx("option",{value:"3",children:"Diseno Grafico"}),a.jsx("option",{value:"4",children:"Pre-Prensa"}),a.jsx("option",{value:"5",children:"Cotizaciones"}),a.jsx("option",{value:"6",children:"Sala de Muestras"})]})]}),a.jsxs(Rg,{children:[a.jsx(Ng,{children:"Cliente"}),a.jsx(qb,{type:"text",placeholder:"Buscar cliente...",value:c,onChange:w=>u(w.target.value)})]}),a.jsx(xfe,{$variant:"primary",onClick:y,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(bfe,{children:m}),h?a.jsx(Kb,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(vfe,{children:[a.jsxs(hf,{$color:d.colors.primary,children:[a.jsx(ff,{children:b.total}),a.jsx(pf,{children:"Total Completadas"})]}),a.jsxs(hf,{$color:d.colors.success,children:[a.jsx(ff,{children:b.enPlazo}),a.jsx(pf,{children:"En Plazo"})]}),a.jsxs(hf,{$color:d.colors.danger,children:[a.jsx(ff,{children:b.fueraPlazo}),a.jsx(pf,{children:"Fuera de Plazo"})]}),a.jsxs(hf,{$color:d.colors.warning,children:[a.jsxs(ff,{children:[S,"%"]}),a.jsx(pf,{children:"% Cumplimiento"})]}),a.jsxs(hf,{$color:"#7C3AED",children:[a.jsx(ff,{children:b.promedioDias.toFixed(1)}),a.jsx(pf,{children:"Dias Promedio"})]})]}),a.jsxs(_fe,{children:[a.jsxs(zg,{children:[a.jsx(Ig,{children:"Completadas por Semana"}),j.length>0?a.jsx(ia,{data:T,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}}):a.jsx(Kb,{children:"No hay datos para mostrar"})]}),a.jsxs(zg,{children:[a.jsx(Ig,{children:"Tendencia de Completadas"}),j.length>0?a.jsx(Sd,{data:F,options:{responsive:!0,plugins:{legend:{display:!1}}}}):a.jsx(Kb,{children:"No hay datos para mostrar"})]})]}),a.jsxs(zg,{style:{marginBottom:"1.5rem"},children:[a.jsx(Ig,{children:"Distribucion por Area"}),a.jsxs(VA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ui,{children:"Area"}),a.jsx(Ui,{children:"Completadas"}),a.jsx(Ui,{children:"Porcentaje"}),a.jsx(Ui,{style:{width:"40%"},children:"Progreso"})]})}),a.jsx("tbody",{children:x.length===0?a.jsx("tr",{children:a.jsx(Aa,{colSpan:4,style:{textAlign:"center"},children:"No hay datos"})}):x.map(w=>a.jsxs("tr",{children:[a.jsx(Aa,{children:a.jsx(HA,{$color:WA[w.area]||"#6B7280",children:w.area})}),a.jsx(Aa,{style:{fontWeight:600},children:w.completadas}),a.jsxs(Aa,{children:[w.porcentaje.toFixed(1),"%"]}),a.jsx(Aa,{children:a.jsx(yfe,{$value:w.porcentaje,$color:WA[w.area]||"#6B7280"})})]},w.area))})]})]}),a.jsxs(zg,{children:[a.jsxs(Ig,{children:["Detalle de OTs Completadas (",g.items.length," registros)"]}),a.jsxs(VA,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Ui,{children:"OT ID"}),a.jsx(Ui,{children:"Cliente"}),a.jsx(Ui,{children:"Descripcion"}),a.jsx(Ui,{children:"Creacion"}),a.jsx(Ui,{children:"Completada"}),a.jsx(Ui,{children:"Dias"}),a.jsx(Ui,{children:"Estado"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Aa,{colSpan:7,style:{textAlign:"center"},children:"No hay OTs completadas en el rango de fechas seleccionado"})}):g.items.slice(0,50).map(w=>{var M;const P=w.dias_proceso||Math.round((new Date(w.completed_at).getTime()-new Date(w.created_at).getTime())/864e5);return a.jsxs("tr",{children:[a.jsxs(Aa,{style:{fontWeight:600},children:["#",w.id]}),a.jsx(Aa,{children:w.client_name||"Sin cliente"}),a.jsx(Aa,{children:((M=w.descripcion)==null?void 0:M.substring(0,30))||"-"}),a.jsx(Aa,{children:new Date(w.created_at).toLocaleDateString()}),a.jsx(Aa,{children:new Date(w.completed_at).toLocaleDateString()}),a.jsx(Aa,{style:{fontWeight:600},children:P}),a.jsx(Aa,{children:a.jsx(HA,{$color:w.en_plazo?d.colors.success:d.colors.danger,children:w.en_plazo?"En Plazo":"Fuera Plazo"})})]},w.id)})})]})]})]})]})}en.register(hn,fn,Zr,ga,na,aa,ra);const kfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Sfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Cfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,$fe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Efe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Tfe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Afe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,mf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,gf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,xf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Ffe=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,Xb=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Yb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Dfe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,vf=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Hd=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Pfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,Mfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  ${({$level:e})=>{switch(e){case"critical":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;case"warning":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.success}20; color: ${d.colors.success};`}}}
`,Ofe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Rfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,GA={Ventas:"#4F46E5",Desarrollo:"#059669",Diseno:"#D97706",Catalogacion:"#DC2626",Precatalogacion:"#7C3AED",Muestra:"#0891B2"};function Nfe({onNavigate:e}){var _,g,v;const[t,r]=C.useState(!0),[n,i]=C.useState(null),[s,o]=C.useState(null),l=async()=>{r(!0),i(null);try{const y=await ta.getGestionOTsActivas();o(y)}catch(y){console.error("Error fetching report:",y),i("Error al cargar los datos del reporte.")}finally{r(!1)}};C.useEffect(()=>{l()},[]);const c=C.useMemo(()=>s!=null&&s.por_area?s.por_area.reduce((y,b)=>y+b.ots_atrasadas,0):0,[s]),u=C.useMemo(()=>{var x;if(!((x=s==null?void 0:s.por_area)!=null&&x.length))return 0;const y=s.por_area.reduce((j,S)=>j+S.dias_promedio*S.total_ots,0),b=s.por_area.reduce((j,S)=>j+S.total_ots,0);return b>0?(y/b).toFixed(1):"0"},[s]),h=C.useMemo(()=>{var y;return(y=s==null?void 0:s.por_area)!=null&&y.length?{labels:s.por_area.map(b=>b.area_nombre),datasets:[{label:"Normal",data:s.por_area.map(b=>Math.max(0,b.total_ots-b.ots_atrasadas)),backgroundColor:d.colors.success},{label:"Atrasadas",data:s.por_area.map(b=>b.ots_atrasadas),backgroundColor:d.colors.danger}]}:null},[s]),f=C.useMemo(()=>{var y;return(y=s==null?void 0:s.por_area)!=null&&y.length?{labels:s.por_area.map(b=>b.area_nombre),datasets:[{data:s.por_area.map(b=>b.total_ots),backgroundColor:s.por_area.map(b=>GA[b.area_nombre]||"#6B7280"),borderWidth:0}]}:null},[s]),m=(y,b)=>{const x=b>0?y/b*100:0;return x>20?"critical":x>10?"warning":"normal"};return a.jsxs(kfe,{children:[a.jsx(Sfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Cfe,{children:"Gestion de OTs Activas"}),a.jsx($fe,{children:a.jsx(Efe,{children:a.jsx(Tfe,{$variant:"primary",onClick:l,disabled:t,children:t?"Cargando...":"Actualizar"})})}),n&&a.jsx(Rfe,{children:n}),t?a.jsx(Ofe,{children:"Cargando datos del reporte..."}):s&&a.jsxs(a.Fragment,{children:[a.jsxs(Afe,{children:[a.jsxs(mf,{$color:d.colors.primary,children:[a.jsx(gf,{children:s.total_activas}),a.jsx(xf,{children:"Total OTs Activas"})]}),a.jsxs(mf,{$color:d.colors.success,children:[a.jsx(gf,{children:s.total_activas-c}),a.jsx(xf,{children:"En Tiempo"})]}),a.jsxs(mf,{$color:d.colors.danger,children:[a.jsx(gf,{children:c}),a.jsx(xf,{children:"Atrasadas"})]}),a.jsxs(mf,{$color:d.colors.warning,children:[a.jsxs(gf,{children:[u,"d"]}),a.jsx(xf,{children:"Dias Promedio"})]}),a.jsxs(mf,{$color:"#7C3AED",children:[a.jsx(gf,{children:((_=s.por_area)==null?void 0:_.length)||0}),a.jsx(xf,{children:"Areas con OTs"})]})]}),a.jsxs(Ffe,{children:[h&&a.jsxs(Xb,{children:[a.jsx(Yb,{children:"Estado de OTs por Area"}),a.jsx(ia,{data:h,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{stacked:!0},y:{stacked:!0}}}})]}),f&&a.jsxs(Xb,{children:[a.jsx(Yb,{children:"Distribucion por Area"}),a.jsx(kp,{data:f,options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})]})]}),a.jsxs(Xb,{children:[a.jsx(Yb,{children:"Detalle por Area"}),a.jsxs(Dfe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(vf,{children:"Area"}),a.jsx(vf,{children:"Total OTs"}),a.jsx(vf,{children:"Dias Promedio"}),a.jsx(vf,{children:"Atrasadas"}),a.jsx(vf,{children:"Estado"})]})}),a.jsx("tbody",{children:((g=s.por_area)==null?void 0:g.length)===0?a.jsx("tr",{children:a.jsx(Hd,{colSpan:5,style:{textAlign:"center"},children:"No hay OTs activas actualmente"})}):(v=s.por_area)==null?void 0:v.map(y=>a.jsxs("tr",{children:[a.jsx(Hd,{children:a.jsx(Pfe,{$color:GA[y.area_nombre]||"#6B7280",children:y.area_nombre})}),a.jsx(Hd,{style:{fontWeight:600},children:y.total_ots}),a.jsxs(Hd,{children:[y.dias_promedio.toFixed(1),"d"]}),a.jsx(Hd,{style:{fontWeight:600,color:y.ots_atrasadas>0?d.colors.danger:"inherit"},children:y.ots_atrasadas}),a.jsx(Hd,{children:a.jsx(Mfe,{$level:m(y.ots_atrasadas,y.total_ots),children:m(y.ots_atrasadas,y.total_ots)==="critical"?"Critico":m(y.ots_atrasadas,y.total_ots)==="warning"?"Alerta":"Normal"})})]},y.area_id||y.area_nombre))})]})]})]})]})}en.register(hn,fn,Zr,Br,Jn,na,aa,ra,dh);const zfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Ife=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,Lfe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Bfe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Ufe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,qA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,KA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,XA=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,Qb=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Vfe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Lg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Bg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Ug=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Hfe=p.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
`,YA=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,QA=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Wfe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,mc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Xo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Gfe=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,qfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Kfe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Xfe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,Yfe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function Qfe({onNavigate:e}){const t=Yfe(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState(1),[c,u]=C.useState(!0),[h,f]=C.useState(null),[m,_]=C.useState(null),g=async()=>{u(!0),f(null);try{const b=await ta.getTiempoPrimeraMuestra({page:o,page_size:20,date_desde:r||void 0,date_hasta:i||void 0});_(b)}catch(b){console.error("Error fetching report:",b),f("Error al cargar los datos del reporte.")}finally{u(!1)}};C.useEffect(()=>{g()},[o]);const v=()=>{l(1),g()},y=C.useMemo(()=>{var j;if(!((j=m==null?void 0:m.items)!=null&&j.length))return null;const b=[{label:"0-5 dias",min:0,max:5,color:d.colors.success},{label:"6-10 dias",min:6,max:10,color:"#60A5FA"},{label:"11-15 dias",min:11,max:15,color:d.colors.warning},{label:"16+ dias",min:16,max:999,color:d.colors.danger}],x=b.map(S=>m.items.filter(T=>T.dias_hasta_muestra!==null&&T.dias_hasta_muestra>=S.min&&T.dias_hasta_muestra<=S.max).length);return{labels:b.map(S=>S.label),datasets:[{label:"OTs",data:x,backgroundColor:b.map(S=>S.color)}]}},[m]);return a.jsxs(zfe,{children:[a.jsx(Ife,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(Lfe,{children:"Tiempo Primera Muestra"}),a.jsx(Bfe,{children:a.jsxs(Ufe,{children:[a.jsxs(qA,{children:[a.jsx(KA,{children:"Desde"}),a.jsx(XA,{type:"date",value:r,onChange:b=>n(b.target.value)})]}),a.jsxs(qA,{children:[a.jsx(KA,{children:"Hasta"}),a.jsx(XA,{type:"date",value:i,onChange:b=>s(b.target.value)})]}),a.jsx(Qb,{$variant:"primary",onClick:v,disabled:c,children:c?"Cargando...":"Filtrar"})]})}),h&&a.jsx(Kfe,{children:h}),c?a.jsx(qfe,{children:"Cargando datos del reporte..."}):m&&a.jsxs(a.Fragment,{children:[a.jsxs(Vfe,{children:[a.jsxs(Lg,{$color:d.colors.primary,children:[a.jsx(Bg,{children:m.total}),a.jsx(Ug,{children:"Total OTs"})]}),a.jsxs(Lg,{$color:d.colors.warning,children:[a.jsxs(Bg,{children:[m.promedio_dias.toFixed(1),"d"]}),a.jsx(Ug,{children:"Tiempo Promedio"})]}),a.jsxs(Lg,{$color:d.colors.success,children:[a.jsxs(Bg,{children:[m.minimo_dias.toFixed(1),"d"]}),a.jsx(Ug,{children:"Tiempo Minimo"})]}),a.jsxs(Lg,{$color:d.colors.danger,children:[a.jsxs(Bg,{children:[m.maximo_dias.toFixed(1),"d"]}),a.jsx(Ug,{children:"Tiempo Maximo"})]})]}),a.jsx(Hfe,{children:y&&a.jsxs(YA,{children:[a.jsx(QA,{children:"Distribucion por Tiempo hasta Primera Muestra"}),a.jsx(ia,{data:y,options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})]})}),a.jsxs(YA,{children:[a.jsxs(QA,{children:["Detalle de OTs (",m.total," registros)"]}),a.jsxs(Wfe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(mc,{children:"OT ID"}),a.jsx(mc,{children:"Cliente"}),a.jsx(mc,{children:"Descripcion"}),a.jsx(mc,{children:"Creacion"}),a.jsx(mc,{children:"Primera Muestra"}),a.jsx(mc,{children:"Dias"}),a.jsx(mc,{children:"Estado"})]})}),a.jsx("tbody",{children:m.items.length===0?a.jsx("tr",{children:a.jsx(Xo,{colSpan:7,style:{textAlign:"center"},children:"No hay datos en el periodo seleccionado"})}):m.items.map(b=>{var x;return a.jsxs("tr",{children:[a.jsxs(Xo,{style:{fontWeight:600},children:["#",b.id]}),a.jsx(Xo,{children:b.client_name||"Sin cliente"}),a.jsxs(Xo,{children:[((x=b.descripcion)==null?void 0:x.substring(0,40))||"-","..."]}),a.jsx(Xo,{children:b.created_at}),a.jsx(Xo,{children:b.primera_muestra_at||"-"}),a.jsx(Xo,{style:{fontWeight:600,color:b.dias_hasta_muestra===null?d.colors.textSecondary:b.dias_hasta_muestra<=10?d.colors.success:b.dias_hasta_muestra<=15?d.colors.warning:d.colors.danger},children:b.dias_hasta_muestra!==null?`${b.dias_hasta_muestra}d`:"Pendiente"}),a.jsx(Xo,{children:a.jsx(Gfe,{$color:b.dias_hasta_muestra!==null?d.colors.success:d.colors.warning,children:b.dias_hasta_muestra!==null?"Con muestra":"Sin muestra"})})]},b.id)})})]}),m.total_pages>1&&a.jsxs(Xfe,{children:[a.jsx(Qb,{onClick:()=>l(b=>Math.max(1,b-1)),disabled:o===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",o," de ",m.total_pages]}),a.jsx(Qb,{onClick:()=>l(b=>Math.min(m.total_pages,b+1)),disabled:o===m.total_pages,children:"Siguiente"})]})]})]})]})}en.register(hn,fn,Zr,ga,Br,Jn,na,aa,ra,dh);const Jfe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Zfe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,e0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,t0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,r0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,JA=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ZA=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,e3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,n0e=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,a0e=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Vg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Hg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Wg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,i0e=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: 1fr 1fr; }
  @media (max-width: 768px) { grid-template-columns: 1fr; }
`,_f=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,yf=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,t3=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,gc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Yo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,s0e=p.span`
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  background: ${({$color:e})=>`${e}20`};
  color: ${({$color:e})=>e};
`,o0e=p.div`
  height: 8px;
  background: ${d.colors.bgLight};
  border-radius: 4px;
  overflow: hidden;
  &::after {
    content: '';
    display: block;
    height: 100%;
    width: ${({$value:e})=>Math.min(e,100)}%;
    background: ${({$color:e})=>e};
  }
`,l0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,c0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,bf={"Error de diseno":"#DC2626","Colores incorrectos":"#D97706","Dimensiones erroneas":"#7C3AED","Materiales inadecuados":"#059669","Texto ilegible":"#4F46E5",Otros:"#6B7280"},d0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function u0e({onNavigate:e}){var j,S,T;const t=d0e(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState(!0),[c,u]=C.useState(null),[h,f]=C.useState(null),m=async()=>{l(!0),u(null);try{const F=await ta.getMotivosRechazo({date_desde:r||void 0,date_hasta:i||void 0});f(F)}catch(F){console.error("Error fetching report:",F),u("Error al cargar los datos del reporte.")}finally{l(!1)}};C.useEffect(()=>{m()},[]);const _=()=>{m()},g=((j=h==null?void 0:h.items)==null?void 0:j[0])||null,v=(S=h==null?void 0:h.por_mes)!=null&&S.length?h.por_mes[h.por_mes.length-1]:null,y=C.useMemo(()=>{var F;return(F=h==null?void 0:h.items)!=null&&F.length?{labels:h.items.map(w=>w.motivo),datasets:[{data:h.items.map(w=>w.cantidad),backgroundColor:h.items.map(w=>bf[w.motivo]||"#6B7280"),borderWidth:0}]}:null},[h]),b=C.useMemo(()=>{var F;return(F=h==null?void 0:h.items)!=null&&F.length?{labels:h.items.map(w=>w.motivo),datasets:[{label:"Rechazos",data:h.items.map(w=>w.cantidad),backgroundColor:h.items.map(w=>bf[w.motivo]||"#6B7280")}]}:null},[h]),x=C.useMemo(()=>{var F;return(F=h==null?void 0:h.por_mes)!=null&&F.length?{labels:h.por_mes.map(w=>w.mes),datasets:[{label:"Cantidad Rechazos",data:h.por_mes.map(w=>w.cantidad),borderColor:d.colors.danger,backgroundColor:`${d.colors.danger}20`,fill:!0,tension:.4}]}:null},[h]);return a.jsxs(Jfe,{children:[a.jsx(Zfe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(e0e,{children:"Motivos de Rechazo"}),a.jsx(t0e,{children:a.jsxs(r0e,{children:[a.jsxs(JA,{children:[a.jsx(ZA,{children:"Desde"}),a.jsx(e3,{type:"date",value:r,onChange:F=>n(F.target.value)})]}),a.jsxs(JA,{children:[a.jsx(ZA,{children:"Hasta"}),a.jsx(e3,{type:"date",value:i,onChange:F=>s(F.target.value)})]}),a.jsx(n0e,{$variant:"primary",onClick:_,disabled:o,children:o?"Cargando...":"Filtrar"})]})}),c&&a.jsx(c0e,{children:c}),o?a.jsx(l0e,{children:"Cargando datos del reporte..."}):h&&a.jsxs(a.Fragment,{children:[a.jsxs(a0e,{children:[a.jsxs(Vg,{$color:d.colors.danger,children:[a.jsx(Hg,{children:h.total}),a.jsx(Wg,{children:"Total Rechazos"})]}),a.jsxs(Vg,{$color:g?bf[g.motivo]||"#6B7280":d.colors.warning,children:[a.jsx(Hg,{children:(g==null?void 0:g.cantidad)||0}),a.jsxs(Wg,{children:["Motivo: ",(g==null?void 0:g.motivo)||"-"]})]}),a.jsxs(Vg,{$color:d.colors.primary,children:[a.jsx(Hg,{children:((T=h.items)==null?void 0:T.length)||0}),a.jsx(Wg,{children:"Tipos de Motivos"})]}),a.jsxs(Vg,{$color:d.colors.success,children:[a.jsx(Hg,{children:(v==null?void 0:v.cantidad)||0}),a.jsx(Wg,{children:"Ultimo Mes"})]})]}),a.jsxs(i0e,{children:[y&&a.jsxs(_f,{children:[a.jsx(yf,{children:"Distribucion por Motivo"}),a.jsx(bS,{data:y,options:{responsive:!0,plugins:{legend:{position:"right"}}}})]}),b&&a.jsxs(_f,{children:[a.jsx(yf,{children:"Rechazos por Motivo"}),a.jsx(ia,{data:b,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),x&&a.jsxs(_f,{children:[a.jsx(yf,{children:"Tendencia Mensual"}),a.jsx(Sd,{data:x,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})]})]}),a.jsxs(_f,{children:[a.jsx(yf,{children:"Ranking de Motivos"}),a.jsxs(t3,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(gc,{children:"#"}),a.jsx(gc,{children:"Motivo"}),a.jsx(gc,{children:"Cantidad"}),a.jsx(gc,{children:"Porcentaje"}),a.jsx(gc,{style:{width:"40%"},children:"Distribucion"})]})}),a.jsx("tbody",{children:h.items.length===0?a.jsx("tr",{children:a.jsx(Yo,{colSpan:5,style:{textAlign:"center"},children:"No hay datos de motivos de rechazo"})}):h.items.map((F,w)=>a.jsxs("tr",{children:[a.jsx(Yo,{style:{fontWeight:600},children:w+1}),a.jsx(Yo,{children:a.jsx(s0e,{$color:bf[F.motivo]||"#6B7280",children:F.motivo})}),a.jsx(Yo,{style:{fontWeight:600},children:F.cantidad}),a.jsxs(Yo,{children:[F.porcentaje.toFixed(1),"%"]}),a.jsx(Yo,{children:a.jsx(o0e,{$value:F.porcentaje*3,$color:bf[F.motivo]||"#6B7280"})})]},F.motivo))})]})]}),h.por_mes&&h.por_mes.length>0&&a.jsxs(_f,{style:{marginTop:"1.5rem"},children:[a.jsx(yf,{children:"Rechazos por Mes"}),a.jsxs(t3,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(gc,{children:"Mes"}),a.jsx(gc,{children:"Cantidad"})]})}),a.jsx("tbody",{children:h.por_mes.map(F=>a.jsxs("tr",{children:[a.jsx(Yo,{style:{fontWeight:600},children:F.mes}),a.jsx(Yo,{style:{fontWeight:600,color:d.colors.danger},children:F.cantidad})]},F.mes))})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra);const h0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,f0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,p0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,m0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,g0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,r3=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,n3=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,a3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,x0e=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,v0e=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Gg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,qg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Kg=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,_0e=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,a2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,y0e=p(a2)`
  grid-column: 1 / -1;
`,Jb=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,b0e=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,jf=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,wf=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,j0e=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$level:e})=>{switch(e){case"excellent":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"good":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"regular":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"poor":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`}}}
`,w0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,k0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,S0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  background: ${d.colors.bgLight};
  border-radius: 8px;
`,C0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=new Date(t,r,0).getDate(),i=`${t}-${String(r).padStart(2,"0")}-${String(n).padStart(2,"0")}`,s=new Date;s.setMonth(s.getMonth()-5);const o=s.getFullYear(),l=s.getMonth()+1;return{firstDay:`${o}-${String(l).padStart(2,"0")}-01`,lastDayStr:i}},$0e=e=>e<=3?"excellent":e<=5?"good":e<=7?"regular":"poor",E0e=e=>{switch(e){case"excellent":return"Excelente";case"good":return"Bueno";case"regular":return"Regular";case"poor":return"Bajo"}};function T0e({onNavigate:e}){const t=C0e(),[r,n]=C.useState(t.firstDay),[i,s]=C.useState(t.lastDayStr),[o,l]=C.useState(!0),[c,u]=C.useState(null),[h,f]=C.useState(null),m=async()=>{l(!0),u(null);try{const x=await ta.getTiempoDisenadorExterno({date_desde:r,date_hasta:i});f(x)}catch(x){console.error("Error fetching report:",x),u("Error al cargar los datos del reporte.")}finally{l(!1)}};C.useEffect(()=>{m()},[]);const _=C.useMemo(()=>{if(!h||!h.disenadores.length)return{totalDisenadores:0,totalOTs:0,tiempoPromedio:0};const x=h.disenadores.reduce((S,T)=>S+T.total_ots,0),j=h.disenadores.reduce((S,T)=>S+T.tiempo_promedio,0)/h.disenadores.length;return{totalDisenadores:h.total_disenadores,totalOTs:x,tiempoPromedio:j.toFixed(1)}},[h]),g=C.useMemo(()=>!h||!h.disenadores.length?null:{labels:h.disenadores.map(x=>x.nombre),datasets:[{label:"Tiempo Promedio (dias)",data:h.disenadores.map(x=>x.tiempo_promedio),backgroundColor:h.disenadores.map(x=>x.tiempo_promedio<=5?d.colors.success:d.colors.warning)}]},[h]),v=C.useMemo(()=>{if(!h||!h.disenadores.length)return null;const x=[d.colors.primary,d.colors.success,"#7C3AED",d.colors.warning,"#EC4899","#06B6D4","#F59E0B","#10B981"];return{labels:h.disenadores.map(j=>j.nombre),datasets:[{data:h.disenadores.map(j=>j.total_ots),backgroundColor:h.disenadores.map((j,S)=>x[S%x.length])}]}},[h]),y={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}},b={responsive:!0,plugins:{legend:{position:"right"}}};return a.jsxs(h0e,{children:[a.jsx(f0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(p0e,{children:"Tiempo Disenador Externo"}),a.jsx(m0e,{children:a.jsxs(g0e,{children:[a.jsxs(r3,{children:[a.jsx(n3,{children:"Desde"}),a.jsx(a3,{type:"date",value:r,onChange:x=>n(x.target.value)})]}),a.jsxs(r3,{children:[a.jsx(n3,{children:"Hasta"}),a.jsx(a3,{type:"date",value:i,onChange:x=>s(x.target.value)})]}),a.jsx(x0e,{$variant:"primary",onClick:m,disabled:o,children:o?"Cargando...":"Filtrar"})]})}),c&&a.jsx(k0e,{children:c}),o?a.jsx(w0e,{children:"Cargando datos del reporte..."}):h&&h.disenadores.length>0?a.jsxs(a.Fragment,{children:[a.jsxs(v0e,{children:[a.jsxs(Gg,{$color:d.colors.primary,children:[a.jsx(qg,{children:_.totalDisenadores}),a.jsx(Kg,{children:"Disenadores Activos"})]}),a.jsxs(Gg,{$color:d.colors.success,children:[a.jsx(qg,{children:_.totalOTs}),a.jsx(Kg,{children:"OTs Totales"})]}),a.jsxs(Gg,{$color:d.colors.warning,children:[a.jsxs(qg,{children:[_.tiempoPromedio,"d"]}),a.jsx(Kg,{children:"Tiempo Promedio"})]}),a.jsxs(Gg,{$color:"#7C3AED",children:[a.jsx(qg,{children:h.disenadores.filter(x=>x.tiempo_promedio<=5).length}),a.jsx(Kg,{children:"Dentro de Meta"})]})]}),a.jsxs(_0e,{children:[g&&a.jsxs(a2,{children:[a.jsx(Jb,{children:"Tiempo Promedio por Disenador"}),a.jsx(ia,{data:g,options:y})]}),v&&a.jsxs(a2,{children:[a.jsx(Jb,{children:"OTs por Disenador"}),a.jsx(kp,{data:v,options:b})]})]}),a.jsxs(y0e,{children:[a.jsx(Jb,{children:"Detalle por Disenador"}),a.jsxs(b0e,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(jf,{children:"ID"}),a.jsx(jf,{children:"Disenador"}),a.jsx(jf,{children:"OTs Totales"}),a.jsx(jf,{children:"Tiempo Promedio"}),a.jsx(jf,{children:"Performance"})]})}),a.jsx("tbody",{children:h.disenadores.map(x=>{const j=$0e(x.tiempo_promedio);return a.jsxs("tr",{children:[a.jsx(wf,{children:x.id}),a.jsx(wf,{style:{fontWeight:600},children:x.nombre}),a.jsx(wf,{children:x.total_ots}),a.jsxs(wf,{style:{color:x.tiempo_promedio<=5?d.colors.success:d.colors.warning},children:[x.tiempo_promedio.toFixed(1)," dias"]}),a.jsx(wf,{children:a.jsx(j0e,{$level:j,children:E0e(j)})})]},x.id)})})]})]})]}):a.jsx(S0e,{children:"No hay datos de disenadores externos para el periodo seleccionado."})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra);const A0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,F0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,D0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,P0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,M0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,Zb=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ej=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,O0e=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,i3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,tj=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,R0e=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,kf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Sf=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Cf=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,N0e=p.div`
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,i2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,z0e=p(i2)`
  grid-column: 1 / -1;
`,rj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,I0e=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,xc=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Qo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,L0e=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,B0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,U0e=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,V0e=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,H0e={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger},W0e=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function G0e({onNavigate:e}){const t=W0e(),[r,n]=C.useState(""),[i,s]=C.useState(t.firstDay),[o,l]=C.useState(t.lastDayStr),[c,u]=C.useState(1),[h,f]=C.useState(!0),[m,_]=C.useState(null),[g,v]=C.useState(null),y=async()=>{f(!0),_(null);try{const w=await ta.getMuestras({page:c,page_size:20,date_desde:i||void 0,date_hasta:o||void 0,estado:r||void 0});v(w)}catch(w){console.error("Error fetching report:",w),_("Error al cargar los datos del reporte.")}finally{f(!1)}};C.useEffect(()=>{y()},[c]);const b=()=>{u(1),y()},x=C.useMemo(()=>{if(!(g!=null&&g.por_estado))return{pendientes:0,en_proceso:0,completadas:0,rechazadas:0};const w={};return g.por_estado.forEach(P=>{w[P.estado]=P.cantidad}),{pendientes:w.pendiente||0,en_proceso:w.en_proceso||0,completadas:w.completada||0,rechazadas:w.rechazada||0}},[g]),j=C.useMemo(()=>{var w;return(w=g==null?void 0:g.por_estado)!=null&&w.length?{labels:g.por_estado.map(P=>P.estado),datasets:[{data:g.por_estado.map(P=>P.cantidad),backgroundColor:g.por_estado.map(P=>H0e[P.estado]||"#6B7280")}]}:null},[g]),S=C.useMemo(()=>{var w;return(w=g==null?void 0:g.por_tipo)!=null&&w.length?{labels:g.por_tipo.map(P=>P.tipo),datasets:[{label:"Muestras",data:g.por_tipo.map(P=>P.cantidad),backgroundColor:d.colors.primary}]}:null},[g]),T={responsive:!0,plugins:{legend:{position:"right"}}},F={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(A0e,{children:[a.jsx(F0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(D0e,{children:"Sala de Muestra"}),a.jsx(P0e,{children:a.jsxs(M0e,{children:[a.jsxs(Zb,{children:[a.jsx(ej,{children:"Desde"}),a.jsx(i3,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(Zb,{children:[a.jsx(ej,{children:"Hasta"}),a.jsx(i3,{type:"date",value:o,onChange:w=>l(w.target.value)})]}),a.jsxs(Zb,{children:[a.jsx(ej,{children:"Estado"}),a.jsxs(O0e,{value:r,onChange:w=>n(w.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(tj,{$variant:"primary",onClick:b,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(U0e,{children:m}),h?a.jsx(B0e,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(R0e,{children:[a.jsxs(kf,{$color:d.colors.warning,children:[a.jsx(Sf,{children:x.pendientes}),a.jsx(Cf,{children:"Pendientes"})]}),a.jsxs(kf,{$color:d.colors.primary,children:[a.jsx(Sf,{children:x.en_proceso}),a.jsx(Cf,{children:"En Proceso"})]}),a.jsxs(kf,{$color:d.colors.success,children:[a.jsx(Sf,{children:x.completadas}),a.jsx(Cf,{children:"Completadas"})]}),a.jsxs(kf,{$color:d.colors.danger,children:[a.jsx(Sf,{children:x.rechazadas}),a.jsx(Cf,{children:"Rechazadas"})]}),a.jsxs(kf,{$color:"#7C3AED",children:[a.jsx(Sf,{children:g.total}),a.jsx(Cf,{children:"Total Muestras"})]})]}),a.jsxs(N0e,{children:[S&&a.jsxs(i2,{children:[a.jsx(rj,{children:"Muestras por Tipo"}),a.jsx(ia,{data:S,options:F})]}),j&&a.jsxs(i2,{children:[a.jsx(rj,{children:"Distribucion por Estado"}),a.jsx(kp,{data:j,options:T})]})]}),a.jsxs(z0e,{children:[a.jsxs(rj,{children:["Cola de Muestras (",g.total," registros)"]}),a.jsxs(I0e,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(xc,{children:"ID"}),a.jsx(xc,{children:"OT"}),a.jsx(xc,{children:"Tipo"}),a.jsx(xc,{children:"Fecha Solicitud"}),a.jsx(xc,{children:"Completada"}),a.jsx(xc,{children:"Estado"}),a.jsx(xc,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Qo,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(w=>a.jsxs("tr",{children:[a.jsxs(Qo,{style:{fontWeight:600},children:["#",w.id]}),a.jsxs(Qo,{children:["OT-",w.ot_id]}),a.jsx(Qo,{children:w.tipo}),a.jsx(Qo,{children:w.created_at}),a.jsx(Qo,{children:w.completed_at||"-"}),a.jsx(Qo,{children:a.jsx(L0e,{$status:w.estado,children:w.estado})}),a.jsx(Qo,{children:w.responsable})]},w.id))})]}),g.total_pages>1&&a.jsxs(V0e,{children:[a.jsx(tj,{onClick:()=>u(w=>Math.max(1,w-1)),disabled:c===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",c," de ",g.total_pages]}),a.jsx(tj,{onClick:()=>u(w=>Math.min(g.total_pages,w+1)),disabled:c===g.total_pages,children:"Siguiente"})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra,dh);const q0e=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,K0e=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,X0e=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Y0e=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Q0e=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,J0e=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,Z0e=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,epe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 120px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,tpe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,rpe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
`,Xg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1.25rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
  position: relative;
`,Yg=p.div`
  font-size: 2rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Qg=p.div`
  font-size: 0.85rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,npe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,nj=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,aj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,ape=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,Wd=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,vc=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,ipe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,spe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`;function ope({onNavigate:e}){const[t,r]=C.useState(new Date().getFullYear()),[n,i]=C.useState(!0),[s,o]=C.useState(null),[l,c]=C.useState(null),u=async()=>{i(!0),o(null);try{const v=await ta.getIndicadoresSalaMuestra(t);c(v)}catch(v){console.error("Error fetching report:",v),o("Error al cargar los datos del reporte.")}finally{i(!1)}};C.useEffect(()=>{u()},[t]);const h=C.useMemo(()=>{var x;if(!((x=l==null?void 0:l.por_mes)!=null&&x.length))return{completadas:0,rechazadas:0,tasaAprobacion:0};const v=l.por_mes.reduce((j,S)=>j+S.completadas,0),y=l.por_mes.reduce((j,S)=>j+S.rechazadas,0),b=v+y;return{completadas:v,rechazadas:y,tasaAprobacion:b>0?(v/b*100).toFixed(1):"0"}},[l]),f=C.useMemo(()=>{var v;return(v=l==null?void 0:l.por_mes)!=null&&v.length?{labels:l.por_mes.map(y=>y.mes),datasets:[{label:"Tiempo Promedio (dias)",data:l.por_mes.map(y=>y.tiempo_promedio),borderColor:d.colors.primary,yAxisID:"y",tension:.3},{label:"Total Muestras",data:l.por_mes.map(y=>y.total_muestras),borderColor:d.colors.success,yAxisID:"y1",tension:.3}]}:null},[l]),m=C.useMemo(()=>{var v;return(v=l==null?void 0:l.por_mes)!=null&&v.length?{labels:l.por_mes.map(y=>y.mes),datasets:[{label:"Completadas",data:l.por_mes.map(y=>y.completadas),backgroundColor:d.colors.success},{label:"Rechazadas",data:l.por_mes.map(y=>y.rechazadas),backgroundColor:d.colors.danger}]}:null},[l]),_={responsive:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Dias"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Cantidad"},grid:{drawOnChartArea:!1}}}},g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}};return a.jsxs(q0e,{children:[a.jsx(K0e,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(X0e,{children:"Indicadores Sala de Muestra"}),a.jsx(Y0e,{children:a.jsxs(Q0e,{children:[a.jsxs(J0e,{children:[a.jsx(Z0e,{children:"Ano"}),a.jsx(epe,{value:t,onChange:v=>r(Number(v.target.value)),children:Array.from({length:6},(v,y)=>new Date().getFullYear()-y).map(v=>a.jsx("option",{value:v,children:v},v))})]}),a.jsx(tpe,{$variant:"primary",onClick:u,disabled:n,children:n?"Cargando...":"Actualizar"})]})}),s&&a.jsx(spe,{children:s}),n?a.jsx(ipe,{children:"Cargando datos del reporte..."}):l&&a.jsxs(a.Fragment,{children:[a.jsxs(rpe,{children:[a.jsxs(Xg,{$color:d.colors.primary,children:[a.jsx(Yg,{children:l.total_muestras}),a.jsx(Qg,{children:"Total Muestras (Ano)"})]}),a.jsxs(Xg,{$color:d.colors.warning,children:[a.jsxs(Yg,{children:[l.tiempo_promedio.toFixed(1),"d"]}),a.jsx(Qg,{children:"Tiempo Promedio"})]}),a.jsxs(Xg,{$color:d.colors.success,children:[a.jsx(Yg,{children:h.completadas}),a.jsx(Qg,{children:"Completadas"})]}),a.jsxs(Xg,{$color:d.colors.danger,children:[a.jsx(Yg,{children:h.rechazadas}),a.jsx(Qg,{children:"Rechazadas"})]})]}),a.jsxs(npe,{children:[f&&a.jsxs(nj,{children:[a.jsx(aj,{children:"Tendencia de KPIs"}),a.jsx(Sd,{data:f,options:_})]}),m&&a.jsxs(nj,{children:[a.jsx(aj,{children:"Completadas vs Rechazadas"}),a.jsx(ia,{data:m,options:g})]})]}),a.jsxs(nj,{children:[a.jsx(aj,{children:"Detalle por Mes"}),a.jsxs(ape,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(Wd,{children:"Mes"}),a.jsx(Wd,{children:"Total Muestras"}),a.jsx(Wd,{children:"Completadas"}),a.jsx(Wd,{children:"Rechazadas"}),a.jsx(Wd,{children:"Tiempo Prom."}),a.jsx(Wd,{children:"Tasa Aprobacion"})]})}),a.jsx("tbody",{children:l.por_mes.length===0?a.jsx("tr",{children:a.jsx(vc,{colSpan:6,style:{textAlign:"center"},children:"No hay datos para el ano seleccionado"})}):l.por_mes.map(v=>{const y=v.completadas+v.rechazadas,b=y>0?(v.completadas/y*100).toFixed(1):"0";return a.jsxs("tr",{children:[a.jsx(vc,{style:{fontWeight:600},children:v.mes}),a.jsx(vc,{children:v.total_muestras}),a.jsx(vc,{style:{color:d.colors.success,fontWeight:600},children:v.completadas}),a.jsx(vc,{style:{color:d.colors.danger,fontWeight:600},children:v.rechazadas}),a.jsxs(vc,{children:[v.tiempo_promedio.toFixed(1),"d"]}),a.jsxs(vc,{style:{color:Number(b)>=90?d.colors.success:d.colors.warning},children:[b,"%"]})]},v.mes)})})]})]})]})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra);const lpe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,cpe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,dpe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,upe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,hpe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,fpe=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,ppe=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,mpe=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,gpe=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,xpe=p.div`
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: repeat(2, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Jg=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Zg=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,ex=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,vpe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,s2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,_pe=p(s2)`
  grid-column: 1 / -1;
`,ij=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,ype=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,$f=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Ef=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,bpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,jpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,wpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
  background: ${d.colors.bgLight};
  border-radius: 8px;
`;function kpe({onNavigate:e}){const t=new Date().getFullYear(),[r,n]=C.useState(t),[i,s]=C.useState(!0),[o,l]=C.useState(null),[c,u]=C.useState(null),h=async()=>{s(!0),l(null);try{const y=await ta.getDisenoEstructuralSala(r);u(y)}catch(y){console.error("Error fetching report:",y),l("Error al cargar los datos del reporte.")}finally{s(!1)}};C.useEffect(()=>{h()},[r]);const f=C.useMemo(()=>{if(!c||!c.por_mes.length)return{totalOTs:0,tiempoPromDiseno:0,tiempoPromMuestra:0,tiempoTotal:0};const y=c.por_mes.reduce((j,S)=>j+S.total_ots,0),b=c.por_mes.reduce((j,S)=>j+S.tiempo_diseno,0)/c.por_mes.length,x=c.por_mes.reduce((j,S)=>j+S.tiempo_muestra,0)/c.por_mes.length;return{totalOTs:y,tiempoPromDiseno:b.toFixed(1),tiempoPromMuestra:x.toFixed(1),tiempoTotal:(b+x).toFixed(1)}},[c]),m=C.useMemo(()=>!c||!c.por_mes.length?null:{labels:c.por_mes.map(y=>y.mes),datasets:[{label:"OTs Totales",data:c.por_mes.map(y=>y.total_ots),backgroundColor:d.colors.primary}]},[c]),_=C.useMemo(()=>!c||!c.por_mes.length?null:{labels:c.por_mes.map(y=>y.mes),datasets:[{label:"Tiempo Diseno (dias)",data:c.por_mes.map(y=>y.tiempo_diseno),borderColor:d.colors.primary,backgroundColor:d.colors.primary+"20",fill:!0,tension:.3},{label:"Tiempo Muestra (dias)",data:c.por_mes.map(y=>y.tiempo_muestra),borderColor:d.colors.warning,backgroundColor:d.colors.warning+"20",fill:!0,tension:.3}]},[c]),g={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}},v={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Dias"}}}};return a.jsxs(lpe,{children:[a.jsx(cpe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx(dpe,{children:"Diseno Estructural y Sala de Muestra"}),a.jsx(upe,{children:a.jsxs(hpe,{children:[a.jsxs(fpe,{children:[a.jsx(ppe,{children:"Ano"}),a.jsx(mpe,{value:r,onChange:y=>n(Number(y.target.value)),children:Array.from({length:6},(y,b)=>t-b).map(y=>a.jsx("option",{value:y,children:y},y))})]}),a.jsx(gpe,{$variant:"primary",onClick:h,disabled:i,children:i?"Cargando...":"Actualizar"})]})}),o&&a.jsx(jpe,{children:o}),i?a.jsx(bpe,{children:"Cargando datos del reporte..."}):c&&c.por_mes.length>0?a.jsxs(a.Fragment,{children:[a.jsxs(xpe,{children:[a.jsxs(Jg,{$color:d.colors.primary,children:[a.jsx(Zg,{children:f.totalOTs}),a.jsx(ex,{children:"OTs Totales (Ano)"})]}),a.jsxs(Jg,{$color:d.colors.success,children:[a.jsxs(Zg,{children:[f.tiempoPromDiseno,"d"]}),a.jsx(ex,{children:"Tiempo Prom. Diseno"})]}),a.jsxs(Jg,{$color:d.colors.warning,children:[a.jsxs(Zg,{children:[f.tiempoPromMuestra,"d"]}),a.jsx(ex,{children:"Tiempo Prom. Muestra"})]}),a.jsxs(Jg,{$color:"#7C3AED",children:[a.jsxs(Zg,{children:[f.tiempoTotal,"d"]}),a.jsx(ex,{children:"Tiempo Total Prom."})]})]}),a.jsxs(vpe,{children:[m&&a.jsxs(s2,{children:[a.jsx(ij,{children:"OTs por Mes"}),a.jsx(ia,{data:m,options:g})]}),_&&a.jsxs(s2,{children:[a.jsx(ij,{children:"Tiempos Diseno vs Muestra"}),a.jsx(Sd,{data:_,options:v})]})]}),a.jsxs(_pe,{children:[a.jsxs(ij,{children:["Detalle Mensual - ",r]}),a.jsxs(ype,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx($f,{children:"Mes"}),a.jsx($f,{children:"OTs Totales"}),a.jsx($f,{children:"Tiempo Diseno (dias)"}),a.jsx($f,{children:"Tiempo Muestra (dias)"}),a.jsx($f,{children:"Tiempo Total (dias)"})]})}),a.jsx("tbody",{children:c.por_mes.map((y,b)=>a.jsxs("tr",{children:[a.jsx(Ef,{style:{fontWeight:600},children:y.mes}),a.jsx(Ef,{children:y.total_ots}),a.jsx(Ef,{style:{color:y.tiempo_diseno<=5?d.colors.success:d.colors.warning},children:y.tiempo_diseno.toFixed(1)}),a.jsx(Ef,{style:{color:y.tiempo_muestra<=3?d.colors.success:d.colors.warning},children:y.tiempo_muestra.toFixed(1)}),a.jsx(Ef,{children:(y.tiempo_diseno+y.tiempo_muestra).toFixed(1)})]},b))})]})]})]}):a.jsx(wpe,{children:"No hay datos de diseno y muestra para el ano seleccionado."})]})}en.register(hn,fn,Jn,Br,Zr,ga,na,aa,ra);const Spe=p.div`
  padding: 1.5rem;
  max-width: 100%;
`,Cpe=p.button`
  background: none;
  border: none;
  color: ${d.colors.primary};
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  &:hover { text-decoration: underline; }
`,$pe=p.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1.5rem 0;
`,Epe=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1.5rem;
`,Tpe=p.div`
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: flex-end;
`,sj=p.div`
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
`,oj=p.label`
  font-size: 0.75rem;
  font-weight: 500;
  color: ${d.colors.textSecondary};
`,Ape=p.select`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  min-width: 150px;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,s3=p.input`
  padding: 0.5rem;
  border: 1px solid ${d.colors.border};
  border-radius: 4px;
  font-size: 0.875rem;
  &:focus { outline: none; border-color: ${d.colors.primary}; }
`,lj=p.button`
  padding: 0.5rem 1rem;
  border: 1px solid ${({$variant:e})=>e==="primary"?d.colors.primary:d.colors.border};
  background: ${({$variant:e})=>e==="primary"?d.colors.primary:"white"};
  color: ${({$variant:e})=>e==="primary"?"white":d.colors.textPrimary};
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  &:hover { opacity: 0.9; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
`,Fpe=p.div`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1200px) { grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 768px) { grid-template-columns: repeat(2, 1fr); }
`,Tf=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid ${({$color:e})=>e||d.colors.primary};
`,Af=p.div`
  font-size: 1.75rem;
  font-weight: 700;
  color: ${d.colors.textPrimary};
`,Ff=p.div`
  font-size: 0.8rem;
  color: ${d.colors.textSecondary};
  margin-top: 0.25rem;
`,Dpe=p.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  @media (max-width: 1024px) { grid-template-columns: 1fr; }
`,o2=p.div`
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: 8px;
  padding: 1rem;
`,Ppe=p(o2)`
  grid-column: 1 / -1;
`,cj=p.h3`
  font-size: 1rem;
  font-weight: 600;
  color: ${d.colors.textPrimary};
  margin: 0 0 1rem 0;
`,Mpe=p.table`
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
`,_c=p.th`
  text-align: left;
  padding: 0.75rem 0.5rem;
  background: ${d.colors.bgLight};
  border-bottom: 2px solid ${d.colors.border};
  font-weight: 600;
  color: ${d.colors.textSecondary};
  font-size: 0.75rem;
  text-transform: uppercase;
`,Jo=p.td`
  padding: 0.75rem 0.5rem;
  border-bottom: 1px solid ${d.colors.border};
  color: ${d.colors.textPrimary};
`,Ope=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$status:e})=>{switch(e){case"pendiente":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;case"en_proceso":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"completada":return`background: ${d.colors.success}20; color: ${d.colors.success};`;case"rechazada":return`background: ${d.colors.danger}20; color: ${d.colors.danger};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,Rpe=p.span`
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-weight: 500;
  ${({$tipo:e})=>{switch(e==null?void 0:e.toLowerCase()){case"fisica":return`background: ${d.colors.primary}20; color: ${d.colors.primary};`;case"digital":return"background: #7C3AED20; color: #7C3AED;";case"prototipo":return`background: ${d.colors.warning}20; color: ${d.colors.warning};`;default:return`background: ${d.colors.textSecondary}20; color: ${d.colors.textSecondary};`}}}
`,Npe=p.div`
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
`,zpe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.textSecondary};
`,Ipe=p.div`
  text-align: center;
  padding: 2rem;
  color: ${d.colors.error};
  background: ${d.colors.error}10;
  border-radius: 8px;
  margin-bottom: 1rem;
`,Lpe={pendiente:d.colors.warning,en_proceso:d.colors.primary,completada:d.colors.success,rechazada:d.colors.danger},Bpe={fisica:d.colors.primary,digital:"#7C3AED",prototipo:d.colors.warning},Upe=()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=`${t}-${String(r).padStart(2,"0")}-01`,i=new Date(t,r,0).getDate(),s=`${t}-${String(r).padStart(2,"0")}-${String(i).padStart(2,"0")}`;return{firstDay:n,lastDayStr:s}};function Vpe({onNavigate:e}){const t=Upe(),[r,n]=C.useState(""),[i,s]=C.useState(t.firstDay),[o,l]=C.useState(t.lastDayStr),[c,u]=C.useState(1),[h,f]=C.useState(!0),[m,_]=C.useState(null),[g,v]=C.useState(null),y=async()=>{f(!0),_(null);try{const w=await ta.getMuestras({page:c,page_size:20,date_desde:i||void 0,date_hasta:o||void 0,estado:r||void 0});v(w)}catch(w){console.error("Error fetching report:",w),_("Error al cargar los datos del reporte.")}finally{f(!1)}};C.useEffect(()=>{y()},[c]);const b=()=>{u(1),y()},x=C.useMemo(()=>{if(!(g!=null&&g.por_estado))return{};const w={};return g.por_estado.forEach(P=>{w[P.estado]=P.cantidad}),w},[g]),j=C.useMemo(()=>{var w;return(w=g==null?void 0:g.por_tipo)!=null&&w.length?{labels:g.por_tipo.map(P=>P.tipo),datasets:[{data:g.por_tipo.map(P=>P.cantidad),backgroundColor:g.por_tipo.map(P=>Bpe[P.tipo.toLowerCase()]||"#6B7280")}]}:null},[g]),S=C.useMemo(()=>{var w;return(w=g==null?void 0:g.por_estado)!=null&&w.length?{labels:g.por_estado.map(P=>P.estado),datasets:[{label:"Cantidad",data:g.por_estado.map(P=>P.cantidad),backgroundColor:g.por_estado.map(P=>Lpe[P.estado]||"#6B7280")}]}:null},[g]),T={responsive:!0,plugins:{legend:{position:"right"}}},F={responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};return a.jsxs(Spe,{children:[a.jsx(Cpe,{onClick:()=>e("reportes"),children:" Volver a Reportes"}),a.jsx($pe,{children:"Muestras"}),a.jsx(Epe,{children:a.jsxs(Tpe,{children:[a.jsxs(sj,{children:[a.jsx(oj,{children:"Desde"}),a.jsx(s3,{type:"date",value:i,onChange:w=>s(w.target.value)})]}),a.jsxs(sj,{children:[a.jsx(oj,{children:"Hasta"}),a.jsx(s3,{type:"date",value:o,onChange:w=>l(w.target.value)})]}),a.jsxs(sj,{children:[a.jsx(oj,{children:"Estado"}),a.jsxs(Ape,{value:r,onChange:w=>n(w.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"pendiente",children:"Pendiente"}),a.jsx("option",{value:"en_proceso",children:"En Proceso"}),a.jsx("option",{value:"completada",children:"Completada"}),a.jsx("option",{value:"rechazada",children:"Rechazada"})]})]}),a.jsx(lj,{$variant:"primary",onClick:b,disabled:h,children:h?"Cargando...":"Filtrar"})]})}),m&&a.jsx(Ipe,{children:m}),h?a.jsx(zpe,{children:"Cargando datos del reporte..."}):g&&a.jsxs(a.Fragment,{children:[a.jsxs(Fpe,{children:[a.jsxs(Tf,{$color:d.colors.primary,children:[a.jsx(Af,{children:g.total}),a.jsx(Ff,{children:"Total Muestras"})]}),a.jsxs(Tf,{$color:d.colors.warning,children:[a.jsx(Af,{children:x.pendiente||0}),a.jsx(Ff,{children:"Pendientes"})]}),a.jsxs(Tf,{$color:d.colors.primary,children:[a.jsx(Af,{children:x.en_proceso||0}),a.jsx(Ff,{children:"En Proceso"})]}),a.jsxs(Tf,{$color:d.colors.success,children:[a.jsx(Af,{children:x.completada||0}),a.jsx(Ff,{children:"Completadas"})]}),a.jsxs(Tf,{$color:d.colors.danger,children:[a.jsx(Af,{children:x.rechazada||0}),a.jsx(Ff,{children:"Rechazadas"})]})]}),a.jsxs(Dpe,{children:[j&&a.jsxs(o2,{children:[a.jsx(cj,{children:"Por Tipo de Muestra"}),a.jsx(bS,{data:j,options:T})]}),S&&a.jsxs(o2,{children:[a.jsx(cj,{children:"Por Estado"}),a.jsx(ia,{data:S,options:F})]})]}),a.jsxs(Ppe,{children:[a.jsxs(cj,{children:["Listado de Muestras (",g.total," registros)"]}),a.jsxs(Mpe,{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx(_c,{children:"ID"}),a.jsx(_c,{children:"OT"}),a.jsx(_c,{children:"Tipo"}),a.jsx(_c,{children:"Fecha Solicitud"}),a.jsx(_c,{children:"Completada"}),a.jsx(_c,{children:"Estado"}),a.jsx(_c,{children:"Responsable"})]})}),a.jsx("tbody",{children:g.items.length===0?a.jsx("tr",{children:a.jsx(Jo,{colSpan:7,style:{textAlign:"center"},children:"No hay muestras en el periodo seleccionado"})}):g.items.map(w=>a.jsxs("tr",{children:[a.jsxs(Jo,{style:{fontWeight:600},children:["#",w.id]}),a.jsxs(Jo,{children:["OT-",w.ot_id]}),a.jsx(Jo,{children:a.jsx(Rpe,{$tipo:w.tipo,children:w.tipo})}),a.jsx(Jo,{children:w.created_at}),a.jsx(Jo,{children:w.completed_at||"-"}),a.jsx(Jo,{children:a.jsx(Ope,{$status:w.estado,children:w.estado})}),a.jsx(Jo,{children:w.responsable})]},w.id))})]}),g.total_pages>1&&a.jsxs(Npe,{children:[a.jsx(lj,{onClick:()=>u(w=>Math.max(1,w-1)),disabled:c===1,children:"Anterior"}),a.jsxs("span",{style:{padding:"0.5rem 1rem"},children:["Pagina ",c," de ",g.total_pages]}),a.jsx(lj,{onClick:()=>u(w=>Math.min(g.total_pages,w+1)),disabled:c===g.total_pages,children:"Siguiente"})]})]})]})]})}const De={Admin:1,Gerente:2,JefeVenta:3,Vendedor:4,JefeDesarrollo:5,Ingeniero:6,JefeDiseo:7,Diseador:8,JefeCatalogador:9,Catalogador:10,JefePrecatalogador:11,Precatalogador:12,JefeMuestras:13,TecnicoMuestras:14,GerenteComercial:15,SuperAdministrador:18,VendedorExterno:19},Lt={isAdmin:e=>e===De.Admin,isSuperAdministrador:e=>e===De.SuperAdministrador,isVendedor:e=>e===De.Vendedor,isVendedorExterno:e=>e===De.VendedorExterno,isJefeVenta:e=>e===De.JefeVenta,isJefeDesarrollo:e=>e===De.JefeDesarrollo,isGerenteGeneral:e=>e===De.Gerente,isGerenteComercial:e=>e===De.GerenteComercial,isJefeCatalogador:e=>e===De.JefeCatalogador,isCatalogador:e=>e===De.Catalogador,isIngeniero:e=>e===De.Ingeniero,isJefeDiseo:e=>e===De.JefeDiseo,isDiseador:e=>e===De.Diseador,isJefePrecatalogador:e=>e===De.JefePrecatalogador,isPrecatalogador:e=>e===De.Precatalogador,isJefeMuestras:e=>e===De.JefeMuestras,isTecnicoMuestras:e=>e===De.TecnicoMuestras,hasArea:e=>[De.JefeVenta,De.Vendedor,De.JefeDesarrollo,De.Ingeniero,De.JefeDiseo,De.Diseador,De.JefeCatalogador,De.Catalogador,De.JefePrecatalogador,De.Precatalogador,De.JefeMuestras,De.TecnicoMuestras,De.SuperAdministrador].includes(e),canApprove:e=>[De.Admin,De.SuperAdministrador,De.JefeVenta,De.JefeDesarrollo].includes(e),canViewReports:e=>[De.Admin,De.SuperAdministrador,De.JefeCatalogador,De.Gerente,De.GerenteComercial,De.JefeDesarrollo,De.JefeDiseo].includes(e),hasFullMantenedores:e=>[De.Admin,De.SuperAdministrador].includes(e),canUseCotizador:e=>[De.Admin,De.SuperAdministrador,De.Vendedor,De.Gerente,De.GerenteComercial,De.JefeVenta].includes(e),canApproveCotizaciones:e=>[De.Gerente,De.GerenteComercial,De.JefeVenta].includes(e),canAccessMantenedores:e=>[De.Admin,De.SuperAdministrador,De.Vendedor,De.JefeVenta,De.JefeCatalogador,De.Catalogador,De.Ingeniero,De.JefeDesarrollo,De.JefeDiseo,De.Diseador,De.JefePrecatalogador,De.Precatalogador].includes(e),canViewMuestras:e=>[De.Ingeniero,De.JefeVenta,De.Vendedor,De.TecnicoMuestras,De.JefeMuestras,De.JefeDesarrollo,De.SuperAdministrador,De.Admin].includes(e),canCreateMuestra:(e,t)=>e===De.Ingeniero||e===De.JefeDesarrollo||(e===De.Vendedor||e===De.JefeVenta)&&t===1},Hpe=new UN({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),Wpe=p.div`
  min-height: 100vh;
  background-color: ${d.colors.bgLight};
`,Gpe=p.header`
  background-color: white;
  border-bottom: 1px solid ${d.colors.border};
  padding: ${d.spacing.sm} ${d.spacing.xl};
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
`,qpe=p.div`
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: ${d.spacing.md};
`,Kpe=p.div`
  display: flex;
  align-items: center;
  flex-shrink: 0;
`,Xpe=p.h1`
  color: ${d.colors.primary};
  font-size: ${d.typography.sizes.h2};
  font-weight: ${d.typography.weights.bold};
  margin: 0;
`,Ype=p.nav`
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  flex-wrap: wrap;
  justify-content: center;
  flex: 1;
`,Qpe=p.div`
  display: flex;
  align-items: center;
  gap: ${d.spacing.sm};
  flex-shrink: 0;
`,Jpe=p.span`
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  white-space: nowrap;
`,Zpe=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.primary}15;
    border-color: ${d.colors.primary};
    color: ${d.colors.primary};
  }
`,eme=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background-color: transparent;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  color: ${d.colors.textSecondary};
  font-size: ${d.typography.sizes.small};
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background-color: ${d.colors.danger}15;
    border-color: ${d.colors.danger};
    color: ${d.colors.danger};
  }
`,tme=p.main`
  max-width: 1400px;
  margin: 0 auto;
  padding: ${d.spacing.lg} ${d.spacing.xl};
`,Gd=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,dj=p.div`
  position: relative;
  display: inline-block;
`,uj=p.button`
  padding: ${d.spacing.xs} ${d.spacing.sm};
  background: ${({$active:e})=>e?d.colors.primary:"transparent"};
  color: ${({$active:e})=>e?"white":d.colors.textSecondary};
  border: none;
  border-radius: ${d.radius.md};
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.medium};
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: ${d.spacing.xs};
  white-space: nowrap;

  &:hover {
    background: ${({$active:e})=>e?d.colors.primary:d.colors.bgLight};
    color: ${({$active:e})=>e?"white":d.colors.textPrimary};
  }
`,hj=p.span`
  display: inline-block;
  transition: transform 0.2s;
  transform: ${({$open:e})=>e?"rotate(180deg)":"rotate(0deg)"};
`,fj=p.div`
  position: absolute;
  top: 100%;
  left: 0;
  min-width: 220px;
  background: white;
  border: 1px solid ${d.colors.border};
  border-radius: ${d.radius.md};
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  display: ${({$open:e})=>e?"block":"none"};
  max-height: 400px;
  overflow-y: auto;
`,an=p.div`
  padding: ${d.spacing.xs} 0;
  border-bottom: 1px solid ${d.colors.border};

  &:last-child {
    border-bottom: none;
  }
`,Un=p.div`
  padding: ${d.spacing.xs} ${d.spacing.md};
  font-size: ${d.typography.sizes.small};
  font-weight: ${d.typography.weights.semibold};
  color: ${d.colors.textSecondary};
  text-transform: uppercase;
  letter-spacing: 0.5px;
`,Ie=p.button`
  width: 100%;
  padding: ${d.spacing.sm} ${d.spacing.md};
  background: ${({$active:e})=>e?`${d.colors.primary}15`:"transparent"};
  color: ${({$active:e})=>e?d.colors.primary:d.colors.textPrimary};
  border: none;
  text-align: left;
  cursor: pointer;
  font-size: ${d.typography.sizes.small};
  transition: all 0.15s;

  &:hover {
    background: ${d.colors.bgLight};
    color: ${d.colors.primary};
  }
`;function rme({user:e,onLogout:t}){const[r,n]=C.useState("dashboard"),[i,s]=C.useState(null),[o,l]=C.useState(null),[c,u]=C.useState(null),[h,f]=C.useState(null),[m,_]=C.useState(null),[g,v]=C.useState(null),[y,b]=C.useState(!1),[x,j]=C.useState(!1),S=C.useRef(null),T=C.useRef(null),w=["clientes","usuarios","jerarquias-1","jerarquias-2","jerarquias-3","tipo-productos","estilos","colores","canales","tipos-cintas","almacenes","tipo-palet","organizaciones-ventas","grupo-imputacion-material","matrices","sectores","cartones","secuencias-operacionales","rechazo-conjunto","tiempo-tratamiento","grupo-materiales-1","grupo-materiales-2","materiales","grupo-plantas","adhesivos","cebes","clasificaciones-clientes","armados","procesos","pegados","envases","rayados","papeles","cardboards","carton-esquineros","plantas","tipo-ondas","factores-ondas","factores-desarrollos","factores-seguridads","areahcs","consumo-adhesivos","consumo-energias","consumo-adhesivo-pegados","merma-corrugadoras","merma-convertidoras","mercados","rubros","ciudades-fletes","fletes","maquila-servicios","tarifario","tarifario-margens","variables-cotizador","insumos-palletizados","detalle-precio-palletizados","paises","fsc","reference-types","recubrimiento-types"].includes(r);C.useEffect(()=>{const W=R=>{S.current&&!S.current.contains(R.target)&&b(!1),T.current&&!T.current.contains(R.target)&&j(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const[P,M]=C.useState({productTypeId:null,impresion:null,fsc:null,cinta:null,coverageInternalId:null,coverageExternalId:null,plantaId:null,cartonColor:null,cartonId:null}),A=W=>{M(W),console.log("Form data changed:",W)},D=C.useCallback((W,R,ae)=>{n(W),b(!1),j(!1),W==="editar-ot"&&R?(s(R),l(null),u(null),f(null),_(null)):W==="gestionar-ot"&&R?(l(R),s(null),u(null),f(null),_(null)):W==="editar-ot-especial"&&R?(s(R),l(null),u(null),f(null),_(null)):W==="detalle-log-ot"&&R?(u(R),s(null),l(null),f(null),_(null)):(W==="cotizacion-editar"||W==="cotizacion-externa-editar")&&R?(f(R),s(null),l(null),u(null),_(null)):W==="crear-ot-desde-cotizacion"&&ae?(_(ae),s(null),l(null),u(null),f(null),v(null)):(W==="muestras-list"||W==="muestra-nueva")&&R?(v(R),s(null),l(null),u(null),f(null),_(null)):(s(null),l(null),u(null),f(null),_(null),v(null))},[]),H=`${e.nombre} ${e.apellido}`,U=()=>{switch(r){case"dashboard":return a.jsx(sa,{onNavigate:D});case"crear-ot":return a.jsx(O$,{onNavigate:D});case"crear-ot-especial":return a.jsx(lU,{onNavigate:D});case"editar-ot-especial":return i?a.jsx(yU,{otId:i,onNavigate:D}):null;case"editar-ot":return i?a.jsx(iB,{otId:i,onNavigate:D}):null;case"cascade-form":return a.jsx(vk,{values:P,onChange:A});case"gestionar-ot":return o?a.jsx(a9,{otId:o,onNavigate:D}):null;case"notificaciones":return a.jsx(x9,{onNavigate:D});case"aprobacion-ots":return a.jsx(j9,{onNavigate:D});case"asignaciones":return a.jsx(R9,{onNavigate:D});case"cotizar-multiples-ot":return Lt.canUseCotizador(e.role_id)?a.jsx(Y9,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"reportes":return a.jsx(Lse,{onNavigate:D});case"detalle-log-ot":return c?a.jsx(OU,{otId:c,onNavigate:D}):null;case"reporte-ots-activas":return a.jsx(Mue,{onNavigate:D});case"reporte-ots-completadas":return a.jsx(que,{onNavigate:D});case"reporte-tiempo-area":return a.jsx(hhe,{onNavigate:D});case"reporte-rechazos":return a.jsx(Phe,{onNavigate:D});case"reporte-carga-mensual":return a.jsx(Yhe,{onNavigate:D});case"reporte-anulaciones":return a.jsx(dfe,{onNavigate:D});case"reporte-ots-completadas-fechas":return a.jsx(wfe,{onNavigate:D});case"reporte-gestion-ots-activas":return a.jsx(Nfe,{onNavigate:D});case"reporte-tiempo-primera-muestra":return a.jsx(Qfe,{onNavigate:D});case"reporte-motivos-rechazo":return a.jsx(u0e,{onNavigate:D});case"reporte-tiempo-disenador-externo":return a.jsx(T0e,{onNavigate:D});case"reporte-sala-muestra":return a.jsx(G0e,{onNavigate:D});case"reporte-indicador-sala-muestra":return a.jsx(ope,{onNavigate:D});case"reporte-diseno-estructural-sala":return a.jsx(kpe,{onNavigate:D});case"reporte-muestras":return a.jsx(Vpe,{onNavigate:D});case"cotizaciones":return Lt.canUseCotizador(e.role_id)?a.jsx(Fne,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"cotizacion-nueva":return Lt.canUseCotizador(e.role_id)?a.jsx(Km,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"cotizacion-editar":return Lt.canUseCotizador(e.role_id)?h?a.jsx(Km,{cotizacionId:h,onNavigate:D}):null:a.jsx(sa,{onNavigate:D});case"aprobaciones":return Lt.canUseCotizador(e.role_id)?a.jsx(Kae,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"ayuda-cotizador":return Lt.canUseCotizador(e.role_id)?a.jsx(dse,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"cotizador-externo":return Lt.canUseCotizador(e.role_id)?a.jsx(Qie,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"cotizacion-externa-nueva":return Lt.canUseCotizador(e.role_id)?a.jsx(Km,{onNavigate:D,isExterno:!0}):a.jsx(sa,{onNavigate:D});case"cotizacion-externa-editar":return Lt.canUseCotizador(e.role_id)?h?a.jsx(Km,{cotizacionId:h,onNavigate:D,isExterno:!0}):null:a.jsx(sa,{onNavigate:D});case"aprobacion-externa-cotizaciones":return Lt.canUseCotizador(e.role_id)?a.jsx(die,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"detalle-a-ot":return Lt.canUseCotizador(e.role_id)?a.jsx(Rie,{onNavigate:D}):a.jsx(sa,{onNavigate:D});case"crear-ot-desde-cotizacion":return Lt.canUseCotizador(e.role_id)?m?a.jsx(O$,{onNavigate:D,initialData:m}):null:a.jsx(sa,{onNavigate:D});case"muestras-list":return g?a.jsx(yse,{otId:g,onNavigate:D,onCreateMuestra:()=>D("muestra-nueva",g)}):null;case"muestra-nueva":return g?a.jsx($se,{otId:g,onNavigate:D,onSuccess:()=>D("muestras-list",g)}):null;case"clientes":return a.jsx(xV,{onNavigate:D});case"usuarios":return a.jsx(zV,{onNavigate:D});case"jerarquias-1":return a.jsx(cy,{nivel:1,onNavigate:D});case"jerarquias-2":return a.jsx(cy,{nivel:2,onNavigate:D});case"jerarquias-3":return a.jsx(cy,{nivel:3,onNavigate:D});case"tipo-productos":return a.jsx(We,{tablaKey:"tipo_productos",onNavigate:D});case"estilos":return a.jsx(We,{tablaKey:"estilos",onNavigate:D});case"colores":return a.jsx(We,{tablaKey:"colores",onNavigate:D});case"canales":return a.jsx(We,{tablaKey:"canales",onNavigate:D});case"tipos-cintas":return a.jsx(We,{tablaKey:"tipos_cintas",onNavigate:D});case"almacenes":return a.jsx(We,{tablaKey:"almacenes",onNavigate:D});case"tipo-palet":return a.jsx(We,{tablaKey:"tipo_palet",onNavigate:D});case"organizaciones-ventas":return a.jsx(We,{tablaKey:"organizaciones_ventas",onNavigate:D});case"grupo-imputacion-material":return a.jsx(We,{tablaKey:"grupo_imputacion_material",onNavigate:D});case"matrices":return a.jsx(We,{tablaKey:"matrices",onNavigate:D});case"sectores":return a.jsx(We,{tablaKey:"sectores",onNavigate:D});case"cartones":return a.jsx(We,{tablaKey:"cartones",onNavigate:D});case"secuencias-operacionales":return a.jsx(We,{tablaKey:"secuencias_operacionales",onNavigate:D});case"rechazo-conjunto":return a.jsx(We,{tablaKey:"rechazo_conjunto",onNavigate:D});case"tiempo-tratamiento":return a.jsx(We,{tablaKey:"tiempo_tratamiento",onNavigate:D});case"grupo-materiales-1":return a.jsx(We,{tablaKey:"grupo_materiales_1",onNavigate:D});case"grupo-materiales-2":return a.jsx(We,{tablaKey:"grupo_materiales_2",onNavigate:D});case"materiales":return a.jsx(We,{tablaKey:"materiales",onNavigate:D});case"grupo-plantas":return a.jsx(We,{tablaKey:"grupo_plantas",onNavigate:D});case"adhesivos":return a.jsx(We,{tablaKey:"adhesivos",onNavigate:D});case"cebes":return a.jsx(We,{tablaKey:"cebes",onNavigate:D});case"clasificaciones-clientes":return a.jsx(We,{tablaKey:"clasificaciones_clientes",onNavigate:D});case"armados":return a.jsx(We,{tablaKey:"armados",onNavigate:D});case"procesos":return a.jsx(We,{tablaKey:"procesos",onNavigate:D});case"pegados":return a.jsx(We,{tablaKey:"pegados",onNavigate:D});case"envases":return a.jsx(We,{tablaKey:"envases",onNavigate:D});case"rayados":return a.jsx(We,{tablaKey:"rayados",onNavigate:D});case"papeles":return a.jsx(We,{tablaKey:"papeles",onNavigate:D});case"cardboards":return a.jsx(We,{tablaKey:"cardboards",onNavigate:D});case"carton-esquineros":return a.jsx(We,{tablaKey:"carton_esquineros",onNavigate:D});case"plantas":return a.jsx(We,{tablaKey:"plantas",onNavigate:D});case"tipo-ondas":return a.jsx(We,{tablaKey:"tipo_ondas",onNavigate:D});case"factores-ondas":return a.jsx(We,{tablaKey:"factores_ondas",onNavigate:D});case"factores-desarrollos":return a.jsx(We,{tablaKey:"factores_desarrollos",onNavigate:D});case"factores-seguridads":return a.jsx(We,{tablaKey:"factores_seguridads",onNavigate:D});case"areahcs":return a.jsx(We,{tablaKey:"areahcs",onNavigate:D});case"consumo-adhesivos":return a.jsx(We,{tablaKey:"consumo_adhesivos",onNavigate:D});case"consumo-energias":return a.jsx(We,{tablaKey:"consumo_energias",onNavigate:D});case"consumo-adhesivo-pegados":return a.jsx(We,{tablaKey:"consumo_adhesivo_pegados",onNavigate:D});case"merma-corrugadoras":return a.jsx(We,{tablaKey:"merma_corrugadoras",onNavigate:D});case"merma-convertidoras":return a.jsx(We,{tablaKey:"merma_convertidoras",onNavigate:D});case"mercados":return a.jsx(We,{tablaKey:"mercados",onNavigate:D});case"rubros":return a.jsx(We,{tablaKey:"rubros",onNavigate:D});case"ciudades-fletes":return a.jsx(We,{tablaKey:"ciudades_fletes",onNavigate:D});case"fletes":return a.jsx(We,{tablaKey:"fletes",onNavigate:D});case"maquila-servicios":return a.jsx(We,{tablaKey:"maquila_servicios",onNavigate:D});case"tarifario":return a.jsx(We,{tablaKey:"tarifario",onNavigate:D});case"tarifario-margens":return a.jsx(We,{tablaKey:"tarifario_margens",onNavigate:D});case"variables-cotizador":return a.jsx(We,{tablaKey:"variables_cotizador",onNavigate:D});case"insumos-palletizados":return a.jsx(We,{tablaKey:"insumos_palletizados",onNavigate:D});case"detalle-precio-palletizados":return a.jsx(We,{tablaKey:"detalle_precio_palletizados",onNavigate:D});case"paises":return a.jsx(We,{tablaKey:"paises",onNavigate:D});case"fsc":return a.jsx(We,{tablaKey:"fsc",onNavigate:D});case"reference-types":return a.jsx(We,{tablaKey:"reference_types",onNavigate:D});case"recubrimiento-types":return a.jsx(We,{tablaKey:"recubrimiento_types",onNavigate:D});case"carga-masiva":return a.jsx(Lre,{onNavigate:D});case"cambiar-contrasena":return a.jsx(Yre,{onNavigate:D});default:return a.jsx(sa,{onNavigate:D})}};return a.jsxs(Wpe,{children:[a.jsx(Gpe,{children:a.jsxs(qpe,{children:[a.jsx(Kpe,{children:a.jsx(Xpe,{children:"INVEB"})}),a.jsxs(Ype,{children:[!Lt.isVendedorExterno(e.role_id)&&!Lt.isAdmin(e.role_id)&&a.jsx(Gd,{$active:r==="dashboard",onClick:()=>D("dashboard"),children:"Ordenes de Trabajo"}),Lt.isVendedorExterno(e.role_id)?a.jsxs(a.Fragment,{children:[a.jsx(Gd,{$active:r==="dashboard",onClick:()=>D("dashboard"),children:"Ordenes de Trabajo"}),a.jsxs(dj,{ref:S,children:[a.jsxs(uj,{$active:r==="cotizador-externo",onClick:()=>b(!y),children:["Cotizador",a.jsx(hj,{$open:y,children:""})]}),a.jsx(fj,{$open:y,children:a.jsx(an,{children:a.jsx(Ie,{$active:r==="cotizador-externo",onClick:()=>D("cotizador-externo"),children:"Cotizaciones"})})})]})]}):a.jsxs(a.Fragment,{children:[Lt.hasArea(e.role_id)&&a.jsx(Gd,{$active:r==="notificaciones",onClick:()=>D("notificaciones"),children:"Notificaciones"}),Lt.hasArea(e.role_id)&&!Lt.isAdmin(e.role_id)&&!Lt.isVendedor(e.role_id)&&a.jsx(Gd,{$active:r==="asignaciones",onClick:()=>D("asignaciones"),children:"Asignaciones"}),Lt.canApprove(e.role_id)&&a.jsx(Gd,{$active:r==="aprobacion-ots",onClick:()=>D("aprobacion-ots"),children:"Aprobaciones"}),Lt.canViewReports(e.role_id)&&a.jsx(Gd,{$active:r==="reportes",onClick:()=>D("reportes"),children:"Reporteria"}),Lt.canAccessMantenedores(e.role_id)&&a.jsxs(dj,{ref:S,children:[a.jsxs(uj,{$active:w,onClick:()=>b(!y),children:["Mantenedores",a.jsx(hj,{$open:y,children:""})]}),a.jsxs(fj,{$open:y,children:[a.jsxs(an,{children:[a.jsx(Un,{children:"Principales"}),a.jsx(Ie,{$active:r==="clientes",onClick:()=>D("clientes"),children:"Clientes"}),Lt.hasFullMantenedores(e.role_id)&&a.jsx(Ie,{$active:r==="usuarios",onClick:()=>D("usuarios"),children:"Usuarios"})]}),Lt.hasFullMantenedores(e.role_id)&&a.jsxs(a.Fragment,{children:[a.jsxs(an,{children:[a.jsx(Un,{children:"Jerarquias"}),a.jsx(Ie,{$active:r==="jerarquias-1",onClick:()=>D("jerarquias-1"),children:"Jerarquias Nivel 1"}),a.jsx(Ie,{$active:r==="jerarquias-2",onClick:()=>D("jerarquias-2"),children:"Jerarquias Nivel 2"}),a.jsx(Ie,{$active:r==="jerarquias-3",onClick:()=>D("jerarquias-3"),children:"Jerarquias Nivel 3"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Productos"}),a.jsx(Ie,{$active:r==="tipo-productos",onClick:()=>D("tipo-productos"),children:"Tipo de Productos"}),a.jsx(Ie,{$active:r==="estilos",onClick:()=>D("estilos"),children:"Estilos"}),a.jsx(Ie,{$active:r==="colores",onClick:()=>D("colores"),children:"Colores"}),a.jsx(Ie,{$active:r==="canales",onClick:()=>D("canales"),children:"Canales"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Logistica"}),a.jsx(Ie,{$active:r==="tipos-cintas",onClick:()=>D("tipos-cintas"),children:"Tipos de Cintas"}),a.jsx(Ie,{$active:r==="almacenes",onClick:()=>D("almacenes"),children:"Almacenes"}),a.jsx(Ie,{$active:r==="tipo-palet",onClick:()=>D("tipo-palet"),children:"Tipo de Palet"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Comercial"}),a.jsx(Ie,{$active:r==="organizaciones-ventas",onClick:()=>D("organizaciones-ventas"),children:"Organizaciones de Ventas"}),a.jsx(Ie,{$active:r==="grupo-imputacion-material",onClick:()=>D("grupo-imputacion-material"),children:"Grupo Imputacion Material"}),a.jsx(Ie,{$active:r==="matrices",onClick:()=>D("matrices"),children:"Matrices"}),a.jsx(Ie,{$active:r==="clasificaciones-clientes",onClick:()=>D("clasificaciones-clientes"),children:"Clasificaciones Clientes"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Produccion"}),a.jsx(Ie,{$active:r==="sectores",onClick:()=>D("sectores"),children:"Sectores"}),a.jsx(Ie,{$active:r==="cartones",onClick:()=>D("cartones"),children:"Cartones"}),a.jsx(Ie,{$active:r==="secuencias-operacionales",onClick:()=>D("secuencias-operacionales"),children:"Secuencias Operacionales"}),a.jsx(Ie,{$active:r==="rechazo-conjunto",onClick:()=>D("rechazo-conjunto"),children:"Rechazo Conjunto"}),a.jsx(Ie,{$active:r==="tiempo-tratamiento",onClick:()=>D("tiempo-tratamiento"),children:"Tiempo de Tratamiento"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Materiales"}),a.jsx(Ie,{$active:r==="materiales",onClick:()=>D("materiales"),children:"Materiales"}),a.jsx(Ie,{$active:r==="grupo-materiales-1",onClick:()=>D("grupo-materiales-1"),children:"Grupo Materiales 1"}),a.jsx(Ie,{$active:r==="grupo-materiales-2",onClick:()=>D("grupo-materiales-2"),children:"Grupo Materiales 2"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Configuracion"}),a.jsx(Ie,{$active:r==="grupo-plantas",onClick:()=>D("grupo-plantas"),children:"Grupo de Plantas"}),a.jsx(Ie,{$active:r==="adhesivos",onClick:()=>D("adhesivos"),children:"Adhesivos"}),a.jsx(Ie,{$active:r==="cebes",onClick:()=>D("cebes"),children:"CEBES"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Procesos"}),a.jsx(Ie,{$active:r==="armados",onClick:()=>D("armados"),children:"Armados"}),a.jsx(Ie,{$active:r==="procesos",onClick:()=>D("procesos"),children:"Procesos"}),a.jsx(Ie,{$active:r==="pegados",onClick:()=>D("pegados"),children:"Pegados"}),a.jsx(Ie,{$active:r==="envases",onClick:()=>D("envases"),children:"Envases"}),a.jsx(Ie,{$active:r==="rayados",onClick:()=>D("rayados"),children:"Rayados"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Papeles"}),a.jsx(Ie,{$active:r==="papeles",onClick:()=>D("papeles"),children:"Papeles"}),a.jsx(Ie,{$active:r==="cardboards",onClick:()=>D("cardboards"),children:"Cardboards"}),a.jsx(Ie,{$active:r==="carton-esquineros",onClick:()=>D("carton-esquineros"),children:"Carton Esquineros"}),a.jsx(Ie,{$active:r==="tipo-ondas",onClick:()=>D("tipo-ondas"),children:"Tipo Ondas"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Plantas"}),a.jsx(Ie,{$active:r==="plantas",onClick:()=>D("plantas"),children:"Plantas"}),a.jsx(Ie,{$active:r==="factores-ondas",onClick:()=>D("factores-ondas"),children:"Factores Ondas"}),a.jsx(Ie,{$active:r==="factores-desarrollos",onClick:()=>D("factores-desarrollos"),children:"Factores Desarrollos"}),a.jsx(Ie,{$active:r==="factores-seguridads",onClick:()=>D("factores-seguridads"),children:"Factores Seguridad"}),a.jsx(Ie,{$active:r==="areahcs",onClick:()=>D("areahcs"),children:"Area HCs"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Consumos"}),a.jsx(Ie,{$active:r==="consumo-adhesivos",onClick:()=>D("consumo-adhesivos"),children:"Consumo Adhesivos"}),a.jsx(Ie,{$active:r==="consumo-energias",onClick:()=>D("consumo-energias"),children:"Consumo Energias"}),a.jsx(Ie,{$active:r==="consumo-adhesivo-pegados",onClick:()=>D("consumo-adhesivo-pegados"),children:"Consumo Adhesivo Pegados"}),a.jsx(Ie,{$active:r==="merma-corrugadoras",onClick:()=>D("merma-corrugadoras"),children:"Merma Corrugadoras"}),a.jsx(Ie,{$active:r==="merma-convertidoras",onClick:()=>D("merma-convertidoras"),children:"Merma Convertidoras"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Comercial"}),a.jsx(Ie,{$active:r==="mercados",onClick:()=>D("mercados"),children:"Mercados"}),a.jsx(Ie,{$active:r==="rubros",onClick:()=>D("rubros"),children:"Rubros"}),a.jsx(Ie,{$active:r==="ciudades-fletes",onClick:()=>D("ciudades-fletes"),children:"Ciudades Fletes"}),a.jsx(Ie,{$active:r==="fletes",onClick:()=>D("fletes"),children:"Fletes"}),a.jsx(Ie,{$active:r==="maquila-servicios",onClick:()=>D("maquila-servicios"),children:"Maquila Servicios"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Tarifas"}),a.jsx(Ie,{$active:r==="tarifario",onClick:()=>D("tarifario"),children:"Tarifario"}),a.jsx(Ie,{$active:r==="tarifario-margens",onClick:()=>D("tarifario-margens"),children:"Tarifario Margenes"}),a.jsx(Ie,{$active:r==="variables-cotizador",onClick:()=>D("variables-cotizador"),children:"Variables Cotizador"}),a.jsx(Ie,{$active:r==="insumos-palletizados",onClick:()=>D("insumos-palletizados"),children:"Insumos Palletizados"}),a.jsx(Ie,{$active:r==="detalle-precio-palletizados",onClick:()=>D("detalle-precio-palletizados"),children:"Precio Palletizados"})]}),a.jsxs(an,{children:[a.jsx(Un,{children:"Cotizador - Catalogos"}),a.jsx(Ie,{$active:r==="paises",onClick:()=>D("paises"),children:"Paises"}),a.jsx(Ie,{$active:r==="fsc",onClick:()=>D("fsc"),children:"FSC"}),a.jsx(Ie,{$active:r==="reference-types",onClick:()=>D("reference-types"),children:"Tipos Referencia"}),a.jsx(Ie,{$active:r==="recubrimiento-types",onClick:()=>D("recubrimiento-types"),children:"Tipos Recubrimiento"})]})]})]})]}),Lt.canUseCotizador(e.role_id)&&a.jsxs(dj,{ref:T,children:[a.jsxs(uj,{$active:r==="cotizaciones"||r==="aprobaciones",onClick:()=>j(!x),children:["Cotizador",a.jsx(hj,{$open:x,children:""})]}),a.jsx(fj,{$open:x,children:a.jsxs(an,{children:[a.jsx(Ie,{$active:r==="cotizaciones",onClick:()=>D("cotizaciones"),children:"Cotizaciones"}),Lt.canApproveCotizaciones(e.role_id)&&a.jsx(Ie,{$active:r==="aprobaciones",onClick:()=>D("aprobaciones"),children:"Aprobar Cotizaciones"}),a.jsx(Ie,{$active:r==="ayuda-cotizador",onClick:()=>D("ayuda-cotizador"),children:"Seccin de Ayuda"})]})})]})]})]}),a.jsxs(Qpe,{children:[a.jsx(Jpe,{children:H}),a.jsx(Zpe,{onClick:()=>D("cambiar-contrasena"),children:"Clave"}),a.jsx(eme,{onClick:t,children:"Salir"})]})]})}),a.jsx(tme,{children:U()})]})}function nme(){const[e,t]=C.useState(null),[r,n]=C.useState(!0),[i,s]=C.useState("login"),[o,l]=C.useState({});C.useEffect(()=>{const f=mo.getStoredUser();f&&t(f),n(!1)},[]);const c=C.useCallback(async(f,m)=>{try{const _=await mo.login({rut:f,password:m});return t(_.user),!0}catch(_){return console.error("Login failed:",_),!1}},[]),u=C.useCallback(()=>{mo.logout(),t(null),s("login")},[]),h=C.useCallback((f,m)=>{s(f),m&&l(m)},[]);if(r)return null;if(!e)switch(i){case"forgot-password":return a.jsx(une,{onNavigate:h});case"reset-password":return a.jsx(xne,{onNavigate:h,token:o.token,email:o.email});default:return a.jsx(y7,{onLogin:c,onNavigate:h})}return a.jsx(rme,{user:e,onLogout:u})}function ame(){return a.jsxs(VN,{client:Hpe,children:[a.jsx(lI,{}),a.jsx(nme,{})]})}pj.createRoot(document.getElementById("root")).render(a.jsx(Es.StrictMode,{children:a.jsx(ame,{})}));
//# sourceMappingURL=index-CQIW2R52.js.map
